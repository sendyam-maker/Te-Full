VERSION 5.00
Object = "{BDC217C8-ED16-11CD-956C-0000C04E4C0A}#1.1#0"; "TABCTL32.OCX"
Object = "{0D452EE1-E08F-101A-852E-02608C4D0BB4}#2.0#0"; "FM20.DLL"
Begin VB.Form Frmacc21q0 
   AutoRedraw      =   -1  'True
   Caption         =   "客戶/代理人匯款銀行資料維護"
   ClientHeight    =   5472
   ClientLeft      =   48
   ClientTop       =   336
   ClientWidth     =   8892
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   ScaleHeight     =   5472
   ScaleMode       =   0  '使用者自訂
   ScaleWidth      =   8989.535
   Begin TabDlg.SSTab SSTab1 
      Height          =   5364
      Left            =   60
      TabIndex        =   31
      Top             =   60
      Width           =   8628
      _ExtentX        =   15219
      _ExtentY        =   9462
      _Version        =   393216
      Tab             =   1
      TabHeight       =   520
      TabCaption(0)   =   "匯款資料"
      TabPicture(0)   =   "Frmacc21q0.frx":0000
      Tab(0).ControlEnabled=   0   'False
      Tab(0).Control(0)=   "Combo3"
      Tab(0).Control(0).Enabled=   0   'False
      Tab(0).Control(1)=   "Command1"
      Tab(0).Control(1).Enabled=   0   'False
      Tab(0).Control(2)=   "Combo1"
      Tab(0).Control(2).Enabled=   0   'False
      Tab(0).Control(3)=   "Combo2"
      Tab(0).Control(3).Enabled=   0   'False
      Tab(0).Control(4)=   "txtA2226"
      Tab(0).Control(4).Enabled=   0   'False
      Tab(0).Control(5)=   "Label28"
      Tab(0).Control(5).Enabled=   0   'False
      Tab(0).Control(6)=   "Text23"
      Tab(0).Control(6).Enabled=   0   'False
      Tab(0).Control(7)=   "Text7"
      Tab(0).Control(7).Enabled=   0   'False
      Tab(0).Control(8)=   "Text6"
      Tab(0).Control(8).Enabled=   0   'False
      Tab(0).Control(9)=   "Text1"
      Tab(0).Control(9).Enabled=   0   'False
      Tab(0).Control(10)=   "Text4"
      Tab(0).Control(10).Enabled=   0   'False
      Tab(0).Control(11)=   "Text3"
      Tab(0).Control(11).Enabled=   0   'False
      Tab(0).Control(12)=   "Text5"
      Tab(0).Control(12).Enabled=   0   'False
      Tab(0).Control(13)=   "Text9"
      Tab(0).Control(13).Enabled=   0   'False
      Tab(0).Control(14)=   "Text2"
      Tab(0).Control(14).Enabled=   0   'False
      Tab(0).Control(15)=   "Text8"
      Tab(0).Control(15).Enabled=   0   'False
      Tab(0).Control(16)=   "Text10"
      Tab(0).Control(16).Enabled=   0   'False
      Tab(0).Control(17)=   "Text11"
      Tab(0).Control(17).Enabled=   0   'False
      Tab(0).Control(18)=   "Text14"
      Tab(0).Control(18).Enabled=   0   'False
      Tab(0).Control(19)=   "Text15"
      Tab(0).Control(19).Enabled=   0   'False
      Tab(0).Control(20)=   "Text12"
      Tab(0).Control(20).Enabled=   0   'False
      Tab(0).Control(21)=   "Label21"
      Tab(0).Control(21).Enabled=   0   'False
      Tab(0).Control(22)=   "Label20"
      Tab(0).Control(22).Enabled=   0   'False
      Tab(0).Control(23)=   "lblNation"
      Tab(0).Control(23).Enabled=   0   'False
      Tab(0).Control(24)=   "Label19"
      Tab(0).Control(24).Enabled=   0   'False
      Tab(0).Control(25)=   "Label9"
      Tab(0).Control(25).Enabled=   0   'False
      Tab(0).Control(26)=   "Image1"
      Tab(0).Control(26).Enabled=   0   'False
      Tab(0).Control(27)=   "Label10"
      Tab(0).Control(27).Enabled=   0   'False
      Tab(0).Control(28)=   "Label2"
      Tab(0).Control(28).Enabled=   0   'False
      Tab(0).Control(29)=   "Label1"
      Tab(0).Control(29).Enabled=   0   'False
      Tab(0).Control(30)=   "Label3"
      Tab(0).Control(30).Enabled=   0   'False
      Tab(0).Control(31)=   "Label4"
      Tab(0).Control(31).Enabled=   0   'False
      Tab(0).Control(32)=   "Label5"
      Tab(0).Control(32).Enabled=   0   'False
      Tab(0).Control(33)=   "Label6"
      Tab(0).Control(33).Enabled=   0   'False
      Tab(0).Control(34)=   "Label8"
      Tab(0).Control(34).Enabled=   0   'False
      Tab(0).Control(35)=   "Label11"
      Tab(0).Control(35).Enabled=   0   'False
      Tab(0).Control(36)=   "Shape1"
      Tab(0).Control(36).Enabled=   0   'False
      Tab(0).Control(37)=   "Label12"
      Tab(0).Control(37).Enabled=   0   'False
      Tab(0).Control(38)=   "Label7"
      Tab(0).Control(38).Enabled=   0   'False
      Tab(0).ControlCount=   39
      TabCaption(1)   =   "其他資料"
      TabPicture(1)   =   "Frmacc21q0.frx":001C
      Tab(1).ControlEnabled=   -1  'True
      Tab(1).Control(0)=   "Shape2"
      Tab(1).Control(0).Enabled=   0   'False
      Tab(1).Control(1)=   "Label13"
      Tab(1).Control(1).Enabled=   0   'False
      Tab(1).Control(2)=   "Label14"
      Tab(1).Control(2).Enabled=   0   'False
      Tab(1).Control(3)=   "Label15"
      Tab(1).Control(3).Enabled=   0   'False
      Tab(1).Control(4)=   "Label16"
      Tab(1).Control(4).Enabled=   0   'False
      Tab(1).Control(5)=   "Label17(0)"
      Tab(1).Control(5).Enabled=   0   'False
      Tab(1).Control(6)=   "Label22"
      Tab(1).Control(6).Enabled=   0   'False
      Tab(1).Control(7)=   "Label23"
      Tab(1).Control(7).Enabled=   0   'False
      Tab(1).Control(8)=   "lblCNT"
      Tab(1).Control(8).Enabled=   0   'False
      Tab(1).Control(9)=   "Label24"
      Tab(1).Control(9).Enabled=   0   'False
      Tab(1).Control(10)=   "Text13"
      Tab(1).Control(10).Enabled=   0   'False
      Tab(1).Control(11)=   "Text16"
      Tab(1).Control(11).Enabled=   0   'False
      Tab(1).Control(12)=   "Text17"
      Tab(1).Control(12).Enabled=   0   'False
      Tab(1).Control(13)=   "Text18"
      Tab(1).Control(13).Enabled=   0   'False
      Tab(1).Control(14)=   "Text19"
      Tab(1).Control(14).Enabled=   0   'False
      Tab(1).Control(15)=   "Text20"
      Tab(1).Control(15).Enabled=   0   'False
      Tab(1).Control(16)=   "Text21"
      Tab(1).Control(16).Enabled=   0   'False
      Tab(1).Control(17)=   "Label25"
      Tab(1).Control(17).Enabled=   0   'False
      Tab(1).Control(18)=   "txtFAddr"
      Tab(1).Control(18).Enabled=   0   'False
      Tab(1).Control(19)=   "Label26"
      Tab(1).Control(19).Enabled=   0   'False
      Tab(1).Control(20)=   "Label27"
      Tab(1).Control(20).Enabled=   0   'False
      Tab(1).Control(21)=   "txtA2224"
      Tab(1).Control(21).Enabled=   0   'False
      Tab(1).Control(22)=   "txtA2225"
      Tab(1).Control(22).Enabled=   0   'False
      Tab(1).Control(23)=   "lblA2225Name"
      Tab(1).Control(23).Enabled=   0   'False
      Tab(1).ControlCount=   24
      TabCaption(2)   =   "備註"
      TabPicture(2)   =   "Frmacc21q0.frx":0038
      Tab(2).ControlEnabled=   0   'False
      Tab(2).Control(0)=   "Text22"
      Tab(2).Control(0).Enabled=   0   'False
      Tab(2).Control(1)=   "Label18"
      Tab(2).Control(1).Enabled=   0   'False
      Tab(2).ControlCount=   2
      Begin VB.ComboBox Combo3 
         BackColor       =   &H00C0FFFF&
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   11.4
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   324
         ItemData        =   "Frmacc21q0.frx":0054
         Left            =   -68250
         List            =   "Frmacc21q0.frx":0061
         TabIndex        =   13
         Top             =   1215
         Width           =   1545
      End
      Begin VB.CommandButton Command1 
         Height          =   300
         Left            =   -71280
         Picture         =   "Frmacc21q0.frx":007D
         Style           =   1  '圖片外觀
         TabIndex        =   26
         Top             =   480
         Width           =   350
      End
      Begin VB.ComboBox Combo1 
         BackColor       =   &H00C0FFFF&
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   11.4
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   324
         ItemData        =   "Frmacc21q0.frx":017F
         Left            =   -72780
         List            =   "Frmacc21q0.frx":0198
         TabIndex        =   5
         Top             =   2250
         Width           =   2925
      End
      Begin VB.ComboBox Combo2 
         BackColor       =   &H00C0FFFF&
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   11.4
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   324
         ItemData        =   "Frmacc21q0.frx":01DF
         Left            =   -70350
         List            =   "Frmacc21q0.frx":01E1
         TabIndex        =   1
         Top             =   480
         Width           =   1425
      End
      Begin MSForms.TextBox txtA2226 
         Height          =   336
         Left            =   -68400
         TabIndex        =   16
         Top             =   3024
         Width           =   588
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   1
         Size            =   "1032;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label Label28 
         BackStyle       =   0  '透明
         Caption         =   "是否為IBAN          (Y.是 N.否)"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   252
         Left            =   -69720
         TabIndex        =   62
         Top             =   3030
         Width           =   3144
      End
      Begin VB.Label lblA2225Name 
         AutoSize        =   -1  'True
         BackStyle       =   0  '透明
         Caption         =   "lblA2225Name"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   216
         Left            =   3240
         TabIndex        =   61
         Top             =   4968
         Width           =   1380
      End
      Begin MSForms.TextBox txtA2225 
         Height          =   336
         Left            =   2568
         TabIndex        =   24
         Top             =   4920
         Width           =   588
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   3
         Size            =   "1032;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox txtA2224 
         Height          =   336
         Left            =   2040
         TabIndex        =   23
         Top             =   4536
         Width           =   4164
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   35
         Size            =   "7345;593"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label Label27 
         BackStyle       =   0  '透明
         Caption         =   "受款人地址國家代號"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   252
         Left            =   408
         TabIndex        =   60
         Top             =   4968
         Width           =   2160
      End
      Begin VB.Label Label26 
         BackStyle       =   0  '透明
         Caption         =   "受款人地址城市"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   252
         Left            =   408
         TabIndex        =   59
         Top             =   4608
         Width           =   1752
      End
      Begin MSForms.TextBox txtFAddr 
         Height          =   708
         Left            =   2040
         TabIndex        =   22
         Top             =   3816
         Width           =   6204
         VariousPropertyBits=   -1467989985
         BackColor       =   14737632
         Size            =   "10943;1249"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label Label25 
         BackStyle       =   0  '透明
         Caption         =   "受款人英文地址"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   252
         Left            =   408
         TabIndex        =   58
         Top             =   3840
         Width           =   1752
      End
      Begin MSForms.TextBox Text23 
         Height          =   330
         Left            =   -73500
         TabIndex        =   12
         Top             =   4720
         Width           =   6285
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   50
         Size            =   "11086;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text7 
         Height          =   330
         Left            =   -68280
         TabIndex        =   15
         Top             =   2640
         Width           =   585
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   3
         Size            =   "1032;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text22 
         Height          =   4200
         Left            =   -74040
         TabIndex        =   25
         Top             =   600
         Width           =   7335
         VariousPropertyBits=   -1466941413
         BackColor       =   12648447
         MaxLength       =   1000
         ScrollBars      =   2
         Size            =   "12938;7408"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text21 
         Height          =   330
         Left            =   1890
         TabIndex        =   21
         Top             =   3090
         Width           =   6375
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   110
         Size            =   "11245;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text6 
         Height          =   330
         Left            =   -72840
         TabIndex        =   10
         Top             =   4050
         Width           =   1725
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   12
         Size            =   "3043;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text20 
         Height          =   330
         Left            =   1890
         TabIndex        =   20
         Top             =   2250
         Width           =   6375
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   50
         Size            =   "11245;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text19 
         Height          =   330
         Left            =   1890
         TabIndex        =   19
         Top             =   1920
         Width           =   6375
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   50
         Size            =   "11245;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text18 
         Height          =   330
         Left            =   1890
         TabIndex        =   18
         Top             =   1590
         Width           =   6375
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   50
         Size            =   "11245;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text17 
         Height          =   330
         Left            =   1890
         TabIndex        =   30
         Top             =   1230
         Width           =   6375
         VariousPropertyBits=   671105055
         BackColor       =   14737632
         Size            =   "11245;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text16 
         Height          =   330
         Left            =   1890
         TabIndex        =   29
         Top             =   900
         Width           =   6375
         VariousPropertyBits=   671105055
         BackColor       =   14737632
         Size            =   "11245;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text13 
         Height          =   330
         Left            =   2340
         TabIndex        =   17
         Top             =   570
         Width           =   1572
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   9
         Size            =   "2773;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text1 
         Height          =   330
         Left            =   -72840
         TabIndex        =   0
         Top             =   480
         Width           =   1572
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   9
         Size            =   "2773;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   330
         Left            =   -68250
         TabIndex        =   27
         Top             =   480
         Width           =   1545
         VariousPropertyBits=   671105055
         BackColor       =   14737632
         Size            =   "2725;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text3 
         Height          =   330
         Left            =   -73500
         TabIndex        =   2
         Top             =   1230
         Width           =   4000
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   35
         Size            =   "7056;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text5 
         Height          =   330
         Left            =   -74130
         TabIndex        =   28
         Top             =   840
         Width           =   7425
         VariousPropertyBits=   671105055
         BackColor       =   14737632
         Size            =   "13097;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text9 
         Height          =   330
         Left            =   -73500
         TabIndex        =   3
         Top             =   1560
         Width           =   4000
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   35
         Size            =   "7056;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   330
         Left            =   -73500
         TabIndex        =   4
         Top             =   1890
         Width           =   4000
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   35
         Size            =   "7056;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text8 
         Height          =   330
         Left            =   -73350
         TabIndex        =   7
         Top             =   3000
         Width           =   3600
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   34
         Size            =   "6350;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text10 
         Height          =   330
         Left            =   -73350
         TabIndex        =   8
         Top             =   3360
         Width           =   4000
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   35
         Size            =   "7056;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text11 
         Height          =   330
         Left            =   -73350
         TabIndex        =   9
         Top             =   3690
         Width           =   4000
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   35
         Size            =   "7056;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text14 
         Height          =   330
         Left            =   -68760
         TabIndex        =   14
         Top             =   2280
         Width           =   465
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   1
         Size            =   "820;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text15 
         Height          =   330
         Left            =   -73500
         TabIndex        =   11
         Top             =   4400
         Width           =   6285
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   60
         Size            =   "11086;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text12 
         Height          =   330
         Left            =   -73140
         TabIndex        =   6
         Top             =   2640
         Width           =   3285
         VariousPropertyBits=   671105051
         BackColor       =   12648447
         MaxLength       =   30
         Size            =   "5794;582"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   225
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label Label24 
         Caption         =   "P.S. 中間銀行之swift code 需加上"":""以利程式辨別."
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   9.6
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   1920
         TabIndex        =   57
         Top             =   2640
         Width           =   4695
      End
      Begin VB.Label lblCNT 
         Caption         =   "lblCNT"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   11.4
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   1440
         TabIndex        =   56
         Top             =   3480
         Width           =   375
      End
      Begin VB.Label Label23 
         BackStyle       =   0  '透明
         Caption         =   "目前輸入　　　字"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   255
         Left            =   408
         TabIndex        =   55
         Top             =   3480
         Width           =   1995
      End
      Begin VB.Label Label22 
         Caption         =   " 整批結匯, 台銀之地址能容納70字元,華銀則為名稱+地址為140字元"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   9.6
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF00FF&
         Height          =   255
         Left            =   2400
         TabIndex        =   54
         Top             =   3480
         Width           =   5895
      End
      Begin VB.Label Label21 
         BackStyle       =   0  '透明
         Caption         =   "台一備註"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   53
         Top             =   4800
         Width           =   1185
      End
      Begin VB.Label Label20 
         BackStyle       =   0  '透明
         Caption         =   "媒體備註"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   52
         Top             =   4440
         Width           =   1185
      End
      Begin VB.Label lblNation 
         BackStyle       =   0  '透明
         Caption         =   "lblNation"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -67680
         TabIndex        =   51
         Top             =   2670
         Width           =   1275
      End
      Begin VB.Label Label19 
         BackStyle       =   0  '透明
         Caption         =   "受款銀行國籍"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -69720
         TabIndex        =   50
         Top             =   2670
         Width           =   1545
      End
      Begin VB.Label Label18 
         BackStyle       =   0  '透明
         Caption         =   "備註"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74580
         TabIndex        =   49
         Top             =   600
         Width           =   915
      End
      Begin VB.Label Label17 
         BackStyle       =   0  '透明
         Caption         =   "受款人短地址"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   252
         Index           =   0
         Left            =   408
         TabIndex        =   48
         Top             =   3120
         Width           =   1992
      End
      Begin VB.Label Label16 
         BackStyle       =   0  '透明
         Caption         =   "中間銀行資料"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   420
         TabIndex        =   47
         Top             =   1650
         Width           =   1995
      End
      Begin VB.Label Label15 
         BackStyle       =   0  '透明
         Caption         =   "列印對象地址"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   420
         TabIndex        =   46
         Top             =   1290
         Width           =   1485
      End
      Begin VB.Label Label14 
         BackStyle       =   0  '透明
         Caption         =   "列印對象名稱"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   420
         TabIndex        =   45
         Top             =   930
         Width           =   1485
      End
      Begin VB.Label Label13 
         BackStyle       =   0  '透明
         Caption         =   "付款明細列印對象"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   420
         TabIndex        =   44
         Top             =   600
         Width           =   1995
      End
      Begin VB.Shape Shape2 
         BorderColor     =   &H00FF0000&
         Height          =   4896
         Left            =   156
         Top             =   396
         Width           =   8292
      End
      Begin VB.Label Label9 
         BackStyle       =   0  '透明
         Caption         =   "客戶/代理人編號"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   43
         Top             =   480
         Width           =   1755
      End
      Begin VB.Image Image1 
         Height          =   135
         Left            =   -75000
         Top             =   5160
         Visible         =   0   'False
         Width           =   135
      End
      Begin VB.Label Label10 
         BackStyle       =   0  '透明
         Caption         =   "受款人名稱"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   42
         Top             =   1260
         Width           =   1185
      End
      Begin VB.Label Label2 
         BackStyle       =   0  '透明
         Caption         =   "名稱"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   41
         Top             =   870
         Width           =   555
      End
      Begin VB.Label Label1 
         BackStyle       =   0  '透明
         Caption         =   "國籍"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -68790
         TabIndex        =   40
         Top             =   480
         Width           =   555
      End
      Begin VB.Label Label3 
         BackStyle       =   0  '透明
         Caption         =   "手續費方式"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -69480
         TabIndex        =   39
         Top             =   1260
         Width           =   1275
      End
      Begin VB.Label Label4 
         BackStyle       =   0  '透明
         Caption         =   "CNAPS(大陸匯款)"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   38
         Top             =   4080
         Width           =   1875
      End
      Begin VB.Label Label5 
         BackStyle       =   0  '透明
         Caption         =   "受款人帳號"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   37
         Top             =   3030
         Width           =   1185
      End
      Begin VB.Label Label6 
         BackStyle       =   0  '透明
         Caption         =   "受款銀行"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   36
         Top             =   3360
         Width           =   1185
      End
      Begin VB.Label Label8 
         BackStyle       =   0  '透明
         Caption         =   "受款銀行代號種類"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   35
         Top             =   2295
         Width           =   1965
      End
      Begin VB.Label Label11 
         BackStyle       =   0  '透明
         Caption         =   "匯款方式        (1.票匯 2.電匯)"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -69720
         TabIndex        =   34
         Top             =   2280
         Width           =   3675
      End
      Begin VB.Shape Shape1 
         BorderColor     =   &H00FF0000&
         Height          =   4720
         Left            =   -74790
         Top             =   390
         Width           =   8295
      End
      Begin VB.Label Label12 
         BackStyle       =   0  '透明
         Caption         =   "受款銀行代號"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -74640
         TabIndex        =   33
         Top             =   2670
         Width           =   1485
      End
      Begin VB.Label Label7 
         BackStyle       =   0  '透明
         Caption         =   "幣別"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   10.8
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   -70860
         TabIndex        =   32
         Top             =   480
         Width           =   555
      End
   End
End
Attribute VB_Name = "Frmacc21q0"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'Memo by Lydia 2021/12/02  改成Form 2.0; 所有TextBox
'Memo By Sonia 2012/12/4 智權人員欄已修改
'2010/12/1 memo by sonia 員工編號欄已修改
'Memo by Morgan 2010/7/30 日期欄已修改
Option Explicit
Public adoacc220 As New ADODB.Recordset
Dim m_OAddr As String 'Added by Lydia 2017/08/07 原地址
Dim tmpBol As Boolean 'Added by Lydia 2025/07/21

Private Sub Combo1_GotFocus()
    Me.Combo1.SelStart = 0
    Me.Combo1.SelLength = Len(Me.Combo2.Text)
End Sub

Private Sub Combo1_KeyUp(KeyCode As Integer, Shift As Integer)
    KeyEnter KeyCode
End Sub

Private Sub Combo2_GotFocus()
    Me.Combo2.SelStart = 0
    Me.Combo2.SelLength = Len(Me.Combo2.Text)
End Sub

Private Sub Combo2_KeyPress(KeyAscii As Integer)
    KeyAscii = UpperCase(KeyAscii)
End Sub

Private Sub Combo2_KeyUp(KeyCode As Integer, Shift As Integer)
    KeyEnter KeyCode
End Sub

Private Sub Combo2_Validate(Cancel As Boolean)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset

    If strSaveConfirm <> MsgText(3) Then
        Exit Sub
    End If
    If Combo2.Text = MsgText(601) Then
        MsgBox Label7 & MsgText(52), , MsgText(5)
        Cancel = True
        Exit Sub
    Else
        Me.Text1.Text = Left(Me.Text1.Text & "000000000", 9)
        StrSQLa = "Select * From ACC220 Where a2201='" & Me.Text1.Text & "' And a2202='" & Me.Combo2.Text & "' "
        rsA.CursorLocation = adUseClient
        rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
        If rsA.RecordCount > 0 Then
            MsgBox "資料重複, 請重新輸入!!!", vbExclamation + vbOKOnly
            Cancel = True
        End If
        If rsA.State <> adStateClosed Then rsA.Close
        Set rsA = Nothing
    End If
    If Cancel = True Then Combo2_GotFocus
End Sub

Private Sub Command1_Click()
    Acc220Refresh
    If adoacc220.RecordCount <> 0 Then
        FormShow
        RecordShow
    End If
End Sub

Private Sub Command1_KeyUp(KeyCode As Integer, Shift As Integer)
    Select Case KeyCode
    Case vbKeyReturn
        Command1_Click
        Exit Sub
    End Select
    KeyEnter KeyCode
End Sub

Private Sub Form_Activate()
    strFormName = Name
    If strItemNo = MsgText(601) Then
        Exit Sub
    End If
    If adoacc220.RecordCount <> 0 Then
        adoacc220.MoveFirst
    End If
    Text1 = strItemNo
    Acc220Refresh
    If adoacc220.RecordCount <> 0 Then
        FormShow
        RecordShow
    End If
    strItemNo = MsgText(601)
End Sub

'Added by Lydia 2021/12/02
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    Call PUB_SaveTrackMode(0, KeyCode)  'Added by Lydia 2021/12/02 Form2.0 記錄鍵盤傳入順序
End Sub

Private Sub Form_KeyUp(KeyCode As Integer, Shift As Integer)
    Call PUB_SaveTrackMode(1, KeyCode)  'Added by Lydia 2021/12/02 Form2.0 記錄鍵盤傳入順序
    
    KeyEnter KeyCode
End Sub

Private Sub Form_Load()
   '表單初始化
   'Modified by Lydia 2015/03/27
   ' PUB_InitForm Me, 8880, 5520, strBackPicPath1
   'Modify by Amy 2023/08/18 W8880 H5685
   PUB_InitForm Me, 8990, 5920, strBackPicPath1
   'tool6_enabled 'Remove by Morgan 2010/12/7 --要有新增功能
    OpenTable
    If adoacc220.RecordCount <> 0 Then
        adoacc220.MoveLast
        adoacc220.MoveFirst
        RecordShow
    End If

   lblCNT.Caption = ""  'Added by Lydia 2017/09/07
   SSTab1.Tab = 0 'Added by Lydia 2021/12/07
   'Added by Lydia 2025/07/21
   lblNation.Caption = ""
   lblA2225Name.Caption = ""
   
End Sub

Private Sub Form_Unload(Cancel As Integer)
    If strSaveConfirm = MsgText(3) Or strSaveConfirm = MsgText(4) Then
        Cancel = 1
        Exit Sub
    End If
    StatusClear
    strFormName = MsgText(601)
    strTrackMode = "" 'Added by Lydia 2021/12/02 Form2.0 記錄鍵盤傳入順序(清除)
    KeyEnter vbKeyEscape
    MenuEnabled
    Set Frmacc21q0 = Nothing
End Sub

Private Sub SSTab1_Click(PreviousTab As Integer)

    If Me.Visible = False Then Exit Sub 'Added by Lydia 2025/07/02
    Select Case Me.SSTab1.Tab
    Case 0 '匯款資料
        Me.Text1.SetFocus
        Text1_GotFocus
    Case 1 '其他資料
        Me.Text13.SetFocus
        Text13_GotFocus
    'Added by Lydia 2015/03/30
    Case 2 '備註
        Me.Text22.SetFocus
        Text22_GotFocus
    End Select
End Sub

Private Sub Text1_GotFocus()
    TextInverse Text1
    CloseIme 'Added by Lydia 2017/09/29
End Sub

'Modified by Lydia 2021/12/02 改成Form 2.0; KeyAscii As Integer=>MSForms.ReturnInteger
Private Sub Text1_KeyPress(KeyAscii As MSForms.ReturnInteger)
    KeyAscii = UpperCase(KeyAscii)
End Sub

'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text1_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text1_LostFocus()
    If Me.Text1.Text <> "" Then
        Me.Text1.Text = Left(Me.Text1.Text & "000000000", 9)
    End If
End Sub

Private Sub Text1_Validate(Cancel As Boolean)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset

    If strSaveConfirm <> MsgText(3) Then
        Exit Sub
    End If
    If Text1 = MsgText(601) Then
        MsgBox Label9 & MsgText(52), , MsgText(5)
        Cancel = True
        Exit Sub
    Else
        Me.Text1.Text = Left(Me.Text1.Text & "000000000", 9)
        'Modified by Lydia 2015/3/24 改名稱秀一欄,排序:英->中->日
'        StrSQLa = "Select NA03, CU04, CU05, CU88, CU89, CU90, CU06 From Customer, Nation Where CU10=NA01(+) And CU01='" & Mid(Me.Text1.Text, 1, 8) & "' And CU02='" & Mid(Me.Text1.Text, 9, 1) & "' And CU02='0' "
'        StrSQLa = StrSQLa & " Union Select NA03, FA04, FA05, FA63, FA64, FA65, FA06 From Fagent, Nation Where FA10=NA01(+) And FA01='" & Mid(Me.Text1.Text, 1, 8) & "' And FA02='" & Mid(Me.Text1.Text, 9, 1) & "' And FA02='0' "
        'Modified by Lydia 2025/10/17 +英文地址addr
        'Modified by Lydia 2025/11/06 +,substr(NA01,1,3) as NA01
        StrSQLa = "Select NA03, Decode(CU05, Null, Nvl(CU04, CU06), CU05||' '||CU88||' '||CU89||' '||CU90) CNAME, CU05, CU88, CU89,rtrim(cu24||' '||cu25||' '||cu26||' '||cu27||' '||cu28||' '||cu102) addr,substr(NA01,1,3) as NA01 From Customer, Nation Where CU10=NA01(+) And CU01='" & Mid(Me.Text1.Text, 1, 8) & "' And CU02='" & Mid(Me.Text1.Text, 9, 1) & "' And CU02='0' "
        StrSQLa = StrSQLa & " Union Select NA03, Decode(FA05, Null, Nvl(FA04, FA06), FA05||' '||FA63||' '||FA64||' '||FA65) CNAME, FA05, FA63, FA64,rtrim(fa18||' '||fa19||' '||fa20||' '||fa21||' '||fa22||' '||fa70) as addr,substr(NA01,1,3) as NA01 From Fagent, Nation Where FA10=NA01(+) And FA01='" & Mid(Me.Text1.Text, 1, 8) & "' And FA02='" & Mid(Me.Text1.Text, 9, 1) & "' And FA02='0' "
        rsA.CursorLocation = adUseClient
        rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
        If rsA.RecordCount > 0 Then
            Me.Text4.Text = "" & rsA.Fields(0).Value
            Me.Text5.Text = "" & rsA.Fields(1).Value
           ' Me.Text6.Text = Trim("" & rsA.Fields(2).Value & " " & rsA.Fields(3).Value & " " & rsA.Fields(4).Value & " " & rsA.Fields(5).Value)
          '  Me.Text7.Text = "" & rsA.Fields(6).Value
            If Me.Text1.Tag <> Me.Text1.Text Then 'Added by Lydia 2025/11/06 遇見因為別的檢查不通過，然後跳離Text1觸發自動帶入X/Y名稱，造成人工輸入的名稱不見
               Me.Text3.Text = "" & rsA.Fields(2).Value
               Me.Text9.Text = "" & rsA.Fields(3).Value
               Me.Text2.Text = "" & rsA.Fields(4).Value
            'Added by Lydia 2025/11/06
               Me.txtA2225 = "" & rsA.Fields("na01")
               Me.lblA2225Name.Caption = "" & rsA.Fields(0).Value
            End If
            'end 2025/11/06
        '    Me.Text15.Text = "" & rsA.Fields(5).Value
            Me.txtFAddr.Text = "" & rsA.Fields("addr")  'Added by Lydia 2025/10/17
        Else
            MsgBox "查無此客戶/代理人資料!!!", vbExclamation + vbOKOnly
            Me.Text4.Text = ""
            Me.Text5.Text = ""
          '  Me.Text6.Text = ""
          '  Me.Text7.Text = ""
            Me.Text3.Text = ""
            Me.Text9.Text = ""
            Me.Text2.Text = ""
          '  Me.Text15.Text = ""
            Me.txtFAddr.Text = ""   'Added by Lydia 2025/10/17
            'Added by Lydia 2025/11/03
            Me.txtA2225.Text = ""
            Me.lblA2225Name.Caption = ""
            'end 2025/11/03
            Cancel = True
        End If
        lblNation.Caption = ""
        'end 2015/3/24
        If rsA.State <> adStateClosed Then rsA.Close
        Set rsA = Nothing
        Me.Text1.Tag = Me.Text1.Text 'Added by Lydia 2025/11/06
    End If
    If Cancel = True Then Text1_GotFocus
End Sub

Private Sub Text10_GotFocus()
    TextInverse Me.Text10
     CloseIme 'Added by Lydia 2017/09/29
End Sub

'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text10_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text11_GotFocus()
    TextInverse Me.Text11
     CloseIme 'Added by Lydia 2017/09/29
End Sub

'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text11_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text12_GotFocus()
    TextInverse Me.Text12
End Sub

'2015/8/11 ADD BY SONIA 台銀因電匯媒體故要求不可輸空白
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyAscii As Integer=>MSForms.ReturnInteger
Private Sub Text12_KeyPress(KeyAscii As MSForms.ReturnInteger)
    If KeyAscii = 32 Then
       KeyAscii = 0
    'Added by Lydia 2017/09/14 限大寫
    Else
        KeyAscii = UpperCase(KeyAscii)
    'end 2017/09/14
    End If
End Sub

Private Sub Text12_Validate(Cancel As Boolean)
Dim bolC3 As Boolean, a1 As Integer

    For a1 = 1 To Len(Text12)
       If Mid(Text12, a1, 1) = " " Then
          Cancel = True: Exit For
       End If
    Next a1
    If Cancel = True Then
       MsgBox "受款銀行代號不可有空格!!", vbExclamation
       Text12_GotFocus
    End If
End Sub

'Added by Lydia 2017/09/12
Private Sub Text21_Change()
   lblCNT.Caption = GetTextLength(Me.Text21.Text)
End Sub

'Added by Lydia 2017/09/07
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyAscii As Integer=>MSForms.ReturnInteger
Private Sub Text21_KeyPress(KeyAscii As MSForms.ReturnInteger)
   'lblCNT.Caption = GetTextLength(Me.Text21.Text) 'Mark by Lydia 2017/09/12
End Sub

'Modified by Lydia 2021/12/02 改成Form 2.0; KeyAscii As Integer=>MSForms.ReturnInteger
Private Sub Text8_KeyPress(KeyAscii As MSForms.ReturnInteger)
    If KeyAscii = 32 Then
       KeyAscii = 0
    'Mark by Amy 2016/01/12 會無法使用copy貼上及backspace刪除
'    'Added by Lydia 2015/10/06 限輸入英文或數字
'    ElseIf Not ((KeyAscii >= 48 And KeyAscii <= 57) Or (KeyAscii >= 65 And KeyAscii <= 90) Or (KeyAscii >= 97 And KeyAscii <= 122)) Then
'        KeyAscii = 0
   'end 2015/10/06
    'Added by Lydia 2017/09/14 限大寫
    Else
        KeyAscii = UpperCase(KeyAscii)
    'end 2017/09/14
    End If
End Sub

Private Sub Text8_Validate(Cancel As Boolean)
Dim bolC3 As Boolean, a1 As Integer
Dim strMsg As String 'Add by Amy 2016/01/12

    For a1 = 1 To Len(Text8)
       If Mid(Text8, a1, 1) = " " Then
          strMsg = "不可有空格!!"
          Cancel = True: Exit For
       'Add by Amy 2016/01/12 +elseif
       ElseIf Asc(Mid(Text8, a1, 1)) = 13 Then
          strMsg = "不可有換行!!"
          Cancel = True: Exit For
       ElseIf Not (IsNumeric(Mid(Text8, a1, 1)) Or (Asc(Mid(Text8, a1, 1)) >= 65 And Asc(Mid(Text8, a1, 1)) <= 90) Or _
          (Asc(Mid(Text8, a1, 1)) >= 97 And Asc(Mid(Text8, a1, 1)) <= 122)) Then
          strMsg = "只可輸入英文或數字!!"
          Cancel = True: Exit For
       End If
    Next a1
    If Cancel = True Then
       MsgBox "受款人帳號" & strMsg, vbExclamation
       Text8_GotFocus
    End If
    'end 2016/01/12
End Sub
'2015/8/11 END
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text12_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text13_GotFocus()
    TextInverse Me.Text13
End Sub

'Modified by Lydia 2021/12/02 改成Form 2.0; KeyAscii As Integer=>MSForms.ReturnInteger
Private Sub Text13_KeyPress(KeyAscii As MSForms.ReturnInteger)
    KeyAscii = UpperCase(KeyAscii)
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text13_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

'*****列印對象*****
Private Sub Text13_Validate(Cancel As Boolean)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
    
    If strSaveConfirm <> MsgText(3) And strSaveConfirm <> MsgText(4) Then
        Exit Sub
    End If
    If Text13 <> MsgText(601) Then
        Me.Text13.Text = Left(Me.Text13.Text & "000000000", 9)
        StrSQLa = "Select Decode(FA05, Null, Nvl(FA04, FA06), FA05||' '||FA63||' '||FA64||' '||FA65), Decode(FA32, Null, Decode(FA18, Null,Nvl(FA17, FA23), FA18||' '||FA19||' '||FA20||' '||FA21||' '||FA22||' '||FA70), FA32||' '||FA33||' '||FA34||' '||FA35||' '||FA36)  From Fagent " & _
                        " Where FA01='" & Mid(Me.Text13.Text, 1, 8) & "' And FA02='" & Mid(Me.Text13.Text, 9, 1) & "' And FA02='0' "
        rsA.CursorLocation = adUseClient
        rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
        If rsA.RecordCount > 0 Then
            Me.Text16.Text = "" & rsA.Fields(0).Value
            Me.Text17.Text = "" & rsA.Fields(1).Value
        Else
            MsgBox "查無此代理人資料!!!", vbExclamation + vbOKOnly
            Me.Text16.Text = ""
            Me.Text17.Text = ""
            Cancel = True
        End If
        If rsA.State <> adStateClosed Then rsA.Close
        Set rsA = Nothing
    Else
        Me.Text16.Text = ""
        Me.Text17.Text = ""
    End If
    If Cancel = True Then Text13_GotFocus
End Sub

Private Sub Text14_GotFocus()
    TextInverse Me.Text14
End Sub

'Modified by Lydia 2021/12/02 改成Form 2.0; KeyAscii As Integer=>MSForms.ReturnInteger
Private Sub Text14_KeyPress(KeyAscii As MSForms.ReturnInteger)
    If KeyAscii <> 8 And KeyAscii <> 49 And KeyAscii <> 50 Then
        KeyAscii = 0
    End If
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text14_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text15_GotFocus()
    TextInverse Text15
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text15_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text18_GotFocus()
    TextInverse Me.Text18
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text18_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text19_GotFocus()
    TextInverse Me.Text19
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text19_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text2_GotFocus()
    TextInverse Text2
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text2_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

'*************************************************
'  開啟資料表
'
'*************************************************
Private Sub OpenTable()
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset

On Error GoTo Checking
    strSql = "Select * From acc220 Order By a2201 "
    adoacc220.CursorLocation = adUseClient
'    adoacc220.MaxRecords = intMax
    adoacc220.Open strSql, adoTaie, adOpenDynamic, adLockBatchOptimistic
    
    StrSQLa = "select * from acc1y0 order by a1y01 asc"
    rsA.CursorLocation = adUseClient
    rsA.Open StrSQLa, adoTaie, adOpenStatic, adLockReadOnly
    Do While rsA.EOF = False
        Combo2.AddItem "" & rsA.Fields("a1y01").Value
        rsA.MoveNext
    Loop
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing
Checking:
    If Err.Number = 0 Then
        Exit Sub
    End If
    MsgBox Err.Description, , MsgText(5)
End Sub

'*************************************************
'  顯示資料表
'
'*************************************************
Public Sub FormShow()
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
    
On Error GoTo ErrorHandler

    Me.Text1.Text = "" & Me.adoacc220.Fields(0).Value
    Me.Combo2.Text = "" & Me.adoacc220.Fields(1).Value
    Me.Text3.Text = "" & Me.adoacc220.Fields(2).Value
    Me.Text9.Text = "" & Me.adoacc220.Fields(3).Value
    Me.Text2.Text = "" & Me.adoacc220.Fields(4).Value
    'Modified by Lydia 2015/03/27 名稱只要3欄
    'Me.Text15.Text = "" & Me.adoacc220.Fields(5).Value
    Me.Text8.Text = "" & Me.adoacc220.Fields(6).Value
    Me.Text10.Text = "" & Me.adoacc220.Fields(7).Value
    Me.Text11.Text = "" & Me.adoacc220.Fields(8).Value
    Me.Combo1.Text = "" & Me.adoacc220.Fields(9).Value
    Me.Text12.Text = "" & Me.adoacc220.Fields(10).Value
    Me.Text14.Text = "" & Me.adoacc220.Fields(11).Value
    Me.Text13.Text = "" & Me.adoacc220.Fields(12).Value
    Me.Text18.Text = "" & Me.adoacc220.Fields(13).Value
    Me.Text19.Text = "" & Me.adoacc220.Fields(14).Value
    Me.Text20.Text = "" & Me.adoacc220.Fields(15).Value
    'Modified by Lydia 2015/3/24 針對台銀水單媒體化增加的欄位
    Me.Text7.Text = "" & Me.adoacc220.Fields(16).Value
    Me.Text21.Text = "" & Me.adoacc220.Fields(17).Value
    lblCNT.Caption = GetTextLength(Me.Text21.Text)  'Added by Lydia 2017/09/07
    Me.Combo3.Text = "" & Me.adoacc220.Fields(18).Value
    Me.Text6.Text = "" & Me.adoacc220.Fields(19).Value
    Me.Text22.Text = "" & Me.adoacc220.Fields(20).Value
    Call Text7_Validate(False)
    'Modified by Lydia 2015/03/27 媒體,台一備註
    Me.Text15.Text = "" & Me.adoacc220.Fields(21).Value
    Me.Text23.Text = "" & Me.adoacc220.Fields(22).Value
    'Added by Lydia 2025/07/21
    Me.txtA2224.Text = "" & Me.adoacc220.Fields(23).Value
    Me.txtA2225.Text = "" & Me.adoacc220.Fields(24).Value
    'end 2025/07/21
    Me.txtA2226.Text = "" & Me.adoacc220.Fields(25).Value 'Added by Lydia 2025/10/17
    
    'Modified by Morgan 2014/1/24 +CU10
    'Modified by Lydia 2015/3/24 改名稱秀一欄,排序:英->中->日
'    StrSQLa = "Select NA03, CU04, CU05||' '||CU88||' '||CU89||' '||CU90, CU06,CU10 From Customer, Nation Where CU10=NA01(+) And CU01='" & Mid(Me.Text1.Text, 1, 8) & "' And CU02='" & Mid(Me.Text1.Text, 9, 1) & "' And CU02='0' "
'    StrSQLa = StrSQLa & " Union Select NA03, FA04, FA05||' '||FA63||' '||FA64||' '||FA65, FA06,FA10 From Fagent, Nation Where FA10=NA01(+) And FA01='" & Mid(Me.Text1.Text, 1, 8) & "' And FA02='" & Mid(Me.Text1.Text, 9, 1) & "' And FA02='0' "
    'Modified by Lydia 2017/08/07　與台銀結匯一樣抓英文名稱和地址
    'StrSQLa = "Select NA03, Decode(CU05, Null, Nvl(CU04, CU06), CU05||' '||CU88||' '||CU89||' '||CU90) CNAME,CU10 From Customer, Nation Where CU10=NA01(+) And CU01='" & Mid(Me.Text1.Text, 1, 8) & "' And CU02='" & Mid(Me.Text1.Text, 9, 1) & "' And CU02='0' "
    'StrSQLa = StrSQLa & " Union Select NA03,Decode(FA05, Null, Nvl(FA04, FA06), FA05||' '||FA63||' '||FA64||' '||FA65) CNAME, FA10 From Fagent, Nation Where FA10=NA01(+) And FA01='" & Mid(Me.Text1.Text, 1, 8) & "' And FA02='" & Mid(Me.Text1.Text, 9, 1) & "' And FA02='0' "
    'Modified by Lydia 2017/09/05 debug 客戶地址抓錯欄位 cu24||' '||cu25||' '||cu26||' '||cu27||' '||cu28||' '||cu102 -> cu24||' '||cu25||' '||cu26||' '||cu27||' '||cu28||' '||cu102
    'Modified by Lydia 2025/07/21 +地址國籍FA55,CU87 as addrna
    StrSQLa = "Select NA03, Decode(CU05, Null, Nvl(CU04, CU06), CU05||' '||CU88||' '||CU89||' '||CU90) CNAME,CU10,rtrim(cu24||' '||cu25||' '||cu26||' '||cu27||' '||cu28||' '||cu102) addr,CU87 as addrna From Customer, Nation Where CU10=NA01(+) And CU01='" & Mid(Me.Text1.Text, 1, 8) & "' And CU02='" & Mid(Me.Text1.Text, 9, 1) & "' And CU02='0' "
    StrSQLa = StrSQLa & " Union Select NA03,Decode(FA05, Null, Nvl(FA04, FA06), FA05||' '||FA63||' '||FA64||' '||FA65) CNAME, FA10,rtrim(fa18||' '||fa19||' '||fa20||' '||fa21||' '||fa22||' '||fa70) as addr,FA55 as addrna From Fagent, Nation Where FA10=NA01(+) And FA01='" & Mid(Me.Text1.Text, 1, 8) & "' And FA02='" & Mid(Me.Text1.Text, 9, 1) & "' And FA02='0' "

    rsA.CursorLocation = adUseClient
    rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
    If rsA.RecordCount > 0 Then
         'Added by Morgan 2014/1/24
         '澳洲不可輸入受款人名稱的3,4欄位
         'Modified by Lydia 2015/03/30 名稱只秀3欄
         If rsA.Fields("CU10") = "015" Then
            'Me.Text15.Enabled = False
            'Modified by Lydia 2017/06/19 不顯示
            'Me.Text2.Enabled = False
            Me.Text2.Visible = False
         Else
            'Me.Text15.Enabled = True
            'Modified by Lydia 2017/06/19 不顯示
            'Me.Text2.Enabled = True
            Me.Text2.Visible = True
         End If
         'END 2014/1/24
         
        Me.Text4.Text = "" & rsA.Fields(0).Value
        Me.Text5.Text = "" & rsA.Fields(1).Value
'        Me.Text6.Text = "" & rsA.Fields(2).Value
'        Me.Text7.Text = "" & rsA.Fields(3).Value
        Frmacc0000.Toolbar1.Buttons.Item(5).Enabled = True
        'Added by Lydia 2017/08/07 列印對象名稱、地址
        Me.Text16.Text = Trim("" & rsA.Fields("cname"))
        Me.Text17.Text = Trim("" & rsA.Fields("addr"))
        'Added by Lydia 2025/07/21
        Me.txtFAddr.Text = Trim("" & rsA.Fields("addr")) '受款人英文地址：不會被列印對象取代
        If Me.txtA2225.Text = "" Then
           Me.txtA2225.Text = Mid(IIf("" & rsA.Fields("addrna") <> "", "" & rsA.Fields("addrna"), "" & rsA.Fields("cu10")), 1, 3)
        End If
        'end 2025/07/21
    Else
        Me.Text4.Text = ""
        Me.Text5.Text = ""
        Me.Text6.Text = ""
        Me.Text7.Text = ""
        'Added by Lydia 2017/08/07
        Me.Text16.Text = ""
        Me.Text17.Text = ""
        'Added by Lydia 2025/07/21
        Me.txtFAddr.Text = ""
    End If
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing
    'Added by Lydia 2025/07/21
    If Trim(txtA2225.Text) = "" Then
       lblA2225Name.Caption = ""
    Else
       lblA2225Name.Caption = GetNationValue(txtA2225.Text, "2")
    End If
    'end 2025/07/21
    
Exit Sub
ErrorHandler:
    MsgBox Err.Description
End Sub

'*************************************************
'  顯示筆數
'
'*************************************************
Public Sub RecordShow()
    
On Error GoTo ErrorHandler
    If adoacc220.RecordCount = 0 Then
        Exit Sub
    End If
    CountShow adoacc220.Bookmark, adoacc220.RecordCount
Exit Sub
ErrorHandler:
    MsgBox Err.Description
End Sub

'*************************************************
'  重新整理國外請款資料
'
'*************************************************
Public Sub Acc220Refresh()
On Error GoTo Checking
    If adoacc220.State = adStateOpen Then
        adoacc220.Close
    End If
    'Modify By Cheng 2003/08/07
'    strSQL = "Select * From ACC220 Order By a2201 "
    strSql = "Select * From ACC220 Order By a2201, a2202 "
    adoacc220.CursorLocation = adUseClient
'    adoacc220.MaxRecords = intMax
    adoacc220.Open strSql, adoTaie, adOpenDynamic, adLockBatchOptimistic
'    Do While "" & adoacc220("a2201").Value & adoacc220("a2202").Value <= Left(Me.Text1.Text & "000000000", 9) & Me.Combo2.Text
'        If "" & adoacc220("a2201").Value & adoacc220("a2202").Value = Left(Me.Text1.Text & "000000000", 9) & Me.Combo2.Text Then Exit Do
'        adoacc220.MoveNext
'    Loop

    'Modify by Amy 2014/07/11 查Y54015 出現EOF、BOF錯誤
'    Do While "" & adoacc220("a2201").Value <= Left(Me.Text1.Text & "000000000", 9)
'        If "" & adoacc220("a2201").Value = Left(Me.Text1.Text & "000000000", 9) Then Exit Do
'        adoacc220.MoveNext
'    Loop
    With adoacc220
        If .RecordCount > 0 Then
            .Find "a2201 ='" & Left(Me.Text1.Text & "000000000", 9) & "'", 0, adSearchForward, 1
            If .EOF = True Then
                MsgBox MsgText(28), , MsgText(5)
                .MoveFirst
            End If
        End If
    End With
    'end 2014/07/11
    
Checking:
    If Err.Number = 0 Then
        Exit Sub
    End If
    MsgBox Err.Description, , MsgText(5)
End Sub

Private Sub Text20_GotFocus()
    TextInverse Me.Text20
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text20_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text3_GotFocus()
    TextInverse Me.Text3
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text3_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text8_GotFocus()
    TextInverse Me.Text8
    CloseIme 'Added by Lydia 2015/10/06 限輸入英文或數字
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text8_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text9_GotFocus()
    TextInverse Me.Text9
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text9_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub
'Added by Lydia 2015/03/24
'Modified by Lydia 2015/03/27 調整欄位與檢查字數控制,+媒體備註,台一備註
Private Sub Combo3_GotFocus()
    Me.Combo3.SelStart = 0
    Me.Combo3.SelLength = Len(Me.Combo2.Text)
End Sub

Private Sub Combo3_KeyUp(KeyCode As Integer, Shift As Integer)
    KeyEnter KeyCode
End Sub
Private Sub Combo3_KeyPress(KeyAscii As Integer)
    KeyAscii = UpperCase(KeyAscii)
End Sub
Private Sub Combo3_Validate(Cancel As Boolean)
Dim bolC3 As Boolean, a1 As Integer
  If Combo3.Text <> "" Then
    For a1 = 0 To Combo3.ListCount - 1
        If Combo3.Text = Combo3.List(a1) Then
           bolC3 = True: Exit For
        End If
    Next a1
    If bolC3 = False Then
       MsgBox "請選擇手續費方式!!", vbExclamation
       Cancel = True
       Combo3.SetFocus
    End If
  End If
End Sub

Private Sub Text6_GotFocus()
    TextInverse Me.Text6
End Sub

'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text6_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub
Private Sub Text7_GotFocus()
    TextInverse Me.Text7
End Sub

'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text7_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text7_Validate(Cancel As Boolean)

    If Text7.Text <> "" Then
       'Modified by Lydia 2025/07/21 改成模組
       'strExc(3) = "select na60,na03 from nation where na01=" & CNULL(Text7.Text)
       'intI = 1
       'Set RsTemp = ClsLawReadRstMsg(intI, strExc(3))
       'If intI = 0 Or IsNull(RsTemp.Fields(0)) Then
       '   MsgBox "請輸入受款人國籍或該國未設定央行國家代碼!!", vbExclamation
       strExc(3) = GetNationValue(Text7.Text, "1")
       If Trim(strExc(3)) = "" Then
       'end 2025/07/21
          Text7.SetFocus
          Text7_GotFocus
          Cancel = True
       Else
          'Modified by Lydia 2025/07/21
          'lblNation.Caption = "" & RsTemp.Fields(1)
          lblNation.Caption = strExc(3)
          If Trim(txtA2225) = "" Then
             txtA2225.Text = Text7.Text
             Call txtA2225_Validate(tmpBol)
          End If
          'end 2025/07/21
       End If
    Else
       lblNation.Caption = ""
    End If
End Sub
Private Sub Text21_GotFocus()
    TextInverse Me.Text21
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text21_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

'Modified by Lydia 2017/09/12 改成Public
Public Sub Text21_Validate(Cancel As Boolean)
Dim strA As String
   '針對台銀媒體檔格式,受款人名稱+地址最長140字
   If Text21.Text <> "" Then
      Text21.Text = Trim(Text21.Text) 'Added by Lydia 2025/09/10
      strA = Trim(Text3.Text) & IIf(Len(Text9) > 0, " " & Trim(Text9), "") & IIf(Len(Text2) > 0, " " & Trim(Text2), "")
      strA = strA & " " & Trim(Text21)
      If GetTextLength(strA) > 140 Then
         MsgBox "受款人名稱+短地址最長140字,請修改!!", vbExclamation
         Cancel = True
      End If
      'Added by Lydia 2025/09/10 排除非英數字，但包含特定符號
      strA = PUB_GetSimpleName(Text21, , True, True)
      If strA <> Text21 Then
         MsgBox "短地址有不支援的字元：" & vbCrLf & vbCrLf & "輸入：" & Text21 & vbCrLf & vbCrLf & "輸出：" & strA
         Cancel = True
      End If
      'end 2025/09/10
   End If
   
End Sub

Private Sub Text21_LostFocus()
Dim Cancel As Boolean

  Text21_Validate (Cancel)
End Sub
Private Sub Text22_GotFocus()
    TextInverse Me.Text22
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text22_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub

Private Sub Text23_GotFocus()
    TextInverse Me.Text23
End Sub
'Modified by Lydia 2021/12/02 改成Form 2.0; KeyCode As Integer=>MSForms.ReturnInteger
Private Sub Text23_KeyUp(KeyCode As MSForms.ReturnInteger, Shift As Integer)
    'Modified by Lydia 2021/12/02 +val()
    KeyEnter Val(KeyCode)
End Sub
'end 2015/03/27

'Added by Lydia 2017/09/12
Private Sub Text18_Validate(Cancel As Boolean)
   If Trim(Text18.Text) <> "" And InStr(Trim(UCase(Text18.Text)), "SWIFT") > 0 Then
      If InStr(Text18.Text, ":") = 0 Then
          MsgBox "中間銀行之swift code 需加上"":""以利程式辨別.", vbCritical
          Text13.SetFocus
          Cancel = True
          Exit Sub
      End If
   End If
End Sub

Private Sub Text19_Validate(Cancel As Boolean)
   If Trim(Text19.Text) <> "" And InStr(Trim(UCase(Text19.Text)), "SWIFT") > 0 Then
      If InStr(Text19.Text, ":") = 0 Then
          MsgBox "中間銀行之swift code 需加上"":""以利程式辨別.", vbCritical
          Text13.SetFocus
          Cancel = True
          Exit Sub
      End If
   End If
End Sub

Private Sub Text20_Validate(Cancel As Boolean)
   If Trim(Text20.Text) <> "" And InStr(Trim(UCase(Text20.Text)), "SWIFT") > 0 Then
      If InStr(Text20.Text, ":") = 0 Then
          MsgBox "中間銀行之swift code 需加上"":""以利程式辨別.", vbCritical
          Text13.SetFocus
          Cancel = True
          Exit Sub
      End If
   End If
End Sub
'end 2017/09/12

'Added by Lydia 2020/05/28
Public Sub Text15_Validate(Cancel As Boolean)
Dim strTmp As String
    If Text15.Text <> "" Then
        strTmp = PUB_GetSimpleName(Text15.Text, True, True)
        If strTmp <> Text15.Text Then
            MsgBox "請輸入英數字！", vbCritical, "檢核資料"
            Text15.SetFocus
            Text15_GotFocus
            Cancel = True
        End If
    End If
End Sub

'Added by Lydia 2025/07/21
Private Sub txtA2224_GotFocus()
   TextInverse txtA2224
End Sub

Private Sub txtA2224_LostFocus()
Dim bolTmp As Boolean

   Call txtA2224_Validate(bolTmp)
End Sub

Private Sub txtA2224_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
   If Button = 2 Then Forms(0).PopupMenu2 txtA2224
End Sub

Public Sub txtA2224_Validate(Cancel As Boolean)
Dim strExcept As String, strTmp As String

   'Added by Lydia 2025/08/06
   Dim strNowAddress As String, strNowType As String
   If Trim(Text21) <> "" Then
      'Modified by Lydia 2025/09/10
      'strNowAddress = UCase(CheckFstSpec(PUB_GetSimpleName(Text21, True)))
      Text21 = Trim(Text21)
      strNowAddress = UCase(CheckFstSpec(PUB_GetSimpleName(Text21, , True, True)))
      'end 2025/09/10
      strNowType = "受款人短地址"
   Else
      'Modified by Lydia 2025/09/10
      'strNowAddress = UCase(CheckFstSpec(PUB_GetSimpleName(txtFAddr, True)))
      txtFAddr = Trim(txtFAddr)
      strNowAddress = UCase(CheckFstSpec(PUB_GetSimpleName(txtFAddr, , True, True)))
      'end 2025/09/10
      strNowType = "受款人地址"
   End If
   'end 2025/08/06
   '參考DHL的判斷(frm060330)城邦國家(特別行政區)：香港、澳門、新加坡、摩納哥
   strExcept = "HONG KONG,MACAU,SINGAPORE,MONACO,"
   'Modified by Lydia 2025/08/06
   'If Trim(txtFAddr) <> "" Then
   If Trim(strNowAddress) <> "" Then
      'Modified by Lydia 2025/09/10
      'strTmp = UCase(CheckFstSpec(PUB_GetSimpleName(txtA2224, True)))
      strTmp = UCase(CheckFstSpec(PUB_GetSimpleName(txtA2224, , True, True)))
      'Moddified by Lydia 2025/08/06 如果有受款人短地址，改用短地址判斷。
      'If InStr(UCase(CheckFstSpec(PUB_GetSimpleName(txtFAddr, True))), strTmp) = 0 Then
      '  MsgBox "受款人地址城市不在受款人地址內，請檢查!!"
      If InStr(strNowAddress, strTmp) = 0 Then
         If MsgBox("受款人地址城市不在" & strNowType & "內，是否正確？", vbExclamation + vbYesNo + vbDefaultButton2) = vbNo Then
      'end 2025/08/06
            GoTo EXITSUB
         End If
      Else
         If InStr(strExcept, UCase(strTmp)) = 0 Then
            If lblA2225Name.Caption <> "" And InStr(lblA2225Name.Caption, strTmp) > 0 Then
               If MsgBox("受款人地址城市" & strTmp & "與英文國家名稱相同，若城市名稱不正確請選擇「否」!", vbInformation + vbYesNo + vbDefaultButton2) = vbNo Then
                  GoTo EXITSUB
               End If
            End If
         Else
            If lblA2225Name.Caption <> "" And InStr(lblA2225Name.Caption, strTmp) = 0 Then
               MsgBox "以下受款人地址城市必須國家名稱相同：" & vbCrLf & "城邦國家(特別行政區)：香港、澳門、新加坡、摩納哥", vbCritical
               GoTo EXITSUB
            End If
         End If
      End If
      'Added by Lydia 2025/09/10 排除非英數字
      strTmp = PUB_GetSimpleName(txtA2224, , True)
      If strTmp <> txtA2224 Then
         MsgBox "城市不支援的字元：" & vbCrLf & vbCrLf & "輸入：" & txtA2224 & vbCrLf & vbCrLf & "輸出：" & strTmp
         txtA2224.SetFocus
         txtA2224_GotFocus
         Cancel = True
         Exit Sub
      End If
      'end 2025/09/10
   Else
      If Trim(txtA2224) <> "" Then
          MsgBox "無受款人地址不可輸入城市!!"
          GoTo EXITSUB
      End If
   End If
   
   txtA2224.Text = strTmp
   Exit Sub
   
EXITSUB:
   txtA2224.Text = strTmp
   txtA2224.SetFocus
   txtA2224_GotFocus
   Cancel = True
End Sub

Private Sub txtA2225_GotFocus()
   TextInverse txtA2225
End Sub

Public Sub txtA2225_Validate(Cancel As Boolean)
   If Trim(txtA2225) <> "" Then
       strExc(3) = GetNationValue(txtA2225.Text, "2")
       If Trim(strExc(3)) = "" Then
          txtA2225.SetFocus
          txtA2225_GotFocus
          Cancel = True
       Else
          lblA2225Name.Caption = strExc(3)
       End If
   Else
       lblA2225Name.Caption = ""
   End If
End Sub
Private Function GetNationValue(ByVal pNA01 As String, ByVal pType As String) As String
Dim strQ As String, intQ As Integer
Dim rsQuery As New ADODB.Recordset
   
   If pNA01 = "" Or pType = "" Then Exit Function
   GetNationValue = ""
   strQ = "select " & IIf(pType = "1", "NA03", "NA80") & " from nation where na01='" & pNA01 & "' and nvl(na60,'N')<>'N' " & IIf(pType = "2", " and na80 is not null ", "")
   intQ = 1
   Set rsQuery = ClsLawReadRstMsg(intQ, strQ)
   If intQ = 0 Then
       MsgBox "請輸入" & IIf(pType = "1", "受款人", "受款人地址") & "國籍或該國未設定央行國家代碼" & IIf(pType = "2", "或華銀結匯國家名稱", "") & "!!", vbExclamation
   Else
       GetNationValue = "" & rsQuery.Fields(0)
   End If
   Set rsQuery = Nothing
End Function

'Added by Lydia 2025/10/17
Private Sub txtA2226_GotFocus()
   TextInverse txtA2226
End Sub

Private Sub txtA2226_KeyPress(KeyAscii As MSForms.ReturnInteger)
  KeyAscii = UpperCase(KeyAscii)
End Sub

Private Sub txtA2226_Validate(Cancel As Boolean)
  If Trim(txtA2226) <> "" And txtA2226 <> "Y" And txtA2226 <> "N" Then
      MsgBox "是否為IBAN，請輸入Y或N!!", vbCritical
      Cancel = True
  End If
End Sub

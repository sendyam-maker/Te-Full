VERSION 5.00
Object = "{0D452EE1-E08F-101A-852E-02608C4D0BB4}#2.0#0"; "FM20.DLL"
Begin VB.Form frm060104_4 
   BorderStyle     =   1  '單線固定
   Caption         =   "外專發文 - 補件期限"
   ClientHeight    =   5796
   ClientLeft      =   1188
   ClientTop       =   972
   ClientWidth     =   7092
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   ScaleHeight     =   5796
   ScaleWidth      =   7092
   Begin VB.Frame Frame1 
      BorderStyle     =   0  '沒有框線
      Caption         =   "Frame1"
      Height          =   5145
      Left            =   5970
      TabIndex        =   65
      Top             =   570
      Width           =   1005
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   0
         Left            =   0
         MaxLength       =   8
         TabIndex        =   85
         Top             =   225
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   1
         Left            =   0
         MaxLength       =   8
         TabIndex        =   84
         Top             =   495
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   2
         Left            =   0
         MaxLength       =   8
         TabIndex        =   83
         Top             =   735
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   3
         Left            =   0
         MaxLength       =   8
         TabIndex        =   82
         Top             =   975
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   4
         Left            =   0
         MaxLength       =   8
         TabIndex        =   81
         Top             =   1215
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   5
         Left            =   0
         MaxLength       =   8
         TabIndex        =   80
         Top             =   1455
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   6
         Left            =   0
         MaxLength       =   8
         TabIndex        =   79
         Top             =   1695
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   7
         Left            =   0
         MaxLength       =   8
         TabIndex        =   78
         Top             =   1935
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   8
         Left            =   0
         MaxLength       =   8
         TabIndex        =   77
         Top             =   2175
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   9
         Left            =   0
         MaxLength       =   8
         TabIndex        =   76
         Top             =   2415
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   10
         Left            =   0
         MaxLength       =   8
         TabIndex        =   75
         Top             =   2655
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   11
         Left            =   0
         MaxLength       =   8
         TabIndex        =   74
         Top             =   2895
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   12
         Left            =   0
         MaxLength       =   8
         TabIndex        =   73
         Top             =   3135
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   13
         Left            =   0
         MaxLength       =   8
         TabIndex        =   72
         Top             =   3375
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   14
         Left            =   0
         MaxLength       =   8
         TabIndex        =   71
         Top             =   3615
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   15
         Left            =   0
         MaxLength       =   8
         TabIndex        =   70
         Top             =   3855
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   16
         Left            =   0
         MaxLength       =   8
         TabIndex        =   69
         Top             =   4095
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   17
         Left            =   0
         MaxLength       =   8
         TabIndex        =   68
         Top             =   4335
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   18
         Left            =   0
         MaxLength       =   8
         TabIndex        =   67
         Top             =   4575
         Width           =   870
      End
      Begin VB.TextBox Text3 
         Height          =   285
         Index           =   19
         Left            =   0
         MaxLength       =   8
         TabIndex        =   66
         Top             =   4815
         Width           =   870
      End
      Begin VB.Label Label17 
         AutoSize        =   -1  'True
         Caption         =   "約定期限"
         Height          =   180
         Index           =   3
         Left            =   60
         TabIndex        =   86
         Top             =   0
         Width           =   720
      End
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   0
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   2
      Top             =   810
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   1
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   5
      Top             =   1080
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   2
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   8
      Top             =   1320
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   3
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   11
      Top             =   1560
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   4
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   14
      Top             =   1800
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   5
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   17
      Top             =   2040
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   6
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   20
      Top             =   2280
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   7
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   23
      Top             =   2520
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   8
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   26
      Top             =   2760
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   9
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   29
      Top             =   3000
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   10
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   32
      Top             =   3240
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   11
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   35
      Top             =   3480
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   12
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   38
      Top             =   3720
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   13
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   41
      Top             =   3960
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   14
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   44
      Top             =   4200
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   15
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   47
      Top             =   4440
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   16
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   50
      Top             =   4680
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   17
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   53
      Top             =   4920
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   18
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   56
      Top             =   5160
      Width           =   870
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   19
      Left            =   5085
      MaxLength       =   8
      TabIndex        =   59
      Top             =   5400
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   0
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   1
      Top             =   810
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   1
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   4
      Top             =   1080
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   2
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   7
      Top             =   1320
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   3
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   10
      Top             =   1560
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   4
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   13
      Top             =   1800
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   5
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   16
      Top             =   2040
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   6
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   19
      Top             =   2280
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   7
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   22
      Top             =   2520
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   8
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   25
      Top             =   2760
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   9
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   28
      Top             =   3000
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   10
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   31
      Top             =   3240
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   11
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   34
      Top             =   3480
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   12
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   37
      Top             =   3720
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   13
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   40
      Top             =   3960
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   14
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   43
      Top             =   4200
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   15
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   46
      Top             =   4440
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   16
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   49
      Top             =   4680
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   17
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   52
      Top             =   4920
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   18
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   55
      Top             =   5160
      Width           =   870
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   19
      Left            =   4230
      MaxLength       =   8
      TabIndex        =   58
      Top             =   5400
      Width           =   870
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "確定(&O)"
      Default         =   -1  'True
      Height          =   400
      Index           =   0
      Left            =   4455
      TabIndex        =   60
      Top             =   70
      Width           =   800
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "回前畫面(&U)"
      CausesValidation=   0   'False
      Height          =   400
      Index           =   1
      Left            =   5280
      TabIndex        =   61
      Top             =   70
      Width           =   1200
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   0
      Left            =   90
      TabIndex        =   0
      Top             =   810
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   1
      Left            =   90
      TabIndex        =   3
      Top             =   1080
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   2
      Left            =   90
      TabIndex        =   6
      Top             =   1320
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   3
      Left            =   90
      TabIndex        =   9
      Top             =   1560
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   4
      Left            =   90
      TabIndex        =   12
      Top             =   1800
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   5
      Left            =   90
      TabIndex        =   15
      Top             =   2040
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   6
      Left            =   90
      TabIndex        =   18
      Top             =   2280
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   7
      Left            =   90
      TabIndex        =   21
      Top             =   2520
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   8
      Left            =   90
      TabIndex        =   24
      Top             =   2760
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   9
      Left            =   90
      TabIndex        =   27
      Top             =   3000
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   10
      Left            =   90
      TabIndex        =   30
      Top             =   3240
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   11
      Left            =   90
      TabIndex        =   33
      Top             =   3480
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   12
      Left            =   90
      TabIndex        =   36
      Top             =   3720
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   13
      Left            =   90
      TabIndex        =   39
      Top             =   3960
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   14
      Left            =   90
      TabIndex        =   42
      Top             =   4200
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   15
      Left            =   90
      TabIndex        =   45
      Top             =   4440
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   16
      Left            =   90
      TabIndex        =   48
      Top             =   4680
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   17
      Left            =   90
      TabIndex        =   51
      Top             =   4920
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   18
      Left            =   90
      TabIndex        =   54
      Top             =   5160
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo1 
      Height          =   300
      Index           =   19
      Left            =   90
      TabIndex        =   57
      Top             =   5400
      Width           =   4155
      VariousPropertyBits=   746604571
      DisplayStyle    =   3
      Size            =   "7329;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin VB.Label Label17 
      AutoSize        =   -1  'True
      Caption         =   "本所期限"
      Height          =   195
      Index           =   0
      Left            =   4230
      TabIndex        =   64
      Top             =   570
      Width           =   735
   End
   Begin VB.Label Label17 
      AutoSize        =   -1  'True
      Caption         =   "法定期限"
      Height          =   195
      Index           =   1
      Left            =   5085
      TabIndex        =   63
      Top             =   570
      Width           =   735
   End
   Begin VB.Label Label17 
      AutoSize        =   -1  'True
      Caption         =   " 補件內容"
      Height          =   195
      Index           =   2
      Left            =   165
      TabIndex        =   62
      Top             =   570
      Width           =   780
   End
End
Attribute VB_Name = "frm060104_4"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'Memo By Sindy 2021/11/15 Form2.0已修改
'Memo By Morgan 2012/12/10 智權人員欄已修改
'2010/12/6 memo by sonia 員工編號欄已修改
'Memo by Morgan2010/8/12 日期欄已修改
Option Explicit

Dim strReceiveNo As String, intWhere As Integer, iSitu As Integer
Dim pa(1 To 4) As String
'Add by Morgan 2006/4/27
Dim oCallForm As Form '呼叫的Form
Dim m_CP10 As String
Dim m_CP27 As String
Dim m_Date1 As String, m_Date2 As String
Dim m_Date3 As String 'Add By Sindy 2021/6/24
Dim m_HasPriDate As Boolean
Dim m_pAgreeOnDate As String 'Modify By Sindy 2021/4/27


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' 設定本所期限及法定期限
' Input :  strDate1 ==> 本所期限
'          strDate2 ==> 法定期限
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Modify By Sindy 2021/4/27 + , ByVal strDate3 As String
Public Sub SetData(ByVal strDate1 As String, ByVal strDate2 As String, ByVal strDate3 As String)
   
   strDate1 = TransDate(strDate1, 1)
   strDate2 = TransDate(strDate2, 1)
   strDate3 = TransDate(strDate3, 1)
   m_Date1 = strDate1
   m_Date2 = strDate2
   m_Date3 = strDate3 'm_pAgreeOnDate = strDate3
   
   '不預設,改點選時才設
'   Dim oText As TextBox
'   For Each oText In Text1
'      oText = StrDate1
'   Next
'   For Each oText In Text2
'      oText = StrDate2
'   Next
End Sub

Private Sub cmdOK_Click(Index As Integer)
   If Index = 0 Then
      If ChkNull = True Then
         Exit Sub
      Else
         'Added by Morgan 2012/5/30
         '若新型未輸入優先權資料時檢查有無點選優先權證明文件
         If m_CP10 = "102" And m_HasPriDate = False Then
            If CheckPriPaper = True Then
               If MsgBox("本案並未輸入優先權資料但卻有點選優先權證明文件，請確認期限是否正確?", vbYesNo + vbDefaultButton2) = vbNo Then
                  Exit Sub
               End If
            End If
         End If
         'end 2012/5/30
         
         If FormSave = False Then
            MsgBox "存檔失敗，請洽系統管理員 !", vbCritical: Exit Sub
         End If
      End If
   End If
   
   oCallForm.Show
   Unload Me
End Sub

Private Function CheckPriPaper() As Boolean
   Dim oCombo As Object
   
   For Each oCombo In Combo1
      If InStr(oCombo.Text, "優先權證明文件") > 0 Then
         CheckPriPaper = True
         Exit For
      End If
   Next
End Function

Private Sub Combo1_Click(Index As Integer)
   Dim strDate1 As String, strDate2 As String
   '2008/1/22 ADD BY SONIA
   Dim oCombo As Object
   Dim i As Integer
   '2008/1/22 END
   
   If Me.Visible = False Then Exit Sub 'Added by Morgan 2022/1/13 因2.0物件在 Form Load 設定原期限時會觸發此事件導致期限被覆蓋(清除)
   
   If m_CP27 <> "" And InStr(Combo1(Index).Text, "寄存證明") > 0 Then
      'Added by Morgan 2012/10/15(即刻啟用)
      '102新法：寄存證明法定期限=申請日+4個月或最早優先權日+16個月
      'strDate1 = CompDate(1, 3, m_CP27)
      strDate1 = CompDate(1, 4, m_CP27)
      strExc(1) = PUB_GetFirstPriDate(pa())
      If strExc(1) <> "" Then
         strExc(2) = CompDate(1, 16, strExc(1))
         If strDate1 < strExc(2) Then
            strDate1 = strExc(2)
         End If
      End If
      'end 2012/10/15
      
      'Modified by Morgan 2014/11/20 外專改回舊規則
      ''Added by Morgan 2014/10/29
      'If strSrvDate(1) >= 台灣案所限新規則啟用日 Then
      '   StrDate2 = PUB_GetOurDeadline(strDate1)
      'Else
      ''end 2014/10/29
      
      'Added by Morgan 2019/7/11 外專台灣案所限以改工作天計算
      If strSrvDate(1) >= 外專台灣案所限新規則啟用日 Then
         'Modify By Sindy 2021/4/27 + m_pAgreeOnDate
         strDate2 = PUB_GetFCPOurDeadline(strDate1, 4, , m_pAgreeOnDate)
      Else
      'end 2019/7/11
      
         strDate2 = CompDate(2, -4, strDate1)
         
      End If 'Added by Morgan 2019/7/11
      
      'End If 'Added by Morgan 2014/10/29
      'end 2014/11/20
      
      Text1(Index) = TransDate(strDate2, 1)
      Text2(Index) = TransDate(strDate1, 1)
      Text3(Index) = TransDate(m_pAgreeOnDate, 1) 'Add By Sindy 2021/4/27
      
   'Added by Morgan 2012/10/29(102/1/1啟用)
   '102新法：優先權證明文件法定期限=最早優先權日+16個月(設計+10個月)
   ElseIf DBDATE(m_CP27) >= "20130101" And InStr(Combo1(Index).Text, "優先權證明文件") > 0 Then
      'Modified by Morgan 2024/4/11 改判斷專利種類
      'strExc(3) = PUB_GetFirstPriDate(pa(), strExc(4))
      strExc(5) = ""
      strExc(3) = PUB_GetFirstPriDate(pa(), strExc(4), strExc(5))
      'end 2024/4/11
      If strExc(3) <> "" Then
         'Modified by Morgan 2013/3/27 +125衍生設計
         'Modified by Morgan 2024/4/11 改判斷專利種類，因為有可是事後補文件，相關收文號非申請程序。 Ex:FCP-071203--Winfrey
         'If m_CP10 = "103" Or m_CP10 = "125" Or strExc(4) = "2" Then
         If strExc(5) = "3" Or strExc(4) = "2" Then
         'end 2024/4/11
            strDate1 = CompDate(1, 10, strExc(3))
         Else
            strDate1 = CompDate(1, 16, strExc(3))
         End If
      End If
      
      'Modified by Morgan 2014/11/20 外專改回舊規則
      ''Added by Morgan 2014/10/29
      'If strSrvDate(1) >= 台灣案所限新規則啟用日 Then
      '   StrDate2 = PUB_GetOurDeadline(strDate1)
      'Else
      ''end 2014/10/29
      
      'Added by Morgan 2019/7/11 外專台灣案所限以改工作天計算
      If strSrvDate(1) >= 外專台灣案所限新規則啟用日 Then
         'Modify By Sindy 2021/4/27 + m_pAgreeOnDate
         strDate2 = PUB_GetFCPOurDeadline(strDate1, 4, , m_pAgreeOnDate)
      Else
      'end 2019/7/11
      
         strDate2 = CompDate(2, -4, strDate1)
      
      End If 'Added by Morgan 2019/7/11
      
      'End If 'Added by Morgan 2014/10/29
      'end 2014/11/20
      
      Text1(Index) = TransDate(strDate2, 1)
      Text2(Index) = TransDate(strDate1, 1)
      Text3(Index) = TransDate(m_pAgreeOnDate, 1) 'Add By Sindy 2021/4/27
   'End 2012/10/29
   
   Else
      Text1(Index) = m_Date1
      Text2(Index) = m_Date2
      Text3(Index) = m_Date3 'm_pAgreeOnDate 'Add By Sindy 2021/4/27
   End If
   
'Removed by Morgan 2012/5/30 移到load並改判斷有主張優先權(有pridate)--靜芳
'   '2008/1/22 ADD BY SONIA 新型申請發文時只要有點選到優先權證明文件,則所有文件期限都改為法定期限=發文日+4個月, 本所期限=法定期限-4天
'   If m_CP10 = "102" And m_CP27 <> "" And InStr(Combo1(Index).Text, "優先權證明文件") > 0 Then
'      strDate1 = CompDate(1, 4, m_CP27)
'      StrDate2 = CompDate(2, -4, strDate1)
'      SetData StrDate2, strDate1
'      Text1(Index) = m_Date1
'      Text2(Index) = m_Date2
'      i = 0
'      Do While i <= 19
'         If Text1(i) <> "" Then
'            Text1(i) = m_Date1
'            Text2(i) = m_Date2
'         End If
'         i = i + 1
'      Loop
'   End If
'   '2008/1/22 END
'end 2012/5/30
End Sub

'Modify by Morgan 2006/5/1 改寫
Private Sub Form_Load()

   Dim i As Integer, strTmp As String
   Dim oCombo As Object, oText As TextBox
   
   MoveFormToCenter Me
   intWhere = 國外_FC
   
   'Add By Sindy 2021/4/29
   If strSrvDate(1) >= 外專台灣案約定期限啟用日 Then
      Frame1.Visible = True
   Else
      Frame1.Visible = False
   End If
   '2021/4/29 END
   
   Select Case strExc(0)
      Case "frm060104_2"
         Set oCallForm = frm060104_2
      Case "frm060104_3"
         Set oCallForm = frm060104_3
   End Select
   
   pa(1) = strExc(1)
   pa(2) = strExc(2)
   pa(3) = strExc(3)
   pa(4) = strExc(4)
   m_CP10 = strExc(5)
   strReceiveNo = strExc(6)
   m_CP27 = strExc(7)
   
   For Each oCombo In Combo1
      PUB_SetCombo202 oCombo, m_CP10
   Next

   'Modified by Morgan 2012/10/15 +231寄存證明
   'Modify By Sindy 2021/4/27 +,NP23
   strExc(0) = "SELECT NP08,NP09,NP15,NP23 FROM NEXTPROGRESS WHERE NP01='" & strReceiveNo & _
      "' AND NP07 in(" & 補文件 & ",231) AND (NP06 IS NULL OR NP06='')"
      
   intI = 1
   Set RsTemp = ClsLawReadRstMsg(intI, strExc(0)) 'edit by nickc 2007/02/05 不用 dll 了 objLawDll.ReadRstMsg(intI, strExc(0))
   With RsTemp
   If intI = 1 Then
      i = 0
      Do While Not .EOF
         If Not IsNull(.Fields(0)) Then Text1(i) = TransDate(.Fields(0), 1)
         If Not IsNull(.Fields(1)) Then Text2(i) = TransDate(.Fields(1), 1)
         If Not IsNull(.Fields(3)) Then Text3(i) = TransDate(.Fields(3), 1) 'Add By Sindy 2021/4/27
         If Not IsNull(.Fields(2)) Then Combo1(i) = .Fields(2)
         i = i + 1
         .MoveNext
      Loop
   End If
   End With
   
   Dim strDate1 As String
   Dim strDate2 As String
   
   '有發文日
   If m_CP27 <> Empty Then
      '法定期限=發文日+4個月, 本所期限=法定期限-4天 <= 新案發文
      'Modified by Morgan 2013/6/18 +125衍生設計
      If (m_CP10 >= "101" And m_CP10 <= "105") Or m_CP10 = "125" Then
      
         '2007/8/3 MODIFY BY SONIA 新型申請期限改掛發文日當日起2個月
         'StrDate1 = CompDate(1, 4, m_CP27)
         If m_CP10 = "102" Then
            'Modified by Morgan 2012/5/30
            'strDate1 = CompDate(1, 2, m_CP27)
            '有主張優先權的也是+4個月
            strExc(0) = "select 1 from pridate where pd01='" & pa(1) & "' and pd02='" & pa(2) & "' and pd03='" & pa(3) & "' and pd04='" & pa(4) & "'"
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
            If intI = 1 Then
               m_HasPriDate = True
               'Modified by Morgan 2013/7/31 不管有沒有主張優先權都 2 個月--靜芳
               'strDate1 = CompDate(1, 4, m_CP27)
               strDate1 = CompDate(1, 2, m_CP27)
               'end 2013/7/31
            Else
               strDate1 = CompDate(1, 2, m_CP27)
            End If
         Else
            strDate1 = CompDate(1, 4, m_CP27)
         End If
         '2007/8/3 END
         
         'Modified by Morgan 2014/11/20 外專改回舊規則
         ''Added by Morgan 2014/10/29
         'If strSrvDate(1) >= 台灣案所限新規則啟用日 Then
         '   StrDate2 = PUB_GetOurDeadline(strDate1)
         'Else
         ''end 2014/10/29
         
         'Added by Morgan 2019/7/11 外專台灣案所限以改工作天計算
         If strSrvDate(1) >= 外專台灣案所限新規則啟用日 Then
            'Modify By Sindy 2021/4/27 + m_pAgreeOnDate
            strDate2 = PUB_GetFCPOurDeadline(strDate1, 4, , m_pAgreeOnDate)
         Else
         'end 2019/7/11
         
            strDate2 = CompDate(2, -4, strDate1)
            
         End If 'Added by Morgan 2019/7/11
         
         'End If 'Added by Morgan 2014/10/29
         'end 2014/11/20
         
         'Modify By Sindy 2021/4/27 + , m_pAgreeOnDate
         SetData strDate2, strDate1, m_pAgreeOnDate
         
      '法定期限=發文日+20天, 本所期限=法定期限-2天 <= 訴願501, 行政訴訟503, 行政再審504, 行政訴訟上訴507, 抗告509
      ElseIf m_CP10 = "501" Or m_CP10 = "503" Or m_CP10 = "504" Or m_CP10 = "507" Or m_CP10 = "509" Then
         strDate1 = CompDate(2, 20, m_CP27)
         'Modified by Morgan 2014/11/20 外專改回舊規則
         ''Added by Morgan 2014/10/29
         'If strSrvDate(1) >= 台灣案所限新規則啟用日 Then
         '   StrDate2 = PUB_GetOurDeadline(strDate1)
         'Else
         ''end 2014/10/29
         
         'Added by Morgan 2019/7/11 外專台灣案所限以改工作天計算
         If strSrvDate(1) >= 外專台灣案所限新規則啟用日 Then
            'Modify By Sindy 2021/4/27 + m_pAgreeOnDate
            strDate2 = PUB_GetFCPOurDeadline(strDate1, 2, , m_pAgreeOnDate)
         Else
         'end 2019/7/11
      
            strDate2 = CompDate(2, -2, strDate1)
         
         End If 'Added by Morgan 2019/7/11
         
         'End If 'Added by Morgan 2014/10/29
         'end 2014/11/20
         
         'Modify By Sindy 2021/4/27 + , m_pAgreeOnDate
         SetData strDate2, strDate1, m_pAgreeOnDate
         
      End If
      
   End If

End Sub

Private Sub Form_Unload(Cancel As Integer)
   Set frm060104_4 = Nothing
End Sub

Private Function FormSave() As Boolean
 Dim i As Integer, intMax As Long, strTxt(1 To 21) As String, j As Integer
 
 '911105 nick transation
 FormSave = True
 On Error GoTo CheckingErr
 cnnConnection.BeginTrans
 
   'Dim strReceiveNo As String, strSales As String
   'Modified by Morgan 2012/10/15 +231寄存證明
   strTxt(1) = "DELETE FROM NEXTPROGRESS WHERE NP01='" & strReceiveNo & _
      "' AND NP07 in (" & 補文件 & ",231) AND (NP06 IS NULL OR NP06='')"
   '911105 nick transation
   cnnConnection.Execute strTxt(1)
   
   'edit by nickc 2007/02/02 不用 dll 了
   'intMax = objPublicData.GetNextProgressNo
   intMax = GetNextProgressNo
   j = 2
   For i = 0 To 19
      If IsEmptyText(Text1(i)) = False And _
         IsEmptyText(Text2(i)) = False And _
         IsEmptyText(Combo1(i)) = False Then
         'Modified by Morgan 2012/10/15
         '寄存證明改用231
         If InStr(Combo1(i), "寄存證明") > 0 Then
            strExc(1) = "231"
         Else
            strExc(1) = 補文件
         End If
         
         intMax = GetNextProgressNo
         'Modify By Sindy 2021/4/27 + ,NP23:約定期限
         strTxt(j) = "INSERT INTO NEXTPROGRESS (NP01,NP02,NP03,NP04,NP05,NP07,NP08," & _
            "NP09,NP10,NP15,NP22,NP23) VALUES ('" & strReceiveNo & "','" & pa(1) & _
            "','" & pa(2) & "','" & pa(3) & "','" & pa(4) & "'," & strExc(1) & _
            "," & TransDate(Text1(i), 2) & "," & TransDate(Text2(i), 2) & ",'" & _
            PUB_GetFCPSalesNo(pa(1), pa(2), pa(3), pa(4)) & "','" & Combo1(i) & _
            "'," & intMax & "," & CNULL(TransDate(Text3(i), 2)) & ")"
         cnnConnection.Execute strTxt(j)
         j = j + 1
         intMax = intMax + 1
      End If
   Next
   
   '911105 nick transation
   'FormSave = objLawDll.ExecSQL(j - 1, strTxt)
   cnnConnection.CommitTrans
'911105 nick
   Exit Function
CheckingErr:
   cnnConnection.RollbackTrans
   FormSave = False
End Function

Private Function ChkNull() As Boolean
   Dim i As Integer, bolChk As Boolean
   
   ' 90.07.06 modify by louis
   'For i = 0 To 19
   '   If (Text1(i) <> "" And (Text2(i) = "" Or Combo1(i) = "")) Or _
   '      (Text2(i) <> "" And (Text1(i) = "" Or Combo1(i) = "")) Or _
   '      (Combo1(i) <> "" And (Text1(i) = "" Or Text1(i) = "")) Then
   '      bolChk = True
   '      Exit For
   '   End If
   'Next
   For i = 0 To 19
      If IsEmptyText(Combo1(i).Text) = False Then
         'Modify By Sindy 2021/4/27 + Or IsEmptyText(Text3(i).Text) = True
         If IsEmptyText(Text1(i).Text) = True Or IsEmptyText(Text2(i).Text) = True Or _
            (IsEmptyText(Text3(i).Text) = True And Text3(i).Visible = True) Then
            bolChk = True
            Exit For
         End If
      End If
   Next i
   
   If bolChk = True Then
      'Add By Sindy 2021/4/27
      If strSrvDate(1) >= 外專台灣案約定期限啟用日 Then
         MsgBox "本所期限、法定期限、約定期限及備註必須同時輸入 !", vbCritical
      Else
      '2021/4/27 END
         MsgBox "本所期限、法定期限及備註必須同時輸入 !", vbCritical
      End If
      ChkNull = True
   End If
End Function

Private Sub Text1_GotFocus(Index As Integer)
  TextInverse Text1(Index)
End Sub

Private Sub Text1_Validate(Index As Integer, Cancel As Boolean)
   If Text1(Index) <> "" Then
      If Not ChkDate(Text1(Index)) Then
         Cancel = True
         MsgBox "本所期限輸入錯誤！"
         TextInverse Text1(Index)
      End If
   End If
End Sub

Private Sub Text2_GotFocus(Index As Integer)
  TextInverse Text2(Index)
End Sub

Private Sub Text2_Validate(Index As Integer, Cancel As Boolean)
   If Text2(Index) <> "" And Text1(Index) <> "" Then
      'Modify by Morgan 2010/8/12 百年蟲
      'If Not ChkDate(Text2(Index)) Or text1(Index) > Text2(Index) Then
      If Not ChkDate(Text2(Index)) Or Val(Text1(Index)) > Val(Text2(Index)) Then
         MsgBox "期限輸入錯誤！"
         Cancel = True
         TextInverse Text2(Index)
      End If
   ElseIf Text2(Index) <> "" And Text1(Index) = "" Then
      MsgBox "本所期限及法定期限必須同時有值 !", vbCritical
      Cancel = True
      TextInverse Text2(Index)
   ElseIf Text2(Index) = "" And Text1(Index) <> "" Then
      MsgBox "本所期限及法定期限必須同時有值 !", vbCritical
      Cancel = True
      TextInverse Text2(Index)
   End If
End Sub

Private Sub Text3_GotFocus(Index As Integer)
  TextInverse Text3(Index)
End Sub

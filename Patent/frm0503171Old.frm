VERSION 5.00
Object = "{20C62CAE-15DA-101B-B9A8-444553540000}#1.1#0"; "MSMAPI32.OCX"
Begin VB.Form frm0503171Old 
   BorderStyle     =   1  '單線固定
   Caption         =   "客戶案件總簿-紙本作業列印(英/日文格式加Word前使用)***程式不需維護***"
   ClientHeight    =   6510
   ClientLeft      =   3690
   ClientTop       =   1560
   ClientWidth     =   7485
   ControlBox      =   0   'False
   LinkTopic       =   "Form16"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   ScaleHeight     =   6510
   ScaleWidth      =   7485
   Begin VB.CheckBox Check10 
      Caption         =   "Word"
      Enabled         =   0   'False
      Height          =   240
      Index           =   0
      Left            =   5040
      TabIndex        =   63
      Top             =   750
      Width           =   780
   End
   Begin VB.CheckBox Check10 
      Caption         =   "Excel"
      Enabled         =   0   'False
      Height          =   240
      Index           =   1
      Left            =   5880
      TabIndex        =   62
      Top             =   750
      Width           =   780
   End
   Begin VB.TextBox txtMail 
      Height          =   270
      Left            =   1080
      TabIndex        =   9
      Top             =   2205
      Width           =   6270
   End
   Begin MSMAPI.MAPIMessages MAPIMessages1 
      Left            =   7305
      Top             =   525
      _ExtentX        =   1005
      _ExtentY        =   1005
      _Version        =   393216
      AddressEditFieldCount=   1
      AddressModifiable=   0   'False
      AddressResolveUI=   0   'False
      FetchSorted     =   0   'False
      FetchUnreadOnly =   0   'False
   End
   Begin MSMAPI.MAPISession MAPISession1 
      Left            =   7860
      Top             =   90
      _ExtentX        =   1005
      _ExtentY        =   1005
      _Version        =   393216
      DownloadMail    =   -1  'True
      LogonUI         =   -1  'True
      NewSession      =   0   'False
   End
   Begin VB.TextBox txt1 
      Height          =   264
      Index           =   15
      Left            =   1095
      MaxLength       =   1
      TabIndex        =   5
      Top             =   1035
      Width           =   375
   End
   Begin VB.TextBox txt1 
      Height          =   264
      Index           =   10
      Left            =   1080
      MaxLength       =   1
      TabIndex        =   6
      Top             =   1350
      Width           =   375
   End
   Begin VB.Frame Frame2 
      Caption         =   "　　　　　　　　　　　　  標準方式條件(不適用專利群組案件)　　　　　　　　　　　　　　　　 "
      Enabled         =   0   'False
      Height          =   3350
      Left            =   75
      TabIndex        =   38
      Top             =   2535
      Width           =   7275
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   16
         Left            =   2325
         MaxLength       =   1
         TabIndex        =   67
         Top             =   1450
         Width           =   375
      End
      Begin VB.CheckBox Check12 
         Caption         =   "已閉卷或銷卷或核駁"
         Height          =   210
         Left            =   90
         TabIndex        =   66
         Top             =   2070
         Width           =   1920
      End
      Begin VB.CheckBox Check11 
         Caption         =   "已閉卷或銷卷"
         Height          =   210
         Left            =   2070
         TabIndex        =   65
         Top             =   2070
         Width           =   1380
      End
      Begin VB.CheckBox Check9 
         Caption         =   "只印未核准"
         Height          =   210
         Left            =   6030
         TabIndex        =   64
         Top             =   2070
         Width           =   1200
      End
      Begin VB.CheckBox Check8 
         Caption         =   "只印已核准"
         Height          =   210
         Left            =   4770
         TabIndex        =   61
         Top             =   2070
         Width           =   1200
      End
      Begin VB.CheckBox Check7 
         Caption         =   "只印申請案"
         Height          =   210
         Left            =   3510
         TabIndex        =   60
         Top             =   2070
         Width           =   1200
      End
      Begin VB.CheckBox Check6 
         Caption         =   "含銷卷"
         Height          =   210
         Left            =   4410
         TabIndex        =   59
         Top             =   1785
         Value           =   1  '核取
         Width           =   1110
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   6
         Left            =   2370
         MaxLength       =   4
         TabIndex        =   25
         Top             =   1755
         Width           =   800
      End
      Begin VB.CheckBox ChkClose 
         Caption         =   "含閉卷"
         Height          =   210
         Left            =   3285
         TabIndex        =   58
         Top             =   1785
         Value           =   1  '核取
         Width           =   1110
      End
      Begin VB.CheckBox Check5 
         Caption         =   "專用期仍有效的"
         Height          =   210
         Left            =   5535
         TabIndex        =   57
         Top             =   1785
         Width           =   1560
      End
      Begin VB.CheckBox Check2 
         Caption         =   "不含"
         Height          =   210
         Left            =   135
         TabIndex        =   56
         Top             =   2610
         Width           =   675
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   3
         Left            =   1035
         MaxLength       =   7
         TabIndex        =   18
         Top             =   825
         Width           =   800
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   4
         Left            =   2370
         MaxLength       =   7
         TabIndex        =   19
         Top             =   825
         Width           =   800
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   5
         Left            =   1035
         MaxLength       =   4
         TabIndex        =   24
         Top             =   1755
         Width           =   800
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   7
         Left            =   1035
         MaxLength       =   1
         TabIndex        =   22
         Top             =   1170
         Width           =   375
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   8
         Left            =   5610
         MaxLength       =   1
         TabIndex        =   23
         Top             =   1200
         Width           =   375
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   9
         Left            =   1050
         MaxLength       =   1
         TabIndex        =   17
         Top             =   510
         Width           =   375
      End
      Begin VB.CheckBox Check1 
         Caption         =   "全部"
         Height          =   255
         Index           =   0
         Left            =   1035
         TabIndex        =   10
         Top             =   180
         Width           =   705
      End
      Begin VB.CheckBox Check1 
         Caption         =   "專利"
         Height          =   255
         Index           =   1
         Left            =   1725
         TabIndex        =   11
         Top             =   180
         Width           =   705
      End
      Begin VB.CheckBox Check1 
         Caption         =   "商標"
         Height          =   255
         Index           =   2
         Left            =   2415
         TabIndex        =   12
         Top             =   180
         Width           =   705
      End
      Begin VB.CheckBox Check1 
         Caption         =   "著作權"
         Height          =   255
         Index           =   3
         Left            =   3105
         TabIndex        =   13
         Top             =   180
         Width           =   915
      End
      Begin VB.CheckBox Check1 
         Caption         =   "法務"
         Height          =   255
         Index           =   4
         Left            =   4005
         TabIndex        =   14
         Top             =   180
         Width           =   705
      End
      Begin VB.CheckBox Check1 
         Caption         =   "條碼"
         Height          =   255
         Index           =   5
         Left            =   4725
         TabIndex        =   15
         Top             =   180
         Width           =   705
      End
      Begin VB.CheckBox Check1 
         Caption         =   "網域"
         Height          =   255
         Index           =   6
         Left            =   5445
         TabIndex        =   16
         Top             =   180
         Width           =   705
      End
      Begin VB.TextBox txt1 
         Height          =   810
         Index           =   12
         Left            =   1035
         MultiLine       =   -1  'True
         ScrollBars      =   2  '垂直捲軸
         TabIndex        =   26
         Top             =   2340
         Width           =   6075
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   13
         Left            =   4845
         MaxLength       =   7
         TabIndex        =   20
         Top             =   840
         Width           =   800
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   14
         Left            =   6180
         MaxLength       =   7
         TabIndex        =   21
         Top             =   840
         Width           =   800
      End
      Begin VB.TextBox txt1 
         Height          =   264
         Index           =   2
         Left            =   1035
         TabIndex        =   30
         Top             =   165
         Visible         =   0   'False
         Width           =   6060
      End
      Begin VB.Label Label15 
         AutoSize        =   -1  'True
         Caption         =   "商標案件是否輸出指定商品:            (Y:是 僅適用Excel)"
         Height          =   180
         Left            =   45
         TabIndex        =   68
         Top             =   1485
         Width           =   4185
      End
      Begin VB.Label Label2 
         AutoSize        =   -1  'True
         Caption         =   "系統別："
         Height          =   180
         Index           =   0
         Left            =   60
         TabIndex        =   49
         Top             =   210
         Width           =   720
      End
      Begin VB.Label Label4 
         AutoSize        =   -1  'True
         Caption         =   "申請國家："
         Height          =   180
         Left            =   45
         TabIndex        =   48
         Top             =   1785
         Width           =   900
      End
      Begin VB.Label Label6 
         AutoSize        =   -1  'True
         Caption         =   "是否含核駁："
         Height          =   180
         Index           =   0
         Left            =   45
         TabIndex        =   47
         Top             =   1215
         Width           =   1080
      End
      Begin VB.Label Label7 
         AutoSize        =   -1  'True
         Caption         =   "(N:不含)"
         Height          =   180
         Index           =   0
         Left            =   1545
         TabIndex        =   46
         Top             =   1215
         Width           =   645
      End
      Begin VB.Label Label8 
         AutoSize        =   -1  'True
         Caption         =   "國內外是否分開列印:"
         Height          =   180
         Left            =   3885
         TabIndex        =   45
         Top             =   1230
         Width           =   1665
      End
      Begin VB.Label Label9 
         AutoSize        =   -1  'True
         Caption         =   "(Y:分開)"
         Height          =   180
         Left            =   6090
         TabIndex        =   44
         Top             =   1230
         Width           =   645
      End
      Begin VB.Label Label10 
         AutoSize        =   -1  'True
         Caption         =   "輸出順序："
         Height          =   180
         Left            =   60
         TabIndex        =   43
         Top             =   540
         Width           =   900
      End
      Begin VB.Label Label11 
         AutoSize        =   -1  'True
         Caption         =   "(1.本所案號 2.案件名稱 3.申請國家+本所案號 4.申請國家+案件名稱)"
         Height          =   180
         Left            =   1560
         TabIndex        =   42
         Top             =   540
         Width           =   5295
      End
      Begin VB.Line Line2 
         X1              =   2010
         X2              =   2250
         Y1              =   945
         Y2              =   945
      End
      Begin VB.Line Line3 
         X1              =   2010
         X2              =   2250
         Y1              =   1875
         Y2              =   1875
      End
      Begin VB.Label Label2 
         AutoSize        =   -1  'True
         Caption         =   "本所案號："
         Height          =   180
         Index           =   2
         Left            =   45
         TabIndex        =   41
         Top             =   2385
         Width           =   900
      End
      Begin VB.Line Line4 
         X1              =   5820
         X2              =   6060
         Y1              =   960
         Y2              =   960
      End
      Begin VB.Label Label2 
         AutoSize        =   -1  'True
         Caption         =   "收文日期："
         Height          =   180
         Index           =   3
         Left            =   45
         TabIndex        =   40
         Top             =   840
         Width           =   900
      End
      Begin VB.Label Label2 
         AutoSize        =   -1  'True
         Caption         =   "申請日期:"
         Height          =   180
         Index           =   4
         Left            =   3855
         TabIndex        =   39
         Top             =   870
         Width           =   765
      End
   End
   Begin VB.CheckBox Check4 
      Caption         =   "標準方式(請勾選下方各條件)"
      Height          =   240
      Index           =   1
      Left            =   1080
      TabIndex        =   8
      Top             =   1950
      Width           =   3095
   End
   Begin VB.CheckBox Check4 
      Caption         =   "只輸出專利群組案件(勾選時下方各條件無效)"
      Height          =   240
      Index           =   0
      Left            =   1080
      TabIndex        =   7
      Top             =   1680
      Width           =   4065
   End
   Begin VB.CheckBox Check3 
      Caption         =   "電子檔(勾選時，須副總簽字認可)"
      Height          =   240
      Index           =   1
      Left            =   2025
      TabIndex        =   4
      Top             =   750
      Width           =   3030
   End
   Begin VB.CheckBox Check3 
      Caption         =   "紙本"
      Height          =   240
      Index           =   0
      Left            =   1095
      TabIndex        =   3
      Top             =   750
      Width           =   780
   End
   Begin VB.TextBox txt1 
      Height          =   264
      Index           =   11
      Left            =   1095
      MaxLength       =   6
      TabIndex        =   0
      Top             =   90
      Width           =   800
   End
   Begin VB.Frame Frame1 
      Caption         =   "設定"
      Enabled         =   0   'False
      Height          =   600
      Left            =   75
      TabIndex        =   32
      Top             =   5910
      Width           =   4675
      Begin VB.ComboBox Combo1 
         Height          =   300
         Left            =   705
         Style           =   2  '單純下拉式
         TabIndex        =   27
         Top             =   180
         Width           =   3870
      End
      Begin VB.Label Label2 
         Caption         =   "印表機"
         Height          =   315
         Index           =   1
         Left            =   75
         TabIndex        =   33
         Top             =   240
         Width           =   765
      End
   End
   Begin VB.CommandButton cmdok 
      Caption         =   "結束(&X)"
      Height          =   400
      Index           =   1
      Left            =   6540
      TabIndex        =   29
      Top             =   60
      Width           =   756
   End
   Begin VB.CommandButton cmdok 
      Caption         =   "確定(&O)"
      Default         =   -1  'True
      Height          =   400
      Index           =   0
      Left            =   5760
      TabIndex        =   28
      Top             =   60
      Width           =   756
   End
   Begin VB.TextBox txt1 
      Height          =   264
      Index           =   1
      Left            =   2580
      MaxLength       =   9
      TabIndex        =   2
      Top             =   420
      Width           =   1275
   End
   Begin VB.TextBox txt1 
      Height          =   264
      Index           =   0
      Left            =   1095
      MaxLength       =   9
      TabIndex        =   1
      Top             =   420
      Width           =   1275
   End
   Begin VB.Label Lbl_inf 
      AutoSize        =   -1  'True
      Caption         =   "Lbl_inf"
      ForeColor       =   &H00FF0000&
      Height          =   180
      Left            =   4770
      TabIndex        =   69
      Top             =   5910
      Width           =   525
   End
   Begin VB.Label lblCu110 
      AutoSize        =   -1  'True
      BeginProperty Font 
         Name            =   "新細明體"
         Size            =   11.25
         Charset         =   136
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   225
      Left            =   3930
      TabIndex        =   55
      Top             =   450
      Width           =   75
   End
   Begin VB.Label Label14 
      AutoSize        =   -1  'True
      Caption         =   "E-Mail："
      Height          =   180
      Left            =   180
      TabIndex        =   54
      Top             =   2235
      Width           =   660
   End
   Begin VB.Label Label12 
      AutoSize        =   -1  'True
      Caption         =   "(1.首次接洽程序(中文A4) 2.最新收文程序(中文A4) 3.所有程序)"
      Height          =   180
      Left            =   1605
      TabIndex        =   53
      Top             =   1065
      Width           =   4875
   End
   Begin VB.Label Label3 
      AutoSize        =   -1  'True
      Caption         =   "格　　式："
      Height          =   180
      Left            =   105
      TabIndex        =   52
      Top             =   1065
      Width           =   900
   End
   Begin VB.Label Label6 
      AutoSize        =   -1  'True
      Caption         =   "報表語文："
      Height          =   180
      Index           =   1
      Left            =   90
      TabIndex        =   51
      Top             =   1395
      Width           =   900
   End
   Begin VB.Label Label7 
      AutoSize        =   -1  'True
      Caption         =   "(1.中文 2. 英文 3.日文)"
      Height          =   180
      Index           =   1
      Left            =   1590
      TabIndex        =   50
      Top             =   1395
      Width           =   1740
   End
   Begin VB.Label Label13 
      AutoSize        =   -1  'True
      Caption         =   "輸出內容："
      Height          =   180
      Left            =   90
      TabIndex        =   37
      Top             =   1740
      Width           =   900
   End
   Begin VB.Label Label6 
      AutoSize        =   -1  'True
      Caption         =   "輸出方式："
      Height          =   180
      Index           =   2
      Left            =   120
      TabIndex        =   36
      Top             =   765
      Width           =   900
   End
   Begin VB.Label lblSalesName 
      AutoSize        =   -1  'True
      Caption         =   "Name"
      Height          =   180
      Left            =   1980
      TabIndex        =   35
      Top             =   120
      Width           =   405
   End
   Begin VB.Label Label5 
      AutoSize        =   -1  'True
      Caption         =   "智權人員："
      Height          =   180
      Left            =   105
      TabIndex        =   34
      Top             =   120
      Width           =   900
   End
   Begin VB.Line Line1 
      X1              =   2370
      X2              =   2610
      Y1              =   540
      Y2              =   540
   End
   Begin VB.Label Label1 
      AutoSize        =   -1  'True
      Caption         =   "客戶編號："
      Height          =   180
      Left            =   105
      TabIndex        =   31
      Top             =   450
      Width           =   900
   End
End
Attribute VB_Name = "frm0503171Old"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'Memo By Sindy 2012/12/3 智權人員欄已修改
'Memo By Sindy 2011/2/17 SQLDate已檢查
'Memo by Morgan2010/12/28 申請案號欄已修改
'Memo By Sindy 2010/11/26 員工編號欄已修改
'Memo by Morgan2010/8/12 日期欄已修改
Option Explicit

'Modify by Morgan 2008/9/8 排除B類且收文日為19221111的
Dim strSql As String, strSQL1 As String, strSQL2 As String, StrSQL3 As String, StrSQL4 As String, strSQL5 As String, i As Integer, j As Integer, k As Integer, s As Integer
Dim strTemp(0 To 24) As String, StrTemp5(0 To 14) As String, iPrint As Integer, Page As Integer
'Modify By Cheng 2003/05/02
Dim PLeft(0 To 20) As Integer, strTemp1 As Variant, strTemp2 As Variant, SeekPrint As Integer, SeekPrintL As Integer, SeekTempPrint As String, IntTot As Integer
'Add By Cheng 2002/02/27
Dim m_ColCustName As String '申請人名稱欄位
Dim m_ColCustAdd As String '申請人地址欄位
Dim m_ColAgName As String '代理人名稱欄位
Dim m_ColAgAdd As String '代理人地址欄位
'Add By Cheng 2003/02/10
Dim m_strSQL1_2 As String, m_strSQL1_3 As String, m_strSQL1_4 As String, m_strSQL1_5 As String, m_strSQL5_2 As String, m_strSQL5_3 As String
'add by nickc 2007/01/10
Dim m_strSQL5_4 As String, m_strSQL5_5 As String, m_strSQL2_2 As String, m_strSQL2_3 As String, m_strSQL2_4 As String, m_strSQL2_5 As String
'Add By Sindy 2011/2/23
Dim m_strSQL3_2 As String, m_strSQL3_3 As String, m_strSQL3_4 As String, m_strSQL3_5 As String, m_strSQL4_2 As String, m_strSQL4_3 As String
Dim m_strSQL4_4 As String, m_strSQL4_5 As String

'Add By Cheng 2003/07/07
Dim m_arrCaseNo '本所案號
Dim m_strPrintKind As String '列印種類"0"不印, "1"專利, "2"商標, "3"其他, "4"法務

'Add by Morgan 2003/11/28
'strIdfTag '聯合商標改為正商標的辨識旗標 A:原為聯合商標, B:原為服務標章, C:原為聯合服務標章
Const strIdfTag As String = "DECODE(TM58,NULL,' ', DECODE( INSTR(TM58,'原為聯合商標',1,1),0,DECODE( INSTR(TM58,'原為服務標章',1,1),0,DECODE(INSTR(TM58,'原為聯合服務標章',1,1),0,'','C'),'B'),'A'))"
'add by nickc 2005/11/08
Dim strSeekGroup As String
Dim g_WordAp As Word.Application
Dim IsOpenWord As Boolean, IsHaveData As Boolean
Dim o_PaperHeight As Integer
'add by nickc 2005/11/16
Dim blnWordNewPage As Boolean
Dim m_IsOrNot As String 'Add by Morgan 2007/8/17 是否含指定案號
Dim tmpPrName As String, oldtmpPrName As String

'Add by Amy 2013/10/03
Dim ReportName As String
Dim strInventor As String              '發明人名稱
Dim CaseProgress_NewA As String 'A類最新進度
Dim xlsCustPoint As New Excel.Application
Dim wksrpt As New Worksheet
Dim IsOpenExcel As Boolean '是否開啟Excel
Dim intXlsRow As Integer
Dim oldCaseNo As String '用於 記錄本所案號 重覆者不需抓圖檔
Dim SetTitle() As String '記錄抬頭(陣列大小:專利 商標 其他 最大欄位數)17
Dim setXlsWidth() As Double '記錄欄寬17
Dim setFieldNo_txt() As String '記錄需設定文字欄位格式的編號3
Dim setFieldNo() As String '記錄需設定欄位格式的編號2
Dim setFieldType() As String '記錄設定欄位格式2
Dim strXlsData As String 'Excel 資料
Dim strXlsTp(7) As String 'for Excel
Dim CountPT As Integer, CountTM As Integer, CountOT As Integer '最後顯示筆數
Dim bolTMGoods As Boolean 'Add by Amy 2017/03/13 是否show 指定商品
'Add by Amy 2017/07/25
Dim strPriDate As String '優先權資料
Dim strTBF As String '暫存檔欄位
Dim strWkName As String 'Add by Amy 2017/12/26 for 2010 工作表名稱為中文

'Add by Amy 2017/03/13
Private Sub Check1_Click(Index As Integer)
    If UCase(GetStaffDepartment(strUserNum)) <> "M51" Then Exit Sub
    
    If Check1(0) = vbChecked Or Check1(2) = vbChecked Then
        txt1(16).Enabled = True
    Else
        txt1(16).Enabled = False
        txt1(16) = ""
    End If
End Sub

'add by nickc 2005/11/03
Private Sub Check3_Click(Index As Integer)
If Index = 0 Then
   If Check3(Index).Value = vbChecked Then
      Frame1.Enabled = True
      Check3(1).Value = 0 'Add By Sindy 2012/7/26
      'Add by Amy 2013/10/03 增加勾選Word或Excel
      Check10(0).Value = 0
      Check10(1).Value = 0
      Check10(0).Enabled = False
      Check10(1).Enabled = False
      'end 2013/10/3
   Else
      Frame1.Enabled = False
   End If
ElseIf Index = 1 Then
   If Check3(Index).Value = vbChecked Then
      txtMail.Enabled = True
      Check3(0).Value = 0 'Add By Sindy 2012/7/26
      'Add by Amy 2013/10/03
      Check10(0).Enabled = True
      Check10(1).Enabled = True
      'end 2013/10/3
   Else
      txtMail.Enabled = False
      'Add by Amy 2013/10/03
      Check10(0).Enabled = False
      Check10(1).Enabled = False
      Check10(0).Value = 0
      Check10(1).Value = 0
      'end 2013/10/3
   End If
End If
End Sub

Private Sub Check4_Click(Index As Integer)
'標準
If Index = 1 Then
   If Check4(Index).Value = vbChecked Then
      Check4(0).Value = 0
      Frame2.Enabled = True
      'Add by Amy 2013/10/03 +if
      If Check3(1).Value = vbChecked Then
           Check10(0).Enabled = True
           Check10(1).Enabled = True
      Else
            Check10(0).Enabled = False
            Check10(1).Enabled = False
      End If
   Else
      Frame2.Enabled = False
      If Check3(1).Value = vbChecked Then
        Check10(0).Enabled = False
        Check10(1).Enabled = False
      End If
   End If
ElseIf Index = 0 Then  'Add by Amy 2013/10/03 勾選「專利群組案件」不可勾選Excel
    If Check4(Index) = vbChecked Then
        Check4(1).Value = 0
        If Check3(1).Value = vbChecked Then
            Check10(1).Enabled = False
            Check10(0).Value = 1
            Check10(1).Value = 0
        Else
            Check10(0).Enabled = False
            Check10(1).Enabled = False
            Check10(0).Value = 0
            Check10(1).Value = 0
        End If
    Else
        If Check3(1).Value = vbChecked Then
            Check10(0).Enabled = True
            Check10(1).Enabled = True
        End If
    End If
End If
End Sub

'Add by Amy 2013/10/03
Private Sub check10_Click(Index As Integer)
If Check10(Index).Value = vbChecked Then
    Check3(0).Value = 0
    Check3(1).Value = 1
    If Index = 0 Then
        Check10(1).Value = 0
    Else
        Check10(0).Value = 0
    End If
End If
End Sub
'end 2013/10/3

'*******************
'   客戶案件總簿
'   邱小姐說分成專利和商標兩種格式各分中，英，日
'   除了商標外其他都是專利格式
'   專利     lawcase , servicepractice  , patent  ,hirecase
'   商標     trademark
'   90/07/17   nick keyin 與原本條款全部都不一樣
'*******************
Private Sub cmdok_Click(Index As Integer)
Dim strTemp As String
Dim strAttFileName As String 'Add by Amy 2013/10/03
   
On Error GoTo ErrorHandler

If txt1(10) = "1" And txt1(10) <> MsgText(601) Then
    MsgBox "只能產生英文or日文格式的紙本"
    Exit Sub
End If
   
Select Case Index
Case 0 '確定
   'Add by Morgan 2007/8/17
   If Check2.Value = 1 Then
      m_IsOrNot = " Not "
   Else
      m_IsOrNot = ""
   End If
        'add by nickc 2005/11/16 假設沒有 word 文件
        IsOpenWord = False
        IsOpenExcel = False: intXlsRow = 3: CountPT = 0: CountTM = 0: CountOT = 0 'Add by Amy 2013/10/03
        'add by nickc 2005/11/16 假設沒有資料
        IsHaveData = False
        bolTMGoods = False 'Add by Amy 2017/03/13
        'add by nickc 2005/11/03
        If Check3(0).Value = vbChecked Then
'edit by nickc 2006/11/23
'            If Combo1.ListIndex >= SeekPrint Then
'                j = Combo1.ListIndex + 1
'            Else
'                j = Combo1.ListIndex
'            End If
            Set Printer = Printers(Combo1.ListIndex)
            'Add by Morgan 2011/8/11
            '故意設定紙張屬性以便清除印表機狀態(相同印表機驅動程式會沿用原設定值,Ex.進紙槽)
            Printer.PaperSize = 9
            Printer.EndDoc
            'End 2011/8/11
        End If
'        If Check3(1).Value = vbChecked Then
'            If Len(txtMail) = 0 Then
'                s = MsgBox("E-Mail 不可空白!!", , "USER 輸入錯誤")
'                txtMail.SetFocus
'                txtMail.SelStart = 0
'                Exit Sub
'            End If
'        End If
        '    Printer.Orientation = 1
        DoEvents
        '檢查客戶編號
        If Len(txt1(1)) = 0 Then
            s = MsgBox("客戶編號區間不可空白!!", , "USER 輸入錯誤")
            txt1(0).SetFocus
            txt1_GotFocus (0)
            Exit Sub
        Else
            If Mid(Trim(txt1(0)), 1, 6) <> Mid(Trim(txt1(1)), 1, 6) Then
                s = MsgBox("客戶編號前六碼必須相同!!", , "USER 輸入錯誤")
                txt1(0).SetFocus
                txt1_GotFocus (0)
                Exit Sub
            End If
            If Me.txt1(10).Text = "" Then
                MsgBox "請輸入報表語文!!!", vbExclamation + vbOKOnly
                Me.txt1(10).SetFocus
                txt1_GotFocus 10
                Exit Sub
            End If
            If Me.txt1(11).Text <> "" Then
                Me.lblSalesName.Caption = GetStaffName(Me.txt1(11).Text, True)
                If Me.lblSalesName.Caption = "" Then
                    MsgBox "智權人員編號輸入錯誤!!!", vbExclamation + vbOKOnly
                    Me.txt1(11).SetFocus
                    txt1_GotFocus 11
                    Exit Sub
                End If
            End If
            'Add by Amy 2013/10/03  +輸入方式擇一選擇，且選電子檔 需選 word 或excel
            If Check3(0).Value = vbChecked Or Check3(1).Value = vbChecked Then
                If Check3(1).Value = vbChecked Then
                    If Check10(0).Value = vbUnchecked And Check10(1).Value = vbUnchecked Then
                        MsgBox "請勾選需產生 Word 或 Excel !!", vbExclamation + vbOKOnly
                        Check10(0).SetFocus
                        Exit Sub
                    End If
                End If
            Else
                MsgBox "請勾選輸出方式 !!", vbExclamation + vbOKOnly
                Check3(0).SetFocus
                Exit Sub
            End If
            'Add By Sindy 2010/01/22
            ClearQueryLog (Me.Name) 'Add By Sindy 2010/01/22 清除查詢印表記錄檔欄位
            '輸出內容
            If Check4(0).Value = vbChecked Then pub_QL05 = pub_QL05 & ";" & Label13 & Check4(0).Caption
            If Check4(1).Value = vbChecked Then pub_QL05 = pub_QL05 & ";" & Label13 & Check4(1).Caption
            '智權人員
            If Len(Trim(txt1(11))) <> 0 Then pub_QL05 = pub_QL05 & ";" & Label5 & Trim(txt1(11)) & lblSalesName
            '客戶編號
            If Len(Trim(txt1(0))) <> 0 Or Len(Trim(txt1(1))) <> 0 Then
               pub_QL05 = pub_QL05 & ";" & Label1 & Trim(txt1(0)) & "-" & Trim(txt1(1))
            End If
            '輸出方式
            If Check3(0).Value = vbChecked Then pub_QL05 = pub_QL05 & ";" & Label6(2) & Check3(0).Caption
            If Check3(1).Value = vbChecked Then pub_QL05 = pub_QL05 & ";" & Label6(2) & Check3(1).Caption
            '格式
            If Len(Trim(txt1(15))) <> 0 Then pub_QL05 = pub_QL05 & ";" & Label3 & Trim(txt1(15)) & Label12
            '報表語文
            If Len(Trim(txt1(10))) <> 0 Then pub_QL05 = pub_QL05 & ";" & Label6(1) & Trim(txt1(10)) & Label7(1)
            'E -MAIL
            If Len(Trim(txtMail)) <> 0 Then pub_QL05 = pub_QL05 & ";" & Label14 & Trim(txtMail)
            'Add by Amy 2017/03/13
            If Len(Trim(txt1(16))) <> 0 Then
                bolTMGoods = True
                pub_QL05 = pub_QL05 & ";" & "商標輸出指定商品"
            End If
            '標準方式條件(不適用專利群組案件)
            If Check4(1).Value = vbChecked Then
               'Modify By Sindy 2012/7/31
               '系統類別
               If Len(Trim(txt1(2))) <> 0 And Me.Check1(0).Value = vbChecked Then
                  pub_QL05 = pub_QL05 & ";系統類別：" & Trim(txt1(2))
               Else
                  strTemp = ""
                  If Me.Check1(1).Value = vbChecked Then
                     strTemp = strTemp & ",CFP,FCP,P"
                  End If
                  If Me.Check1(2).Value = vbChecked Then
                     strTemp = strTemp & ",CFT,FCT,T,TF"
                  End If
                  If Me.Check1(3).Value = vbChecked Then
                     strTemp = strTemp & ",TC,CFC"
                  End If
                  If Me.Check1(4).Value = vbChecked Then
                     'modify by sonia 2019/7/29 +ACS系統類別
                     strTemp = strTemp & ",L,CFL,FCL,LA,LIN,ACS"
                  End If
                  If Me.Check1(5).Value = vbChecked Then
                     strTemp = strTemp & ",TB"
                  End If
                  If Me.Check1(6).Value = vbChecked Then
                     strTemp = strTemp & ",TD"
                  End If
                  pub_QL05 = pub_QL05 & ";系統類別：" & Mid(strTemp, 2, Len(strTemp))
               End If
               '2012/7/31 End
               '系統別
               pub_QL05 = pub_QL05 & ";" & Label2(0)
               If Check1(0).Value = vbChecked Then pub_QL05 = pub_QL05 & "," & Check1(0).Caption
               If Check1(1).Value = vbChecked Then pub_QL05 = pub_QL05 & "," & Check1(1).Caption
               If Check1(2).Value = vbChecked Then pub_QL05 = pub_QL05 & "," & Check1(2).Caption
               If Check1(3).Value = vbChecked Then pub_QL05 = pub_QL05 & "," & Check1(3).Caption
               If Check1(4).Value = vbChecked Then pub_QL05 = pub_QL05 & "," & Check1(4).Caption
               If Check1(5).Value = vbChecked Then pub_QL05 = pub_QL05 & "," & Check1(5).Caption
               If Check1(6).Value = vbChecked Then pub_QL05 = pub_QL05 & "," & Check1(6).Caption
               '輸出順序
               If Len(Trim(txt1(9))) <> 0 Then pub_QL05 = pub_QL05 & ";" & Label10 & Trim(txt1(9)) & Label11
               '收文日期
               If Len(Trim(txt1(3))) <> 0 Or Len(Trim(txt1(4))) <> 0 Then
                  pub_QL05 = pub_QL05 & ";" & Label2(3) & Trim(txt1(3)) & "-" & Trim(txt1(4))
               End If
               '申請日期
               If Len(Trim(txt1(13))) <> 0 Or Len(Trim(txt1(14))) <> 0 Then
                  pub_QL05 = pub_QL05 & ";" & Label2(4) & Trim(txt1(13)) & "-" & Trim(txt1(14))
               End If
               '是否含核駁
               If Len(Trim(txt1(7))) <> 0 Then pub_QL05 = pub_QL05 & ";" & Label6(0) & Trim(txt1(7)) & Label7(0)
               '國內外是否分開列印
               If Len(Trim(txt1(8))) <> 0 Then pub_QL05 = pub_QL05 & ";" & Label8 & Trim(txt1(8)) & Label9
               '申請國家
               If Len(Trim(txt1(5))) <> 0 Or Len(Trim(txt1(6))) <> 0 Then
                  pub_QL05 = pub_QL05 & ";" & Label4 & Trim(txt1(5)) & "-" & Trim(txt1(6))
               End If
               '含閉卷
               If ChkClose.Value = vbChecked Then pub_QL05 = pub_QL05 & ";" & ChkClose.Caption
               '含銷卷
               If Check6.Value = vbChecked Then pub_QL05 = pub_QL05 & ";" & Check6.Caption
               '專用期仍有效的
               If Check5.Value = vbChecked Then pub_QL05 = pub_QL05 & ";" & Check5.Caption
               '本所案號
               If Len(Trim(txt1(12))) <> 0 Then pub_QL05 = pub_QL05 & ";" & Label2(2) & txt1(12)
               '不含
               If Check2.Value = vbChecked Then pub_QL05 = pub_QL05 & ";" & "不含指定案號"
            End If
            '2010/01/22 End
            'Add by Amy 2017/07/25 報表為中文 +欄位
            strTBF = "R013001,R013002,R013003,R013004,R013005,R013006,R013007,R013008,R013009,R013010,R013011,R013012,R013013,R013014,R013015,R013016,R013017,R013018,R013019" & _
                        ",ID,R013020,R013021,R013022,R013023,R013024,R013025,R013026,R013027"
            strTBF = " (" & strTBF & ") "
            'add by nickc 2005/11/07 群組
            If Check4(0).Value = vbChecked Then
                    Screen.MousePointer = vbHourglass
                    Me.Enabled = False
                    'Add By Cheng 2003/02/10
                    '初始化頁數
                    Page = 0
                    'Modify By Cheng 2003/02/10
                    '若使用者為電腦中心人員
                    If UCase(GetStaffDepartment(strUserNum)) = "M51" Then
                        '若為中文報表
                        If Me.txt1(10).Text = "1" Then
                            ProcessP_1_Grp
                        '若非中文報表(照舊)
                        Else
                            ProcessP_Grp
                        End If
                    '若使用者非電腦中心人員
                    Else
                        If intPCaseKind = 2 Then
                            '沒有群組報表
                            MsgBox "群組報表僅限專利才有！", vbCritical, "錯誤！"
                            Me.Enabled = True
                            Screen.MousePointer = vbDefault
                            Exit Sub
                        Else
                            '若為中文報表
                            If Me.txt1(10).Text = "1" Then
                                ReportName = "專利" 'Add by Amy 2013/10/03
                                ProcessP_1_Grp
                            '若非中文報表(照舊)
                            Else
                                ProcessP_Grp
                            End If
                        End If
                    End If
                    'add by nickc 2005/11/21 有資料更新
                    Screen.MousePointer = vbHourglass
                    If IsHaveData = True Then
                        '更新檢查客戶准駁檢查日
                        cnnConnection.Execute "update customer set cu110=TO_NUMBER(TO_CHAR( SYSDATE,'YYYYMMDD')) where substr(cu01,1,6)='" & Mid(txt1(0), 1, 6) & "' and cu110 is null "
                    End If
                    'Modify by Amy 2013/10/03 +Excel
                    'add by nickc 2005/11/16 將 word 存檔，寄信
'                    If IsOpenWord = True Then
'                        fn_PutEnd txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1) & ".doc"
                    strAttFileName = ""
                    If IsOpenWord = True Or IsOpenExcel = True Then
                        strAttFileName = txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1)
                        If IsOpenWord = True Then
                            strAttFileName = strAttFileName & ".doc"
                            fn_PutEnd strAttFileName
                        ElseIf IsOpenExcel = True Then
                            strAttFileName = strAttFileName & ".xls"
                            fn_PutEndXls strAttFileName
                        End If
                        If strAttFileName = "" Then '2013/10/3
                            MsgBox "檔案產生失敗，請確認！"
                        Else
'Modified by Morgan 2014/2/10 Outlook 2010 無法寄,改用SMTP
'                           DoEvents
'                           MAPISession1.LogonUI = False
'                           MAPISession1.UserName = strUserNum
'                           MAPISession1.SignOn
'                           MAPIMessages1.SessionID = MAPISession1.SessionID
'                           MAPIMessages1.MsgIndex = -1
'                           MAPIMessages1.Compose
'                           MAPIMessages1.MsgSubject = txt1(0) & "客戶案件總簿--電子檔"
'                           MAPIMessages1.MsgNoteText = "Dear All：" & vbCrLf & "客戶案件總簿" & vbCrLf & "資料如附件！" & vbCrLf & vbCrLf & vbCrLf & "                                                        電腦中心"
'                           MAPIMessages1.AttachmentIndex = 0
'                           MAPIMessages1.AttachmentPosition = 0
'                           MAPIMessages1.AttachmentPathName = App.path & "\" & txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1) & ".doc"
'                           MAPIMessages1.RecipIndex = 0
'                           MAPIMessages1.RecipDisplayName = IIf(Trim(txtMail.Text) = "", txt1(11), txtMail.Text)
'                           MAPIMessages1.ResolveName
'                           MAPIMessages1.Send
'                           MAPISession1.SignOff
                            'Modify by Amy 2014/07/17
                            'PUB_SendMail strUserNum, IIf(Trim(txtMail.Text) = "", txt1(11), txtMail.Text), "", txt1(0) & "客戶案件總簿--電子檔", "Dear All：" & vbCrLf & "客戶案件總簿" & vbCrLf & "資料如附件！" & vbCrLf & vbCrLf & vbCrLf & "                                                        電腦中心", , App.path & "\" & txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1) & ".doc", False
                            PUB_SendMail strUserNum, IIf(Trim(txtMail.Text) = "", txt1(11), txtMail.Text), "", txt1(0) & "客戶案件總簿--電子檔", "Dear All：" & vbCrLf & "客戶案件總簿" & vbCrLf & "資料如附件！" & vbCrLf & vbCrLf & vbCrLf & "                                                        電腦中心", , App.path & "\" & strAttFileName, False
'end 2014/2/10
                            'Kill App.path & "\" & txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1) & ".doc"
                            Kill App.path & "\" & strAttFileName
                            'end 2014/07/17
                        End If
                    End If
                    
                    If IsHaveData = True Then
                        If Check10(1).Value = vbChecked Then 'Modify by Amy 2013/10/13 +if
                            MsgBox "輸出完成!!" & vbCrLf & " 專利 " & CountPT & " 筆，商標 " & CountTM & " 筆，其他" & CountOT & " 筆！", , "輸出成功"
                        Else
                            MsgBox "輸出完成!!" & vbCrLf & " 共 " & Page & " 頁！", , "輸出成功"
                        End If
                    End If
                    ClearVar 'Add by Amy 2018/02/05
                    Me.Enabled = True
                    Screen.MousePointer = vbDefault
            ElseIf Check4(1).Value = vbChecked Then
                If (Me.Check1(0).Value = vbUnchecked And Me.Check1(1).Value = vbUnchecked And Me.Check1(2).Value = vbUnchecked And _
                    Me.Check1(3).Value = vbUnchecked And Me.Check1(4).Value = vbUnchecked And Me.Check1(5).Value = vbUnchecked And _
                    Me.Check1(6).Value = vbUnchecked) And Me.txt1(12).Text = "" Then
                    MsgBox "請選擇系統類別或輸入本所案號!!!", vbExclamation + vbOKOnly
                    Me.txt1(12).SetFocus
                    txt1_GotFocus 12
                    Exit Sub
                Else
                    '檢查收文日區間
                    If PUB_CheckKeyInDate(Me.txt1(3)) = -1 Then
                        Me.txt1(3).SetFocus
                        txt1_GotFocus 3
                        Exit Sub
                    End If
                    If PUB_CheckKeyInDate(Me.txt1(4)) = -1 Then
                        Me.txt1(4).SetFocus
                        txt1_GotFocus 4
                        Exit Sub
                    End If
                    '檢查申請日區間
                    If PUB_CheckKeyInDate(Me.txt1(13)) = -1 Then
                        Me.txt1(13).SetFocus
                        txt1_GotFocus 13
                        Exit Sub
                    End If
                    If PUB_CheckKeyInDate(Me.txt1(14)) = -1 Then
                        Me.txt1(14).SetFocus
                        txt1_GotFocus 14
                        Exit Sub
                    End If

                    If Len(txt1(9)) = 0 Then
                        s = MsgBox("輸出順序不可空白!!", , "USER 輸入錯誤")
                        txt1(9).SetFocus
                        Exit Sub
                    End If
                    '檢查智權人員代碼
'edit by nickc 2005/11/08 往上搬
'                    If Me.txt1(11).Text <> "" Then
'                        Me.lblSalesName.Caption = GetStaffName(Me.txt1(11).Text, True)
'                        If Me.lblSalesName.Caption = "" Then
'                            MsgBox "智權人員編號輸入錯誤!!!", vbExclamation + vbOKOnly
'                            Me.txt1(11).SetFocus
'                            txt1_GotFocus 11
'                            Exit Sub
'                        End If
''                    Else
'                            'Modify By Cheng 2003/07/21
'        '                    MsgBox "請輸入智權人員!!!", vbExclamation + vbOKOnly
'        '                    Me.txt1(11).SetFocus
'        '                    txt1_GotFocus 11
'        '                    Exit Sub
'                    End If
'                    If Me.txt1(10).Text = "" Then
'                        MsgBox "請輸入報表語文!!!", vbExclamation + vbOKOnly
'                        Me.txt1(10).SetFocus
'                        txt1_GotFocus 10
'                        Exit Sub
'                    End If
                    If Me.txt1(15).Text = "" Then
                        MsgBox "請輸入輸出格式!!!", vbExclamation + vbOKOnly
                        Me.txt1(15).SetFocus
                        txt1_GotFocus 15
                        Exit Sub
                    End If
                    Screen.MousePointer = vbHourglass
                    Me.Enabled = False
                    '初始化頁數
                    Page = 0
                    '若使用者為電腦中心人員
                    If UCase(GetStaffDepartment(strUserNum)) = "M51" Then
                        '若為中文報表
                        If Me.txt1(10).Text = "1" Then
                            ReportName = "專利" 'Add by Amy 2013/10/03
                            ProcessP_1
                            ReportName = "商標" 'Add by Amy 2013/10/03
                            ProcessT
                            ReportName = "其他" 'Add by Amy 2013/10/03
                            ProcessO
                        '若非中文報表(照舊)
                        Else
                            ProcessP
                            ProcessT
                        End If
                    '若使用者非電腦中心人員
                    Else
                        If intPCaseKind = 2 Then
                            '若為中文報表
                            If Me.txt1(10).Text = "1" Then
                                ReportName = "商標" 'Add by Amy 2013/10/03
                                ProcessT
                                ReportName = "其他" 'Add by Amy 2013/10/03
                                ProcessO
                            '若非中文報表(照舊)
                            Else
                                ProcessT
                            End If
                        Else
                            '若為中文報表
                            If Me.txt1(10).Text = "1" Then
                                ReportName = "專利" 'Add by Amy 2013/10/03
                                ProcessP_1
                                ReportName = "其他" 'Add by Amy 2013/10/03
                                ProcessO
                            '若非中文報表(照舊)
                            Else
                                ProcessP
                            End If
                        End If
                    End If
                    'add by nickc 2005/11/21 有資料更新
                    Screen.MousePointer = vbHourglass
                    If IsHaveData = True Then
                        '更新檢查客戶准駁檢查日
                        cnnConnection.Execute "update customer set cu110=TO_NUMBER(TO_CHAR( SYSDATE,'YYYYMMDD')) where substr(cu01,1,6)='" & Mid(txt1(0), 1, 6) & "' and cu110 is null "
                    End If
                    'Modify by Amy 2013/10/03 +Excel
                    'add by nickc 2005/11/16 將 word 存檔，寄信
'                    If IsOpenWord = True Then
'                        fn_PutEnd txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1) & ".doc"
                    strAttFileName = ""
                    If IsOpenWord = True Or IsOpenExcel = True Then
                        strAttFileName = txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1)
                        If IsOpenWord = True Then
                            strAttFileName = strAttFileName & ".doc"
                            fn_PutEnd strAttFileName
                        ElseIf IsOpenExcel = True Then
                            strAttFileName = strAttFileName & ".xls"
                            fn_PutEndXls strAttFileName
                        End If
                        If strAttFileName = "" Then '2013/10/03
                            MsgBox "檔案產生失敗，請確認！"
                        Else
'Modified by Morgan 2014/2/10 Outlook 2010 無法寄,改用SMTP
'                           DoEvents
'                           MAPISession1.LogonUI = False
'                           MAPISession1.UserName = strUserNum
'                           MAPISession1.SignOn
'                           MAPIMessages1.SessionID = MAPISession1.SessionID
'                           MAPIMessages1.MsgIndex = -1
'                           MAPIMessages1.Compose
'                           MAPIMessages1.MsgSubject = txt1(0) & "客戶案件總簿--電子檔"
'                           MAPIMessages1.MsgNoteText = "Dear All：" & vbCrLf & "客戶案件總簿" & vbCrLf & "資料如附件！" & vbCrLf & vbCrLf & vbCrLf & "                                                        電腦中心"
'                           MAPIMessages1.AttachmentIndex = 0
'                           MAPIMessages1.AttachmentPosition = 0
'                           MAPIMessages1.AttachmentPathName = App.path & "\" & txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1) & ".doc"
'                           MAPIMessages1.RecipIndex = 0
'                           MAPIMessages1.RecipDisplayName = IIf(Trim(txtMail.Text) = "", txt1(11), txtMail.Text)
'                           MAPIMessages1.ResolveName
'                           MAPIMessages1.Send
'                           MAPISession1.SignOff
                            'Modify by Amy 2014/07/17
                            'PUB_SendMail strUserNum, IIf(Trim(txtMail.Text) = "", txt1(11), txtMail.Text), "", txt1(0) & "客戶案件總簿--電子檔", "Dear All：" & vbCrLf & "客戶案件總簿" & vbCrLf & "資料如附件！" & vbCrLf & vbCrLf & vbCrLf & "                                                        電腦中心", , App.path & "\" & txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1) & ".doc", False
                            PUB_SendMail strUserNum, IIf(Trim(txtMail.Text) = "", txt1(11), txtMail.Text), "", txt1(0) & "客戶案件總簿--電子檔", "Dear All：" & vbCrLf & "客戶案件總簿" & vbCrLf & "資料如附件！" & vbCrLf & vbCrLf & vbCrLf & "電腦中心", , App.path & "\" & strAttFileName, False
'end 2014/2/10
                            'Kill App.path & "\" & txt1(11).Text & "_" & txt1(0) & "_" & strSrvDate(1) & ".doc"
                            Kill App.path & "\" & strAttFileName
                            'end 2014/07/17
                        End If
                    End If
                                        
                    If IsHaveData = True Then
                        If Check10(1).Value = vbChecked Then 'Modify by Amy 2013/10/13 +if
                            MsgBox "輸出完成!!" & vbCrLf & " 專利 " & CountPT & " 筆，商標 " & CountTM & " 筆，其他" & CountOT & " 筆！", , "輸出成功"
                        Else
                            MsgBox "輸出完成!!" & vbCrLf & " 共 " & Page & " 頁！", , "輸出成功"
                        End If
                    End If
                    ClearVar 'Add by Amy 2018/02/05
                    Me.Enabled = True
                    Screen.MousePointer = vbDefault
                End If
            End If
        End If
Case 1 '結束
     Unload Me
Case Else
End Select
'Add By Cheng 2002/11/15
Exit Sub
ErrorHandler:
    Select Case Err.Number
    Case 380
        MsgBox "印表機選擇錯誤!!!"
    Case Else
        MsgBox "(" & Err.Number & ")" & Err.Description
    End Select
    'Resume Next
    'Add By Cheng 2003/04/23
    Me.Enabled = True
    Screen.MousePointer = vbDefault
End Sub

Sub ProcessT()
   Dim ii As Integer
   Dim blnMatchKind As Boolean

On Error GoTo ErrHnd

   Screen.MousePointer = vbHourglass
   'add by nickc 2005/11/09 紙本
   If Check3(0).Value = vbChecked Then
       '若下所有程序或英日報表
       If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
         Printer.Orientation = 1
         'Modified by Morgan 2015/6/2
         'Printer.PaperSize = 39
         Printer.PaperSize = PUB_GetPaperSize(15)
         'END 2015/6/2
         o_PaperHeight = 14200
       '其他
       Else
           Printer.Orientation = 2
           Printer.PaperSize = 9
           o_PaperHeight = 10000
       End If
   ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
       If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
           o_PaperHeight = 50 'Modify by Amy 2019/11/21 原:56
       Else
           o_PaperHeight = 40
       End If
   End If
   m_strPrintKind = "2"
   blnMatchKind = False
   cnnConnection.Execute "delete from R050317_C WHERE ID='" & strUserNum & "' "     '語文為中文      對內
   cnnConnection.Execute "DELETE FROM R050317_E WHERE ID='" & strUserNum & "' "     '語文為英文    對外
   cnnConnection.Execute "DELETE FROM R050317_J WHERE ID='" & strUserNum & "' "     '語文為日文   對外
   strSQL1 = ""
   '若為所有程序
   If Me.txt1(15).Text = "3" Then
       '2008/4/18 MODIFY BY SONIA 加入TM04='00'的條件
       strSQL2 = " AND TM04='00' AND TM01=CP01 AND TM02=CP02 AND TM03=CP03 AND TM04=CP04 "
   '若為首次或最新程序(只抓A, B類)
   Else
       '2008/4/18 MODIFY BY SONIA 加入TM04='00'的條件
       strSQL2 = " AND TM04='00' AND TM01=CP01(+) AND TM02=CP02(+) AND TM03=CP03(+) AND TM04=CP04(+) "
   End If
   StrSQL3 = ""
   StrSQL4 = ""
   strSQL5 = ""
   'add by nickc 2007/01/10
   m_strSQL2_2 = strSQL2: m_strSQL2_3 = strSQL2: m_strSQL2_4 = strSQL2: m_strSQL2_5 = strSQL2
   
   strSQL2 = strSQL2 + " AND (TM23>='" & GetNewFagent(txt1(0)) & "' AND TM23<='" & GetNewFagent(txt1(1)) & "') "
   
   'add by nickc 2007/01/10
   m_strSQL2_2 = m_strSQL2_2 + " AND (TM78>='" & GetNewFagent(txt1(0)) & "' AND TM78<='" & GetNewFagent(txt1(1)) & "') "
   m_strSQL2_3 = m_strSQL2_3 + " AND (TM79>='" & GetNewFagent(txt1(0)) & "' AND TM79<='" & GetNewFagent(txt1(1)) & "') "
   m_strSQL2_4 = m_strSQL2_4 + " AND (TM80>='" & GetNewFagent(txt1(0)) & "' AND TM80<='" & GetNewFagent(txt1(1)) & "') "
   m_strSQL2_5 = m_strSQL2_5 + " AND (TM81>='" & GetNewFagent(txt1(0)) & "' AND TM81<='" & GetNewFagent(txt1(1)) & "') "

   '若有勾選系統類別
   If Me.Check1(0).Value = vbChecked Or Me.Check1(2).Value = vbChecked Then
       blnMatchKind = True
       strSQL2 = strSQL2 & " and TM01 in (' ',"
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 & " and TM01 in (' ',"
       m_strSQL2_3 = m_strSQL2_3 & " and TM01 in (' ',"
       m_strSQL2_4 = m_strSQL2_4 & " and TM01 in (' ',"
       m_strSQL2_5 = m_strSQL2_5 & " and TM01 in (' ',"
       
       If Me.Check1(0).Value = vbChecked Then
           strSQL2 = strSQL2 & SQLGrpStr(txt1(2), 2) & ","
           'add by nickc 2007/01/10
           m_strSQL2_2 = m_strSQL2_2 & SQLGrpStr(txt1(2), 2) & ","
           m_strSQL2_3 = m_strSQL2_3 & SQLGrpStr(txt1(2), 2) & ","
           m_strSQL2_4 = m_strSQL2_4 & SQLGrpStr(txt1(2), 2) & ","
           m_strSQL2_5 = m_strSQL2_5 & SQLGrpStr(txt1(2), 2) & ","
       End If
       If Me.Check1(2).Value = vbChecked Then
           strSQL2 = strSQL2 & "'CFT','FCT','T','TF'" & ","
           'add by nickc 2007/01/10
           m_strSQL2_2 = m_strSQL2_2 & "'CFT','FCT','T','TF'" & ","
           m_strSQL2_3 = m_strSQL2_3 & "'CFT','FCT','T','TF'" & ","
           m_strSQL2_4 = m_strSQL2_4 & "'CFT','FCT','T','TF'" & ","
           m_strSQL2_5 = m_strSQL2_5 & "'CFT','FCT','T','TF'" & ","
       End If
       strSQL2 = Left(strSQL2, Len(strSQL2) - 1)
       strSQL2 = strSQL2 & " ) "
       'add by nickc 2007/01/10
       m_strSQL2_2 = Left(m_strSQL2_2, Len(m_strSQL2_2) - 1)
       m_strSQL2_2 = m_strSQL2_2 & " ) "
       m_strSQL2_3 = Left(m_strSQL2_3, Len(m_strSQL2_3) - 1)
       m_strSQL2_3 = m_strSQL2_3 & " ) "
       m_strSQL2_4 = Left(m_strSQL2_4, Len(m_strSQL2_4) - 1)
       m_strSQL2_4 = m_strSQL2_4 & " ) "
       m_strSQL2_5 = Left(m_strSQL2_5, Len(m_strSQL2_5) - 1)
       m_strSQL2_5 = m_strSQL2_5 & " ) "
       
   End If
   If blnMatchKind = False Then Exit Sub
   
   '若有設定本所案號
   If Trim(Me.txt1(12).Text) <> "" Then
   
       strSQL2 = strSQL2 & " and " & m_IsOrNot & " ( "
       
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 & " and " & m_IsOrNot & " ( "
       m_strSQL2_3 = m_strSQL2_3 & " and " & m_IsOrNot & " ( "
       m_strSQL2_4 = m_strSQL2_4 & " and " & m_IsOrNot & " ( "
       m_strSQL2_5 = m_strSQL2_5 & " and " & m_IsOrNot & " ( "
       
       m_arrCaseNo = Split(Replace(Me.txt1(12).Text, vbCrLf, ""), ",")
       For ii = LBound(m_arrCaseNo) To UBound(m_arrCaseNo)
           strSQL2 = strSQL2 & " ( " & ChgTradeMark(m_arrCaseNo(ii)) & " ) "
           'add by nickc 2007/01/10
           m_strSQL2_2 = m_strSQL2_2 & " ( " & ChgTradeMark(m_arrCaseNo(ii)) & " ) "
           m_strSQL2_3 = m_strSQL2_3 & " ( " & ChgTradeMark(m_arrCaseNo(ii)) & " ) "
           m_strSQL2_4 = m_strSQL2_4 & " ( " & ChgTradeMark(m_arrCaseNo(ii)) & " ) "
           m_strSQL2_5 = m_strSQL2_5 & " ( " & ChgTradeMark(m_arrCaseNo(ii)) & " ) "
           
           If ii < UBound(m_arrCaseNo) Then
               strSQL2 = strSQL2 & " Or "
               'add by nickc 2007/01/10
               m_strSQL2_2 = m_strSQL2_2 & " Or "
               m_strSQL2_3 = m_strSQL2_3 & " Or "
               m_strSQL2_4 = m_strSQL2_4 & " Or "
               m_strSQL2_5 = m_strSQL2_5 & " Or "
           End If
       Next ii
       strSQL2 = strSQL2 & " ) "
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 & " ) "
       m_strSQL2_3 = m_strSQL2_3 & " ) "
       m_strSQL2_4 = m_strSQL2_4 & " ) "
       m_strSQL2_5 = m_strSQL2_5 & " ) "
   End If
   
   '收文日區間
   If Len(txt1(3)) <> 0 Then
      strSQL2 = strSQL2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
      'add by nickc 2007/01/10
      m_strSQL2_2 = m_strSQL2_2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
      m_strSQL2_3 = m_strSQL2_3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
      m_strSQL2_4 = m_strSQL2_4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
      m_strSQL2_5 = m_strSQL2_5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   End If
   If Len(txt1(4)) <> 0 Then
      strSQL2 = strSQL2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
      'add by nickc 2007/01/10
      m_strSQL2_2 = m_strSQL2_2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
      m_strSQL2_3 = m_strSQL2_3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
      m_strSQL2_4 = m_strSQL2_4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
      m_strSQL2_5 = m_strSQL2_5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   'Add By Cheng 2002/03/19
   Else
      If Len(txt1(3)) <> 0 Then
         strSQL2 = strSQL2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
         'add by nickc 2007/01/10
         m_strSQL2_2 = m_strSQL2_2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
         m_strSQL2_3 = m_strSQL2_3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
         m_strSQL2_4 = m_strSQL2_4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
         m_strSQL2_5 = m_strSQL2_5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      End If
   End If
   '申請日區間
   'Modify by Amy 2017/12/26 Or 申請日Is Null拿掉
   If Me.txt1(13).Text <> "" And Me.txt1(14).Text = "" Then
       'strSQL2 = strSQL2 & " AND ((TM11>=" & Val(ChangeTStringToWString(Txt1(13))) & " And TM11<=" & strSrvDate(1) & " ) Or TM11 Is Null ) "
       strSQL2 = strSQL2 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & strSrvDate(1) & " )  ) "
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & strSrvDate(1) & " )  ) "
       m_strSQL2_3 = m_strSQL2_3 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & strSrvDate(1) & " )  ) "
       m_strSQL2_4 = m_strSQL2_4 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & strSrvDate(1) & " )  ) "
       m_strSQL2_5 = m_strSQL2_5 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & strSrvDate(1) & " )  ) "
   End If
   If Me.txt1(13).Text = "" And Me.txt1(14).Text <> "" Then
       strSQL2 = strSQL2 & " AND (TM11<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 & " AND (TM11<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
       m_strSQL2_3 = m_strSQL2_3 & " AND (TM11<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
       m_strSQL2_4 = m_strSQL2_4 & " AND (TM11<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
       m_strSQL2_5 = m_strSQL2_5 & " AND (TM11<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
   End If
   If Me.txt1(13).Text <> "" And Me.txt1(14).Text <> "" Then
       strSQL2 = strSQL2 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
       'add by nickc 2007/01/210
       m_strSQL2_2 = m_strSQL2_2 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
       m_strSQL2_3 = m_strSQL2_3 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
       m_strSQL2_4 = m_strSQL2_4 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
       m_strSQL2_5 = m_strSQL2_5 & " AND ((TM11>=" & Val(ChangeTStringToWString(txt1(13))) & " And TM11<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
   End If
   'end 2017/12/26
   '申請國家
   If Len(txt1(5)) <> 0 Then
       strSQL2 = strSQL2 + " AND TM10>='" & txt1(5) & "' "
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 + " AND TM10>='" & txt1(5) & "' "
       m_strSQL2_3 = m_strSQL2_3 + " AND TM10>='" & txt1(5) & "' "
       m_strSQL2_4 = m_strSQL2_4 + " AND TM10>='" & txt1(5) & "' "
       m_strSQL2_5 = m_strSQL2_5 + " AND TM10>='" & txt1(5) & "' "
   End If
   
   'add by nickc 2005/11/24 加入閉卷選擇
   If ChkClose.Value <> vbChecked Then
       strSQL2 = strSQL2 + " AND (tm29<>'Y' or tm29 is null) "
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 + " AND (tm29<>'Y' or tm29 is null) "
       m_strSQL2_3 = m_strSQL2_3 + " AND (tm29<>'Y' or tm29 is null) "
       m_strSQL2_4 = m_strSQL2_4 + " AND (tm29<>'Y' or tm29 is null) "
       m_strSQL2_5 = m_strSQL2_5 + " AND (tm29<>'Y' or tm29 is null) "
   End If
   
   'Added by Morgan 2017/1/13 已閉卷或銷卷或核駁
   If Check12.Value = vbChecked Then
       strSQL2 = strSQL2 + " AND (tm29||TM57 is NOT null or tm16='2') "
       m_strSQL2_2 = m_strSQL2_2 + " AND (tm29||TM57 is NOT null or tm16='2') "
       m_strSQL2_3 = m_strSQL2_3 + " AND (tm29||TM57 is NOT null or tm16='2') "
       m_strSQL2_4 = m_strSQL2_4 + " AND (tm29||TM57 is NOT null or tm16='2') "
       m_strSQL2_5 = m_strSQL2_5 + " AND (tm29||TM57 is NOT null or tm16='2') "
   End If
   'end 2015/9/16
   
   'Added by Morgan 2015/9/16 已閉卷或銷卷
   If Check11.Value = vbChecked Then
       strSQL2 = strSQL2 + " AND tm29||TM57 is NOT null  "
       m_strSQL2_2 = m_strSQL2_2 + " AND tm29||TM57 is NOT null  "
       m_strSQL2_3 = m_strSQL2_3 + " AND tm29||TM57 is NOT null  "
       m_strSQL2_4 = m_strSQL2_4 + " AND tm29||TM57 is NOT null  "
       m_strSQL2_5 = m_strSQL2_5 + " AND tm29||TM57 is NOT null  "
   End If
   'end 2015/9/16
   
   'Add by Morgan 2011/1/13 +只印申請案
   If Check7.Value = vbChecked Then
      strSQL2 = strSQL2 + " AND tm28='1' "
      m_strSQL2_2 = m_strSQL2_2 + " AND tm28='1' "
      m_strSQL2_3 = m_strSQL2_3 + " AND tm28='1' "
      m_strSQL2_4 = m_strSQL2_4 + " AND tm28='1' "
      m_strSQL2_5 = m_strSQL2_5 + " AND tm28='1' "
   End If
   
   'Add by Morgan 2011/10/13 +只印已核准
   If Check8.Value = vbChecked Then
      strSQL2 = strSQL2 + " AND tm16='1' "
      m_strSQL2_2 = m_strSQL2_2 + " AND tm16='1' "
      m_strSQL2_3 = m_strSQL2_3 + " AND tm16='1' "
      m_strSQL2_4 = m_strSQL2_4 + " AND tm16='1' "
      m_strSQL2_5 = m_strSQL2_5 + " AND tm16='1' "
   End If
   
   'Add by Morgan 2013/12/24 +只印未核准(核駁或申請中)
   If Check9.Value = vbChecked Then
      strSQL2 = strSQL2 + " AND nvl(tm16,'2')='2' "
      m_strSQL2_2 = m_strSQL2_2 + " AND nvl(tm16,'2')='2' "
      m_strSQL2_3 = m_strSQL2_3 + " AND nvl(tm16,'2')='2' "
      m_strSQL2_4 = m_strSQL2_4 + " AND nvl(tm16,'2')='2' "
      m_strSQL2_5 = m_strSQL2_5 + " AND nvl(tm16,'2')='2' "
   End If
   
   'Add by Morgan 2008/4/9 +銷卷選擇
   If Check6.Value <> vbChecked Then
      strSQL2 = strSQL2 + " AND tm57 is null "
      m_strSQL2_2 = m_strSQL2_2 + " AND tm57 is null "
      m_strSQL2_3 = m_strSQL2_3 + " AND tm57 is null "
      m_strSQL2_4 = m_strSQL2_4 + " AND tm57 is null "
      m_strSQL2_5 = m_strSQL2_5 + " AND tm57 is null "
   End If
    
   If Len(txt1(6)) <> 0 Then
       strSQL2 = strSQL2 + " AND TM10<='" & txt1(6) & "' "
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 + " AND TM10<='" & txt1(6) & "' "
       m_strSQL2_3 = m_strSQL2_3 + " AND TM10<='" & txt1(6) & "' "
       m_strSQL2_4 = m_strSQL2_4 + " AND TM10<='" & txt1(6) & "' "
       m_strSQL2_5 = m_strSQL2_5 + " AND TM10<='" & txt1(6) & "' "
   End If
   
   If UCase(txt1(7)) = "N" Then '若不含核駁
       'C類核駁的資料不出現
       strSQL2 = strSQL2 + " And '1002' <> CP10(+) "
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 + " And '1002' <> CP10(+) "
       m_strSQL2_3 = m_strSQL2_3 + " And '1002' <> CP10(+) "
       m_strSQL2_4 = m_strSQL2_4 + " And '1002' <> CP10(+) "
       m_strSQL2_5 = m_strSQL2_5 + " And '1002' <> CP10(+) "
   End If

   '是否含核駁
   If Me.txt1(7).Text <> "" Then
       'edit by nickc 2008/04/15 所有程序抓cp 期於抓tm
       If txt1(15) = "3" Then
           strSQL2 = strSQL2 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
           'add by nickc 2007/01/10
           m_strSQL2_2 = m_strSQL2_2 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
           m_strSQL2_3 = m_strSQL2_3 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
           m_strSQL2_4 = m_strSQL2_4 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
           m_strSQL2_5 = m_strSQL2_5 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
       Else
           strSQL2 = strSQL2 + " AND ( TM16<>'2' OR TM16 IS NULL ) "
           'add by nickc 2007/01/10
           m_strSQL2_2 = m_strSQL2_2 + " AND ( TM16<>'2' OR TM16 IS NULL ) "
           m_strSQL2_3 = m_strSQL2_3 + " AND ( TM16<>'2' OR TM16 IS NULL ) "
           m_strSQL2_4 = m_strSQL2_4 + " AND ( TM16<>'2' OR TM16 IS NULL ) "
           m_strSQL2_5 = m_strSQL2_5 + " AND ( TM16<>'2' OR TM16 IS NULL ) "
       End If
   End If

   'Modify by Morgan 2009/7/24 +延展已發文尚無結果的也要
   'Add by Morgan 2007/12/25
   '只印仍有效的
   If Check5.Value = 1 Then
       strSQL2 = strSQL2 + " AND ( TM22>=" & strSrvDate(1) & " OR TM22 IS NULL" & _
         " OR EXISTS(SELECT * FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04 AND B.CP10='102' AND B.CP27>0 AND B.CP57 IS NULL AND B.CP24 IS NULL)) "
       m_strSQL2_2 = m_strSQL2_2 + " AND ( TM22>=" & strSrvDate(1) & " OR TM22 IS NULL" & _
         " OR EXISTS(SELECT * FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04 AND B.CP10='102' AND B.CP27>0 AND B.CP57 IS NULL AND B.CP24 IS NULL)) "
       m_strSQL2_3 = m_strSQL2_3 + " AND ( TM22>=" & strSrvDate(1) & " OR TM22 IS NULL" & _
         " OR EXISTS(SELECT * FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04 AND B.CP10='102' AND B.CP27>0 AND B.CP57 IS NULL AND B.CP24 IS NULL)) "
       m_strSQL2_4 = m_strSQL2_4 + " AND ( TM22>=" & strSrvDate(1) & " OR TM22 IS NULL" & _
         " OR EXISTS(SELECT * FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04 AND B.CP10='102' AND B.CP27>0 AND B.CP57 IS NULL AND B.CP24 IS NULL)) "
       m_strSQL2_5 = m_strSQL2_5 + " AND ( TM22>=" & strSrvDate(1) & " OR TM22 IS NULL" & _
         " OR EXISTS(SELECT * FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04 AND B.CP10='102' AND B.CP27>0 AND B.CP57 IS NULL AND B.CP24 IS NULL)) "
   End If
   'end 2007/12/25
   
'   '有發證日
'   If Check5.Value = 1 Then
'       strSQL2 = strSQL2 + " AND ( TM20>0) "
'       m_strSQL2_2 = m_strSQL2_2 + " AND ( TM20>0) "
'       m_strSQL2_3 = m_strSQL2_3 + " AND ( TM20>0) "
'       m_strSQL2_4 = m_strSQL2_4 + " AND ( TM20>0) "
'       m_strSQL2_5 = m_strSQL2_5 + " AND ( TM22>0) "
'   End If
   

   '智權人員
   If Me.txt1(11).Text <> "" Then
       strSQL2 = strSQL2 + " AND CU13='" & Me.txt1(11).Text & "' "
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 + " AND CU13='" & Me.txt1(11).Text & "' "
       m_strSQL2_3 = m_strSQL2_3 + " AND CU13='" & Me.txt1(11).Text & "' "
       m_strSQL2_4 = m_strSQL2_4 + " AND CU13='" & Me.txt1(11).Text & "' "
       m_strSQL2_5 = m_strSQL2_5 + " AND CU13='" & Me.txt1(11).Text & "' "
   '若未輸入智權人員
   Else
       strSQL2 = strSQL2 + " AND CU13 Is Null "
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 + " AND CU13 Is Null "
       m_strSQL2_3 = m_strSQL2_3 + " AND CU13 Is Null "
       m_strSQL2_4 = m_strSQL2_4 + " AND CU13 Is Null "
       m_strSQL2_5 = m_strSQL2_5 + " AND CU13 Is Null "
   End If
   
   '若選擇列印首次接洽或最新收文程序
   If Me.txt1(15).Text = "1" Or Me.txt1(15).Text = "2" Then
       'Modify by Morgan 2005/5/16 若只有一道程序時取消的還是要印
       'strSQL2 = strSQL2 + " AND CP57 Is Null "
       strSQL2 = strSQL2 + " AND (CP57 Is Null" & _
         " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
         " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
         "))"
       'add by nickc 2007/01/10
       m_strSQL2_2 = m_strSQL2_2 + " AND (CP57 Is Null" & _
         " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
         " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
         "))"
       m_strSQL2_3 = m_strSQL2_3 + " AND (CP57 Is Null" & _
         " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
         " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
         "))"
       m_strSQL2_4 = m_strSQL2_4 + " AND (CP57 Is Null" & _
         " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
         " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
         "))"
       m_strSQL2_5 = m_strSQL2_5 + " AND (CP57 Is Null" & _
         " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
         " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
         "))"
   End If

   CheckOC
   
Select Case txt1(10)
   Case 1 '中文報表
      If Me.txt1(15).Text = "3" Then
         'B類收文的不續辦, 閉卷也要列印
         'Modify By Sindy 2011/3/15 +TM17
         strSql = " SELECT tm23,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm23),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('703', '704'))) AND SUBSTR(tm23,1,8)=CU01(+) AND DECODE(SUBSTR(tm23,9,1),NULL,'0',SUBSTR(tm23,9,1))=CU02(+) AND tm10=NA01(+)  " & strSQL2
         'add by nickc 2007/01/10
         strSql = strSql & " union all SELECT tm78,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm78),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('703', '704'))) AND SUBSTR(tm78,1,8)=CU01(+) AND DECODE(SUBSTR(tm78,9,1),NULL,'0',SUBSTR(tm78,9,1))=CU02(+) AND tm10=NA01(+)  " & m_strSQL2_2
         strSql = strSql & " union all SELECT tm79,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm79),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('703', '704'))) AND SUBSTR(tm79,1,8)=CU01(+) AND DECODE(SUBSTR(tm79,9,1),NULL,'0',SUBSTR(tm79,9,1))=CU02(+) AND tm10=NA01(+)  " & m_strSQL2_3
         strSql = strSql & " union all SELECT tm80,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm80),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('703', '704'))) AND SUBSTR(tm80,1,8)=CU01(+) AND DECODE(SUBSTR(tm80,9,1),NULL,'0',SUBSTR(tm80,9,1))=CU02(+) AND tm10=NA01(+)  " & m_strSQL2_4
         strSql = strSql & " union all SELECT tm81,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm81),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('703', '704'))) AND SUBSTR(tm81,1,8)=CU01(+) AND DECODE(SUBSTR(tm81,9,1),NULL,'0',SUBSTR(tm81,9,1))=CU02(+) AND tm10=NA01(+)  " & m_strSQL2_5
      '若為首次或最新程序(只抓A, B類)
      Else
         'Modify By Sindy 2011/3/15 +TM17
         strSql = " SELECT tm23,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm23),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09, TM01, TM02, TM03, TM04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND 'C'>CP09(+) AND SUBSTR(tm23,1,8)=CU01(+) AND DECODE(SUBSTR(tm23,9,1),NULL,'0',SUBSTR(tm23,9,1))=CU02(+) AND tm10=NA01(+)  " & strSQL2
         'add by nickc 2007/01/10
         strSql = strSql & " union all SELECT tm78,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm78),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09, TM01, TM02, TM03, TM04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND 'C'>CP09(+) AND SUBSTR(tm78,1,8)=CU01(+) AND DECODE(SUBSTR(tm78,9,1),NULL,'0',SUBSTR(tm78,9,1))=CU02(+) AND tm10=NA01(+)  " & m_strSQL2_2
         strSql = strSql & " union all SELECT tm79,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm79),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09, TM01, TM02, TM03, TM04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND 'C'>CP09(+) AND SUBSTR(tm79,1,8)=CU01(+) AND DECODE(SUBSTR(tm79,9,1),NULL,'0',SUBSTR(tm79,9,1))=CU02(+) AND tm10=NA01(+)  " & m_strSQL2_3
         strSql = strSql & " union all SELECT tm80,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm80),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09, TM01, TM02, TM03, TM04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND 'C'>CP09(+) AND SUBSTR(tm80,1,8)=CU01(+) AND DECODE(SUBSTR(tm80,9,1),NULL,'0',SUBSTR(tm80,9,1))=CU02(+) AND tm10=NA01(+)  " & m_strSQL2_4
         strSql = strSql & " union all SELECT tm81,tm45,NVL(Decode(cu04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),tm81),tm12,NVL(NA01,tm10),NVL(Nvl(decode(tm10,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(tm05,Nvl(TM06,TM07)),CP05," & SQLDate("CP57") & "||Decode(tm29,'Y','*',''),cp09, TM01, TM02, TM03, TM04," & SQLDate("TM11") & "," & SQLDate("CP27") & ", CP57,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND 'C'>CP09(+) AND SUBSTR(tm81,1,8)=CU01(+) AND DECODE(SUBSTR(tm81,9,1),NULL,'0',SUBSTR(tm81,9,1))=CU02(+) AND tm10=NA01(+)  " & m_strSQL2_5
      End If
      adoRecordset.CursorLocation = adUseClient
      k = 0
      adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
      If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
         InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
         With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = LBound(strTemp) To UBound(strTemp)
                    strTemp(i) = ""
                Next i
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If Right(strTemp(16), 1) = "*" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = Replace(strTemp(16), "*", "閉卷")
                End If
                '申請日
                strTemp(23) = "" & .Fields(22).Value
                '發文日
                strTemp(24) = "" & .Fields(23).Value
                CheckOC2
                strSql = "select min(pd05) from pridate where pd01='" & CheckStr(.Fields(18)) & "' and pd02='" & CheckStr(.Fields(19)) & "' and pd03='" & CheckStr(.Fields(20)) & "' and pd04='" & CheckStr(.Fields(21)) & "' "
                adoRecordset1.CursorLocation = adUseClient
                adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                If adoRecordset1.RecordCount <> 0 Then
                     strTemp(6) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                Else
                     strTemp(6) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5" '專利,服務
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>411 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8" '法務,顧問
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND np07 <> 6001 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6" '商標,服務
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>305 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify By Sindy 2011/3/15 FCT,T,TF延展(102)和第二期(716)專用權須存在(TM17=Y)
                     If (CheckStr(.Fields(18)) = "T" Or CheckStr(.Fields(18)) = "FCT" Or CheckStr(.Fields(18)) = "TF") And _
                        CheckStr("" & .Fields("TM17")) <> "Y" Then
                        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                        'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403,102,716) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                        strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     '2011/3/15 End
                     Else
                        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                        'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                        strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     End If
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 中文新增 R013028 存CP31
                strSql = "INSERT INTO R050317_C " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & PUB_GetRelateCasePropertyName(strTemp(17), Me.txt1(10).Text) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','" & "" & .Fields("CP57").Value & "',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
            'Modify by Amy 2017/07/25 更新R013028
            If IsHaveData = True Then
                strSql = "Update R050317_C Set R013028=(Select CP31 From CaseProgress Where R013018=CP09(+)) Where ID='" & strUserNum & "'"
                cnnConnection.Execute strSql
            End If
            'end 2017/07/25
         End With
         If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_c WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
    
Case 2 '英文報表
    '若為所有程序
    If Me.txt1(15).Text = "3" Then
        'Modify By Sindy 2011/3/15 +TM17
        strSql = " SELECT tm23,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm23),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or CP09>='C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm23,1,8)=CU01(+) AND DECODE(SUBSTR(tm23,9,1),NULL,'0',SUBSTR(tm23,9,1))=CU02(+) AND tm10=NA01(+) " & strSQL2
        'add by nickc 2007/01/10
        strSql = strSql & " union all SELECT tm78,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm78),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or CP09>='C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm78,1,8)=CU01(+) AND DECODE(SUBSTR(tm78,9,1),NULL,'0',SUBSTR(tm78,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_2
        strSql = strSql & " union all SELECT tm79,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm79),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or CP09>='C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm79,1,8)=CU01(+) AND DECODE(SUBSTR(tm79,9,1),NULL,'0',SUBSTR(tm79,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_3
        strSql = strSql & " union all SELECT tm80,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm80),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or CP09>='C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm80,1,8)=CU01(+) AND DECODE(SUBSTR(tm80,9,1),NULL,'0',SUBSTR(tm80,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_4
        strSql = strSql & " union all SELECT tm81,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm81),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or CP09>='C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm81,1,8)=CU01(+) AND DECODE(SUBSTR(tm81,9,1),NULL,'0',SUBSTR(tm81,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_5
    '若為首次或最新程序(只抓A, B類)
    Else
        'edit by nickc 2005/11/11 修正錯誤
        'strSQL = " SELECT tm23,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm23),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09, TM01, TM02, TM03, TM04 FROM trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm23,1,8)=CU01(+) AND DECODE(SUBSTR(tm23,9,1),NULL,'0',SUBSTR(tm23,9,1))=CU02(+) AND tm10=NA01(+) " & strSQL2
        'Modify By Sindy 2011/3/15 +TM17
        strSql = " SELECT tm23,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm23),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm23,1,8)=CU01(+) AND DECODE(SUBSTR(tm23,9,1),NULL,'0',SUBSTR(tm23,9,1))=CU02(+) AND tm10=NA01(+) " & strSQL2
        'add by nickc 2007/01/10
        strSql = strSql & " union all SELECT tm78,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm78),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm78,1,8)=CU01(+) AND DECODE(SUBSTR(tm78,9,1),NULL,'0',SUBSTR(tm78,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_2
        strSql = strSql & " union all SELECT tm79,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm79),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm79,1,8)=CU01(+) AND DECODE(SUBSTR(tm79,9,1),NULL,'0',SUBSTR(tm79,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_3
        strSql = strSql & " union all SELECT tm80,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm80),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm80,1,8)=CU01(+) AND DECODE(SUBSTR(tm80,9,1),NULL,'0',SUBSTR(tm80,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_4
        strSql = strSql & " union all SELECT tm81,tm45,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),tm81),tm12,NVL(NA01,tm10),NVL(Nvl(cpm10,CPM13),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm06,TM07)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm81,1,8)=CU01(+) AND DECODE(SUBSTR(tm81,9,1),NULL,'0',SUBSTR(tm81,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_5
    End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "Closed"
                Else
                    strTemp(16) = ""
                End If
                CheckOC2
                strSql = "select min(pd05) from pridate where pd01='" & CheckStr(.Fields(18)) & "' and pd02='" & CheckStr(.Fields(19)) & "' and pd03='" & CheckStr(.Fields(20)) & "' and pd04='" & CheckStr(.Fields(21)) & "' "
                adoRecordset1.CursorLocation = adUseClient
                adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                If adoRecordset1.RecordCount <> 0 Then
                     strTemp(6) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                Else
                     strTemp(6) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>411 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>305 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify By Sindy 2011/3/15 FCT,T,TF延展(102)和第二期(716)專用權須存在(TM17=Y)
                     If (CheckStr(.Fields(18)) = "T" Or CheckStr(.Fields(18)) = "FCT" Or CheckStr(.Fields(18)) = "TF") And _
                        CheckStr("" & .Fields("TM17")) <> "Y" Then
                        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                        'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403,102,716) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                        strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     '2011/3/15 End
                     Else
                        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                        'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                        strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     End If
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
'                strSQL = "INSERT INTO R050317_E values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "') "
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_E " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            '
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            'CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
                'cnnConnection.Execute "DELETE FROM R050317_E WHERE SUBSTR(R013012,1,1)='C' AND R013012<>'" & chgsql(CheckStr(adoRecordset1.Fields(0))) & "' AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 3 '日文報表
    '若為所有程序
    If Me.txt1(15).Text = "3" Then
        'Modify By Sindy 2011/3/15 +TM17
        strSql = " SELECT tm23,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm23),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM Trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm23,1,8)=CU01(+) AND DECODE(SUBSTR(tm23,9,1),NULL,'0',SUBSTR(tm23,9,1))=CU02(+) AND tm10=NA01(+) " & strSQL2
        'add by nickc 2007/01/10
        strSql = strSql & " union all SELECT tm78,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm78),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM Trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm78,1,8)=CU01(+) AND DECODE(SUBSTR(tm78,9,1),NULL,'0',SUBSTR(tm78,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_2
        strSql = strSql & " union all SELECT tm79,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm79),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM Trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm79,1,8)=CU01(+) AND DECODE(SUBSTR(tm79,9,1),NULL,'0',SUBSTR(tm79,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_3
        strSql = strSql & " union all SELECT tm80,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm80),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM Trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm80,1,8)=CU01(+) AND DECODE(SUBSTR(tm80,9,1),NULL,'0',SUBSTR(tm80,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_4
        strSql = strSql & " union all SELECT tm81,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm81),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09,cp01,cp02,cp03,cp04,TM17 FROM Trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(tm81,1,8)=CU01(+) AND DECODE(SUBSTR(tm81,9,1),NULL,'0',SUBSTR(tm81,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_5
    '若為首次或最新程序(只抓A, B類)
    Else
        'edit by nickc 2005/11/11 修正錯誤
        'strSQL = " SELECT tm23,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm23),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09, TM01, TM02, TM03, TM04 FROM Trademark,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm23,1,8)=CU01(+) AND DECODE(SUBSTR(tm23,9,1),NULL,'0',SUBSTR(tm23,9,1))=CU02(+) AND tm10=NA01(+) " & strSQL2
        'Modify By Sindy 2011/3/15 +TM17
        strSql = " SELECT tm23,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm23),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM Trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm23,1,8)=CU01(+) AND DECODE(SUBSTR(tm23,9,1),NULL,'0',SUBSTR(tm23,9,1))=CU02(+) AND tm10=NA01(+) " & strSQL2
        'add by nickc 2007/01/10
        strSql = strSql & " union all SELECT tm78,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm78),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM Trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm78,1,8)=CU01(+) AND DECODE(SUBSTR(tm78,9,1),NULL,'0',SUBSTR(tm78,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_2
        strSql = strSql & " union all SELECT tm79,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm79),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM Trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm79,1,8)=CU01(+) AND DECODE(SUBSTR(tm79,9,1),NULL,'0',SUBSTR(tm79,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_3
        strSql = strSql & " union all SELECT tm80,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm80),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM Trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm80,1,8)=CU01(+) AND DECODE(SUBSTR(tm80,9,1),NULL,'0',SUBSTR(tm80,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_4
        strSql = strSql & " union all SELECT tm81,tm45,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),tm81),tm12,NVL(NA01,tm10),NVL(Nvl(cpm13,CPM10),CP10),' ',' ',tm35,tm01||'-'||tm02||decode(tm03||tm04,'000','','-'||tm03||'-'||tm04),tm15,tm21||'='||tm22,tm14,tm09,Nvl(TM05, Nvl(tm07,TM06)),CP05,tm29,cp09, TM01, TM02, TM03, TM04,TM17 FROM Trademark,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP09<'C' AND SUBSTR(tm81,1,8)=CU01(+) AND DECODE(SUBSTR(tm81,9,1),NULL,'0',SUBSTR(tm81,9,1))=CU02(+) AND tm10=NA01(+) " & m_strSQL2_5
    End If
    CheckOC
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "ゾゆ"
                Else
                    strTemp(16) = ""
                End If
                CheckOC2
                strSql = "select min(pd05) from pridate where pd01='" & CheckStr(.Fields(18)) & "' and pd02='" & CheckStr(.Fields(19)) & "' and pd03='" & CheckStr(.Fields(20)) & "' and pd04='" & CheckStr(.Fields(21)) & "' "
                adoRecordset1.CursorLocation = adUseClient
                adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                If adoRecordset1.RecordCount <> 0 Then
                     strTemp(6) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                Else
                     strTemp(6) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>411 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>305 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify By Sindy 2011/3/15 FCT,T,TF延展(102)和第二期(716)專用權須存在(TM17=Y)
                     If (CheckStr(.Fields(18)) = "T" Or CheckStr(.Fields(18)) = "FCT" Or CheckStr(.Fields(18)) = "TF") And _
                        CheckStr("" & .Fields("TM17")) <> "Y" Then
                        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                        'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403,102,716) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                        strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (102,716) " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     '2011/3/15 End
                     Else
                        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                        'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                        strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     End If
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
'                strSQL = "INSERT INTO R050317_J values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & " ','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "') "
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_J " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & " ','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            '
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            'CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
                'cnnConnection.Execute "DELETE FROM R050317_E WHERE SUBSTR(R013012,1,1)='C' AND R013012<>'" & chgsql(CheckStr(adoRecordset1.Fields(0))) & "' AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case Else
End Select
'Add by Amy 2017/12/26 剔除D類
cnnConnection.Execute "Delete From R050317_C WHERE ID='" & strUserNum & "'  And SubStr(R013018,1,1)='D' "     '語文為中文      對內
cnnConnection.Execute "Delete From R050317_E WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為英文    對外
cnnConnection.Execute "Delete From R050317_J WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為日文   對外
'end 2017/12/26
Select Case txt1(10)
Case 1     '中文
    '列印所有程序
    If Me.txt1(15).Text = "3" Then
        PrintDataCt
    '列印首次或最新程序
    Else
        PrintDataCt_A4
    End If
Case 2     '英文
   PrintDataEt
Case 3     '日文
   PrintDataJt
Case Else
End Select
'ShowPrintOk
'Screen.MousePointer = vbDefault

ErrHnd:
   If Err.Number <> 0 Then MsgBox Err.Description
   'Resume
End Sub

Private Sub ProcessP()
Screen.MousePointer = vbHourglass
'add by nickc 2005/11/09 紙本
If Check3(0).Value = vbChecked Then
    '若下所有程序或英日報表
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        Printer.Orientation = 1
        'Modified by Morgan 2015/6/2
        'Printer.PaperSize = 39
        Printer.PaperSize = PUB_GetPaperSize(15)
        'END 2015/6/2
        o_PaperHeight = 14200
    '其他
    Else
        Printer.Orientation = 2
        Printer.PaperSize = 9
        o_PaperHeight = 10000
    End If
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        o_PaperHeight = 50 'Modify by Amy 2019/11/21 原:56
    Else
        o_PaperHeight = 40
    End If
End If
m_strPrintKind = "0"
cnnConnection.Execute "delete from R050317_C WHERE ID='" & strUserNum & "' "     '語文為中文      對內
cnnConnection.Execute "DELETE FROM R050317_E WHERE ID='" & strUserNum & "' "     '語文為英文    對外
cnnConnection.Execute "DELETE FROM R050317_J WHERE ID='" & strUserNum & "' "     '語文為日文   對外
strSQL1 = ""
strSQL2 = ""
StrSQL3 = ""
StrSQL4 = ""
strSQL5 = ""
'初始化變數
m_strSQL1_2 = "": m_strSQL1_3 = "": m_strSQL1_4 = "": m_strSQL1_5 = ""
m_strSQL5_2 = "": m_strSQL5_3 = "": m_strSQL5_4 = "": m_strSQL5_5 = ""
'Add By Sindy 2011/2/23
m_strSQL3_2 = "": m_strSQL3_3 = "": m_strSQL3_4 = "": m_strSQL3_5 = ""
m_strSQL4_2 = "": m_strSQL4_3 = "": m_strSQL4_4 = "": m_strSQL4_5 = ""
'2011/2/23 End

strSQL1 = strSQL1 + " AND (PA26>='" & GetNewFagent(txt1(0)) & "' AND PA26<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL1_2 = m_strSQL1_2 + " AND (PA27>='" & GetNewFagent(txt1(0)) & "' AND PA27<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL1_3 = m_strSQL1_3 + " AND (PA28>='" & GetNewFagent(txt1(0)) & "' AND PA28<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL1_4 = m_strSQL1_4 + " AND (PA29>='" & GetNewFagent(txt1(0)) & "' AND PA29<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL1_5 = m_strSQL1_5 + " AND (PA30>='" & GetNewFagent(txt1(0)) & "' AND PA30<='" & GetNewFagent(txt1(1)) & "') "
StrSQL3 = StrSQL3 + " AND (LC11>='" & GetNewFagent(txt1(0)) & "' AND LC11<='" & GetNewFagent(txt1(1)) & "') "
'Add By Sindy 2011/2/23
m_strSQL3_2 = m_strSQL3_2 + " AND (LC43>='" & GetNewFagent(txt1(0)) & "' AND LC43<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL3_3 = m_strSQL3_3 + " AND (LC44>='" & GetNewFagent(txt1(0)) & "' AND LC44<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL3_4 = m_strSQL3_4 + " AND (LC45>='" & GetNewFagent(txt1(0)) & "' AND LC45<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL3_5 = m_strSQL3_5 + " AND (LC46>='" & GetNewFagent(txt1(0)) & "' AND LC46<='" & GetNewFagent(txt1(1)) & "') "
'2011/2/23 End
StrSQL4 = StrSQL4 + " AND (HC05>='" & GetNewFagent(txt1(0)) & "' AND HC05<='" & GetNewFagent(txt1(1)) & "') "
'Add By Sindy 2011/2/23
m_strSQL4_2 = m_strSQL4_2 + " AND (HC24>='" & GetNewFagent(txt1(0)) & "' AND HC24<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL4_3 = m_strSQL4_3 + " AND (HC25>='" & GetNewFagent(txt1(0)) & "' AND HC25<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL4_4 = m_strSQL4_4 + " AND (HC26>='" & GetNewFagent(txt1(0)) & "' AND HC26<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL4_5 = m_strSQL4_5 + " AND (HC27>='" & GetNewFagent(txt1(0)) & "' AND HC27<='" & GetNewFagent(txt1(1)) & "') "
'2011/2/23 End
strSQL5 = strSQL5 + " AND (SP08>='" & GetNewFagent(txt1(0)) & "' AND SP08<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL5_2 = m_strSQL5_2 + " AND (SP58>='" & GetNewFagent(txt1(0)) & "' AND SP58<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL5_3 = m_strSQL5_3 + " AND (SP59>='" & GetNewFagent(txt1(0)) & "' AND SP59<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL5_4 = m_strSQL5_4 + " AND (SP65>='" & GetNewFagent(txt1(0)) & "' AND SP65<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL5_5 = m_strSQL5_5 + " AND (SP66>='" & GetNewFagent(txt1(0)) & "' AND SP66<='" & GetNewFagent(txt1(1)) & "') "
'系統類別
If Len(txt1(2)) <> 0 Then
    strSQL1 = strSQL1 & " and PA01 in (" & SQLGrpStr(txt1(2), 1) & ") "
    m_strSQL1_2 = m_strSQL1_2 & " and PA01 in (" & SQLGrpStr(txt1(2), 1) & ") "
    m_strSQL1_3 = m_strSQL1_3 & " and PA01 in (" & SQLGrpStr(txt1(2), 1) & ") "
    m_strSQL1_4 = m_strSQL1_4 & " and PA01 in (" & SQLGrpStr(txt1(2), 1) & ") "
    m_strSQL1_5 = m_strSQL1_5 & " and PA01 in (" & SQLGrpStr(txt1(2), 1) & ") "
    StrSQL3 = StrSQL3 & " and LC01 in (" & SQLGrpStr(txt1(2), 3) & ") "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 & " and LC01 in (" & SQLGrpStr(txt1(2), 3) & ") "
    m_strSQL3_3 = m_strSQL3_3 & " and LC01 in (" & SQLGrpStr(txt1(2), 3) & ") "
    m_strSQL3_4 = m_strSQL3_4 & " and LC01 in (" & SQLGrpStr(txt1(2), 3) & ") "
    m_strSQL3_5 = m_strSQL3_5 & " and LC01 in (" & SQLGrpStr(txt1(2), 3) & ") "
    '2011/2/23 End
    StrSQL4 = StrSQL4 & " and HC01 in (" & SQLGrpStr(txt1(2), 4) & ") "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 & " and HC01 in (" & SQLGrpStr(txt1(2), 4) & ") "
    m_strSQL4_3 = m_strSQL4_3 & " and HC01 in (" & SQLGrpStr(txt1(2), 4) & ") "
    m_strSQL4_4 = m_strSQL4_4 & " and HC01 in (" & SQLGrpStr(txt1(2), 4) & ") "
    m_strSQL4_5 = m_strSQL4_5 & " and HC01 in (" & SQLGrpStr(txt1(2), 4) & ") "
    '2011/2/23 End
    strSQL5 = strSQL5 & " and SP01 in (" & SQLGrpStr(txt1(2), 5) & ") "
    m_strSQL5_2 = m_strSQL5_2 & " and SP01 in (" & SQLGrpStr(txt1(2), 5) & ") "
    m_strSQL5_3 = m_strSQL5_3 & " and SP01 in (" & SQLGrpStr(txt1(2), 5) & ") "
    m_strSQL5_4 = m_strSQL5_4 & " and SP01 in (" & SQLGrpStr(txt1(2), 5) & ") "
    m_strSQL5_5 = m_strSQL5_5 & " and SP01 in (" & SQLGrpStr(txt1(2), 5) & ") "
End If
'收文日區間
If Len(txt1(3)) <> 0 Then
   strSQL1 = strSQL1 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL1_2 = m_strSQL1_2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL1_3 = m_strSQL1_3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL1_4 = m_strSQL1_4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL1_5 = m_strSQL1_5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   StrSQL3 = StrSQL3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   'Add By Sindy 2011/2/23
   m_strSQL3_2 = m_strSQL3_2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL3_3 = m_strSQL3_3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL3_4 = m_strSQL3_4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL3_5 = m_strSQL3_5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   '2011/2/23 End
   StrSQL4 = StrSQL4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   'Add By Sindy 2011/2/23
   m_strSQL4_2 = m_strSQL4_2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL4_3 = m_strSQL4_3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL4_4 = m_strSQL4_4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL4_5 = m_strSQL4_5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   '2011/2/23 End
   strSQL5 = strSQL5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL5_2 = m_strSQL5_2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL5_3 = m_strSQL5_3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL5_4 = m_strSQL5_4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL5_5 = m_strSQL5_5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
End If
If Len(txt1(4)) <> 0 Then
   strSQL1 = strSQL1 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL1_2 = m_strSQL1_2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL1_3 = m_strSQL1_3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL1_4 = m_strSQL1_4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL1_5 = m_strSQL1_5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   StrSQL3 = StrSQL3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   'Add By Sindy 2011/2/23
   m_strSQL3_2 = m_strSQL3_2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL3_3 = m_strSQL3_3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL3_4 = m_strSQL3_4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL3_5 = m_strSQL3_5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   '2011/2/23 End
   StrSQL4 = StrSQL4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   'Add By Sindy 2011/2/23
   m_strSQL4_2 = m_strSQL4_2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL4_3 = m_strSQL4_3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL4_4 = m_strSQL4_4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL4_5 = m_strSQL4_5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   '2011/2/23 End
   strSQL5 = strSQL5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL5_2 = m_strSQL5_2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL5_3 = m_strSQL5_3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL5_4 = m_strSQL5_4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL5_5 = m_strSQL5_5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
Else
   If Len(txt1(3)) <> 0 Then
      strSQL1 = strSQL1 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL1_2 = m_strSQL1_2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL1_3 = m_strSQL1_3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL1_4 = m_strSQL1_4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL1_5 = m_strSQL1_5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      StrSQL3 = StrSQL3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      'Add By Sindy 2011/2/23
      m_strSQL3_2 = m_strSQL3_2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL3_3 = m_strSQL3_3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL3_4 = m_strSQL3_4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL3_5 = m_strSQL3_5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      '2011/2/23 End
      StrSQL4 = StrSQL4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      'Add By Sindy 2011/2/23
      m_strSQL4_2 = m_strSQL4_2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL4_3 = m_strSQL4_3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL4_4 = m_strSQL4_4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL4_5 = m_strSQL4_5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      '2011/2/23 End
      strSQL5 = strSQL5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL5_2 = m_strSQL5_2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL5_3 = m_strSQL5_3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL5_4 = m_strSQL5_4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL5_5 = m_strSQL5_5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
   End If
End If
'申請日區間
'Modify by Amy 2017/12/26 Or 申請日Is Null拿掉
If Me.txt1(13).Text <> "" And Me.txt1(14).Text = "" Then
    'strSQL1 = strSQL1 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " ) Or PA10 Is Null ) "
    strSQL1 = strSQL1 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
    m_strSQL1_2 = m_strSQL1_2 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
    m_strSQL1_3 = m_strSQL1_3 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
    m_strSQL1_4 = m_strSQL1_4 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
    m_strSQL1_5 = m_strSQL1_5 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
    strSQL5 = strSQL5 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
    m_strSQL5_2 = m_strSQL5_2 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
    m_strSQL5_3 = m_strSQL5_3 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
    m_strSQL5_4 = m_strSQL5_4 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
    m_strSQL5_5 = m_strSQL5_5 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
End If
If Me.txt1(13).Text = "" And Me.txt1(14).Text <> "" Then
    strSQL1 = strSQL1 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL1_2 = m_strSQL1_2 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL1_3 = m_strSQL1_3 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL1_4 = m_strSQL1_4 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL1_5 = m_strSQL1_5 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    strSQL5 = strSQL5 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  )"
    m_strSQL5_2 = m_strSQL5_2 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL5_3 = m_strSQL5_3 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL5_4 = m_strSQL5_4 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL5_5 = m_strSQL5_5 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
End If
If Me.txt1(13).Text <> "" And Me.txt1(14).Text <> "" Then
    strSQL1 = strSQL1 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL1_2 = m_strSQL1_2 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL1_3 = m_strSQL1_3 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL1_4 = m_strSQL1_4 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL1_5 = m_strSQL1_5 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    strSQL5 = strSQL5 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL5_2 = m_strSQL5_2 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL5_3 = m_strSQL5_3 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL5_4 = m_strSQL5_4 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL5_5 = m_strSQL5_5 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
End If
'end 2017/12/26
'申請國家
If Len(txt1(5)) <> 0 Then
    strSQL1 = strSQL1 + " AND PA09>='" & txt1(5) & "' "
    m_strSQL1_2 = m_strSQL1_2 + " AND PA09>='" & txt1(5) & "' "
    m_strSQL1_3 = m_strSQL1_3 + " AND PA09>='" & txt1(5) & "' "
    m_strSQL1_4 = m_strSQL1_4 + " AND PA09>='" & txt1(5) & "' "
    m_strSQL1_5 = m_strSQL1_5 + " AND PA09>='" & txt1(5) & "' "
    StrSQL3 = StrSQL3 + " AND LC15>='" & txt1(5) & "' "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND LC15>='" & txt1(5) & "' "
    m_strSQL3_3 = m_strSQL3_3 + " AND LC15>='" & txt1(5) & "' "
    m_strSQL3_4 = m_strSQL3_4 + " AND LC15>='" & txt1(5) & "' "
    m_strSQL3_5 = m_strSQL3_5 + " AND LC15>='" & txt1(5) & "' "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND SP09>='" & txt1(5) & "' "
    m_strSQL5_2 = m_strSQL5_2 + " AND SP09>='" & txt1(5) & "' "
    m_strSQL5_3 = m_strSQL5_3 + " AND SP09>='" & txt1(5) & "' "
    m_strSQL5_4 = m_strSQL5_4 + " AND SP09>='" & txt1(5) & "' "
    m_strSQL5_5 = m_strSQL5_5 + " AND SP09>='" & txt1(5) & "' "
End If

'add by nickc 2005/11/24 加入閉卷選擇
If ChkClose.Value <> vbChecked Then
    strSQL1 = strSQL1 + " AND (PA57<>'Y' or pa57 is null) "
    m_strSQL1_2 = m_strSQL1_2 + " AND (PA57<>'Y' or pa57 is null) "
    m_strSQL1_3 = m_strSQL1_3 + " AND (PA57<>'Y' or pa57 is null) "
    m_strSQL1_4 = m_strSQL1_4 + " AND (PA57<>'Y' or pa57 is null) "
    m_strSQL1_5 = m_strSQL1_5 + " AND (PA57<>'Y' or pa57 is null) "
    StrSQL3 = StrSQL3 + " AND (lc08<>'Y' or lc08 is null) "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND (lc08<>'Y' or lc08 is null) "
    m_strSQL3_3 = m_strSQL3_3 + " AND (lc08<>'Y' or lc08 is null) "
    m_strSQL3_4 = m_strSQL3_4 + " AND (lc08<>'Y' or lc08 is null) "
    m_strSQL3_5 = m_strSQL3_5 + " AND (lc08<>'Y' or lc08 is null) "
    '2011/2/23 End
    StrSQL4 = StrSQL4 + " AND (hc09<>'Y' or hc09 is null) "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 + " AND (hc09<>'Y' or hc09 is null) "
    m_strSQL4_3 = m_strSQL4_3 + " AND (hc09<>'Y' or hc09 is null) "
    m_strSQL4_4 = m_strSQL4_4 + " AND (hc09<>'Y' or hc09 is null) "
    m_strSQL4_5 = m_strSQL4_5 + " AND (hc09<>'Y' or hc09 is null) "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND (sp15<>'Y' or sp15 is null) "
    m_strSQL5_2 = m_strSQL5_2 + " AND (sp15<>'Y' or sp15 is null) "
    m_strSQL5_3 = m_strSQL5_3 + " AND (sp15<>'Y' or sp15 is null) "
    m_strSQL5_4 = m_strSQL5_4 + " AND (sp15<>'Y' or sp15 is null) "
    m_strSQL5_5 = m_strSQL5_5 + " AND (sp15<>'Y' or sp15 is null) "
End If

'Added by Morgan 2017/1/13 已閉卷或銷卷或核駁
If Check12.Value = vbChecked Then
    strSQL1 = strSQL1 + " AND (PA57||PA108 is not null or pa16='2') "
    m_strSQL1_2 = m_strSQL1_2 + " AND (PA57||PA108 is not null or pa16='2') "
    m_strSQL1_3 = m_strSQL1_3 + " AND (PA57||PA108 is not null or pa16='2') "
    m_strSQL1_4 = m_strSQL1_4 + " AND (PA57||PA108 is not null or pa16='2') "
    m_strSQL1_5 = m_strSQL1_5 + " AND (PA57||PA108 is not null or pa16='2') "
    StrSQL3 = StrSQL3 + " AND lc08||lc34 is not null "
    m_strSQL3_2 = m_strSQL3_2 + " AND lc08||lc34 is not null "
    m_strSQL3_3 = m_strSQL3_3 + " AND lc08||lc34 is not null "
    m_strSQL3_4 = m_strSQL3_4 + " AND lc08||lc34 is not null "
    m_strSQL3_5 = m_strSQL3_5 + " AND lc08||lc34 is not null "
    StrSQL4 = StrSQL4 + " AND (hc09||hc19 is not null "
    m_strSQL4_2 = m_strSQL4_2 + " AND hc09||hc19 is not null "
    m_strSQL4_3 = m_strSQL4_3 + " AND hc09||hc19 is not null "
    m_strSQL4_4 = m_strSQL4_4 + " AND hc09||hc19 is not null "
    m_strSQL4_5 = m_strSQL4_5 + " AND hc09||hc19 is not null "
    strSQL5 = strSQL5 + " AND sp15||sp61 is not null "
    m_strSQL5_2 = m_strSQL5_2 + " AND sp15||sp61 is not null "
    m_strSQL5_3 = m_strSQL5_3 + " AND sp15||sp61 is not null "
    m_strSQL5_4 = m_strSQL5_4 + " AND sp15||sp61 is not null "
    m_strSQL5_5 = m_strSQL5_5 + " AND sp15||sp61 is not null "
End If

'Added by Morgan 2015/9/16 已閉卷或銷卷
If Check11.Value = vbChecked Then
    strSQL1 = strSQL1 + " AND PA57||PA108 is not null "
    m_strSQL1_2 = m_strSQL1_2 + " AND PA57||PA108 is not null "
    m_strSQL1_3 = m_strSQL1_3 + " AND PA57||PA108 is not null "
    m_strSQL1_4 = m_strSQL1_4 + " AND PA57||PA108 is not null "
    m_strSQL1_5 = m_strSQL1_5 + " AND PA57||PA108 is not null "
    StrSQL3 = StrSQL3 + " AND lc08||lc34 is not null "
    m_strSQL3_2 = m_strSQL3_2 + " AND lc08||lc34 is not null "
    m_strSQL3_3 = m_strSQL3_3 + " AND lc08||lc34 is not null "
    m_strSQL3_4 = m_strSQL3_4 + " AND lc08||lc34 is not null "
    m_strSQL3_5 = m_strSQL3_5 + " AND lc08||lc34 is not null "
    StrSQL4 = StrSQL4 + " AND hc09||hc19 is not null "
    m_strSQL4_2 = m_strSQL4_2 + " AND hc09||hc19 is not null "
    m_strSQL4_3 = m_strSQL4_3 + " AND hc09||hc19 is not null "
    m_strSQL4_4 = m_strSQL4_4 + " AND hc09||hc19 is not null "
    m_strSQL4_5 = m_strSQL4_5 + " AND hc09||hc19 is not null "
    strSQL5 = strSQL5 + " AND sp15||sp61 is not null "
    m_strSQL5_2 = m_strSQL5_2 + " AND sp15||sp61 is not null "
    m_strSQL5_3 = m_strSQL5_3 + " AND sp15||sp61 is not null "
    m_strSQL5_4 = m_strSQL5_4 + " AND sp15||sp61 is not null "
    m_strSQL5_5 = m_strSQL5_5 + " AND sp15||sp61 is not null "
End If
'end 2015/9/16

'Add by Morgan 2011/1/13 +只印申請案
If Check7.Value = vbChecked Then
   strSQL1 = strSQL1 + " AND pa23='1' "
   m_strSQL1_2 = m_strSQL1_2 + " AND pa23='1' "
   m_strSQL1_3 = m_strSQL1_3 + " AND pa23='1' "
   m_strSQL1_4 = m_strSQL1_4 + " AND pa23='1' "
   m_strSQL1_5 = m_strSQL1_5 + " AND pa23='1' "
End If
   
'Add by Morgan 2011/10/13 +只印已核准
If Check8.Value = vbChecked Then
   strSQL1 = strSQL1 + " AND pa16='1' "
   m_strSQL1_2 = m_strSQL1_2 + " AND pa16='1' "
   m_strSQL1_3 = m_strSQL1_3 + " AND pa16='1' "
   m_strSQL1_4 = m_strSQL1_4 + " AND pa16='1' "
   m_strSQL1_5 = m_strSQL1_5 + " AND pa16='1' "
End If

'Add by Morgan 2013/12/24 +只印未核准(核駁或申請中)
If Check9.Value = vbChecked Then
   strSQL1 = strSQL1 + " AND nvl(pa16,'2')='2' "
   m_strSQL1_2 = m_strSQL1_2 + " AND nvl(pa16,'2')='2' "
   m_strSQL1_3 = m_strSQL1_3 + " AND nvl(pa16,'2')='2' "
   m_strSQL1_4 = m_strSQL1_4 + " AND nvl(pa16,'2')='2' "
   m_strSQL1_5 = m_strSQL1_5 + " AND nvl(pa16,'2')='2' "
End If


'Add by Morgan 2008/4/9 +銷卷選擇
If Check6.Value <> vbChecked Then
   strSQL1 = strSQL1 + " AND pa108 is null "
   m_strSQL1_2 = m_strSQL1_2 + " AND pa108 is null "
   m_strSQL1_3 = m_strSQL1_3 + " AND pa108 is null "
   m_strSQL1_4 = m_strSQL1_4 + " AND pa108 is null "
   m_strSQL1_5 = m_strSQL1_5 + " AND pa108 is null "
   StrSQL3 = StrSQL3 + " AND lc34 is null "
   'Add By Sindy 2011/2/23
   m_strSQL3_2 = m_strSQL3_2 + " AND lc34 is null "
   m_strSQL3_3 = m_strSQL3_3 + " AND lc34 is null "
   m_strSQL3_4 = m_strSQL3_4 + " AND lc34 is null "
   m_strSQL3_5 = m_strSQL3_5 + " AND lc34 is null "
   '2011/2/23 End
   StrSQL4 = StrSQL4 + " AND hc19 is null "
   'Add By Sindy 2011/2/23
   m_strSQL4_2 = m_strSQL4_2 + " AND hc19 is null "
   m_strSQL4_3 = m_strSQL4_3 + " AND hc19 is null "
   m_strSQL4_4 = m_strSQL4_4 + " AND hc19 is null "
   m_strSQL4_5 = m_strSQL4_5 + " AND hc19 is null "
   '2011/2/23 End
   strSQL5 = strSQL5 + " AND sp61 is null "
   m_strSQL5_2 = m_strSQL5_2 + " AND sp61 is null "
   m_strSQL5_3 = m_strSQL5_3 + " AND sp61 is null "
   m_strSQL5_4 = m_strSQL5_4 + " AND sp61 is null "
   m_strSQL5_5 = m_strSQL5_5 + " AND sp61 is null "
End If
    
If Len(txt1(6)) <> 0 Then
    strSQL1 = strSQL1 + " AND PA09<='" & txt1(6) & "' "
    m_strSQL1_2 = m_strSQL1_2 + " AND PA09<='" & txt1(6) & "' "
    m_strSQL1_3 = m_strSQL1_3 + " AND PA09<='" & txt1(6) & "' "
    m_strSQL1_4 = m_strSQL1_4 + " AND PA09<='" & txt1(6) & "' "
    m_strSQL1_5 = m_strSQL1_5 + " AND PA09<='" & txt1(6) & "' "
    StrSQL3 = StrSQL3 + " AND LC15<='" & txt1(6) & "' "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND LC15<='" & txt1(6) & "' "
    m_strSQL3_3 = m_strSQL3_3 + " AND LC15<='" & txt1(6) & "' "
    m_strSQL3_4 = m_strSQL3_4 + " AND LC15<='" & txt1(6) & "' "
    m_strSQL3_5 = m_strSQL3_5 + " AND LC15<='" & txt1(6) & "' "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND SP09<='" & txt1(6) & "' "
    m_strSQL5_2 = m_strSQL5_2 + " AND SP09<='" & txt1(6) & "' "
    m_strSQL5_3 = m_strSQL5_3 + " AND SP09<='" & txt1(6) & "' "
    m_strSQL5_4 = m_strSQL5_4 + " AND SP09<='" & txt1(6) & "' "
    m_strSQL5_5 = m_strSQL5_5 + " AND SP09<='" & txt1(6) & "' "
End If
If UCase(txt1(7)) = "N" Then
    'Add By Cheng 2003/02/10
    'C類核駁的資料不出現
    strSQL1 = strSQL1 + " AND CP10 <> '1002' "
    m_strSQL1_2 = m_strSQL1_2 + " AND CP10 <> '1002' "
    m_strSQL1_3 = m_strSQL1_3 + " AND CP10 <> '1002' "
    m_strSQL1_4 = m_strSQL1_4 + " AND CP10 <> '1002' "
    m_strSQL1_5 = m_strSQL1_5 + " AND CP10 <> '1002' "
    StrSQL3 = StrSQL3 + " AND CP10 <> '1002' "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND CP10 <> '1002' "
    m_strSQL3_3 = m_strSQL3_3 + " AND CP10 <> '1002' "
    m_strSQL3_4 = m_strSQL3_4 + " AND CP10 <> '1002' "
    m_strSQL3_5 = m_strSQL3_5 + " AND CP10 <> '1002' "
    '2011/2/23 End
    StrSQL4 = StrSQL4 + " AND CP10 <> '1002' "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 + " AND CP10 <> '1002' "
    m_strSQL4_3 = m_strSQL4_3 + " AND CP10 <> '1002' "
    m_strSQL4_4 = m_strSQL4_4 + " AND CP10 <> '1002' "
    m_strSQL4_5 = m_strSQL4_5 + " AND CP10 <> '1002' "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND CP10 <> '1002' "
    m_strSQL5_2 = m_strSQL5_2 + " AND CP10 <> '1002' "
    m_strSQL5_3 = m_strSQL5_3 + " AND CP10 <> '1002' "
    m_strSQL5_4 = m_strSQL5_4 + " AND CP10 <> '1002' "
    m_strSQL5_5 = m_strSQL5_5 + " AND CP10 <> '1002' "
End If
'Add By Cheng 2003/05/22
'是否含核駁
If Me.txt1(7).Text <> "" Then
    'edit by nickc 2008/04/15 所有程序抓cp，其餘抓pa
    If txt1(15) = "3" Then
        strSQL1 = strSQL1 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
        m_strSQL1_2 = m_strSQL1_2 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
        m_strSQL1_3 = m_strSQL1_3 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
        m_strSQL1_4 = m_strSQL1_4 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
        m_strSQL1_5 = m_strSQL1_5 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
    Else
        strSQL1 = strSQL1 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
        m_strSQL1_2 = m_strSQL1_2 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
        m_strSQL1_3 = m_strSQL1_3 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
        m_strSQL1_4 = m_strSQL1_4 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
        m_strSQL1_5 = m_strSQL1_5 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
    End If
End If
'Add By Cheng 2003/06/13
'智權人員
If Me.txt1(11).Text <> "" Then
    strSQL1 = strSQL1 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_2 = m_strSQL1_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_3 = m_strSQL1_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_4 = m_strSQL1_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_5 = m_strSQL1_5 + " AND CU13='" & Me.txt1(11).Text & "' "
    StrSQL3 = StrSQL3 + " AND CU13='" & Me.txt1(11).Text & "' "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL3_3 = m_strSQL3_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL3_4 = m_strSQL3_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL3_5 = m_strSQL3_5 + " AND CU13='" & Me.txt1(11).Text & "' "
    '2011/2/23 End
    StrSQL4 = StrSQL4 + " AND CU13='" & Me.txt1(11).Text & "' "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL4_3 = m_strSQL4_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL4_4 = m_strSQL4_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL4_5 = m_strSQL4_5 + " AND CU13='" & Me.txt1(11).Text & "' "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL5_2 = m_strSQL5_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL5_3 = m_strSQL5_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL5_4 = m_strSQL5_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL5_5 = m_strSQL5_5 + " AND CU13='" & Me.txt1(11).Text & "' "
'Add By Cheng 2003/07/21
'若未輸入智權人員
Else
    strSQL1 = strSQL1 + " AND CU13 Is Null "
    m_strSQL1_2 = m_strSQL1_2 + " AND CU13 Is Null "
    m_strSQL1_3 = m_strSQL1_3 + " AND CU13 Is Null "
    m_strSQL1_4 = m_strSQL1_4 + " AND CU13 Is Null "
    m_strSQL1_5 = m_strSQL1_5 + " AND CU13 Is Null "
    StrSQL3 = StrSQL3 + " AND CU13 Is Null "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND CU13 Is Null "
    m_strSQL3_3 = m_strSQL3_3 + " AND CU13 Is Null "
    m_strSQL3_4 = m_strSQL3_4 + " AND CU13 Is Null "
    m_strSQL3_5 = m_strSQL3_5 + " AND CU13 Is Null "
    '2011/2/23 End
    StrSQL4 = StrSQL4 + " AND CU13 Is Null "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 + " AND CU13 Is Null "
    m_strSQL4_3 = m_strSQL4_3 + " AND CU13 Is Null "
    m_strSQL4_4 = m_strSQL4_4 + " AND CU13 Is Null "
    m_strSQL4_5 = m_strSQL4_5 + " AND CU13 Is Null "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND CU13 Is Null "
    m_strSQL5_2 = m_strSQL5_2 + " AND CU13 Is Null "
    m_strSQL5_3 = m_strSQL5_3 + " AND CU13 Is Null "
    m_strSQL5_4 = m_strSQL5_4 + " AND CU13 Is Null "
    m_strSQL5_5 = m_strSQL5_5 + " AND CU13 Is Null "
End If
CheckOC
Select Case txt1(10)
Case 1 '中文報表
         'Modify By Cheng 2002/02/27
'                        strSQL = " SELECT PA26,pa77,NVL(CU04,PA26),pa11,NVL(na03,PA09),NVL(decode(pa09,'000',cpm03,cpm04),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),PA05,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'         strSQL = strSQL + " union all select LC11,lc23,NVL(CU04,LC11),''  ,NVL(na03,LC15),NVL(decode(lc15,'000',cpm03,cpm04),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,''  ,0   ,''                                   ,''                            ,lc05,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'         strSQL = strSQL + " union all select HC05,''  ,NVL(CU04,HC05),''  ,na03          ,NVL(cpm03,CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=HC01(+) AND CP02=HC02(+) AND CP03=HC03(+) AND CP04=HC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'         strSQL = strSQL + " union all select sp08,sp27,NVL(CU04,SP26),sp11,NVL(na03,SP09),NVL(decode(sp09,'000',cpm03,cpm04),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,sp05,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
      '910819 Sieg 307
      If intPCaseKind = 專利 And intPWhere = 國外_CF Then
        'Add By Cheng 2003/02/10
        'Patent 申請人有五個欄位所以要分成五個陳述句
'         strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'92.03.27 nick 改本所案號
'         strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'         strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'         strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
 '        strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'         strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'         strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(na03,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'         strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,na03          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'        'ServicePractice 申請人有三個欄位所以要分成三個陳述句
''         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP26),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'         strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'         strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
        'Modify By Cheng 2003/05/02
'         strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'         strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'         strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'         strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'         strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'         strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(na03,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'         strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,na03          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            'Modify By Cheng 2003/11/25
            'B類收文的不續辦, 閉卷也要列印
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
                                 strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = strSql + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all select LC43,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all select LC44,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all select LC45,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all select LC46,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC24),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC25),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC26),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC27),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
        'ServicePractice 申請人有三個欄位所以要分成三個陳述句
'         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP26),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
            'Modify By Cheng 2003/11/25
            'B類收文的不續辦, 閉卷也要列印
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(na03,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,na03          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND CP09<'B' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            'Modified by Lydia 2018/06/05 修改顯示案件性質 '020',CPM04,CPM03 => '000',CPM03,CPM04
                                      strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',CPM03,CPM04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',CPM03,CPM04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',CPM03,CPM04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',CPM03,CPM04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',CPM03,CPM04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            'end 2018/06/05
            strSql = strSql + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all select LC43,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all select LC44,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all select LC45,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all select LC46,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC24),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC25),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC26),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC27),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
        'ServicePractice 申請人有三個欄位所以要分成三個陳述句
'         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP26),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
            'Modify By Cheng 2003/08/27
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        End If
      Else
        'Modify By Cheng 2003/02/10
        'Patent 申請人有五個欄位所以要分成五個陳述句
'         strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'92.03.27 nick 改本所案號
'         strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'         strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'         strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'         strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'         strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'         strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(na03,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'         strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,na03          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'        'ServicePractice 申請人有三個欄位所以要分成三個陳述句
''         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP26),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'         strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'         strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            'Modify By Cheng 2003/11/25
            'B類收文的不續辦, 閉卷也要列印
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
                                   strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = strSql + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all select LC43,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all select LC44,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all select LC45,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all select LC46,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC24),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC25),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC26),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC27),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
        'ServicePractice 申請人有三個欄位所以要分成三個陳述句
'         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP26),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
            'Modify By Cheng 2003/11/25
            'B類收文的不續辦, 閉卷也要列印
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(na03,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,na03          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND CP09<'B' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'        'ServicePractice 申請人有三個欄位所以要分成三個陳述句
''         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP26),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
                                      strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = strSql + " union all select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all select LC43,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all select LC44,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all select LC45,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all select LC46,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC24),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC25),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC26),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC27),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
        'ServicePractice 申請人有三個欄位所以要分成三個陳述句
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        End If
      End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                'Add By Cheng 2003/05/07
                For i = LBound(strTemp) To UBound(strTemp)
                    strTemp(i) = ""
                Next i
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                'Modify By Cheng 2003/05/02
'                If strTemp(16) = "Y" Then
'                    strTemp(9) = "*" + strTemp(9)
'                    strTemp(16) = "閉卷"
'                Else
'                    strTemp(16) = ""
'                End If
                If Right(strTemp(16), 1) = "*" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = Replace(strTemp(16), "*", "閉卷")
                End If
                'Add By Cheng 2003/05/07
                '申請日
                strTemp(23) = "" & .Fields(22).Value
                CheckOC2
                'Add By Cheng 2003/05/28
                strSql = "select min(pd05) from pridate where pd01='" & CheckStr(.Fields(18)) & "' and pd02='" & CheckStr(.Fields(19)) & "' and pd03='" & CheckStr(.Fields(20)) & "' and pd04='" & CheckStr(.Fields(21)) & "' "
                adoRecordset1.CursorLocation = adUseClient
                adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                If adoRecordset1.RecordCount <> 0 Then
                     strTemp(24) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                Else
                     strTemp(24) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND np07 <> 6001 And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 中文新增 R013028 存CP31
                strSql = "INSERT INTO R050317_C " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & PUB_GetRelateCasePropertyName(strTemp(17), Me.txt1(10).Text) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','" & "" & .Fields("CP57").Value & "',null) "
                cnnConnection.Execute strSql
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
            'Modify by Amy 2017/07/25 更新R013028
            If IsHaveData = True Then
                strSql = "Update R050317_C Set R013028=(Select CP31 From CaseProgress Where R013018=CP09(+)) Where ID='" & strUserNum & "'"
                cnnConnection.Execute strSql
            End If
            'end 2017/07/25
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            '
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_c WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 2 '英文報表
    '89/11/23   改 nick
    'If txt1(5) = "1" Then
    '                    strSQL = " SELECT PA75,pa77,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,PA26),pa11,NVL(na04,PA09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,PA06,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) " & strSQL1 & StrSQL11
    '     strSQL = strSQL + " union all select sp26,sp27,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,SP08),sp11,NVL(na04,SP09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,'','',sp06,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP09,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL3 & strSQL33
    '     strSQL = strSQL + " union all select lc22,lc23,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,LC11),'',NVL(na04,LC15),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,'',0,'','',lc06,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL4 & strSQL44
    '     strSQL = strSQL + " union all select CP44,CP45,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,PA26),pa11,NVL(na04,PA09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,PA06,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=ptm01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) " & strSQL1 & StrSQL22 & StrSQL221
    '     strSQL = strSQL + " union all select CP44,CP45,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,SP08),sp11,NVL(na04,SP09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,'','',sp06,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP09,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL3 & StrSQL22 & StrSQL222
    '     strSQL = strSQL + " union all select CP44,CP45,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,LC11),'',NVL(na04,LC15),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,'',0,'','',lc06,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL4 & StrSQL22 & StrSQL223
    'Else
    '                    strSQL = " SELECT PA75,pa77,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,PA26),pa11,NVL(na04,PA09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,PA06,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=ptm01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) " & strSQL1 & StrSQL11
    '     strSQL = strSQL + " union all select sp26,sp27,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,SP08),sp11,NVL(na04,SP09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,'','',sp06,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP09,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL3 & strSQL33
    '     strSQL = strSQL + " union all select lc22,lc23,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,LC11),'',NVL(na04,LC15),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,'',0,'','',lc06,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL4 & strSQL44
    '     strSQL = strSQL + " union all select CP44,CP45,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,PA26),pa11,NVL(na04,PA09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,PA06,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=ptm01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) " & strSQL1 & StrSQL22 & StrSQL221
    '     strSQL = strSQL + " union all select CP44,CP45,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,SP08),sp11,NVL(na04,SP09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,'','',sp06,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP09,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL3 & StrSQL22 & StrSQL222
    '     strSQL = strSQL + " union all select CP44,CP45,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,LC11),'',NVL(na04,LC15),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,'',0,'','',lc06,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL4 & StrSQL22 & StrSQL223
    'End If
         'Modify By Cheng 2002/02/27
'                        strSQL = " SELECT PA26,pa77,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,PA26),pa11,NVL(na04,PA09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,PA06,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'         strSQL = strSQL + " union all select LC11,lc23,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,LC11),''  ,NVL(na04,LC15),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,''  ,0   ,''                                       ,''   ,lc06,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'         strSQL = strSQL + " union all select HC05,''  ,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,HC05),''  ,na04          ,NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=HC01(+) AND CP02=HC02(+) AND CP03=HC03(+) AND CP04=HC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'         strSQL = strSQL + " union all select sp08,sp27,NVL(cu05||' '||cu88||' '||cu89||' '||cu90,SP08),sp11,NVL(na04,SP09),NVL(cpm10,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                       ,''   ,sp06,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'92.03.27 nick 改本所案號
'      strSQL = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
'         strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC11),''  ,NVL(na04,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND SUBSTR(LC11,9,1) = CU02(+) AND LC15=NA01(+) " & strSQL3
'         strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC05),''  ,na04          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=HC01(+) AND CP02=HC02(+) AND CP03=HC03(+) AND CP04=HC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(HC05,1,8)=CU01(+) AND SUBSTR(HC05,9,1) = CU02(+) AND '000'=NA01(+) " & strSQL4
'         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
                                       strSql = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = strSql + " union all select LC11,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC11,1,8)=CU01(+) AND SUBSTR(LC11,9,1) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all select LC43,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC43,1,8)=CU01(+) AND SUBSTR(LC43,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all select LC44,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC44,1,8)=CU01(+) AND SUBSTR(LC44,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all select LC45,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC45,1,8)=CU01(+) AND SUBSTR(LC45,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all select LC46,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC46,1,8)=CU01(+) AND SUBSTR(LC46,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC05),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC05,1,8)=CU01(+) AND SUBSTR(HC05,9,1) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC24),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC24,1,8)=CU01(+) AND SUBSTR(HC24,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC25),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC25,1,8)=CU01(+) AND SUBSTR(HC25,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC26),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC26,1,8)=CU01(+) AND SUBSTR(HC26,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC27),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC27,1,8)=CU01(+) AND SUBSTR(HC27,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC11),''  ,NVL(na04,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND SUBSTR(LC11,9,1) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC05),''  ,na04          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'B' AND SUBSTR(HC05,1,8)=CU01(+) AND SUBSTR(HC05,9,1) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND SUBSTR(LC11,9,1) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC05),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC05,1,8)=CU01(+) AND SUBSTR(HC05,9,1) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
                                       strSql = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = strSql + " union all select LC11,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND SUBSTR(LC11,9,1) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all select LC43,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC43,1,8)=CU01(+) AND SUBSTR(LC43,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all select LC44,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC44,1,8)=CU01(+) AND SUBSTR(LC44,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all select LC45,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC45,1,8)=CU01(+) AND SUBSTR(LC45,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all select LC46,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC46,1,8)=CU01(+) AND SUBSTR(LC46,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC05),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC05,1,8)=CU01(+) AND SUBSTR(HC05,9,1) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC24),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC24,1,8)=CU01(+) AND SUBSTR(HC24,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC25),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC25,1,8)=CU01(+) AND SUBSTR(HC25,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC26),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC26,1,8)=CU01(+) AND SUBSTR(HC26,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC27),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC27,1,8)=CU01(+) AND SUBSTR(HC27,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "Closed"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_E " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 3 '日文報表
'    If txt1(5) = "1" Then
'                        strSQL = " SELECT PA75,pa77,NVL(cu06,PA26),pa11,NVL(na04,PA09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,PA07,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=ptm01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) " & strSQL1 & StrSQL11
'         strSQL = strSQL + " union all select sp26,sp27,NVL(cu06,SP08),sp11,NVL(na04,SP09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,'','',sp07,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP09,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL3 & strSQL33
'         strSQL = strSQL + " union all select lc22,lc23,NVL(cu06,LC11),'',NVL(na04,LC15),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,'',0,'','',lc07,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL4 & strSQL44
'         strSQL = strSQL + " union all select CP44,CP45,NVL(cu06,PA26),pa11,NVL(na04,PA09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,PA07,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=ptm01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) " & strSQL1 & StrSQL22 & StrSQL221
'         strSQL = strSQL + " union all select CP44,CP45,NVL(cu06,SP08),sp11,NVL(na04,SP09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,'','',sp07,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP09,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL3 & StrSQL22 & StrSQL222
'         strSQL = strSQL + " union all select CP44,CP45,NVL(cu06,LC11),'',NVL(na04,LC15),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,'',0,'','',lc07,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL4 & StrSQL22 & StrSQL223
'    Else
'                        strSQL = " SELECT PA75,pa77,NVL(cu06,PA26),pa11,NVL(na04,PA09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,PA07,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=ptm01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) " & strSQL1 & StrSQL11
'         strSQL = strSQL + " union all select sp26,sp27,NVL(cu06,SP08),sp11,NVL(na04,SP09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,'','',sp07,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP09,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL3 & strSQL33
'         strSQL = strSQL + " union all select lc22,lc23,NVL(cu06,LC11),'',NVL(na04,LC15),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,'',0,'','',lc07,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL4 & strSQL44
'         strSQL = strSQL + " union all select CP44,CP45,NVL(cu06,PA26),pa11,NVL(na04,PA09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,PA07,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=ptm01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) " & strSQL1 & StrSQL22 & StrSQL221
'         strSQL = strSQL + " union all select CP44,CP45,NVL(cu06,SP08),sp11,NVL(na04,SP09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,'','',sp07,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP09,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL3 & StrSQL22 & StrSQL222
'         strSQL = strSQL + " union all select CP44,CP45,NVL(cu06,LC11),'',NVL(na04,LC15),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,'',0,'','',lc07,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL4 & StrSQL22 & StrSQL223
'    End If
'                        strSQL = " SELECT PA26,pa77,NVL(cu06,PA26),pa11,NVL(na04,PA09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,PA07,CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'         strSQL = strSQL + " union all select LC11,lc23,NVL(CU06,LC11),''  ,NVL(na04,LC15),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,''  ,0   ,''                                    ,''   ,lc07,CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'         strSQL = strSQL + " union all select HC05,''  ,NVL(cu06,HC05),''  ,na04          ,NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=HC01(+) AND CP02=HC02(+) AND CP03=HC03(+) AND CP04=HC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'         strSQL = strSQL + " union all select sp08,sp27,NVL(CU06,SP08),sp11,NVL(na04,SP09),NVL(cpm13,CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                    ,''   ,sp07,CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'92.03.27 nick 改本所案號
'                        strSQL = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||'-'||PA03||'-'||PA04,PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND CP01=PA01(+) AND CP02=PA02(+) AND CP03=PA03(+) AND CP04=PA04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'         strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC11),''  ,NVL(na04,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||'-'||LC03||'-'||LC04,''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND CP01=LC01(+) AND CP02=LC02(+) AND CP03=LC03(+) AND CP04=LC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'         strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC05),''  ,na04          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=HC01(+) AND CP02=HC02(+) AND CP03=HC03(+) AND CP04=HC04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'         strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||'-'||SP03||'-'||SP04,SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND CP01=SP01(+) AND CP02=SP02(+) AND CP03=SP03(+) AND CP04=SP04(+) AND (CP09<'B' or  CP09>'C') AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
                                        strSql = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = strSql + " union all select LC11,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all select LC43,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all select LC44,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all select LC45,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all select LC46,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC05),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC24),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC25),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC26),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC27),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC11),''  ,NVL(na04,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC05),''  ,na04          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'B' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
'            strSQL = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = strSQL + " union all select LC11,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC05),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
                                        strSql = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = strSql + " union all select LC11,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all select LC43,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all select LC44,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all select LC45,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all select LC46,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC05),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC24),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC25),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC26),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC27),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        End If
    CheckOC
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "ゾゆ"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_J " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & " ','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case Else
End Select
'Add by Amy 2017/12/26 剔除D類
cnnConnection.Execute "Delete From R050317_C WHERE ID='" & strUserNum & "'  And SubStr(R013018,1,1)='D' "     '語文為中文      對內
cnnConnection.Execute "Delete From R050317_E WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為英文    對外
cnnConnection.Execute "Delete From R050317_J WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為日文   對外
'end 2017/12/26
Select Case txt1(10)
Case 1     '中文
   PrintDataCp
   PrintDataCp (True)
Case 2     '英文
   PrintDataEp
Case 3     '日文
   PrintDataJp
   PrintDataJp (True)
Case Else
End Select
End Sub

Private Sub GetPleftCp()
Erase PLeft
'第一行
PLeft(0) = 0 '彼所案號
'Modify By Cheng 2002/02/27
'PLeft(1) = 3100
'PLeft(2) = 5200
'PLeft(3) = 7300
'PLeft(4) = 8600
'PLeft(5) = 16300
'PLeft(6) = 17900
PLeft(2) = 5200 - 2100 '申請案號  3100
PLeft(19) = 4800 '申請日
PLeft(3) = 7300 - 2100 + 1200 '申請國家  6400
PLeft(4) = 8600 - 2100 + 1200 '案件性質  7700
'Add By Cheng 2003
'加准駁狀況
PLeft(14) = 11700 '准駁
'PLeft(5) = 13800 '發文日
PLeft(5) = 9600 '發文日
'Add By Cheng 2003/05/28
'加優先權日
PLeft(20) = 13800 '優先權日
PLeft(6) = 17900 - 2100 '取消收文日期
PLeft(18) = 17900  '是否閉卷
'第二行
PLeft(7) = 0 '客戶案件案號
PLeft(8) = 3100 '本所案號
PLeft(9) = 4800 '專利號數
'Modify By Cheng 2002/11/20
'PLeft(10) = 9000 + 200 '專利種類
PLeft(10) = 9000 + 600 '專利種類
PLeft(11) = 11100 + 200 '案件名稱
PLeft(12) = 16400 + 200 '備註
PLeft(13) = 17900 '最近期限
End Sub

Private Sub GetPleftCt()
Erase PLeft
'第一行
PLeft(0) = 0 '彼所案號
'Modify By Cheng 2002/02/27
'PLeft(1) = 3100
'PLeft(2) = 5200
'PLeft(3) = 7300
'PLeft(4) = 8600
'PLeft(5) = 16300 - 2000
'PLeft(6) = 17900
PLeft(2) = 5200 - 2100 '申請案號
PLeft(19) = 4800 '申請日
PLeft(3) = 7300 - 2100 + 1200 '申請國家
PLeft(4) = 8600 - 2100 + 1200 '案件性質
'Add By Cheng 2003/05/28
'加發文日
PLeft(20) = 9600 '發文日
'Add By Cheng 2003
'加准駁狀況
PLeft(14) = 11700 '准駁
'PLeft(5) = 12200 '優先權日
PLeft(5) = 13800 '優先權日
PLeft(6) = 17900 - 2100 '取消收文日期
PLeft(18) = 17900  '是否閉卷
'第二行
PLeft(7) = 0 '客戶案件案號
PLeft(8) = 3100 '本所案號
PLeft(9) = 4800 '審定號數
PLeft(10) = 9000 + 200 + 1500 '商品類別
PLeft(11) = 11100 + 200 + 1500 '商標名稱
PLeft(12) = 16400 + 200 '備註
PLeft(13) = 17900 '最近期限
End Sub

'Modify by Amy 2020/04/01 +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintDataEp(Optional ByVal IsLawOnly As Boolean = False)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String
'Add By Cheng 2003/02/07
Dim strCust As String '記錄申請人
'Add By Cheng 2003/02/10
Dim strSystemKind As String '記錄系統類別
'Add By Cheng 2003/02/27
Dim blnFirstPage As Boolean '判斷是否第一頁
Dim strWhere As String 'Add by Amy 2020/04/01

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True
'Add By Cheng 2003/02/27
'列印第一頁
blnFirstPage = True

'若非所有程序
If Me.txt1(15).Text <> "3" Then
    '首次程序
    If Me.txt1(15).Text = "1" Then
        StrSQLa = "Select * From R050317_E Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
    '最新程序
    ElseIf Me.txt1(15).Text = "2" Then
        StrSQLa = "Select * From R050317_E Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
    End If
    strCaseNo = " "
    rsA.CursorLocation = adUseClient
    rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
    If rsA.RecordCount > 0 Then
        While Not rsA.EOF
            If strCaseNo <> "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
                strCaseNo = "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
            Else
                rsA.Delete
            End If
            rsA.MoveNext
        Wend
    End If
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing
End If

'Add by Amy 2020/04/01
If IsLawOnly = True Then
    strWhere = " And InStr(R013010,'L')>0 "
ElseIf strSrvDate(1) >= 事務所合併日 Then
    strWhere = "And InStr(R013010,'L')=0 "
End If
'end 2020/04/01

'Modify by Amy 2020/04/01 +strWhere
If txt1(8) = "Y" Then
   strSql = "SELECT DISTINCT R013001,R013019 FROM R050317_E WHERE ID='" & strUserNum & "' " & strWhere & " GROUP BY R013001,R013019 ORDER BY R013019,R013001 "
Else
   strSql = "SELECT DISTINCT R013001 FROM R050317_E WHERE ID='" & strUserNum & "' " & strWhere & "  GROUP BY R013001 ORDER BY R013001 "
End If
'end 2020/04/01
CheckOC
'Add By Cheng 2003/02/10
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   '頁數加一
    'Page = 1
    Page = Page + 1
   'Add By Cheng 2002/02/27
   RefreshColData 2, "申請人"
    With adoRecordset
        .MoveFirst
        Do While .EOF = False
            'Add By Cheng 2003/02/07
            '記錄申請人
            strCust = "" & .Fields(0).Value
            strTemp(20) = CheckStr(.Fields(0))
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields(1))
            Else
               strTemp(21) = ""
            End If
            'strSQL = "SELECT FA05,FA63,FA64,FA65,FA18,FA19,FA20,FA21,FA22,FA12||DECODE(FA13,NULL,'',','||FA13),FA16,FA14||DECODE(FA15,NULL,'',','||FA15),FA08,FA53 FROM FAGENT WHERE FA01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND FA02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            'Modify By Cheng 2002/02/27
'            strSQL = "SELECT CU05,CU88,CU89,CU90,CU24,CU25,CU26,CU27,CU28,CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU59,CU62 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU59,CU62 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                'StrTemp5(0) = GetNewFagent(strTemp(20)) + "  " + CheckStr(adoRecordset1.Fields(0))      邱小姐說要改回來  不秀代號 90/01/17
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                
               '910819 Sieg 109
                'StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                'StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                'StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                'StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                'StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
                
                StrTemp5(14) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(13))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(14))
                
            Else
                For i = 0 To 14
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            'edit by nickc 2005/11/17
            'PrintTitleEp
            'Add By Cheng 2003/02/07
            '若申請人不同則跳頁
            If strCust <> strTemp(20) Then
                strCust = strTemp(20)
                'Add By Cheng 2003/02/27
                strSystemKind = strTemp(21)
                If txt1(8) = "Y" Then
                   strSystemKind = strTemp(21)
                Else
                   strSystemKind = ""
                End If
                Page = Page + 1
                'add  by nickc 2005/11/15  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.NewPage
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_DocNewPage
                End If
                Call PrintTitleEp(IsLawOnly) 'Modify by Amy 2020/04/01
            'Add By Cheng 2003/02/10
            '若申請人相同
            Else
                '記錄系統類別
                If txt1(8) = "Y" Then
                    '若系統類別不同
                    If strSystemKind <> strTemp(21) Then
                       strSystemKind = strTemp(21)
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_DocNewPage
                        End If
                        Call PrintTitleEp(IsLawOnly) 'Modify by Amy 2020/04/01
                    End If
                End If
            End If
            'Modify By Cheng 2003/02/27
            '若為第一頁才印表頭
            If blnFirstPage = True Then
                Call PrintTitleEp(IsLawOnly) 'Modify by Amy 2020/04/01
                blnFirstPage = False
            End If
            'strSQL = "SELECT * FROM R050317_E WHERE R013001='" & chgsql(strTemp(14)) & "' AND ID='" & strUserNum & "' ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) DESC"
            If txt1(8) = "Y" Then
                'Modify By Cheng 2003/11/15
'               strSQL = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_e,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' "
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09, Decode(FA05, Null, FA06, FA05||' '||FA63||' '||FA64||' '||FA65) FROM R050317_e,caseprogress, Patent, Fagent WHERE r013018=cp09(+) And R013022=PA01(+) And R013023=PA02(+) And R013024=PA03(+) And R013025=PA04(+) And substr(PA75,1,8)=FA01(+) And substr(PA75,9,1)=FA02(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' " & strWhere
                'End
            Else
                'Modify By Cheng 2003/11/14
'               strSQL = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_e,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' "
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09, Decode(FA05, Null, FA06, FA05||' '||FA63||' '||FA64||' '||FA65) FROM R050317_e,caseprogress, Patent, Fagent WHERE r013018=cp09(+) And R013022=PA01(+) And R013023=PA02(+) And R013024=PA03(+) And R013025=PA04(+) And substr(PA75,1,8)=FA01(+) And substr(PA75,9,1)=FA02(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' " & strWhere
                'End
            End If
            '依本所案號排序
            If Me.txt1(9).Text = "1" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015 "
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+案件名稱排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    For i = 0 To 16
                        'If i <> 10 Then
                        '   strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1)) & "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
                        'Else
                           strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1))
                        'End If
                    Next i
                    If SeekTempPrint = "" Then
                        SeekTempPrint = strTemp(8)
                        strTemp(0) = StrToStr(strTemp(0), 15)
                        strTemp(1) = StrToStr(strTemp(1), 10)
                        strTemp(2) = StrToStr(strTemp(2), 10)
                        strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
'                        strTemp(4) = StrToStr(strTemp(4), 38)
                        strTemp(4) = StrToStr(strTemp(4), 22)
                        strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                        strTemp(10) = StrToStr(strTemp(12), 10)
                        strTemp(11) = StrToStr(strTemp(13), 25)
                        strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                        strTemp(12) = ""
                        strTemp(6) = StrToStr(strTemp(15), 11)
                        strTemp(20) = StrToStr("" & adoRecordset1.Fields(20).Value, 13)
                    Else
                        If SeekTempPrint <> strTemp(8) Then
                           'add  by nickc 2005/11/15  紙本
                           If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                iPrint = iPrint + 300
                           ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                           End If
                           SeekTempPrint = strTemp(8)
                           'edit by nickc 2005/11/15
                           'If iPrint >= 14200 Then
                           If iPrint >= o_PaperHeight Then
                              Page = Page + 1
                              'add  by nickc 2005/11/15  紙本
                              If Check3(0).Value = vbChecked Then
                                  Printer.NewPage
                              ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                  fn_DocNewPage
                              End If
                              Call PrintTitleEp(IsLawOnly) 'Modify by Amy 2020/04/01
                           End If
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
'                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(4) = StrToStr(strTemp(4), 22)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                           strTemp(20) = StrToStr("" & adoRecordset1.Fields(20).Value, 13)
                        Else
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
'                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(4) = StrToStr(strTemp(4), 22)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                           strTemp(20) = ""
                           For i = 0 To 3
                              strTemp(i) = ""
                           Next i
                           For i = 6 To 13
                              strTemp(i) = ""
                           Next i
                        End If
                    End If
                    'edit by nickc 2005/11/15
                    'If iPrint >= 14200 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.Line (0, iPrint)-(19200, iPrint)
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord(, False), , , 10
                            fn_DocNewPage
                        End If
                        Call PrintTitleEp(IsLawOnly) 'Modify by Amy 2020/04/01
                    End If
                    Call PrintDatilEp(IsLawOnly) 'Modify by Amy 2020/04/01
                    adoRecordset1.MoveNext
                Loop
                'add  by nickc 2005/11/15  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.Line (0, iPrint)-(19200, iPrint)
                    iPrint = iPrint + 100
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrLineToWord(, False), , , 10
                End If
                
                'edit by nickc 2005/11/15
                'If iPrint >= 14200 Then
                If iPrint >= o_PaperHeight Then
                    Page = Page + 1
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    Call PrintTitleEp(IsLawOnly) 'Modify by Amy 2020/04/01
                End If
                'Modify by Amy 2020/04/01 +strWhere
                If txt1(8) = "Y" Then
                  'Modified by Morgan 2015/6/3
                  'strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strCust & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  'Modified by Morgan 2015/6/3
                  'strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strCust & "' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                'end 2020/04/01
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5) - 3000
                    Printer.CurrentY = iPrint
                    Printer.Print "Total：" & Format(IntTot, "##0")
                    'Add By Cheng 2003/02/06
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "Total：" & Format(IntTot, "##0"), 52), , , 10
                End If
                'Modify by Amy 2020/04/01 +strWhere
                If txt1(8) = "Y" Then
                  'Modified by Morgan 2015/6/3
                  'strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017='Closed' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strCust & "' AND R013019='" & strTemp(21) & "' AND R013017='Closed' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                Else
                  'Modified by Morgan 2015/6/3
                  'strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND R013017='Closed' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strCust & "' AND R013017='Closed' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                End If
                'end 2020/04/01
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If

                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5)
                    Printer.CurrentY = iPrint
                    Printer.Print "File Closed：" & Format(IntTot, "##0")
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "File Closed：" & Format(IntTot, "##0"), 17), , , 10
                End If
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
End If
CheckOC
'Printer.CurrentX = 500
'Printer.CurrentY = iPrint
'Printer.Print String(250, "-")
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
End Sub

Private Sub PrintDataEt()
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True

'若非所有程序
If Me.txt1(15).Text <> "3" Then
    '首次程序
    If Me.txt1(15).Text = "1" Then
        StrSQLa = "Select * From R050317_E Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
    '最新程序
    ElseIf Me.txt1(15).Text = "2" Then
        StrSQLa = "Select * From R050317_E Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
    End If
    strCaseNo = " "
    rsA.CursorLocation = adUseClient
    rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
    
    If rsA.RecordCount > 0 Then
        While Not rsA.EOF
            If strCaseNo <> "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
                strCaseNo = "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
            Else
                rsA.Delete
            End If
            rsA.MoveNext
        Wend
    End If
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing
End If
If txt1(8) = "Y" Then
   strSql = "SELECT DISTINCT R013001,R013019 FROM R050317_E WHERE ID='" & strUserNum & "' GROUP BY R013001,R013019 ORDER BY R013019,R013001 "
Else
   strSql = "SELECT DISTINCT R013001 FROM R050317_E WHERE ID='" & strUserNum & "' GROUP BY R013001 ORDER BY R013001 "
End If
CheckOC
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   'Modify By Cheng 2003/02/10
    '頁數加一
    'Page = 1
    Page = Page + 1
   'Add By Cheng 2002/02/27
   RefreshColData 2, "申請人"
    With adoRecordset
        .MoveFirst
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields(0))
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields(1))
            Else
               strTemp(21) = ""
            End If
            'strSQL = "SELECT FA05,FA63,FA64,FA65,FA18,FA19,FA20,FA21,FA22,FA12||DECODE(FA13,NULL,'',','||FA13),FA16,FA14||DECODE(FA15,NULL,'',','||FA15),FA08,FA53 FROM FAGENT WHERE FA01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND FA02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            'Modify By Cheng 2002/02/27
'            strSQL = "SELECT CU05,CU88,CU89,CU90,CU24,CU25,CU26,CU27,CU28,CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU59,CU62 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU59,CU62 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                'StrTemp5(0) = GetNewFagent(strTemp(20)) + "  " + CheckStr(adoRecordset1.Fields(0))      邱小姐說要改回來  不秀代號 90/01/17
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 11
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            PrintTitleEt
            'strSQL = "SELECT * FROM R050317_E WHERE R013001='" & chgsql(strTemp(14)) & "' AND ID='" & strUserNum & "' ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) DESC"
            If txt1(8) = "Y" Then
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_e,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' "
            Else
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_e,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' "
            End If
            '依本所案號排序
            If Me.txt1(9).Text = "1" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015 "
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+案件名稱排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    For i = 0 To 16
                        'If i <> 10 Then
                        '   strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1)) & "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
                        'Else
                           strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1))
                        'End If
                    Next i
                    If SeekTempPrint = "" Then
                        SeekTempPrint = strTemp(8)
                        strTemp(0) = StrToStr(strTemp(0), 15)
                        strTemp(1) = StrToStr(strTemp(1), 10)
                        strTemp(2) = StrToStr(strTemp(2), 10)
                        strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6) 'Modify by Amy 2017/07/25 原:StrToStr(strTemp(3), 6) 國籍只顯示code ex:MCTF03 X39289040
                        strTemp(4) = StrToStr(strTemp(4), 28)
                        strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 1)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "-" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 2)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & Format(ChangeWStringToWDateString(strTemp(11)), "mmm dd,yyyy")
                        strTemp(10) = StrToStr(strTemp(12), 10)
                        strTemp(11) = StrToStr(strTemp(13), 15)
                        strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                        strTemp(12) = ""
                        strTemp(6) = StrToStr(strTemp(15), 11)
                    Else
                        If SeekTempPrint <> strTemp(8) Then
                           'add  by nickc 2005/11/15  紙本
                           If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                iPrint = iPrint + 300
                           ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                           End If
                           SeekTempPrint = strTemp(8)
                           'edit by nickc 2005/11/15
                           'If iPrint >= 14200 Then
                           If iPrint >= o_PaperHeight Then
                              Page = Page + 1
                              'add  by nickc 2005/11/15  紙本
                              If Check3(0).Value = vbChecked Then
                                  Printer.NewPage
                              ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                  fn_DocNewPage
                              End If
                              PrintTitleEt
                           End If
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 28)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 1)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "-" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 2)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & Format(ChangeWStringToWDateString(strTemp(11)), "mmm dd,yyyy")
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 15)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                        Else
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 28)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 1)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "-" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 2)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & Format(ChangeWStringToWDateString(strTemp(11)), "mmm dd,yyyy")
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 15)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                           For i = 0 To 3
                              strTemp(i) = ""
                           Next i
                           For i = 6 To 13
                              strTemp(i) = ""
                           Next i
                        End If
                    End If
                    'edit by nickc 2005/11/15
                    'If iPrint >= 14200 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.Line (0, iPrint)-(19200, iPrint)
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord(, False), , , 10
                            fn_DocNewPage
                        End If
                        PrintTitleEt
                    End If
                    PrintDatilEt
                    adoRecordset1.MoveNext
                Loop
                'add  by nickc 2005/11/15  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.Line (0, iPrint)-(19200, iPrint)
                    iPrint = iPrint + 100
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrLineToWord(, False), , , 10
                End If
                'edit by nickc 2005/11/15
                'If iPrint >= 14200 Then
                If iPrint >= o_PaperHeight Then
                    Page = Page + 1
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    PrintTitleEt
                End If
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5) - 3000
                    Printer.CurrentY = iPrint
                    Printer.Print "Total：" & Format(IntTot, "##0")
                    'Add By Cheng 2003/02/06
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "Total：" & Format(IntTot, "##0"), 52), , , 10
                End If
                
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017='Closed' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                Else
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND R013017='Closed' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                End If
                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5)
                    Printer.CurrentY = iPrint
                    Printer.Print "File Closed：" & Format(IntTot, "##0")
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "File Closed：" & Format(IntTot, "##0"), 17), , , 10
                End If
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
End If
CheckOC
'Printer.CurrentX = 500
'Printer.CurrentY = iPrint
'Printer.Print String(250, "-")
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
End Sub

'Modify by Amy 2020/04/01 +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintDataJp(Optional ByVal IsLawOnly As Boolean = False)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String
Dim strWhere As String 'Add by Amy 2020/04/01

'Add By Cheng 2003/02/07
Dim strCust As String '記錄申請人
'Add By Cheng 2003/02/10
Dim strSystemKind As String '記錄系統類別
'Add By Cheng 2003/02/27
Dim blnFirstPage As Boolean '判斷是否第一頁

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True

'Add By Cheng 2003/02/27
'列印第一頁
blnFirstPage = True

'若非所有程序
If Me.txt1(15).Text <> "3" Then
    '首次程序
    If Me.txt1(15).Text = "1" Then
        StrSQLa = "Select * From R050317_J Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
    '最新程序
    ElseIf Me.txt1(15).Text = "2" Then
        StrSQLa = "Select * From R050317_J Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
    End If
    strCaseNo = " "
    rsA.CursorLocation = adUseClient
    rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
    If rsA.RecordCount > 0 Then
        While Not rsA.EOF
            If strCaseNo <> "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
                strCaseNo = "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
            Else
                rsA.Delete
            End If
            rsA.MoveNext
        Wend
    End If
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing
End If

'Add by Amy 2020/04/01
If IsLawOnly = True Then
    strWhere = " And InStr(R013010,'L')>0 "
ElseIf strSrvDate(1) >= 事務所合併日 Then
    strWhere = "And InStr(R013010,'L')=0 "
End If
'end 2020/04/01
'Modify by Amy 2020/04/01 +strWhere
If txt1(8) = "Y" Then
   strSql = "SELECT DISTINCT R013001,R013019 FROM R050317_J WHERE ID='" & strUserNum & "' " & strWhere & " GROUP BY R013001,R013019 ORDER BY R013019,R013001 "
Else
   strSql = "SELECT DISTINCT R013001 FROM R050317_J WHERE ID='" & strUserNum & "' " & strWhere & " GROUP BY R013001 ORDER BY R013001 "
End If
'end 2020/04/01
CheckOC
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   'Modify By Cheng 2003/02/10
    '頁數加一
    'Page = 1
    Page = Page + 1
   'Add By Cheng 2002/02/27
   RefreshColData 3, "申請人"
    With adoRecordset
        .MoveFirst
        Do While .EOF = False
            'Add By Cheng 2003/02/07
            '記錄申請人
            strCust = "" & .Fields(0).Value
            strTemp(20) = CheckStr(.Fields(0))
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields(1))
            Else
               strTemp(21) = ""
            End If
            'strSQL = "SELECT FA06,'','','',FA23,'','','','',FA12||DECODE(FA13,NULL,'',','||FA13),FA16,FA14||DECODE(FA15,NULL,'',','||FA15),FA09,FA54 FROM FAGENT WHERE FA01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND FA02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            'Modify By Cheng 2002/02/27
'            strSQL = "SELECT CU06,'','','',CU29,'','','','',CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU60,CU63 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU60,CU63 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                'StrTemp5(0) = GetNewFagent(strTemp(20)) + "  " + CheckStr(adoRecordset1.Fields(0))      邱小姐說要改回來  不秀代號 90/01/17
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 11
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            'edit by nickc 2005/11/17
            'PrintTitleJp
'Add By Cheng 2003/02/07
            '若申請人不同則跳頁
            If strCust <> strTemp(20) Then
                strCust = strTemp(20)
                'Add By Cheng 2003/02/27
                strSystemKind = strTemp(21)
                If txt1(8) = "Y" Then
                   strSystemKind = strTemp(21)
                Else
                   strSystemKind = ""
                End If
                Page = Page + 1
                'add  by nickc 2005/11/15  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.NewPage
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_DocNewPage
                End If
                Call PrintTitleJp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
            'Add By Cheng 2003/02/10
            '若申請人相同
            Else
                '記錄系統類別
                If txt1(8) = "Y" Then
                    '若系統類別不同
                    If strSystemKind <> strTemp(21) Then
                       strSystemKind = strTemp(21)
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_DocNewPage
                        End If
                        Call PrintTitleJp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
                    End If
                End If
            End If
            'Modify By Cheng 2003/02/27
            '若為第一頁才印表頭
'            PrintTitleCp
            If blnFirstPage = True Then
                Call PrintTitleJp(IsLawOnly) 'Modify by Amy 2020/04/01
                blnFirstPage = False
            End If
            '初始化本所案號變數
            SeekTempPrint = ""
            
            'strSQL = "SELECT * FROM R050317_J WHERE R013001='" & chgsql(strTemp(14)) & "' AND ID='" & strUserNum & "' ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) DESC"
            'Modify by Amy 2020/04/01 +strWhere
            If txt1(8) = "Y" Then
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_j,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' " & strWhere
            Else
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_j,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' " & strWhere
            End If
            'end 2020/04/01
            '依本所案號排序
            If Me.txt1(9) = "1" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015 "
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+本所案號排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    For i = 0 To 16
                        'If i <> 10 Then
                        '   strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1)) & "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
                        'Else
                           strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1))
                        'End If
                    Next i
                    If SeekTempPrint = "" Then
                        SeekTempPrint = strTemp(8)
                        strTemp(0) = StrToStr(strTemp(0), 15)
                        strTemp(1) = StrToStr(strTemp(1), 10)
                        strTemp(2) = StrToStr(strTemp(2), 10)
                        strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                        strTemp(4) = StrToStr(strTemp(4), 38)
                        strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                        strTemp(10) = StrToStr(strTemp(12), 10)
                        strTemp(11) = StrToStr(strTemp(13), 25)
                        strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                        strTemp(12) = ""
                        strTemp(6) = StrToStr(strTemp(15), 11)
                    Else
                        If SeekTempPrint <> strTemp(8) Then
                           If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                iPrint = iPrint + 300
                           ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                           End If
                           SeekTempPrint = strTemp(8)
                           'edit by nickc 2005/11/15
                           'If iPrint >= 14200 Then
                           If iPrint >= o_PaperHeight Then
                              Page = Page + 1
                              'add  by nickc 2005/11/15  紙本
                              If Check3(0).Value = vbChecked Then
                                  Printer.NewPage
                              ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                  fn_DocNewPage
                              End If
                              Call PrintTitleJp(IsLawOnly) 'Modify by Amy 2020/04/01 +IsLawOnly
                           End If
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                        Else
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                           For i = 0 To 3
                              strTemp(i) = ""
                           Next i
                           For i = 6 To 13
                              strTemp(i) = ""
                           Next i
                        End If
                    End If
                    'edit by nickc 2005/11/15
                    'If iPrint >= 14200 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.Line (0, iPrint)-(19200, iPrint)
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord(, False), , , 10
                            fn_DocNewPage
                        End If
                        Call PrintTitleJp(IsLawOnly) 'Modify by Amy 2020/04/01 +IsLawOnly
                    End If
                    Call PrintDatilJp(IsLawOnly) 'Modify by Amy 2020/04/01 +IsLawOnly
                    adoRecordset1.MoveNext
                Loop
                If Check3(0).Value = vbChecked Then
                    Printer.Line (0, iPrint)-(19200, iPrint)
                    iPrint = iPrint + 100
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrLineToWord(, False), , , 10
                End If
                'edit by nickc 2005/11/15
                'If iPrint >= 14200 Then
                If iPrint >= o_PaperHeight Then
                    Page = Page + 1
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    Call PrintTitleJp(IsLawOnly) 'Modify by Amy 2020/04/01 +IsLawOnly
                End If
                'Modify by Amy 2020/04/01 +strWhere
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                'end 2020/04/01
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If

                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5) - 3000
                    Printer.CurrentY = iPrint
                    Printer.Print "合計：" & Format(IntTot, "##0")
                    'Add By Cheng 2003/02/06
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "合計：" & Format(IntTot, "##0"), 52), , , 10
                End If
                'Modify by Amy 2020/04/01 +strWhere
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017='ゾゆ' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                Else
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND R013017='ゾゆ' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                End If
                'end 2020/04/01
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If

                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5)
                    Printer.CurrentY = iPrint
                    Printer.Print "出願ЯU閉鎖：" & Format(IntTot, "##0")
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "出願ЯU閉鎖：" & Format(IntTot, "##0"), 17), , , 10
                End If
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
End If
CheckOC
'Printer.CurrentX = 500
'Printer.CurrentY = iPrint
'Printer.Print String(250, "-")
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
End Sub

Private Sub PrintDataJt()
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True

'若非所有程序
If Me.txt1(15).Text <> "3" Then
    '首次程序
    If Me.txt1(15).Text = "1" Then
        StrSQLa = "Select * From R050317_J Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
    '最新程序
    ElseIf Me.txt1(15).Text = "2" Then
        StrSQLa = "Select * From R050317_J Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
    End If
    strCaseNo = " "
    rsA.CursorLocation = adUseClient
    rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
    If rsA.RecordCount > 0 Then
        While Not rsA.EOF
            If strCaseNo <> "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
                strCaseNo = "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
            Else
                rsA.Delete
            End If
            rsA.MoveNext
        Wend
    End If
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing
End If
If txt1(8) = "Y" Then
   strSql = "SELECT DISTINCT R013001,R013019 FROM R050317_J WHERE ID='" & strUserNum & "' GROUP BY R013001,R013019 ORDER BY R013019,R013001 "
Else
   strSql = "SELECT DISTINCT R013001 FROM R050317_J WHERE ID='" & strUserNum & "' GROUP BY R013001 ORDER BY R013001 "
End If
CheckOC
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   'Modify By Cheng 2003/02/10
    '頁數加一
    'Page = 1
    Page = Page + 1
   'Add By Cheng 2002/02/27
   RefreshColData 3, "申請人"
    With adoRecordset
        .MoveFirst
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields(0))
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields(1))
            Else
               strTemp(21) = ""
            End If
            'strSQL = "SELECT FA06,'','','',FA23,'','','','',FA12||DECODE(FA13,NULL,'',','||FA13),FA16,FA14||DECODE(FA15,NULL,'',','||FA15),FA09,FA54 FROM FAGENT WHERE FA01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND FA02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            'Modify By Cheng 2002/02/27
'            strSQL = "SELECT CU06,'','','',CU29,'','','','',CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU60,CU63 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU60,CU63 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                'StrTemp5(0) = GetNewFagent(strTemp(20)) + "  " + CheckStr(adoRecordset1.Fields(0))      邱小姐說要改回來  不秀代號 90/01/17
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 11
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            PrintTitleJt
            'strSQL = "SELECT * FROM R050317_J WHERE R013001='" & chgsql(strTemp(14)) & "' AND ID='" & strUserNum & "' ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) DESC"
            If txt1(8) = "Y" Then
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_j,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' "
            Else
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_j,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' "
            End If
            '依本所案號排序
            If Me.txt1(9).Text = "1" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015 "
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+案件名稱排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    For i = 0 To 16
                        'If i <> 10 Then
                        '   strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1)) & "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
                        'Else
                           strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1))
                        'End If
                    Next i
                    If SeekTempPrint = "" Then
                        SeekTempPrint = strTemp(8)
                        strTemp(0) = StrToStr(strTemp(0), 15)
                        strTemp(1) = StrToStr(strTemp(1), 10)
                        strTemp(2) = StrToStr(strTemp(2), 10)
                        strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                        strTemp(4) = StrToStr(strTemp(4), 28)
                        strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 1)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "-" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 2)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & Format(ChangeWStringToWDateString(strTemp(11)), "mmm dd,yyyy")
                        strTemp(10) = StrToStr(strTemp(12), 10)
                        strTemp(11) = StrToStr(strTemp(13), 15)
                        strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                        strTemp(12) = ""
                        strTemp(6) = StrToStr(strTemp(15), 11)
                    Else
                        If SeekTempPrint <> strTemp(8) Then
                           'add  by nickc 2005/11/15  紙本
                           If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                iPrint = iPrint + 300
                           ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                           End If
                           SeekTempPrint = strTemp(8)
                           'edit by nickc 2005/11/15
                           'If iPrint >= 14200 Then
                           If iPrint >= o_PaperHeight Then
                              Page = Page + 1
                              'add  by nickc 2005/11/15  紙本
                              If Check3(0).Value = vbChecked Then
                                  Printer.NewPage
                              ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                  fn_DocNewPage
                              End If
                              PrintTitleJt
                           End If
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 28)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 1)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "-" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 2)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & Format(ChangeWStringToWDateString(strTemp(11)), "mmm dd,yyyy")
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 15)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                        Else
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 28)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 1)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "-" & StrToStr(Format(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 2)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & Format(ChangeWStringToWDateString(strTemp(11)), "mmm dd,yyyy")
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 15)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                           For i = 0 To 3
                              strTemp(i) = ""
                           Next i
                           For i = 6 To 13
                              strTemp(i) = ""
                           Next i
                        End If
                    End If
                    'edit by nickc 2005/11/15
                    'If iPrint >= 14200 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.Line (0, iPrint)-(19200, iPrint)
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord(, False), , , 10
                            fn_DocNewPage
                        End If
                        PrintTitleJt
                    End If
                    PrintDatilJt
                    adoRecordset1.MoveNext
                Loop
                'add  by nickc 2005/11/15  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.Line (0, iPrint)-(19200, iPrint)
                    iPrint = iPrint + 100
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrLineToWord(, False), , , 10
                End If
                'edit by nickc 2005/11/15
                'If iPrint >= 14200 Then
                If iPrint >= o_PaperHeight Then
                    Page = Page + 1
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    PrintTitleJt
                End If
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5) - 3000
                    Printer.CurrentY = iPrint
                    Printer.Print "合計：" & Format(IntTot, "##0")
                    'Add By Cheng 2003/02/06
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "合計：" & Format(IntTot, "##0"), 52), , , 10
                End If
                
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017='ゾゆ' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                Else
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND R013017='ゾゆ' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5)
                    Printer.CurrentY = iPrint
                    Printer.Print "出願ЯU閉鎖：" & Format(IntTot, "##0")
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "出願ЯU閉鎖：" & Format(IntTot, "##0"), 17), , , 10
                End If
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
End If
CheckOC
'Printer.CurrentX = 500
'Printer.CurrentY = iPrint
'Printer.Print String(250, "-")
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
End Sub

'Modify by Amy +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintTitleEp(Optional ByVal IsLawOnly As Boolean = False)
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    GetPleftEp
    iPrint = 500
    Printer.Font.Size = 22
    Printer.Font.Bold = True
    Printer.Font.Underline = True
    Printer.FontName = "細明體"
    Printer.CurrentX = 9000 - (Printer.TextWidth("Status Report On Patents/Applications") / 2)
    Printer.CurrentY = iPrint
    Printer.Print "Status Report On Patents/Applications"
    iPrint = iPrint + 500
    Printer.CurrentX = 9000 - (Printer.TextWidth("Prepared by Tai E International Patent & Law Office") / 2)
    Printer.CurrentY = iPrint
    Printer.Print "Prepared by Tai E International Patent & Law Office"
    iPrint = iPrint + 500
    Printer.Font.Size = 10
    Printer.Font.Bold = False
    Printer.Font.Underline = False
    iPrint = iPrint + 300
    'USER 確認英文格式並不用 USER ID
    '89/11/14
    'Printer.CurrentX = 0
    'Printer.CurrentY = iPrint
    'Printer.Print "USER ID：" & strUserNum
    'iPrint = iPrint + 300
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy")
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "To："
    If Len(StrTemp5(12)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(12)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(13)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(13)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(0)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(0)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(1)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(1)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(2)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(2)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(3)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(3)
       iPrint = iPrint + 300
    End If
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "Address：" & StrTemp5(4)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "Tel：" & StrTemp5(5)
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Page：" & str(Page)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("Address：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(6)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "E-mail：" & StrTemp5(7)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("Address：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(8)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "Fax：" & StrTemp5(9)
    iPrint = iPrint + 300
    If Len(StrTemp5(10)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("Address：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(10)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(11)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("Address：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(11)
       iPrint = iPrint + 300
    End If
    
    '090819 Sieg 109
    If Len(StrTemp5(14)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("Address：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(14)
       iPrint = iPrint + 300
    End If
    
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "Your Ref"
    Printer.CurrentX = PLeft(1)
    Printer.CurrentY = iPrint
    'If intPCaseKind = 2 Then
    'Modify By Cheng 2002/02/27
    '取消列印申請人
    'Printer.Print "Applicant"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "Appln. No."
    Printer.CurrentX = PLeft(3)
    Printer.CurrentY = iPrint
    Printer.Print "Country"
    Printer.CurrentX = PLeft(4)
    Printer.CurrentY = iPrint
    Printer.Print "Status"
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print "Patent Aagent"
    Printer.CurrentX = PLeft(5)
    Printer.CurrentY = iPrint
    Printer.Print "Date Of Filing"
    Printer.CurrentX = PLeft(6)
    Printer.CurrentY = iPrint
    Printer.Print "File Closed"
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(7)
    Printer.CurrentY = iPrint
    Printer.Print "Case No."
    Printer.CurrentX = PLeft(8)
    Printer.CurrentY = iPrint
    Printer.Print "Our Ref"
    Printer.CurrentX = PLeft(9)
    Printer.CurrentY = iPrint
    Printer.Print "Pat. No.　　/Expiry Date/Patent Right"
    Printer.CurrentX = PLeft(10)
    Printer.CurrentY = iPrint
    Printer.Print "Type Of Patent"
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print "Title"
    Printer.CurrentX = PLeft(12)
    Printer.CurrentY = iPrint
    Printer.Print "Remarks"
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "Next Due Day"
    iPrint = iPrint + 300
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If blnWordNewPage = True And Page <> 1 Then
        fn_DocNewPage
    End If
    blnWordNewPage = False
    Dim isPrintDate As Boolean
    Dim o_tmp1 As String
    Dim o_tmp2 As String
    Dim o_tmp3 As String
    Dim o_tmp4 As String
    Dim o_tmp5 As String
    Dim o_tmp6 As String
    iPrint = 0
    o_tmp1 = StrTemp5(12)
    o_tmp2 = StrTemp5(13)
    o_tmp3 = StrTemp5(0)
    o_tmp4 = StrTemp5(1)
    o_tmp5 = StrTemp5(2)
    o_tmp6 = StrTemp5(3)
    If Len(CheckStr(o_tmp6)) <> 0 Then
        If Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            o_tmp6 = fn_StrToWordFmt("To：" & o_tmp6, 50) & "Tel：" & StrTemp5(5)
        Else
            o_tmp6 = fn_StrToWordFmt("　：" & o_tmp6, 50) & "Tel：" & StrTemp5(5)
        End If
    End If
    If Len(CheckStr(o_tmp5)) <> 0 Then
        If Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("To：" & o_tmp5, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("To：" & o_tmp5, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("　：" & o_tmp5, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("　：" & o_tmp5, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp4)) <> 0 Then
        If Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("To：" & o_tmp4, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("To：" & o_tmp4, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("　：" & o_tmp4, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("　：" & o_tmp4, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp3)) <> 0 Then
        If Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("To：" & o_tmp3, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("To：" & o_tmp3, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("　：" & o_tmp3, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("　：" & o_tmp3, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp2)) <> 0 Then
        If Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("To：" & o_tmp2, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("To：" & o_tmp2, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("　：" & o_tmp2, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("　：" & o_tmp2, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp1)) <> 0 Then
        If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) = 0 Then
            o_tmp1 = fn_StrToWordFmt("To：" & o_tmp1, 50) & "Tel：" & StrTemp5(5)
        Else
            o_tmp1 = fn_StrToWordFmt("To：" & o_tmp1, 50)
        End If
    End If
    isPrintDate = False
    'g_WordAp.
    fn_PutWords "Status Report On Patents/Applications", wdAlignParagraphCenter, "細明體", 22, False, True, True
    fn_PutWords "Prepared by Tai E International Patent & Law Office", wdAlignParagraphCenter, "細明體", 22, , True, True
    'fn_PutWords "　　（專利）", wdAlignParagraphCenter, , 16
    If Len(o_tmp1) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp1, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp1, 95), , , 10
        End If
    End If
    If Len(o_tmp2) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp2, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp2, 95), , , 10
        End If
    End If
    If Len(o_tmp3) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp3, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp3, 95), , , 10
        End If
    End If
    If Len(o_tmp4) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp4, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp4, 95), , , 10
        End If
    End If
    If Len(o_tmp5) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp5, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp5, 95), , , 10
        End If
    End If
    If Len(o_tmp6) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp6, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp6, 95), , , 10
        End If
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("Address：" & StrTemp5(4), 50) & "E-mail：" & StrTemp5(7), 83) & "Page：" & str(Page), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　　 " & StrTemp5(6), 50) & "Fax：" & StrTemp5(9), 83), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　　 " & StrTemp5(8), 50), 83), , , 10
    If Len(StrTemp5(10)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(10), 50), , , 10
    End If
    If Len(StrTemp5(11)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(11), 50), , , 10
    End If
    fn_PutWords fn_StrLineToWord("=", False), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("Your Ref", 16) & fn_StrToWordFmt("Appln. No.", 23) & fn_StrToWordFmt("Country", 14) & fn_StrToWordFmt("Status", 16) & fn_StrToWordFmt("Patent Aagent", 8) & fn_StrToWordFmt("Date Of Filing", 9) & "File Closed", 95), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("Case No.", 16) & fn_StrToWordFmt("Our Ref", 11) & fn_StrToWordFmt("Pat. No./Expiry Date/Patent Right", 25) & fn_StrToWordFmt("Type Of Patent", 8) & fn_StrToWordFmt("Title", 21) & fn_StrToWordFmt("Remarks", 6) & "Next Due Day", 95), , , 10
    fn_PutWords fn_StrLineToWord("=", False), , , 10
End If
End Sub

Private Sub PrintTitleEt()
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    GetPleftEt
    iPrint = 500
    Printer.Font.Size = 22
    Printer.Font.Bold = True
    Printer.Font.Underline = True
    Printer.FontName = "細明體"
    Printer.CurrentX = 9000 - (Printer.TextWidth("Status Report On TradeMark/Applications") / 2)
    Printer.CurrentY = iPrint
    Printer.Print "Status Report On TradeMark/Applications"
    iPrint = iPrint + 500
    Printer.CurrentX = 9000 - (Printer.TextWidth("Prepared by Tai E International Patent & Law Office") / 2)
    Printer.CurrentY = iPrint
    Printer.Print "Prepared by Tai E International Patent & Law Office"
    iPrint = iPrint + 500
    Printer.Font.Size = 10
    Printer.Font.Bold = False
    Printer.Font.Underline = False
    iPrint = iPrint + 300
    'USER 確認英文格式並不用 USER ID
    '89/11/14
    'Printer.CurrentX = 0
    'Printer.CurrentY = iPrint
    'Printer.Print "USER ID：" & strUserNum
    'iPrint = iPrint + 300
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy")
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "To："
    If Len(StrTemp5(12)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(12)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(13)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(13)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(0)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(0)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(1)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(1)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(2)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(2)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(3)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(3)
       iPrint = iPrint + 300
    End If
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "Address：" & StrTemp5(4)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "Tel：" & StrTemp5(5)
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Page：" & str(Page)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("Address：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(6)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "E-mail：" & StrTemp5(7)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("Address：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(8)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "Fax：" & StrTemp5(9)
    iPrint = iPrint + 300
    If Len(StrTemp5(10)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("Address：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(10)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(11)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("Address：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(11)
       iPrint = iPrint + 300
    End If
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "Your Ref"
    Printer.CurrentX = PLeft(1)
    Printer.CurrentY = iPrint
    'If intPCaseKind = 2 Then
    'Modify By Cheng 2002/02/27
    '取消列印申請人
    'Printer.Print "Applicant"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "Appln. No."
    Printer.CurrentX = PLeft(3)
    Printer.CurrentY = iPrint
    Printer.Print "Country"
    Printer.CurrentX = PLeft(4)
    Printer.CurrentY = iPrint
    Printer.Print "Status"
    Printer.CurrentX = PLeft(5)
    Printer.CurrentY = iPrint
    Printer.Print "Relevant Filing Date"
    Printer.CurrentX = PLeft(6)
    Printer.CurrentY = iPrint
    Printer.Print "File Closed"
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(7)
    Printer.CurrentY = iPrint
    Printer.Print "Case No."
    Printer.CurrentX = PLeft(8)
    Printer.CurrentY = iPrint
    Printer.Print "Our Ref"
    Printer.CurrentX = PLeft(9)
    Printer.CurrentY = iPrint
    Printer.Print "Approved No.　　　　 /(Duration)　　　 　　　/Publication Date"
    Printer.CurrentX = PLeft(10)
    Printer.CurrentY = iPrint
    Printer.Print "Class(es)"
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print "Title"
    Printer.CurrentX = PLeft(12)
    Printer.CurrentY = iPrint
    Printer.Print "Mark"
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "Next Due Day"
    iPrint = iPrint + 300
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If blnWordNewPage = True And Page <> 1 Then
        fn_DocNewPage
    End If
    blnWordNewPage = False
    Dim isPrintDate As Boolean
    Dim o_tmp1 As String
    Dim o_tmp2 As String
    Dim o_tmp3 As String
    Dim o_tmp4 As String
    Dim o_tmp5 As String
    Dim o_tmp6 As String
    iPrint = 0
    o_tmp1 = StrTemp5(12)
    o_tmp2 = StrTemp5(13)
    o_tmp3 = StrTemp5(0)
    o_tmp4 = StrTemp5(1)
    o_tmp5 = StrTemp5(2)
    o_tmp6 = StrTemp5(3)
    If Len(CheckStr(o_tmp6)) <> 0 Then
        If Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            o_tmp6 = fn_StrToWordFmt("To：" & o_tmp6, 50) & "Tel：" & StrTemp5(5)
        Else
            o_tmp6 = fn_StrToWordFmt("　：" & o_tmp6, 50) & "Tel：" & StrTemp5(5)
        End If
    End If
    If Len(CheckStr(o_tmp5)) <> 0 Then
        If Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("To：" & o_tmp5, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("To：" & o_tmp5, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("　：" & o_tmp5, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("　：" & o_tmp5, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp4)) <> 0 Then
        If Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("To：" & o_tmp4, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("To：" & o_tmp4, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("　：" & o_tmp4, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("　：" & o_tmp4, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp3)) <> 0 Then
        If Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("To：" & o_tmp3, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("To：" & o_tmp3, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("　：" & o_tmp3, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("　：" & o_tmp3, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp2)) <> 0 Then
        If Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("To：" & o_tmp2, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("To：" & o_tmp2, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("　：" & o_tmp2, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("　：" & o_tmp2, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp1)) <> 0 Then
        If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) = 0 Then
            o_tmp1 = fn_StrToWordFmt("To：" & o_tmp1, 50) & "Tel：" & StrTemp5(5)
        Else
            o_tmp1 = fn_StrToWordFmt("To：" & o_tmp1, 50)
        End If
    End If
    isPrintDate = False
    'g_WordAp.
    fn_PutWords "Status Report On Patents/Applications", wdAlignParagraphCenter, "細明體", 22, False, True, True
    fn_PutWords "Prepared by Tai E International Patent & Law Office", wdAlignParagraphCenter, "細明體", 22, , True, True
    'fn_PutWords "　　（專利）", wdAlignParagraphCenter, , 16
    If Len(o_tmp1) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp1, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp1, 95), , , 10
        End If
    End If
    If Len(o_tmp2) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp2, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp2, 95), , , 10
        End If
    End If
    If Len(o_tmp3) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp3, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp3, 95), , , 10
        End If
    End If
    If Len(o_tmp4) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp4, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp4, 95), , , 10
        End If
    End If
    If Len(o_tmp5) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp5, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp5, 95), , , 10
        End If
    End If
    If Len(o_tmp6) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp6, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp6, 95), , , 10
        End If
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("Address：" & StrTemp5(4), 50) & "E-mail：" & StrTemp5(7), 83) & "Page：" & str(Page), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　　 " & StrTemp5(6), 50) & "Fax：" & StrTemp5(9), 83), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　　 " & StrTemp5(8), 50), 83), , , 10
    If Len(StrTemp5(10)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(10), 50), , , 10
    End If
    If Len(StrTemp5(11)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(11), 50), , , 10
    End If
    fn_PutWords fn_StrLineToWord("=", False), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("Your Ref", 16) & fn_StrToWordFmt("Appln. No.", 23) & fn_StrToWordFmt("Country", 14) & fn_StrToWordFmt("Status", 16) & fn_StrToWordFmt("Relevant Filing Date", 9) & fn_StrToWordFmt("File Closed", 8), 95), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("Case No.", 16) & fn_StrToWordFmt("Our Ref", 11) & fn_StrToWordFmt("Approved No./(Duration)/Publication Date", 25) & fn_StrToWordFmt("Class(es)", 8) & fn_StrToWordFmt("Title", 21) & fn_StrToWordFmt("Mark", 6) & "Next Due Day", 95), , , 10
    fn_PutWords fn_StrLineToWord("=", False), , , 10
End If
End Sub

'Modify by Amy 2020/04/01  +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintTitleJp(Optional ByVal IsLawOnly As Boolean = False)
Dim strCmpTitle As String 'Add by Amy 2020/04/01

'Add by Amy 2020/04/01
If IsLawOnly = True Then
    strCmpTitle = CompNameQuery("L", 3) & "  作成"
Else
    strCmpTitle = CompNameQuery("2", 3) & "  作成"
End If
'end 2020/04/01
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    GetPleftEp
    iPrint = 500
    Printer.Font.Size = 22
    Printer.Font.Bold = True
    Printer.Font.Underline = True
    Printer.FontName = "細明體"
    Printer.CurrentX = 9000 - (Printer.TextWidth("案件ソ狀況報告") / 2)
    Printer.CurrentY = iPrint
    Printer.Print "案件ソ狀況報告"
    iPrint = iPrint + 500
    'Modified by Lydia 2018/03/16
    'Printer.CurrentX = 9000 - (Printer.TextWidth("台一嚜息Q法律事務所  作成") / 2)
    'Modify by Amy 2020/04/01
    'strCmpTitle = Taie_Jpn_Title & "  作成"
    Printer.CurrentX = 9000 - (Printer.TextWidth(strCmpTitle) / 2)
    Printer.CurrentY = iPrint
    'Modified by Lydia 2018/03/16
    'Printer.Print "台一嚜息Q法律事務所  作成"
    Printer.Print strCmpTitle 'Taie_Jpn_Title & "  作成"
    'end 2020/04/01
    iPrint = iPrint + 500
    Printer.Font.Size = 10
    Printer.Font.Bold = False
    Printer.Font.Underline = False
    iPrint = iPrint + 300
    'USER 確認英文格式並不用 USER ID
    '89/11/14
    'Printer.CurrentX = 0
    'Printer.CurrentY = iPrint
    'Printer.Print "USER ID：" & strUserNum
    'iPrint = iPrint + 300
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy")
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "To："
    If Len(StrTemp5(12)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(12)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(13)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(13)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(0)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(0)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(1)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(1)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(2)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(2)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(3)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(3)
       iPrint = iPrint + 300
    End If
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "住所：" & StrTemp5(4)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "Tel：" & StrTemp5(5)
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Page：" & str(Page)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("住所：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(6)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "E-mail：" & StrTemp5(7)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("住所：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(8)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "Fax：" & StrTemp5(9)
    iPrint = iPrint + 300
    If Len(StrTemp5(10)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("住所：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(10)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(11)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("住所：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(11)
       iPrint = iPrint + 300
    End If
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "貴整理番"
    Printer.CurrentX = PLeft(1)
    Printer.CurrentY = iPrint
    'If intPCaseKind = 2 Then
    'Modify By Cheng 2002/02/27
    '取消列印申請人欄位
    'Printer.Print "出願人"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "出願番"
    Printer.CurrentX = PLeft(3)
    Printer.CurrentY = iPrint
    Printer.Print "鵀W"
    Printer.CurrentX = PLeft(4)
    Printer.CurrentY = iPrint
    Printer.Print "狀況"
    Printer.CurrentX = PLeft(5)
    Printer.CurrentY = iPrint
    Printer.Print "}送日"
    Printer.CurrentX = PLeft(6)
    Printer.CurrentY = iPrint
    Printer.Print "出願ЯU閉鎖"
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(7)
    Printer.CurrentY = iPrint
    Printer.Print "Case No."
    Printer.CurrentX = PLeft(8)
    Printer.CurrentY = iPrint
    Printer.Print "J整理番"
    Printer.CurrentX = PLeft(9)
    Printer.CurrentY = iPrint
    Printer.Print "特許蛣f謘@　/存珒褻﹊U茪Fソ日/存"
    Printer.CurrentX = PLeft(10)
    Printer.CurrentY = iPrint
    Printer.Print "工業所有裀U種E"
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print "名b"
    Printer.CurrentX = PLeft(12)
    Printer.CurrentY = iPrint
    Printer.Print "註"
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "次ソ期限"
    iPrint = iPrint + 300
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If blnWordNewPage = True And Page <> 1 Then
        fn_DocNewPage
    End If
    blnWordNewPage = False
    Dim isPrintDate As Boolean
    Dim o_tmp1 As String
    Dim o_tmp2 As String
    Dim o_tmp3 As String
    Dim o_tmp4 As String
    Dim o_tmp5 As String
    Dim o_tmp6 As String
    iPrint = 0
    o_tmp1 = StrTemp5(12)
    o_tmp2 = StrTemp5(13)
    o_tmp3 = StrTemp5(0)
    o_tmp4 = StrTemp5(1)
    o_tmp5 = StrTemp5(2)
    o_tmp6 = StrTemp5(3)
    If Len(CheckStr(o_tmp6)) <> 0 Then
        If Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            o_tmp6 = fn_StrToWordFmt("To：" & o_tmp6, 50) & "Tel：" & StrTemp5(5)
        Else
            o_tmp6 = fn_StrToWordFmt("　：" & o_tmp6, 50) & "Tel：" & StrTemp5(5)
        End If
    End If
    If Len(CheckStr(o_tmp5)) <> 0 Then
        If Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("To：" & o_tmp5, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("To：" & o_tmp5, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("　：" & o_tmp5, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("　：" & o_tmp5, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp4)) <> 0 Then
        If Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("To：" & o_tmp4, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("To：" & o_tmp4, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("　：" & o_tmp4, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("　：" & o_tmp4, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp3)) <> 0 Then
        If Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("To：" & o_tmp3, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("To：" & o_tmp3, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("　：" & o_tmp3, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("　：" & o_tmp3, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp2)) <> 0 Then
        If Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("To：" & o_tmp2, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("To：" & o_tmp2, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("　：" & o_tmp2, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("　：" & o_tmp2, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp1)) <> 0 Then
        If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) = 0 Then
            o_tmp1 = fn_StrToWordFmt("To：" & o_tmp1, 50) & "Tel：" & StrTemp5(5)
        Else
            o_tmp1 = fn_StrToWordFmt("To：" & o_tmp1, 50)
        End If
    End If
    isPrintDate = False
    'g_WordAp.
    fn_PutWords "案件ソ狀況報告", wdAlignParagraphCenter, "細明體", 22, False, True, True
    'Modified by Lydia 2018/03/16
    'fn_PutWords "台一嚜息Q法律事務所  作成", wdAlignParagraphCenter, "細明體", 22, , True, True
    'Modify by Amy 2020/04/01 原:Taie_Jpn_Title& "  作成"
    fn_PutWords strCmpTitle, wdAlignParagraphCenter, "細明體", 22, , True, True
    'fn_PutWords "　　（專利）", wdAlignParagraphCenter, , 16
    If Len(o_tmp1) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp1, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp1, 95), , , 10
        End If
    End If
    If Len(o_tmp2) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp2, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp2, 95), , , 10
        End If
    End If
    If Len(o_tmp3) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp3, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp3, 95), , , 10
        End If
    End If
    If Len(o_tmp4) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp4, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp4, 95), , , 10
        End If
    End If
    If Len(o_tmp5) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp5, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp5, 95), , , 10
        End If
    End If
    If Len(o_tmp6) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp6, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp6, 95), , , 10
        End If
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("住所：" & StrTemp5(4), 50) & "E-mail：" & StrTemp5(7), 83) & "Page：" & str(Page), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　" & StrTemp5(6), 50) & "Fax：" & StrTemp5(9), 83), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　" & StrTemp5(8), 50), 83), , , 10
    If Len(StrTemp5(10)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(10), 50), , , 10
    End If
    If Len(StrTemp5(11)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(11), 50), , , 10
    End If
    fn_PutWords fn_StrLineToWord("=", False), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("貴整理番", 16) & fn_StrToWordFmt("出願番", 23) & fn_StrToWordFmt("鵀W", 14) & fn_StrToWordFmt("狀況", 16) & fn_StrToWordFmt("}送日", 9) & fn_StrToWordFmt("出願ЯU閉鎖", 8), 95), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("Case No.", 16) & fn_StrToWordFmt("J整理番", 11) & fn_StrToWordFmt("特許蛣f/存珒褻﹊U茪Fソ日/存", 25) & fn_StrToWordFmt("工業所有裀U種E", 8) & fn_StrToWordFmt("名b", 21) & fn_StrToWordFmt("註", 6) & "次ソ期限", 95), , , 10
    fn_PutWords fn_StrLineToWord("=", False), , , 10
End If
End Sub

Private Sub PrintTitleJt()
Dim strCmpTitle As String 'Add by Amy 2020/04/01

strCmpTitle = CompNameQuery(2, 3) & "  作成" 'Add by Amy 2020/04/01
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    GetPleftEt
    iPrint = 500
    Printer.Font.Size = 22
    Printer.Font.Bold = True
    Printer.Font.Underline = True
    Printer.FontName = "細明體"
    Printer.CurrentX = 9000 - (Printer.TextWidth("案件ソ狀況報告") / 2)
    Printer.CurrentY = iPrint
    Printer.Print "案件ソ狀況報告"
    iPrint = iPrint + 500
    'Modifed by Lydia 2018/03/16
    'Printer.CurrentX = 9000 - (Printer.TextWidth("台一嚜息Q法律事務所  作成") / 2)
    'Modify by Amy 2020/04/01
    'strCmpTitle = Taie_Jpn_Title & "  作成"
    Printer.CurrentX = 9000 - (Printer.TextWidth(strCmpTitle) / 2)
    Printer.CurrentY = iPrint
    'Modifed by Lydia 2018/03/16
    'Printer.Print "台一嚜息Q法律事務所  作成"
    Printer.Print strCmpTitle 'Taie_Jpn_Title & "  作成"
    'end 2020/04/01
    iPrint = iPrint + 500
    Printer.Font.Size = 10
    Printer.Font.Bold = False
    Printer.Font.Underline = False
    iPrint = iPrint + 300
    'USER 確認英文格式並不用 USER ID
    '89/11/14
    'Printer.CurrentX = 0
    'Printer.CurrentY = iPrint
    'Printer.Print "USER ID：" & strUserNum
    'iPrint = iPrint + 300
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy")
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "To："
    If Len(StrTemp5(12)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(12)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(13)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(13)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(0)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(0)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(1)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(1)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(2)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(2)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(3)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("To：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(3)
       iPrint = iPrint + 300
    End If
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "住所：" & StrTemp5(4)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "Tel：" & StrTemp5(5)
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Page：" & str(Page)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("住所：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(6)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "E-mail：" & StrTemp5(7)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("住所：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(8)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    Printer.Print "Fax：" & StrTemp5(9)
    iPrint = iPrint + 300
    If Len(StrTemp5(10)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("住所：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(10)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(11)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("住所：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(11)
       iPrint = iPrint + 300
    End If
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "貴整理番"
    Printer.CurrentX = PLeft(1)
    Printer.CurrentY = iPrint
    'If intPCaseKind = 2 Then
    'Modify By Cheng 2002/02/27
    '取消列印申請人欄位
    'Printer.Print "出願人"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "出願番"
    Printer.CurrentX = PLeft(3)
    Printer.CurrentY = iPrint
    Printer.Print "鵀W"
    Printer.CurrentX = PLeft(4)
    Printer.CurrentY = iPrint
    Printer.Print "狀況"
    Printer.CurrentX = PLeft(5)
    Printer.CurrentY = iPrint
    Printer.Print "優先菑"
    Printer.CurrentX = PLeft(6)
    Printer.CurrentY = iPrint
    Printer.Print "出願ЯU閉鎖"
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(7)
    Printer.CurrentY = iPrint
    Printer.Print "Case No."
    Printer.CurrentX = PLeft(8)
    Printer.CurrentY = iPrint
    Printer.Print "J整理番"
    Printer.CurrentX = PLeft(9)
    Printer.CurrentY = iPrint
    Printer.Print "登錄番謘@　　　 　　/存珒褻﹛@　　　　　　 /公告年月日　　　"
    'Printer.Print "審定號數　　　　 　　/(專用期間)　　 　　　　/公告日　　　    "
    Printer.CurrentX = PLeft(10)
    Printer.CurrentY = iPrint
    Printer.Print "商標瞻"
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print "商標名b"
    Printer.CurrentX = PLeft(12)
    Printer.CurrentY = iPrint
    Printer.Print "註"
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "次ソ期限"
    iPrint = iPrint + 300
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If blnWordNewPage = True And Page <> 1 Then
        fn_DocNewPage
    End If
    blnWordNewPage = False
    Dim isPrintDate As Boolean
    Dim o_tmp1 As String
    Dim o_tmp2 As String
    Dim o_tmp3 As String
    Dim o_tmp4 As String
    Dim o_tmp5 As String
    Dim o_tmp6 As String
    iPrint = 0
    o_tmp1 = StrTemp5(12)
    o_tmp2 = StrTemp5(13)
    o_tmp3 = StrTemp5(0)
    o_tmp4 = StrTemp5(1)
    o_tmp5 = StrTemp5(2)
    o_tmp6 = StrTemp5(3)
    If Len(CheckStr(o_tmp6)) <> 0 Then
        If Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            o_tmp6 = fn_StrToWordFmt("To：" & o_tmp6, 50) & "Tel：" & StrTemp5(5)
        Else
            o_tmp6 = fn_StrToWordFmt("　：" & o_tmp6, 50) & "Tel：" & StrTemp5(5)
        End If
    End If
    If Len(CheckStr(o_tmp5)) <> 0 Then
        If Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("To：" & o_tmp5, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("To：" & o_tmp5, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("　：" & o_tmp5, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("　：" & o_tmp5, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp4)) <> 0 Then
        If Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("To：" & o_tmp4, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("To：" & o_tmp4, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("　：" & o_tmp4, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("　：" & o_tmp4, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp3)) <> 0 Then
        If Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("To：" & o_tmp3, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("To：" & o_tmp3, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("　：" & o_tmp3, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("　：" & o_tmp3, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp2)) <> 0 Then
        If Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("To：" & o_tmp2, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("To：" & o_tmp2, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("　：" & o_tmp2, 50) & "Tel：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("　：" & o_tmp2, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp1)) <> 0 Then
        o_tmp1 = fn_StrToWordFmt("To：" & o_tmp1, 50) & "Tel：" & StrTemp5(5)
    End If
    isPrintDate = False
    'g_WordAp.
    fn_PutWords "案件ソ狀況報告", wdAlignParagraphCenter, "細明體", 22, False, True, True
    'Modified by Lydia 2018/03/16
    'fn_PutWords "台一嚜息Q法律事務所  作成", wdAlignParagraphCenter, "細明體", 22, , True, True
    'Moidfy by Amy 2020/04/01 原:Taie_Jpn_Title& "  作成"
    fn_PutWords strCmpTitle, wdAlignParagraphCenter, "細明體", 22, , True, True
    'fn_PutWords "　　（專利）", wdAlignParagraphCenter, , 16
    If Len(o_tmp1) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp1, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp1, 95), , , 10
        End If
    End If
    If Len(o_tmp2) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp2, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp2, 95), , , 10
        End If
    End If
    If Len(o_tmp3) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp3, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp3, 95), , , 10
        End If
    End If
    If Len(o_tmp4) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp4, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp4, 95), , , 10
        End If
    End If
    If Len(o_tmp5) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp5, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp5, 95), , , 10
        End If
    End If
    If Len(o_tmp6) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp6, 83) & "Date：" & Format(ChangeWStringToWDateString(strSrvDate(1)), "mmm dd,yyyy"), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp6, 95), , , 10
        End If
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("住所：" & StrTemp5(4), 50) & "E-mail：" & StrTemp5(7), 83) & "Page：" & str(Page), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　" & StrTemp5(6), 50) & "Fax：" & StrTemp5(9), 83), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　" & StrTemp5(8), 50), 83), , , 10
    If Len(StrTemp5(10)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(10), 50), , , 10
    End If
    If Len(StrTemp5(11)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(11), 50), , , 10
    End If
    fn_PutWords fn_StrLineToWord("=", False), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("貴整理番", 16) & fn_StrToWordFmt("出願番", 23) & fn_StrToWordFmt("鵀W", 14) & fn_StrToWordFmt("狀況", 16) & fn_StrToWordFmt("優先菑", 9) & fn_StrToWordFmt("出願ЯU閉鎖", 8), 95), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("Case No.", 16) & fn_StrToWordFmt("J整理番", 11) & fn_StrToWordFmt("登錄番/存珒褻/公告年月日", 25) & fn_StrToWordFmt("商標瞻", 8) & fn_StrToWordFmt("商標名b", 21) & fn_StrToWordFmt("註", 6) & "次ソ期限", 95), , , 10
    fn_PutWords fn_StrLineToWord("=", False), , , 10
End If
End Sub

'Modify by Amy +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintDatilEp(Optional ByVal IsLawOnly As Boolean = False)
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    For i = 0 To 6
       'Modify By Cheng 2002/02/27
       If i <> 1 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print strTemp(i)
       End If
    Next i
    '國外代理人名稱
    i = 20
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print strTemp(i)
    iPrint = iPrint + 300
    For i = 7 To 13
       Printer.CurrentX = PLeft(i)
       Printer.CurrentY = iPrint
       Printer.Print strTemp(i)
    Next i
    iPrint = iPrint + 300
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(Replace(strTemp(0), "*", "＊"), 11) & fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18) & fn_StrToWordFmt(strTemp(2), 7) & fn_StrToWordFmt(strTemp(3), 11) & fn_StrToWordFmt(strTemp(4), 5) & fn_StrToWordFmt(strTemp(5), 7) & fn_StrToWordFmt(strTemp(6), 12) & strTemp(7), 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(0), 16) & fn_StrToWordFmt(strTemp(2), 23) & fn_StrToWordFmt(strTemp(3), 14) & fn_StrToWordFmt(strTemp(4), 16) & fn_StrToWordFmt(strTemp(20), 8) & fn_StrToWordFmt(strTemp(5), 9) & strTemp(6), 95), , , 10
    If iPrint >= o_PaperHeight Then
        Page = Page + 1
        'add  by nickc 2005/11/15  紙本
        If Check3(0).Value = vbChecked Then
            'Printer.Line (0, iPrint)-(16000, iPrint)
            Printer.NewPage
        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
            'fn_PutWords fn_StrLineToWord, , , 10
            fn_DocNewPage
        End If
        Call PrintTitleEp(IsLawOnly) 'Modify by Amy 2020/04/01
    End If
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Replace(strTemp(1), Trim(Replace(fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18), "　", "")), ""), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(11), 12) & fn_StrToWordFmt(strTemp(12), 5) & fn_StrToWordFmt(strTemp(13), 4) & fn_StrToWordFmt(strTemp(14), 3) & "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(7), 16) & fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(strTemp(9), 25) & fn_StrToWordFmt(strTemp(10), 8) & fn_StrToWordFmt(strTemp(11), 21) & fn_StrToWordFmt(strTemp(12), 6) & strTemp(13), 95), , , 10

End If
    
End Sub

Private Sub PrintDatilEt()
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    For i = 0 To 6
       If i <> 1 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print strTemp(i)
       End If
    Next i
    iPrint = iPrint + 300
    For i = 7 To 13
       Printer.CurrentX = PLeft(i)
       Printer.CurrentY = iPrint
       Printer.Print strTemp(i)
    Next i
    iPrint = iPrint + 300
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(Replace(strTemp(0), "*", "＊"), 11) & fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18) & fn_StrToWordFmt(strTemp(2), 7) & fn_StrToWordFmt(strTemp(3), 11) & fn_StrToWordFmt(strTemp(4), 5) & fn_StrToWordFmt(strTemp(5), 7) & fn_StrToWordFmt(strTemp(6), 12) & strTemp(7), 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(0), 16) & fn_StrToWordFmt(strTemp(2), 23) & fn_StrToWordFmt(strTemp(3), 14) & fn_StrToWordFmt(strTemp(4), 16) & fn_StrToWordFmt(strTemp(5), 8) & strTemp(6), 95), , , 10
    If iPrint >= o_PaperHeight Then
        Page = Page + 1
        'add  by nickc 2005/11/15  紙本
        If Check3(0).Value = vbChecked Then
            'Printer.Line (0, iPrint)-(16000, iPrint)
            Printer.NewPage
        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
            'fn_PutWords fn_StrLineToWord, , , 10
            fn_DocNewPage
        End If
        PrintTitleEt
    End If
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Replace(strTemp(1), Trim(Replace(fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18), "　", "")), ""), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(11), 12) & fn_StrToWordFmt(strTemp(12), 5) & fn_StrToWordFmt(strTemp(13), 4) & fn_StrToWordFmt(strTemp(14), 3) & "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(7), 16) & fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(strTemp(9), 25) & fn_StrToWordFmt(strTemp(10), 8) & fn_StrToWordFmt(strTemp(11), 21) & fn_StrToWordFmt(strTemp(12), 6) & strTemp(13), 95), , , 10

End If
End Sub

'Modify by Amy 2020/04/01 +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintDatilJp(Optional ByVal IsLawOnly As Boolean = False)
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    For i = 0 To 6
       If i <> 1 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print strTemp(i)
       End If
    Next i
    iPrint = iPrint + 300
    For i = 7 To 13
       Printer.CurrentX = PLeft(i)
       Printer.CurrentY = iPrint
       Printer.Print strTemp(i)
    Next i
    iPrint = iPrint + 300
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(Replace(strTemp(0), "*", "＊"), 11) & fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18) & fn_StrToWordFmt(strTemp(2), 7) & fn_StrToWordFmt(strTemp(3), 11) & fn_StrToWordFmt(strTemp(4), 5) & fn_StrToWordFmt(strTemp(5), 7) & fn_StrToWordFmt(strTemp(6), 12) & strTemp(7), 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(0), 16) & fn_StrToWordFmt(strTemp(2), 23) & fn_StrToWordFmt(strTemp(3), 14) & fn_StrToWordFmt(strTemp(4), 16) & fn_StrToWordFmt(strTemp(5), 8) & strTemp(6), 95), , , 10
    If iPrint >= o_PaperHeight Then
        Page = Page + 1
        'add  by nickc 2005/11/15  紙本
        If Check3(0).Value = vbChecked Then
            'Printer.Line (0, iPrint)-(16000, iPrint)
            Printer.NewPage
        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
            'fn_PutWords fn_StrLineToWord, , , 10
            fn_DocNewPage
        End If
        Call PrintTitleJp(IsLawOnly) 'Modify by Amy 2020/04/01
    End If
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Replace(strTemp(1), Trim(Replace(fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18), "　", "")), ""), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(11), 12) & fn_StrToWordFmt(strTemp(12), 5) & fn_StrToWordFmt(strTemp(13), 4) & fn_StrToWordFmt(strTemp(14), 3) & "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(7), 16) & fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(strTemp(9), 25) & fn_StrToWordFmt(strTemp(10), 8) & fn_StrToWordFmt(strTemp(11), 21) & fn_StrToWordFmt(strTemp(12), 6) & strTemp(13), 95), , , 10

End If
End Sub

Private Sub PrintDatilJt()
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    For i = 0 To 6
       If i <> 1 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print strTemp(i)
       End If
    Next i
    iPrint = iPrint + 300
    For i = 7 To 13
       Printer.CurrentX = PLeft(i)
       Printer.CurrentY = iPrint
       Printer.Print strTemp(i)
    Next i
    iPrint = iPrint + 300
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(Replace(strTemp(0), "*", "＊"), 11) & fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18) & fn_StrToWordFmt(strTemp(2), 7) & fn_StrToWordFmt(strTemp(3), 11) & fn_StrToWordFmt(strTemp(4), 5) & fn_StrToWordFmt(strTemp(5), 7) & fn_StrToWordFmt(strTemp(6), 12) & strTemp(7), 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(0), 16) & fn_StrToWordFmt(strTemp(2), 23) & fn_StrToWordFmt(strTemp(3), 14) & fn_StrToWordFmt(strTemp(4), 16) & fn_StrToWordFmt(strTemp(5), 8) & strTemp(6), 95), , , 10
    If iPrint >= o_PaperHeight Then
        Page = Page + 1
        'add  by nickc 2005/11/15  紙本
        If Check3(0).Value = vbChecked Then
            'Printer.Line (0, iPrint)-(16000, iPrint)
            Printer.NewPage
        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
            'fn_PutWords fn_StrLineToWord, , , 10
            fn_DocNewPage
        End If
        PrintTitleJt
    End If
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Replace(strTemp(1), Trim(Replace(fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18), "　", "")), ""), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(11), 12) & fn_StrToWordFmt(strTemp(12), 5) & fn_StrToWordFmt(strTemp(13), 4) & fn_StrToWordFmt(strTemp(14), 3) & "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(7), 16) & fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(strTemp(9), 25) & fn_StrToWordFmt(strTemp(10), 8) & fn_StrToWordFmt(strTemp(11), 21) & fn_StrToWordFmt(strTemp(12), 6) & strTemp(13), 95), , , 10

End If
End Sub

Private Sub GetPleftEp()
   Erase PLeft
   PLeft(0) = 0
   PLeft(2) = 5200 - 2100   '3100
   PLeft(3) = 7300 - 2100   '5200
   PLeft(4) = 8600 - 2100   '6500
   PLeft(5) = 16300 - 2100   '14200
   PLeft(6) = 17900 - 2100   '15800
   PLeft(18) = 17900  '是否閉卷
   
   PLeft(7) = 0
   PLeft(8) = 3100
   PLeft(9) = 4800
   PLeft(10) = 9000 + 200
   PLeft(11) = 11100 + 200
   PLeft(12) = 16400 + 200
   PLeft(13) = 17900
End Sub

Private Sub GetPleftEt()
   Erase PLeft
   PLeft(0) = 0
   PLeft(2) = 5200 - 2100
   PLeft(3) = 7300 - 2100
   PLeft(4) = 8600 - 2100
   PLeft(5) = 16300 - 2000 - 2100
   PLeft(6) = 17900 - 2100
   PLeft(18) = 17900  '是否閉卷
   
   PLeft(7) = 0
   PLeft(8) = 3100
   PLeft(9) = 4800
   PLeft(10) = 9000 + 200 + 1500
   PLeft(11) = 11100 + 200 + 1500
   PLeft(12) = 16400 + 200
   PLeft(13) = 17900

End Sub

'Modify by Amy 2020/04/01 +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintDataCp(Optional ByVal IsLawOnly As Boolean = False)
   Dim strCust As String '記錄申請人
   Dim strSystemKind As String '記錄系統類別
   Dim blnFirstPage As Boolean '判斷是否第一頁
   Dim strWhere As String 'Add by Amy 2020/04/01
   
   'Add by Amy 2020/04/01
   If IsLawOnly = True Then
      strWhere = " And InStr(R013010,'L')>0 "
   ElseIf strSrvDate(1) >= 事務所合併日 Then
      strWhere = "And InStr(R013010,'L')=0 "
   End If
   'end 2020/04/01
   
   'add by nickc 2005/11/16 控制 word 換頁用
   blnWordNewPage = True
   '列印第一頁
   blnFirstPage = True
   '國內外分開列印(不同系統類別分開列印)
   'Modify by Amy 2020/04/01 +strWhere
   If txt1(8) = "Y" Then
      '修改排序方式申請人, 系統類別
      strSql = "SELECT DISTINCT R013001,R013019 FROM R050317_C WHERE ID='" & strUserNum & "' " & strWhere & " GROUP BY R013001,R013019 ORDER BY R013001,R013019 "
   '國內外不分開列印(不管系統類別)
   Else
      strSql = "SELECT DISTINCT R013001 FROM R050317_C WHERE ID='" & strUserNum & "' " & strWhere & " GROUP BY R013001 ORDER BY R013001 "
   End If
   'end 2020/04/01
   CheckOC
   SeekTempPrint = ""
   adoRecordset.CursorLocation = adUseClient
   adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   '頁數加一
   Page = Page + 1
   RefreshColData 1, "申請人"
    With adoRecordset
        .MoveFirst
        '記錄申請人
        strCust = "" & .Fields(0).Value
        '記錄系統類別
        If txt1(8) = "Y" Then
            strSystemKind = "" & .Fields(1).Value
        Else
            strSystemKind = ""
        End If
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields(0))
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields(1))
            Else
               strTemp(21) = ""
            End If
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU58,CU61 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 13
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            
            '若申請人不同則跳頁
            If strCust <> strTemp(20) Then
                strCust = strTemp(20)
                strSystemKind = strTemp(21)
                If txt1(8) = "Y" Then
                   strSystemKind = strTemp(21)
                Else
                   strSystemKind = ""
                End If
                Page = Page + 1
                'Add by Amy 2013/10/03 +Excel
                If Check10(1).Value = vbChecked Then
                    fn_SetExcel
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                Else
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    Call PrintTitleCp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
                End If
            '若申請人相同
            Else
                '記錄系統類別
                If txt1(8) = "Y" Then
                    '若系統類別不同
                    If strSystemKind <> strTemp(21) Then
                       strSystemKind = strTemp(21)
                        Page = Page + 1
                        'Add by Amy 2013/10/03 +Excel
                        If Check10(1).Value = vbChecked Then
                             fn_SetExcel
                             fn_CreateExcel Page, strSystemKind, blnFirstPage
                        Else
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_DocNewPage
                            End If
                            Call PrintTitleCp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
                        End If
                    End If
                End If
            End If
            '若為第一頁才印表頭
            'Modify by Amy 2013/10/03 +Excel
            If blnFirstPage = True Then
                If Check10(1).Value = vbChecked Then
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                Else
                    Call PrintTitleCp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
                End If
                blnFirstPage = False
            End If
            '初始化本所案號變數
            SeekTempPrint = ""
            'Modify by Amy 2017/07/25 +R013028
            'Modify by Amy 2020/04/01 +strWhere
            If txt1(8) = "Y" Then
               'edit by nickc 2008/04/15 所有程序抓cp 其餘抓pa
               'Modify by Amy 2013/10/03 所有strsql +顯示R013022, R013023, R013024, R013025
               If txt1(15) = "3" Then
                    'strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,CP24, r013020, r013021 FROM R050317_C,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' "
                    strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,CP24, r013020, r013021,R013022, R013023, R013024, R013025,R013028 From R050317_C,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' " & strWhere
               Else
                    'strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,pa16 as CP24, r013020, r013021 FROM R050317_C,caseprogress,patent WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' and cp01=pa01(+) and cp02=pa02(+) and cp03=pa03(+) and cp04=pa04(+) "
                    strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,pa16 as CP24, r013020, r013021,R013022, R013023, R013024, R013025 ,R013028 From R050317_C,caseprogress,patent WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' and cp01=pa01(+) and cp02=pa02(+) and cp03=pa03(+) and cp04=pa04(+) " & strWhere
               End If
            Else
                'edit by nickc 2008/04/15 所有程序抓cp 其餘抓pa
                If txt1(15) = "3" Then
                    'strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,CP24, r013020, r013021 FROM R050317_C,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' "
                    strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,CP24, r013020, r013021,R013022, R013023, R013024, R013025 ,R013028 From R050317_C,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' " & strWhere
                Else
                    'strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,pa16 as CP24, r013020, r013021 FROM R050317_C,caseprogress,patent WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' and cp01=pa01(+) and cp02=pa02(+) and cp03=pa03(+) and cp04=pa04(+) "
                    strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,pa16 as CP24, r013020, r013021,R013022, R013023, R013024, R013025 ,R013028 From R050317_C,caseprogress,patent WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' and cp01=pa01(+) and cp02=pa02(+) and cp03=pa03(+) and cp04=pa04(+) " & strWhere
                End If
            End If
            'end 2020/04/01
            'end 2017/07/25
            
            '依本所案號排序
            If Me.txt1(9).Text = "1" Then
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018 "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018 "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018 "
            '依申請國家+案件名稱排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018 "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    For i = 0 To 19
                           strTemp(i) = "" & adoRecordset1.Fields(i + 1)
                    Next i
                    strTemp(22) = ""
                    strTemp(23) = ""
                    strTemp(24) = ""
                    
                    '若本所案號不同
                    'Modify by Amy 2013/10/03 產生Excel資料時需全有值，不需判斷本所案號相同不顯示的欄位
                    'If SeekTempPrint <> strTemp(8) Then
                    If SeekTempPrint <> strTemp(8) Or Check10(1).Value = vbChecked Then
                        If Not Check10(1).Value = vbChecked Then
                            '若本所案號變數有資料
                            If SeekTempPrint <> "" Then
                                'add  by nickc 2005/11/15  紙本
                                If Check3(0).Value = vbChecked Then
                                    Printer.Line (0, iPrint)-(19200, iPrint)
                                    iPrint = iPrint + 300
                                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                    fn_PutWords fn_StrLineToWord(, False), , , 10
                                End If
                                'edit by nickc 2005/11/15
                                'If iPrint >= 14200 Then
                                If iPrint >= o_PaperHeight Then
                                    Page = Page + 1
                                    'add  by nickc 2005/11/15  紙本
                                    If Check3(0).Value = vbChecked Then
                                        Printer.NewPage
                                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                        fn_DocNewPage
                                    End If
                                    Call PrintTitleCp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
                                End If
                            End If
                        End If 'Not check10(1)
                        SeekTempPrint = strTemp(8)
                        strTemp(0) = StrToStr(strTemp(0), 15)
                        strTemp(1) = StrToStr(strTemp(1), 10)
                        strTemp(2) = StrToStr(strTemp(2), 10)
                        strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                        strTemp(4) = StrToStr(strTemp(4), 38)
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        'Add by Amy 2013/10/03 +if
                        If Check10(1).Value = vbChecked Then
                            strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10)
                        Else
                            strTemp(9) = Format(StrToStr(strTemp(9) & String(20, " "), 10) & " ", "@@@@@@@@@@@@@@@@@@@@") & "/(" & StrToStr(Format(ChangeWStringToWDateString(strTemp(10)) & String(10, " "), "@@@@@@@@@@"), 5) & ")/" & strTemp(11)
                        End If 'end 2013/10/3
                        strTemp(10) = StrToStr(strTemp(12), 4) 'Modify by Amy 2013/10/03 原取10
                        strTemp(11) = StrToStr(strTemp(13), 25)
                        strTemp(13) = strTemp(6)
                        strTemp(12) = ""
                        strTemp(6) = "" & strTemp(15)
                        If Right(strTemp(6), 2) = "閉卷" Then
                            strTemp(6) = Replace(strTemp(6), "閉卷", "")
                            strTemp(22) = "閉卷"
                        End If
                        '顯示准駁狀況
                        strTemp(14) = IIf(strTemp(19) = "1", "准", IIf(strTemp(19) = "2", "駁", ""))
                        '申請日
                        strTemp(23) = "" & adoRecordset1.Fields(21).Value
                        '優先權日
                        strTemp(24) = "" & adoRecordset1.Fields(22).Value
                    
                    '若本所案號相同
                    ElseIf SeekTempPrint = strTemp(8) Then '2013/10/3 原:Else
                        strTemp(4) = StrToStr(strTemp(4), 38)
                        'Add by Morgan 2008/8/14 取消收文日
                        strTemp(6) = "" & strTemp(15)
                        If Right(strTemp(6), 2) = "閉卷" Then
                            strTemp(6) = Replace(strTemp(6), "閉卷", "")
                        End If
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        strTemp(9) = Format(StrToStr(strTemp(9) & String(20, " "), 10) & " ", "@@@@@@@@@@@@@@@@@@@@") & "/(" & StrToStr(Format(ChangeWStringToWDateString(strTemp(10)) & String(10, " "), "@@@@@@@@@@"), 5) & ")/" & strTemp(11)
                        '顯示准駁狀況
                        strTemp(14) = IIf(strTemp(19) = "1", "准", IIf(strTemp(19) = "2", "駁", ""))
                        For i = 0 To 3
                           strTemp(i) = ""
                        Next i
                        'Modify by Morgan 2008/8/14 取消收文日也要印
                        'For i = 6 To 13
                        For i = 7 To 13
                           strTemp(i) = ""
                        Next i
                        strTemp(22) = ""
                        strTemp(23) = ""
                        strTemp(24) = ""
                    End If
                    strPriDate = "" 'Add by Amy 2017/07/25
                    'Add by Amy 2013/10/03 +勾選Excel
                    If Check10(1).Value = vbChecked Then
                        'Add by Amy 2017/07/25 +優先權資料(所有格式只顯示於CP31=Y 那筆)
                        If Not (txt1(15) = "3" And "" & adoRecordset1("R013028") <> "Y") Then
                            PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                        End If
                        
                        If txt1(15) = "2" Then
                            CaseProgress_NewA = StrToStr(strTemp(5), 6)
                        Else
                            'Modify by Amy 2021/05/20 申請國家可能為空值 ex:CFP-007198
                            CaseProgress_NewA = StrToStr(GetCaseProgress_NewA("" & adoRecordset1.Fields("R013005").Value, adoRecordset1.Fields("R013022").Value, adoRecordset1.Fields("R013023").Value, adoRecordset1.Fields("R013024").Value, adoRecordset1.Fields("R013025").Value), 6)
                        End If
                        'Modify by Amy 2017/07/25 +優先權資料
                        'Moidfy by Amy 2020/04/01 +法務
                        If ReportName = "其他" Or ReportName = "法務" Then
                            GetOtherDuration "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                             'Excel資料(依顯示順序)
                             strXlsData = strTemp(8) & "$$" & strXlsTp(0) & "$$" & strTemp(7) & "$$" & strTemp(11) & "$$" & _
                                                strTemp(23) & "$$" & strTemp(3) & "$$" & strTemp(2) & "$$" & strTemp(9) & "$$" & _
                                                strXlsTp(4) & "$$" & strTemp(4) & "$$" & strXlsTp(1) & "$$" & strXlsTp(2) & "$$" & _
                                                CaseProgress_NewA & "$$" & strTemp(13) & IIf(Len(strTemp(15)) > 0, Chr(10) & "(" & StrToStr(strTemp(15), 6) & ")", "") & _
                                                "$$" & strPriDate

                        Else
                            GetPatentDuration "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value, False
                            '抓 發明人 及 最新案件進度
                            strInventor = GetInventor(adoRecordset1.Fields("R013022").Value, adoRecordset1.Fields("R013023").Value, adoRecordset1.Fields("R013024").Value, adoRecordset1.Fields("R013025").Value)
                            'Excel資料(依顯示順序) Modify by Amy 2013/11/04 strTemp(13)改strxlstp(5)/strTemp(15)改strxlstp(6)
                            strXlsData = "$$" & strTemp(8) & "$$" & strXlsTp(0) & "$$" & strTemp(7) & "$$" & strTemp(11) & "$$" & _
                                                strInventor & "$$" & strTemp(23) & "$$" & strTemp(3) & "$$" & strTemp(2) & "$$" & strTemp(9) & "$$" & _
                                                strTemp(10) & "$$" & strTemp(14) & "$$" & strTemp(4) & "$$" & strXlsTp(1) & "$$" & strXlsTp(2) & "$$" & _
                                                strXlsTp(3) & IIf(Len(strXlsTp(4)) > 0, Chr(10) & strXlsTp(4), "") & "$$" & CaseProgress_NewA & "$$" & strXlsTp(5) & IIf(Len(strXlsTp(6)) > 0, Chr(10) & "(" & StrToStr(strXlsTp(6), 6) & ")", "") & _
                                                "$$" & strPriDate
                         End If
                         'end 2017/07/25
                         
                         fn_PutExcel "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                         
                    '不是勾選Excel
                    Else
                        'edit by nickc 2005/11/15
                        'If iPrint >= 14200 Then
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                                fn_DocNewPage
                            End If
                            Call PrintTitleCp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
                        End If
                        '列印明細資料
                        PrintDatilCp
                        'Add by Amy 2017/07/25 +顯示優先權資料
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            '紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                                fn_DocNewPage
                            End If
                            Call PrintTitleCp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
                        End If
                        '優先權資料(所有格式只顯示於CP31=Y 那筆)
                        If Not (txt1(15) = "3" And "" & adoRecordset1("R013028") <> "Y") Then
                            PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value, "PrintTitleCp"
                        End If
                        'end 2017/07/25
                    End If 'end 勾選Excel
                    adoRecordset1.MoveNext
                Loop
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.Line (0, iPrint)-(19200, iPrint)
                        iPrint = iPrint + 100
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrLineToWord(, False), , , 10
                    End If
                    'edit by nickc 2005/11/15
                    'If iPrint >= 14200 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_DocNewPage
                        End If
                        Call PrintTitleCp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
                    End If
                End If '2013/10/3
                
                'Modify by Amy 2020/04/01 +strWhere
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                'end 2020/04/01
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                     IntTot = AdoRecordSet3.RecordCount
                End If

                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/16  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(5) - 3000
                        Printer.CurrentY = iPrint
                        Printer.Print "總計：" & Format(IntTot, "##0")
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "總計：" & Format(IntTot, "##0"), 52), , , 10
                    End If
                End If
                'Modify by Amy 2020/04/01 +strWhere
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                'end 2020/04/01
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                  IntTot = AdoRecordSet3.RecordCount
                End If
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/16  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(5)
                        Printer.CurrentY = iPrint
                        Printer.Print "閉卷件數：" & Format(IntTot, "##0")
                        iPrint = iPrint + 300
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt("閉卷件數：" & Format(IntTot, "##0"), 17), , , 10, False
                    End If
                End If '2013/10/3
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
    If adoRecordset.RecordCount > 0 And Check10(1).Value = vbChecked Then 'Add by Amy 2013/10/03
        fn_SetExcel '設定最後一個sheet 的Excel格式
    End If
End If
CheckOC
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
End Sub

'Modify by Morgan 2008/8/14 第2道程序以後不必印空白行,電子檔版面欄位校正
Private Sub PrintDataCt()
   Dim strCust As String '記錄申請人
   Dim strSystemKind As String '記錄系統類別
   Dim blnFirstPage As Boolean '判斷是否第一頁
   Dim strTMGoods As String 'Add by Amy 2017/03/13 指定商品
   
   'add by nickc 2005/11/16 控制 word 換頁用
   blnWordNewPage = True
   '列印第一頁
   blnFirstPage = True
   '國內外分開列印(不同系統類別分開列印)
   If txt1(8) = "Y" Then
      strSql = "SELECT DISTINCT R013001,R013019 From R050317_C WHERE ID='" & strUserNum & "' GROUP BY R013001,R013019 ORDER BY R013001,R013019 "
   '國內外不分開列印(不管系統類別)
   Else
      strSql = "SELECT DISTINCT R013001 From R050317_C WHERE ID='" & strUserNum & "' GROUP BY R013001 ORDER BY R013001 "
   End If
   CheckOC
   SeekTempPrint = ""
   adoRecordset.CursorLocation = adUseClient
   adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
   
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   '頁數加一
   Page = Page + 1
   RefreshColData 1, "申請人"
    With adoRecordset
        .MoveFirst
        'Add By Cheng 2003/02/07
        '記錄申請人
        strCust = "" & .Fields(0).Value
        'Add By Cheng 2003/02/10
        '記錄系統類別
        If txt1(8) = "Y" Then
            strSystemKind = "" & .Fields(1).Value
        Else
            strSystemKind = ""
        End If
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields(0))
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields(1))
            Else
               strTemp(21) = ""
            End If
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU58,CU61 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 13
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            '若申請人不同則跳頁
            If strCust <> strTemp(20) Then
                strCust = strTemp(20)
                strSystemKind = strTemp(21)
                If txt1(8) = "Y" Then
                   strSystemKind = strTemp(21)
                Else
                   strSystemKind = ""
                End If
                Page = Page + 1
                'Add by Amy 2013/10/03 +Excel
                If Check10(1).Value = vbChecked Then
                    fn_SetExcel
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                Else
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    PrintTitleCt
                End If
            '若申請人相同
            Else
                '記錄系統類別
                If txt1(8) = "Y" Then
                    '若系統類別不同
                    If strSystemKind <> strTemp(21) Then
                       strSystemKind = strTemp(21)
                        Page = Page + 1
                        'Add by Amy 2013/10/03 +Excel
                        If Check10(1).Value = vbChecked Then
                             fn_SetExcel
                             fn_CreateExcel Page, strSystemKind, blnFirstPage
                        Else
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_DocNewPage
                            End If
                            PrintTitleCt
                        End If
                    End If
                End If
            End If
            '若為第一頁才印表頭
            'Modify by Amy 2013/10/03 +Excel
            If blnFirstPage = True Then
                If Check10(1).Value = vbChecked Then
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                Else
                    PrintTitleCt
                End If
                blnFirstPage = False
            End If
            '初始化本所案號變數
            SeekTempPrint = ""
            'Modify by Amy 2017/07/25 +R013028
            If txt1(8) = "Y" Then
               'edit by nickc 2008/04/15 所有程序抓cp 其餘抓pa
               'Modify by Amy 2013/10/03 所有strsql +顯示R013022, R013023, R013024, R013025
               If txt1(15) = "3" Then
                    'strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,CP24, r013020, r013021 FROM R050317_C,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' "
                    strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,CP24, r013020, r013021,R013022, R013023, R013024, R013025 ,R013028 From R050317_C,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' "
               Else
                    'strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,tm16 as CP24, r013020, r013021 FROM R050317_C,caseprogress,trademark WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' and cp01=tm01(+) and cp02=tm02(+) and cp03=tm03(+) and cp04=tm04(+)  "
                    strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,tm16 as CP24, r013020, r013021,R013022, R013023, R013024, R013025 ,R013028 From R050317_C,caseprogress,trademark WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' and cp01=tm01(+) and cp02=tm02(+) and cp03=tm03(+) and cp04=tm04(+)  "
               End If
            Else
               'edit by nickc 2008/04/15 所有程序抓cp 其餘抓pa
               If txt1(15) = "3" Then
                    'strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,CP24, r013020, r013021 FROM R050317_C,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' "
                    strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,CP24, r013020, r013021,R013022, R013023, R013024, R013025 ,R013028 From R050317_C,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' "
               Else
                    'strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,tm16 as CP24, r013020, r013021 FROM R050317_C,caseprogress,trademark WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' and cp01=tm01(+) and cp02=tm02(+) and cp03=tm03(+) and cp04=tm04(+) "
                    strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,tm16 as CP24, r013020, r013021,R013022, R013023, R013024, R013025 ,R013028 From R050317_C,caseprogress,trademark WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' and cp01=tm01(+) and cp02=tm02(+) and cp03=tm03(+) and cp04=tm04(+) "
               End If
            End If
            'end 2017/07/25
            
            'Modify by Morgan 2008/9/8 排序在收文號前加收文日
            '依本所案號排序
            If Me.txt1(9).Text = "1" Then
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))),cp05, r013018  "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))),cp05, r013018  "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))),cp05, r013018  "
            '依申請國家+案件名稱排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))),cp05, r013018  "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    For i = 0 To 19
                        strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1))
                    Next i
                    strTemp(22) = ""
                    strTemp(23) = ""
                    strTemp(24) = ""
                    
                    '若本所案號不同
                    'Modify by Amy 2013/10/03 產生Excel資料時需全有值，不需判斷本所案號相同不顯示的欄位
                    'If SeekTempPrint <> strTemp(8) Then
                    If SeekTempPrint <> strTemp(8) Or Check10(1).Value = vbChecked Then
                        If Not Check10(1).Value = vbChecked Then
                            If SeekTempPrint <> "" Then
                                'add  by nickc 2005/11/15  紙本
                                If Check3(0).Value = vbChecked Then
                                    Printer.Line (0, iPrint)-(19200, iPrint)
                                    iPrint = iPrint + 300
                                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                    fn_PutWords fn_StrLineToWord(, False), , , 10
                                End If
                                'edit by nickc 2005/11/15
                                'If iPrint >= 14200 Then
                                If iPrint >= o_PaperHeight Then
                                    Page = Page + 1
                                    'add  by nickc 2005/11/15  紙本
                                    If Check3(0).Value = vbChecked Then
                                        Printer.NewPage
                                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                        fn_DocNewPage
                                    End If
                                    PrintTitleCt
                                End If
                            End If
                        End If '2013/10/3
                        SeekTempPrint = strTemp(8)
                        strTemp(0) = StrToStr(strTemp(0), 15)
                        strTemp(1) = StrToStr(strTemp(1), 10)
                        strTemp(2) = StrToStr(strTemp(2), 10)
                        strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                        strTemp(4) = StrToStr(strTemp(4), 28)
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        
                        'Modify by Morgan 2008/8/14
                        If Check3(0).Value = vbChecked Then
                           strTemp(9) = Format(StrToStr(strTemp(9) & String(20, " "), 10) & " ", "@@@@@@@@@@@@@@@@@@@@") & "/(" & StrToStr(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 1)) & String(10, " "), "@@@@@@@@@@"), 5) & "-" & StrToStr(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 2)) & String(10, " "), "@@@@@@@@@@"), 5) & ")/" & Format(ChangeTStringToTDateString(ChangeWStringToTString(strTemp(11))) & " ", "@@@@@@@@@@")
                        ElseIf Check10(1).Value = vbChecked Then 'Add by Amy 2013/10/03
                            strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 11)
                        Else
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 11) & "/(" & StrToStr(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 1)) & String(10, " "), "@@@@@@@@@@"), 5) & "-" & StrToStr(Format(ChangeWStringToWDateString(StringTwoString(strTemp(10), 2)) & String(10, " "), "@@@@@@@@@@"), 5) & ")/" & ChangeTStringToTDateString(ChangeWStringToTString(strTemp(11)))
                        End If
                        strTemp(10) = StrToStr(strTemp(12), 10)
                        strTemp(11) = StrToStr(strTemp(13), 15)
                        strTemp(13) = strTemp(6)
                        strTemp(12) = ""
                        strTemp(6) = "" & strTemp(15)
                        If Right(strTemp(6), 2) = "閉卷" Then
                            strTemp(6) = Replace(strTemp(6), "閉卷", "")
                            strTemp(22) = "閉卷"
                        End If
                        '顯示准駁狀況
                        strTemp(14) = IIf(strTemp(19) = "1", "准", IIf(strTemp(19) = "2", "駁", ""))
                        '申請日
                        strTemp(23) = "" & adoRecordset1.Fields(21).Value
                        '發文日
                        strTemp(24) = "" & adoRecordset1.Fields(22).Value
                        
                    '若本所案號相同
                    ElseIf SeekTempPrint = strTemp(8) Then '2013/10/3 原:Else
                        strTemp(4) = StrToStr(strTemp(4), 28)
                        'Add by Morgan 2008/8/14 取消收文日
                        strTemp(6) = "" & strTemp(15)
                        If Right(strTemp(6), 2) = "閉卷" Then
                            strTemp(6) = Replace(strTemp(6), "閉卷", "")
                        End If
                        '顯示准駁狀況
                        strTemp(14) = IIf(strTemp(19) = "1", "准", IIf(strTemp(19) = "2", "駁", ""))
                        '發文日
                        strTemp(24) = "" & adoRecordset1.Fields(22).Value
                        For i = 0 To 3
                           strTemp(i) = ""
                        Next i
                        'Modify by Morgan 2008/8/14 取消收文日也要印
                        'For i = 6 To 13
                        For i = 7 To 13
                           strTemp(i) = ""
                        Next i
                        strTemp(22) = ""
                        strTemp(23) = ""
                        'Add by Morgan 2008/8/14 優先權日只要印一次
                        strTemp(5) = ""
                    End If
                    strPriDate = "" 'Add by Amy 2017/07/25
                    
                    'Add by Amy 2013/10/03 +勾選Excel
                    If Check10(1).Value = vbChecked Then
                        'Add by Amy 2017/07/25 +優先權資料(所有格式只顯示於CP31=Y 那筆)
                        If Not (txt1(15) = "3" And "" & adoRecordset1("R013028") <> "Y") Then
                            PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                        End If
                        'Add by Amy 2017/03/13 +指定商品
                        strTMGoods = ""
                        If bolTMGoods = True Then
                            'Modify by Amy 2019/05/30  指商品若無中文->英文->日文 BeforePrintGetDBData加參數
                            strTMGoods = BeforePrintGetDBData("TMGoods:" & adoRecordset1("R013022").Value & "-" & adoRecordset1("R013023").Value & "-" & _
                                                                                                                 adoRecordset1("R013024").Value & "-" & adoRecordset1("R013025").Value & "-中文含標題", True, True)
                        End If
                        'end 2017/03/13
                        GetTrademarkDuration "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                        '最新案件進度
                        If txt1(15) = "2" Then
                            CaseProgress_NewA = strTemp(5)
                        Else
                            'Modify by Amy 2021/05/20 申請國家可能為空值 ex:CFP-007198
                            CaseProgress_NewA = GetCaseProgress_NewA("" & adoRecordset1.Fields("R013005").Value, adoRecordset1.Fields("R013022").Value, adoRecordset1.Fields("R013023").Value, adoRecordset1.Fields("R013024").Value, adoRecordset1.Fields("R013025").Value)
                        End If
                        'Excel資料(依顯示順序)
                         'Modify by Amy 2017/03/13 +指定商品
                         'Modify by Amy 2017/07/25 +優先權資料
                         strXlsData = "$$" & strTemp(8) & "$$" & strXlsTp(0) & "$$" & strTemp(7) & "$$" & strTemp(11) & "$$" & _
                                            strTemp(23) & "$$" & strTemp(3) & "$$" & strTemp(2) & "$$" & strTemp(9) & "$$" & strXlsTp(4) & "$$" & _
                                            strTemp(14) & "$$" & strTemp(4) & "$$" & strXlsTp(1) & "$$" & strXlsTp(2) & "$$" & _
                                            strXlsTp(3) & "$$" & CaseProgress_NewA & "$$" & strTemp(13) & IIf(Len(strTemp(15)) > 0, Chr(10) & "(" & StrToStr(strTemp(15), 6) & ")", "") & IIf(bolTMGoods = True, "$$" & strTMGoods, "") & _
                                            "$$" & strPriDate
                        fn_PutExcel "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                        
                    '不是勾選Excel
                    Else
                        'edit by nickc 2005/11/15
                        'If iPrint >= 14200 Then
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                                fn_DocNewPage
                            End If
                            PrintTitleCt
                        End If
                        PrintDatilCt
                        'Add by Amy 2017/07/25 +優先權資料
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            '紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                                fn_DocNewPage
                            End If
                            PrintTitleCt
                        End If
                        If Not (txt1(15) = "3" And "" & adoRecordset1("R013028") <> "Y") Then
                            PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value, "PrintTitleCt"
                        End If
                        'end 2017/07/25
                    End If '2013/10/3
                    adoRecordset1.MoveNext
                Loop
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.Line (0, iPrint)-(19200, iPrint)
                        iPrint = iPrint + 100
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrLineToWord(, False), , , 10
                    End If
                    'edit by nickc 2005/11/17
                    'If iPrint >= 14200 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_DocNewPage
                        End If
                        PrintTitleCt
                    End If
                End If '2013/10/3
                
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/17  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(5) - 3000
                        Printer.CurrentY = iPrint
                        Printer.Print "總計：" & Format(IntTot, "##0")
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "總計：" & Format(IntTot, "##0"), 52), , , 10
                    End If
                End If
                If txt1(8) = "Y" Then
                    'Modify By Cheng 2003/05/07
'                  strSQL = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_c WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017='閉卷' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                    'Modify By Cheng 2003/05/07
'                  strSQL = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_c WHERE R013001='" & strTemp(20) & "' AND R013017='閉卷' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                End If
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/17  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(5)
                        Printer.CurrentY = iPrint
                        Printer.Print "閉卷件數：" & Format(IntTot, "##0")
                        iPrint = iPrint + 300
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt("閉卷件數：" & Format(IntTot, "##0"), 17), , , 10, False
                    End If
                End If '2013/10/3
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
    If adoRecordset.RecordCount > 0 And Check10(1).Value = vbChecked Then 'Add by Amy 2013/10/03
        fn_SetExcel '設定最後一個sheet 的Excel格式
    End If
End If
CheckOC
'Printer.CurrentX = 500
'Printer.CurrentY = iPrint
'Printer.Print String(250, "-")
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
End Sub

'Modify by Amy +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintTitleCp(Optional ByVal IsLawOnly As Boolean = False)
Dim strGetTitleNick As String
Dim strCmpTitle As String 'Add by Amy 2020/04/01

strGetTitleNick = GetTitleNick
'Add by Amy 2020/04/01
If strGetTitleNick = "" Then
    Select Case m_strPrintKind
        Case "1"
            strCmpTitle = "（專利）"
        Case "3"
            strCmpTitle = "（其他）"
        Case "4"
            strCmpTitle = "（法務）"
        Case Else
    End Select
End If
strCmpTitle = strGetTitleNick & "客戶" & IIf(Check4(0).Value = vbChecked, "群組", "") & "案件總簿" & strCmpTitle
'end 2020/04/01
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    GetPleftCp
    iPrint = 500
    Printer.Font.Size = 22
    Printer.Font.Bold = True
    Printer.Font.Underline = True
    Printer.FontName = "細明體"
    'Modify by Amy 2020/04/01
    'Printer.CurrentX = 9000 - (Printer.TextWidth(GetTitleNick & "客戶案件總簿") / 2)
    'Printer.CurrentX = 9000 - (Printer.TextWidth(strGetTitleNick & "客戶" & IIf(Check4(0).Value = vbChecked, "群組", "") & "案件總簿" & IIf(strGetTitleNick = "", IIf(m_strPrintKind = "1", "（專利）", IIf(m_strPrintKind = "3", "（其他）", "")), "")) / 2)
    Printer.CurrentX = 9000 - (Printer.TextWidth(strCmpTitle) / 2)
    Printer.CurrentY = iPrint
    'Printer.Print GetTitleNick & "客戶案件總簿"
    Printer.Print strCmpTitle
    'end 2020/04/01
    iPrint = iPrint + 500
    'Printer.CurrentX = 9000 - (Printer.TextWidth("Prepared by Tai E International Patent & Law Office") / 2)
    'Printer.CurrentY = iPrint
    'Printer.Print "Prepared by Tai E International Patent & Law Office"
    'iPrint = iPrint + 500
    Printer.Font.Size = 10
    Printer.Font.Bold = False
    Printer.Font.Underline = False
    iPrint = iPrint + 300
    'USER 確認格式並不用 USER ID
    '89/11/14
    'Printer.CurrentX = 0
    'Printer.CurrentY = iPrint
    'Printer.Print "USER ID：" & strUserNum
    'iPrint = iPrint + 300
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "列印日期：" & ChangeTStringToTDateString(GetTaiwanTodayDate)
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "收件人："
    If Len(StrTemp5(12)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(12)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(13)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(13)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(0)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(0)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(1)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(1)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(2)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(2)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(3)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(3)
       iPrint = iPrint + 300
    End If
    'Add By Cheng 2003/06/13
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint - 300
    
    Printer.Print "電話：" & StrTemp5(5)
    
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "地址：" & StrTemp5(4)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    
    Printer.Print "E-mail：" & StrTemp5(7)
    
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Page：" & str(Page)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(6)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    
    Printer.Print "傳真：" & StrTemp5(9)
    
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(8)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    
    Printer.Print "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True)
    
    iPrint = iPrint + 300
    If Len(StrTemp5(10)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(10)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(11)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(11)
       iPrint = iPrint + 300
    End If
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "彼所案號"
    Printer.CurrentX = PLeft(1)
    Printer.CurrentY = iPrint
    'If intPCaseKind = 2 Then
    'Modify By Cheng 2002/02/27
    '取消列印申請人欄位
    'Printer.Print "申請人"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "申請案號"
    Printer.CurrentX = PLeft(19)
    Printer.CurrentY = iPrint
    Printer.Print "申請日"
    Printer.CurrentX = PLeft(3)
    Printer.CurrentY = iPrint
    Printer.Print "申請國家"
    Printer.CurrentX = PLeft(4)
    Printer.CurrentY = iPrint
    Printer.Print "案件性質"
    Printer.CurrentX = PLeft(5)
    Printer.CurrentY = iPrint
    Printer.Print "發文日"
    'Add By Cheng 2003/02/10
    '加准駁狀況
    Printer.CurrentX = PLeft(14)
    Printer.CurrentY = iPrint
    Printer.Print "准駁"
    Printer.CurrentX = PLeft(20)
    Printer.CurrentY = iPrint
    Printer.Print "最早優先權日"
    Printer.CurrentX = PLeft(6)
    Printer.CurrentY = iPrint
    Printer.Print "取消收文日期"
    Printer.CurrentX = PLeft(18)
    Printer.CurrentY = iPrint
    Printer.Print "是否閉卷"
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(7)
    Printer.CurrentY = iPrint
    Printer.Print "客戶案件案號"
    Printer.CurrentX = PLeft(8)
    Printer.CurrentY = iPrint
    Printer.Print "本所案號"
    Printer.CurrentX = PLeft(9)
    Printer.CurrentY = iPrint
    Printer.Print "專利號數　　/(專利權到期日)/專利權是否存在"
    Printer.CurrentX = PLeft(10)
    Printer.CurrentY = iPrint
    Printer.Print "專利種類"
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print "案件名稱"
    Printer.CurrentX = PLeft(12)
    Printer.CurrentY = iPrint
    Printer.Print "備註"
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "最近期限"
    iPrint = iPrint + 300
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If blnWordNewPage = True And Page <> 1 Then
        fn_DocNewPage
    End If
    blnWordNewPage = False
    Dim isPrintDate As Boolean
    Dim o_tmp1 As String
    Dim o_tmp2 As String
    Dim o_tmp3 As String
    Dim o_tmp4 As String
    Dim o_tmp5 As String
    Dim o_tmp6 As String
    iPrint = 0
    o_tmp1 = StrTemp5(12)
    o_tmp2 = StrTemp5(13)
    o_tmp3 = StrTemp5(0)
    o_tmp4 = StrTemp5(1)
    o_tmp5 = StrTemp5(2)
    o_tmp6 = StrTemp5(3)
    If Len(CheckStr(o_tmp6)) <> 0 Then
        If Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            o_tmp6 = fn_StrToWordFmt("收件人：" & o_tmp6, 50) & "電話：" & StrTemp5(5)
        Else
            o_tmp6 = fn_StrToWordFmt("　　　：" & o_tmp6, 50) & "電話：" & StrTemp5(5)
        End If
    End If
    If Len(CheckStr(o_tmp5)) <> 0 Then
        If Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp4)) <> 0 Then
        If Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp3)) <> 0 Then
        If Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp2)) <> 0 Then
        If Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp1)) <> 0 Then
        If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) = 0 Then
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 50) & "電話：" & StrTemp5(5)
        Else
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 50)
        End If
    End If
    isPrintDate = False
    'g_WordAp.
    'Modify by Amy 2020/04/01 改抓變數
    'fn_PutWords strGetTitleNick & "客戶" & IIf(Check4(0).Value = vbChecked, "群組", "") & "案件總簿" & IIf(strGetTitleNick = "", IIf(m_strPrintKind = "1", "（專利）", IIf(m_strPrintKind = "3", "（其他）", "")), ""), wdAlignParagraphCenter, "細明體", 22, False, True, True
    fn_PutWords strCmpTitle, wdAlignParagraphCenter, "細明體", 22, False, True, True
    'fn_PutWords "　　（專利）", wdAlignParagraphCenter, , 16
    If Len(o_tmp1) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp1, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp1, 95), , , 10
        End If
    End If
    If Len(o_tmp2) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp2, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp2, 95), , , 10
        End If
    End If
    If Len(o_tmp3) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp3, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp3, 95), , , 10
        End If
    End If
    If Len(o_tmp4) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp4, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp4, 95), , , 10
        End If
    End If
    If Len(o_tmp5) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp5, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp5, 95), , , 10
        End If
    End If
    If Len(o_tmp6) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp6, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp6, 95), , , 10
        End If
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("地址：" & StrTemp5(4), 50) & "E-mail：" & StrTemp5(7), 83) & "Page：" & str(Page), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(6), 50) & "傳真：" & StrTemp5(9), 83), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(8), 50) & "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True), 83), , , 10
    If Len(StrTemp5(10)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(10), 50), , , 10
    End If
    If Len(StrTemp5(11)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(11), 50), , , 10
    End If
    fn_PutWords fn_StrLineToWord("=", False), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("彼所案號", 16) & fn_StrToWordFmt("申請案號", 11) & fn_StrToWordFmt("申請日", 8) & fn_StrToWordFmt("申請國家", 7) & fn_StrToWordFmt("案件性質", 10) & fn_StrToWordFmt("發文日", 8) & fn_StrToWordFmt("准駁", 9) & fn_StrToWordFmt("最早優先權日", 9) & fn_StrToWordFmt("取消收文日", 9) & "是否閉卷", 95), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("客戶案件案號", 16) & fn_StrToWordFmt("本所案號", 11) & fn_StrToWordFmt("專利號數/(專利權到期日)/專利權是否存在", 25) & fn_StrToWordFmt("專利種類", 8) & fn_StrToWordFmt("案件名稱", 21) & fn_StrToWordFmt("備註", 6) & "最近期限", 95), , , 10
    fn_PutWords fn_StrLineToWord("=", False), , , 10
End If
End Sub

Private Sub PrintTitleCt()
Dim strGetTitleNick As String
Dim strCmpTitle As String 'Add by Amy 2020/04/01

strGetTitleNick = GetTitleNick
'Moidify by Amy 2020/04/01
If strGetTitleNick = "" Then
    strCmpTitle = "（商標）"
End If
strCmpTitle = strGetTitleNick & "客戶案件總簿" & strCmpTitle
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    GetPleftCt
    iPrint = 500
    Printer.Font.Size = 22
    Printer.Font.Bold = True
    Printer.Font.Underline = True
    Printer.FontName = "細明體"
    'Moidify by Amy 2020/04/01
    'Printer.CurrentX = 9000 - (Printer.TextWidth(GetTitleNick & "客戶案件總簿") / 2)
    'Printer.CurrentX = 9000 - (Printer.TextWidth(strGetTitleNick & "客戶案件總簿" & IIf(strGetTitleNick = "", "（商標）", "")) / 2)
    Printer.CurrentX = 9000 - (Printer.TextWidth(strCmpTitle) / 2)
    Printer.CurrentY = iPrint
    'Printer.Print GetTitleNick & "客戶案件總簿"
    Printer.Print strCmpTitle
    'end 2020/04/01
    iPrint = iPrint + 500
    'Printer.CurrentX = 9000 - (Printer.TextWidth("Prepared by Tai E International Patent & Law Office") / 2)
    'Printer.CurrentY = iPrint
    'Printer.Print "Prepared by Tai E International Patent & Law Office"
    'iPrint = iPrint + 500
    Printer.Font.Size = 10
    Printer.Font.Bold = False
    Printer.Font.Underline = False
    iPrint = iPrint + 300
    'USER 確認格式並不用 USER ID
    '89/11/14
    'Printer.CurrentX = 0
    'Printer.CurrentY = iPrint
    'Printer.Print "USER ID：" & strUserNum
    'iPrint = iPrint + 300
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "列印日期：" & ChangeTStringToTDateString(GetTaiwanTodayDate)
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "收件人："
    If Len(StrTemp5(12)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(12)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(13)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(13)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(0)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(0)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(1)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(1)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(2)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(2)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(3)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(3)
       iPrint = iPrint + 300
    End If
    'Add By Cheng 2003/06/13
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint - 300
    
    Printer.Print "電話：" & StrTemp5(5)
    
    Printer.CurrentX = 0
    Printer.CurrentY = iPrint
    Printer.Print "地址：" & StrTemp5(4)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    
    Printer.Print "E-mail：" & StrTemp5(7)
    
    Printer.CurrentX = 16000
    Printer.CurrentY = iPrint
    Printer.Print "Page：" & str(Page)
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(6)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    
    Printer.Print "傳真：" & StrTemp5(9)
    
    iPrint = iPrint + 300
    Printer.CurrentX = 0 + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(8)
    Printer.CurrentX = 10000
    Printer.CurrentY = iPrint
    
    Printer.Print "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True)
    
    iPrint = iPrint + 300
    If Len(StrTemp5(10)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(10)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(11)) <> 0 Then
       Printer.CurrentX = 0 + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(11)
       iPrint = iPrint + 300
    End If
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "彼所案號"
    Printer.CurrentX = PLeft(1)
    Printer.CurrentY = iPrint
    'If intPCaseKind = 2 Then
    'Modify By Cheng 2002/02/27
    '取消列印申請人欄位
    'Printer.Print "申請人"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "申請案號"
    Printer.CurrentX = PLeft(19)
    Printer.CurrentY = iPrint
    Printer.Print "申請日"
    Printer.CurrentX = PLeft(3)
    Printer.CurrentY = iPrint
    Printer.Print "申請國家"
    Printer.CurrentX = PLeft(4)
    Printer.CurrentY = iPrint
    Printer.Print "案件性質"
    'Add By Cheng 2003/02/10
    Printer.CurrentX = PLeft(20)
    Printer.CurrentY = iPrint
    Printer.Print "發文日"
    'Add By Cheng 2003/02/10
    Printer.CurrentX = PLeft(14)
    Printer.CurrentY = iPrint
    Printer.Print "准駁"
    Printer.CurrentX = PLeft(5)
    Printer.CurrentY = iPrint
    Printer.Print "最早優先權日"
    Printer.CurrentX = PLeft(6)
    Printer.CurrentY = iPrint
    Printer.Print "取消收文日期"
    Printer.CurrentX = PLeft(18)
    Printer.CurrentY = iPrint
    Printer.Print "是否閉卷"
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(7)
    Printer.CurrentY = iPrint
    Printer.Print "客戶案件案號"
    Printer.CurrentX = PLeft(8)
    Printer.CurrentY = iPrint
    Printer.Print "本所案號"
    Printer.CurrentX = PLeft(9)
    Printer.CurrentY = iPrint
    Printer.Print "審定號數　　　　 　　/(專用期間)　　 　　　　/公告日　　　    "
    Printer.CurrentX = PLeft(10)
    Printer.CurrentY = iPrint
    Printer.Print "商品類別"
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print "商標名稱"
    Printer.CurrentX = PLeft(12)
    Printer.CurrentY = iPrint
    Printer.Print "備註"
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "最近期限"
    iPrint = iPrint + 300
    Printer.Line (0, iPrint)-(19200, iPrint)
    iPrint = iPrint + 100
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If blnWordNewPage = True And Page <> 1 Then
        fn_DocNewPage
    End If
    blnWordNewPage = False
    Dim isPrintDate As Boolean
    Dim o_tmp1 As String
    Dim o_tmp2 As String
    Dim o_tmp3 As String
    Dim o_tmp4 As String
    Dim o_tmp5 As String
    Dim o_tmp6 As String
    iPrint = 0
    o_tmp1 = StrTemp5(12)
    o_tmp2 = StrTemp5(13)
    o_tmp3 = StrTemp5(0)
    o_tmp4 = StrTemp5(1)
    o_tmp5 = StrTemp5(2)
    o_tmp6 = StrTemp5(3)
    If Len(CheckStr(o_tmp6)) <> 0 Then
        If Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            o_tmp6 = fn_StrToWordFmt("收件人：" & o_tmp6, 50) & "電話：" & StrTemp5(5)
        Else
            o_tmp6 = fn_StrToWordFmt("　　　：" & o_tmp6, 50) & "電話：" & StrTemp5(5)
        End If
    End If
    If Len(CheckStr(o_tmp5)) <> 0 Then
        If Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp4)) <> 0 Then
        If Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp3)) <> 0 Then
        If Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp2)) <> 0 Then
        If Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 50)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 50) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 50)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp1)) <> 0 Then
        If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) = 0 Then
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 50) & "電話：" & StrTemp5(5)
        Else
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 50)
        End If
    End If
    isPrintDate = False
    'g_WordAp.
    'Modify by Amy 2020/04/01 改抓變數
    'fn_PutWords strGetTitleNick & "客戶案件總簿" & IIf(strGetTitleNick = "", "（商標）", ""), wdAlignParagraphCenter, "細明體", 22, False, True, True
    fn_PutWords strCmpTitle, wdAlignParagraphCenter, "細明體", 22, False, True, True
    'fn_PutWords "　　（專利）", wdAlignParagraphCenter, , 16
    If Len(o_tmp1) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp1, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp1, 95), , , 10
        End If
    End If
    If Len(o_tmp2) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp2, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp2, 95), , , 10
        End If
    End If
    If Len(o_tmp3) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp3, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp3, 95), , , 10
        End If
    End If
    If Len(o_tmp4) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp4, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp4, 95), , , 10
        End If
    End If
    If Len(o_tmp5) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp5, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp5, 95), , , 10
        End If
    End If
    If Len(o_tmp6) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp6, 83) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp6, 95), , , 10
        End If
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("地址：" & StrTemp5(4), 50) & "E-mail：" & StrTemp5(7), 83) & "Page：" & str(Page), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(6), 50) & "傳真：" & StrTemp5(9), 83), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(8), 50) & "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True), 83), , , 10
    If Len(StrTemp5(10)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(10), 50), , , 10
    End If
    If Len(StrTemp5(11)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(11), 50), , , 10
    End If
    fn_PutWords fn_StrLineToWord("=", False), , , 10
    'Modify by Morgan 2008/8/14
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("彼所案號", 16) & fn_StrToWordFmt("申請案號", 11) & fn_StrToWordFmt("申請日", 8) & fn_StrToWordFmt("申請國家", 7) & fn_StrToWordFmt("案件性質", 10) & fn_StrToWordFmt("發文日", 8) & fn_StrToWordFmt("准駁", 9) & fn_StrToWordFmt("優先權日", 9) & fn_StrToWordFmt("取消收文日", 9) & "是否閉卷", 95), , , 10
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("客戶案件案號", 16) & fn_StrToWordFmt("本所案號", 11) & fn_StrToWordFmt("審定號數/(專用期間)/公告日", 25) & fn_StrToWordFmt("商品類別", 8) & fn_StrToWordFmt("商標名稱", 21) & fn_StrToWordFmt("備註", 6) & "最近期限", 95), , , 10
    fn_PutWords "彼所案號　　　　　　　　　　　　申請案號　　　　　申請日　　　　　申請國家　　　案件性質　　　　　發文日　　　　　　　准駁　　　　　　　　　最早優先權日　　　取消收文日　　　　　是否閉卷", , , 10
    fn_PutWords "客戶案件案號　　　　　　　　　　本所案號　　　　　審定號數　　　　　　　/(專用期間)　　　　　　　/公告日　　商品類別　　　　　　商標名稱　　　　　　　　　　　　　　備註　　　　　最近期限", , , 10
    fn_PutWords fn_StrLineToWord("=", False), , , 10
End If
End Sub

'Modify by Amy +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintDatilCp(Optional ByVal IsLawOnly As Boolean = False)
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    For i = 0 To 6
       'Modify By Cheng 2002/02/27
       If i <> 1 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print strTemp(i)
       End If
        'Add By Cheng 2003/02/10
        '列印准駁狀況
        If i = 4 Then
            Printer.CurrentX = PLeft(14)
            Printer.CurrentY = iPrint
            Printer.Print strTemp(14)
        End If
    Next i
    '列印申請日
    Printer.CurrentX = PLeft(19)
    Printer.CurrentY = iPrint
    Printer.Print strTemp(23)
    'Add By Cheng 2003/05/28
    '列印優先權日
    Printer.CurrentX = PLeft(20)
    Printer.CurrentY = iPrint
    Printer.Print strTemp(24)
    '列印是否閉卷
    Printer.CurrentX = PLeft(18)
    Printer.CurrentY = iPrint
    Printer.Print strTemp(22)
    'Modify by Morgan 2008/8/14 不再印空行
    If strTemp(8) <> "" Then
      iPrint = iPrint + 300
      For i = 7 To 13
         Printer.CurrentX = PLeft(i)
         Printer.CurrentY = iPrint
         Printer.Print strTemp(i)
      Next i
    End If
    iPrint = iPrint + 300
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(0), 16) & fn_StrToWordFmt(strTemp(2), 11) & fn_StrToWordFmt(strTemp(23), 8) & fn_StrToWordFmt(strTemp(3), 7) & fn_StrToWordFmt(strTemp(4), 10) & fn_StrToWordFmt(strTemp(5), 8) & fn_StrToWordFmt(strTemp(14), 9) & fn_StrToWordFmt(strTemp(24), 9) & fn_StrToWordFmt(strTemp(6), 9) & strTemp(22), 95), , , 10
    If iPrint >= o_PaperHeight Then
        Page = Page + 1
        'add  by nickc 2005/11/15  紙本
        If Check3(0).Value = vbChecked Then
            Printer.NewPage
        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
            fn_DocNewPage
        End If
        Call PrintTitleCp(IsLawOnly)  'Modify by Amy 2020/03/20 +IsLawOnly
    End If
    
   'Modify by Morgan 2008/8/15 不再印空行
   'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(7), 16) & fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(strTemp(9), 25) & fn_StrToWordFmt(strTemp(10), 8) & fn_StrToWordFmt(strTemp(11), 21) & fn_StrToWordFmt(strTemp(12), 6) & strTemp(13), 95), , , 10
   If strTemp(8) <> "" Then
      fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(7), 16) & fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(strTemp(9), 25) & fn_StrToWordFmt(strTemp(10), 8) & fn_StrToWordFmt(strTemp(11), 21) & fn_StrToWordFmt(strTemp(12), 6) & strTemp(13), 95), , , 10
   End If
End If
End Sub

Private Sub PrintDatilCt()
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    For i = 0 To 6
       'Modify By Cheng 2002/02/27
       If i <> 1 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print strTemp(i)
       End If
        'Add By Cheng 2003/02/10
        '列印准駁狀況
        If i = 4 Then
            Printer.CurrentX = PLeft(14)
            Printer.CurrentY = iPrint
            Printer.Print strTemp(14)
        End If
    Next i
    '列印申請日
    Printer.CurrentX = PLeft(19)
    Printer.CurrentY = iPrint
    Printer.Print strTemp(23)
    'Add By Cheng 2003/05/28
    '列印發文日
    Printer.CurrentX = PLeft(20)
    Printer.CurrentY = iPrint
    Printer.Print strTemp(24)
    '列印是否閉卷
    Printer.CurrentX = PLeft(18)
    Printer.CurrentY = iPrint
    Printer.Print strTemp(22)
    'Modify by Morgan 2008/8/14 不再印空行
    If strTemp(8) <> "" Then
      iPrint = iPrint + 300
      For i = 7 To 13
         Printer.CurrentX = PLeft(i)
         Printer.CurrentY = iPrint
         Printer.Print strTemp(i)
      Next i
   End If
    iPrint = iPrint + 300
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    'Modify by Morgan 2008/8/14
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(0), 16) & fn_StrToWordFmt(strTemp(2), 11) & fn_StrToWordFmt(strTemp(23), 8) & fn_StrToWordFmt(strTemp(3), 7) & fn_StrToWordFmt(strTemp(4), 10) & fn_StrToWordFmt(strTemp(5), 8) & fn_StrToWordFmt(strTemp(14), 9) & fn_StrToWordFmt(strTemp(24), 9) & fn_StrToWordFmt(strTemp(6), 9) & strTemp(22), 95), , , 10
    fn_PutWords fn_StrToWordFmt(strTemp(0), 16) & fn_StrToWordFmt(strTemp(2), 9) & fn_StrToWordFmt(strTemp(23), 8) & fn_StrToWordFmt(strTemp(3), 7) & fn_StrToWordFmt(strTemp(4), 9) & fn_StrToWordFmt(strTemp(24), 10) & fn_StrToWordFmt(strTemp(14), 11) & fn_StrToWordFmt(strTemp(5), 9) & fn_StrToWordFmt(strTemp(6), 10) & strTemp(22), , , 10
    If iPrint >= o_PaperHeight Then
        Page = Page + 1
        'add  by nickc 2005/11/15  紙本
        If Check3(0).Value = vbChecked Then
            'Printer.Line (0, iPrint)-(16000, iPrint)
            Printer.NewPage
        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
            'fn_PutWords fn_StrLineToWord, , , 10
            fn_DocNewPage
        End If
        PrintTitleCt
    End If
   'Modify by Morgan 2008/8/14 不再印空行
   'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(7), 16) & fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(strTemp(9), 25) & fn_StrToWordFmt(strTemp(10), 8) & fn_StrToWordFmt(strTemp(11), 21) & fn_StrToWordFmt(strTemp(12), 6) & strTemp(13), 95), , , 10
   If strTemp(8) <> "" Then
      'Modify by Amy 2015/03/18 fn_StrToWordFmt(strTemp(10)...,+True) 商品類別
      fn_PutWords fn_StrToWordFmt(strTemp(7), 16) & fn_StrToWordFmt(strTemp(8), 9) & fn_StrToWordFmt(strTemp(9), 29) & fn_StrToWordFmt(strTemp(10), 10, True) & fn_StrToWordFmt(strTemp(11), 18) & fn_StrToWordFmt(strTemp(12), 7) & strTemp(13), , , 10
   End If

End If
End Sub


Private Sub GetPleftJp()
Erase PLeft
PLeft(0) = 0
'Modify By Cheng 2002/02/27
'PLeft(1) = 3100
'PLeft(2) = 5200
'PLeft(3) = 7300
'PLeft(4) = 8600
'PLeft(5) = 16300
'PLeft(6) = 17900
PLeft(2) = 5200 - 2100
PLeft(3) = 7300 - 2100
PLeft(4) = 8600 - 2100
PLeft(5) = 16300 - 2100
PLeft(6) = 17900 - 2100
PLeft(18) = 17900 - 1100 '是否閉卷

PLeft(7) = 0
PLeft(8) = 3100
PLeft(9) = 4800
PLeft(10) = 9000 + 200
PLeft(11) = 11100 + 200
PLeft(12) = 16400 + 200
PLeft(13) = 17900

End Sub

Private Sub GetPleftJt()
Erase PLeft
PLeft(0) = 0
'Modify By Cheng 2002/02/27
'PLeft(1) = 3100
'PLeft(2) = 5200
'PLeft(3) = 7300
'PLeft(4) = 8600
'PLeft(5) = 16300 - 2000
'PLeft(6) = 17900
PLeft(2) = 5200 - 2100
PLeft(3) = 7300 - 2100
PLeft(4) = 8600 - 2100
PLeft(5) = 16300 - 2000 - 2100
PLeft(6) = 17900 - 2100
PLeft(18) = 17900 - 1100 '是否閉卷

PLeft(7) = 0
PLeft(8) = 3100
PLeft(9) = 4800
PLeft(10) = 9000 + 200 + 1500
PLeft(11) = 11100 + 200 + 1500
PLeft(12) = 16400 + 200
PLeft(13) = 17900

End Sub

Private Sub Form_Load()
    MoveFormToCenter Me
    txt1(2) = GetSystemKindByNick
    strSql = Printer.DeviceName
    SeekPrintL = Printer.Orientation
    For i = 0 To Printers.Count - 1
        Set Printer = Printers(i)
         'edit by nickc 2006/11/23
         'If Printer.DeviceName <> strSQL Then
            Combo1.AddItem Printer.DeviceName, j
            j = j + 1
         'End If
        If Printer.DeviceName = strSql Then
            SeekPrint = i
        End If
    Next i
    
    'edit by nickc 2006/10/23
    Set Printer = Printers(SeekPrint)
    'Combo1.Text = Combo1.List(0)
    Combo1.Text = Combo1.List(SeekPrint)
    
    Me.lblSalesName.Caption = ""
    'add by nickc 2005/11/03
    Lbl_inf.Visible = False 'Add by Amy 2021/02/23
    'Modify by Amy 2017/07/25 非M51部門之前仍用舊程式，改新程式後指定商品非M51部門不可輸
    If UCase(GetStaffDepartment(strUserNum)) = "M51" Then
      'Modify by Amy 2022/01/17 只能產生紙本
      Check3(1).Enabled = False
      Label15.Enabled = False
      txt1(16).Enabled = False
      'end 2022/01/17
      'Add by Amy 2021/02/23
      Lbl_inf.Visible = True
      Lbl_inf = "•10904月改中、日文版L公司名稱" & vbCrLf & _
                    "•11002月改中文版法律所案源檔"
    Else
      Check3(1).Enabled = False
      Label15.Enabled = False
      txt1(16).Enabled = False
    End If
    txtMail.Enabled = False
End Sub

Private Sub Form_Unload(Cancel As Integer)
Set Printer = Printers(SeekPrint)
Printer.Orientation = SeekPrintL

Set frm0503171Old = Nothing
End Sub

'Add by Amy 2021/02/03 英、日文版word 版面不是A4,而Word 為A4,需調版面改太多,故英、日文版不可產生電子檔-秀玲(從lostfocus搬過來)
Private Sub txt1_Change(Index As Integer)
    If Index <> 10 Then Exit Sub
    If txt1(Index) = MsgText(601) Then Exit Sub
    
    If Me.txt1(10) <> "1" And Me.txt1(10) <> "2" And Me.txt1(10) <> "3" Then
        MsgBox "報表語文輸入錯誤,只能 1 到 3 !!", , "USER 輸入錯誤"
        txt1(10).SetFocus
        txt1(10).SelStart = 0
        txt1(10).SelLength = Len(txt1(10))
        Exit Sub
    End If
    If Me.txt1(10) = "1" Then
        Check3(1).Enabled = True: Check10(0).Enabled = True: Check10(1).Enabled = True
        Check4(0).Enabled = True '中文才可以印群組
    Else
        '不是中文不可印群組
        Check4(0).Value = 0: Check4(0).Enabled = False
        Check4(1).Value = 1
        '不是中文不可產生電子檔
        Check3(0).Value = vbChecked: Check3(1).Value = 0
        Check10(0).Value = 0: Check10(1).Value = 0
        Check3(1).Enabled = False: Check10(0).Enabled = False: Check10(1).Enabled = False
    End If
End Sub

Private Sub txt1_GotFocus(Index As Integer)
    CloseIme
    txt1(Index).SelStart = 0
    txt1(Index).SelLength = Len(txt1(Index))
End Sub

Private Sub txt1_LostFocus(Index As Integer)
Select Case Index
Case 0 '客戶編號起
    If Me.txt1(0).Text <> "" Then
        Me.txt1(0).Text = Left(Me.txt1(0).Text & String(9, "0"), 9)
        Me.txt1(1).Text = Left(Me.txt1(0).Text, 8) & "Z"
    End If
Case 1 '客戶編號迄
    If Me.txt1(1).Text <> "" Then
        Me.txt1(1).Text = Left(Me.txt1(1).Text & String(9, "0"), 9)
    End If
Case 2 '系統類別
     strTemp1 = Split(Replace(UCase(GetSystemKindByNick), ",,", ""), ",")
     strTemp2 = Split(Replace(UCase(txt1(2)), ",,", ""), ",")
     For i = 0 To UBound(strTemp2)
        s = 0
        For j = 0 To UBound(strTemp1)
            If strTemp1(j) = strTemp2(i) Then
                s = 1
                Exit For
            End If
        Next j
        If s = 0 Then
            s = MsgBox(strUserName & " 沒有 " & strTemp2(i) & " 的權限 ", , "權限問題")
            txt1(2).SetFocus
            txt1(2).SelStart = 0
            txt1(2).SelLength = Len(txt1(2))
            Exit Sub
        End If
     Next i
Case 7 '是否含核駁
     Select Case Trim(txt1(7))
     Case "N", "n", " ", ""
     Case Else
          s = MsgBox("是否含核駁輸入錯誤,只能 N 或空白!!", , "USER 輸入錯誤")
          txt1(7).SetFocus
          txt1(7).SelStart = 0
          txt1(7).SelLength = Len(txt1(7))
          Exit Sub
     End Select
Case 8 '國內外是否分開列印
     Select Case Trim(txt1(8))
     Case "Y", "y", " ", ""
     Case Else
          s = MsgBox("國內外是否分開列印只能 Y 或空白!!", , "USER 輸入錯誤")
          txt1(8).SetFocus
          txt1(8).SelStart = 0
          txt1(8).SelLength = Len(txt1(8))
          Exit Sub
     End Select
Case 9
     Select Case Trim(txt1(9))
'     Case "1", "2", ""
     Case "1", "2", "3", "4", ""
     Case Else
'          s = MsgBox("列印順序輸入錯誤,只能 1 或 2 !!", , "USER 輸入錯誤")
          s = MsgBox("列印順序輸入錯誤,只能 1, 2, 3 或 4 !!", , "USER 輸入錯誤")
          txt1(9).SetFocus
          txt1(9).SelStart = 0
          txt1(9).SelLength = Len(txt1(9))
          Exit Sub
     End Select
'Mark by Amy 2021/02/03 英、日文版word 版面不是A4,因Word 為A4,需調版面改太多,故英、日文版不可產生電子檔,將下列判斷改至Validate
'Case 10 '報表語文
'    Check10(1).Enabled = False '2013/10/3
'     Select Case Trim(Txt1(10))
     'Add by Amy 2013/10/03 中文才可以勾選產生excel
     'edit by nickc 2005/11/08 中文才可以印群組，英日文暫不做
     'Case "1", "2", "3", ""
'     Case "1"
'            Check4(0).Enabled = True
'            If Check4(1).Value = 1 Then Check10(1).Enabled = True '2013/10/3
'     Case "2", "3", ""
'            Check4(0).Enabled = False
'            Check4(0).Value = 0
'            Check10(1).Value = 0
'     Case Else
'          s = MsgBox("報表語文輸入錯誤,只能 1 到 3 !!", , "USER 輸入錯誤")
'          Txt1(10).SetFocus
'          Txt1(10).SelStart = 0
'          Txt1(10).SelLength = Len(Txt1(10))
'          Exit Sub
'     End Select
Case 1, 6
      If RunNick(txt1(Index - 1), txt1(Index)) Then
         txt1(Index - 1).SetFocus
         txt1_GotFocus (Index - 1)
         Exit Sub
      End If
Case 3, 4 '收文日期
    If PUB_CheckKeyInDate(Me.txt1(Index)) = -1 Then
        Me.txt1(Index).SetFocus
        txt1_GotFocus Index
        Exit Sub
    End If
    If Index = 4 Then
        If RunNick(txt1(Index - 1), txt1(Index)) Then
            txt1(Index - 1).SetFocus
            txt1_GotFocus (Index - 1)
        Exit Sub
        End If
    End If
Case 13, 14 '申請日期
    If PUB_CheckKeyInDate(Me.txt1(Index)) = -1 Then
        Me.txt1(Index).SetFocus
        txt1_GotFocus Index
        Exit Sub
    End If
    If Index = 14 Then
        If RunNick(txt1(Index - 1), txt1(Index)) Then
            txt1(Index - 1).SetFocus
            txt1_GotFocus (Index - 1)
        Exit Sub
        End If
    End If
Case Else
End Select
End Sub

Private Sub txt1_KeyPress(Index As Integer, KeyAscii As Integer)
    KeyAscii = UpperCase(KeyAscii)
    Select Case Index
    Case 9 '列印順序
'        If KeyAscii <> 8 And KeyAscii <> 49 And KeyAscii <> 50 Then
        If KeyAscii <> 8 And KeyAscii <> 49 And KeyAscii <> 50 And KeyAscii <> 51 And KeyAscii <> 52 Then
            KeyAscii = 0
        End If
    Case 10 '報表語文
        If KeyAscii <> 8 And KeyAscii <> 49 And KeyAscii <> 50 And KeyAscii <> 51 Then
            KeyAscii = 0
        ElseIf KeyAscii = 50 Or KeyAscii = 51 Then 'Add by Amy 2013/10/03 報表語文 不是中文 不可選產生excel
            
        End If
    Case 15 '列印程序
        If KeyAscii <> 8 And KeyAscii <> 49 And KeyAscii <> 50 And KeyAscii <> 51 Then
            KeyAscii = 0
        End If
    Case 16 'Add by Amy 2017/03/13 是否輸出指定商品
        If KeyAscii <> Asc("Y") Then
            KeyAscii = 0
        End If
    End Select
End Sub

Private Sub RefreshColData(Index As Integer, strKind As String)
Select Case Index
Case 1 '中文報表
   If strKind = "申請人" Then
        'Modify By Cheng 2003/02/10
        '加申請人代號
'      m_ColCustName = "Nvl(CU04,Nvl(CU05,CU06)),Decode(CU04,Null,Decode(CU05,Null,CU88,''),''),Decode(CU04,Null,Decode(CU05,Null,CU89,''),''),Decode(CU04,Null,Decode(CU05,Null,CU90,''),'')"
'Modify by Morgan 2004/1/9
'中文大報表客戶名稱改顯示中文+空白+(日文,英文)
'      m_ColCustName = "CU01||CU02||'   '||Nvl(CU04,Nvl(CU05,CU06)),Decode(CU04,Null,Decode(CU05,Null,CU88,''),''),Decode(CU04,Null,Decode(CU05,Null,CU89,''),''),Decode(CU04,Null,Decode(CU05,Null,CU90,''),'')"
      Select Case txt1(15)
         Case 3
            m_ColCustName = "CU01||CU02||'   '||CU04||'　'||NVL(CU06,CU05||CU88||CU89||CU90),Decode(CU04,Null,Decode(CU05,Null,CU88,''),''),Decode(CU04,Null,Decode(CU05,Null,CU89,''),''),Decode(CU04,Null,Decode(CU05,Null,CU90,''),'')"
         Case Else
            m_ColCustName = "CU01||CU02||'   '||Nvl(CU04,Nvl(CU05,CU06)),Decode(CU04,Null,Decode(CU05,Null,CU88,''),''),Decode(CU04,Null,Decode(CU05,Null,CU89,''),''),Decode(CU04,Null,Decode(CU05,Null,CU90,''),'')"
      End Select
      
        'Modify By Cheng 2003/07/11
        '聯絡地址-->POX-->申請地址
'      m_ColCustAdd = "Nvl(CU23,Nvl(CU65,Nvl(CU24,CU29)))," & _
'         "Decode(CU23,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU25),CU66),'')," & _
'         "Decode(CU23,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU26),CU67),'')," & _
'         "Decode(CU23,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU27),CU68),'')," & _
'         "Decode(CU23,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU28),CU69),'')"
      m_ColCustAdd = "Nvl(CU31,Nvl(CU23,Nvl(CU65,Nvl(CU24,CU29))))," & _
         "Decode(CU31,Null,Decode(CU23,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU25),CU66),''),'')," & _
         "Decode(CU31,Null,Decode(CU23,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU26),CU67),''),'')," & _
         "Decode(CU31,Null,Decode(CU23,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU27),CU68),''),'')," & _
         "Decode(CU31,Null,Decode(CU23,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU28),CU69),''),'')"
   Else '代理人
        'Modify By Cheng 2003/02/10
        '加代理人代號
'      m_ColAgName = "Nvl(FA04,Nvl(FA05,FA06)),Decode(FA04,Null,Decode(FA05,Null,'',FA63),''),Decode(FA04,Null,Decode(FA05,Null,'',FA64),''),Decode(FA04,Null,Decode(FA05,Null,'',FA65),'')"
      m_ColAgName = "FA01||FA02||'   '||Nvl(FA04,Nvl(FA05,FA06)),Decode(FA04,Null,Decode(FA05,Null,'',FA63),''),Decode(FA04,Null,Decode(FA05,Null,'',FA64),''),Decode(FA04,Null,Decode(FA05,Null,'',FA65),'')"
      m_ColAgAdd = "Nvl(FA17,Nvl(FA32,Nvl(FA18,FA23))),Decode(FA17,Null,Decode(FA32,Null,Decode(FA18,Null,'',FA19),FA33),''),Decode(FA17,Null,Decode(FA32,Null,Decode(FA18,Null,'',FA20),FA34),''),Decode(FA17,Null,Decode(FA32,Null,Decode(FA18,Null,'',FA21),FA35),''),Decode(FA17,Null,Decode(FA32,Null,Decode(FA18,Null,'',FA22),FA36),'')"
   End If
Case 2 '英文報表
   If strKind = "申請人" Then
        'Modify By Cheng 2003/02/10
        '加申請人代號
'      m_ColCustName = "Nvl(CU05,CU06),Decode(CU05,Null,'',CU88),Decode(CU05,Null,'',CU89),Decode(CU05,Null,'',CU90)"
'Modify by Morgan 2004/1/9
'英文大報表客戶名稱改顯示英文+空白+(日文,中文)
'      m_ColCustName = "CU01||CU02||'   '||Nvl(CU05,CU06),Decode(CU05,Null,'',CU88),Decode(CU05,Null,'',CU89),Decode(CU05,Null,'',CU90)"
      Select Case txt1(15)
         Case 3
            m_ColCustName = "CU01||CU02||'   '||CU05||CU88||CU89||CU90||'　'||NVL(CU06,CU04),Decode(CU05,Null,'',CU88),Decode(CU05,Null,'',CU89),Decode(CU05,Null,'',CU90)"
         Case Else
            m_ColCustName = "CU01||CU02||'   '||Nvl(CU05,CU06),Decode(CU05,Null,'',CU88),Decode(CU05,Null,'',CU89),Decode(CU05,Null,'',CU90)"
      End Select
      
      m_ColCustAdd = "Nvl(CU65,Nvl(CU24,CU29)),Decode(CU65,Null,Decode(CU24,Null,'',CU25),CU66)," & _
         "Decode(CU65,Null,Decode(CU24,Null,'',CU26),CU67)," & _
         "Decode(CU65,Null,Decode(CU24,Null,'',CU27),CU68)," & _
         "Decode(CU65,Null,Decode(CU24,Null,'',CU28),CU69),Decode(CU65,Null,Decode(CU24,Null,'',CU102),'')"
   Else '代理人
        'Modify By Cheng 2003/02/10
        '加代理人代號
'      m_ColAgName = "Nvl(FA05,FA06),Decode(FA05,Null,'',FA63),Decode(FA05,Null,'',FA64),Decode(FA05,Null,'',FA65)"
      m_ColAgName = "FA01||FA02||'   '||Nvl(FA05,FA06),Decode(FA05,Null,'',FA63),Decode(FA05,Null,'',FA64),Decode(FA05,Null,'',FA65)"
      m_ColAgAdd = "Nvl(FA32,Nvl(FA18,FA23)),Decode(FA32,Null,Decode(FA18,Null,'',FA19),FA33),Decode(FA32,Null,Decode(FA18,Null,'',FA20),FA34),Decode(FA32,Null,Decode(FA18,Null,'',FA21),FA35),Decode(FA32,Null,Decode(FA18,Null,'',FA22),FA36)"
   End If
Case 3 '日文報表
   If strKind = "申請人" Then
        'Modify By Cheng 2003/02/10
        '加申請人代號
'      m_ColCustName = "Nvl(CU06,CU05),Decode(CU06,Null,CU88,''),Decode(CU06,Null,CU89,''),Decode(CU06,Null,CU90,'')"
'Modify by Morgan 2004/1/9
'日文大報表客戶名稱改顯示日文+空白+中文
'      m_ColCustName = "CU01||CU02||'   '||Nvl(CU06,CU05),Decode(CU06,Null,CU88,''),Decode(CU06,Null,CU89,''),Decode(CU06,Null,CU90,'')"
      Select Case txt1(15)
         Case 3
            m_ColCustName = "CU01||CU02||'   '||CU06||'　'||CU04,Decode(CU06,Null,CU88,''),Decode(CU06,Null,CU89,''),Decode(CU06,Null,CU90,'')"
         Case Else
            m_ColCustName = "CU01||CU02||'   '||Nvl(CU06,CU05),Decode(CU06,Null,CU88,''),Decode(CU06,Null,CU89,''),Decode(CU06,Null,CU90,'')"
      End Select
      
      m_ColCustAdd = "Nvl(CU29,Nvl(CU65,CU24))," & _
         "Decode(CU29,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU25),CU66),'')," & _
         "Decode(CU29,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU26),CU67),'')," & _
         "Decode(CU29,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU27),CU68),'')," & _
         "Decode(CU29,Null,Decode(CU65,Null,Decode(CU24,Null,'',CU28),CU69),'')"
   Else '代理人
        'Modify By Cheng 2003/02/10
        '加代理人代號
'      m_ColAgName = "Nvl(FA06,FA05),Decode(FA06,Null,FA63,''),Decode(FA06,Null,FA64,''),Decode(FA06,Null,FA65,'')"
      m_ColAgName = "FA01||FA02||'   '||Nvl(FA06,FA05),Decode(FA06,Null,FA63,''),Decode(FA06,Null,FA64,''),Decode(FA06,Null,FA65,'')"
      m_ColAgAdd = "Nvl(FA23,Nvl(FA32,FA18)),Decode(FA23,Null,Decode(FA32,Null,FA19,FA33),''),Decode(FA23,Null,Decode(FA32,Null,FA20,FA34),''),Decode(FA23,Null,Decode(FA32,Null,FA21,FA35),''),Decode(FA23,Null,Decode(FA32,Null,FA22,FA36),'')"
   End If
End Select
End Sub

Private Sub txt1_Validate(Index As Integer, Cancel As Boolean)
    'add by nickc 2005/11/21
    Dim ChkRs As New ADODB.Recordset
    
    Select Case Index
    'add by nickc 2005/11/21
    Case 0, 1
        'Add by Amy 2017/03/13 避免未輸資料也會查,需要等故判斷有值才run
        If Len(Trim(txt1(1))) = 0 Or Len(Trim(txt1(0))) = 0 Then Exit Sub
        'end 2017/03/13
        Set ChkRs = New ADODB.Recordset
        If ChkRs.State = 1 Then ChkRs.Close
        ChkRs.CursorLocation = adUseClient
        'Modify by Amy 2017/03/13 +開發日小於20060101-秀玲
        'ChkRs.Open "select * from customer where cu01>='" & Mid(txt1(Index), 1, 6) & "00' and cu01<='" & Mid(txt1(Index), 1, 6) & "ZZ' and cu110>0 And cu14<20060101", cnnConnection, adOpenStatic, adLockReadOnly
        ChkRs.Open "select * from customer where cu01>='" & Mid(txt1(Index), 1, 6) & "00' and cu01<='" & Mid(txt1(Index), 1, 6) & "ZZ' and cu110 is null And cu14<20060101", cnnConnection, adOpenStatic, adLockReadOnly
        If ChkRs.RecordCount = 0 Then
            lblCu110.Caption = ""
        Else
            lblCu110.Caption = "請檢查准駁資料！"
        End If
        ChkRs.Close
        Set ChkRs = Nothing
'    'Add by Amy 2021/02/03 原設計英、日文版word 版面不是A4,因Word 為A4,需調版面改太多,故英、日文版不可產生電子檔-秀玲
'    Case 10 '報表語文
'        If Me.txt1(10) <> "1" And Me.txt1(10) <> "2" And Me.txt1(10) <> "3" Then
'            MsgBox "報表語文輸入錯誤,只能 1 到 3 !!", , "USER 輸入錯誤"
'            txt1(10).SetFocus
'            txt1(10).SelStart = 0
'            txt1(10).SelLength = Len(txt1(10))
'            Exit Sub
'        End If
'        If Me.txt1(10) = "1" Then
'            Check3(1).Enabled = True: Check10(0).Enabled = True: Check10(1).Enabled = True
'            Check4(0).Enabled = True '中文才可以印群組
'        Else
'            '不是中文不可印群組
'            Check4(0).Value = 0: Check4(0).Enabled = False
'            Check4(1).Value = 1
'            '不是中文不可產生電子檔
'            Check3(0).Value = vbChecked: Check3(1).Value = 0
'            Check10(0).Value = 0: Check10(1).Value = 0
'            Check3(1).Enabled = False: Check10(0).Enabled = False: Check10(1).Enabled = False
'        End If
    Case 11 '智權人員
        Me.lblSalesName.Caption = GetStaffName(Me.txt1(11).Text, True)
        If Me.txt1(11).Text <> "" And Me.lblSalesName.Caption = "" Then
            MsgBox "智權人員編號輸入錯誤!!!", vbExclamation + vbOKOnly
            Me.txt1(11).SetFocus
            txt1_GotFocus 11
            Cancel = True
        End If
    Case Else
    End Select
End Sub

'Add By Cheng 2003/07/07
'除專利及商標基本檔其他的相關資料
Private Sub ProcessO()
Dim ii As Integer
Dim blnMatchKind As Boolean

Screen.MousePointer = vbHourglass
'add by nickc 2005/11/09 紙本
If Check3(0).Value = vbChecked Then
    '若下所有程序或英日報表
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        Printer.Orientation = 1
        'Modified by Morgan 2015/6/2
        'Printer.PaperSize = 39
        Printer.PaperSize = PUB_GetPaperSize(15)
        'END 2015/6/2        o_PaperHeight = 14200
    '其他
    Else
        Printer.Orientation = 2
        Printer.PaperSize = 9
        o_PaperHeight = 10000
    End If
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        o_PaperHeight = 50 'Modify by Amy 2019/11/21 原:56
    Else
        o_PaperHeight = 40
    End If
End If
m_strPrintKind = "3"
blnMatchKind = False
cnnConnection.Execute "delete from R050317_C WHERE ID='" & strUserNum & "' "     '語文為中文      對內
cnnConnection.Execute "DELETE FROM R050317_E WHERE ID='" & strUserNum & "' "     '語文為英文    對外
cnnConnection.Execute "DELETE FROM R050317_J WHERE ID='" & strUserNum & "' "     '語文為日文   對外
strSQL1 = "": strSQL2 = "": StrSQL3 = "": StrSQL4 = "": strSQL5 = ""
'初始化變數
m_strSQL1_2 = "": m_strSQL1_3 = "": m_strSQL1_4 = "": m_strSQL1_5 = ""
m_strSQL5_2 = "": m_strSQL5_3 = ""
'add by nickc 2007/01/10
m_strSQL5_4 = "": m_strSQL5_5 = ""
'Add By Sindy 2011/2/23
m_strSQL3_2 = "": m_strSQL3_3 = "": m_strSQL3_4 = "": m_strSQL3_5 = ""
m_strSQL4_2 = "": m_strSQL4_3 = "": m_strSQL4_4 = "": m_strSQL4_5 = ""

StrSQL3 = StrSQL3 + " AND (LC11>='" & GetNewFagent(txt1(0)) & "' AND LC11<='" & GetNewFagent(txt1(1)) & "') "
'Add By Sindy 2011/2/23
m_strSQL3_2 = m_strSQL3_2 + " AND (LC43>='" & GetNewFagent(txt1(0)) & "' AND LC43<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL3_3 = m_strSQL3_3 + " AND (LC44>='" & GetNewFagent(txt1(0)) & "' AND LC44<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL3_4 = m_strSQL3_4 + " AND (LC45>='" & GetNewFagent(txt1(0)) & "' AND LC45<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL3_5 = m_strSQL3_5 + " AND (LC46>='" & GetNewFagent(txt1(0)) & "' AND LC46<='" & GetNewFagent(txt1(1)) & "') "
'2011/2/23 End
StrSQL4 = StrSQL4 + " AND (HC05>='" & GetNewFagent(txt1(0)) & "' AND HC05<='" & GetNewFagent(txt1(1)) & "') "
'Add By Sindy 2011/2/23
m_strSQL4_2 = m_strSQL4_2 + " AND (HC24>='" & GetNewFagent(txt1(0)) & "' AND HC24<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL4_3 = m_strSQL4_3 + " AND (HC25>='" & GetNewFagent(txt1(0)) & "' AND HC25<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL4_4 = m_strSQL4_4 + " AND (HC26>='" & GetNewFagent(txt1(0)) & "' AND HC26<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL4_5 = m_strSQL4_5 + " AND (HC27>='" & GetNewFagent(txt1(0)) & "' AND HC27<='" & GetNewFagent(txt1(1)) & "') "
'2011/2/23 End
strSQL5 = strSQL5 + " AND (SP08>='" & GetNewFagent(txt1(0)) & "' AND SP08<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL5_2 = m_strSQL5_2 + " AND (SP58>='" & GetNewFagent(txt1(0)) & "' AND SP58<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL5_3 = m_strSQL5_3 + " AND (SP59>='" & GetNewFagent(txt1(0)) & "' AND SP59<='" & GetNewFagent(txt1(1)) & "') "
'add by nickc 2007/01/10
m_strSQL5_4 = m_strSQL5_4 + " AND (SP65>='" & GetNewFagent(txt1(0)) & "' AND SP65<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL5_5 = m_strSQL5_5 + " AND (SP66>='" & GetNewFagent(txt1(0)) & "' AND SP66<='" & GetNewFagent(txt1(1)) & "') "
'若有勾選系統類別
If Me.Check1(0).Value = vbChecked Or Me.Check1(3).Value = vbChecked Or Me.Check1(4).Value = vbChecked Or Me.Check1(5).Value = vbChecked Or Me.Check1(6).Value = vbChecked Then
    blnMatchKind = True
    StrSQL3 = StrSQL3 & " and LC01 in (' ',"
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 & " and LC01 in (' ',"
    m_strSQL3_3 = m_strSQL3_3 & " and LC01 in (' ',"
    m_strSQL3_4 = m_strSQL3_4 & " and LC01 in (' ',"
    m_strSQL3_5 = m_strSQL3_5 & " and LC01 in (' ',"
    '2011/2/23 End
    StrSQL4 = StrSQL4 & " and HC01 in (' ',"
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 & " and HC01 in (' ',"
    m_strSQL4_3 = m_strSQL4_3 & " and HC01 in (' ',"
    m_strSQL4_4 = m_strSQL4_4 & " and HC01 in (' ',"
    m_strSQL4_5 = m_strSQL4_5 & " and HC01 in (' ',"
    '2011/2/23 End
    strSQL5 = strSQL5 & " and SP01 in (' ',"
    m_strSQL5_2 = m_strSQL5_2 & " and CP01 in (' ',"
    m_strSQL5_3 = m_strSQL5_3 & " and CP01 in (' ',"
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 & " and CP01 in (' ',"
    m_strSQL5_5 = m_strSQL5_5 & " and CP01 in (' ',"
    If Me.Check1(0).Value = vbChecked Then
        StrSQL3 = StrSQL3 & SQLGrpStr(txt1(2), 3) & ","
        'Add By Sindy 2011/2/23
        m_strSQL3_2 = m_strSQL3_2 & SQLGrpStr(txt1(2), 3) & ","
        m_strSQL3_3 = m_strSQL3_3 & SQLGrpStr(txt1(2), 3) & ","
        m_strSQL3_4 = m_strSQL3_4 & SQLGrpStr(txt1(2), 3) & ","
        m_strSQL3_5 = m_strSQL3_5 & SQLGrpStr(txt1(2), 3) & ","
        '2011/2/23 End
        StrSQL4 = StrSQL4 & SQLGrpStr(txt1(2), 4) & ","
        'Add By Sindy 2011/2/23
        m_strSQL4_2 = m_strSQL4_2 & SQLGrpStr(txt1(2), 4) & ","
        m_strSQL4_3 = m_strSQL4_3 & SQLGrpStr(txt1(2), 4) & ","
        m_strSQL4_4 = m_strSQL4_4 & SQLGrpStr(txt1(2), 4) & ","
        m_strSQL4_5 = m_strSQL4_5 & SQLGrpStr(txt1(2), 4) & ","
        '2011/2/23 End
        strSQL5 = strSQL5 & SQLGrpStr(txt1(2), 5) & ","
        m_strSQL5_2 = m_strSQL5_2 & SQLGrpStr(txt1(2), 5) & ","
        m_strSQL5_3 = m_strSQL5_3 & SQLGrpStr(txt1(2), 5) & ","
        'add by nickc 2007/01/10
        m_strSQL5_4 = m_strSQL5_4 & SQLGrpStr(txt1(2), 5) & ","
        m_strSQL5_5 = m_strSQL5_5 & SQLGrpStr(txt1(2), 5) & ","
    End If
    If Me.Check1(3).Value = vbChecked Then
        strSQL5 = strSQL5 & "'TC','CFC'" & ","
        m_strSQL5_2 = m_strSQL5_2 & "'TC','CFC'" & ","
        m_strSQL5_3 = m_strSQL5_3 & "'TC','CFC'" & ","
        'add by nickc 2007/01/10
        m_strSQL5_4 = m_strSQL5_4 & "'TC','CFC'" & ","
        m_strSQL5_5 = m_strSQL5_5 & "'TC','CFC'" & ","
    End If
    If Me.Check1(4).Value = vbChecked Then
        'Modify By Sindy 2009/07/24 增加LIN系統類別
        'modify by sonia 2019/7/29 +ACS系統類別
        StrSQL3 = StrSQL3 & "'L','CFL','FCL','LA','LIN','ACS'" & ","
        'Add By Sindy 2011/2/23
        m_strSQL3_2 = m_strSQL3_2 & "'L','CFL','FCL','LA','LIN','ACS'" & ","
        m_strSQL3_3 = m_strSQL3_3 & "'L','CFL','FCL','LA','LIN','ACS'" & ","
        m_strSQL3_4 = m_strSQL3_4 & "'L','CFL','FCL','LA','LIN','ACS'" & ","
        m_strSQL3_5 = m_strSQL3_5 & "'L','CFL','FCL','LA','LIN','ACS'" & ","
        '2011/2/23 End
        'Modify by Amy 2014/07/21 申請國家為空或輸000 增加LA系統類別
        If txt1(5) = "" Or txt1(5) = "000" Or txt1(6) = "000" Then
            StrSQL4 = StrSQL4 & "'LA'" & ","
            m_strSQL4_2 = m_strSQL4_2 & "'LA'" & ","
            m_strSQL4_3 = m_strSQL4_3 & "'LA'" & ","
            m_strSQL4_4 = m_strSQL4_4 & "'LA'" & ","
            m_strSQL4_5 = m_strSQL4_5 & "'LA'" & ","
        End If
        'end 2014/07/21
    End If
    If Me.Check1(5).Value = vbChecked Then
        strSQL5 = strSQL5 & "'TB'" & ","
        m_strSQL5_2 = m_strSQL5_2 & "'TB'" & ","
        m_strSQL5_3 = m_strSQL5_3 & "'TB'" & ","
        'add by nickc 2007/01/10
        m_strSQL5_4 = m_strSQL5_4 & "'TB'" & ","
        m_strSQL5_5 = m_strSQL5_5 & "'TB'" & ","
    End If
    If Me.Check1(6).Value = vbChecked Then
        strSQL5 = strSQL5 & "'TD'" & ","
        m_strSQL5_2 = m_strSQL5_2 & "'TD'" & ","
        m_strSQL5_3 = m_strSQL5_3 & "'TD'" & ","
        'add by nickc 2007/01/10
        m_strSQL5_4 = m_strSQL5_4 & "'TD'" & ","
        m_strSQL5_5 = m_strSQL5_5 & "'TD'" & ","
    End If
    StrSQL3 = Left(StrSQL3, Len(StrSQL3) - 1)
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = Left(m_strSQL3_2, Len(m_strSQL3_2) - 1)
    m_strSQL3_3 = Left(m_strSQL3_3, Len(m_strSQL3_3) - 1)
    m_strSQL3_4 = Left(m_strSQL3_4, Len(m_strSQL3_4) - 1)
    m_strSQL3_5 = Left(m_strSQL3_5, Len(m_strSQL3_5) - 1)
    '2011/2/23 End
    StrSQL4 = Left(StrSQL4, Len(StrSQL4) - 1)
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = Left(m_strSQL4_2, Len(m_strSQL4_2) - 1)
    m_strSQL4_3 = Left(m_strSQL4_3, Len(m_strSQL4_3) - 1)
    m_strSQL4_4 = Left(m_strSQL4_4, Len(m_strSQL4_4) - 1)
    m_strSQL4_5 = Left(m_strSQL4_5, Len(m_strSQL4_5) - 1)
    '2011/2/23 End
    strSQL5 = Left(strSQL5, Len(strSQL5) - 1)
    m_strSQL5_2 = Left(m_strSQL5_2, Len(m_strSQL5_2) - 1)
    m_strSQL5_3 = Left(m_strSQL5_3, Len(m_strSQL5_3) - 1)
    'add by nickc 2007/01/10
    m_strSQL5_4 = Left(m_strSQL5_4, Len(m_strSQL5_4) - 1)
    m_strSQL5_5 = Left(m_strSQL5_5, Len(m_strSQL5_5) - 1)
    
    StrSQL3 = StrSQL3 & " ) "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 & " ) "
    m_strSQL3_3 = m_strSQL3_3 & " ) "
    m_strSQL3_4 = m_strSQL3_4 & " ) "
    m_strSQL3_5 = m_strSQL3_5 & " ) "
    '2011/2/23 End
    StrSQL4 = StrSQL4 & " ) "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 & " ) "
    m_strSQL4_3 = m_strSQL4_3 & " ) "
    m_strSQL4_4 = m_strSQL4_4 & " ) "
    m_strSQL4_5 = m_strSQL4_5 & " ) "
    '2011/2/23 End
    strSQL5 = strSQL5 & " ) "
    m_strSQL5_2 = m_strSQL5_2 & " ) "
    m_strSQL5_3 = m_strSQL5_3 & " ) "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 & " ) "
    m_strSQL5_5 = m_strSQL5_5 & " ) "
End If

If blnMatchKind = False Then Exit Sub

'若有設定本所案號
If Trim(Me.txt1(12).Text) <> "" Then
    StrSQL3 = StrSQL3 & " and " & m_IsOrNot & " ( "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 & " and " & m_IsOrNot & " ( "
    m_strSQL3_3 = m_strSQL3_3 & " and " & m_IsOrNot & " ( "
    m_strSQL3_4 = m_strSQL3_4 & " and " & m_IsOrNot & " ( "
    m_strSQL3_5 = m_strSQL3_5 & " and " & m_IsOrNot & " ( "
    '2011/2/23 End
    StrSQL4 = StrSQL4 & " and " & m_IsOrNot & " ( "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 & " and " & m_IsOrNot & " ( "
    m_strSQL4_3 = m_strSQL4_3 & " and " & m_IsOrNot & " ( "
    m_strSQL4_4 = m_strSQL4_4 & " and " & m_IsOrNot & " ( "
    m_strSQL4_5 = m_strSQL4_5 & " and " & m_IsOrNot & " ( "
    '2011/2/23 End
    strSQL5 = strSQL5 & " and " & m_IsOrNot & " ( "
    m_strSQL5_2 = m_strSQL5_2 & " and " & m_IsOrNot & " ( "
    m_strSQL5_3 = m_strSQL5_3 & " and " & m_IsOrNot & " ( "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 & " and " & m_IsOrNot & " ( "
    m_strSQL5_5 = m_strSQL5_5 & " and " & m_IsOrNot & " ( "
    
'    m_arrCaseNo = Split(Me.txt1(12).Text, ",")
    m_arrCaseNo = Split(Replace(Me.txt1(12).Text, vbCrLf, ""), ",")
    For ii = LBound(m_arrCaseNo) To UBound(m_arrCaseNo)
        StrSQL3 = StrSQL3 & " ( " & ChgLawcase(m_arrCaseNo(ii)) & " ) "
        'Add By Sindy 2011/2/23
        m_strSQL3_2 = m_strSQL3_2 & " ( " & ChgLawcase(m_arrCaseNo(ii)) & " ) "
        m_strSQL3_3 = m_strSQL3_3 & " ( " & ChgLawcase(m_arrCaseNo(ii)) & " ) "
        m_strSQL3_4 = m_strSQL3_4 & " ( " & ChgLawcase(m_arrCaseNo(ii)) & " ) "
        m_strSQL3_5 = m_strSQL3_5 & " ( " & ChgLawcase(m_arrCaseNo(ii)) & " ) "
        '2011/2/23 End
        StrSQL4 = StrSQL4 & " ( " & ChgHirecase(m_arrCaseNo(ii)) & " ) "
        'Add By Sindy 2011/2/23
        m_strSQL4_2 = m_strSQL4_2 & " ( " & ChgHirecase(m_arrCaseNo(ii)) & " ) "
        m_strSQL4_3 = m_strSQL4_3 & " ( " & ChgHirecase(m_arrCaseNo(ii)) & " ) "
        m_strSQL4_4 = m_strSQL4_4 & " ( " & ChgHirecase(m_arrCaseNo(ii)) & " ) "
        m_strSQL4_5 = m_strSQL4_5 & " ( " & ChgHirecase(m_arrCaseNo(ii)) & " ) "
        '2011/2/23 End
        strSQL5 = strSQL5 & " ( " & ChgService(m_arrCaseNo(ii)) & " ) "
        m_strSQL5_2 = m_strSQL5_2 & " ( " & ChgCaseprogress(m_arrCaseNo(ii)) & " ) "
        m_strSQL5_3 = m_strSQL5_3 & " ( " & ChgCaseprogress(m_arrCaseNo(ii)) & " ) "
        'add by nickc 2007/01/10
        m_strSQL5_4 = m_strSQL5_4 & " ( " & ChgCaseprogress(m_arrCaseNo(ii)) & " ) "
        m_strSQL5_5 = m_strSQL5_5 & " ( " & ChgCaseprogress(m_arrCaseNo(ii)) & " ) "
        If ii < UBound(m_arrCaseNo) Then
            StrSQL3 = StrSQL3 & " Or "
            'Add By Sindy 2011/2/23
            m_strSQL3_2 = m_strSQL3_2 & " Or "
            m_strSQL3_3 = m_strSQL3_3 & " Or "
            m_strSQL3_4 = m_strSQL3_4 & " Or "
            m_strSQL3_5 = m_strSQL3_5 & " Or "
            '2011/2/23 End
            StrSQL4 = StrSQL4 & " Or "
            'Add By Sindy 2011/2/23
            m_strSQL4_2 = m_strSQL4_2 & " Or "
            m_strSQL4_3 = m_strSQL4_3 & " Or "
            m_strSQL4_4 = m_strSQL4_4 & " Or "
            m_strSQL4_5 = m_strSQL4_5 & " Or "
            '2011/2/23 End
            strSQL5 = strSQL5 & " Or "
            m_strSQL5_2 = m_strSQL5_2 & " Or "
            m_strSQL5_3 = m_strSQL5_3 & " Or "
            'add by nickc 2007/01/10
            m_strSQL5_4 = m_strSQL5_4 & " Or "
            m_strSQL5_5 = m_strSQL5_5 & " Or "
        End If
    Next ii
    StrSQL3 = StrSQL3 & " ) "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 & " ) "
    m_strSQL3_3 = m_strSQL3_3 & " ) "
    m_strSQL3_4 = m_strSQL3_4 & " ) "
    m_strSQL3_5 = m_strSQL3_5 & " ) "
    '2011/2/23 End
    StrSQL4 = StrSQL4 & " ) "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 & " ) "
    m_strSQL4_3 = m_strSQL4_3 & " ) "
    m_strSQL4_4 = m_strSQL4_4 & " ) "
    m_strSQL4_5 = m_strSQL4_5 & " ) "
    '2011/2/23 End
    strSQL5 = strSQL5 & " ) "
    m_strSQL5_2 = m_strSQL5_2 & " ) "
    m_strSQL5_3 = m_strSQL5_3 & " ) "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 & " ) "
    m_strSQL5_5 = m_strSQL5_5 & " ) "
End If

'收文日區間
If Len(txt1(3)) <> 0 Then
   StrSQL3 = StrSQL3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   'Add By Sindy 2011/2/23
   m_strSQL3_2 = m_strSQL3_2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL3_3 = m_strSQL3_3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL3_4 = m_strSQL3_4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL3_5 = m_strSQL3_5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   '2011/2/23 End
   StrSQL4 = StrSQL4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   'Add By Sindy 2011/2/23
   m_strSQL4_2 = m_strSQL4_2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL4_3 = m_strSQL4_3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL4_4 = m_strSQL4_4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL4_5 = m_strSQL4_5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   '2011/2/23 End
   strSQL5 = strSQL5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL5_2 = m_strSQL5_2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL5_3 = m_strSQL5_3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   'add by nickc 2007/01/10
   m_strSQL5_4 = m_strSQL5_4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL5_5 = m_strSQL5_5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
End If
If Len(txt1(4)) <> 0 Then
   StrSQL3 = StrSQL3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   'Add By Sindy 2011/2/23
   m_strSQL3_2 = m_strSQL3_2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL3_3 = m_strSQL3_3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL3_4 = m_strSQL3_4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL3_5 = m_strSQL3_5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   '2011/2/23 End
   StrSQL4 = StrSQL4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   'Add By Sindy 2011/2/23
   m_strSQL4_2 = m_strSQL4_2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL4_3 = m_strSQL4_3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL4_4 = m_strSQL4_4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL4_5 = m_strSQL4_5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   '2011/2/23 End
   strSQL5 = strSQL5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL5_2 = m_strSQL5_2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL5_3 = m_strSQL5_3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   'add by nickc 2007/01/10
   m_strSQL5_4 = m_strSQL5_4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL5_5 = m_strSQL5_5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
Else
   If Len(txt1(3)) <> 0 Then
      StrSQL3 = StrSQL3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      'Add By Sindy 2011/2/23
      m_strSQL3_2 = m_strSQL3_2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL3_3 = m_strSQL3_3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL3_4 = m_strSQL3_4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL3_5 = m_strSQL3_5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      '2011/2/23 End
      StrSQL4 = StrSQL4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      'Add By Sindy 2011/2/23
      m_strSQL4_2 = m_strSQL4_2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL4_3 = m_strSQL4_3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL4_4 = m_strSQL4_4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL4_5 = m_strSQL4_5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      '2011/2/23 End
      strSQL5 = strSQL5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL5_2 = m_strSQL5_2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL5_3 = m_strSQL5_3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      'add by nickc 2007/01/10
      m_strSQL5_4 = m_strSQL5_4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL5_5 = m_strSQL5_5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
   End If
End If
'申請日區間
'Modify By Cheng 2003/12/26
'If Len(txt1(13)) <> 0 Then
'   StrSQL5 = StrSQL5 & " AND SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " "
'   m_strSQL5_2 = m_strSQL5_2 & " AND SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " "
'   m_strSQL5_3 = m_strSQL5_3 & " AND SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " "
'End If
'If Len(txt1(14)) <> 0 Then
'   StrSQL5 = StrSQL5 & " AND SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " "
'   m_strSQL5_2 = m_strSQL5_2 & " AND SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " "
'   m_strSQL5_3 = m_strSQL5_3 & " AND SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " "
'Else
'   If Len(txt1(13)) <> 0 Then
'      StrSQL5 = StrSQL5 & " AND SP10<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
'      m_strSQL5_2 = m_strSQL5_2 & " AND SP10<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
'      m_strSQL5_3 = m_strSQL5_3 & " AND SP10<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
'   End If
'End If
'Modify by Amy 2017/12/26 Or 申請日Is Null拿掉
If Me.txt1(13).Text <> "" And Me.txt1(14).Text = "" Then
    strSQL5 = strSQL5 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
    m_strSQL5_2 = m_strSQL5_2 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
    m_strSQL5_3 = m_strSQL5_3 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
    m_strSQL5_5 = m_strSQL5_5 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & strSrvDate(1) & " )  ) "
End If
If Me.txt1(13).Text = "" And Me.txt1(14).Text <> "" Then
    strSQL5 = strSQL5 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  )"
    m_strSQL5_2 = m_strSQL5_2 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL5_3 = m_strSQL5_3 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL5_5 = m_strSQL5_5 & " AND (SP10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
End If
If Me.txt1(13).Text <> "" And Me.txt1(14).Text <> "" Then
    strSQL5 = strSQL5 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL5_2 = m_strSQL5_2 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL5_3 = m_strSQL5_3 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL5_5 = m_strSQL5_5 & " AND ((SP10>=" & Val(ChangeTStringToWString(txt1(13))) & " And SP10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
End If
'end 2017/12/26
'End
'申請國家
If Len(txt1(5)) <> 0 Then
    StrSQL3 = StrSQL3 + " AND LC15>='" & txt1(5) & "' "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND LC15>='" & txt1(5) & "' "
    m_strSQL3_3 = m_strSQL3_3 + " AND LC15>='" & txt1(5) & "' "
    m_strSQL3_4 = m_strSQL3_4 + " AND LC15>='" & txt1(5) & "' "
    m_strSQL3_5 = m_strSQL3_5 + " AND LC15>='" & txt1(5) & "' "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND SP09>='" & txt1(5) & "' "
    m_strSQL5_2 = m_strSQL5_2 + " AND SP09>='" & txt1(5) & "' "
    m_strSQL5_3 = m_strSQL5_3 + " AND SP09>='" & txt1(5) & "' "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 + " AND SP09>='" & txt1(5) & "' "
    m_strSQL5_5 = m_strSQL5_5 + " AND SP09>='" & txt1(5) & "' "
End If
If Len(txt1(6)) <> 0 Then
    StrSQL3 = StrSQL3 + " AND LC15<='" & txt1(6) & "' "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND LC15<='" & txt1(6) & "' "
    m_strSQL3_3 = m_strSQL3_3 + " AND LC15<='" & txt1(6) & "' "
    m_strSQL3_4 = m_strSQL3_4 + " AND LC15<='" & txt1(6) & "' "
    m_strSQL3_5 = m_strSQL3_5 + " AND LC15<='" & txt1(6) & "' "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND SP09<='" & txt1(6) & "' "
    m_strSQL5_2 = m_strSQL5_2 + " AND SP09<='" & txt1(6) & "' "
    m_strSQL5_3 = m_strSQL5_3 + " AND SP09<='" & txt1(6) & "' "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 + " AND SP09<='" & txt1(6) & "' "
    m_strSQL5_5 = m_strSQL5_5 + " AND SP09<='" & txt1(6) & "' "
End If

'add by nickc 2005/11/24 加入閉卷選擇
If ChkClose.Value <> vbChecked Then
    StrSQL3 = StrSQL3 + " AND (LC08<>'Y' or lc08 is null) "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND (LC08<>'Y' or lc08 is null) "
    m_strSQL3_3 = m_strSQL3_3 + " AND (LC08<>'Y' or lc08 is null) "
    m_strSQL3_4 = m_strSQL3_4 + " AND (LC08<>'Y' or lc08 is null) "
    m_strSQL3_5 = m_strSQL3_5 + " AND (LC08<>'Y' or lc08 is null) "
    '2011/2/23 End
    StrSQL4 = StrSQL4 + " AND (hC09<>'Y' or hc09 is null) "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 + " AND (hC09<>'Y' or hc09 is null) "
    m_strSQL4_3 = m_strSQL4_3 + " AND (hC09<>'Y' or hc09 is null) "
    m_strSQL4_4 = m_strSQL4_4 + " AND (hC09<>'Y' or hc09 is null) "
    m_strSQL4_5 = m_strSQL4_5 + " AND (hC09<>'Y' or hc09 is null) "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND (SP15<>'Y' or sp15 is null)"
    m_strSQL5_2 = m_strSQL5_2 + " AND (SP15<>'Y' or sp15 is null) "
    m_strSQL5_3 = m_strSQL5_3 + " AND (SP15<>'Y' or sp15 is null) "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 + " AND (SP15<>'Y' or sp15 is null) "
    m_strSQL5_5 = m_strSQL5_5 + " AND (SP15<>'Y' or sp15 is null) "
End If

'Added by Morgan 2015/9/16 已閉卷或銷卷
If Check11.Value = vbChecked Then
    StrSQL3 = StrSQL3 + " AND lc08||lc34 is not null "
    m_strSQL3_2 = m_strSQL3_2 + " AND lc08||lc34 is not null "
    m_strSQL3_3 = m_strSQL3_3 + " AND lc08||lc34 is not null "
    m_strSQL3_4 = m_strSQL3_4 + " AND lc08||lc34 is not null "
    m_strSQL3_5 = m_strSQL3_5 + " AND lc08||lc34 is not null "
    StrSQL4 = StrSQL4 + " AND hc09||hc19 is not null "
    m_strSQL4_2 = m_strSQL4_2 + " AND hc09||hc19 is not null "
    m_strSQL4_3 = m_strSQL4_3 + " AND hc09||hc19 is not null "
    m_strSQL4_4 = m_strSQL4_4 + " AND hc09||hc19 is not null "
    m_strSQL4_5 = m_strSQL4_5 + " AND hc09||hc19 is not null "
    strSQL5 = strSQL5 + " AND sp15||sp61 is not null"
    m_strSQL5_2 = m_strSQL5_2 + " AND sp15||sp61 is not null "
    m_strSQL5_3 = m_strSQL5_3 + " AND sp15||sp61 is not null "
    m_strSQL5_4 = m_strSQL5_4 + " AND sp15||sp61 is not null "
    m_strSQL5_5 = m_strSQL5_5 + " AND sp15||sp61 is not null "

End If
'end 2015/9/16


If UCase(txt1(7)) = "N" Then
    'Modify By Cheng 2003/09/08
    'Begin
    '申請中的資料也要出來
'    strSQL3 = strSQL3 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
'    strSQL4 = strSQL4 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
'    StrSQL5 = StrSQL5 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
'    m_strSQL5_2 = m_strSQL5_2 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
'    m_strSQL5_3 = m_strSQL5_3 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
    'End
    'C類核駁的資料不出現
'    strSQL3 = strSQL3 + " AND CP10 <> '1002' "
'    strSQL4 = strSQL4 + " AND CP10 <> '1002' "
'    StrSQL5 = StrSQL5 + " AND CP10 <> '1002' "
'    m_strSQL5_2 = m_strSQL5_2 + " AND CP10 <> '1002' "
'    m_strSQL5_3 = m_strSQL5_3 + " AND CP10 <> '1002' "
    StrSQL3 = StrSQL3 + " AND '1002'<>CP10(+) "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND '1002'<>CP10(+) "
    m_strSQL3_3 = m_strSQL3_3 + " AND '1002'<>CP10(+) "
    m_strSQL3_4 = m_strSQL3_4 + " AND '1002'<>CP10(+) "
    m_strSQL3_5 = m_strSQL3_5 + " AND '1002'<>CP10(+) "
    '2011/2/23 End
    StrSQL4 = StrSQL4 + " AND '1002'<>CP10(+) "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 + " AND '1002'<>CP10(+) "
    m_strSQL4_3 = m_strSQL4_3 + " AND '1002'<>CP10(+) "
    m_strSQL4_4 = m_strSQL4_4 + " AND '1002'<>CP10(+) "
    m_strSQL4_5 = m_strSQL4_5 + " AND '1002'<>CP10(+) "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND '1002'<>CP10(+) "
    m_strSQL5_2 = m_strSQL5_2 + " AND '1002'<>CP10(+) "
    m_strSQL5_3 = m_strSQL5_3 + " AND '1002'<>CP10(+) "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 + " AND '1002'<>CP10(+) "
    m_strSQL5_5 = m_strSQL5_5 + " AND '1002'<>CP10(+) "
End If
'智權人員
If Me.txt1(11).Text <> "" Then
    StrSQL3 = StrSQL3 + " AND CU13='" & Me.txt1(11).Text & "' "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL3_3 = m_strSQL3_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL3_4 = m_strSQL3_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL3_5 = m_strSQL3_5 + " AND CU13='" & Me.txt1(11).Text & "' "
    '2011/2/23 End
    StrSQL4 = StrSQL4 + " AND CU13='" & Me.txt1(11).Text & "' "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL4_3 = m_strSQL4_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL4_4 = m_strSQL4_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL4_5 = m_strSQL4_5 + " AND CU13='" & Me.txt1(11).Text & "' "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL5_2 = m_strSQL5_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL5_3 = m_strSQL5_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL5_5 = m_strSQL5_5 + " AND CU13='" & Me.txt1(11).Text & "' "
'Add By Cheng 2003/07/21
'若未輸入智權人員
Else
    StrSQL3 = StrSQL3 + " AND CU13 Is Null "
    'Add By Sindy 2011/2/23
    m_strSQL3_2 = m_strSQL3_2 + " AND CU13 Is Null "
    m_strSQL3_3 = m_strSQL3_3 + " AND CU13 Is Null "
    m_strSQL3_4 = m_strSQL3_4 + " AND CU13 Is Null "
    m_strSQL3_5 = m_strSQL3_5 + " AND CU13 Is Null "
    '2011/2/23 End
    StrSQL4 = StrSQL4 + " AND CU13 Is Null "
    'Add By Sindy 2011/2/23
    m_strSQL4_2 = m_strSQL4_2 + " AND CU13 Is Null "
    m_strSQL4_3 = m_strSQL4_3 + " AND CU13 Is Null "
    m_strSQL4_4 = m_strSQL4_4 + " AND CU13 Is Null "
    m_strSQL4_5 = m_strSQL4_5 + " AND CU13 Is Null "
    '2011/2/23 End
    strSQL5 = strSQL5 + " AND CU13 Is Null "
    m_strSQL5_2 = m_strSQL5_2 + " AND CU13 Is Null "
    m_strSQL5_3 = m_strSQL5_3 + " AND CU13 Is Null "
    'add by nickc 2007/01/10
    m_strSQL5_4 = m_strSQL5_4 + " AND CU13 Is Null "
    m_strSQL5_5 = m_strSQL5_5 + " AND CU13 Is Null "
End If
'Add By Cheng 2004/04/19
'若選擇列印首次接洽或最新收文程序
If Me.txt1(15).Text = "1" Or Me.txt1(15).Text = "2" Then
    'Modify by Morgan 2005/5/16 若只有一道程序時取消的還是要印
'    strSQL3 = strSQL3 + " AND CP57 Is Null "
'    strSQL4 = strSQL4 + " AND CP57 Is Null "
'    strSQL5 = strSQL5 + " AND CP57 Is Null "
'    m_strSQL5_2 = m_strSQL5_2 + " AND CP57 Is Null "
'    m_strSQL5_3 = m_strSQL5_3 + " AND CP57 Is Null "
    StrSQL3 = StrSQL3 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   'Add By Sindy 2011/2/23
   m_strSQL3_2 = m_strSQL3_2 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   m_strSQL3_3 = m_strSQL3_3 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   m_strSQL3_4 = m_strSQL3_4 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   m_strSQL3_5 = m_strSQL3_5 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   '2011/2/23 End
   StrSQL4 = StrSQL4 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   'Add By Sindy 2011/2/23
   m_strSQL4_2 = m_strSQL4_2 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   m_strSQL4_3 = m_strSQL4_3 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   m_strSQL4_4 = m_strSQL4_4 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   m_strSQL4_5 = m_strSQL4_5 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   '2011/2/23 End
   strSQL5 = strSQL5 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   m_strSQL5_2 = m_strSQL5_2 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   m_strSQL5_3 = m_strSQL5_3 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   'add by nickc 2007/01/10
   m_strSQL5_4 = m_strSQL5_4 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
   m_strSQL5_5 = m_strSQL5_5 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
End If
'End
CheckOC
Select Case txt1(10)
Case 1 '中文報表
      If intPCaseKind = 專利 And intPWhere = 國外_CF Then
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
                                       strSql = "Select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all Select LC43,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all Select LC44,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all Select LC45,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all Select LC46,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC24),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC25),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC26),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC27),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            'Modify By Cheng 2003/11/25
            'B類收文的不續辦, 閉卷也要列印
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = "Select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(na03,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,na03          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND CP09<'B' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
'            strSQL = "Select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
                                       strSql = "Select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all Select LC43,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all Select LC44,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all Select LC45,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all Select LC46,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC24),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC25),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC26),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC27),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        End If
      Else
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
                                       strSql = "Select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all Select LC43,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all Select LC44,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all Select LC45,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all Select LC46,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC24),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC25),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC26),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC27),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            'Modify By Cheng 2003/11/25
            'B類收文的不續辦, 閉卷也要列印
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And ((CP01 In ('CPS', 'FG', 'PS') And CP10 In ('907', '913')) Or (CP01 In ('CFC', 'S', 'TB', 'TC', 'TD', 'TF', 'TM', 'TR', 'TS', 'TT'))))) " & _
                                        " AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = "Select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(na03,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01 AND LC02=CP02 AND LC03=CP03 AND LC04=CP04 AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,na03          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01 AND HC02=CP02 AND HC03=CP03 AND HC04=CP04 AND CP09<'B' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(na03,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01 AND SP02=CP02 AND SP03=CP03 AND SP04=CP04 AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
'            strSQL = "Select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09,cp01,cp02,cp03,cp04, '', CP57 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
                                       strSql = "Select LC11,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all Select LC43,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all Select LC44,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all Select LC45,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all Select LC46,lc23,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(decode(lc15,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                   ,''                            ,Nvl(lc05,Nvl(LC06,LC07)),CP05," & SQLDate("CP57") & "||Decode(LC08,'Y','*',''),cp09, LC01, LC02, LC03, LC04, '', CP57 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC05),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC24),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC25),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC26),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),HC27),''  ,NA01          ,NVL(Nvl(cpm03,Nvl(CPM10,CPM13)),CP10)                         ," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                   ,''                            ,HC06,CP05," & SQLDate("CP57") & "||Decode(HC09,'Y','*',''),cp09, HC01, HC02, HC03, HC04, '', CP57 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(decode(sp09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                   ,''                            ,Nvl(sp05,Nvl(SP06,SP07)),CP05," & SQLDate("CP57") & "||Decode(SP15,'Y','*',''),cp09, SP01, SP02, SP03, SP04," & SQLDate("SP10") & ", CP57 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        End If
      End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = LBound(strTemp) To UBound(strTemp)
                    strTemp(i) = ""
                Next i
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If Right(strTemp(16), 1) = "*" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = Replace(strTemp(16), "*", "閉卷")
                End If
                '申請日
                strTemp(23) = "" & .Fields(22).Value
                CheckOC2
                strSql = "select min(pd05) from pridate where pd01='" & CheckStr(.Fields(18)) & "' and pd02='" & CheckStr(.Fields(19)) & "' and pd03='" & CheckStr(.Fields(20)) & "' and pd04='" & CheckStr(.Fields(21)) & "' "
                adoRecordset1.CursorLocation = adUseClient
                adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                If adoRecordset1.RecordCount <> 0 Then
                     strTemp(24) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                Else
                     strTemp(24) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>411 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND np07 <> 6001 And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>305 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Cheng 2003/07/08
'                strSQL = "INSERT INTO R050317_C values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "') "
                'Modify By Cheng 2003/08/12
'                strSQL = "INSERT INTO R050317_C values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','" & "" & .Fields("CP57").Value & "') "
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 中文新增 R013028 存CP31
                strSql = "INSERT INTO R050317_C " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & PUB_GetRelateCasePropertyName(strTemp(17), Me.txt1(10).Text) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','" & "" & .Fields("CP57").Value & "',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
            'Modify by Amy 2017/07/25 更新R013028
            If IsHaveData = True Then
                strSql = "Update R050317_C Set R013028=(Select CP31 From CaseProgress Where R013018=CP09(+)) Where ID='" & strUserNum & "'"
                cnnConnection.Execute strSql
            End If
            'end 2017/07/25
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_c WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 2 '英文報表
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
                                       strSql = "Select LC11,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC11,1,8)=CU01(+) AND SUBSTR(LC11,9,1) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all Select LC43,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC43,1,8)=CU01(+) AND SUBSTR(LC43,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all Select LC44,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC44,1,8)=CU01(+) AND SUBSTR(LC44,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all Select LC45,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC45,1,8)=CU01(+) AND SUBSTR(LC45,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all Select LC46,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC46,1,8)=CU01(+) AND SUBSTR(LC46,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC05),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC05,1,8)=CU01(+) AND SUBSTR(HC05,9,1) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC24),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC24,1,8)=CU01(+) AND SUBSTR(HC24,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC25),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC25,1,8)=CU01(+) AND SUBSTR(HC25,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC26),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC26,1,8)=CU01(+) AND SUBSTR(HC26,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC27),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC27,1,8)=CU01(+) AND SUBSTR(HC27,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = "Select LC11,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC11),''  ,NVL(na04,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND SUBSTR(LC11,9,1) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC05),''  ,na04          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'B' AND SUBSTR(HC05,1,8)=CU01(+) AND SUBSTR(HC05,9,1) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
'            strSQL = "Select LC11,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC11,1,8)=CU01(+) AND SUBSTR(LC11,9,1) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC05),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC05,1,8)=CU01(+) AND SUBSTR(HC05,9,1) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
                                       strSql = "Select LC11,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC11,1,8)=CU01(+) AND SUBSTR(LC11,9,1) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all Select LC43,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC43,1,8)=CU01(+) AND SUBSTR(LC43,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all Select LC44,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC44,1,8)=CU01(+) AND SUBSTR(LC44,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all Select LC45,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC45,1,8)=CU01(+) AND SUBSTR(LC45,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all Select LC46,lc23,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                       ,''   ,Nvl(lc06,lc07),CP05,LC08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC46,1,8)=CU01(+) AND SUBSTR(LC46,9,1) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC05),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC05,1,8)=CU01(+) AND SUBSTR(HC05,9,1) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC24),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC24,1,8)=CU01(+) AND SUBSTR(HC24,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC25),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC25,1,8)=CU01(+) AND SUBSTR(HC25,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC26),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC26,1,8)=CU01(+) AND SUBSTR(HC26,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),HC27),''  ,NA01          ,NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                       ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC27,1,8)=CU01(+) AND SUBSTR(HC27,9,1) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                       ,''   ,Nvl(sp06,Sp07),CP05,SP15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "Closed"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>411 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>305 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
'                strSQL = "INSERT INTO R050317_E values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "') "
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_E " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 3 '日文報表
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
                                       strSql = "Select LC11,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all Select LC43,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all Select LC44,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all Select LC45,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all Select LC46,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC05),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC24),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC25),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC26),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC27),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = "Select LC11,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC11),''  ,NVL(na04,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'B' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC05),''  ,na04          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'B' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(na04,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'B' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
'            strSQL = "Select LC11,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09,cp01,cp02,cp03,cp04 FROM LAWCASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & strSQL3
'            strSQL = strSQL + " union all select HC05,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC05),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09,cp01,cp02,cp03,cp04 FROM HIRECASE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & strSQL4
'            strSQL = strSQL + " union all select sp08,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & StrSQL5
'            strSQL = strSQL + " union all select sp58,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
'            strSQL = strSQL + " union all select sp59,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09,cp01,cp02,cp03,cp04 FROM SERVICEPRACTICE,CASEPROGRESS,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
                                       strSql = "Select LC11,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC11),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC11,1,8)=CU01(+) AND DECODE(SUBSTR(LC11,9,1),NULL,'0',SUBSTR(LC11,9,1)) = CU02(+) AND LC15=NA01(+) " & StrSQL3
            'Add By Sindy 2011/2/23
            strSql = strSql + " union all Select LC43,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC43),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC43,1,8)=CU01(+) AND DECODE(SUBSTR(LC43,9,1),NULL,'0',SUBSTR(LC43,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_2
            strSql = strSql + " union all Select LC44,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC44),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC44,1,8)=CU01(+) AND DECODE(SUBSTR(LC44,9,1),NULL,'0',SUBSTR(LC44,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_3
            strSql = strSql + " union all Select LC45,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC45),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC45,1,8)=CU01(+) AND DECODE(SUBSTR(LC45,9,1),NULL,'0',SUBSTR(LC45,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_4
            strSql = strSql + " union all Select LC46,lc23,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),LC46),''  ,NVL(NA01,LC15),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',lc17,LC01||'-'||LC02||decode(lc03||lc04,'000','','-'||LC03||'-'||LC04),''  ,0   ,''                                    ,''   ,Nvl(lc07,LC06),CP05,lc08,cp09, LC01, LC02, LC03, LC04 FROM LAWCASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cp01=CPM01(+) AND CP10=CPM02(+) AND LC01=CP01(+) AND LC02=CP02(+) AND LC03=CP03(+) AND LC04=CP04(+) AND CP09<'C' AND SUBSTR(LC46,1,8)=CU01(+) AND DECODE(SUBSTR(LC46,9,1),NULL,'0',SUBSTR(LC46,9,1)) = CU02(+) AND LC15=NA01(+) " & m_strSQL3_5
            '2011/2/23 End
            If txt1(5) = "" Or txt1(5) = "000" Then '2012/7/27 ADD BY SONIA 未下申請國家或輸000時才抓顧問案件
               strSql = strSql + " union all select HC05,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC05),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC05,1,8)=CU01(+) AND DECODE(SUBSTR(HC05,9,1),NULL,'0',SUBSTR(HC05,9,1)) = CU02(+) AND '000'=NA01(+) " & StrSQL4
               'Add By Sindy 2011/2/23
               strSql = strSql + " union all select HC24,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC24),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC24,1,8)=CU01(+) AND DECODE(SUBSTR(HC24,9,1),NULL,'0',SUBSTR(HC24,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_2
               strSql = strSql + " union all select HC25,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC25),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC25,1,8)=CU01(+) AND DECODE(SUBSTR(HC25,9,1),NULL,'0',SUBSTR(HC25,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_3
               strSql = strSql + " union all select HC26,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC26),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC26,1,8)=CU01(+) AND DECODE(SUBSTR(HC26,9,1),NULL,'0',SUBSTR(HC26,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_4
               strSql = strSql + " union all select HC27,''  ,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),HC27),''  ,NA01          ,NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',''  ,HC01||'-'||HC02||'-'||HC03||'-'||HC04,''  ,0   ,''                                    ,''   ,HC06          ,CP05,HC09,cp09, HC01, HC02, HC03, HC04 FROM HIRECASE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND HC01=CP01(+) AND HC02=CP02(+) AND HC03=CP03(+) AND HC04=CP04(+) AND CP09<'C' AND SUBSTR(HC27,1,8)=CU01(+) AND DECODE(SUBSTR(HC27,9,1),NULL,'0',SUBSTR(HC27,9,1)) = CU02(+) AND '000'=NA01(+) " & m_strSQL4_5
               '2011/2/23 End
            End If '2012/7/27 ADD BY SONIA
            strSql = strSql + " union all select sp08,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP08),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP08,1,8)=CU01(+) AND DECODE(SUBSTR(SP08,9,1),NULL,'0',SUBSTR(SP08,9,1)) = CU02(+) AND SP09=NA01(+) " & strSQL5
            strSql = strSql + " union all select sp58,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP58),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP58,1,8)=CU01(+) AND DECODE(SUBSTR(SP58,9,1),NULL,'0',SUBSTR(SP58,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_2
            strSql = strSql + " union all select sp59,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP59),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP59,1,8)=CU01(+) AND DECODE(SUBSTR(SP59,9,1),NULL,'0',SUBSTR(SP59,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_3
            'add by nickc 2007/01/10
            strSql = strSql + " union all select sp65,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP65),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP65,1,8)=CU01(+) AND DECODE(SUBSTR(SP65,9,1),NULL,'0',SUBSTR(SP65,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_4
            strSql = strSql + " union all select sp66,sp27,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),SP66),sp11,NVL(NA01,SP09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',sp29,SP01||'-'||SP02||decode(sp03||sp04,'000','','-'||SP03||'-'||SP04),SP14,sp21,''                                    ,''   ,Nvl(sp07,SP06),CP05,sp15,cp09, SP01, SP02, SP03, SP04 FROM SERVICEPRACTICE,CASEPROGRESS A,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND SP01=CP01(+) AND SP02=CP02(+) AND SP03=CP03(+) AND SP04=CP04(+) AND CP09<'C' AND SUBSTR(SP66,1,8)=CU01(+) AND DECODE(SUBSTR(SP66,9,1),NULL,'0',SUBSTR(SP66,9,1)) = CU02(+) AND SP09=NA01(+) " & m_strSQL5_5
        End If
    CheckOC
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "ゾゆ"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>411 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>305 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
'                strSQL = "INSERT INTO R050317_J values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & " ','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "') "
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_J " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & " ','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case Else
End Select
'Add by Amy 2017/12/26 剔除D類
cnnConnection.Execute "Delete From R050317_C WHERE ID='" & strUserNum & "'  And SubStr(R013018,1,1)='D' "     '語文為中文      對內
cnnConnection.Execute "Delete From R050317_E WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為英文    對外
cnnConnection.Execute "Delete From R050317_J WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為日文   對外
'end 2017/12/26
'Add by Amy 2021/02/03 台灣L案,若法律所案源檔有存在且僅有C類案源案件類型LOS02時，此案號不列出。
cnnConnection.Execute "Delete From R050317_C WHERE ID='" & strUserNum & "' And InStr(R013022,'L')>0 And R013005='000' And R013022||R013023||R013024||R013025 In (" & _
                                      "Select Distinct R013022||R013023||R013024||R013025 From R050317_C,LawOfficeSource Where InStr(R013022,'L')>0 And R013005='000' And R013018=Los06(+) And Los06 is not null And Los02='C') "
'Modify by Amy 2020/04/01 Call 增加參數/加 ReportName
Select Case txt1(10)
Case 1     '中文
    '列印所有程序
    If Me.txt1(15).Text = "3" Then
         Call PrintDataCp
         If strSrvDate(1) >= 事務所合併日 Then
            '紙本
            If Check3(0).Value = vbChecked Then
                '若下所有程序或英日報表
                If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
                    Printer.Orientation = 1
                    Printer.PaperSize = PUB_GetPaperSize(15)
                '其他
                Else
                    Printer.Orientation = 2
                    Printer.PaperSize = 9
                End If
            End If
            ReportName = "法務": m_strPrintKind = 4
            Call PrintDataCp(True)
         End If
    '選首次或最新程序
    Else
         Call PrintDataCo_A4
         If strSrvDate(1) >= 事務所合併日 Then
            '紙本
            If Check3(0).Value = vbChecked Then
                '若下所有程序或英日報表
                If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
                    Printer.Orientation = 1
                    Printer.PaperSize = PUB_GetPaperSize(15)
                '其他
                Else
                    Printer.Orientation = 2
                    Printer.PaperSize = 9
                End If
            End If
            ReportName = "法務": m_strPrintKind = 4
            Call PrintDataCo_A4(True)
         End If
    End If
Case 2     '英文
    Call PrintDataEp
    If strSrvDate(1) >= 事務所合併日 Then
        '紙本
        If Check3(0).Value = vbChecked Then
            '若下所有程序或英日報表
            If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
                Printer.Orientation = 1
                Printer.PaperSize = PUB_GetPaperSize(15)
            '其他
            Else
                Printer.Orientation = 2
                Printer.PaperSize = 9
            End If
        End If
        ReportName = "法務": m_strPrintKind = 4
        Call PrintDataEp(True)
    End If
Case 3     '日文
    Call PrintDataJp
    If strSrvDate(1) >= 事務所合併日 Then
        '紙本
        If Check3(0).Value = vbChecked Then
            '若下所有程序或英日報表
            If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
                Printer.Orientation = 1
                Printer.PaperSize = PUB_GetPaperSize(15)
            '其他
            Else
                Printer.Orientation = 2
                Printer.PaperSize = 9
            End If
        End If
        ReportName = "法務": m_strPrintKind = 4
        Call PrintDataJp(True)
    End If
Case Else
End Select
'end 2020/04/01
'Screen.MousePointer = vbDefault
End Sub

'Add By Cheng 2003/07/08
'只抓專利基本檔的資料
Private Sub ProcessP_1()
Dim ii As Integer
Dim blnMatchKind As Boolean

On Error GoTo ErrHnd

Screen.MousePointer = vbHourglass
'add by nickc 2005/11/09 紙本
If Check3(0).Value = vbChecked Then
    '若下所有程序或英日報表
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        Printer.Orientation = 1
        'Modified by Morgan 2015/6/26
        'If InStr(UCase(Printer.DeviceName), "PDF") = 0 Then 'Added by Morgan 2014/5/21
        '    Printer.PaperSize = 39
        'End If
        Printer.PaperSize = PUB_GetPaperSize(15)
        'end 2015/6/25
        o_PaperHeight = 14200
    '其他
    Else
        Printer.Orientation = 2
        Printer.PaperSize = 9
        o_PaperHeight = 10000
    End If
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        o_PaperHeight = 50 'Modify by Amy 2019/11/21 原:56
    Else
        o_PaperHeight = 40
    End If
End If
m_strPrintKind = "1"
blnMatchKind = False
cnnConnection.Execute "delete from R050317_C WHERE ID='" & strUserNum & "' "     '語文為中文      對內
cnnConnection.Execute "DELETE FROM R050317_E WHERE ID='" & strUserNum & "' "     '語文為英文    對外
cnnConnection.Execute "DELETE FROM R050317_J WHERE ID='" & strUserNum & "' "     '語文為日文   對外
strSQL1 = ""
strSQL2 = ""
StrSQL3 = ""
StrSQL4 = ""
strSQL5 = ""
'初始化變數
m_strSQL1_2 = "": m_strSQL1_3 = "": m_strSQL1_4 = "": m_strSQL1_5 = ""
m_strSQL5_2 = "": m_strSQL5_3 = ""
strSQL1 = strSQL1 + " AND (PA26>='" & GetNewFagent(txt1(0)) & "' AND PA26<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL1_2 = m_strSQL1_2 + " AND (PA27>='" & GetNewFagent(txt1(0)) & "' AND PA27<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL1_3 = m_strSQL1_3 + " AND (PA28>='" & GetNewFagent(txt1(0)) & "' AND PA28<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL1_4 = m_strSQL1_4 + " AND (PA29>='" & GetNewFagent(txt1(0)) & "' AND PA29<='" & GetNewFagent(txt1(1)) & "') "
m_strSQL1_5 = m_strSQL1_5 + " AND (PA30>='" & GetNewFagent(txt1(0)) & "' AND PA30<='" & GetNewFagent(txt1(1)) & "') "
'若有勾選系統類別
If Me.Check1(0).Value = vbChecked Or Me.Check1(1).Value = vbChecked Then
    blnMatchKind = True
    strSQL1 = strSQL1 & " and PA01 in (' ',"
    m_strSQL1_2 = m_strSQL1_2 & " and PA01 in (' ',"
    m_strSQL1_3 = m_strSQL1_3 & " and PA01 in (' ',"
    m_strSQL1_4 = m_strSQL1_4 & " and PA01 in (' ',"
    m_strSQL1_5 = m_strSQL1_5 & " and PA01 in (' ',"
    If Me.Check1(0).Value = vbChecked Then
        strSQL1 = strSQL1 & SQLGrpStr(txt1(2), 1) & ","
        m_strSQL1_2 = m_strSQL1_2 & SQLGrpStr(txt1(2), 1) & ","
        m_strSQL1_3 = m_strSQL1_3 & SQLGrpStr(txt1(2), 1) & ","
        m_strSQL1_4 = m_strSQL1_4 & SQLGrpStr(txt1(2), 1) & ","
        m_strSQL1_5 = m_strSQL1_5 & SQLGrpStr(txt1(2), 1) & ","
    End If
    If Me.Check1(1).Value = vbChecked Then
        strSQL1 = strSQL1 & "'CFP','FCP','P'" & ","
        m_strSQL1_2 = m_strSQL1_2 & "'CFP','FCP','P'" & ","
        m_strSQL1_3 = m_strSQL1_3 & "'CFP','FCP','P'" & ","
        m_strSQL1_4 = m_strSQL1_4 & "'CFP','FCP','P'" & ","
        m_strSQL1_5 = m_strSQL1_5 & "'CFP','FCP','P'" & ","
    End If
    strSQL1 = Left(strSQL1, Len(strSQL1) - 1)
    m_strSQL1_2 = Left(m_strSQL1_2, Len(m_strSQL1_2) - 1)
    m_strSQL1_3 = Left(m_strSQL1_3, Len(m_strSQL1_3) - 1)
    m_strSQL1_4 = Left(m_strSQL1_4, Len(m_strSQL1_4) - 1)
    m_strSQL1_5 = Left(m_strSQL1_5, Len(m_strSQL1_5) - 1)
    
    strSQL1 = strSQL1 & " ) "
    m_strSQL1_2 = m_strSQL1_2 & " ) "
    m_strSQL1_3 = m_strSQL1_3 & " ) "
    m_strSQL1_4 = m_strSQL1_4 & " ) "
    m_strSQL1_5 = m_strSQL1_5 & " ) "
End If

If blnMatchKind = False Then Exit Sub

'若有設定本所案號
If Trim(Me.txt1(12).Text) <> "" Then
    strSQL1 = strSQL1 & " and " & m_IsOrNot & " ( "
    m_strSQL1_2 = m_strSQL1_2 & " and " & m_IsOrNot & " ( "
    m_strSQL1_3 = m_strSQL1_3 & " and " & m_IsOrNot & " ( "
    m_strSQL1_4 = m_strSQL1_4 & " and " & m_IsOrNot & " ( "
    m_strSQL1_5 = m_strSQL1_5 & " and " & m_IsOrNot & " ( "
    
'    m_arrCaseNo = Split(Me.txt1(12).Text, ",")
    m_arrCaseNo = Split(Replace(Me.txt1(12).Text, vbCrLf, ""), ",")
    For ii = LBound(m_arrCaseNo) To UBound(m_arrCaseNo)
        strSQL1 = strSQL1 & " ( " & ChgPatent(m_arrCaseNo(ii)) & " ) "
        m_strSQL1_2 = m_strSQL1_2 & " ( " & ChgPatent(m_arrCaseNo(ii)) & " ) "
        m_strSQL1_3 = m_strSQL1_3 & " ( " & ChgPatent(m_arrCaseNo(ii)) & " ) "
        m_strSQL1_4 = m_strSQL1_4 & " ( " & ChgPatent(m_arrCaseNo(ii)) & " ) "
        m_strSQL1_5 = m_strSQL1_5 & " ( " & ChgPatent(m_arrCaseNo(ii)) & " ) "
        If ii < UBound(m_arrCaseNo) Then
            strSQL1 = strSQL1 & " Or "
            m_strSQL1_2 = m_strSQL1_2 & " Or "
            m_strSQL1_3 = m_strSQL1_3 & " Or "
            m_strSQL1_4 = m_strSQL1_4 & " Or "
            m_strSQL1_5 = m_strSQL1_5 & " Or "
        End If
    Next ii
    strSQL1 = strSQL1 & " ) "
    m_strSQL1_2 = m_strSQL1_2 & " ) "
    m_strSQL1_3 = m_strSQL1_3 & " ) "
    m_strSQL1_4 = m_strSQL1_4 & " ) "
    m_strSQL1_5 = m_strSQL1_5 & " ) "
End If

'收文日區間
If Len(txt1(3)) <> 0 Then
   strSQL1 = strSQL1 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL1_2 = m_strSQL1_2 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL1_3 = m_strSQL1_3 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL1_4 = m_strSQL1_4 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
   m_strSQL1_5 = m_strSQL1_5 & " AND CP05>=" & Val(ChangeTStringToWString(txt1(3))) & " "
End If
If Len(txt1(4)) <> 0 Then
   strSQL1 = strSQL1 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL1_2 = m_strSQL1_2 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL1_3 = m_strSQL1_3 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL1_4 = m_strSQL1_4 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
   m_strSQL1_5 = m_strSQL1_5 & " AND CP05<=" & Val(ChangeTStringToWString(txt1(4))) & " "
Else
   If Len(txt1(3)) <> 0 Then
      strSQL1 = strSQL1 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL1_2 = m_strSQL1_2 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL1_3 = m_strSQL1_3 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL1_4 = m_strSQL1_4 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
      m_strSQL1_5 = m_strSQL1_5 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
   End If
End If
'申請日區間
'Modify By Cheng 2003/12/26
'If Len(txt1(13)) <> 0 Then
'   strSQL1 = strSQL1 & " AND PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " "
'   m_strSQL1_2 = m_strSQL1_2 & " AND PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " "
'   m_strSQL1_3 = m_strSQL1_3 & " AND PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " "
'   m_strSQL1_4 = m_strSQL1_4 & " AND PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " "
'   m_strSQL1_5 = m_strSQL1_5 & " AND PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " "
'End If
'If Len(txt1(14)) <> 0 Then
'   strSQL1 = strSQL1 & " AND PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " "
'   m_strSQL1_2 = m_strSQL1_2 & " AND PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " "
'   m_strSQL1_3 = m_strSQL1_3 & " AND PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " "
'   m_strSQL1_4 = m_strSQL1_4 & " AND PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " "
'   m_strSQL1_5 = m_strSQL1_5 & " AND PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " "
'Else
'   If Len(txt1(13)) <> 0 Then
'      strSQL1 = strSQL1 & " AND PA10<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
'      m_strSQL1_2 = m_strSQL1_2 & " AND PA10<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
'      m_strSQL1_3 = m_strSQL1_3 & " AND PA10<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
'      m_strSQL1_4 = m_strSQL1_4 & " AND PA10<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
'      m_strSQL1_5 = m_strSQL1_5 & " AND PA10<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & " "
'   End If
'End If
'Modify by Amy 2017/12/26 Or 申請日Is Null拿掉
If Me.txt1(13).Text <> "" And Me.txt1(14).Text = "" Then
    'strSQL1 = strSQL1 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " ) Or PA10 Is Null ) "
    strSQL1 = strSQL1 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
    m_strSQL1_2 = m_strSQL1_2 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
    m_strSQL1_3 = m_strSQL1_3 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
    m_strSQL1_4 = m_strSQL1_4 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
    m_strSQL1_5 = m_strSQL1_5 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & strSrvDate(1) & " )  ) "
End If
If Me.txt1(13).Text = "" And Me.txt1(14).Text <> "" Then
    strSQL1 = strSQL1 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL1_2 = m_strSQL1_2 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL1_3 = m_strSQL1_3 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL1_4 = m_strSQL1_4 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
    m_strSQL1_5 = m_strSQL1_5 & " AND (PA10<=" & Val(ChangeTStringToWString(txt1(14))) & "  ) "
End If
If Me.txt1(13).Text <> "" And Me.txt1(14).Text <> "" Then
    strSQL1 = strSQL1 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL1_2 = m_strSQL1_2 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL1_3 = m_strSQL1_3 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL1_4 = m_strSQL1_4 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
    m_strSQL1_5 = m_strSQL1_5 & " AND ((PA10>=" & Val(ChangeTStringToWString(txt1(13))) & " And PA10<=" & Val(ChangeTStringToWString(txt1(14))) & " )  ) "
End If
'end 2017/12/26
'End
'申請國家
If Len(txt1(5)) <> 0 Then
    strSQL1 = strSQL1 + " AND PA09>='" & txt1(5) & "' "
    m_strSQL1_2 = m_strSQL1_2 + " AND PA09>='" & txt1(5) & "' "
    m_strSQL1_3 = m_strSQL1_3 + " AND PA09>='" & txt1(5) & "' "
    m_strSQL1_4 = m_strSQL1_4 + " AND PA09>='" & txt1(5) & "' "
    m_strSQL1_5 = m_strSQL1_5 + " AND PA09>='" & txt1(5) & "' "
End If
If Len(txt1(6)) <> 0 Then
    strSQL1 = strSQL1 + " AND PA09<='" & txt1(6) & "' "
    m_strSQL1_2 = m_strSQL1_2 + " AND PA09<='" & txt1(6) & "' "
    m_strSQL1_3 = m_strSQL1_3 + " AND PA09<='" & txt1(6) & "' "
    m_strSQL1_4 = m_strSQL1_4 + " AND PA09<='" & txt1(6) & "' "
    m_strSQL1_5 = m_strSQL1_5 + " AND PA09<='" & txt1(6) & "' "
End If
'add by nickc 2005/11/24 加入閉卷選擇
If ChkClose.Value <> vbChecked Then
    strSQL1 = strSQL1 + " AND (PA57<>'Y' or pa57 is null) "
    m_strSQL1_2 = m_strSQL1_2 + " AND (PA57<>'Y' or pa57 is null) "
    m_strSQL1_3 = m_strSQL1_3 + " AND (PA57<>'Y' or pa57 is null) "
    m_strSQL1_4 = m_strSQL1_4 + " AND (PA57<>'Y' or pa57 is null) "
    m_strSQL1_5 = m_strSQL1_5 + " AND (PA57<>'Y' or pa57 is null) "
End If

'Added by Morgan 2015/9/16 已閉卷或銷卷或核駁
If Check12.Value = vbChecked Then
   strSQL1 = strSQL1 + " AND (PA57||PA108 IS NOT NULL or pa16='2') "
    m_strSQL1_2 = m_strSQL1_2 + " AND (PA57||PA108 IS NOT NULL or pa16='2') "
    m_strSQL1_3 = m_strSQL1_3 + " AND (PA57||PA108 IS NOT NULL or pa16='2') "
    m_strSQL1_4 = m_strSQL1_4 + " AND (PA57||PA108 IS NOT NULL or pa16='2') "
    m_strSQL1_5 = m_strSQL1_5 + " AND (PA57||PA108 IS NOT NULL or pa16='2') "
End If

'Added by Morgan 2015/9/16 已閉卷或銷卷
If Check11.Value = vbChecked Then
   strSQL1 = strSQL1 + " AND PA57||PA108 IS NOT NULL "
    m_strSQL1_2 = m_strSQL1_2 + " AND PA57||PA108 IS NOT NULL "
    m_strSQL1_3 = m_strSQL1_3 + " AND PA57||PA108 IS NOT NULL "
    m_strSQL1_4 = m_strSQL1_4 + " AND PA57||PA108 IS NOT NULL "
    m_strSQL1_5 = m_strSQL1_5 + " AND PA57||PA108 IS NOT NULL "
End If
'end 2015/9/16

'Add by Morgan 2011/1/13 +只印申請案
If Check7.Value = vbChecked Then
   strSQL1 = strSQL1 + " AND pa23='1' "
   m_strSQL1_2 = m_strSQL1_2 + " AND pa23='1' "
   m_strSQL1_3 = m_strSQL1_3 + " AND pa23='1' "
   m_strSQL1_4 = m_strSQL1_4 + " AND pa23='1' "
   m_strSQL1_5 = m_strSQL1_5 + " AND pa23='1' "
End If

'Add by Morgan 2011/10/13 +只印已核准
If Check8.Value = vbChecked Then
   strSQL1 = strSQL1 + " AND pa16='1' "
   m_strSQL1_2 = m_strSQL1_2 + " AND pa16='1' "
   m_strSQL1_3 = m_strSQL1_3 + " AND pa16='1' "
   m_strSQL1_4 = m_strSQL1_4 + " AND pa16='1' "
   m_strSQL1_5 = m_strSQL1_5 + " AND pa16='1' "
End If

'Add by Morgan 2013/12/24 +只印未核准(核駁或申請中)
If Check9.Value = vbChecked Then
   strSQL1 = strSQL1 + " AND nvl(pa16,'2')='2' "
   m_strSQL1_2 = m_strSQL1_2 + " AND nvl(pa16,'2')='2' "
   m_strSQL1_3 = m_strSQL1_3 + " AND nvl(pa16,'2')='2' "
   m_strSQL1_4 = m_strSQL1_4 + " AND nvl(pa16,'2')='2' "
   m_strSQL1_5 = m_strSQL1_5 + " AND nvl(pa16,'2')='2' "
End If

'Add by Morgan 2008/4/9 +銷卷選擇
If Check6.Value <> vbChecked Then
   strSQL1 = strSQL1 + " AND pa108 is null "
   m_strSQL1_2 = m_strSQL1_2 + " AND pa108 is null "
   m_strSQL1_3 = m_strSQL1_3 + " AND pa108 is null "
   m_strSQL1_4 = m_strSQL1_4 + " AND pa108 is null "
   m_strSQL1_5 = m_strSQL1_5 + " AND pa108 is null "
End If

If UCase(txt1(7)) = "N" Then
    'Modify By Cheng 2003/09/08
    'Begin
'    '申請中的資料也要出來
'    strSQL1 = strSQL1 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
'    m_strSQL1_2 = m_strSQL1_2 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
'    m_strSQL1_3 = m_strSQL1_3 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
'    m_strSQL1_4 = m_strSQL1_4 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
'    m_strSQL1_5 = m_strSQL1_5 + " AND ( CP24<>'2' OR CP24 IS NULL ) "
    'End
    'C類核駁的資料不出現
    strSQL1 = strSQL1 + " AND '1002'<>CP10(+) "
    m_strSQL1_2 = m_strSQL1_2 + " AND '1002'<>CP10(+) "
    m_strSQL1_3 = m_strSQL1_3 + " AND '1002'<>CP10(+) "
    m_strSQL1_4 = m_strSQL1_4 + " AND '1002'<>CP10(+) "
    m_strSQL1_5 = m_strSQL1_5 + " AND '1002'<>CP10(+) "
End If
'是否含核駁
If Me.txt1(7).Text <> "" Then
    'edit by nickc 2008/04/15 所有程序抓 cp 期於抓pa
    If txt1(15) = "3" Then
        strSQL1 = strSQL1 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
        m_strSQL1_2 = m_strSQL1_2 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
        m_strSQL1_3 = m_strSQL1_3 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
        m_strSQL1_4 = m_strSQL1_4 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
        m_strSQL1_5 = m_strSQL1_5 + " AND ( cp24<>'2' OR cp24 IS NULL ) "
    Else
        strSQL1 = strSQL1 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
        m_strSQL1_2 = m_strSQL1_2 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
        m_strSQL1_3 = m_strSQL1_3 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
        m_strSQL1_4 = m_strSQL1_4 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
        m_strSQL1_5 = m_strSQL1_5 + " AND ( PA16<>'2' OR PA16 IS NULL ) "
    End If
End If

'Add by Morgan 2007/10/23
'已准的
'    strSQL1 = strSQL1 + " AND PA16='1' "
'    m_strSQL1_2 = m_strSQL1_2 + " AND PA16='1' "
'    m_strSQL1_3 = m_strSQL1_3 + " AND PA16='1' "
'    m_strSQL1_4 = m_strSQL1_4 + " AND PA16='1' "
'    m_strSQL1_5 = m_strSQL1_5 + " AND PA16='1' "

'已駁的
'    strSQL1 = strSQL1 + " AND PA16='2' "
'    m_strSQL1_2 = m_strSQL1_2 + " AND PA16='2' "
'    m_strSQL1_3 = m_strSQL1_3 + " AND PA16='2' "
'    m_strSQL1_4 = m_strSQL1_4 + " AND PA16='2' "
'    m_strSQL1_5 = m_strSQL1_5 + " AND PA16='2' "

'申請中的
'    strSQL1 = strSQL1 + " AND PA16 IS NULL "
'    m_strSQL1_2 = m_strSQL1_2 + " AND PA16 IS NULL "
'    m_strSQL1_3 = m_strSQL1_3 + " AND PA16 IS NULL "
'    m_strSQL1_4 = m_strSQL1_4 + " AND PA16 IS NULL "
'    m_strSQL1_5 = m_strSQL1_5 + " AND PA16 IS NULL "
'

'已閉卷的
'    strSQL1 = strSQL1 + " AND PA57 IS NOT NULL "
'    m_strSQL1_2 = m_strSQL1_2 + " AND PA57 IS NOT NULL "
'    m_strSQL1_3 = m_strSQL1_3 + " AND PA57 IS NOT NULL "
'    m_strSQL1_4 = m_strSQL1_4 + " AND PA57 IS NOT NULL "
'    m_strSQL1_5 = m_strSQL1_5 + " AND PA57 IS NOT NULL "


'Add by Morgan 2007/12/25
'只印仍有效的
If Check5.Value = 1 Then
    strSQL1 = strSQL1 + " AND ( PA25>=" & strSrvDate(1) & " OR PA25 IS NULL ) "
    m_strSQL1_2 = m_strSQL1_2 + " AND ( PA25>=" & strSrvDate(1) & " OR PA25 IS NULL ) "
    m_strSQL1_3 = m_strSQL1_3 + " AND ( PA25>=" & strSrvDate(1) & " OR PA25 IS NULL ) "
    m_strSQL1_4 = m_strSQL1_4 + " AND ( PA25>=" & strSrvDate(1) & " OR PA25 IS NULL ) "
    m_strSQL1_5 = m_strSQL1_5 + " AND ( PA25>=" & strSrvDate(1) & " OR PA25 IS NULL ) "
End If
'end 2007/12/25
    
'智權人員
If Me.txt1(11).Text <> "" Then
    strSQL1 = strSQL1 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_2 = m_strSQL1_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_3 = m_strSQL1_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_4 = m_strSQL1_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_5 = m_strSQL1_5 + " AND CU13='" & Me.txt1(11).Text & "' "
'Add By Cheng 2003/07/21
'若未輸入智權人員
Else
    strSQL1 = strSQL1 + " AND CU13 Is Null "
    m_strSQL1_2 = m_strSQL1_2 + " AND CU13 Is Null "
    m_strSQL1_3 = m_strSQL1_3 + " AND CU13 Is Null "
    m_strSQL1_4 = m_strSQL1_4 + " AND CU13 Is Null "
    m_strSQL1_5 = m_strSQL1_5 + " AND CU13 Is Null "
End If
'Add By Cheng 2004/04/19
'若選擇列印首次接洽或最新收文程序
If Me.txt1(15).Text = "1" Or Me.txt1(15).Text = "2" Then
    'Modify by Morgan 2005/5/16 若只有一道程序時取消的還是要印
'    strSQL1 = strSQL1 + " AND CP57 Is Null "
'    m_strSQL1_2 = m_strSQL1_2 + " AND CP57 Is Null "
'    m_strSQL1_3 = m_strSQL1_3 + " AND CP57 Is Null "
'    m_strSQL1_4 = m_strSQL1_4 + " AND CP57 Is Null "
'    m_strSQL1_5 = m_strSQL1_5 + " AND CP57 Is Null "
    strSQL1 = strSQL1 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
    m_strSQL1_2 = m_strSQL1_2 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
    m_strSQL1_3 = m_strSQL1_3 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
    m_strSQL1_4 = m_strSQL1_4 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
    m_strSQL1_5 = m_strSQL1_5 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL AND C.CP09<'B')" & _
      "))"
End If
'End
CheckOC
Select Case txt1(10)
Case 1 '中文報表
      '2005/6/6 MODIFY BY SONIA 各語法加入 PA04='00' 之控制
      If intPCaseKind = 專利 And intPWhere = 國外_CF Then
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            'Modify By Cheng 2003/11/25
            'B類收文的不續辦, 閉卷也要列印
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 " & _
               " AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 " & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 " & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 " & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 " & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
        End If
      Else
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            'Modify By Cheng 2003/11/25
            'B類收文的不續辦, 閉卷也要列印
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(na03,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND CP09<'B' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_5
        End If
      End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = LBound(strTemp) To UBound(strTemp)
                    strTemp(i) = ""
                Next i
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If Right(strTemp(16), 1) = "*" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = Replace(strTemp(16), "*", "閉卷")
                End If
                '申請日
                strTemp(23) = "" & .Fields(22).Value
                CheckOC2
                strSql = "select min(pd05) from pridate where pd01='" & CheckStr(.Fields(18)) & "' and pd02='" & CheckStr(.Fields(19)) & "' and pd03='" & CheckStr(.Fields(20)) & "' and pd04='" & CheckStr(.Fields(21)) & "' "
                adoRecordset1.CursorLocation = adUseClient
                adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                If adoRecordset1.RecordCount <> 0 Then
                     strTemp(24) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                Else
                     strTemp(24) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>411 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND np07 <> 6001 And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>305 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Cheng 2003/07/08
'                strSQL = "INSERT INTO R050317_C values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "') "
                'Modify By Cheng 2003/08/12
'                strSQL = "INSERT INTO R050317_C values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','" & "" & .Fields("CP57").Value & "') "
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 中文新增 R013028 存CP31
                strSql = "INSERT INTO R050317_C " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & PUB_GetRelateCasePropertyName(strTemp(17), Me.txt1(10).Text) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','" & "" & .Fields("CP57").Value & "',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
            'Modify by Amy 2017/07/25 更新R013028
            If IsHaveData = True Then
                strSql = "Update R050317_C Set R013028=(Select CP31 From CaseProgress Where R013018=CP09(+)) Where ID='" & strUserNum & "'"
                cnnConnection.Execute strSql
            End If
            'end 2017/07/25
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            '
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_c WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 2 '英文報表
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            strSql = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(na04,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "Closed"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>411 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>305 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
'                strSQL = "INSERT INTO R050317_E values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "') "
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_E " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 3 '日文報表
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            strSql = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
'            strSQL = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(na04,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'B' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
'            strSQL = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        End If
    CheckOC
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "ゾゆ"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>411 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'edit by nick 2004/09/20
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07<>305 AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
'                strSQL = "INSERT INTO R050317_J values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & " ','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "') "
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_J " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & " ','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case Else
End Select
'Add by Amy 2017/12/26 剔除D類
cnnConnection.Execute "Delete From R050317_C WHERE ID='" & strUserNum & "'  And SubStr(R013018,1,1)='D' "     '語文為中文      對內
cnnConnection.Execute "Delete From R050317_E WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為英文    對外
cnnConnection.Execute "Delete From R050317_J WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為日文   對外
'end 2017/12/26
Select Case txt1(10)
Case 1     '中文
    '列印所有程序
    If Me.txt1(15).Text = "3" Then
         PrintDataCp
    '列印首次或最新程序
    Else
         PrintDataCp_A4
    End If
Case 2     '英文
    PrintDataEp
Case 3     '日文
    PrintDataJp
Case Else
End Select
'Screen.MousePointer = vbDefault
ErrHnd:
   If Err.Number <> 0 Then MsgBox Err.Description, vbCritical
End Sub

Private Sub PrintDataCp_A4()
Dim strCust As String '記錄申請人
Dim strSystemKind As String '記錄系統類別
Dim blnFirstPage As Boolean '判斷是否第一頁
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String '申請人+本所案號

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True


On Error GoTo ErrHnd

'重整資料
''先刪除非A類收文資料
'strSQLA = "Delete From R050317_C Where ID='" & strUserNum & "' And R013018>'B' "
'cnnConnection.Execute strSQLA
'首次程序
If Me.txt1(15).Text = "1" Then
    'Modify By Cheng 2003/08/27
'    strSQLA = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, R013016 , R013018 "
    StrSQLa = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013001, R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
'最新程序
ElseIf Me.txt1(15).Text = "2" Then
    'Modify By Cheng 2003/07/18
'    strSQLA = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, R013016 Desc, R013018 Desc "
    'Modify By Cheng 2003/08/27
'    strSQLA = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, R013016 Desc, substr(R013018,1,1), R013018 Desc "
    StrSQLa = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013001, R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
End If
strCaseNo = " "
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
If rsA.RecordCount > 0 Then
    While Not rsA.EOF
        If strCaseNo <> "" & rsA("R013001").Value & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
            strCaseNo = "" & rsA("R013001").Value & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
        Else
            rsA.Delete
        End If
        rsA.MoveNext
    Wend
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing
'列印第一頁
blnFirstPage = True
'國內外分開列印(不同系統類別分開列印)
If txt1(8) = "Y" Then
    '修改排序方式申請人, 系統類別
    strSql = "SELECT DISTINCT R013001,R013019 FROM R050317_C WHERE ID='" & strUserNum & "' GROUP BY R013001,R013019 ORDER BY R013001,R013019 "
'國內外不分開列印(不管系統類別)
Else
    strSql = "SELECT DISTINCT R013001 FROM R050317_C WHERE ID='" & strUserNum & "' GROUP BY R013001 ORDER BY R013001 "
End If
CheckOC
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
    '頁數加一
    Page = Page + 1
    RefreshColData 1, "申請人"
    With adoRecordset
        .MoveFirst
        '記錄申請人
        strCust = "" & .Fields("R013001").Value
        '記錄系統類別
        If txt1(8) = "Y" Then
            strSystemKind = "" & .Fields("R013019").Value
        Else
            strSystemKind = ""
        End If
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields("R013001").Value)
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields("R013019").Value)
            Else
               strTemp(21) = ""
            End If
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU58,CU61 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 13
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            '若申請人不同則跳頁
            If strCust <> strTemp(20) Then
                strCust = strTemp(20)
                strSystemKind = strTemp(21)
                If txt1(8) = "Y" Then
                   strSystemKind = strTemp(21)
                Else
                   strSystemKind = ""
                End If
                Page = Page + 1
                'Add by Amy 2013/10/03 +Excel
                If Check10(1).Value = vbChecked Then
                    fn_SetExcel
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                Else
                    'add  by nickc 2005/11/03  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    PrintTitleCp_A4
                End If
            '若申請人相同
            Else
                '記錄系統類別
                If txt1(8) = "Y" Then
                    '若系統類別不同
                    If strSystemKind <> strTemp(21) Then
                        strSystemKind = strTemp(21)
                        Page = Page + 1
                        'Add by Amy 2013/10/03 +Excel
                        If Check10(1).Value = vbChecked Then
                             fn_SetExcel
                             fn_CreateExcel Page, strSystemKind, blnFirstPage
                        Else
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_DocNewPage
                            End If
                            PrintTitleCp_A4
                        End If
                    End If
                End If
            End If
            '若為第一頁才印表頭
            'Modify by Amy 2013/10/03 +Excel
            If blnFirstPage = True Then
                 If Check10(1).Value = vbChecked Then
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                 Else
                    PrintTitleCp_A4
                 End If
                 blnFirstPage = False
            End If
            '初始化本所案號變數
            SeekTempPrint = ""
            '國內外是否分開列印
            'Modify by Amy 2017/07/25 +R013028
            If txt1(8) = "Y" Then
                'edit by nickc 2008/04/15 所有程序抓cp 其餘抓pa
                If txt1(15) = "3" Then
                    strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007 ,R013028 From R050317_C,caseprogress WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' "
                Else
                    strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, pa16 as CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007 ,R013028 From R050317_C,caseprogress,patent WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' and cp01=pa01(+) and cp02=pa02(+) and cp03=pa03(+) and cp04=pa04(+) "
                End If
            Else
                'edit by nickc 2008/04/15 所有程序抓cp 其餘抓pa
                If txt1(15) = "3" Then
                    strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007 ,R013028 From R050317_C,caseprogress WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' "
                Else
                    strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, pa16 as CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007 ,R013028 From R050317_C,caseprogress,patent WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' and cp01=pa01(+) and cp02=pa02(+) and cp03=pa03(+) and cp04=pa04(+)  "
                End If
            End If
            'end 2017/07/25
            
            '依本所案號排序
            If Me.txt1(9).Text = "1" Then
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            '依申請國家+案件名稱排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    strTemp(0) = "" & adoRecordset1.Fields(0).Value
                        strTemp(1) = StrToStr("" & adoRecordset1.Fields(1).Value, 42)
                        strTemp(2) = "" & adoRecordset1.Fields(2).Value
                        strTemp(3) = StrToStr("" & adoRecordset1.Fields(3).Value, 10)
                        strTemp(4) = StrToStr("" & adoRecordset1.Fields(4).Value, 4) 'Modify By Amy 2013/10/13 原顯示3個字
                        strTemp(5) = StrToStr("" & adoRecordset1.Fields(5).Value, 6)
                        strTemp(6) = ""
                        strTemp(7) = ""
                        strTemp(8) = StrToStr("" & adoRecordset1.Fields(8).Value, 10)
                        strTemp(9) = StrToStr(GetNationName("" & adoRecordset1.Fields(9).Value, IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                        strTemp(10) = StrToStr("" & adoRecordset1.Fields(10).Value, 10)
                        strTemp(11) = IIf("" & adoRecordset1.Fields(11).Value = "1", "准", IIf("" & adoRecordset1.Fields(11).Value = "2", "駁", ""))
                        strTemp(12) = ""
                        strTemp(13) = ""
                        strTemp(14) = ""
                        strTemp(15) = ""
                        'Modify by Amy 2013/10/13 +往下搬
                        'GetPatentDuration "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                        strPriDate = "" 'Add by Amy 2017/07/25
                        
                    'Modify by Amy 2013/10/13 +if
                    If Check10(1).Value = vbChecked Then
                        'Add by Amy 2017/07/25 +優先權資料(所有格式只顯示於CP31=Y 那筆)
                        If Not (txt1(15) = "3" And "" & adoRecordset1("R013028") <> "Y") Then
                            PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                        End If
                        GetPatentDuration "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value, False
                        '抓 發明人 及 最新案件進度
                        strInventor = GetInventor(adoRecordset1.Fields("R013022").Value, adoRecordset1.Fields("R013023").Value, adoRecordset1.Fields("R013024").Value, adoRecordset1.Fields("R013025").Value)
                        strTemp(2) = ChangeTStringToWDateString(ChangeTDateStringToTString(strTemp(2))) '申請日
                        'Modify by Amy 2017/07/25 +優先權資料
                        If txt1(15) = "2" Then
                            CaseProgress_NewA = StrToStr(strTemp(5), 6)
                            'Excel資料(依顯示順序) Modify by Amy 2013/11/04 strTemp(7)改strxlstp(5)/strTemp(15)改strxlstp(6)
                            strXlsData = "$$" & strTemp(0) & "$$" & strXlsTp(0) & "$$" & strTemp(8) & "$$" & strTemp(1) & "$$" & _
                                               strInventor & "$$" & strTemp(2) & "$$" & strTemp(9) & "$$" & strTemp(3) & "$$" & strTemp(10) & "$$" & _
                                               strTemp(4) & "$$" & strTemp(11) & "$$" & strTemp(5) & "$$" & strXlsTp(1) & "$$" & strXlsTp(2) & "$$" & _
                                               strXlsTp(3) & IIf(Len(strXlsTp(4)) > 0, Chr(10) & strXlsTp(4), "") & "$$" & strXlsTp(5) & IIf(Len(strXlsTp(6)) > 0, Chr(10) & "(" & StrToStr(strXlsTp(6), 6) & ")", "") & _
                                                "$$" & strPriDate
                        Else
                            'Modify by Amy 2021/05/20 申請國家可能為空值 ex:CFP-007198
                            CaseProgress_NewA = StrToStr(GetCaseProgress_NewA("" & adoRecordset1.Fields("R013005").Value, adoRecordset1.Fields("R013022").Value, adoRecordset1.Fields("R013023").Value, adoRecordset1.Fields("R013024").Value, adoRecordset1.Fields("R013025").Value), 6)
                            'Excel資料(依顯示順序) Modify by Amy 2013/11/04 strTemp(7)改strxlstp(5)/strTemp(15)改strxlstp(6)
                            strXlsData = "$$" & strTemp(0) & "$$" & strXlsTp(0) & "$$" & strTemp(8) & "$$" & strTemp(1) & "$$" & _
                                               strInventor & "$$" & strTemp(2) & "$$" & strTemp(9) & "$$" & strTemp(3) & "$$" & strTemp(10) & "$$" & _
                                               strTemp(4) & "$$" & strTemp(11) & "$$" & strTemp(5) & "$$" & strXlsTp(1) & "$$" & strXlsTp(2) & "$$" & _
                                               strXlsTp(3) & IIf(Len(strXlsTp(4)) > 0, Chr(10) & strXlsTp(4), "") & "$$" & CaseProgress_NewA & "$$" & strXlsTp(5) & IIf(Len(strXlsTp(6)) > 0, Chr(10) & "(" & StrToStr(strXlsTp(6), 6) & ")", "") & _
                                              "$$" & strPriDate
                        End If
                        'end 2017/07/25

                        fn_PutExcel "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                    
                    '不是勾選Excel
                    Else
                        GetPatentDuration "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                        'edit by nickc 2005/11/11
                        'If iPrint >= 10000 Then
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                'Modified by Morgan 2013/6/24
                                'Printer.Line (0, iPrint)-(16000, iPrint)
                                Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)

                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                                fn_DocNewPage
                            End If
                            PrintTitleCp_A4
                        End If
                        '列印明細資料
                        PrintDatilCp_A4
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_DocNewPage
                            End If
                            PrintTitleCp_A4
                        End If
                        'Modify by Amy 2017/07/25 +FunctionName
                        PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value, "PrintTitleCp_A4"
                        'edit by nickc 2005/11/11
                        'If iPrint >= 10000 Then
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                'Modified by Morgan 2013/6/24
                                'Printer.Line (0, iPrint)-(16000, iPrint)
                                Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)

                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                                fn_DocNewPage
                            End If
                            PrintTitleCp_A4
                        Else
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.CurrentX = PLeft(0)
                                Printer.CurrentY = iPrint
                                'Modified by Morgan 2013/6/24
                                'Printer.Print String(220, "-")
                                Printer.Print String(160, "-")
                                iPrint = iPrint + 300
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                            End If
                            'edit by nickc 2005/11/11
                            'If iPrint >= 10000 Then
                            If iPrint >= o_PaperHeight Then
                                Page = Page + 1
                                'add  by nickc 2005/11/03  紙本
                                If Check3(0).Value = vbChecked Then
'                                   Printer.Line (0, iPrint)-(16000, iPrint)
                                    Printer.NewPage
                                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                    fn_DocNewPage
                                End If
                                PrintTitleCp_A4
                            End If
                        End If
                    End If 'end 2013/10/13
                    adoRecordset1.MoveNext
                Loop
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
'                   Printer.Line (0, iPrint)-(16000, iPrint)
'                   iPrint = iPrint + 100
                    'edit by nickc 2005/11/11
                    'If iPrint >= 10000 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/03  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_DocNewPage
                        End If
                        PrintTitleCp_A4
                    End If
                End If
                
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                    IntTot = AdoRecordSet3.RecordCount
                End If
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/03  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(5)
                        Printer.CurrentY = iPrint
                        Printer.Print "總計：" & Format(IntTot, "##0")
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 54.5) & "總計：" & Format(IntTot, "##0"), 69), , , 10
                    End If
                End If
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                    IntTot = AdoRecordSet3.RecordCount
                End If
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/03  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(13)
                        Printer.CurrentY = iPrint
                        Printer.Print "閉卷件數：" & Format(IntTot, "##0")
                        iPrint = iPrint + 300
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt("閉卷件數：" & Format(IntTot, "##0"), 11), , , 10, False
                    End If
                End If
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
    If adoRecordset.RecordCount > 0 And Check10(1).Value = vbChecked Then 'Add by Amy 2013/10/03
        fn_SetExcel '設定最後一個sheet 的Excel格式
    End If
End If
CheckOC
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
ErrHnd:
   If Err.Number <> 0 Then
      MsgBox Err.Description, vbCritical
   End If
End Sub

'Add By Cheng 2003/07/08
Private Sub PrintTitleCp_A4()
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    GetPleftCp_A4
    iPrint = 500
    Printer.Font.Size = 22
    Printer.Font.Bold = True
    Printer.Font.Underline = True
    Printer.FontName = "細明體"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "客戶" & IIf(Check4(0).Value = vbChecked, "群組", "") & "案件總簿"
    Printer.Font.Bold = False
    Printer.Font.Underline = False
    iPrint = iPrint + 500
    Printer.Font.Size = 16
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "　　（專利）"
    Printer.Font.Size = 10
    iPrint = iPrint + 500
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "列印日期：" & ChangeTStringToTDateString(strSrvDate(2))
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "收件人："
    If Len(StrTemp5(12)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(12)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(13)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(13)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(0)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(0)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(1)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(1)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(2)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(2)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(3)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(3)
       iPrint = iPrint + 300
    End If
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint - 300
    
    Printer.Print "電話：" & StrTemp5(5)
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "地址：" & StrTemp5(4)
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    
    Printer.Print "E-mail：" & StrTemp5(7)
    
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "Page：" & str(Page)
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(6)
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    
    Printer.Print "傳真：" & StrTemp5(9)
    
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(8)
    Printer.CurrentX = PLeft(2) 'edit by nickc 2005/11/18 PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "預設接洽人：" & GetCU08(strTemp(20)) 'Modify by Amy 2019/08/29 原:接洽人-秀玲
    Printer.CurrentX = PLeft(4) 'edit by nickc 2005/11/18 PLeft(2)
    Printer.CurrentY = iPrint
    
    Printer.Print "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True)
    
    iPrint = iPrint + 300
    If Len(StrTemp5(10)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(10)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(11)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(11)
       iPrint = iPrint + 300
    End If
    'Modified by Morgan 2013/6/24
    'Printer.Line (0, iPrint)-(16000, iPrint)
    Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
    iPrint = iPrint + 100
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "本所案號"
    Printer.CurrentX = PLeft(1)
    Printer.CurrentY = iPrint
    Printer.Print "專利名稱"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "申請日"
    Printer.CurrentX = PLeft(3)
    Printer.CurrentY = iPrint
    Printer.Print "申請案號"
    Printer.CurrentX = PLeft(4)
    Printer.CurrentY = iPrint
    Printer.Print "種類"
    Printer.CurrentX = PLeft(5)
    Printer.CurrentY = iPrint
    Printer.Print "案件性質"
    Printer.CurrentX = PLeft(6)
    Printer.CurrentY = iPrint
    Printer.Print "專　用　期　限"
    Printer.CurrentX = PLeft(7)
    Printer.CurrentY = iPrint
    Printer.Print "最近期限"
    iPrint = iPrint + 300
    
    Printer.CurrentX = PLeft(8)
    Printer.CurrentY = iPrint
    Printer.Print "客戶案件案號"
    Printer.CurrentX = PLeft(9)
    Printer.CurrentY = iPrint
    Printer.Print "申請國家"
    Printer.CurrentX = PLeft(10)
    Printer.CurrentY = iPrint
    Printer.Print "專利號數"
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print "准駁"
    Printer.CurrentX = PLeft(12)
    Printer.CurrentY = iPrint
    Printer.Print "下次繳費日"
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "(年度)"
    Printer.CurrentX = PLeft(14)
    Printer.CurrentY = iPrint
    Printer.Print "閉卷"
    Printer.CurrentX = PLeft(15)
    Printer.CurrentY = iPrint
    Printer.Print "(程序)"
    iPrint = iPrint + 300
    'Modified by Morgan 2013/6/24
    'Printer.Line (0, iPrint)-(16000, iPrint)
    Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)

    iPrint = iPrint + 100
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If blnWordNewPage = True And Page <> 1 Then
        fn_DocNewPage
    End If
    blnWordNewPage = False
    Dim isPrintDate As Boolean
    Dim o_tmp1 As String
    Dim o_tmp2 As String
    Dim o_tmp3 As String
    Dim o_tmp4 As String
    Dim o_tmp5 As String
    Dim o_tmp6 As String
    iPrint = 0
    o_tmp1 = StrTemp5(12)
    o_tmp2 = StrTemp5(13)
    o_tmp3 = StrTemp5(0)
    o_tmp4 = StrTemp5(1)
    o_tmp5 = StrTemp5(2)
    o_tmp6 = StrTemp5(3)
    If Len(CheckStr(o_tmp6)) <> 0 Then
        If Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            o_tmp6 = fn_StrToWordFmt("收件人：" & o_tmp6, 29) & "電話：" & StrTemp5(5)
        Else
            o_tmp6 = fn_StrToWordFmt("　　　：" & o_tmp6, 29) & "電話：" & StrTemp5(5)
        End If
    End If
    If Len(CheckStr(o_tmp5)) <> 0 Then
        If Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp4)) <> 0 Then
        If Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp3)) <> 0 Then
        If Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp2)) <> 0 Then
        If Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp1)) <> 0 Then
        If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) = 0 Then
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 29) & "電話：" & StrTemp5(5)
        Else
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 29)
        End If
    End If
    isPrintDate = False
    'g_WordAp.
    fn_PutWords "客戶" & IIf(Check4(0).Value = vbChecked, "群組", "") & "案件總簿", wdAlignParagraphCenter, "細明體", 22, False, True, True
    fn_PutWords "（專利）", wdAlignParagraphCenter, , 16
    If Len(o_tmp1) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp1, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp1, 80), , , 10
        End If
    End If
    If Len(o_tmp2) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp2, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp2, 80), , , 10
        End If
    End If
    If Len(o_tmp3) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp3, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp3, 80), , , 10
        End If
    End If
    If Len(o_tmp4) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp4, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp4, 80), , , 10
        End If
    End If
    If Len(o_tmp5) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp5, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp5, 80), , , 10
        End If
    End If
    If Len(o_tmp6) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp6, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp6, 80), , , 10
        End If
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("地址：" & StrTemp5(4), 29) & "E-mail：" & StrTemp5(7), 69) & "Page：" & str(Page), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(6), 29) & "傳真：" & StrTemp5(9), 69), , , 10
    'Modify by Amy 2019/08/29 原:接洽人-秀玲
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(8), 29) & "預設接洽人：" & GetCU08(strTemp(20)), 47.5) & "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True), 69), , , 10
    If Len(StrTemp5(10)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(10), 29), , , 10
    End If
    If Len(StrTemp5(11)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(11), 29), , , 10
    End If
    fn_PutWords fn_StrLineToWord("="), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("本所案號", 11) & fn_StrToWordFmt("專利名稱", 18) & fn_StrToWordFmt("申請日", 7) & fn_StrToWordFmt("申請案號", 11) & fn_StrToWordFmt("種類", 5) & fn_StrToWordFmt("案件性質", 7) & fn_StrToWordFmt("專　用　期　限", 12) & "最近期限", 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("客戶案件案號", 29) & fn_StrToWordFmt("申請國家", 7) & fn_StrToWordFmt("專利號數", 11) & fn_StrToWordFmt("准駁", 12) & fn_StrToWordFmt("下次繳費日", 5) & fn_StrToWordFmt("(年度)", 4) & fn_StrToWordFmt("閉卷", 3) & "(程序)", 80), , , 10
    fn_PutWords fn_StrLineToWord("="), , , 10
End If
End Sub

'Add By Cheng 2003/07/08
Private Sub GetPleftCp_A4()
Dim iLeftMargin As Integer
'Added by Morgan 2013/6/24
If Printer.ScaleMode = 1 And Printer.Width - Printer.ScaleWidth < 600 Then
   iLeftMargin = 300
End If

Erase PLeft
'第一行
PLeft(0) = iLeftMargin + 0 '本所案號
PLeft(1) = iLeftMargin + 2100 '專利名稱
PLeft(2) = iLeftMargin + 6300 '申請日
PLeft(3) = iLeftMargin + 7600 '申請案號
PLeft(4) = iLeftMargin + 9800 '種類
PLeft(5) = iLeftMargin + 10700 '案件性質
PLeft(6) = iLeftMargin + 12100 '專用期限
PLeft(7) = iLeftMargin + 14500 '最近期限
'第二行
PLeft(8) = iLeftMargin + 0 '客戶案件案號
PLeft(9) = iLeftMargin + 6300 '申請國家
PLeft(10) = iLeftMargin + 7600 '專利號數
PLeft(11) = iLeftMargin + 9800 '准駁
PLeft(12) = iLeftMargin + 12100 '下次繳費日
PLeft(13) = iLeftMargin + 13100 '(年度)
PLeft(14) = iLeftMargin + 13900 '閉卷
PLeft(15) = iLeftMargin + 14600 '(程序)
End Sub

'取得專利專用期限
'Modify By Amy 2013/10/03 +Optional IsNextPayDate(下次繳費日) As Boolean = True
Private Sub GetPatentDuration(strCaseNo1 As String, strCaseNo2 As String, StrCaseNo3 As String, strCaseNo4 As String, Optional IsNextPayDate As Boolean = True)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim StrSqlB As String
Dim rsB As New ADODB.Recordset
Dim arrYearPay
Dim arrYearPaySet
Dim ii As Integer
'Dim arrPA73 'Add by Amy 2013/11/28
Dim strTp As String 'Add by Amy 2013/11/28  +最後費(年度) 繳多年起始年的陣列位置

'Modify by Amy 2013/10/03 +PA73 for Excel
StrSQLa = "Select PA24, PA25, PA57, PA72, PA08, NA21, NA23, NA25,pa09,pa21,PA73 From Patent, Nation Where PA09=NA01 And " & ChgPatent(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4)
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
If rsA.RecordCount > 0 Then
    'Modify by Amy 2013/10/03 +if 下次繳費日
    If IsNextPayDate Then
        strTemp(6) = ChangeWStringToWDateString("" & rsA("PA24").Value) & "-" & ChangeWStringToWDateString("" & rsA("PA25").Value)
        strTemp(14) = IIf("" & rsA("PA57").Value = "Y", "＊", "")
    
        '取得「下次」繳費日(年度)
        If ("" & rsA("PA08").Value = "1" And "" & rsA("NA21").Value <> "") Or ("" & rsA("pa08").Value = "2" And "" & rsA("NA23").Value <> "") Or ("" & rsA("pa08").Value = "3" And "" & rsA("NA25").Value <> "") Then
            '若有繳年費記錄
            If "" & rsA("PA72").Value <> "" Then
                arrYearPay = Split("" & rsA("PA72").Value, ",")
                If "" & rsA("PA08").Value = "1" Then
                    arrYearPaySet = Split("" & rsA("NA21").Value, ",")
                ElseIf rsA("PA08").Value = "2" Then
                    arrYearPaySet = Split("" & rsA("NA23").Value, ",")
                     '2005/6/13 ADD BY SONIA 台灣發證日930701以前專用期12年
                    If rsA("PA09").Value = "000" And rsA("PA21").Value <> "" Then
                        If rsA("PA21").Value < "20040701" Then
                            arrYearPaySet = Split("1,2,3,4,5,6,7,8,9,10,11,12", ",")
                        End If
                    End If
                     '2005/6/13 END
                Else
                    arrYearPaySet = Split("" & rsA("NA25").Value, ",")
                End If
                For ii = LBound(arrYearPaySet) To UBound(arrYearPaySet)
                    If Val(arrYearPaySet(ii)) > Val(arrYearPay(UBound(arrYearPay))) Then
                        strTemp(13) = "(" & arrYearPaySet(ii) & ")"
                        Exit For
                    Else
                        strTemp(13) = ""
                    End If
                Next ii
            '若尚未繳年費
            Else
                If "" & rsA("PA08").Value = "1" And "" & rsA("NA21").Value <> "" Then
                    arrYearPaySet = Split("" & rsA("NA21").Value, ",")
                    strTemp(13) = "(" & arrYearPaySet(LBound(arrYearPaySet)) & ")"
                ElseIf rsA("PA08").Value = "2" And "" & rsA("NA23").Value <> "" Then
                    arrYearPaySet = Split("" & rsA("NA23").Value, ",")
                    strTemp(13) = "(" & arrYearPaySet(LBound(arrYearPaySet)) & ")"
                ElseIf rsA("PA08").Value = "3" And "" & rsA("NA25").Value <> "" Then
                    arrYearPaySet = Split("" & rsA("NA25").Value, ",")
                    strTemp(13) = "(" & arrYearPaySet(LBound(arrYearPaySet)) & ")"
                End If
            End If
            StrSqlB = "Select Min(NP08) From NextProgress Where " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & " And NP07 In (605,606,607) And NP06 Is Null And NP08>=" & strSrvDate(1)
            rsB.CursorLocation = adUseClient
            rsB.Open StrSqlB, cnnConnection, adOpenStatic, adLockReadOnly
            If rsB.RecordCount > 0 Then
                strTemp(12) = ChangeTStringToTDateString(ChangeWStringToTString("" & rsB.Fields(0).Value))
            End If
            If rsB.State <> adStateClosed Then rsB.Close
            Set rsB = Nothing
            If strTemp(12) = "" Then strTemp(13) = ""
        End If
        
        '2005/4/14 modify by sonia
        'strSQLB = "Select Min(NP08), Decode(PA09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Patent Where NP02=CPM01 And NP07=CPM02 And NP02=PA01 And NP03=PA02 And NP04=PA03 And NP05=PA04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (605,606,607,411) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(PA09,'000',CPM03,CPM04) "
        'Modify by Morgan 2009/7/13 +995,996
        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
        'StrSqlB = "Select Min(NP08), Decode(PA09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Patent Where NP02=CPM01 And NP07=CPM02 And NP02=PA01 And NP03=PA02 And NP04=PA03 And NP05=PA04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (605,606,607,411,997,998,995,996,999,1204,1503,1601) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(PA09,'000',CPM03,CPM04) "
        StrSqlB = "Select Min(NP08), Decode(PA09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Patent Where NP02=CPM01 And NP07=CPM02 And NP02=PA01 And NP03=PA02 And NP04=PA03 And NP05=PA04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & " And NP07 Not In (605,606,607) " & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(PA09,'000',CPM03,CPM04) "
        '2005/4/14 end
        rsB.CursorLocation = adUseClient
        rsB.Open StrSqlB, cnnConnection, adOpenStatic, adLockReadOnly
        If rsB.RecordCount > 0 Then
            strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString("" & rsB.Fields(0).Value))
            strTemp(15) = "" & rsB.Fields(1).Value
        End If
        If rsB.State <> adStateClosed Then rsB.Close
        Set rsB = Nothing
    
    Else '取得「最後」繳費日(年度)
        For ii = 0 To UBound(strXlsTp)
            strXlsTp(ii) = ""
        Next ii
        
        strXlsTp(0) = IIf("" & rsA("PA57").Value = "Y", "閉卷", "")
        strXlsTp(1) = ChangeWStringToWDateString("" & rsA("PA24").Value)
        strXlsTp(2) = ChangeWStringToWDateString("" & rsA("PA25").Value)
        
        If Not IsNull(rsA.Fields("PA73")) Then
            arrYearPay = Split("" & rsA("PA73").Value, ",")
            strXlsTp(3) = ChangeTStringToTDateString(ChangeWStringToTString("" & arrYearPay(UBound(arrYearPay))))
            
            'Add by Amy 2013/11/28 +最後費(年度) 繳多年起始年
            strTp = ""
            If UBound(arrYearPay) > 0 Then
                For ii = UBound(arrYearPay) To 1 Step -1
                   If Val(arrYearPay(ii)) <> Val(arrYearPay(ii - 1)) Then
                       If ii <> UBound(arrYearPay) Then
                            strTp = ii
                       End If
                       Exit For
                   ElseIf ii = 1 Then
                       strTp = "0"
                   End If
                Next ii
            End If
            'end 2013/11/28
            If Not IsNull(rsA.Fields("PA72")) Then
                arrYearPay = Split("" & rsA("PA72").Value, ",")
                strXlsTp(4) = "(" & IIf(strTp <> "", arrYearPay(Val(strTp)) & "-", "") & arrYearPay(UBound(arrYearPay)) & ")" '2013/11/28 +IIf
            End If
        End If
        
        'Add by Amy 2013/11/04 不剔除605,606,607 但閉卷不抓(因word 有抓下次繳費日(年度)所以最近期限才剔除605,606,607)
        StrSqlB = "Select Min(NP08), Decode(PA09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Patent Where NP02=CPM01 And NP07=CPM02 And NP02=PA01 And NP03=PA02 And NP04=PA03 And NP05=PA04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & " And PA57 is null " & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(PA09,'000',CPM03,CPM04) "
      
        rsB.CursorLocation = adUseClient
        rsB.Open StrSqlB, cnnConnection, adOpenStatic, adLockReadOnly
        If rsB.RecordCount > 0 Then
            strXlsTp(5) = ChangeTStringToTDateString(ChangeWStringToTString("" & rsB.Fields(0).Value))
            strXlsTp(6) = "" & rsB.Fields(1).Value
        End If
        If rsB.State <> adStateClosed Then rsB.Close
        Set rsB = Nothing
    End If
    'end 2013/10/23
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing

End Sub

'Add By Cheng 2003/07/08
Private Sub PrintDatilCp_A4()
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    For i = 0 To 7
       If i = 0 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print Replace(strTemp(i), "*", "＊")
       ElseIf i = 1 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print Mid(strTemp(i), 1, 21)
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint + 300
          Printer.Print Mid(strTemp(i), 22, 21)
       Else
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print strTemp(i)
       End If
    Next i
    iPrint = iPrint + 300
    For i = 8 To 14
       Printer.CurrentX = PLeft(i)
       Printer.CurrentY = iPrint
       Printer.Print strTemp(i)
    Next i
    If strTemp(15) <> "" Then
       Printer.CurrentX = PLeft(15) - 300
       Printer.CurrentY = iPrint
       Printer.Print "(" & Left(strTemp(15) & "　　　　　　", 6) & ")"
    End If
    iPrint = iPrint + 300
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(Replace(strTemp(0), "*", "＊"), 11) & fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18) & fn_StrToWordFmt(strTemp(2), 7) & fn_StrToWordFmt(strTemp(3), 11) & fn_StrToWordFmt(strTemp(4), 5) & fn_StrToWordFmt(strTemp(5), 7) & fn_StrToWordFmt(strTemp(6), 12) & strTemp(7), 80), , , 10
    If iPrint >= o_PaperHeight Then
        Page = Page + 1
        'add  by nickc 2005/11/15  紙本
        If Check3(0).Value = vbChecked Then
            'Printer.Line (0, iPrint)-(16000, iPrint)
            Printer.NewPage
        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
            'fn_PutWords fn_StrLineToWord, , , 10
            fn_DocNewPage
        End If
        PrintTitleCp_A4
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Replace(strTemp(1), Trim(Replace(fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18), "　", "")), ""), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(11), 12) & fn_StrToWordFmt(strTemp(12), 5) & fn_StrToWordFmt(strTemp(13), 4) & fn_StrToWordFmt(strTemp(14), 3) & IIf(strTemp(15) <> "", "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", ""), 80), , , 10
End If
End Sub

Private Function GetCU08(strCU0102 As String) As String
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset

strCU0102 = Left(strCU0102 & "00000000", 9)
'Modify by Morgan 2008/7/24 接洽人改先用聯絡人編號抓聯絡人檔
'Modify by Morgan 2009/11/23 接洽人不再抓舊欄位否則以刪除仍會印出
'StrSQLa = "Select nvl(pcc05,CU08) From Customer,potcustcont Where CU01='" & Mid(strCU0102, 1, 8) & "' And CU02='" & Mid(strCU0102, 9, 1) & "' and pcc01(+)=cu01 and pcc02(+)=cu127"
StrSQLa = "Select pcc05 From Customer,potcustcont Where CU01='" & Mid(strCU0102, 1, 8) & "' And CU02='" & Mid(strCU0102, 9, 1) & "' and pcc01(+)=cu01 and pcc02(+)=cu127"
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
If rsA.RecordCount > 0 Then
    GetCU08 = "" & rsA.Fields(0).Value
Else
    GetCU08 = ""
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing

End Function

'取得優先權資料
Private Sub PrintPriDate(strPD01 As String, strPD02 As String, strPD03 As String, strPD04 As String, Optional ByVal stFunction As String = "")
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strPrintText As String
'Add by Amy 2017/07/25
Dim strTp As String, strTp2 As String, intMax As Integer, IsFirst As Boolean

strPrintText = "": strTp = "": strTp2 = "": intMax = 0: IsFirst = True
'Modify by Morgan 2009/10/7 要判斷已有優先權號(CFP會先輸國內案號等有申請號後才會更新)
StrSQLa = "Select * From PriDate, Nation Where PD07=NA01 And PD01='" & strPD01 & "' And PD02='" & strPD02 & "' And PD03 ='" & strPD03 & "' And PD04='" & strPD04 & "' AND PD05>0 Order By PD05, PD07 "
If rsA.State <> adStateClosed Then rsA.Close
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
'Modify by Amy 2017/07/25 +PD06
If rsA.RecordCount > 0 Then
    If Check3(0).Value = vbChecked Or Check10(0).Value = vbChecked Then
        intMax = 80 '換行字數
    End If
    
    While Not rsA.EOF
        'Excel
        If Check10(1).Value = vbChecked Then
            strPrintText = ";" & ChangeTStringToTDateString(ChangeWStringToTString(rsA("PD05").Value)) & " " & rsA.Fields("PD06") & " " & rsA("NA03").Value
        '非Excel
        Else
            strTp2 = ChangeTStringToTDateString(ChangeWStringToTString(rsA("PD05").Value)) & " " & rsA.Fields("PD06") & " " & rsA("NA03").Value
            '加入換行 Tag
            If strTp <> MsgText(601) Then
                If LenB(StrConv(Replace(strTp & "  　　　　　　" & strTp2, "<Enter>  　　　　　　;", ""), vbFromUnicode)) + 8 > 2 * intMax Then
                    strPrintText = strPrintText & strTp & ";<Enter>  　　　　　　"
                    strTp = ""
                End If
            End If
            
            If IsFirst = True Then
                strTp = ";[優先權資料]：" & strTp2
                IsFirst = False
            Else
                strTp = strTp & ";" & strTp2
            End If
            
        End If
        rsA.MoveNext
    Wend
    '最後一筆
    If Check10(1).Value <> vbChecked Then strPrintText = Replace(strPrintText & strTp, ";<Enter>  　　　　　　;", ";<Enter>  　　　　　　")
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing

    '若有優先權資料
    If strPrintText <> "" Then
        strPrintText = Mid(strPrintText, 2)
        'Excel
        If Check10(1).Value = vbChecked Then
             strPriDate = strPrintText
             Exit Sub
        '紙本 or Word
        Else
            '不需換行
            If InStr(strPrintText, "<Enter>") = 0 Then
                'add by nickc 2005/11/11 紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(0)
                    Printer.CurrentY = iPrint
                    Printer.Print strPrintText
                    iPrint = iPrint + 300
                'Word
                Else
                     fn_PutWords fn_StrToWordFmt(strPrintText, intMax), , , 10
                End If
                Exit Sub
            '需換行
            Else
                strTp = strPrintText
                While Len(Trim(strTp)) > 0
                    strPrintText = Mid(strTp, 1, IIf(InStr(strTp, "<Enter>") > 0, InStr(strTp, "<Enter>") + 6, Len(strTp)))
                    
                    '紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(0)
                        Printer.CurrentY = iPrint
                        Printer.Print Replace(strPrintText, "<Enter>", "")
                        iPrint = iPrint + 300
                    'Word
                    Else
                        fn_PutWords fn_StrToWordFmt(Replace(strPrintText, "<Enter>", ""), intMax), , , 10
                    End If
                    
                    strTp = Replace(strTp, strPrintText, "")
                    
                    '判斷是否換頁
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        Else
                            fn_DocNewPage
                        End If
                        Select Case stFunction
                            Case "PrintTitleCt_A4"
                                Call PrintTitleCt_A4
                            Case "PrintTitleCp_A4"
                                Call PrintTitleCp_A4
                            Case "PrintTitleCo_A4"
                                Call PrintTitleCo_A4
                        End Select
                    End If
                Wend
                
            End If
        End If
    End If
End If
'end 2017/07/25

End Sub

'Add By Cheng 2003/07/08
'Modify by Amy +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintTitleCo_A4(Optional ByVal IsLawOnly As Boolean = False)
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    GetPleftCo_A4
    iPrint = 500
    Printer.Font.Size = 22
    Printer.Font.Bold = True
    Printer.Font.Underline = True
    Printer.FontName = "細明體"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "客戶案件總簿"
    Printer.Font.Bold = False
    Printer.Font.Underline = False
    iPrint = iPrint + 500
    Printer.Font.Size = 16
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    'Modify by Amy 2020/04/01 +if
    If IsLawOnly = True Then
        Printer.Print "　　（法務）"
    Else
        Printer.Print "　　（其他）"
    End If
    Printer.Font.Size = 10
    iPrint = iPrint + 500
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "列印日期：" & ChangeTStringToTDateString(strSrvDate(2))
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "收件人："
    If Len(StrTemp5(12)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(12)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(13)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(13)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(0)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(0)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(1)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(1)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(2)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(2)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(3)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(3)
       iPrint = iPrint + 300
    End If
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint - 300
    
    Printer.Print "電話：" & StrTemp5(5)
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "地址：" & StrTemp5(4)
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    
    Printer.Print "E-mail：" & StrTemp5(7)
    
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "Page：" & str(Page)
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(6)
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    
    Printer.Print "傳真：" & StrTemp5(9)
    
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(8)
    Printer.CurrentX = PLeft(2) 'edit by nickc 2005/11/18 PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "預設接洽人：" & GetCU08(strTemp(20)) 'Modify by Amy 2019/08/29 原:接洽人-秀玲
    Printer.CurrentX = PLeft(4) 'edit by nickc 2005/11/18 PLeft(2)
    Printer.CurrentY = iPrint
    
    Printer.Print "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True)
    
    iPrint = iPrint + 300
    If Len(StrTemp5(10)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(10)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(11)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(11)
       iPrint = iPrint + 300
    End If
    'Modified by Morgan 2013/6/24
    'Printer.Line (0, iPrint)-(16000, iPrint)
    Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
    
    iPrint = iPrint + 100
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "本所案號"
    Printer.CurrentX = PLeft(1)
    Printer.CurrentY = iPrint
    Printer.Print "案件名稱"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "申請日"
    Printer.CurrentX = PLeft(3)
    Printer.CurrentY = iPrint
    Printer.Print "申請案號"
    Printer.CurrentX = PLeft(4)
    Printer.CurrentY = iPrint
    Printer.Print "種類"
    Printer.CurrentX = PLeft(5)
    Printer.CurrentY = iPrint
    Printer.Print "案件性質"
    Printer.CurrentX = PLeft(6)
    Printer.CurrentY = iPrint
    Printer.Print "專　用　期　限"
    Printer.CurrentX = PLeft(7)
    Printer.CurrentY = iPrint
    Printer.Print "最近期限"
    iPrint = iPrint + 300
    
    Printer.CurrentX = PLeft(8)
    Printer.CurrentY = iPrint
    Printer.Print "客戶案件案號"
    Printer.CurrentX = PLeft(9)
    Printer.CurrentY = iPrint
    Printer.Print "申請國家"
    Printer.CurrentX = PLeft(10)
    Printer.CurrentY = iPrint
    Printer.Print "審定號數"
    'Printer.CurrentX = PLeft(11)
    'Printer.CurrentY = iPrint
    'Printer.Print "准駁"
    Printer.CurrentX = PLeft(12)
    Printer.CurrentY = iPrint
    Printer.Print "條碼廠商號碼"
    'Printer.CurrentX = PLeft(13)
    'Printer.CurrentY = iPrint
    'Printer.Print "(年度)"
    Printer.CurrentX = PLeft(14)
    Printer.CurrentY = iPrint
    Printer.Print "閉卷"
    Printer.CurrentX = PLeft(15)
    Printer.CurrentY = iPrint
    Printer.Print "(程序)"
    iPrint = iPrint + 300
    'Modified by Morgan 2013/6/24
    'Printer.Line (0, iPrint)-(16000, iPrint)
    Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
    
    iPrint = iPrint + 100
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If blnWordNewPage = True And Page <> 1 Then
        fn_DocNewPage
    End If
    blnWordNewPage = False
    Dim isPrintDate As Boolean
    Dim o_tmp1 As String
    Dim o_tmp2 As String
    Dim o_tmp3 As String
    Dim o_tmp4 As String
    Dim o_tmp5 As String
    Dim o_tmp6 As String
    iPrint = 0
    o_tmp1 = StrTemp5(12)
    o_tmp2 = StrTemp5(13)
    o_tmp3 = StrTemp5(0)
    o_tmp4 = StrTemp5(1)
    o_tmp5 = StrTemp5(2)
    o_tmp6 = StrTemp5(3)
    If Len(CheckStr(o_tmp6)) <> 0 Then
        If Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            o_tmp6 = fn_StrToWordFmt("收件人：" & o_tmp6, 29) & "電話：" & StrTemp5(5)
        Else
            o_tmp6 = fn_StrToWordFmt("　　　：" & o_tmp6, 29) & "電話：" & StrTemp5(5)
        End If
    End If
    If Len(CheckStr(o_tmp5)) <> 0 Then
        If Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp4)) <> 0 Then
        If Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp3)) <> 0 Then
        If Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp2)) <> 0 Then
        If Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp1)) <> 0 Then
        If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) = 0 Then
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 29) & "電話：" & StrTemp5(5)
        Else
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 29)
        End If
    End If
    isPrintDate = False
    'g_WordAp.
    fn_PutWords "客戶案件總簿", wdAlignParagraphCenter, "細明體", 22, False, True, True
    'Modif by Amy 2020/04/01 +if
    If IsLawOnly = True Then
        fn_PutWords "（法務）", wdAlignParagraphCenter, , 16
    Else
        fn_PutWords "（其他）", wdAlignParagraphCenter, , 16
    End If
    If Len(o_tmp1) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp1, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp1, 80), , , 10
        End If
    End If
    If Len(o_tmp2) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp2, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp2, 80), , , 10
        End If
    End If
    If Len(o_tmp3) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp3, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp3, 80), , , 10
        End If
    End If
    If Len(o_tmp4) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp4, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp4, 80), , , 10
        End If
    End If
    If Len(o_tmp5) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp5, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp5, 80), , , 10
        End If
    End If
    If Len(o_tmp6) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp6, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp6, 80), , , 10
        End If
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("地址：" & StrTemp5(4), 29) & "E-mail：" & StrTemp5(7), 69) & "Page：" & str(Page), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(6), 29) & "傳真：" & StrTemp5(9), 69), , , 10
    'Modify by Amy 2019/08/29 原:接洽人-秀玲
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(8), 29) & "預設接洽人：" & GetCU08(strTemp(20)), 47.5) & "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True), 69), , , 10
    If Len(StrTemp5(10)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(10), 29), , , 10
    End If
    If Len(StrTemp5(11)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(11), 29), , , 10
    End If
    fn_PutWords fn_StrLineToWord("="), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("本所案號", 11) & fn_StrToWordFmt("案件名稱", 18) & fn_StrToWordFmt("申請日", 7) & fn_StrToWordFmt("申請案號", 11) & fn_StrToWordFmt("種類", 5) & fn_StrToWordFmt("案件性質", 7) & fn_StrToWordFmt("專　用　期　限", 12) & "最近期限", 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("客戶案件案號", 29) & fn_StrToWordFmt("申請國家", 7) & fn_StrToWordFmt("審定號數", 11) & fn_StrToWordFmt("條碼廠商號碼", 21) & fn_StrToWordFmt("閉卷", 3) & "(程序)", 80), , , 10
    fn_PutWords fn_StrLineToWord("="), , , 10
End If
End Sub

'Add By Cheng 2003/07/09
'Modify by Amy 2020/04/01 +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintDataCo_A4(Optional ByVal IsLawOnly As Boolean = False)
Dim strCust As String '記錄申請人
Dim strSystemKind As String '記錄系統類別
Dim blnFirstPage As Boolean '判斷是否第一頁
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String '申請人+本所案號
Dim strWhere As String 'Add by Amy 2020/04/01

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True
'重整資料
''先刪除非A類收文資料
'strSQLA = "Delete From R050317_C Where ID='" & strUserNum & "' And R013018>'B' "
'cnnConnection.Execute strSQLA
'首次程序
If Me.txt1(15).Text = "1" Then
    'Modify By Cheng 2003/08/27
'    strSQLA = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, R013016 , R013018 "
    StrSQLa = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013001, R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
'最新程序
ElseIf Me.txt1(15).Text = "2" Then
    'Modify By Cheng 2003/07/18
'    strSQLA = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, R013016 Desc, R013018 Desc "
    'Modify By Cheng 2003/08/27
'    strSQLA = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, R013016 Desc, substr(R013018,1,1) , R013018 Desc "
    StrSQLa = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013001, R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
End If
strCaseNo = " "
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
If rsA.RecordCount > 0 Then
    While Not rsA.EOF
        If strCaseNo <> "" & rsA("R013001").Value & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
            strCaseNo = "" & rsA("R013001").Value & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
        Else
            rsA.Delete
        End If
        rsA.MoveNext
    Wend
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing

'Add by Amy 2020/04/01
If IsLawOnly = True Then
    strWhere = " And InStr(R013010,'L')>0 "
ElseIf strSrvDate(1) >= 事務所合併日 Then
    strWhere = "And InStr(R013010,'L')=0 "
End If
'end 2020/04/01
'列印第一頁
blnFirstPage = True
'國內外分開列印(不同系統類別分開列印)
'Modify by Amy 2020/04/01 +strWhere
If txt1(8) = "Y" Then
    '修改排序方式申請人, 系統類別
    strSql = "SELECT DISTINCT R013001,R013019 FROM R050317_C WHERE ID='" & strUserNum & "' " & strWhere & " GROUP BY R013001,R013019 ORDER BY R013001,R013019 "
'國內外不分開列印(不管系統類別)
Else
    strSql = "SELECT DISTINCT R013001 FROM R050317_C WHERE ID='" & strUserNum & "' " & strWhere & " GROUP BY R013001 ORDER BY R013001 "
End If
'end 2020/04/01
CheckOC
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
    '頁數加一
    Page = Page + 1
    RefreshColData 1, "申請人"
    With adoRecordset
        .MoveFirst
        '記錄申請人
        strCust = "" & .Fields("R013001").Value
        '記錄系統類別
        If txt1(8) = "Y" Then
            strSystemKind = "" & .Fields("R013019").Value
        Else
            strSystemKind = ""
        End If
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields("R013001").Value)
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields("R013019").Value)
            Else
               strTemp(21) = ""
            End If
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU58,CU61 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 13
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            '若申請人不同則跳頁
            If strCust <> strTemp(20) Then
                strCust = strTemp(20)
                strSystemKind = strTemp(21)
                If txt1(8) = "Y" Then
                   strSystemKind = strTemp(21)
                Else
                   strSystemKind = ""
                End If
                Page = Page + 1
                'Add by Amy 2013/10/03 +Excel
                If Check10(1).Value = vbChecked Then
                    fn_SetExcel
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                Else
                    'add  by nickc 2005/11/03  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    Call PrintTitleCo_A4(IsLawOnly) 'Modify by Amy 2020/04/01
                End If 'end 2013/10/3
            '若申請人相同
            Else
                '記錄系統類別
                If txt1(8) = "Y" Then
                    '若系統類別不同
                    If strSystemKind <> strTemp(21) Then
                        strSystemKind = strTemp(21)
                        Page = Page + 1
                        'Add by Amy 2013/10/03 +Excel
                        If Check10(1).Value = vbChecked Then
                             fn_SetExcel
                             fn_CreateExcel Page, strSystemKind, blnFirstPage
                        Else
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_DocNewPage
                            End If
                            Call PrintTitleCo_A4(IsLawOnly) 'Modify by Amy 2020/04/01
                        End If
                    End If
                End If
            End If
            '若為第一頁才印表頭
            'Modify by Amy 2013/10/03 +Excel
            If blnFirstPage = True Then
                If Check10(1).Value = vbChecked Then
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                Else
                    Call PrintTitleCo_A4(IsLawOnly) 'Modify by Amy 2020/04/01
                End If
                blnFirstPage = False
            End If
            '初始化本所案號變數
            SeekTempPrint = ""
            '國內外是否分開列印
            'Modify by Amy 2017/07/25 +R013028
            'Modify by Amy 2020/04/01 +strWhere
            If txt1(8) = "Y" Then
               strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007 ,R013028 From R050317_C,caseprogress WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' " & strWhere
            Else
               strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007 ,R013028 From R050317_C,caseprogress WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' " & strWhere
            End If
            'end 2020/04/01
            'end 2017/07/25
            
            '依本所案號排序
            If Me.txt1(9).Text = "1" Then
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            '依申請國家+案件名稱排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    strTemp(0) = "" & adoRecordset1.Fields(0).Value
                    strTemp(1) = StrToStr("" & adoRecordset1.Fields(1).Value, 42)
                    strTemp(2) = "" & adoRecordset1.Fields(2).Value
                    strTemp(3) = StrToStr("" & adoRecordset1.Fields(3).Value, 10)
                    strTemp(4) = StrToStr("" & adoRecordset1.Fields(4).Value, 4) 'Modify by Amy 2013/10/03 原顯示3個字
                    strTemp(5) = StrToStr("" & adoRecordset1.Fields(5).Value, 6)
                    strTemp(6) = ""
                    strTemp(7) = ""
                    strTemp(8) = StrToStr("" & adoRecordset1.Fields(8).Value, 10)
                    strTemp(9) = StrToStr(GetNationName("" & adoRecordset1.Fields(9).Value, IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                    strTemp(10) = StrToStr("" & adoRecordset1.Fields(10).Value, 10)
                    strTemp(11) = ""
                    strTemp(12) = ""
                    strTemp(13) = ""
                    strTemp(14) = ""
                    strTemp(15) = ""
                    GetOtherDuration "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                   
                    'Add by Amy 2013/10/03 +Excel
                    If Check10(1).Value = vbChecked Then
                        'Add by Amy 2017/07/25 +優先權資料
                        strPriDate = ""
                        If Not (txt1(15) = "3" And "" & adoRecordset1("R013028") <> "Y") Then
                            PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                        End If
                         '最新案件進度
                        'Modify by Amy 2017/07/25 +優先權資料
                        If txt1(15) = "2" Then
                            CaseProgress_NewA = StrToStr(strTemp(5), 6)
                            'Excel資料(依顯示順序)
                            strXlsData = strTemp(0) & "$$" & strXlsTp(0) & "$$" & strTemp(8) & "$$" & strTemp(1) & "$$" & _
                                              strTemp(2) & "$$" & strTemp(9) & "$$" & strTemp(3) & "$$" & strTemp(10) & "$$" & strXlsTp(4) & "$$" & _
                                              strTemp(5) & "$$" & strXlsTp(1) & "$$" & strXlsTp(2) & "$$" & _
                                              strTemp(7) & IIf(Len(strTemp(15)) > 0, Chr(10) & "(" & StrToStr(strTemp(15), 6) & ")", "") & "$$" & strPriDate
                        Else
                            'Modify by Amy 2021/05/20 申請國家可能為空值 ex:CFP-007198
                            CaseProgress_NewA = StrToStr(GetCaseProgress_NewA("" & adoRecordset1.Fields("R013005").Value, adoRecordset1.Fields("R013022").Value, adoRecordset1.Fields("R013023").Value, adoRecordset1.Fields("R013024").Value, adoRecordset1.Fields("R013025").Value), 6)
                            'Excel資料(依顯示順序)
                            strXlsData = strTemp(0) & "$$" & strXlsTp(0) & "$$" & strTemp(8) & "$$" & strTemp(1) & "$$" & _
                                              strTemp(2) & "$$" & strTemp(9) & "$$" & strTemp(3) & "$$" & strTemp(10) & "$$" & strXlsTp(4) & "$$" & _
                                              strTemp(5) & "$$" & strXlsTp(1) & "$$" & strXlsTp(2) & "$$" & _
                                             CaseProgress_NewA & "$$" & strTemp(7) & IIf(Len(strTemp(15)) > 0, Chr(10) & "(" & StrToStr(strTemp(15), 6) & ")", "") & "$$" & strPriDate
                        End If
                        'end 2017/07/25
                        fn_PutExcel "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                    '紙本/Word
                    Else
                        'edit by nickc 2005/11/11
                        'If iPrint >= 10000 Then
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                'Modified by Morgan 2013/6/24
                                'Printer.Line (0, iPrint)-(16000, iPrint)
                                Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                                fn_DocNewPage
                            End If
                            Call PrintTitleCo_A4(IsLawOnly) 'Modify by Amy 2020/04/01
                        End If
                        '列印明細資料
                        PrintDatilCo_A4
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_DocNewPage
                            End If
                            Call PrintTitleCo_A4(IsLawOnly) 'Modify by Amy 2020/04/01
                        End If
                        'Modify by Amy 2017/07/27 +FunctionName
                        PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value, "PrintTitleCo_A4"
                        'edit by nickc 2005/11/11
                        'If iPrint >= 10000 Then
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                'Modified by Morgan 2013/6/24
                                'Printer.Line (0, iPrint)-(16000, iPrint)
                                Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                                fn_DocNewPage
                            End If
                            PrintTitleCo_A4
                        Else
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.CurrentX = PLeft(0)
                                Printer.CurrentY = iPrint
                                'Modified by Morgan 2013/6/24
                                'Printer.Print String(220, "-")
                                Printer.Print String(160, "-")
                                iPrint = iPrint + 300
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                            End If
                            'edit by nickc 2005/11/11
                            'If iPrint >= 10000 Then
                            If iPrint >= o_PaperHeight Then
                                Page = Page + 1
                                'add  by nickc 2005/11/03  紙本
                                If Check3(0).Value = vbChecked Then
'                                    Printer.Line (0, iPrint)-(16000, iPrint)
                                     Printer.NewPage
                                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                     fn_DocNewPage
                                End If
                                Call PrintTitleCo_A4(IsLawOnly) 'Modify by Amy 2020/04/01
                            End If
                        End If
                    End If 'end 2013/10/3
                    adoRecordset1.MoveNext
                Loop
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
'                   Printer.Line (0, iPrint)-(16000, iPrint)
'                   iPrint = iPrint + 100
                    'edit by nickc 2005/11/11
                    'If iPrint >= 10000 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/03  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_DocNewPage
                        End If
                        Call PrintTitleCo_A4(IsLawOnly) 'Modify by Amy 2020/04/01
                    End If
                End If
                
                'Modify by Amy 2020/04/01 +strWhere
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                'end 2020/04/01
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                    IntTot = AdoRecordSet3.RecordCount
                End If
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/03  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(5)
                        Printer.CurrentY = iPrint
                        Printer.Print "總計：" & Format(IntTot, "##0")
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 54.5) & "總計：" & Format(IntTot, "##0"), 69), , , 10
                    End If
                End If
                'Modify by Amy 2020/04/01 +strWhere
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' " & strWhere & " group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                'end 2020/04/01
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                    IntTot = AdoRecordSet3.RecordCount
                End If
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/03  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(13)
                        Printer.CurrentY = iPrint
                        Printer.Print "閉卷件數：" & Format(IntTot, "##0")
                        iPrint = iPrint + 300
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt("閉卷件數：" & Format(IntTot, "##0"), 11), , , 10, False
                    End If
                End If
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
    If adoRecordset.RecordCount > 0 And Check10(1).Value = vbChecked Then  'Add by Amy 2013/10/03
        fn_SetExcel '設定最後一個sheet 的Excel格式
    End If
End If
CheckOC
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nick 2005/12/07
'    ShowPrintOk
End If
End Sub

'取得其他專用期限
Private Sub GetOtherDuration(strCaseNo1 As String, strCaseNo2 As String, StrCaseNo3 As String, strCaseNo4 As String)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim StrSqlB As String
Dim rsB As New ADODB.Recordset
Dim arrYearPay
Dim arrYearPaySet
Dim ii As Integer

StrSQLa = "Select '', '', LC08, '' From Lawcase Where " & ChgLawcase(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4)
StrSQLa = StrSQLa & " Union Select '', '', HC09, '' From Hirecase Where " & ChgHirecase(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4)
StrSQLa = StrSQLa & " Union Select SP20||'', SP21||'', SP15, SP19 From Servicepractice Where " & ChgService(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4)
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
If rsA.RecordCount > 0 Then
    'Add by Amy 2013/10/03 +if 使用不同變數存資料 for Excel
    If Check10(1).Value = vbChecked Then
        For ii = 0 To UBound(strXlsTp)
            strXlsTp(ii) = ""
        Next ii
        strXlsTp(1) = ChangeWStringToWDateString("" & rsA.Fields(0).Value)
        strXlsTp(2) = ChangeWStringToWDateString("" & rsA.Fields(1).Value)
        strXlsTp(0) = IIf("" & rsA.Fields(2).Value = "Y", "閉卷", "")
    Else
        strTemp(6) = ChangeWStringToWDateString("" & rsA.Fields(0).Value) & "-" & ChangeWStringToWDateString("" & rsA.Fields(1).Value)
        strTemp(12) = "" & rsA.Fields(3).Value
        strTemp(14) = IIf("" & rsA.Fields(2).Value = "Y", "＊", "")
    End If
    Select Case CheckSys(strCaseNo1)
    Case "1", "5"
        'Modify by Morgan 2009/7/13 +995,996
        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
        'StrSqlB = "Select Min(NP08), Decode(PA09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Patent Where NP02=CPM01 And NP07=CPM02 And NP02=PA01 And NP03=PA02 And NP04=PA03 And NP05=PA04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (411,997,998,995,996,999,1204,1503,1601) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(PA09,'000',CPM03,CPM04) "
        'StrSqlB = StrSqlB & " Union Select Min(NP08), Decode(SP09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Servicepractice Where NP02=CPM01 And NP07=CPM02 And NP02=SP01 And NP03=SP02 And NP04=SP03 And NP05=SP04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (411,997,998,995,996,999,1204,1503,1601) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(SP09,'000',CPM03,CPM04) "
        StrSqlB = "Select Min(NP08), Decode(PA09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Patent Where NP02=CPM01 And NP07=CPM02 And NP02=PA01 And NP03=PA02 And NP04=PA03 And NP05=PA04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(PA09,'000',CPM03,CPM04) "
        StrSqlB = StrSqlB & " Union Select Min(NP08), Decode(SP09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Servicepractice Where NP02=CPM01 And NP07=CPM02 And NP02=SP01 And NP03=SP02 And NP04=SP03 And NP05=SP04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(SP09,'000',CPM03,CPM04) "
    Case "3", "4", "7", "8"
        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
        'StrSqlB = "Select Min(NP08), Decode(LC15,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Lawcase Where NP02=CPM01 And NP07=CPM02 And NP02=LC01 And NP03=LC02 And NP04=LC03 And NP05=LC04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (6001) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(LC15,'000',CPM03,CPM04) "
        'StrSqlB = StrSqlB & " Union Select Min(NP08), Decode('000','000',CPM03,CPM04) From NextProgress, CasePropertyMap, Hirecase Where NP02=CPM01 And NP07=CPM02 And NP02=HC01 And NP03=HC02 And NP04=HC03 And NP05=HC04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (6001) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode('000','000',CPM03,CPM04) "
        'StrSqlB = StrSqlB & " Union Select Min(NP08), Decode(SP09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Servicepractice Where NP02=CPM01 And NP07=CPM02 And NP02=SP01 And NP03=SP02 And NP04=SP03 And NP05=SP04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (6001) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(SP09,'000',CPM03,CPM04) "
        StrSqlB = "Select Min(NP08), Decode(LC15,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Lawcase Where NP02=CPM01 And NP07=CPM02 And NP02=LC01 And NP03=LC02 And NP04=LC03 And NP05=LC04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(LC15,'000',CPM03,CPM04) "
        StrSqlB = StrSqlB & " Union Select Min(NP08), Decode('000','000',CPM03,CPM04) From NextProgress, CasePropertyMap, Hirecase Where NP02=CPM01 And NP07=CPM02 And NP02=HC01 And NP03=HC02 And NP04=HC03 And NP05=HC04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode('000','000',CPM03,CPM04) "
        StrSqlB = StrSqlB & " Union Select Min(NP08), Decode(SP09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Servicepractice Where NP02=CPM01 And NP07=CPM02 And NP02=SP01 And NP03=SP02 And NP04=SP03 And NP05=SP04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(SP09,'000',CPM03,CPM04) "
    Case "2", "6"
        'Modify by Morgan 2009/7/13 +995,996
        'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
        'StrSqlB = "Select Min(NP08), Decode(TM10,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Trademark Where NP02=CPM01 And NP07=CPM02 And NP02=TM01 And NP03=TM02 And NP04=TM03 And NP05=TM04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (305,997,998,995,996,1403) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(TM10,'000',CPM03,CPM04) "
        'StrSqlB = StrSqlB & " Union Select Min(NP08), Decode(SP09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Servicepractice Where NP02=CPM01 And NP07=CPM02 And NP02=SP01 And NP03=SP02 And NP04=SP03 And NP05=SP04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (305,997,998,995,996,1403) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(SP09,'000',CPM03,CPM04) "
        StrSqlB = "Select Min(NP08), Decode(TM10,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Trademark Where NP02=CPM01 And NP07=CPM02 And NP02=TM01 And NP03=TM02 And NP04=TM03 And NP05=TM04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(TM10,'000',CPM03,CPM04) "
        StrSqlB = StrSqlB & " Union Select Min(NP08), Decode(SP09,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Servicepractice Where NP02=CPM01 And NP07=CPM02 And NP02=SP01 And NP03=SP02 And NP04=SP03 And NP05=SP04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(SP09,'000',CPM03,CPM04) "
    End Select
    rsB.CursorLocation = adUseClient
    rsB.Open StrSqlB, cnnConnection, adOpenStatic, adLockReadOnly
    If rsB.RecordCount > 0 Then
        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString("" & rsB.Fields(0).Value))
        strTemp(15) = "" & rsB.Fields(1).Value
    End If
    If rsB.State <> adStateClosed Then rsB.Close
    Set rsB = Nothing
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing

End Sub

'Add By Cheng 2003/07/08
Private Sub GetPleftCo_A4()
Dim iLeftMargin As Integer
'Added by Morgan 2013/6/24
If Printer.ScaleMode = 1 And Printer.Width - Printer.ScaleWidth < 600 Then
   iLeftMargin = 300
End If

Erase PLeft
'第一行
PLeft(0) = iLeftMargin + 0 '本所案號
PLeft(1) = iLeftMargin + 2100 '專利名稱
PLeft(2) = iLeftMargin + 6300 '申請日
PLeft(3) = iLeftMargin + 7600 '申請案號
PLeft(4) = iLeftMargin + 9800 '種類
PLeft(5) = iLeftMargin + 10700 '案件性質
PLeft(6) = iLeftMargin + 12100 '專用期限
PLeft(7) = iLeftMargin + 14500 '最近期限
'第二行
PLeft(8) = iLeftMargin + 0 '客戶案件案號
PLeft(9) = iLeftMargin + 6300 '申請國家
PLeft(10) = iLeftMargin + 7600 '專利號數
PLeft(11) = iLeftMargin + 9800
PLeft(12) = iLeftMargin + 12100 '條碼廠商號碼
PLeft(13) = iLeftMargin + 13100
PLeft(14) = iLeftMargin + 13900 '閉卷
PLeft(15) = iLeftMargin + 14600 '(程序)
End Sub

'Add By Cheng 2003/07/08
'Modify by Amy +IsLawOnly參數(事務所合併日 起法務資料公司名稱不同)
Private Sub PrintDatilCo_A4(Optional ByVal IsLawOnly As Boolean = False)
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    For i = 0 To 7
       If i = 0 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print Replace(strTemp(i), "*", "＊")
       ElseIf i = 1 Then
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print Mid(strTemp(i), 1, 21)
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint + 300
          Printer.Print Mid(strTemp(i), 22, 21)
       Else
          Printer.CurrentX = PLeft(i)
          Printer.CurrentY = iPrint
          Printer.Print strTemp(i)
       End If
    Next i
    iPrint = iPrint + 300
    For i = 8 To 14
       Printer.CurrentX = PLeft(i)
       Printer.CurrentY = iPrint
       Printer.Print strTemp(i)
    Next i
    If strTemp(15) <> "" Then
       Printer.CurrentX = PLeft(15) - 300
       Printer.CurrentY = iPrint
       Printer.Print "(" & Left(strTemp(15) & "　　　　　　", 6) & ")"
    End If
    iPrint = iPrint + 300
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
'    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(Replace(strTemp(0), "*", "＊"), 11) & fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18) & fn_StrToWordFmt(strTemp(2), 7) & fn_StrToWordFmt(strTemp(3), 11) & fn_StrToWordFmt(strTemp(4), 5) & fn_StrToWordFmt(strTemp(5), 7) & fn_StrToWordFmt(strTemp(6), 12) & strTemp(7), 80), , , 10
'    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Mid(strTemp(1), 22, 21), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(12), 21) & fn_StrToWordFmt(strTemp(14), 3) & "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(Replace(strTemp(0), "*", "＊"), 11) & fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18) & fn_StrToWordFmt(strTemp(2), 7) & fn_StrToWordFmt(strTemp(3), 11) & fn_StrToWordFmt(strTemp(4), 5) & fn_StrToWordFmt(strTemp(5), 7) & fn_StrToWordFmt(strTemp(6), 12) & strTemp(7), 80), , , 10
    If iPrint >= o_PaperHeight Then
        Page = Page + 1
        'add  by nickc 2005/11/03  紙本
        If Check3(0).Value = vbChecked Then
            Printer.NewPage
        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
            fn_DocNewPage
        End If
        Call PrintTitleCo_A4(IsLawOnly) 'Modify by Amy 2020/04/01
    End If
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Replace(strTemp(1), fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18), ""), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(11), 12) & fn_StrToWordFmt(strTemp(12), 5) & fn_StrToWordFmt(strTemp(13), 4) & fn_StrToWordFmt(strTemp(14), 3) & "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Replace(strTemp(1), Trim(Replace(fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18), "　", "")), ""), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(11), 12) & fn_StrToWordFmt(strTemp(12), 5) & fn_StrToWordFmt(strTemp(13), 4) & fn_StrToWordFmt(strTemp(14), 3) & IIf(strTemp(15) <> "", "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", ""), 80), , , 10
End If
End Sub

'Add By Cheng 2003/07/08
Private Sub GetPleftCt_A4()
Dim iLeftMargin As Integer
'Added by Morgan 2013/6/24
If Printer.ScaleMode = 1 And Printer.Width - Printer.ScaleWidth < 600 Then
   iLeftMargin = 300
End If

Erase PLeft
'第一行
PLeft(0) = iLeftMargin + 0 '本所案號
PLeft(1) = iLeftMargin + 2100 '專利名稱
PLeft(2) = iLeftMargin + 6300 '申請日
PLeft(3) = iLeftMargin + 7600 '申請案號
PLeft(4) = iLeftMargin + 9800 - 100 '種類
PLeft(5) = iLeftMargin + 10700 '案件性質
PLeft(6) = iLeftMargin + 12100 '專用期限
PLeft(7) = iLeftMargin + 14500 '最近期限
'第二行
PLeft(8) = iLeftMargin + 0 '客戶案件案號
PLeft(9) = iLeftMargin + 6300 '申請國家
PLeft(10) = iLeftMargin + 7600 '審定號數
PLeft(11) = iLeftMargin + 9800 '准駁
PLeft(12) = iLeftMargin + 12100 '商品類別
PLeft(13) = iLeftMargin + 13100
PLeft(14) = iLeftMargin + 13900 '閉卷
PLeft(15) = iLeftMargin + 14600 '(程序)
End Sub

Private Sub PrintDataCt_A4()
Dim strCust As String '記錄申請人
Dim strSystemKind As String '記錄系統類別
Dim blnFirstPage As Boolean '判斷是否第一頁
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String '申請人+本所案號
Dim strTMGoods As String 'Add by Amy 2017/03/13 指定商品

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True

'重整資料
''先刪除非A類收文資料
'strSQLA = "Delete From R050317_C Where ID='" & strUserNum & "' And R013018>'B' "
'cnnConnection.Execute strSQLA
'首次程序
If Me.txt1(15).Text = "1" Then
    'Modify By Cheng 2003/08/27
'    strSQLA = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, R013016 , R013018 "
    StrSQLa = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013001, R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
'最新程序
ElseIf Me.txt1(15).Text = "2" Then
    'Modify By Cheng 2003/07/18
'    strSQLA = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, R013016 Desc, R013018 Desc "
    'Modify By Cheng 2003/08/27
'    strSQLA = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, R013016 Desc, substr(R013018,1,1), R013018 Desc "
    StrSQLa = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013001, R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
End If
strCaseNo = " "
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
If rsA.RecordCount > 0 Then
    While Not rsA.EOF
        If strCaseNo <> "" & rsA("R013001").Value & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
            strCaseNo = "" & rsA("R013001").Value & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
        Else
            rsA.Delete
        End If
        rsA.MoveNext
    Wend
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing
'列印第一頁
blnFirstPage = True
'國內外分開列印(不同系統類別分開列印)
If txt1(8) = "Y" Then
    '修改排序方式申請人, 系統類別
    strSql = "SELECT DISTINCT R013001,R013019 FROM R050317_C WHERE ID='" & strUserNum & "' GROUP BY R013001,R013019 ORDER BY R013001,R013019 "
'國內外不分開列印(不管系統類別)
Else
    strSql = "SELECT DISTINCT R013001 FROM R050317_C WHERE ID='" & strUserNum & "' GROUP BY R013001 ORDER BY R013001 "
End If
CheckOC
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
    '頁數加一
    Page = Page + 1
    RefreshColData 1, "申請人"
    With adoRecordset
        .MoveFirst
        '記錄申請人
        strCust = "" & .Fields("R013001").Value
        '記錄系統類別
        If txt1(8) = "Y" Then
            strSystemKind = "" & .Fields("R013019").Value
        Else
            strSystemKind = ""
        End If
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields("R013001").Value)
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields("R013019").Value)
            Else
               strTemp(21) = ""
            End If
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU58,CU61 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 13
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            '若申請人不同則跳頁
            If strCust <> strTemp(20) Then
                strCust = strTemp(20)
                strSystemKind = strTemp(21)
                If txt1(8) = "Y" Then
                   strSystemKind = strTemp(21)
                Else
                   strSystemKind = ""
                End If
                Page = Page + 1
                'Add by Amy 2013/10/03 +Excel
                If Check10(1).Value = vbChecked Then
                    fn_SetExcel
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                Else
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    PrintTitleCt_A4
                End If
            '若申請人相同
            Else
                '記錄系統類別
                If txt1(8) = "Y" Then
                    '若系統類別不同
                    If strSystemKind <> strTemp(21) Then
                        strSystemKind = strTemp(21)
                        Page = Page + 1
                        'Add by Amy 2013/10/03 +Excel
                        If Check10(1).Value = vbChecked Then
                             fn_SetExcel
                             fn_CreateExcel Page, strSystemKind, blnFirstPage
                        Else
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_DocNewPage
                            End If
                            PrintTitleCt_A4
                        End If
                    End If
                End If
            End If
            '若為第一頁才印表頭
            'Modify by Amy 2013/10/03 +Excel
            If blnFirstPage = True Then
                If Check10(1).Value = vbChecked Then
                    fn_CreateExcel Page, strSystemKind, blnFirstPage
                Else
                    PrintTitleCt_A4
                End If
                blnFirstPage = False
            End If
            '初始化本所案號變數
            SeekTempPrint = ""
            '國內外是否分開列印
            'Modify by Amy 2017/07/25 +R013028
            If txt1(8) = "Y" Then
               'edit by nickc 2008/04/15 所有程序cp其餘抓tm
               If txt1(15) = "3" Then
                    strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007,R013028 From R050317_C,caseprogress WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' "
               Else
                    strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, tm16 as cp24, '', '', '', '', R013022, R013023, R013024, R013025, R013007,R013028 From R050317_C,caseprogress,trademark WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' and cp01=tm01(+) and cp02=tm02(+) and cp03=tm03(+) and cp04=tm04(+) "
               End If
            Else
                'edit by nickc 2008/04/15 所有程序cp其餘抓tm
                If txt1(15) = "3" Then
                    strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007,R013028 From R050317_C,caseprogress WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' "
                Else
                    strSql = "SELECT R013010, R013015, R013020, R013004, R013014, R013006, '', R013008, R013009, R013005, R013011, tm16 as CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007,R013028 From R050317_C,caseprogress,trademark WHERE r013018=CP09(+) And R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' and cp01=tm01(+) and cp02=tm02(+) and cp03=tm03(+) and cp04=tm04(+) "
                End If
            End If
            'end 2017/07/25
            
            '依本所案號排序
            If Me.txt1(9).Text = "1" Then
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            '依申請國家+案件名稱排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))) "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    strTemp(0) = "" & adoRecordset1.Fields(0).Value
                    strTemp(1) = StrToStr("" & adoRecordset1.Fields(1).Value, 42)
                    strTemp(2) = "" & adoRecordset1.Fields(2).Value
                    strTemp(3) = StrToStr("" & adoRecordset1.Fields(3).Value, 10)
                    strTemp(4) = ""
                    strTemp(5) = StrToStr("" & adoRecordset1.Fields(5).Value, 6)
                    strTemp(6) = ""
                    strTemp(7) = ""
                    strTemp(8) = StrToStr("" & adoRecordset1.Fields(8).Value, 10)
                    strTemp(9) = StrToStr(GetNationName("" & adoRecordset1.Fields(9).Value, IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                    strTemp(10) = StrToStr("" & adoRecordset1.Fields(10).Value, 10)
                    strTemp(11) = IIf("" & adoRecordset1.Fields(11).Value = "1", "准", IIf("" & adoRecordset1.Fields(11).Value = "2", "駁", ""))
                    strTemp(12) = ""
                    strTemp(13) = ""
                    strTemp(14) = ""
                    strTemp(15) = ""
                    GetTrademarkDuration "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                    strPriDate = "" 'Add by Amy 2017/07/25
                    
                    'Add by Amy 2013/10/03 +if
                    If Check10(1).Value = vbChecked Then
                        'Add by Amy 2017/07/25 +優先權資料(所有格式只顯示於CP31=Y 那筆)
                        If Not (txt1(15) = "3" And "" & adoRecordset1("R013028") <> "Y") Then
                            PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                        End If
                        'Add by Amy 2017/03/13 +指定商品
                        strTMGoods = ""
                        If bolTMGoods = True Then
                            'Modify by Amy 2019/05/30  指商品若無中文->英文->日文 BeforePrintGetDBData加參數
                            strTMGoods = BeforePrintGetDBData("TMGoods:" & adoRecordset1("R013022").Value & "-" & adoRecordset1("R013023").Value & "-" & _
                                                                                                                 adoRecordset1("R013024").Value & "-" & adoRecordset1("R013025").Value & "-中文含標題", True, True)
                        End If
                        'end 2017/03/13
                        '抓 最新案件進度
                        'Modify by Amy 2017/07/25 +優先權資料
                        If txt1(15) = "2" Then
                            CaseProgress_NewA = StrToStr(strTemp(5), 6)
                            'Excel資料 (依顯示順序)
                            strXlsData = "$$" & strTemp(0) & "$$" & strXlsTp(0) & "$$" & strTemp(8) & "$$" & strTemp(1) & "$$" & _
                                               strTemp(2) & "$$" & strTemp(9) & "$$" & strTemp(3) & "$$" & strTemp(10) & "$$" & strXlsTp(4) & "$$" & _
                                               strTemp(11) & "$$" & strTemp(5) & "$$" & strXlsTp(1) & "$$" & strXlsTp(2) & "$$" & _
                                               strXlsTp(3) & "$$" & strTemp(7) & IIf(Len(strTemp(15)) > 0, Chr(10) & "(" & StrToStr(strTemp(15), 6) & ")", "") & IIf(bolTMGoods = True, "$$" & strTMGoods, "") & _
                                               "$$" & strPriDate

                        Else
                            'Modify by Amy 2021/05/20 申請國家可能為空值 ex:CFP-007198
                            CaseProgress_NewA = StrToStr(GetCaseProgress_NewA("" & adoRecordset1.Fields("R013005").Value, adoRecordset1.Fields("R013022").Value, adoRecordset1.Fields("R013023").Value, adoRecordset1.Fields("R013024").Value, adoRecordset1.Fields("R013025").Value), 6)
                            'Excel資料 (依顯示順序)
                             strXlsData = "$$" & strTemp(0) & "$$" & strXlsTp(0) & "$$" & strTemp(8) & "$$" & strTemp(1) & "$$" & _
                                                strTemp(2) & "$$" & strTemp(9) & "$$" & strTemp(3) & "$$" & strTemp(10) & "$$" & strXlsTp(4) & "$$" & _
                                                strTemp(11) & "$$" & strTemp(5) & "$$" & strXlsTp(1) & "$$" & strXlsTp(2) & "$$" & _
                                                strXlsTp(3) & "$$" & CaseProgress_NewA & "$$" & strTemp(7) & IIf(Len(strTemp(15)) > 0, Chr(10) & "(" & StrToStr(strTemp(15), 6) & ")", "") & IIf(bolTMGoods = True, "$$" & strTMGoods, "") & _
                                                "$$" & strPriDate
                                               
                        End If
                        'end 2017/07/25
                        strTemp(2) = ChangeTStringToWDateString(ChangeTDateStringToTString(strTemp(2)))
                        
                        fn_PutExcel "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                    Else
                        'edit by nickc 2005/11/11
                        'If iPrint >= 10000 Then
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                'Modified by Morgan 2013/6/24
                                'Printer.Line (0, iPrint)-(16000, iPrint)
                                Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                                fn_DocNewPage
                            End If
                            PrintTitleCt_A4
                        End If
                        '列印明細資料
                        PrintDatilCt_A4
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_DocNewPage
                            End If
                            PrintTitleCt_A4
                        End If
                        'Modify by Amy 2017/07/27 +FunctionName
                        PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value, "PrintTitleCt_A4"
                        'edit by nickc 2005/11/11
                        'If iPrint >= 10000 Then
                        If iPrint >= o_PaperHeight Then
                            Page = Page + 1
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                'Modified by Morgan 2013/6/24
                                'Printer.Line (0, iPrint)-(16000, iPrint)
                                Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                                fn_DocNewPage
                            End If
                            PrintTitleCt_A4
                        Else
                            'add  by nickc 2005/11/15  紙本
                            If Check3(0).Value = vbChecked Then
                                Printer.CurrentX = PLeft(0)
                                Printer.CurrentY = iPrint
                                'Modified by Morgan 2013/6/24
                                'Printer.Print String(220, "-")
                                Printer.Print String(160, "-")
                                iPrint = iPrint + 300
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                            End If
                            'edit by nickc 2005/11/11
                            'If iPrint >= 10000 Then
                            If iPrint >= o_PaperHeight Then
                                Page = Page + 1
                                'add  by nickc 2005/11/15  紙本
                                If Check3(0).Value = vbChecked Then
                                    Printer.NewPage
                                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                    fn_DocNewPage
                                End If
                                PrintTitleCt_A4
                            End If
                        End If
                    End If 'end 2013/10/3
                    adoRecordset1.MoveNext
                Loop
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
'                   Printer.Line (0, iPrint)-(16000, iPrint)
    '                iPrint = iPrint + 100
                    'edit by nickc 2005/11/11
                    'If iPrint >= 10000 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_DocNewPage
                        End If
                        PrintTitleCt_A4
                    End If
                End If
                
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                    IntTot = AdoRecordSet3.RecordCount
                End If
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/16  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(5)
                        Printer.CurrentY = iPrint
                        Printer.Print "總計：" & Format(IntTot, "##0")
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 54.5) & "總計：" & Format(IntTot, "##0"), 69), , , 10
                    End If
                End If
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE R013001='" & strTemp(20) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                    IntTot = AdoRecordSet3.RecordCount
                End If
                'Add by Amy 2013/10/03 +Excel
                If Not Check10(1).Value = vbChecked Then
                    'add  by nickc 2005/11/16  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(13)
                        Printer.CurrentY = iPrint
                        Printer.Print "閉卷件數：" & Format(IntTot, "##0")
                        iPrint = iPrint + 300
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt("閉卷件數：" & Format(IntTot, "##0"), 11), , , 10, False
                    End If
                End If
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
    If adoRecordset.RecordCount > 0 And Check10(1).Value = vbChecked Then 'Add by Amy 2013/10/03
        fn_SetExcel '設定最後一個sheet 的Excel格式
    End If
End If
CheckOC
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
End Sub

'取得商標專用期限
Private Sub GetTrademarkDuration(strCaseNo1 As String, strCaseNo2 As String, StrCaseNo3 As String, strCaseNo4 As String)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim StrSqlB As String
Dim rsB As New ADODB.Recordset
Dim arrYearPay
Dim arrYearPaySet
Dim ii As Integer

StrSQLa = "Select TM21, TM22, TM29, TM09 ," & strIdfTag & " || PTM03 From Trademark, PatentTrademarkMap Where '2'=PTM01(+) And TM08=PTM02(+) And " & ChgTradeMark(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4)
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
If rsA.RecordCount > 0 Then
    'Add by Amy 2013/10/03 +if 使用不同變數存資料 for Excel
    If Check10(1).Value = vbChecked Then
        For ii = 0 To UBound(strXlsTp)
            strXlsTp(ii) = ""
        Next ii
        
        strXlsTp(1) = ChangeWStringToWDateString("" & rsA.Fields(0).Value)
        strXlsTp(2) = ChangeWStringToWDateString("" & rsA.Fields(1).Value)
        strXlsTp(3) = "" & rsA.Fields(3).Value '商品類別
        strXlsTp(4) = StrToStr("" & rsA.Fields(4).Value, 4) '種類
        strXlsTp(0) = IIf("" & rsA.Fields(2).Value = "Y", "閉卷", "")
    Else
        strTemp(6) = ChangeWStringToWDateString("" & rsA.Fields(0).Value) & "-" & ChangeWStringToWDateString("" & rsA.Fields(1).Value)
        strTemp(12) = "" & rsA.Fields(3).Value
        strTemp(4) = StrToStr("" & rsA.Fields(4).Value, 4) 'Modify by Amy 2013/10/03 原顯示全部
        strTemp(14) = IIf("" & rsA.Fields(2).Value = "Y", "＊", "")
    End If
    'Modify by Morgan 2009/7/13 +995,996
    'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
    'StrSqlB = "Select Min(NP08), Decode(TM10,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Trademark Where NP02=CPM01 And NP07=CPM02 And NP02=TM01 And NP03=TM02 And NP04=TM03 And NP05=TM04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & strCaseNo3 & strCaseNo4) & " And NP07 Not In (305,997,998,995,996,1403) And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(TM10,'000',CPM03,CPM04) "
    StrSqlB = "Select Min(NP08), Decode(TM10,'000',CPM03,CPM04) From NextProgress, CasePropertyMap, Trademark Where NP02=CPM01 And NP07=CPM02 And NP02=TM01 And NP03=TM02 And NP04=TM03 And NP05=TM04 And " & ChgNextProgress(strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4) & strNpSqlOfNoSalesDuty & " And NP06 Is Null And NP08>=" & strSrvDate(1) & " Group By Decode(TM10,'000',CPM03,CPM04) "
    rsB.CursorLocation = adUseClient
    rsB.Open StrSqlB, cnnConnection, adOpenStatic, adLockReadOnly
    If rsB.RecordCount > 0 Then
        'Add by Amy 2013/10/03 +if
        If txt1(15) = "3" And Check10(1).Value = vbChecked Then
            '選「所有程序」且產生Excel不需重抓 最近期限(因strTemp(7) 客戶案件案號用)
        Else
            strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString("" & rsB.Fields(0).Value))
        End If
        strTemp(15) = StrToStr("" & rsB.Fields(1).Value, 6) 'Modify by Amy 2013/10/03 原顯示全部
    End If
    If rsB.State <> adStateClosed Then rsB.Close
    Set rsB = Nothing
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing

End Sub

'Add By Cheng 2003/07/08
Private Sub PrintDatilCt_A4()
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    Dim StrSQLa As String
    Dim rsA As New ADODB.Recordset
    
    For i = 0 To 7
        If i = 0 Then
            Printer.CurrentX = PLeft(i)
            Printer.CurrentY = iPrint
            Printer.Print Replace(strTemp(i), "*", "＊")
        ElseIf i = 1 Then
            StrSQLa = "Select * From Trademark Where " & ChgTradeMark(Replace(Replace(strTemp(0), "-", ""), "*", ""))
            rsA.CursorLocation = adUseClient
            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
            If rsA.RecordCount > 0 Then
                '中文名稱
                Printer.CurrentX = PLeft(i)
                Printer.CurrentY = iPrint
                Printer.Print Left("" & rsA("TM05").Value, 20)
    '            '英文名稱
                Printer.CurrentX = PLeft(i)
                Printer.CurrentY = iPrint + 300
    '            Printer.Print Left("" & rsA("TM06").Value, 40)
                Printer.Print Mid("" & rsA("TM05").Value, 21, 20)
            Else
                Printer.CurrentX = PLeft(i)
                Printer.CurrentY = iPrint
                Printer.Print Mid(strTemp(i), 1, 21)
                Printer.CurrentX = PLeft(i)
                Printer.CurrentY = iPrint + 300
                Printer.Print Mid(strTemp(i), 22, 21)
            End If
            If rsA.State <> adStateClosed Then rsA.Close
            Set rsA = Nothing
        Else
            Printer.CurrentX = PLeft(i)
            Printer.CurrentY = iPrint
            Printer.Print strTemp(i)
        End If
    Next i
    iPrint = iPrint + 300
    For i = 8 To 14
        Printer.CurrentX = PLeft(i)
        Printer.CurrentY = iPrint
        Printer.Print strTemp(i)
    Next i
    If strTemp(15) <> "" Then
        Printer.CurrentX = PLeft(15) - 300
        Printer.CurrentY = iPrint
        Printer.Print "(" & Left(strTemp(15) & "　　　　　　", 6) & ")"
    End If
    iPrint = iPrint + 300
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If rsA.State = 1 Then rsA.Close
    StrSQLa = "Select * From Trademark Where " & ChgTradeMark(Replace(Replace(strTemp(0), "-", ""), "*", ""))
    rsA.CursorLocation = adUseClient
    rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
    If rsA.RecordCount > 0 Then
        '中文名稱
        strTemp(1) = CheckStr(rsA("tm05").Value)
    End If
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(Replace(strTemp(0), "*", "＊"), 11) & fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18) & fn_StrToWordFmt(strTemp(2), 7) & fn_StrToWordFmt(strTemp(3), 11) & fn_StrToWordFmt(strTemp(4), 5) & fn_StrToWordFmt(strTemp(5), 7) & fn_StrToWordFmt(strTemp(6), 12) & strTemp(7), 80), , , 10
    If iPrint >= o_PaperHeight Then
        Page = Page + 1
        'add  by nickc 2005/11/15  紙本
        If Check3(0).Value = vbChecked Then
            Printer.NewPage
        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
            fn_DocNewPage
        End If
        PrintTitleCt_A4
    End If
    'fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Replace(strTemp(1), fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18), ""), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(11), 12) & fn_StrToWordFmt(strTemp(12), 5) & fn_StrToWordFmt(strTemp(13), 4) & fn_StrToWordFmt(strTemp(14), 3) & "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", 80), , , 10
    'Modify by Amy 2015/03/18 fn_StrToWordFmt(strTemp(12)...,+True) 商品類別
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(strTemp(8), 11) & fn_StrToWordFmt(Replace(strTemp(1), Trim(Replace(fn_StrToWordFmt(Mid(strTemp(1), 1, 21), 18), "　", "")), ""), 18) & fn_StrToWordFmt(strTemp(9), 7) & fn_StrToWordFmt(strTemp(10), 11) & fn_StrToWordFmt(strTemp(11), 12) & fn_StrToWordFmt(strTemp(12), 5, True) & fn_StrToWordFmt(strTemp(13), 4) & fn_StrToWordFmt(strTemp(14), 3) & IIf(strTemp(15) <> "", "(" & Left(strTemp(15) & "　　　　　　", 6) & ")", ""), 80), , , 10
End If
End Sub

'Add By Cheng 2003/07/08
Private Sub PrintTitleCt_A4()
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    GetPleftCt_A4
    iPrint = 500
    Printer.Font.Size = 22
    Printer.Font.Bold = True
    Printer.Font.Underline = True
    Printer.FontName = "細明體"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "客戶案件總簿"
    Printer.Font.Bold = False
    Printer.Font.Underline = False
    iPrint = iPrint + 500
    Printer.Font.Size = 16
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "　　（商標）"
    Printer.Font.Size = 10
    iPrint = iPrint + 500
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "列印日期：" & ChangeTStringToTDateString(strSrvDate(2))
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "收件人："
    If Len(StrTemp5(12)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(12)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(13)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(13)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(0)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(0)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(1)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(1)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(2)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(2)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(3)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("收件人：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(3)
       iPrint = iPrint + 300
    End If
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint - 300
    
    Printer.Print "電話：" & StrTemp5(5)
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "地址：" & StrTemp5(4)
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    
    Printer.Print "E-mail：" & StrTemp5(7)
    
    Printer.CurrentX = PLeft(13)
    Printer.CurrentY = iPrint
    Printer.Print "Page：" & str(Page)
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(6)
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    
    Printer.Print "傳真：" & StrTemp5(9)
    
    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
    Printer.CurrentY = iPrint
    Printer.Print StrTemp5(8)
    Printer.CurrentX = PLeft(2) 'edit by nickc 2005/11/18 PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "預設接洽人：" & GetCU08(strTemp(20)) 'Modify by Amy 2019/08/29 原:接洽人-秀玲
    Printer.CurrentX = PLeft(4) 'edit by nickc 2005/11/18 PLeft(2)
    Printer.CurrentY = iPrint
    
    Printer.Print "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True)
    
    'add by nickc 2005/11/18
    iPrint = iPrint + 300
    
    Printer.CurrentX = PLeft(4)
    Printer.CurrentY = iPrint
    Printer.Print "A：原為聯合商標　B:原為服務標章　C:原為聯合服務標章"
    
    iPrint = iPrint + 300
    If Len(StrTemp5(10)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(10)
       iPrint = iPrint + 300
    End If
    If Len(StrTemp5(11)) <> 0 Then
       Printer.CurrentX = PLeft(0) + Printer.TextWidth("地址：")
       Printer.CurrentY = iPrint
       Printer.Print StrTemp5(11)
       iPrint = iPrint + 300
    End If
    'Modified by Morgan 2013/6/24
    'Printer.Line (0, iPrint)-(16000, iPrint)
    Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
    iPrint = iPrint + 101
    
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "本所案號"
    Printer.CurrentX = PLeft(1)
    Printer.CurrentY = iPrint
    Printer.Print "商標名稱"
    Printer.CurrentX = PLeft(2)
    Printer.CurrentY = iPrint
    Printer.Print "申請日"
    Printer.CurrentX = PLeft(3)
    Printer.CurrentY = iPrint
    Printer.Print "申請案號"
    Printer.CurrentX = PLeft(4) + 100
    Printer.CurrentY = iPrint
    Printer.Print "種類"
    Printer.CurrentX = PLeft(5)
    Printer.CurrentY = iPrint
    Printer.Print "案件性質"
    Printer.CurrentX = PLeft(6)
    Printer.CurrentY = iPrint
    Printer.Print "專　用　期　限"
    Printer.CurrentX = PLeft(7)
    Printer.CurrentY = iPrint
    Printer.Print "最近期限"
    iPrint = iPrint + 300
    
    Printer.CurrentX = PLeft(8)
    Printer.CurrentY = iPrint
    Printer.Print "客戶案件案號"
    Printer.CurrentX = PLeft(9)
    Printer.CurrentY = iPrint
    Printer.Print "申請國家"
    Printer.CurrentX = PLeft(10)
    Printer.CurrentY = iPrint
    Printer.Print "審定號數"
    Printer.CurrentX = PLeft(11)
    Printer.CurrentY = iPrint
    Printer.Print "准駁"
    Printer.CurrentX = PLeft(12)
    Printer.CurrentY = iPrint
    Printer.Print "商品類別"
    'Printer.CurrentX = PLeft(13)
    'Printer.CurrentY = iPrint
    'Printer.Print "(年度)"
    Printer.CurrentX = PLeft(14)
    Printer.CurrentY = iPrint
    Printer.Print "閉卷"
    Printer.CurrentX = PLeft(15)
    Printer.CurrentY = iPrint
    Printer.Print "(程序)"
    iPrint = iPrint + 300
    'Modified by Morgan 2013/6/24
    'Printer.Line (0, iPrint)-(16000, iPrint)
    Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
    iPrint = iPrint + 100
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If blnWordNewPage = True And Page <> 1 Then
        fn_DocNewPage
    End If
    blnWordNewPage = False
    Dim isPrintDate As Boolean
    Dim o_tmp1 As String
    Dim o_tmp2 As String
    Dim o_tmp3 As String
    Dim o_tmp4 As String
    Dim o_tmp5 As String
    Dim o_tmp6 As String
    iPrint = 0
    o_tmp1 = StrTemp5(12)
    o_tmp2 = StrTemp5(13)
    o_tmp3 = StrTemp5(0)
    o_tmp4 = StrTemp5(1)
    o_tmp5 = StrTemp5(2)
    o_tmp6 = StrTemp5(3)
    If Len(CheckStr(o_tmp6)) <> 0 Then
        If Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            o_tmp6 = fn_StrToWordFmt("收件人：" & o_tmp6, 29) & "電話：" & StrTemp5(5)
        Else
            o_tmp6 = fn_StrToWordFmt("　　　：" & o_tmp6, 29) & "電話：" & StrTemp5(5)
        End If
    End If
    If Len(CheckStr(o_tmp5)) <> 0 Then
        If Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("收件人：" & o_tmp5, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) = 0 Then
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp5 = fn_StrToWordFmt("　　　：" & o_tmp5, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp4)) <> 0 Then
        If Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("收件人：" & o_tmp4, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) = 0 Then
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp4 = fn_StrToWordFmt("　　　：" & o_tmp4, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp3)) <> 0 Then
        If Len(CheckStr(o_tmp2)) + Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("收件人：" & o_tmp3, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) = 0 Then
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp3 = fn_StrToWordFmt("　　　：" & o_tmp3, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp2)) <> 0 Then
        If Len(CheckStr(o_tmp1)) = 0 Then
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("收件人：" & o_tmp2, 29)
            End If
        Else
            If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) = 0 Then
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 29) & "電話：" & StrTemp5(5)
            Else
                o_tmp2 = fn_StrToWordFmt("　　　：" & o_tmp2, 29)
            End If
        End If
    End If
    If Len(CheckStr(o_tmp1)) <> 0 Then
        If Len(CheckStr(o_tmp6)) + Len(CheckStr(o_tmp5)) + Len(CheckStr(o_tmp4)) + Len(CheckStr(o_tmp3)) + Len(CheckStr(o_tmp2)) = 0 Then
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 29) & "電話：" & StrTemp5(5)
        Else
            o_tmp1 = fn_StrToWordFmt("收件人：" & o_tmp1, 29)
        End If
    End If
    isPrintDate = False
    'g_WordAp.
    fn_PutWords "客戶案件總簿", wdAlignParagraphCenter, "細明體", 22, False, True, True
    fn_PutWords "（商標）", wdAlignParagraphCenter, , 16
    If Len(o_tmp1) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp1, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp1, 80), , , 10
        End If
    End If
    If Len(o_tmp2) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp2, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp2, 80), , , 10
        End If
    End If
    If Len(o_tmp3) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp3, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp3, 80), , , 10
        End If
    End If
    If Len(o_tmp4) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp4, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp4, 80), , , 10
        End If
    End If
    If Len(o_tmp5) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp5, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp5, 80), , , 10
        End If
    End If
    If Len(o_tmp6) <> 0 Then
        If isPrintDate = False Then
            fn_PutWords fn_StrToWordFmt(o_tmp6, 69) & "列印日期：" & ChangeTStringToTDateString(strSrvDate(2)), , , 10
            isPrintDate = True
        Else
            fn_PutWords fn_StrToWordFmt(o_tmp6, 80), , , 10
        End If
    End If
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("地址：" & StrTemp5(4), 29) & "E-mail：" & StrTemp5(7), 69) & "Page：" & str(Page), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(6), 29) & "傳真：" & StrTemp5(9), 69), , , 10
    'Modify by Amy 2019/08/29 原:接洽人-秀玲
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt(fn_StrToWordFmt("　　　" & StrTemp5(8), 29) & "預設接洽人：" & GetCU08(strTemp(20)), 47.5) & "智權人員：" & Me.txt1(11).Text & " " & GetStaffName(Me.txt1(11).Text, True), 69), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 47) & "A：原為聯合商標　B:原為服務標章　C:原為聯合服務標章", 80), , , 10
    If Len(StrTemp5(10)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(10), 29), , , 10
    End If
    If Len(StrTemp5(11)) <> 0 Then
        fn_PutWords fn_StrToWordFmt("　　　" & StrTemp5(11), 29), , , 10
    End If
    fn_PutWords fn_StrLineToWord("="), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("本所案號", 11) & fn_StrToWordFmt("商標名稱", 18) & fn_StrToWordFmt("申請日", 7) & fn_StrToWordFmt("申請案號", 11) & fn_StrToWordFmt("種類", 5) & fn_StrToWordFmt("案件性質", 7) & fn_StrToWordFmt("專　用　期　限", 12) & "最近期限", 80), , , 10
    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("客戶案件案號", 29) & fn_StrToWordFmt("申請國家", 7) & fn_StrToWordFmt("審定號數", 11) & fn_StrToWordFmt("准駁", 12) & fn_StrToWordFmt("商品類別", 9) & fn_StrToWordFmt("閉卷", 3) & "(程序)", 80), , , 10
    fn_PutWords fn_StrLineToWord("="), , , 10
End If
End Sub

'add by nickc 2005/11/03 群組
Private Sub ProcessP_Grp()

SelectGrpData
'add by nickc 2005/11/09 紙本
If Check3(0).Value = vbChecked Then
    '若下所有程序或英日報表
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        Printer.Orientation = 1
        'Modified by Morgan 2015/6/2
        'Printer.PaperSize = 39
        Printer.PaperSize = PUB_GetPaperSize(15)
        'END 2015/6/2
        o_PaperHeight = 14200
    '其他
    Else
        Printer.Orientation = 2
        Printer.PaperSize = 9
        o_PaperHeight = 10000
    End If
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        o_PaperHeight = 50 'Modify by Amy 2019/11/21 原:56
    Else
        o_PaperHeight = 40
    End If
End If
m_strPrintKind = "0"
cnnConnection.Execute "delete from R050317_C WHERE ID='" & strUserNum & "' "     '語文為中文      對內
cnnConnection.Execute "DELETE FROM R050317_E WHERE ID='" & strUserNum & "' "     '語文為英文    對外
cnnConnection.Execute "DELETE FROM R050317_J WHERE ID='" & strUserNum & "' "     '語文為日文   對外
strSQL1 = ""
strSQL2 = ""
StrSQL3 = ""
StrSQL4 = ""
strSQL5 = ""
'初始化變數
m_strSQL1_2 = "": m_strSQL1_3 = "": m_strSQL1_4 = "": m_strSQL1_5 = ""
m_strSQL5_2 = "": m_strSQL5_3 = ""
'edit by nickc 2006/06/29 此段程式碼取消，不然相關案出不來
'strSQL1 = strSQL1 + " AND (PA26>='" & GetNewFagent(txt1(0)) & "' AND PA26<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
'm_strSQL1_2 = m_strSQL1_2 + " AND (PA27>='" & GetNewFagent(txt1(0)) & "' AND PA27<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
'm_strSQL1_3 = m_strSQL1_3 + " AND (PA28>='" & GetNewFagent(txt1(0)) & "' AND PA28<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
'm_strSQL1_4 = m_strSQL1_4 + " AND (PA29>='" & GetNewFagent(txt1(0)) & "' AND PA29<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
'm_strSQL1_5 = m_strSQL1_5 + " AND (PA30>='" & GetNewFagent(txt1(0)) & "' AND PA30<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
strSQL1 = strSQL1 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
m_strSQL1_2 = m_strSQL1_2 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
m_strSQL1_3 = m_strSQL1_3 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
m_strSQL1_4 = m_strSQL1_4 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
m_strSQL1_5 = m_strSQL1_5 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "

'智權人員
If Me.txt1(11).Text <> "" Then
    strSQL1 = strSQL1 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_2 = m_strSQL1_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_3 = m_strSQL1_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_4 = m_strSQL1_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_5 = m_strSQL1_5 + " AND CU13='" & Me.txt1(11).Text & "' "
'Add By Cheng 2003/07/21
'若未輸入智權人員
Else
    strSQL1 = strSQL1 + " AND CU13 Is Null "
    m_strSQL1_2 = m_strSQL1_2 + " AND CU13 Is Null "
    m_strSQL1_3 = m_strSQL1_3 + " AND CU13 Is Null "
    m_strSQL1_4 = m_strSQL1_4 + " AND CU13 Is Null "
    m_strSQL1_5 = m_strSQL1_5 + " AND CU13 Is Null "
End If
CheckOC
Select Case txt1(10)
Case 1 '中文報表
      If intPCaseKind = 專利 And intPWhere = 國外_CF Then
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        End If
      Else
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
'            strSQL = strSQL + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
'            strSQL = strSQL + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
'            strSQL = strSQL + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
'            strSQL = strSQL + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
            strSql = " SELECT PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " union all SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " union all SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " union all SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " union all SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01, PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        End If
      End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = LBound(strTemp) To UBound(strTemp)
                    strTemp(i) = ""
                Next i
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If Right(strTemp(16), 1) = "*" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = Replace(strTemp(16), "*", "閉卷")
                End If
                strTemp(23) = "" & .Fields(22).Value
                CheckOC2
                strSql = "select min(pd05) from pridate where pd01='" & CheckStr(.Fields(18)) & "' and pd02='" & CheckStr(.Fields(19)) & "' and pd03='" & CheckStr(.Fields(20)) & "' and pd04='" & CheckStr(.Fields(21)) & "' "
                adoRecordset1.CursorLocation = adUseClient
                adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                If adoRecordset1.RecordCount <> 0 Then
                     strTemp(24) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                Else
                     strTemp(24) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND np07 <> 6001 And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 中文新增 R013028 存CP31
                strSql = "INSERT INTO R050317_C " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & PUB_GetRelateCasePropertyName(strTemp(17), Me.txt1(10).Text) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','" & "" & .Fields("CP57").Value & "',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
            'Modify by Amy 2017/07/25 更新R013028
            If IsHaveData = True Then
                strSql = "Update R050317_C Set R013028=(Select CP31 From CaseProgress Where R013018=CP09(+)) Where ID='" & strUserNum & "'"
                cnnConnection.Execute strSql
            End If
            'end 2017/07/25
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            '
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_c WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 2 '英文報表
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            strSql = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
            strSql = " SELECT PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union all SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union all SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union all SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union all SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "Closed"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_E " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            '
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 3 '日文報表
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            strSql = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
            strSql = " SELECT PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union All SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union All SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union All SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union All SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01, PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        End If
    CheckOC
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "ゾゆ"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_J " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & " ','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            '
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case Else
End Select
'Add by Amy 2017/12/26 剔除D類
cnnConnection.Execute "Delete From R050317_C WHERE ID='" & strUserNum & "'  And SubStr(R013018,1,1)='D' "     '語文為中文      對內
cnnConnection.Execute "Delete From R050317_E WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為英文    對外
cnnConnection.Execute "Delete From R050317_J WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為日文   對外
'end 2017/12/26
Select Case txt1(10)
Case 1     '中文
   PrintDataCp_Grp
Case 2     '英文
    'edit by nickc 2005/11/08 暫不做
    'PrintDataEp_Grp
Case 3     '日文
    'edit by nickc 2005/11/08 暫不做
    'PrintDataJp_Grp
Case Else
End Select
'ShowPrintOk
'Screen.MousePointer = vbDefault
End Sub
'add by nickc 2005/11/03 群組
Private Sub ProcessP_1_Grp()
Dim ii As Integer
Dim blnMatchKind As Boolean

On Error GoTo ErrHnd

Screen.MousePointer = vbHourglass
SelectGrpData
'add by nickc 2005/11/09 紙本
If Check3(0).Value = vbChecked Then
    '若下所有程序或英日報表
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        Printer.Orientation = 1
        'Modified by Morgan 2015/6/2
        'Printer.PaperSize = 39
        Printer.PaperSize = PUB_GetPaperSize(15)
        'END 2015/6/2
        o_PaperHeight = 14200
    '其他
    Else
        Printer.Orientation = 2
        Printer.PaperSize = 9
        o_PaperHeight = 10000
    End If
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    If Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3" Then
        o_PaperHeight = 50 'Modify by Amy 2019/11/21 原:56
    Else
        o_PaperHeight = 40
    End If
End If
m_strPrintKind = "1"
blnMatchKind = False
cnnConnection.Execute "delete from R050317_C WHERE ID='" & strUserNum & "' "     '語文為中文      對內
cnnConnection.Execute "DELETE FROM R050317_E WHERE ID='" & strUserNum & "' "     '語文為英文    對外
cnnConnection.Execute "DELETE FROM R050317_J WHERE ID='" & strUserNum & "' "     '語文為日文   對外
strSQL1 = ""
strSQL2 = ""
StrSQL3 = ""
StrSQL4 = ""
strSQL5 = ""
'初始化變數
m_strSQL1_2 = "": m_strSQL1_3 = "": m_strSQL1_4 = "": m_strSQL1_5 = ""
m_strSQL5_2 = "": m_strSQL5_3 = ""
'edit by nickc 2006/06/29 此段程式碼取消，不然相關案出不來
'strSQL1 = strSQL1 + " AND (PA26>='" & GetNewFagent(txt1(0)) & "' AND PA26<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
'm_strSQL1_2 = m_strSQL1_2 + " AND (PA27>='" & GetNewFagent(txt1(0)) & "' AND PA27<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
'm_strSQL1_3 = m_strSQL1_3 + " AND (PA28>='" & GetNewFagent(txt1(0)) & "' AND PA28<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
'm_strSQL1_4 = m_strSQL1_4 + " AND (PA29>='" & GetNewFagent(txt1(0)) & "' AND PA29<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
'm_strSQL1_5 = m_strSQL1_5 + " AND (PA30>='" & GetNewFagent(txt1(0)) & "' AND PA30<='" & GetNewFagent(txt1(1)) & "') and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
strSQL1 = strSQL1 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
m_strSQL1_2 = m_strSQL1_2 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
m_strSQL1_3 = m_strSQL1_3 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
m_strSQL1_4 = m_strSQL1_4 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "
m_strSQL1_5 = m_strSQL1_5 + " and r001001=pa01(+) and r001002=pa02(+) and r001003=pa03(+) and r001004=pa04(+) and id='" & strUserNum & "' "

'智權人員
If Me.txt1(11).Text <> "" Then
    strSQL1 = strSQL1 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_2 = m_strSQL1_2 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_3 = m_strSQL1_3 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_4 = m_strSQL1_4 + " AND CU13='" & Me.txt1(11).Text & "' "
    m_strSQL1_5 = m_strSQL1_5 + " AND CU13='" & Me.txt1(11).Text & "' "
'Add By Cheng 2003/07/21
'若未輸入智權人員
Else
    strSQL1 = strSQL1 + " AND CU13 Is Null "
    m_strSQL1_2 = m_strSQL1_2 + " AND CU13 Is Null "
    m_strSQL1_3 = m_strSQL1_3 + " AND CU13 Is Null "
    m_strSQL1_4 = m_strSQL1_4 + " AND CU13 Is Null "
    m_strSQL1_5 = m_strSQL1_5 + " AND CU13 Is Null "
End If
'Add By Cheng 2004/04/19
'若選擇列印首次接洽或最新收文程序
If Me.txt1(15).Text = "1" Or Me.txt1(15).Text = "2" Then
    strSQL1 = strSQL1 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL)" & _
      "))"
    m_strSQL1_2 = m_strSQL1_2 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL)" & _
      "))"
    m_strSQL1_3 = m_strSQL1_3 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL)" & _
      "))"
    m_strSQL1_4 = m_strSQL1_4 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL)" & _
      "))"
    m_strSQL1_5 = m_strSQL1_5 + " AND (CP57 Is Null" & _
      " OR (CP09=(SELECT MIN(B.CP09) FROM CASEPROGRESS B WHERE B.CP01=A.CP01 AND B.CP02=A.CP02 AND B.CP03=A.CP03 AND B.CP04=A.CP04)" & _
      " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C WHERE C.CP01=A.CP01 AND C.CP02=A.CP02 AND C.CP03=A.CP03 AND C.CP04=A.CP04 AND C.CP57 IS NULL)" & _
      "))"
End If
'End
CheckOC
Select Case txt1(10)
Case 1 '中文報表
      If intPCaseKind = 專利 And intPWhere = 國外_CF Then
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT distinct PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & strSQL1
'            strSQL = strSQL + " union SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
'            strSQL = strSQL + " union SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
'            strSQL = strSQL + " union SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
'            strSQL = strSQL + " union SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
            strSql = " SELECT distinct PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               " AND ((CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & strSQL1
            strSql = strSql + " union SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03)  " & _
                            ",Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
            strSql = strSql + " union SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03) " & _
                            ",Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
            strSql = strSql + " union SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03) " & _
                            ",Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
            strSql = strSql + " union SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03) " & _
                            ",Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
        
        '若為首次或最新程序(只抓A, B類)
        Else
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT distinct PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & strSQL1
'            strSQL = strSQL + " union SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
'            strSQL = strSQL + " union SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
'            strSQL = strSQL + " union SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
'            strSQL = strSQL + " union SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),ptm03,Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
            strSql = " SELECT distinct PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate(" PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & strSQL1
            strSql = strSql + " union SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
            strSql = strSql + " union SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
            strSql = strSql + " union SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
            strSql = strSql + " union SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(pA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
        End If
      Else
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT distinct PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & strSQL1
'            strSQL = strSQL + " union SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h " & _
'                           " WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
'            strSQL = strSQL + " union SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h " & _
'                           " WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
'            strSQL = strSQL + " union SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h " & _
'                           " WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
'            strSQL = strSQL + " union SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h " & _
'                           " WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
            strSql = " SELECT distinct PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04" & _
               "  AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & strSQL1
            strSql = strSql + " union SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h " & _
                           " WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_2
            strSql = strSql + " union SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h " & _
                           " WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_3
            strSql = strSql + " union SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h " & _
                           " WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_4
            strSql = strSql + " union SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09,cp01,cp02,cp03,cp04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h " & _
                           " WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01 AND PA02=CP02 AND PA03=CP03 AND PA04=CP04 AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201) or (CP09>'B' And CP09<'C' And CP10 In ('907', '913'))) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00'  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
'edit by nickc 2008/03/07  專利種類改  大陸抓 04
'            strSQL = " SELECT distinct PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & strSQL1
'            strSQL = strSQL + " union SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_2
'            strSQL = strSQL + " union SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_3
'            strSQL = strSQL + " union SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_4
'            strSQL = strSQL + " union SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'000',ptm03,ptm04),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_5
            strSql = " SELECT distinct PA26,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & strSQL1
            strSql = strSql + " union SELECT PA27,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_2
            strSql = strSql + " union SELECT PA28,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_3
            strSql = strSql + " union SELECT PA29,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_4
            strSql = strSql + " union SELECT PA30,pa77,NVL(Decode(CU04,Null,Decode(CU05,Null,CU06,CU05||' '||CU88||' '||CU89||' '||CU90),CU04),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(decode(pa09,'000',cpm03,cpm04),Nvl(CPM10,CPM13)),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存在','N','消滅',''),decode(pa09,'020',ptm04,ptm03),Nvl(PA05,Nvl(PA06,PA07)),CP05," & SQLDate("CP57") & "||Decode(PA57,'Y','*',''),cp09, PA01,PA02, PA03, PA04," & SQLDate("PA10") & ", CP57 FROM PATENT,CASEPROGRESS A,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND 'C'>CP09(+) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+) AND PA04='00' " & m_strSQL1_5
        End If
      End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = LBound(strTemp) To UBound(strTemp)
                    strTemp(i) = ""
                Next i
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If Right(strTemp(16), 1) = "*" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = Replace(strTemp(16), "*", "閉卷")
                End If
                '申請日
                strTemp(23) = "" & .Fields(22).Value
                CheckOC2
                strSql = "select min(pd05) from pridate where pd01='" & CheckStr(.Fields(18)) & "' and pd02='" & CheckStr(.Fields(19)) & "' and pd03='" & CheckStr(.Fields(20)) & "' and pd04='" & CheckStr(.Fields(21)) & "' "
                adoRecordset1.CursorLocation = adUseClient
                adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                If adoRecordset1.RecordCount <> 0 Then
                     strTemp(24) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                Else
                     strTemp(24) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND np07 <> 6001 And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " And NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 中文新增 R013028 存CP31
                strSql = "INSERT INTO R050317_C " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & PUB_GetRelateCasePropertyName(strTemp(17), Me.txt1(10).Text) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','" & strTemp(23) & "','" & strTemp(24) & "','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','" & "" & .Fields("CP57").Value & "',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
            'Modify by Amy 2017/07/25 更新R013028
            If IsHaveData = True Then
                strSql = "Update R050317_C Set R013028=(Select CP31 From CaseProgress Where R013018=CP09(+)) Where ID='" & strUserNum & "'"
                cnnConnection.Execute strSql
            End If
            'end 2017/07/25
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            '
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_c WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_C WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 2 '英文報表
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            strSql = " SELECT distinct PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
            strSql = " SELECT distinct PA26,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND SUBSTR(PA26,9,1)=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union SELECT PA27,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA27),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND SUBSTR(PA27,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union SELECT PA28,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA28),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND SUBSTR(PA28,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union SELECT PA29,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA29),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND SUBSTR(PA29,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union SELECT PA30,pa77,NVL(Decode(CU05,Null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90),PA30),pa11,NVL(NA01,PA09),NVL(Nvl(cpm10,CPM13),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','Yes','N','Cancelled',''),ptm05,Nvl(PA06,PA07),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND SUBSTR(PA30,9,1)=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        End If
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "Closed"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_E " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & "','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_E WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_E WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case 3 '日文報表
        '若為所有程序
        If Me.txt1(15).Text = "3" Then
            strSql = " SELECT distinct PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09,cp01,cp02,cp03,cp04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND (CP09<'B' or  CP09>'C' or (CP09>'B' And CP09<'C' And CP05>19221111 And CP05<20030201)) AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        '若為首次或最新程序(只抓A, B類)
        Else
            'Modify By Cheng 2003/08/27
            strSql = " SELECT distinct PA26,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA26,1,8)=CU01(+) AND DECODE(SUBSTR(PA26,9,1),NULL,'0',SUBSTR(PA26,9,1))=CU02(+) AND PA09=NA01(+)  " & strSQL1
            strSql = strSql + " Union SELECT PA27,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA27,1,8)=CU01(+) AND DECODE(SUBSTR(PA27,9,1),NULL,'0',SUBSTR(PA27,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_2
            strSql = strSql + " Union SELECT PA28,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA28,1,8)=CU01(+) AND DECODE(SUBSTR(PA28,9,1),NULL,'0',SUBSTR(PA28,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_3
            strSql = strSql + " Union SELECT PA29,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA29,1,8)=CU01(+) AND DECODE(SUBSTR(PA29,9,1),NULL,'0',SUBSTR(PA29,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_4
            strSql = strSql + " Union SELECT PA30,pa77,NVL(Decode(cu06,Null,CU05||' '||CU88||' '||CU89||' '||CU90,CU06),PA26),pa11,NVL(NA01,PA09),NVL(Nvl(cpm13,CPM10),CP10)," & SQLDate("cp27") & ",' ',pa48,PA01||'-'||PA02||decode(pa03||pa04,'000','','-'||PA03||'-'||PA04),PA22,pa25,decode(pa17,'Y','存 ','N','消滅',''),ptm06,Nvl(PA07,PA06),CP05,pA57,cp09, PA01,PA02, PA03, PA04 FROM PATENT,CASEPROGRESS,PATENTTRADEMARKMAP,CASEPROPERTYMAP,CUSTOMER,NATION,r100101_h WHERE cP01=CPM01(+) AND CP10=CPM02(+) AND '1'=PTM01(+) AND PA08=PTM02(+) AND PA01=CP01(+) AND PA02=CP02(+) AND PA03=CP03(+) AND PA04=CP04(+) AND CP09<'C' AND SUBSTR(PA30,1,8)=CU01(+) AND DECODE(SUBSTR(PA30,9,1),NULL,'0',SUBSTR(PA30,9,1))=CU02(+) AND PA09=NA01(+)  " & m_strSQL1_5
        End If
    CheckOC
    adoRecordset.CursorLocation = adUseClient
    k = 0
    adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
    If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/01/22
        With adoRecordset
            .MoveFirst
            DoEvents
            Do While .EOF = False
                For i = 0 To 18
                    strTemp(i) = CheckStr(.Fields(i))
                Next i
                If strTemp(16) = "Y" Then
                    strTemp(9) = "*" + strTemp(9)
                    strTemp(16) = "ゾゆ"
                Else
                    strTemp(16) = ""
                End If
                Select Case CheckSys(CheckStr(.Fields(18)))
                Case "1", "5"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (411,997,998,995,996,999,1204,1503,1601) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "3", "4", "7", "8"
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & " and np07 <> 6001 AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' AND NP08>=" & Val(strSrvDate(1)) & strNpSqlOfNoSalesDuty & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                Case "2", "6"
                     'Modify by Morgan 2009/7/13 +995,996
                     'Modify by Morgan 2011/6/10 排除程序管制的案件性質改用 strNpSqlOfNoSalesDuty 常數
                     'strSQL = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' and NP07 not in (305,997,998,995,996,1403) AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     strSql = "select  MIN(np08)  from nextprogress where np02='" & CheckStr(.Fields(18)) & "' and np03='" & CheckStr(.Fields(19)) & "' and np04='" & CheckStr(.Fields(20)) & "' and np05='" & CheckStr(.Fields(21)) & "' " & strNpSqlOfNoSalesDuty & " AND NP08>=" & Val(strSrvDate(1)) & " AND NP06 IS NULL "
                     CheckOC2
                     adoRecordset1.CursorLocation = adUseClient
                     adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                     If adoRecordset1.RecordCount <> 0 Then
                        strTemp(7) = ChangeTStringToTDateString(ChangeWStringToTString(CheckStr(adoRecordset1.Fields(0))))
                     Else
                        strTemp(7) = ""
                     End If
                     CheckOC2
                End Select
                'Modify By Sindy 2012/7/25 新增一個欄位 R013027=null,與frm210138共用暫存檔
                'Modify by Amy 2017/07/25 +strTBF
                strSql = "INSERT INTO R050317_J " & strTBF & " values ('" & ChgSQL(strTemp(0)) & "','" & ChgSQL(strTemp(1)) & "','" & ChgSQL(strTemp(2)) & "','" & ChgSQL(strTemp(3)) & "','" & ChgSQL(strTemp(4)) & "','" & ChgSQL(strTemp(5)) & "','" & ChgSQL(strTemp(6)) & "','" & ChgSQL(strTemp(7)) & "','" & ChgSQL(strTemp(8)) & "','" & ChgSQL(strTemp(9)) & "','" & ChgSQL(strTemp(10)) & "','" & ChgSQL(strTemp(11)) & "','" & ChgSQL(strTemp(12)) & " ','" & ChgSQL(strTemp(13)) & "','" & ChgSQL(strTemp(14)) & "','" & ChgSQL(strTemp(15)) & "','" & ChgSQL(strTemp(16)) & "','" & ChgSQL(strTemp(17)) & "','" & ChgSQL(strTemp(18)) & "','" & strUserNum & "','','','" & .Fields(18).Value & "','" & .Fields(19).Value & "','" & .Fields(20).Value & "','" & .Fields(21).Value & "','',null) "
                cnnConnection.Execute strSql
                'add by nickc 2005/11/16
                IsHaveData = True
                k = k + 1
                DoEvents
                .MoveNext
            Loop
        End With
        If Val(txt1(5)) = 1 Then
            strSql = "SELECT R013010,MAX(R013016) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 & " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 & " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013016 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MIN(R013008) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "' GROUP BY R013010 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 Then
               strSQL1 = " ("
               strSQL2 = " ("
               Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
               Loop
               strSQL1 = strSQL1 + ") "
               strSQL2 = strSQL2 + ") "
               cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013008 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND ID='" & strUserNum & "'  GROUP BY R013010 "
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            strSql = "SELECT R013010,MAX(R013018) FROM R050317_J WHERE "
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                strSQL1 = " ("
                strSQL2 = " ("
                Do While adoRecordset1.EOF = False
                  strSQL1 = strSQL1 + " '" & ChgSQL(CheckStr(adoRecordset1.Fields(0))) & "' "
                  strSQL2 = strSQL2 + " '" & CheckStr(adoRecordset1.Fields(1)) & "' "
                  adoRecordset1.MoveNext
                  If adoRecordset1.EOF = False Then
                     strSQL1 = strSQL1 + ","
                     strSQL2 = strSQL2 + ","
                  End If
                Loop
                strSQL1 = strSQL1 + ") "
                strSQL2 = strSQL2 + ") "
                cnnConnection.Execute "DELETE FROM R050317_J WHERE (R013018<'B' or R013018>'C') AND (R013010 NOT IN " & strSQL1 & " OR R013018 NOT IN " & strSQL2 & ") AND ID='" & strUserNum & "' "
            End If
            CheckOC2
        End If
    Else
        InsertQueryLog (0) 'Add By Sindy 2010/01/22
        ShowNoData
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    CheckOC
Case Else
End Select
'Add by Amy 2017/12/26 剔除D類
cnnConnection.Execute "Delete From R050317_C WHERE ID='" & strUserNum & "'  And SubStr(R013018,1,1)='D' "     '語文為中文      對內
cnnConnection.Execute "Delete From R050317_E WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為英文    對外
cnnConnection.Execute "Delete From R050317_J WHERE ID='" & strUserNum & "' And SubStr(R013018,1,1)='D' "     '語文為日文   對外
'end 2017/12/26
Select Case txt1(10)
Case 1     '中文
    '列印所有程序
    If Me.txt1(15).Text = "3" Then
         PrintDataCp_Grp
    '列印首次或最新程序
    Else
         PrintDataCp_A4_Grp
    End If
Case 2     '英文
   'edit by nickc 2005/11/08 暫不做
   'PrintDataEp_Grp
Case 3     '日文
   'edit by nickc 2005/11/08 暫不做
   'PrintDataJp_Grp
Case Else
End Select
'Screen.MousePointer = vbDefault
ErrHnd:
   If Err.Number <> 0 Then MsgBox Err.Description, vbCritical

End Sub

Private Sub PrintDataCp_Grp()
'Add By Cheng 2003/02/07
Dim strCust As String '記錄申請人
'Add By Cheng 2003/02/10
Dim strSystemKind As String '記錄系統類別
'Add By Cheng 2003/02/27
Dim blnFirstPage As Boolean '判斷是否第一頁

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True


'Add By Cheng 2003/02/27
'列印第一頁
blnFirstPage = True
strSql = "SELECT DISTINCT min(R013001),substr(r013001,1,6) FROM R050317_C WHERE ID='" & strUserNum & "'  GROUP BY substr(r013001,1,6) ORDER BY substr(r013001,1,6) "
CheckOC
Page = Page + 1
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   'Add By Cheng 2002/02/27
   RefreshColData 1, "申請人"
    With adoRecordset
        .MoveFirst
        '記錄申請人
        strCust = "" & .Fields(0).Value
        '記錄系統類別
        strSystemKind = ""
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields(0))
            strTemp(21) = ""
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU58,CU61 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 13
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            
            'Add By Cheng 2003/02/07
            '若申請人不同則跳頁
            If strCust <> strTemp(20) Then
                'add by nickc 2005/11/15
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(0)
                    Printer.CurrentY = iPrint
                    Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                    Printer.Line (0, iPrint)-(19200, iPrint)
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 96), , , 10
                    fn_PutWords fn_StrLineToWord(, False), , , 10
                End If
                strCust = strTemp(20)
                'Add By Cheng 2003/02/27
                strSystemKind = ""
                Page = Page + 1
                'add  by nickc 2005/11/15  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.NewPage
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_DocNewPage
                End If
                PrintTitleCp
            End If
            'Modify By Cheng 2003/02/27
            '若為第一頁才印表頭
'            PrintTitleCp
            strSeekGroup = ""
            If blnFirstPage = True Then PrintTitleCp: blnFirstPage = False
            '初始化本所案號變數
            SeekTempPrint = ""
            'edit by nickc 2008/04/15 所有程序抓 cp其餘抓pa
            'Modify by Amy 2017/07/25 +R013022/23/24/25/28
            If txt1(15) = "3" Then
                strSql = "SELECT distinct r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,CP24, r013020, r013021,r001005,r001001,r001002,r001003,r001004,R013022,R013023,R013024,R013025,R013028  From R050317_C tmpM,caseprogress,r100101_h tmpH WHERE r013018=cp09(+) and substr(R013001,1,6)='" & Mid(strTemp(20), 1, 6) & "' AND tmpM.ID='" & strUserNum & "' and tmpH.id='" & strUserNum & "' and r001001=r013022 and r001002=r013023 and r001003=r013024 and r001004=r013025 "
            Else
                strSql = "SELECT distinct r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,CP05,CP09,pa16 as CP24, r013020, r013021,r001005,r001001,r001002,r001003,r001004,R013022,R013023,R013024,R013025,R013028 From R050317_C tmpM,caseprogress,r100101_h tmpH,patent WHERE r013018=cp09(+) and substr(R013001,1,6)='" & Mid(strTemp(20), 1, 6) & "' AND tmpM.ID='" & strUserNum & "' and tmpH.id='" & strUserNum & "' and r001001=r013022 and r001002=r013023 and r001003=r013024 and r001004=r013025 and cp01=pa01(+) and cp02=pa02(+) and cp03=pa03(+) and cp04=pa04(+) "
            End If
            'end 2017/07/25
            
            '依本所案號排序
            strSql = strSql & " ORDER BY r001005,r001001,r013001,r001002,r001003,r001004 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    For i = 0 To 19
                           strTemp(i) = "" & adoRecordset1.Fields(i + 1)
                    Next i
                    strTemp(22) = ""
                    strTemp(23) = ""
                    strTemp(24) = ""
                    '若本所案號變數無資料
                    If SeekTempPrint = "" Then
                        SeekTempPrint = strTemp(8)
                        strTemp(0) = StrToStr(strTemp(0), 15)
                        strTemp(1) = StrToStr(strTemp(1), 10)
                        strTemp(2) = StrToStr(strTemp(2), 10)
                        strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                        strTemp(4) = StrToStr(strTemp(4), 38)
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        strTemp(9) = Format(StrToStr(strTemp(9) & String(20, " "), 10) & " ", "@@@@@@@@@@@@@@@@@@@@") & "/(" & StrToStr(Format(ChangeWStringToWDateString(strTemp(10)) & String(10, " "), "@@@@@@@@@@"), 5) & ")/" & strTemp(11)
                        strTemp(10) = StrToStr(strTemp(12), 10)
                        strTemp(11) = StrToStr(strTemp(13), 25)
                        strTemp(13) = strTemp(6)
                        strTemp(12) = ""
                        strTemp(6) = "" & strTemp(15)
                        If Right(strTemp(6), 2) = "閉卷" Then
                            strTemp(6) = Replace(strTemp(6), "閉卷", "")
                            strTemp(22) = "閉卷"
                        End If
                        strTemp(14) = IIf(strTemp(19) = "1", "准", IIf(strTemp(19) = "2", "駁", ""))
                        strTemp(23) = "" & adoRecordset1.Fields(21).Value
                        strTemp(24) = "" & adoRecordset1.Fields(22).Value
                    '若本所案號變數有資料
                    Else
                        '若本所案號不同
                        If SeekTempPrint <> strTemp(8) Then
                           'add  by nickc 2005/11/03  紙本
                           If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                iPrint = iPrint + 300
                           ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                           End If
                           SeekTempPrint = strTemp(8)
                           'edit by nickc 2005/11/17
                           'If iPrint >= 14200 Then
                           If iPrint >= o_PaperHeight Then
                              'add  by nickc 2005/11/15  紙本
                              If Check3(0).Value = vbChecked Then
                                    Printer.CurrentX = PLeft(0)
                                    Printer.CurrentY = iPrint
                                    Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                                    Printer.Line (0, iPrint)-(19200, iPrint)
                              ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                    fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 96), , , 10
                                    fn_PutWords fn_StrLineToWord(, False), , , 10
                              End If
                              Page = Page + 1
                              'add  by nickc 2005/11/15  紙本
                              If Check3(0).Value = vbChecked Then
                                  Printer.NewPage
                              ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                  fn_DocNewPage
                              End If
                              PrintTitleCp
                           End If
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = Format(StrToStr(strTemp(9) & String(20, " "), 10) & " ", "@@@@@@@@@@@@@@@@@@@@") & "/(" & StrToStr(Format(ChangeWStringToWDateString(strTemp(10)) & String(10, " "), "@@@@@@@@@@"), 5) & ")/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = strTemp(6)
                           strTemp(12) = ""
                           strTemp(6) = "" & strTemp(15)
                            If Right(strTemp(6), 2) = "閉卷" Then
                                strTemp(6) = Replace(strTemp(6), "閉卷", "")
                                strTemp(22) = "閉卷"
                            End If
                            strTemp(14) = IIf(strTemp(19) = "1", "准", IIf(strTemp(19) = "2", "駁", ""))
                            strTemp(23) = "" & adoRecordset1.Fields(21).Value
                            strTemp(24) = "" & adoRecordset1.Fields(22).Value
                        '若本所案號相同
                        Else
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = Format(StrToStr(strTemp(9) & String(20, " "), 10) & " ", "@@@@@@@@@@@@@@@@@@@@") & "/(" & StrToStr(Format(ChangeWStringToWDateString(strTemp(10)) & String(10, " "), "@@@@@@@@@@"), 5) & ")/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = strTemp(6)
                           strTemp(12) = ""
                           strTemp(6) = "" & strTemp(15)
                            If Right(strTemp(6), 2) = "閉卷" Then
                                strTemp(6) = Replace(strTemp(6), "閉卷", "")
                                strTemp(22) = "閉卷"
                            End If
                            strTemp(14) = IIf(strTemp(19) = "1", "准", IIf(strTemp(19) = "2", "駁", ""))
                            strTemp(23) = "" & adoRecordset1.Fields(21).Value
                            strTemp(24) = "" & adoRecordset1.Fields(22).Value
                           For i = 0 To 3
                              strTemp(i) = ""
                           Next i
                           For i = 6 To 13
                              strTemp(i) = ""
                           Next i
                            strTemp(22) = ""
                            strTemp(23) = ""
                        End If
                    End If
                    'edit by nickc 2005/11/17
                    'If iPrint >= 14200 Then
                    If iPrint >= o_PaperHeight Then
                        'add  by nickc 2005/11/03  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.CurrentX = PLeft(0)
                            Printer.CurrentY = iPrint
                            Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                            Printer.Line (0, iPrint)-(19200, iPrint)
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 96), , , 10
                            fn_PutWords fn_StrLineToWord(, False), , , 10
                        End If
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_DocNewPage
                        End If
                        PrintTitleCp
                    End If
                    If strSeekGroup = "" Then
                        strSeekGroup = CheckStr(adoRecordset1.Fields("r001005").Value)
                    End If
                    If strSeekGroup <> CheckStr(adoRecordset1.Fields("r001005").Value) Then
                        'add  by nickc 2005/11/03  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.Line (0, iPrint - 200)-(19200, iPrint - 200)
                            Printer.Line (0, iPrint - 250)-(19200, iPrint - 250)
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            g_WordAp.Application.Selection.HomeKey Unit:=wdLine, Extend:=wdExtend
                            fn_PutWords fn_StrLineToWord("=", False), , , 10, False
                        End If
                        strSeekGroup = CheckStr(adoRecordset1.Fields("r001005").Value)
                    End If
                    '列印明細資料
                    PrintDatilCp
                    'Add by Amy 2017/07/25 +顯示優先權資料
                    If iPrint >= o_PaperHeight Then
                        '紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.CurrentX = PLeft(0)
                            Printer.CurrentY = iPrint
                            Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                            Printer.Line (0, iPrint)-(19200, iPrint)
                        ElseIf Check10(0).Value = vbChecked Then
                            fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 96), , , 10
                            fn_PutWords fn_StrLineToWord(, False), , , 10
                        End If
                        Page = Page + 1
                        '紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then
                            fn_DocNewPage
                        End If
                        PrintTitleCp
                    End If
                    '優先權資料(所有格式只顯示於CP31=Y 那筆)
                    If Not (txt1(15) = "3" And "" & adoRecordset1("R013028") <> "Y") Then
                        PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value, "PrintTitleCp"
                    End If
                    'end 2017/07/25
                    adoRecordset1.MoveNext
                Loop
                'add  by nickc 2005/11/15  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.Line (0, iPrint)-(19200, iPrint)
                    iPrint = iPrint + 100
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrLineToWord(, False), , , 10
                End If
                'edit by nickc 2005/11/17
                'If iPrint >= 14200 Then
                If iPrint >= o_PaperHeight Then
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.CurrentX = PLeft(0)
                        Printer.CurrentY = iPrint
                        Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                        Printer.Line (0, iPrint)-(19200, iPrint)
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 96), , , 10
                        fn_PutWords fn_StrLineToWord(, False), , , 10
                    End If
                    Page = Page + 1
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    PrintTitleCp
                End If
                strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE substr(R013001,1,6)='" & Mid(strTemp(20), 1, 6) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If

                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5) - 3000
                    Printer.CurrentY = iPrint
                    Printer.Print "總計：" & Format(IntTot, "##0")
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 35) & "總計：" & Format(IntTot, "##0"), 52), , , 10
                End If
                strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE substr(R013001,1,6)='" & Mid(strTemp(20), 1, 6) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                'add  by nickc 2005/11/17  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5)
                    Printer.CurrentY = iPrint
                    Printer.Print "閉卷件數：" & Format(IntTot, "##0")
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt("閉卷件數：" & Format(IntTot, "##0"), 17), , , 10, False
                End If
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
End If
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
    Printer.Line (0, iPrint)-(19200, iPrint)
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 96), , , 10
    fn_PutWords fn_StrLineToWord(, False), , , 10
End If
CheckOC
'add  by nickc 2005/11/17  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
End Sub

Private Sub PrintDataCp_A4_Grp()
Dim strCust As String '記錄申請人
Dim strSystemKind As String '記錄系統類別
Dim blnFirstPage As Boolean '判斷是否第一頁
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String '申請人+本所案號
Dim strSeekGroup As String

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True


On Error GoTo ErrHnd

'首次程序
If Me.txt1(15).Text = "1" Then
    StrSQLa = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013001, R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
'最新程序
ElseIf Me.txt1(15).Text = "2" Then
    StrSQLa = "Select * From R050317_C Where ID='" & strUserNum & "' Order By R013001, R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
End If
strCaseNo = " "
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
If rsA.RecordCount > 0 Then
    While Not rsA.EOF
        If strCaseNo <> "" & rsA("R013001").Value & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
            strCaseNo = "" & rsA("R013001").Value & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
        Else
            rsA.Delete
        End If
        rsA.MoveNext
    Wend
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing
'列印第一頁
blnFirstPage = True
strSql = "SELECT DISTINCT min(R013001) as r013001,substr(r013001,1,6) FROM R050317_C WHERE ID='" & strUserNum & "'  GROUP BY substr(r013001,1,6) ORDER BY substr(r013001,1,6) "
CheckOC
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
    '頁數加一
    Page = Page + 1
    RefreshColData 1, "申請人"
    With adoRecordset
        .MoveFirst
        '記錄申請人
        strCust = "" & .Fields("R013001").Value
        '記錄系統類別
        strSystemKind = ""
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields("R013001").Value)
            strTemp(21) = ""
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU58,CU61 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 13
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            '若申請人不同則跳頁
            If strCust <> strTemp(20) Then
                'add  by nickc 2005/11/03  紙本
                If Check3(0).Value = vbChecked Then
                    'Modified by Morgan 2013/6/24
                    'Printer.Line (0, iPrint)-(16000, iPrint)
                    Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                    iPrint = iPrint + 300
                    Printer.CurrentX = PLeft(0)
                    Printer.CurrentY = iPrint
                    Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                    Printer.NewPage
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrLineToWord, , , 10
                    fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 80), , , 10
                    fn_DocNewPage
                End If
                strCust = strTemp(20)
                strSystemKind = ""
                Page = Page + 1
                PrintTitleCp_A4
            End If
            strSeekGroup = ""
            '若為第一頁才印表頭
            If blnFirstPage = True Then PrintTitleCp_A4: blnFirstPage = False
            '初始化本所案號變數
            SeekTempPrint = ""
            '國內外是否分開列印
            'edit by nickc 2008/04/15 所有程序抓cp 其餘抓pa
            'Modify by Amy 2017/07/25 +R013028
            If txt1(15) = "3" Then
                strSql = "SELECT distinct R013010, R013015, R013020, R013004, R013014, R013006, r013001, R013008, R013009, R013005, R013011, CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007,r001005,r001001,r001002,r001003,r001004 ,R013028 From R050317_C tmpM,caseprogress,r100101_h tmpH WHERE r013018=CP09(+) And substr(R013001,1,6)='" & Mid(strTemp(20), 1, 6) & "' AND tmpM.ID='" & strUserNum & "' and tmpH.id='" & strUserNum & "' and r001001=r013022 and r001002=r013023 and r001003=r013024 and r001004=r013025 "
            Else
                strSql = "SELECT distinct R013010, R013015, R013020, R013004, R013014, R013006, r013001, R013008, R013009, R013005, R013011, pa16 as CP24, '', '', '', '', R013022, R013023, R013024, R013025, R013007,r001005,r001001,r001002,r001003,r001004 ,R013028 From R050317_C tmpM,caseprogress,r100101_h tmpH,patent WHERE r013018=CP09(+) And substr(R013001,1,6)='" & Mid(strTemp(20), 1, 6) & "' AND tmpM.ID='" & strUserNum & "' and tmpH.id='" & strUserNum & "' and r001001=r013022 and r001002=r013023 and r001003=r013024 and r001004=r013025 and cp01=pa01(+) and cp02=pa02(+) and cp03=pa03(+) and cp04=pa04(+)  "
            End If
            'end 2017/07/25
            
            '依本所案號排序
            strSql = strSql & " ORDER BY r001005,r001001,r013001,r001002,r001003,r001004  "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    strTemp(0) = IIf(CheckStr(adoRecordset1.Fields(6).Value) = strTemp(20), "", "△") & "" & adoRecordset1.Fields(0).Value
                    strTemp(1) = StrToStr("" & adoRecordset1.Fields(1).Value, 42)
                    strTemp(2) = "" & adoRecordset1.Fields(2).Value
                    strTemp(3) = StrToStr("" & adoRecordset1.Fields(3).Value, 10)
                    strTemp(4) = StrToStr("" & adoRecordset1.Fields(4).Value, 3)
                    strTemp(5) = StrToStr("" & adoRecordset1.Fields(5).Value, 6)
                    strTemp(6) = ""
                    strTemp(7) = ""
                    strTemp(8) = StrToStr("" & adoRecordset1.Fields(8).Value, 10)
                    strTemp(9) = StrToStr(GetNationName("" & adoRecordset1.Fields(9).Value, IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                    strTemp(10) = StrToStr("" & adoRecordset1.Fields(10).Value, 10)
                    strTemp(11) = IIf("" & adoRecordset1.Fields(11).Value = "1", "准", IIf("" & adoRecordset1.Fields(11).Value = "2", "駁", ""))
                    strTemp(12) = ""
                    strTemp(13) = ""
                    strTemp(14) = ""
                    strTemp(15) = ""
                    GetPatentDuration "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value
                    If strSeekGroup = "" Then
                        strSeekGroup = CheckStr(adoRecordset1.Fields("r001005").Value)
                    End If
                    If strSeekGroup <> CheckStr(adoRecordset1.Fields("r001005").Value) Then
                        'add  by nickc 2005/11/03  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.CurrentX = PLeft(0)
                            Printer.CurrentY = iPrint - 300
                            Printer.Print String(220, "=")
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            g_WordAp.Application.Selection.HomeKey Unit:=wdLine, Extend:=wdExtend
                            fn_PutWords fn_StrLineToWord("="), , , 10, False
                        End If
                        strSeekGroup = CheckStr(adoRecordset1.Fields("r001005").Value)
                    End If
                    'edit by nickc 2005/11/11
                    'If iPrint >= 10000 Then
                    If iPrint >= o_PaperHeight Then
                        'add  by nickc 2005/11/03  紙本
                        If Check3(0).Value = vbChecked Then
                            'Modified by Morgan 2013/6/24
                            'Printer.Line (0, iPrint)-(16000, iPrint)
                            Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                            iPrint = iPrint + 300
                            Printer.CurrentX = PLeft(0)
                            Printer.CurrentY = iPrint
                            Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord, , , 10
                            fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 80), , , 10
                            fn_DocNewPage
                        End If
                        Page = Page + 1
                        PrintTitleCp_A4
                    End If
                    '列印明細資料
                    PrintDatilCp_A4
                    If iPrint >= o_PaperHeight Then
                        'add  by nickc 2005/11/03  紙本
                        If Check3(0).Value = vbChecked Then
                            'Modified by Morgan 2013/6/24
                            'Printer.Line (0, iPrint)-(16000, iPrint)
                            Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                            iPrint = iPrint + 300
                            Printer.CurrentX = PLeft(0)
                            Printer.CurrentY = iPrint
                            Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord, , , 10
                            fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 80), , , 10
                            fn_DocNewPage
                        End If
                        Page = Page + 1
                        PrintTitleCp_A4
                    End If
                    'Modify by Amy 2017/07/25 +FunctionName
                    PrintPriDate "" & adoRecordset1("R013022").Value, "" & adoRecordset1("R013023").Value, "" & adoRecordset1("R013024").Value, "" & adoRecordset1("R013025").Value, "PrintTitleCp_A4"
                    'edit by nickc 2005/11/11
                    'If iPrint >= 10000 Then
                    If iPrint >= o_PaperHeight Then
                        'add  by nickc 2005/11/03  紙本
                        If Check3(0).Value = vbChecked Then
                            'Modified by Morgan 2013/6/24
                            'Printer.Line (0, iPrint)-(16000, iPrint)
                            Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                            iPrint = iPrint + 300
                            Printer.CurrentX = PLeft(0)
                            Printer.CurrentY = iPrint
                            Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord, , , 10
                            fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 80), , , 10
                            fn_DocNewPage
                        End If
                        Page = Page + 1
                        PrintTitleCp_A4
                    Else
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.CurrentX = PLeft(0)
                            Printer.CurrentY = iPrint
                            'Modified by Morgan 2013/6/24
                            'Printer.Print String(220, "-")
                            Printer.Print String(160, "-")
                            iPrint = iPrint + 300
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord, , , 10
                        End If
                        'edit by nickc 2005/11/11
                        'If iPrint >= 10000 Then
                        If iPrint >= o_PaperHeight Then
                            'add  by nickc 2005/11/03  紙本
                            If Check3(0).Value = vbChecked Then
                                'Modified by Morgan 2013/6/24
                                'Printer.Line (0, iPrint)-(16000, iPrint)
                                Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                                iPrint = iPrint + 300
                                Printer.CurrentX = PLeft(0)
                                Printer.CurrentY = iPrint
                                Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                                Printer.NewPage
                            ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord, , , 10
                                fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 80), , , 10
                                fn_DocNewPage
                            End If
                            Page = Page + 1
                            PrintTitleCp_A4
                        End If
                    End If
                    adoRecordset1.MoveNext
                Loop
                'edit by nickc 2005/11/11
                'If iPrint >= 10000 Then
                If iPrint >= o_PaperHeight Then
                    'add  by nickc 2005/11/03  紙本
                    If Check3(0).Value = vbChecked Then
                        'Modified by Morgan 2013/6/24
                        'Printer.Line (0, iPrint)-(16000, iPrint)
                        Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)
                        iPrint = iPrint + 300
                        Printer.CurrentX = PLeft(0)
                        Printer.CurrentY = iPrint
                        Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_PutWords fn_StrLineToWord, , , 10
                        fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 80), , , 10
                    End If
                    Page = Page + 1
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    PrintTitleCp_A4
                End If
                strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE substr(R013001,1,6)='" & Mid(strTemp(20), 1, 6) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                    IntTot = AdoRecordSet3.RecordCount
                End If
                'add  by nickc 2005/11/16  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(5)
                    Printer.CurrentY = iPrint
                    Printer.Print "總計：" & Format(IntTot, "##0")
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt(fn_StrToWordFmt("", 54.5) & "總計：" & Format(IntTot, "##0"), 69), , , 10
                End If
                strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) From R050317_C WHERE substr(R013001,1,6)='" & Mid(strTemp(20), 1, 6) & "' AND R013017 Like '%閉卷%' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                    IntTot = AdoRecordSet3.RecordCount
                End If
                'add  by nickc 2005/11/16  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.CurrentX = PLeft(13)
                    Printer.CurrentY = iPrint
                    Printer.Print "閉卷件數：" & Format(IntTot, "##0")
                    iPrint = iPrint + 300
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrToWordFmt("閉卷件數：" & Format(IntTot, "##0"), 11), , , 10, False
                End If
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
End If
'add  by nickc 2005/11/03  紙本
If Check3(0).Value = vbChecked Then
    'Modified by Morgan 2013/6/24
    'Printer.Line (0, iPrint)-(16000, iPrint)
    Printer.Line (0, iPrint)-(Printer.ScaleWidth, iPrint)

    iPrint = iPrint + 300
    Printer.CurrentX = PLeft(0)
    Printer.CurrentY = iPrint
    Printer.Print "       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。"
ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
    fn_PutWords fn_StrLineToWord, , , 10
    fn_PutWords fn_StrToWordFmt("       ※本所案號前有 △ 表示與抬頭申請人不同，屬於關係企業。", 80), , , 10
End If
CheckOC
'add  by nickc 2005/11/16  紙本
If Check3(0).Value = vbChecked Then
    Printer.EndDoc
'edit by nickc 2005/12/07
'    ShowPrintOk
End If
ErrHnd:
   If Err.Number <> 0 Then
      MsgBox Err.Description, vbCritical
   End If
End Sub

Private Sub PrintDataEp_Grp()
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True

'若非所有程序
If Me.txt1(15).Text <> "3" Then
    '首次程序
    If Me.txt1(15).Text = "1" Then
        StrSQLa = "Select * From R050317_E Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
    '最新程序
    ElseIf Me.txt1(15).Text = "2" Then
        StrSQLa = "Select * From R050317_E Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
    End If
    strCaseNo = " "
    rsA.CursorLocation = adUseClient
    rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
    If rsA.RecordCount > 0 Then
        While Not rsA.EOF
            If strCaseNo <> "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
                strCaseNo = "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
            Else
                rsA.Delete
            End If
            rsA.MoveNext
        Wend
    End If
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing
End If
strSql = "SELECT DISTINCT min(R013001),substr(r013001,1,6) FROM R050317_E WHERE ID='" & strUserNum & "' GROUP BY substr(r013001,1,6) ORDER BY substr(r013001,1,6) "
CheckOC
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   'Add By Cheng 2003/02/10
    '頁數加一
    'Page = 1
    Page = Page + 1
   'Add By Cheng 2002/02/27
   RefreshColData 2, "申請人"
    With adoRecordset
        .MoveFirst
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields(0))
            strTemp(21) = ""
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU59,CU62 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(14) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(13))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(14))
                
            Else
                For i = 0 To 14
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            PrintTitleEp
            strSql = "SELECT distinct r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09, Decode(FA05, Null, FA06, FA05||' '||FA63||' '||FA64||' '||FA65),r001005 FROM R050317_e tmpH,caseprogress, Patent, Fagent,r100101_h tmpH WHERE r013018=cp09(+) And R013022=PA01(+) And R013023=PA02(+) And R013024=PA03(+) And R013025=PA04(+) And substr(PA75,1,8)=FA01(+) And substr(PA75,9,1)=FA02(+) and substr(R013001,1,6)='" & Mid(strTemp(20), 1, 6) & "' AND tmpM.ID='" & strUserNum & "' and tmpH.id='" & strUserNum & "' and r001001=r013022 and r001002=r013023 and r001003=r013024 and r001004=r013025 "
            '依本所案號排序
            strSql = strSql & " order by r001005,r001001,r013001,r001002,r001003,r001004 "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    For i = 0 To 16
                        strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1))
                    Next i
                    If SeekTempPrint = "" Then
                        SeekTempPrint = strTemp(8)
                        strTemp(0) = StrToStr(strTemp(0), 15)
                        strTemp(1) = StrToStr(strTemp(1), 10)
                        strTemp(2) = StrToStr(strTemp(2), 10)
                        strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
'                        strTemp(4) = StrToStr(strTemp(4), 38)
                        strTemp(4) = StrToStr(strTemp(4), 22)
                        strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                        strTemp(10) = StrToStr(strTemp(12), 10)
                        strTemp(11) = StrToStr(strTemp(13), 25)
                        strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                        strTemp(12) = ""
                        strTemp(6) = StrToStr(strTemp(15), 11)
                        strTemp(20) = StrToStr("" & adoRecordset1.Fields(20).Value, 13)
                    Else
                        If SeekTempPrint <> strTemp(8) Then
                           'add  by nickc 2005/11/15  紙本
                           If Check3(0).Value = vbChecked Then
                              Printer.Line (0, iPrint)-(19200, iPrint)
                              iPrint = iPrint + 300
                           ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                              fn_PutWords fn_StrLineToWord(, False), , , 10
                           End If
                           SeekTempPrint = strTemp(8)
                           'edit by nickc 2005/11/17
                           'If iPrint >= 14200 Then
                           If iPrint >= o_PaperHeight Then
                              Page = Page + 1
                              'add  by nickc 2005/11/15  紙本
                              If Check3(0).Value = vbChecked Then
                                  Printer.NewPage
                              ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                  fn_DocNewPage
                              End If
                              PrintTitleEp
                           End If
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
'                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(4) = StrToStr(strTemp(4), 22)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                           strTemp(20) = StrToStr("" & adoRecordset1.Fields(20).Value, 13)
                        Else
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
'                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(4) = StrToStr(strTemp(4), 22)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                           strTemp(20) = ""
                           For i = 0 To 3
                              strTemp(i) = ""
                           Next i
                           For i = 6 To 13
                              strTemp(i) = ""
                           Next i
                        End If
                    End If
                    'edit by nickc 2005/11/17
                    'If iPrint >= 14200 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.Line (0, iPrint)-(19200, iPrint)
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord(, False), , , 10
                            fn_DocNewPage
                        End If
                        PrintTitleEp
                    End If
                    PrintDatilEp
                    adoRecordset1.MoveNext
                Loop
                'add  by nickc 2005/11/15  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.Line (0, iPrint)-(19200, iPrint)
                    iPrint = iPrint + 100
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrLineToWord(, False), , , 10
                End If
                'edit by nickc 2005/11/17
                'If iPrint >= 14200 Then
                If iPrint >= o_PaperHeight Then
                    Page = Page + 1
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    PrintTitleEp
                End If
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                End If
                Printer.CurrentX = PLeft(5) - 3000
                Printer.CurrentY = iPrint
                Printer.Print "Total：" & Format(IntTot, "##0")
                'Add By Cheng 2003/02/06
                iPrint = iPrint + 300

                If txt1(8) = "Y" Then
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017='Closed' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                Else
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_e WHERE R013001='" & strTemp(20) & "' AND R013017='Closed' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                End If
                Printer.CurrentX = PLeft(5)
                Printer.CurrentY = iPrint
                Printer.Print "File Closed：" & Format(IntTot, "##0")
                iPrint = iPrint + 300
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
End If
CheckOC
'Printer.CurrentX = 500
'Printer.CurrentY = iPrint
'Printer.Print String(250, "-")
Printer.EndDoc
'edit by nickc 2005/12/07
'ShowPrintOk
End Sub
Private Sub PrintDataJp_Grp()
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String

'add by nickc 2005/11/16 控制 word 換頁用
blnWordNewPage = True

'若非所有程序
If Me.txt1(15).Text <> "3" Then
    '首次程序
    If Me.txt1(15).Text = "1" Then
        StrSQLa = "Select * From R050317_J Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 , R013018 "
    '最新程序
    ElseIf Me.txt1(15).Text = "2" Then
        StrSQLa = "Select * From R050317_J Where ID='" & strUserNum & "' Order By R013022, R013023, R013024, R013025, substr(R013018,1,1), R013016 Desc, R013018 Desc "
    End If
    strCaseNo = " "
    rsA.CursorLocation = adUseClient
    rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockOptimistic
    If rsA.RecordCount > 0 Then
        While Not rsA.EOF
            If strCaseNo <> "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value Then
                strCaseNo = "" & rsA("R013022").Value & rsA("R013023").Value & rsA("R013024").Value & rsA("R013025").Value
            Else
                rsA.Delete
            End If
            rsA.MoveNext
        Wend
    End If
    If rsA.State <> adStateClosed Then rsA.Close
    Set rsA = Nothing
End If
If txt1(8) = "Y" Then
   strSql = "SELECT DISTINCT R013001,R013019 FROM R050317_J WHERE ID='" & strUserNum & "' GROUP BY R013001,R013019 ORDER BY R013019,R013001 "
Else
   strSql = "SELECT DISTINCT R013001 FROM R050317_J WHERE ID='" & strUserNum & "' GROUP BY R013001 ORDER BY R013001 "
End If
CheckOC
SeekTempPrint = ""
adoRecordset.CursorLocation = adUseClient
adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   'Modify By Cheng 2003/02/10
    '頁數加一
    'Page = 1
    Page = Page + 1
   'Add By Cheng 2002/02/27
   RefreshColData 3, "申請人"
    With adoRecordset
        .MoveFirst
        Do While .EOF = False
            strTemp(20) = CheckStr(.Fields(0))
            If txt1(8) = "Y" Then
               strTemp(21) = CheckStr(.Fields(1))
            Else
               strTemp(21) = ""
            End If
            'strSQL = "SELECT FA06,'','','',FA23,'','','','',FA12||DECODE(FA13,NULL,'',','||FA13),FA16,FA14||DECODE(FA15,NULL,'',','||FA15),FA09,FA54 FROM FAGENT WHERE FA01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND FA02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            'Modify By Cheng 2002/02/27
'            strSQL = "SELECT CU06,'','','',CU29,'','','','',CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU60,CU63 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            strSql = "SELECT " & m_ColCustName & "," & m_ColCustAdd & ",CU16||DECODE(CU17,NULL,'',','||CU17),CU20,CU18||DECODE(CU19,NULL,'',','||CU19),CU60,CU63 FROM CUSTOMER WHERE CU01='" & Mid(GetNewFagent(strTemp(20)), 1, 8) & "' AND CU02='" & Mid(GetNewFagent(strTemp(20)), 9, 1) & "' "
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                'StrTemp5(0) = GetNewFagent(strTemp(20)) + "  " + CheckStr(adoRecordset1.Fields(0))      邱小姐說要改回來  不秀代號 90/01/17
                StrTemp5(0) = CheckStr(adoRecordset1.Fields(0))
                StrTemp5(1) = CheckStr(adoRecordset1.Fields(1))
                StrTemp5(2) = CheckStr(adoRecordset1.Fields(2))
                StrTemp5(3) = CheckStr(adoRecordset1.Fields(3))
                StrTemp5(4) = CheckStr(adoRecordset1.Fields(4))
                StrTemp5(6) = CheckStr(adoRecordset1.Fields(5))
                StrTemp5(8) = CheckStr(adoRecordset1.Fields(6))
                StrTemp5(10) = CheckStr(adoRecordset1.Fields(7))
                StrTemp5(11) = CheckStr(adoRecordset1.Fields(8))
                StrTemp5(5) = CheckStr(adoRecordset1.Fields(9))
                StrTemp5(7) = CheckStr(adoRecordset1.Fields(10))
                StrTemp5(9) = CheckStr(adoRecordset1.Fields(11))
                StrTemp5(12) = CheckStr(adoRecordset1.Fields(12))
                StrTemp5(13) = CheckStr(adoRecordset1.Fields(13))
            Else
                For i = 0 To 11
                    StrTemp5(i) = ""
                Next i
            End If
            CheckOC2
            PrintTitleJp
            'strSQL = "SELECT * FROM R050317_J WHERE R013001='" & chgsql(strTemp(14)) & "' AND ID='" & strUserNum & "' ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) DESC"
            If txt1(8) = "Y" Then
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_j,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' "
            Else
               strSql = "SELECT r013001,r013002,r013003,r013004,r013005,r013006,r013007,r013008,r013009,r013010,r013011,r013012,r013013,r013014,r013015,r013016,r013017,r013018,cp05,cp09 FROM R050317_j,caseprogress WHERE r013018=cp09(+) and R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' "
            End If
            '依本所案號排序
            If Me.txt1(9) = "1" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015 "
               strSql = strSql & " ORDER BY DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依案件名稱排序
            ElseIf Me.txt1(9).Text = "2" Then
                'Modify By Cheng 2003/05/02
'               strSQL = strSQL & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
               strSql = strSql & " ORDER BY r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+本所案號排序
            ElseIf Me.txt1(9).Text = "3" Then
               strSql = strSql & " ORDER BY R013005, DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010),r013015, Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            '依申請國家+本所案號排序
            Else
               strSql = strSql & " ORDER BY R013005, r013015,DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010), Decode(r013007,NULL,9999999,To_Number(Replace(r013007,'/',''))), r013018  "
            End If
            CheckOC2
            adoRecordset1.CursorLocation = adUseClient
            adoRecordset1.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
            If adoRecordset1.RecordCount <> 0 And adoRecordset1.RecordCount > 0 Then
                adoRecordset1.MoveFirst
                s = adoRecordset1.RecordCount
                Do While adoRecordset1.EOF = False
                    For i = 0 To 16
                        'If i <> 10 Then
                        '   strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1)) & "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
                        'Else
                           strTemp(i) = CheckStr(adoRecordset1.Fields(i + 1))
                        'End If
                    Next i
                    If SeekTempPrint = "" Then
                        SeekTempPrint = strTemp(8)
                        strTemp(0) = StrToStr(strTemp(0), 15)
                        strTemp(1) = StrToStr(strTemp(1), 10)
                        strTemp(2) = StrToStr(strTemp(2), 10)
                        strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                        strTemp(4) = StrToStr(strTemp(4), 38)
                        strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                        strTemp(7) = StrToStr(strTemp(7), 15)
                        strTemp(8) = StrToStr(strTemp(8), 7.5)
                        strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                        strTemp(10) = StrToStr(strTemp(12), 10)
                        strTemp(11) = StrToStr(strTemp(13), 25)
                        strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                        strTemp(12) = ""
                        strTemp(6) = StrToStr(strTemp(15), 11)
                    Else
                        If SeekTempPrint <> strTemp(8) Then
                           'add  by nickc 2005/11/15  紙本
                           If Check3(0).Value = vbChecked Then
                                Printer.Line (0, iPrint)-(19200, iPrint)
                                iPrint = iPrint + 300
                           ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                fn_PutWords fn_StrLineToWord(, False), , , 10
                           End If
                           SeekTempPrint = strTemp(8)
                           'add by nickc 2005/11/15
                           'If iPrint >= 14200 Then
                           If iPrint >= o_PaperHeight Then
                              Page = Page + 1
                              'add  by nickc 2005/11/15  紙本
                              If Check3(0).Value = vbChecked Then
                                  Printer.NewPage
                              ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                                  fn_DocNewPage
                              End If
                              PrintTitleJp
                           End If
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                        Else
                           strTemp(0) = StrToStr(strTemp(0), 15)
                           strTemp(1) = StrToStr(strTemp(1), 10)
                           strTemp(2) = StrToStr(strTemp(2), 10)
                           strTemp(3) = StrToStr(GetNationName(strTemp(3), IIf(Me.txt1(10).Text = "2", "1", "0")), 6)
                           strTemp(4) = StrToStr(strTemp(4), 38)
                           strTemp(5) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(5)))), "mmm dd,yyyy")
                           strTemp(7) = StrToStr(strTemp(7), 15)
                           strTemp(8) = StrToStr(strTemp(8), 7.5)
                           strTemp(9) = StrToStr(strTemp(9) & String(20, " "), 10) & "/" & StrToStr(Format(Format(ChangeWStringToWDateString(strTemp(10)), "mmm dd,yyyy") & String(11, " "), "@@@@@@@@@@@"), 5.5) & "/" & strTemp(11)
                           strTemp(10) = StrToStr(strTemp(12), 10)
                           strTemp(11) = StrToStr(strTemp(13), 25)
                           strTemp(13) = Format(ChangeWStringToWDateString(ChangeTStringToWString(ChangeTDateStringToTString(strTemp(6)))), "mmm dd,yyyy")
                           strTemp(12) = ""
                           strTemp(6) = StrToStr(strTemp(15), 11)
                           For i = 0 To 3
                              strTemp(i) = ""
                           Next i
                           For i = 6 To 13
                              strTemp(i) = ""
                           Next i
                        End If
                    End If
                    'edit by nickc 2005/11/15
                    'If iPrint >= 14200 Then
                    If iPrint >= o_PaperHeight Then
                        Page = Page + 1
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.Line (0, iPrint)-(19200, iPrint)
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_PutWords fn_StrLineToWord(, False), , , 10
                        End If
                        'add  by nickc 2005/11/15  紙本
                        If Check3(0).Value = vbChecked Then
                            Printer.NewPage
                        ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                            fn_DocNewPage
                        End If
                        PrintTitleJp
                    End If
                    PrintDatilJp
                    adoRecordset1.MoveNext
                Loop
                'add  by nickc 2005/11/15  紙本
                If Check3(0).Value = vbChecked Then
                    Printer.Line (0, iPrint)-(19200, iPrint)
                ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                    fn_PutWords fn_StrLineToWord(, False), , , 10
                End If
                iPrint = iPrint + 100
                'edit by nickc 2005/11/15
                'If iPrint >= 14200 Then
                If iPrint >= o_PaperHeight Then
                    Page = Page + 1
                    'add  by nickc 2005/11/15  紙本
                    If Check3(0).Value = vbChecked Then
                        Printer.NewPage
                    ElseIf Check10(0).Value = vbChecked Then '2013/10/3 原Check3(1).Value = vbChecked
                        fn_DocNewPage
                    End If
                    PrintTitleJp
                End If
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                Else
                  strSql = "SELECT distinct DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) "
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                End If
                Printer.CurrentX = PLeft(5) - 3000
                Printer.CurrentY = iPrint
                Printer.Print "合計：" & Format(IntTot, "##0")
                'Add By Cheng 2003/02/06
                iPrint = iPrint + 300
                
                If txt1(8) = "Y" Then
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND R013019='" & strTemp(21) & "' AND R013017='ゾゆ' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                Else
                  strSql = "SELECT distinCt DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010) FROM R050317_J WHERE R013001='" & strTemp(20) & "' AND R013017='ゾゆ' AND ID='" & strUserNum & "' group by DECODE(SUBSTR(R013010,1,1),'*',SUBSTR(R013010,2,LENGTH(R013010)-1),R013010)"
                End If
                CheckOC3
                AdoRecordSet3.CursorLocation = adUseClient
                AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                IntTot = 0
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                If AdoRecordSet3.RecordCount <> 0 And AdoRecordSet3.RecordCount > 0 Then
                        IntTot = AdoRecordSet3.RecordCount
                End If
                End If
                Printer.CurrentX = PLeft(5)
                Printer.CurrentY = iPrint
                Printer.Print "出願ЯU閉鎖：" & Format(IntTot, "##0")
                iPrint = iPrint + 300
                CheckOC3
            End If
            CheckOC2
            .MoveNext
        Loop
    End With
End If
CheckOC
'Printer.CurrentX = 500
'Printer.CurrentY = iPrint
'Printer.Print String(250, "-")
Printer.EndDoc
'edit by nickc 2005/12/07
'ShowPrintOk
End Sub

Sub SelectGrpData()

Dim TmpRecCount As Long  '回傳比數
Dim TmpRecCount1 As Long  '回傳比數
Dim TmpRecCount2 As Long  '回傳比數
Dim TmpRecCount3 As Long  '回傳比數
Dim TmpRecCount4 As Long  '回傳比數
Dim TmpRecCount5 As Long  '回傳比數
'add by nickc 2005/06/07
Dim TmpRecCount6 As Long  '回傳比數
Dim TmpRecCount7 As Long  '回傳比數
'add by nickc 2006/06/20 加入分割
Dim TmpRecCount8 As Long  '回傳比數
Dim TmpRecCount9 As Long  '回傳比數
'add by nickc 2006/06/22 加入CaseRelation1
Dim TmpRecCount10 As Long  '回傳比數

Dim tmpCount As Integer '迴圈次
Dim KeyString As String

cnnConnection.Execute "delete from r100101_h where id='" & strUserNum & "' "
strSql = "select distinct pa01,pa02,pa03,pa04,0,'1','" & strUserNum & "' from patent where  pa26>='" & GetNewFagent(txt1(0)) & "' and pa26<='" & GetNewFagent(txt1(1)) & "' "
strSql = strSql & " union select pa01,pa02,pa03,pa04,0,'1','" & strUserNum & "' from patent where pa27>='" & GetNewFagent(txt1(0)) & "' and pa27<='" & GetNewFagent(txt1(1)) & "' "
strSql = strSql & " union select pa01,pa02,pa03,pa04,0,'1','" & strUserNum & "' from patent where pa28>='" & GetNewFagent(txt1(0)) & "' and pa28<='" & GetNewFagent(txt1(1)) & "' "
strSql = strSql & " union select pa01,pa02,pa03,pa04,0,'1','" & strUserNum & "' from patent where pa29>='" & GetNewFagent(txt1(0)) & "' and pa29<='" & GetNewFagent(txt1(1)) & "' "
strSql = strSql & " union select pa01,pa02,pa03,pa04,0,'1','" & strUserNum & "' from patent where pa30>='" & GetNewFagent(txt1(0)) & "' and pa30<='" & GetNewFagent(txt1(1)) & "' "
cnnConnection.Execute "insert into r100101_h (" & strSql & ") "
TmpRecCount = 1
tmpCount = 1
Do While TmpRecCount <> 0
   cnnConnection.Execute "insert into r100101_h select cm01,cm02,cm03,cm04," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='0' and cm05||cm06||cm07||cm08 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and cm01||cm02||cm03||cm04 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount1
   cnnConnection.Execute "insert into r100101_h select cm01,cm02,cm03,cm04," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='3' and cm05||cm06||cm07||cm08 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and cm01||cm02||cm03||cm04 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount2
   cnnConnection.Execute "insert into r100101_h select cm05,cm06,cm07,cm08," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='0' and cm01||cm02||cm03||cm04 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and cm05||cm06||cm07||cm08 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount3
   cnnConnection.Execute "insert into r100101_h select cm05,cm06,cm07,cm08," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='3' and cm01||cm02||cm03||cm04 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and cm05||cm06||cm07||cm08 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount4
   cnnConnection.Execute "insert into r100101_h select cr01,cr02,cr03,cr04," & tmpCount & ",'1','" & strUserNum & "' from caserelation where cr05||cr06||cr07||cr08 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and cr01||cr02||cr03||cr04 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount5
   cnnConnection.Execute "insert into r100101_h select cm01,cm02,cm03,cm04," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='4' and cm05||cm06||cm07||cm08 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and cm01||cm02||cm03||cm04 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount6
   cnnConnection.Execute "insert into r100101_h select cm05,cm06,cm07,cm08," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='4' and cm01||cm02||cm03||cm04 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and cm05||cm06||cm07||cm08 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount7
   'add by nickc 2006/06/20
   cnnConnection.Execute "insert into r100101_h select dc01,dc02,dc03,dc04," & tmpCount & ",'1','" & strUserNum & "' from divisioncase where dc05||dc06||dc07||dc08 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and dc01||dc02||dc03||dc04 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount8
   cnnConnection.Execute "insert into r100101_h select dc05,dc06,dc07,dc08," & tmpCount & ",'1','" & strUserNum & "' from divisioncase where dc01||dc02||dc03||dc04 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and dc05||dc06||dc07||dc08 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount9
'edit by nickc 2006/11/21 先拿掉
   'add  by nickc 2006/06/22
'   cnnConnection.Execute "insert into r100101_h select cr01,cr02,cr03,cr04," & tmpCount & ",'1','" & strUserNum & "' from caserelation1 where cr05||cr06||cr07||cr08 in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') and cr01||cr02||cr03||cr04 not in (select r001001||r001002||r001003||r001004 from r100101_h where  id='" & strUserNum & "') ", TmpRecCount10
   'edit by nickc 2006/06/22
   'If (TmpRecCount1 + TmpRecCount2 + TmpRecCount3 + TmpRecCount4 + TmpRecCount5 + TmpRecCount6 + TmpRecCount7) = 0 Then
   If (TmpRecCount1 + TmpRecCount2 + TmpRecCount3 + TmpRecCount4 + TmpRecCount5 + TmpRecCount6 + TmpRecCount7 + TmpRecCount8 + TmpRecCount9 + TmpRecCount10) = 0 Then
      Exit Do
   End If
   tmpCount = tmpCount + 1
Loop
'add by nickc 2005/05/31 分類
cnnConnection.Execute "update r100101_h set r001005=0 where id='" & strUserNum & "' "
Dim IsDataOK As Boolean
Dim GroupCount As Integer
Dim ChkDataRs As New ADODB.Recordset
'edit by nickc 2006/06/22
IsDataOK = False
GroupCount = 10
Do While IsDataOK = False
      strSql = "select * from r100101_h where id='" & strUserNum & "' and r001005=0  "
      CheckOC
      With adoRecordset
          .CursorLocation = adUseClient
          .Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
          If .RecordCount <> 0 Then
            .MoveFirst
               cnnConnection.Execute "delete from r100101_h2 where id='" & strUserNum & "' "
               cnnConnection.Execute "insert into r100101_h2 select '" & CheckStr(.Fields("R001001")) & "','" & CheckStr(.Fields("R001002")) & "','" & CheckStr(.Fields("R001003")) & "','" & CheckStr(.Fields("R001004")) & "',0,'1','" & strUserNum & "' from dual "
               TmpRecCount = 1
               tmpCount = 1
                     cnnConnection.Execute "insert into r100101_h2 select cm01,cm02,cm03,cm04," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='0' and cm05||cm06||cm07||cm08 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and cm01||cm02||cm03||cm04 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount1
                     cnnConnection.Execute "insert into r100101_h2 select cm01,cm02,cm03,cm04," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='3' and cm05||cm06||cm07||cm08 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and cm01||cm02||cm03||cm04 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount2
                     cnnConnection.Execute "insert into r100101_h2 select cm05,cm06,cm07,cm08," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='0' and cm01||cm02||cm03||cm04 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and cm05||cm06||cm07||cm08 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount3
                     cnnConnection.Execute "insert into r100101_h2 select cm05,cm06,cm07,cm08," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='3' and cm01||cm02||cm03||cm04 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and cm05||cm06||cm07||cm08 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount4
                     cnnConnection.Execute "insert into r100101_h2 select cr01,cr02,cr03,cr04," & tmpCount & ",'1','" & strUserNum & "' from caserelation where cr05||cr06||cr07||cr08 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and cr01||cr02||cr03||cr04 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount5
                     'add by nickc 2005/06/07
                     cnnConnection.Execute "insert into r100101_h2 select cm01,cm02,cm03,cm04," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='4' and cm05||cm06||cm07||cm08 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and cm01||cm02||cm03||cm04 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount6
                     cnnConnection.Execute "insert into r100101_h2 select cm05,cm06,cm07,cm08," & tmpCount & ",'1','" & strUserNum & "' from casemap where cm10='4' and cm01||cm02||cm03||cm04 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and cm05||cm06||cm07||cm08 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount7
                     'add by nickc 2006/06/20
                     cnnConnection.Execute "insert into r100101_h2 select dc01,dc02,dc03,dc04," & tmpCount & ",'1','" & strUserNum & "' from divisioncase where dc05||dc06||dc07||dc08 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and dc01||dc02||dc03||dc04 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount8
                     cnnConnection.Execute "insert into r100101_h2 select dc05,dc06,dc07,dc08," & tmpCount & ",'1','" & strUserNum & "' from divisioncase where dc01||dc02||dc03||dc04 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and dc05||dc06||dc07||dc08 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount9
                     'add  by nickc 2006/06/22
                     cnnConnection.Execute "insert into r100101_h2 select cr01,cr02,cr03,cr04," & tmpCount & ",'1','" & strUserNum & "' from caserelation1 where cr05||cr06||cr07||cr08 in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') and cr01||cr02||cr03||cr04 not in (select r001001||r001002||r001003||r001004 from r100101_h2 where  id='" & strUserNum & "') ", TmpRecCount10

                     'add by nickc 2005/10/26 沒有相關案的更改到最面
                     'edit by nickc 2006/06/22
                     'If (TmpRecCount1 + TmpRecCount2 + TmpRecCount3 + TmpRecCount4 + TmpRecCount5 + TmpRecCount6 + TmpRecCount7) = 0 Then
                     If (TmpRecCount1 + TmpRecCount2 + TmpRecCount3 + TmpRecCount4 + TmpRecCount5 + TmpRecCount6 + TmpRecCount7 + TmpRecCount8 + TmpRecCount9 + TmpRecCount10) = 0 Then
                         'cnnConnection.Execute "update r100101_h set r001005=99999 where  r001001||r001002||r001003||r001004 in (select distinct r001001||r001002||r001003||r001004 from r100101_h2 where id='" & strUserNum & "' ) and id='" & strUserNum & "' and r001005='0' "
                         cnnConnection.Execute "delete r100101_h where  r001001||r001002||r001003||r001004 in (select distinct r001001||r001002||r001003||r001004 from r100101_h2 where id='" & strUserNum & "' and r001006='1') and id='" & strUserNum & "' and r001006='1' and R001005='0' "
                     Else
                        cnnConnection.Execute "update r100101_h set r001005=(select nvl(min(r001005),0) from r100101_h " & _
                                                            " where r001001||r001002||r001003||r001004 in (select cm01||cm02||cm03||cm04 from casemap where cm05||cm06||cm07||cm08 in ( " & _
                                                            " select r001001||r001002||r001003||r001004 from r100101_h2 where id='" & strUserNum & "') and cm10 in ('0','3','4') " & _
                                                            " union select cm05||cm06||cm07||cm08 from casemap where cm01||cm02||cm03||cm04 in ( " & _
                                                            " select r001001||r001002||r001003||r001004 from r100101_h2 where id='" & strUserNum & "') and cm10 in ('0','3','4') " & _
                                                            " union select cr01||cr02||cr03||cr04 from caserelation where cr05||cr06||cr07||cr08 in (" & _
                                                            " select r001001||r001002||r001003||r001004 from r100101_h2 where id='" & strUserNum & "')) and r001005<>0 and id='" & strUserNum & "') " & _
                                                            " where r001001||r001002||r001003||r001004 in (select cm01||cm02||cm03||cm04 from casemap where cm05||cm06||cm07||cm08 in ( " & _
                                                            " select r001001||r001002||r001003||r001004 from r100101_h2 where id='" & strUserNum & "') and cm10 in ('0','3','4') " & _
                                                            " union select cm05||cm06||cm07||cm08 from casemap where cm01||cm02||cm03||cm04 in (" & _
                                                            " select r001001||r001002||r001003||r001004 from r100101_h2 where id='" & strUserNum & "') and cm10 in ('0','3','4') " & _
                                                            " union select cr01||cr02||cr03||cr04 from caserelation where cr05||cr06||cr07||cr08 in (" & _
                                                            " select r001001||r001002||r001003||r001004 from r100101_h2 where id='" & strUserNum & "') ) and id='" & strUserNum & "' "
                        TmpRecCount7 = 0
                        cnnConnection.Execute "update r100101_h set r001005=" & GroupCount & " where  r001001||r001002||r001003||r001004 in (select distinct r001001||r001002||r001003||r001004 from r100101_h2 where id='" & strUserNum & "' ) and id='" & strUserNum & "' and r001005='0' ", TmpRecCount7
'                        If TmpRecCount7 <> 0 Then
'                           cnnConnection.Execute "insert into r100101_h (r001005,id) values (" & GroupCount + 1 & ",'" & strUserNum & "') "
'                        End If
                        GroupCount = GroupCount + 10
                     End If
                     tmpCount = tmpCount + 1
                     cnnConnection.Execute "delete r100101_h where id='" & strUserNum & "' and r001005=0  and r001001='" & CheckStr(.Fields("r001001").Value) & "' and r001002='" & CheckStr(.Fields("R001002")) & "' and r001003='" & CheckStr(.Fields("R001003")) & "' and r001004='" & CheckStr(.Fields("R001004")) & "'  "
          Else
               IsDataOK = True
          End If
      End With
Loop


End Sub

'Add by Amy  格式3 83004 x7222601 產生新版word 版面會跑掉故改為A4橫印
Sub fn_CreateWord(Optional IsA4 As Boolean = True)
   Dim oldtmpOr
   Dim Prs As Integer
   Dim oldPrItem As Integer
On Error GoTo ErrHnd
    If g_WordAp Is Nothing Then Set g_WordAp = New Word.Application
    
    g_WordAp.Documents.add
    g_WordAp.Visible = True
    g_WordAp.Application.WindowState = wdWindowStateMinimize
    g_WordAp.Application.Selection.Font.Name = "標楷體"
  
       'A4 橫印 34 行
        With g_WordAp.ActiveDocument.PageSetup
                .LineNumbering.Active = False
                If IsA4 = False Then
                    .Orientation = wdOrientPortrait '橫
                Else
                    .Orientation = wdOrientLandscape '直
                End If
                .TopMargin = g_WordAp.CentimetersToPoints(0.56)
                .BottomMargin = g_WordAp.CentimetersToPoints(0.67)
                .LeftMargin = g_WordAp.CentimetersToPoints(0.64)
                .RightMargin = g_WordAp.CentimetersToPoints(0.64)
                .Gutter = g_WordAp.CentimetersToPoints(0)
                .HeaderDistance = g_WordAp.CentimetersToPoints(0)
                .FooterDistance = g_WordAp.CentimetersToPoints(0)
                .PageWidth = g_WordAp.CentimetersToPoints(29.7)
                .PageHeight = g_WordAp.CentimetersToPoints(21)
                .FirstPageTray = wdPrinterDefaultBin
                .OtherPagesTray = wdPrinterDefaultBin
                .SectionStart = wdSectionNewPage
                .OddAndEvenPagesHeaderFooter = False
                .DifferentFirstPageHeaderFooter = False
                .VerticalAlignment = wdAlignVerticalTop
                .SuppressEndnotes = False
                .MirrorMargins = False
                .TwoPagesOnOne = False
                .GutterOnTop = False
                .CharsLine = 67
                .LinesPage = 34
            End With
    
    g_WordAp.Application.Selection.ParagraphFormat.DisableLineHeightGrid = True
    IsOpenWord = True
    
ErrHnd:

   If Err.Number <> 0 Then
      Select Case Err.Number
         Case 91:
            g_WordAp.Documents.add
            Resume Next
         Case 462:
            Set g_WordAp = New Word.Application
            g_WordAp.Documents.add
            Resume Next
         Case Else:
            MsgBox "錯誤 : " & Err.Description, vbCritical
      End Select
   End If
End Sub

Sub fn_CreateWord_Old(Optional IsA4 As Boolean = True)
'   Dim oldtmpOr
'   Dim Prs As Integer
'   Dim oldPrItem As Integer
'On Error GoTo ErrHnd
'   'Set g_WordAp = Nothing
'    'If g_WordAp Is Nothing Then Set g_WordAp = New Word.Application
'    If g_WordAp Is Nothing Then Set g_WordAp = New Word.Application
'
'    g_WordAp.Documents.add
'    g_WordAp.Visible = True
'    g_WordAp.Application.WindowState = wdWindowStateMinimize
''    g_WordAp.Application.WindowState = wdWindowStateMaximize
'    g_WordAp.Application.Selection.Font.Name = "標楷體"
'   'US 48 行
'    If IsA4 = False Then
'        tmpPrName = ""
'        oldtmpPrName = Printer.DeviceName
'        oldtmpOr = Printer.Orientation
'        For Prs = 0 To Printers.Count - 1
'            Set Printer = Printers(Prs)
'             If InStr(1, Printer.DeviceName, "7800") <> 0 Then
'                tmpPrName = Printer.DeviceName
'             End If
'            If Printer.DeviceName = oldtmpPrName Then
'                oldPrItem = Prs
'            End If
'        Next Prs
'        Set Printer = Printers(oldPrItem)
'        g_WordAp.ActivePrinter = tmpPrName
'        With g_WordAp.ActiveDocument.PageSetup
'            .LineNumbering.Active = False
'            .Orientation = wdOrientPortrait
'            .TopMargin = g_WordAp.CentimetersToPoints(0)
'            .BottomMargin = g_WordAp.CentimetersToPoints(0)
'            .LeftMargin = g_WordAp.CentimetersToPoints(0)
'            .RightMargin = g_WordAp.CentimetersToPoints(3.25)
'            .Gutter = g_WordAp.CentimetersToPoints(0)
'            .HeaderDistance = g_WordAp.CentimetersToPoints(0)
'            .FooterDistance = g_WordAp.CentimetersToPoints(0)
'            .PageWidth = g_WordAp.CentimetersToPoints(37.78)
'            .PageHeight = g_WordAp.CentimetersToPoints(27.94)
'            .FirstPageTray = wdPrinterDefaultBin
'            .OtherPagesTray = wdPrinterDefaultBin
'            .SectionStart = wdSectionNewPage
'            .OddAndEvenPagesHeaderFooter = False
'            .DifferentFirstPageHeaderFooter = False
'            .VerticalAlignment = wdAlignVerticalTop
'            .SuppressEndnotes = False
'            .MirrorMargins = False
'            .TwoPagesOnOne = False
'            .GutterOnTop = False
'            .CharsLine = 81
'            .LinesPage = 48
'        End With
'    '其他
'    Else    'A4 橫印 34 行
'        'g_WordAp.ActivePrinter = "HP LaserJet 2200"
'        With g_WordAp.ActiveDocument.PageSetup
'                .LineNumbering.Active = False
'                .Orientation = wdOrientLandscape
'                .TopMargin = g_WordAp.CentimetersToPoints(0.56)
'                .BottomMargin = g_WordAp.CentimetersToPoints(0.67)
'                .LeftMargin = g_WordAp.CentimetersToPoints(0.64)
'                .RightMargin = g_WordAp.CentimetersToPoints(0.64)
'                .Gutter = g_WordAp.CentimetersToPoints(0)
'                .HeaderDistance = g_WordAp.CentimetersToPoints(0)
'                .FooterDistance = g_WordAp.CentimetersToPoints(0)
'                .PageWidth = g_WordAp.CentimetersToPoints(29.7)
'                .PageHeight = g_WordAp.CentimetersToPoints(21)
'                .FirstPageTray = wdPrinterDefaultBin
'                .OtherPagesTray = wdPrinterDefaultBin
'                .SectionStart = wdSectionNewPage
'                .OddAndEvenPagesHeaderFooter = False
'                .DifferentFirstPageHeaderFooter = False
'                .VerticalAlignment = wdAlignVerticalTop
'                .SuppressEndnotes = False
'                .MirrorMargins = False
'                .TwoPagesOnOne = False
'                .GutterOnTop = False
'                .CharsLine = 67
'                .LinesPage = 34
'            End With
'    End If
'    g_WordAp.Application.Selection.ParagraphFormat.DisableLineHeightGrid = True
'    IsOpenWord = True
'
'ErrHnd:
'
'   If Err.Number <> 0 Then
'      Select Case Err.Number
'         Case 91:
'            g_WordAp.Documents.add
'            Resume Next
'         Case 462:
'            'Set g_WordAp = Word.Global
'            Set g_WordAp = New Word.Application
'            g_WordAp.Documents.add
'            'g_WordAp.Activate
'            Resume Next
''         Case 429:
''            Set g_WordAp = New Word.Application
''            Resume Next
'         Case Else:
'            MsgBox "錯誤 : " & Err.Description, vbCritical
'      End Select
'   End If
End Sub

'add by nickc 2005/11/10 將字放入 word 中
Sub fn_PutWords(oStr As String, _
                           Optional oAlignment As WdParagraphAlignment = wdAlignParagraphJustify, _
                           Optional oFontName As String = "細明體", _
                           Optional oFontSize As Integer = 12, _
                           Optional IsNewLine As Boolean = True, _
                           Optional IsUnderline As Boolean = False, _
                           Optional IsBold As Boolean = False)
If IsOpenWord = False Then
    fn_CreateWord Not (Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3")
End If
                           
    With g_WordAp.Application.Selection
        If IsNewLine = True Then
            .TypeParagraph
        End If
        .ParagraphFormat.Alignment = oAlignment
        'Modify by Amy 2017/12/26
        If Me.txt1(15).Text = "3" And InStr(oStr, "案件總簿") = 0 Then
            .Font.Size = 8
        Else
            .Font.Size = oFontSize
        End If
       'end 2017/12/26
        .Font.Name = oFontName
        If IsUnderline = True Then
            If .Font.Underline = wdUnderlineNone Then
                .Font.Underline = wdUnderlineSingle
            Else
                .Font.Underline = wdUnderlineNone
            End If
        End If
        If IsBold = True Then
            .Font.Bold = wdToggle
        End If
        'Modify By Sindy 2012/10/17
        If txt1(15) = "3" And InStr(oStr, "案件總簿") = 0 Then
         .TypeText Text:="        " & oStr
        Else
         .TypeText Text:=oStr
        End If
        '2012/10/17 End
        If IsUnderline = True Then
            If .Font.Underline = wdUnderlineNone Then
                .Font.Underline = wdUnderlineSingle
            Else
                .Font.Underline = wdUnderlineNone
            End If
        End If
        If IsBold = True Then
            .Font.Bold = wdToggle
        End If
    End With
    iPrint = iPrint + 1
End Sub

'add by nickc 2005/11/10  結束將字距縮小
Sub fn_PutEnd(oStrFileName As String)
If IsOpenWord = False Then
    fn_CreateWord Not (Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3")
End If
If Dir(App.path & "\" & oStrFileName) <> "" Then
    Kill App.path & "\" & oStrFileName
End If
With g_WordAp
'        .WholeStory
'        .ParagraphFormat.LeftIndent = CentimetersToPoints(0)
'        .ParagraphFormat.RightIndent = CentimetersToPoints(0)
'        .ParagraphFormat.SpaceBefore = 0
'        .ParagraphFormat.SpaceAfter = 0
'        .ParagraphFormat.LineSpacingRule = wdLineSpaceAtLeast
'        .ParagraphFormat.LineSpacing = 1
'        .MoveRight Unit:=wdLine, Count:=1
    .ChangeFileOpenDirectory App.path & "\"
    .ActiveDocument.SaveAs FileName:=oStrFileName, FileFormat:= _
        wdFormatDocument, LockComments:=False, Password:="", AddToRecentFiles:= _
        True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:= _
        False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
        SaveAsAOCELetter:=False
    .ActiveWindow.Close
    .ActivePrinter = oldtmpPrName 'Add By Sindy 2012/11/29 改回預設印表機
    IsOpenWord = False
End With
    'g_WordAp.Quit
    'g_WordAp.Activate
    g_WordAp.Visible = False
    g_WordAp.Quit
    Set g_WordAp = Nothing
End Sub

'add by nickc 2005/11/10 將文字調成 word 格式
'Modify by Amy 2015/03/18 +bolSign 是否顯示... (商品類別可能多個,直接截斷無法知道後想還有)
Function fn_StrToWordFmt(oStr As String, oCLen As Integer, Optional bolSign As Boolean = False) As String
'Modify by Morgan 2010/1/11 中英混合時有問題
'fn_StrToWordFmt = StrConv(MidB(StrConv(oStr, vbFromUnicode), 1, oCLen * 2), vbUnicode) & String(oCLen - ((LenB(StrConv(StrConv(MidB(StrConv(oStr, vbFromUnicode), 1, oCLen * 2), vbUnicode), vbFromUnicode)) \ 2) + IIf(LenB(StrConv(StrConv(MidB(StrConv(oStr, vbFromUnicode), 1, oCLen * 2), vbUnicode), vbFromUnicode)) Mod 2 <> 0, 1, 0)), "　") & IIf(oCLen Mod 1 <> 0, " ", IIf(LenB(StrConv(StrConv(MidB(StrConv(oStr, vbFromUnicode), 1, oCLen * 2), vbUnicode), vbFromUnicode)) Mod 2 <> 0, IIf(LenB(StrConv(StrConv(MidB(StrConv(oStr, vbFromUnicode), 1, oCLen * 2), vbUnicode), vbFromUnicode)) \ 2 < oCLen, " ", ""), ""))
Dim stTmp As String, stTmpChr As String, strTail As String, iP As Integer, iSpace As Integer, iCnt As Integer
Dim intSign As Integer, bolShowS As Boolean 'Add by Amy 2015/03/18

iCnt = 0
stTmp = ""
'Add by Amy 2015/03/18
intSign = 0
If bolSign = True And LenB(StrConv(oStr, vbFromUnicode)) > 2 * oCLen Then
    intSign = 4
    bolShowS = True
End If
'end 2015/03/18

For iP = 1 To Len(oStr)
   stTmpChr = StrConv(Mid(oStr, iP, 1), vbFromUnicode)
   'Modify by Amy 2015/03/18 + intSign
   If iCnt + intSign + LenB(stTmpChr) > 2 * oCLen Then
      Exit For
   Else
      iCnt = iCnt + LenB(stTmpChr)
   End If
   stTmp = stTmp & stTmpChr
Next
stTmp = StrConv(MidB(stTmp, 1, iCnt), vbUnicode)
iSpace = 2 * oCLen - iCnt - intSign 'Modify by Amy 2015/03/18

If iSpace > 0 Then strTail = String(iSpace \ 2, "　") & String(iSpace Mod 2, " ")   '補全形空白,最後若有半字則補半型空白

fn_StrToWordFmt = stTmp & IIf(bolShowS = True, "....", "") & strTail 'Modify by Amy 2015/03/18
End Function

'add by nickc 2005/11/11 放置相同符號到 word 內
Function fn_StrLineToWord(Optional oStr As String = "－", Optional IsA4 As Boolean = True) As String
If IsOpenWord = False Then
    fn_CreateWord Not (Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3")
End If

If IsA4 = True Then
    fn_StrLineToWord = String((160 / LenB(StrConv(oStr, vbFromUnicode))), oStr)
Else
    'Modify By Sindy 2012/10/17
    If txt1(15) = "3" Then
      fn_StrLineToWord = String((186 / LenB(StrConv(oStr, vbFromUnicode))), oStr)
    Else
      fn_StrLineToWord = String((192 / LenB(StrConv(oStr, vbFromUnicode))), oStr)
    End If
    '2012/10/17 End
End If
End Function

'add by nickc 2005/11/11 換頁
Function fn_DocNewPage()
If IsOpenWord = False Then
    fn_CreateWord Not (Me.txt1(15).Text = "3" Or Me.txt1(10).Text = "2" Or Me.txt1(10).Text = "3")
End If
    fn_PutWords "", , , 10
End Function

'Add by Amy 2013/10/03
Sub fn_CreateExcel(ByRef intXlsSheet As Integer, ByRef strSystemKind As String, ByRef blnFirstPage As Boolean)
Dim strAllField As String '第幾個字換行「-」分隔
Dim strSetField_txt As String, strSetField As String
Dim NewTitle As String
Dim strTitle() As String, strTp1() As String, strTp2() As String
Dim nowFieldNo As String

Dim ii As Integer, jj As Integer, kk As Integer

On Error GoTo ErrHnd
    
    If IsOpenExcel = False Or intXlsSheet > 1 Then
        'Modify by Amy 2018/11/14 Excel2013 開啟只會有一個工作表,造成產生第二個工作表抓名稱會error
        If intXlsSheet > 3 Or (intXlsSheet <> 1 And Val(xlsCustPoint.Version) = 15) Then
            xlsCustPoint.Worksheets.add  '插入sheet
        ElseIf intXlsSheet = 1 Then
            xlsCustPoint.Workbooks.add
            xlsCustPoint.Visible = True
            xlsCustPoint.Application.WindowState = xlMinimized
        End If
        'end 2018/11/14
        'Modify by Amy 2017/12/26 for 工作表名稱改為中文
        If strWkName = MsgText(601) Then strWkName = Left(xlsCustPoint.Worksheets(1).Name, Len(xlsCustPoint.Worksheets(1).Name) - 1)
        Set wksrpt = xlsCustPoint.Worksheets(strWkName & intXlsSheet)
        'end 2017/12/26
        wksrpt.Activate
        wksrpt.Application.ActiveWindow.Zoom = 80 '設Active 多sheet 時此行才會有作用
        'If intXlsSheet > 3 Then wksrpt.Move , After:=xlsCustPoint.Worksheets("Sheet" & intXlsSheet - 1)
        
        wksrpt.Range("a1").Value = "客戶案件總簿(" & ReportName & ")"
        wksrpt.Range("a2").Value = "收件人:" & StrTemp5(0)
        
        If blnFirstPage Then
            Erase SetTitle
            Erase setXlsWidth
            Erase setFieldNo_txt
            Erase setFieldNo
            Erase setFieldType
            
           jj = 0: kk = 0
        'Modify by Amy 2017/07/25 +優先權資料
        Select Case ReportName
            Case "專利"
                If txt1(15) = "2" Then '選「最新收文程序」不用顯示「最新進度」欄
                    strAllField = "案件圖樣-2,本所案號-2,閉卷-0,客戶案件案號-3,專利名稱-2,發明人-0,申請日-0,申請國家-2,申請案號-2,專利號數-2," & _
                                       "種類-0,准駁-0,案件性質-2,專用期限(起)-4,專用期限(迄)-4,最後繳年費日-3,最近期限-0,優先權資料-0"
                Else
                    strAllField = "案件圖樣-2,本所案號-2,閉卷-0,客戶案件案號-3,專利名稱-2,發明人-0,申請日-0,申請國家-2,申請案號-2,專利號數-2," & _
                                       "種類-0,准駁-0,案件性質-2,專用期限(起)-4,專用期限(迄)-4,最後繳年費日-3,最新進度-2,最近期限-0,優先權資料-0"
                End If
                strSetField_txt = "客戶案件案號,專利名稱,申請案號,專利號數"
               
            Case "商標"
                'Modify by Amy 2017/03/13 +指定商品
                If txt1(15) = "2" Then '選「最新收文程序」不用顯示「最新進度」欄
                    strAllField = "案件圖樣-2,本所案號-2,閉卷-0,客戶案件案號-3,商標名稱-2,申請日-0,申請國家-2,申請案號-2,審定號數-2,種類-0," & _
                                       "准駁-0,案件性質-2,專用期限(起)-4,專用期限(迄)-4,商品類別-2,最近期限-0" & IIf(bolTMGoods = True, ",指定商品-2", "") & ",優先權資料-0"
                Else
                    strAllField = "案件圖樣-2,本所案號-2,閉卷-0,客戶案件案號-3,商標名稱-2,申請日-0,申請國家-2,申請案號-2,審定號數-2,種類-0," & _
                                       "准駁-0,案件性質-2,專用期限(起)-4,專用期限(迄)-4,商品類別-2,最新進度-2,最近期限-0" & IIf(bolTMGoods = True, ",指定商品-2", "") & " ,優先權資料-0"
                End If
                'end 2017/03/13
                strSetField_txt = "客戶案件案號,商標名稱,申請案號,審定號數,商品類別"
              
            'Moidfy by Amy 2020/04/01 +法務
            Case "其他", "法務"
                If txt1(15) = "2" Then '選「最新收文程序」不用顯示「最新進度」欄
                    strAllField = "本所案號-2,閉卷-0,客戶案件案號-3,案件名稱-2,申請日-0,申請國家-2,申請案號-2,審定號數-2,種類-0,案件性質-2," & _
                                       "專用期限(起)-4,專用期限(迄)-4,最近期限-0,優先權資料-0"
                Else
                    strAllField = "本所案號-2,閉卷-0,客戶案件案號-3,案件名稱-2,申請日-0,申請國家-2,申請案號-2,審定號數-2,種類-0,案件性質-2," & _
                                       "專用期限(起)-4,專用期限(迄)-4,最新進度-2,最近期限-0,優先權資料-0"
                End If
                strSetField_txt = "客戶案件案號,案件名稱,申請案號,審定號數"
              
        End Select
        'end 2017/07/25
        strSetField = "申請日-e/mm/dd,專用期限(起)-yyyy/mm/dd,專用期限(迄)-yyyy/mm/dd"
                
        strTitle() = Split(strAllField, ",")
        strTp1() = Split(strSetField_txt, ",")
        strTp2() = Split(strSetField, ",")
        
        ReDim SetTitle(UBound(strTitle))
        ReDim setXlsWidth(UBound(strTitle))
        ReDim setFieldNo_txt(UBound(strTp1))
        ReDim setFieldNo(UBound(strTp2))
        ReDim setFieldType(UBound(strTp2))
        
        For ii = 0 To UBound(strTitle)
            If jj <= UBound(strTp1) Then
                If Mid(strTitle(ii), 1, InStr(strTitle(ii), "-") - 1) = strTp1(jj) Then
                    '設定文字欄位
                    setFieldNo_txt(jj) = Chr(ii + 65)
                    jj = jj + 1
                End If
            End If
            If kk <= UBound(strTp2) Then
                If Mid(strTitle(ii), 1, InStr(strTitle(ii), "-") - 1) = Mid(strTp2(kk), 1, InStr(strTp2(kk), "-") - 1) Then
                    '設定需設格式的欄位
                    setFieldNo(kk) = Chr(ii + 65)
                    setFieldType(kk) = Mid(strTp2(kk), InStr(strTp2(kk), "-") + 1)
                    kk = kk + 1
                End If
            End If
            setXlsWidth(ii) = fn_GetXlsWidth(strTitle(ii), NewTitle)
            SetTitle(ii) = NewTitle
            nowFieldNo = Chr(ii + 65)
            
            wksrpt.Columns(nowFieldNo & ":" & nowFieldNo).ColumnWidth = setXlsWidth(ii)
            wksrpt.Range(nowFieldNo & "3").Value = SetTitle(ii)
        Next ii
        
        Else
            For ii = 0 To UBound(SetTitle)
                nowFieldNo = Chr(ii + 65)
                wksrpt.Columns(nowFieldNo & ":" & nowFieldNo).ColumnWidth = setXlsWidth(ii)
                wksrpt.Range(nowFieldNo & "3").Value = SetTitle(ii)
            Next ii
        End If

        If txt1(8) = "Y" And strSystemKind <> "" Then
            wksrpt.Name = strTemp(20) & "-" & strSystemKind
        Else
            wksrpt.Name = strTemp(20) & "-" & ReportName
        End If
        IsOpenExcel = True
    End If
    
ErrHnd:

   If Err.Number <> 0 Then
      Select Case Err.Number
         Case 91:
             xlsCustPoint.Workbooks.add
            Resume Next
         Case 462:
            Set xlsCustPoint = New Excel.Application
            xlsCustPoint.Workbooks.add
            Resume Next
         Case Else:
            MsgBox "錯誤 : " & Err.Description, vbCritical
      End Select
   End If
End Sub


'設定欄寬
Function fn_GetXlsWidth(ByVal strField As String, ByRef NewTitle As String) As Double
    Dim strTp() As String
    Dim strTmp As String
    
    NewTitle = ""
    fn_GetXlsWidth = 0
    
    strTp() = Split(strField, "-")
    
    If Val(strTp(1)) <> 0 Then
        If txt1(15) = "1" And strTp(0) = "案件性質" Then
            NewTitle = "首次接洽" & Chr(10) & strTp(0)
        ElseIf (txt1(15) = "1" And strTp(0) = "最新進度") Or (txt1(15) = "2" And strTp(0) = "案件性質") Then
            NewTitle = "最新收文" & Chr(10) & "案件性質"
        Else
            strTmp = StrToStr(strTp(0), Val(strTp(1))) '目前要取的字串
            NewTitle = strTmp & Chr(10) & Mid(strTp(0), Len(strTmp) + 1) '取的用+換行+取完剩的字串
        End If
               
        If strTp(0) = "最後繳年費日" Then NewTitle = NewTitle & Chr(10) & "(年度)"
    Else
        If strTp(0) = "最近期限" Then
            NewTitle = strTp(0) & Chr(10) & "(程序)"
        Else
            NewTitle = strTp(0)
        End If
    End If
    
    Select Case strTp(0)
        Case "案件圖樣"
            fn_GetXlsWidth = 16.63
        Case "本所案號"
            fn_GetXlsWidth = 14.5
        Case "閉卷"
            fn_GetXlsWidth = 4
        Case "客戶案件案號"
            fn_GetXlsWidth = 10.38
        Case "專利名稱", "商標名稱", "案件名稱"
            fn_GetXlsWidth = 12.88
        Case "發明人"
            fn_GetXlsWidth = 8
        Case "申請日"
            fn_GetXlsWidth = 8.25
        Case "申請國家"
            fn_GetXlsWidth = 8.13
        Case "申請案號"
            fn_GetXlsWidth = 13
        Case "專利號數", "審定號數"
            fn_GetXlsWidth = 15
        Case "種類"
            fn_GetXlsWidth = 8.13
        Case "准駁"
            fn_GetXlsWidth = 3.5
        Case "案件性質"
            fn_GetXlsWidth = 12.38
        Case "專用期限(起)", "專用期限(迄)"
            fn_GetXlsWidth = 9.5
        Case "最後繳年費日"
            fn_GetXlsWidth = 7.88
        Case "最新進度"
            fn_GetXlsWidth = 11.88
        Case "最近期限"
            fn_GetXlsWidth = 12.38
        Case "商品類別"
            fn_GetXlsWidth = 9
        'Add by Amy 2017/03/13
        Case "指定商品"
            fn_GetXlsWidth = 10.38
        'Add by Amy 2017/07/25
        Case "優先權資料"
            fn_GetXlsWidth = 11
        Case Else
            fn_GetXlsWidth = 5
    End Select
End Function
'資料寫入Excel
Sub fn_PutExcel(strNo1 As String, strNo2 As String, strNo3 As String, strNo4 As String)
    Dim bytes() As Byte
    Dim file_num As Integer
    Dim rsPic As New ADODB.Recordset
    Dim IsWmf As Boolean
    Dim stSQL As String
    Dim intR As Integer
    Dim oShape
    Dim nowCaseNo As String
    Dim strData() As String
    Dim ii As Integer
    
    '設定文字格式
    For ii = 0 To UBound(setFieldNo_txt)
        wksrpt.Range(setFieldNo_txt(ii) & intXlsRow + 1).NumberFormatLocal = "@"
    Next ii
    
    '資料寫入
    strData() = Split(strXlsData, "$$")
    
    'Modify by Amy 2017/07/25 修改顯示筆數(同案號算一筆,原一筆資料算一筆)
    nowCaseNo = strNo1 & "-" & strNo2 & strNo3 & strNo4
    If ReportName = "專利" Or ReportName = "商標" Then
        For ii = 0 To UBound(strData)
            If ii = 0 Then
                If oldCaseNo <> nowCaseNo Then
                    '讀案件圖
                    'Modify By Sindy 2018/10/31 TF馬德里商標圖檔-子案的圖同母案
                    '固定都以IBF01=tm01 AND IBF02=substr(tm02,1,5)||'0' AND IBF03='0' AND IBF04='00' 去抓代表圖
                    If strNo1 = "TF" Then
                        stSQL = "select * from ImgByteFile where ibf01='" & strNo1 & "' and ibf02='" & Mid(strNo2, 1, 5) & "0" & "' And ibf03='0' And ibf04='00' and ibf05='1' "
                    Else
                    '2018/10/31 END
                        stSQL = "select * from ImgByteFile where ibf01='" & strNo1 & "' and ibf02='" & strNo2 & "' and ibf03='" & strNo3 & "' and ibf04='" & strNo4 & "' and ibf05='1' "
                    End If
                    intR = 1
                    Set rsPic = ClsLawReadRstMsg(intR, stSQL)
                    If intR = 1 Then
                        wksrpt.Rows(intXlsRow + 1).RowHeight = 110
                        If CheckStr(rsPic.Fields("ibf06")) = "1" Or CheckStr(rsPic.Fields("ibf06")) = "2" Then
                           IsWmf = False
                        Else
                           IsWmf = True
                        End If
                        'Add By Sindy 2017/8/10
'                        If "" & rsPic.Fields("IBF15") <> "" Then
                           Call PUB_GetFtpFile(rsPic.Fields("IBF15"), App.path & "\$$" & strNo1 & strNo2 & strNo3 & strNo4 & "." & IIf(IsWmf, "wmf", "jpg"), UCase("ImgByteFile"))
'                        Else
'                        '2017/8/10 END
'                           ReDim bytes(Val(rsPic.Fields("ibf13").Value))
'                           bytes() = rsPic.Fields("ibf14").GetChunk(Val(rsPic.Fields("ibf13").Value))
'                           file_num = FreeFile
'                           Open App.path & "\$$" & strNo1 & strNo2 & strNo3 & strNo4 & "." & IIf(IsWmf, "wmf", "jpg") For Binary Access Write As #file_num
'                           Put #file_num, , bytes()
'                           Close #file_num
'                        End If
                        
                        Set oShape = wksrpt.Shapes.AddPicture(App.path & "\$$" & strNo1 & strNo2 & strNo3 & strNo4 & "." & IIf(IsWmf, "wmf", "jpg"), False, True, 100, 100, 100, 100)
                        oShape.Left = wksrpt.Columns(Chr(ii + 65)).Left + 1
                        oShape.Top = wksrpt.Range(Chr(ii + 65) & intXlsRow + 1).Top + 1
                    End If
                End If
            End If
            wksrpt.Range(Chr(ii + 65) & intXlsRow + 1).Value = strData(ii) '有圖樣
        Next ii
        
        If oldCaseNo <> nowCaseNo Then
            If ReportName = "專利" Then
                CountPT = CountPT + 1
            Else
                CountTM = CountTM + 1
            End If
        End If
        
    'Moidfy by Amy 2020/04/01 +法務
    ElseIf ReportName = "其他" Or ReportName = "法務" Then
        For ii = 0 To UBound(strData)
            wksrpt.Range(Chr(ii + 65) & intXlsRow + 1).Value = strData(ii) '無圖樣
        Next ii
        If oldCaseNo <> nowCaseNo Then CountOT = CountOT + 1
    End If
    'end 2017/07/25
    oldCaseNo = nowCaseNo
    intXlsRow = intXlsRow + 1
End Sub

'設定Excel格式
Sub fn_SetExcel()
 Dim FieldNo As String
 Dim ii As Integer
 
 For ii = 0 To UBound(setFieldNo)
    FieldNo = setFieldNo(ii) & "4:" & setFieldNo(ii) & intXlsRow
    wksrpt.Range(FieldNo).NumberFormatLocal = setFieldType(ii)
 Next ii

FieldNo = Chr(UBound(SetTitle) + 65)
'報表抬頭格式設定
With wksrpt.Range("A1:" & FieldNo & "1")
    .HorizontalAlignment = xlCenter
    .VerticalAlignment = xlCenter
    .WrapText = False
    .Font.Size = 18
    .Font.Bold = True
    .MergeCells = True
End With

'欄位抬頭格式設定
wksrpt.Range("A3:" & FieldNo & "3").HorizontalAlignment = xlCenter
wksrpt.Range("A3:" & FieldNo & "3").VerticalAlignment = xlCenter
     
'資料內容格式設定
With wksrpt.Range("B4:" & FieldNo & intXlsRow)
    .HorizontalAlignment = xlGeneral
    .VerticalAlignment = xlGeneral
    .WrapText = True
    .Orientation = 0
    .AddIndent = False
    .ShrinkToFit = False
    .MergeCells = False
End With

'欄位抬頭、內容格式設定
With wksrpt.Range("A3:" & FieldNo & intXlsRow)
    .Borders(xlEdgeLeft).LineStyle = xlContinuous
    .Borders(xlEdgeTop).LineStyle = xlContinuous
    .Borders(xlEdgeBottom).LineStyle = xlContinuous
    .Borders(xlEdgeRight).LineStyle = xlContinuous
    .Borders(xlInsideVertical).LineStyle = xlContinuous
    .Borders(xlInsideHorizontal).LineStyle = xlContinuous
    .Font.Name = "新細明體"
    .Font.Size = 11
End With

With wksrpt.PageSetup
    .PaperSize = 9       '設定紙張 A4
    .Orientation = xlLandscape                   '橫印
    .PrintTitleRows = "$1:$3"                    '表頭保留3列
    '.PrintArea = "$A$1:$" & LastFieldNo & "$" & intXlsRow '設定列印範圍
      
    .LeftMargin = xlsCustPoint.InchesToPoints(0.5)
    .RightMargin = xlsCustPoint.InchesToPoints(0.5)
    .TopMargin = xlsCustPoint.InchesToPoints(0.3)
    .BottomMargin = xlsCustPoint.InchesToPoints(0.3)
    .HeaderMargin = xlsCustPoint.InchesToPoints(0.5)
    .FooterMargin = xlsCustPoint.InchesToPoints(0.5)
                
    .Zoom = 100 '縮放比例
End With
    
intXlsRow = 3

End Sub

'存檔
Sub fn_PutEndXls(oStrFileName As String)
If Dir(App.path & "\" & oStrFileName) <> "" Then
    Kill App.path & "\" & oStrFileName
End If

    IsOpenExcel = False
    
    'Modify by Amy 2017/12/26 ++判斷版本
    If Val(xlsCustPoint.Version) < 12 Then
        xlsCustPoint.Workbooks(1).SaveAs FileName:=App.path & "\" & oStrFileName, FileFormat:=-4143
    Else
        xlsCustPoint.Workbooks(1).SaveAs FileName:=App.path & "\" & oStrFileName, FileFormat:=56
    End If
    xlsCustPoint.Workbooks.Close
    xlsCustPoint.Quit
    Set xlsCustPoint = Nothing
    Set wksrpt = Nothing

    PUB_KillTempFile "$$*.*" '刪代表圖檔
End Sub

'抓取所有發明人名稱
Private Function GetInventor(ByRef Str01 As String, ByRef Str02 As String, ByRef Str03 As String, ByRef Str04 As String) As String
   GetInventor = ""
   'Modify By Sindy 2014/11/12
   If strSrvDate(1) >= 專利發明人檔啟用日 Then
      strExc(0) = "Select Decode(in04,null,decode(in05,null,in06,in05),in04) Inv" & _
                  " From PatentInventor,Inventor" & _
                  " Where pi01='" & Str01 & "' And pi02='" & Str02 & "' And pi03='" & Str03 & "' And pi04='" & Str04 & "'" & _
                  " and substr(pi06,1,8)=in01(+) and substr(pi06,9,2)=in02(+)" & _
                  " Order by pi05 asc"
   Else
   '2014/11/12 END
      strExc(0) = "Select Decode(in04,null,decode(in05,null,in06,in05),in04) Inv, decode(in01||in02,pa60,'pa60',pa61,'pa61',pa62,'pa62',pa63,'pa63',pa64,'pa64',pa65,'pa65',pa66,'pa66',pa67,'pa67',pa68,'pa68',pa69,'pa69') ColName " & _
                    "From Patent,Inventor Where pa01='" & Str01 & "' And pa02='" & Str02 & "' And pa03='" & Str03 & "' And pa04='" & Str04 & "' " & _
                     "And in01||in02 in (pa60,pa61,pa62,pa63,pa64,pa65,pa66,pa67,pa68,pa69) Order by ColName"
   End If
   intI = 1
   Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
   If intI = 1 Then
        Do While RsTemp.EOF = False
            GetInventor = GetInventor & RsTemp.Fields("Inv") & ","
            RsTemp.MoveNext
        Loop
   End If
   If GetInventor <> "" Then GetInventor = Left(GetInventor, Len(GetInventor) - 1)
End Function

'Added by Morgan 2015/3/9
Public Function ChgTradeMark(ByVal strTemp As String, Optional iSitu As Integer = 0) As String
 Dim strCase(1 To 4) As String
On Error GoTo ErrHand
   If iSitu = 0 Then
      If strTemp = "" Then GoTo ErrHand
      If Len(strTemp) > 3 Then
         ChgCaseNo strTemp, strCase
      Else
         Erase strCase
         strCase(1) = strTemp
      End If
      ChgTradeMark = "TM01='" & strCase(1) & "'" & IIf(strCase(2) <> "", " AND TM02='" & strCase(2) & "' AND TM03='" & strCase(3) & "' AND TM04='" & strCase(4) & "'", "")
   Else
      ChgTradeMark = "DECODE(TM03||TM04,'000',TM01||'-'||TM02,TM01||'-'||TM02||'-'||TM03||'-'||TM04)"
   End If
   Exit Function
ErrHand:
   ChgTradeMark = "TM01 IS NULL AND TM02 IS NULL AND TM03 IS NULL AND TM04 IS NULL"
End Function


Public Function ChgLawcase(ByVal strTemp As String, Optional iSitu As Integer = 0) As String
 Dim strCase(1 To 4) As String
On Error GoTo ErrHand
   If iSitu = 0 Then
      If strTemp = "" Then GoTo ErrHand
      If Len(strTemp) > 3 Then
         ChgCaseNo strTemp, strCase
      Else
         Erase strCase
         strCase(1) = strTemp
      End If
      ChgLawcase = "LC01='" & strCase(1) & "'" & IIf(strCase(2) <> "", " AND LC02='" & strCase(2) & "' AND LC03='" & strCase(3) & "' AND LC04='" & strCase(4) & "'", "")
   Else
      ChgLawcase = "DECODE(LC03||LC04,'000',LC01||'-'||LC02,LC01||'-'||LC02||'-'||LC03||'-'||LC04)"
   End If
   Exit Function
ErrHand:
   ChgLawcase = "LC01 IS NULL AND LC02 IS NULL AND LC03 IS NULL AND LC04 IS NULL"
End Function


Public Function ChgPatent(ByVal strTemp As String, Optional iSitu As Integer = 0) As String
 Dim strCase(1 To 4) As String
On Error GoTo ErrHand
   If iSitu = 0 Then
      If strTemp = "" Then GoTo ErrHand
      If Len(strTemp) > 3 Then
         ChgCaseNo strTemp, strCase
      Else
         Erase strCase
         strCase(1) = strTemp
      End If
      ChgPatent = "PA01='" & strCase(1) & "'" & IIf(strCase(2) <> "", " AND PA02='" & strCase(2) & "' AND PA03='" & strCase(3) & "' AND PA04='" & strCase(4) & "'", "")
   Else
      ChgPatent = "DECODE(PA03||PA04,'000',PA01||'-'||PA02,PA01||'-'||PA02||'-'||PA03||'-'||PA04)"
   End If
   Exit Function
ErrHand:
   ChgPatent = "PA01 IS NULL AND PA02 IS NULL AND PA03 IS NULL AND PA04 IS NULL"
End Function

'end 2015/3/9

'Add by Amy 2018/02/05 清變數,否則連續重跑只有一筆資料時,計數及圖檔可能不會出現 ex:X07000230/CFT-018749
Sub ClearVar()
    oldCaseNo = ""
End Sub

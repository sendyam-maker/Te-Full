VERSION 5.00
Object = "{BDC217C8-ED16-11CD-956C-0000C04E4C0A}#1.1#0"; "TABCTL32.OCX"
Object = "{0ECD9B60-23AA-11D0-B351-00A0C9055D8E}#6.0#0"; "MSHFLXGD.OCX"
Object = "{0D452EE1-E08F-101A-852E-02608C4D0BB4}#2.0#0"; "FM20.DLL"
Begin VB.Form frm090801_New 
   Appearance      =   0  '平面
   BackColor       =   &H80000005&
   BorderStyle     =   1  '單線固定
   Caption         =   "案件接洽單(電子收文)"
   ClientHeight    =   9852
   ClientLeft      =   3396
   ClientTop       =   2724
   ClientWidth     =   8952
   ControlBox      =   0   'False
   HasDC           =   0   'False
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   ScaleHeight     =   9852
   ScaleWidth      =   8952
   Begin VB.CheckBox Check10 
      Caption         =   "規費調整"
      BeginProperty Font 
         Name            =   "新細明體"
         Size            =   9
         Charset         =   136
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00404000&
      Height          =   195
      Left            =   2070
      TabIndex        =   710
      Top             =   30
      Width           =   1100
   End
   Begin VB.CheckBox ChkCRL152 
      Caption         =   "自行送簽核"
      BeginProperty Font 
         Name            =   "新細明體"
         Size            =   9
         Charset         =   136
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FF0000&
      Height          =   195
      Left            =   1320
      TabIndex        =   690
      Top             =   300
      Width           =   1800
   End
   Begin VB.CommandButton cmdCRL134 
      BackColor       =   &H00C0C0C0&
      Caption         =   "對造為本所客戶："
      BeginProperty Font 
         Name            =   "新細明體"
         Size            =   9
         Charset         =   136
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   7260
      Style           =   1  '圖片外觀
      TabIndex        =   689
      Top             =   7560
      Visible         =   0   'False
      Width           =   1725
   End
   Begin VB.Frame FrameCRL147 
      Caption         =   "Frame31"
      Height          =   255
      Left            =   24
      TabIndex        =   685
      Top             =   270
      Width           =   1280
      Begin VB.CheckBox Check12 
         BackColor       =   &H0080FFFF&
         Caption         =   "費用已核准"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   9
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   255
         Left            =   0
         TabIndex        =   686
         Top             =   0
         Width           =   1280
      End
   End
   Begin VB.Frame FrameCRL90 
      Caption         =   "Frame32"
      Height          =   255
      Left            =   1320
      TabIndex        =   676
      Top             =   0
      Width           =   710
      Begin VB.CheckBox Check11 
         BackColor       =   &H008080FF&
         Caption         =   "急件"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   9
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   255
         Left            =   0
         TabIndex        =   677
         Top             =   0
         Width           =   765
      End
   End
   Begin VB.Frame FrameCRL66 
      Caption         =   "Frame31"
      Height          =   255
      Left            =   24
      TabIndex        =   674
      Top             =   0
      Width           =   1280
      Begin VB.CheckBox ChkCRL66 
         BackColor       =   &H0000C000&
         Caption         =   "對造已簽准"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   9
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   255
         Left            =   0
         TabIndex        =   675
         Top             =   0
         Width           =   1280
      End
   End
   Begin VB.CheckBox Check6 
      Caption         =   "支票"
      Height          =   240
      Index           =   1
      Left            =   2220
      TabIndex        =   275
      Top             =   7740
      Width           =   975
   End
   Begin VB.CheckBox Check6 
      Caption         =   "現金"
      Height          =   255
      Index           =   0
      Left            =   240
      TabIndex        =   271
      Top             =   7740
      Width           =   735
   End
   Begin VB.CommandButton cmdDelCRL 
      Caption         =   "刪除"
      Height          =   350
      Left            =   6480
      TabIndex        =   270
      Top             =   60
      Visible         =   0   'False
      Width           =   770
   End
   Begin VB.CommandButton cmdSend 
      Caption         =   "待收文區(10)"
      Height          =   350
      Left            =   6070
      TabIndex        =   249
      Top             =   60
      Width           =   1170
   End
   Begin VB.ComboBox Combo1 
      Height          =   260
      Index           =   4
      Left            =   540
      TabIndex        =   254
      Top             =   7425
      Width           =   2235
   End
   Begin VB.ComboBox Combo1 
      Height          =   260
      Index           =   2
      Left            =   540
      TabIndex        =   253
      Top             =   6765
      Width           =   2235
   End
   Begin VB.ComboBox Combo1 
      Height          =   260
      Index           =   3
      Left            =   540
      TabIndex        =   252
      Top             =   7095
      Width           =   2235
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000009&
      Height          =   315
      Left            =   -7716
      ScaleHeight     =   264
      ScaleWidth      =   288
      TabIndex        =   56
      Top             =   30
      Visible         =   0   'False
      Width           =   330
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "清除畫面(&C)"
      Height          =   350
      Index           =   2
      Left            =   3900
      TabIndex        =   50
      Top             =   60
      Width           =   1080
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "結束(&X)"
      CausesValidation=   0   'False
      Height          =   350
      Index           =   1
      Left            =   8100
      TabIndex        =   52
      Top             =   60
      Width           =   770
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "新增"
      Height          =   350
      Index           =   0
      Left            =   7280
      TabIndex        =   51
      Top             =   60
      Width           =   770
   End
   Begin TabDlg.SSTab SSTab1 
      Height          =   5940
      Left            =   12
      TabIndex        =   54
      Top             =   540
      Width           =   8892
      _ExtentX        =   15706
      _ExtentY        =   10478
      _Version        =   393216
      Tabs            =   6
      Tab             =   1
      TabsPerRow      =   6
      TabHeight       =   520
      ForeColor       =   -2147483633
      TabCaption(0)   =   "案件/收費項目"
      TabPicture(0)   =   "frm090801_New.frx":0000
      Tab(0).ControlEnabled=   0   'False
      Tab(0).Control(0)=   "Frame33(0)"
      Tab(0).Control(0).Enabled=   0   'False
      Tab(0).ControlCount=   1
      TabCaption(1)   =   "來源及申請人"
      TabPicture(1)   =   "frm090801_New.frx":001C
      Tab(1).ControlEnabled=   -1  'True
      Tab(1).Control(0)=   "SSTab2"
      Tab(1).Control(0).Enabled=   0   'False
      Tab(1).ControlCount=   1
      TabCaption(2)   =   "說明處理事項"
      TabPicture(2)   =   "frm090801_New.frx":0038
      Tab(2).ControlEnabled=   0   'False
      Tab(2).Control(0)=   "SSTab3"
      Tab(2).ControlCount=   1
      TabCaption(3)   =   "發明人資料"
      TabPicture(3)   =   "frm090801_New.frx":0054
      Tab(3).ControlEnabled=   0   'False
      Tab(3).Control(0)=   "Text4(1)"
      Tab(3).Control(1)=   "Text4(2)"
      Tab(3).Control(2)=   "Text4(3)"
      Tab(3).Control(3)=   "Text4(4)"
      Tab(3).Control(4)=   "Text4(5)"
      Tab(3).Control(5)=   "Text4(6)"
      Tab(3).Control(6)=   "Text4(7)"
      Tab(3).Control(7)=   "Text4(8)"
      Tab(3).Control(8)=   "Text4(9)"
      Tab(3).Control(9)=   "Label6(0)"
      Tab(3).Control(10)=   "Label7(0)"
      Tab(3).Control(11)=   "Label8(0)"
      Tab(3).Control(12)=   "Label9(0)"
      Tab(3).Control(13)=   "Label5(0)"
      Tab(3).Control(14)=   "Label5(1)"
      Tab(3).Control(15)=   "Label5(2)"
      Tab(3).Control(16)=   "Label5(3)"
      Tab(3).Control(17)=   "Label5(4)"
      Tab(3).Control(18)=   "Label5(5)"
      Tab(3).Control(19)=   "Label5(6)"
      Tab(3).Control(20)=   "Label5(7)"
      Tab(3).Control(21)=   "Label5(8)"
      Tab(3).Control(22)=   "Label5(9)"
      Tab(3).Control(23)=   "Label10"
      Tab(3).Control(24)=   "Label6(1)"
      Tab(3).Control(25)=   "Text2(0)"
      Tab(3).Control(26)=   "Text2(1)"
      Tab(3).Control(27)=   "Text2(2)"
      Tab(3).Control(28)=   "Text2(3)"
      Tab(3).Control(29)=   "Text2(4)"
      Tab(3).Control(30)=   "Text2(5)"
      Tab(3).Control(31)=   "Text2(6)"
      Tab(3).Control(32)=   "Text2(7)"
      Tab(3).Control(33)=   "Text2(8)"
      Tab(3).Control(34)=   "Text2(9)"
      Tab(3).Control(35)=   "Text4(0)"
      Tab(3).Control(36)=   "Text3(0)"
      Tab(3).Control(37)=   "Combo3(0)"
      Tab(3).Control(38)=   "Text3(1)"
      Tab(3).Control(39)=   "Combo3(1)"
      Tab(3).Control(40)=   "Text3(2)"
      Tab(3).Control(41)=   "Combo3(2)"
      Tab(3).Control(42)=   "Text3(3)"
      Tab(3).Control(43)=   "Combo3(3)"
      Tab(3).Control(44)=   "Text3(4)"
      Tab(3).Control(45)=   "Combo3(4)"
      Tab(3).Control(46)=   "Text3(5)"
      Tab(3).Control(47)=   "Combo3(5)"
      Tab(3).Control(48)=   "Text3(6)"
      Tab(3).Control(49)=   "Combo3(6)"
      Tab(3).Control(50)=   "Text3(7)"
      Tab(3).Control(51)=   "Combo3(7)"
      Tab(3).Control(52)=   "Text3(8)"
      Tab(3).Control(53)=   "Combo3(8)"
      Tab(3).Control(54)=   "Text3(9)"
      Tab(3).Control(55)=   "Combo3(9)"
      Tab(3).Control(56)=   "cmdInventor"
      Tab(3).Control(57)=   "ChkAddress(0)"
      Tab(3).Control(58)=   "ChkAddress(1)"
      Tab(3).Control(59)=   "ChkAddress(2)"
      Tab(3).Control(60)=   "ChkAddress(3)"
      Tab(3).Control(61)=   "ChkAddress(4)"
      Tab(3).Control(62)=   "ChkAddress(5)"
      Tab(3).Control(63)=   "ChkAddress(6)"
      Tab(3).Control(64)=   "ChkAddress(7)"
      Tab(3).Control(65)=   "ChkAddress(8)"
      Tab(3).Control(66)=   "ChkAddress(9)"
      Tab(3).ControlCount=   67
      TabCaption(4)   =   "商標圖及說明"
      TabPicture(4)   =   "frm090801_New.frx":0070
      Tab(4).ControlEnabled=   0   'False
      Tab(4).Control(0)=   "PicText"
      Tab(4).Control(1)=   "G_SeekPicColor"
      Tab(4).Control(2)=   "Frame47"
      Tab(4).Control(3)=   "Frame5"
      Tab(4).Control(4)=   "tmpPic"
      Tab(4).Control(5)=   "cmdPic"
      Tab(4).Control(6)=   "Frame15"
      Tab(4).Control(7)=   "Frame17"
      Tab(4).Control(8)=   "pic1"
      Tab(4).Control(9)=   "Frame29"
      Tab(4).Control(10)=   "FRTMQ"
      Tab(4).ControlCount=   11
      TabCaption(5)   =   "簽核狀況"
      TabPicture(5)   =   "frm090801_New.frx":008C
      Tab(5).ControlEnabled=   0   'False
      Tab(5).Control(0)=   "Frame56"
      Tab(5).Control(1)=   "txtF0309"
      Tab(5).Control(2)=   "txtF0310"
      Tab(5).Control(3)=   "Frame57"
      Tab(5).Control(4)=   "GRD1"
      Tab(5).Control(5)=   "Label29"
      Tab(5).Control(6)=   "LblReason"
      Tab(5).Control(7)=   "Label36"
      Tab(5).Control(8)=   "Label37"
      Tab(5).Control(9)=   "txtF0310_2"
      Tab(5).Control(10)=   "txtF0407"
      Tab(5).Control(11)=   "Label30"
      Tab(5).Control(12)=   "Label32"
      Tab(5).Control(13)=   "Label1(128)"
      Tab(5).Control(14)=   "txtF0306"
      Tab(5).Control(15)=   "Label33"
      Tab(5).Control(16)=   "Label1(130)"
      Tab(5).Control(17)=   "Label34"
      Tab(5).Control(18)=   "txtNote"
      Tab(5).Control(19)=   "Label35"
      Tab(5).Control(20)=   "txtCRL69"
      Tab(5).Control(21)=   "LblRecved"
      Tab(5).ControlCount=   22
      Begin TabDlg.SSTab SSTab3 
         Height          =   5505
         Left            =   -74910
         TabIndex        =   97
         Top             =   360
         Width           =   8700
         _ExtentX        =   15346
         _ExtentY        =   9694
         _Version        =   393216
         Tabs            =   2
         TabsPerRow      =   2
         TabHeight       =   520
         TabCaption(0)   =   "一般"
         TabPicture(0)   =   "frm090801_New.frx":00A8
         Tab(0).ControlEnabled=   -1  'True
         Tab(0).Control(0)=   "txtCRL70"
         Tab(0).Control(0).Enabled=   0   'False
         Tab(0).Control(1)=   "Text1(119)"
         Tab(0).Control(1).Enabled=   0   'False
         Tab(0).Control(2)=   "Label16"
         Tab(0).Control(2).Enabled=   0   'False
         Tab(0).Control(3)=   "Frame18"
         Tab(0).Control(3).Enabled=   0   'False
         Tab(0).Control(4)=   "FrameT"
         Tab(0).Control(4).Enabled=   0   'False
         Tab(0).Control(5)=   "FrameP"
         Tab(0).Control(5).Enabled=   0   'False
         Tab(0).Control(6)=   "FrameL"
         Tab(0).Control(6).Enabled=   0   'False
         Tab(0).Control(7)=   "Frame13"
         Tab(0).Control(7).Enabled=   0   'False
         Tab(0).ControlCount=   8
         TabCaption(1)   =   "舉發聲明"
         TabPicture(1)   =   "frm090801_New.frx":00C4
         Tab(1).ControlEnabled=   0   'False
         Tab(1).Control(0)=   "txtMonth(0)"
         Tab(1).Control(1)=   "txtYear(0)"
         Tab(1).Control(2)=   "txtDay(0)"
         Tab(1).Control(3)=   "txtYear(1)"
         Tab(1).Control(4)=   "txtMonth(1)"
         Tab(1).Control(5)=   "txtDay(1)"
         Tab(1).Control(6)=   "txtItemCount"
         Tab(1).Control(7)=   "chkItem(0)"
         Tab(1).Control(8)=   "chkItem(1)"
         Tab(1).Control(9)=   "chkItem(4)"
         Tab(1).Control(10)=   "chkItem(3)"
         Tab(1).Control(11)=   "chkItem(5)"
         Tab(1).Control(12)=   "chkItem(2)"
         Tab(1).Control(13)=   "txtItemList"
         Tab(1).Control(14)=   "chkItem(6)"
         Tab(1).Control(15)=   "Label18"
         Tab(1).Control(16)=   "Label15"
         Tab(1).Control(17)=   "Label17"
         Tab(1).ControlCount=   18
         Begin VB.Frame Frame13 
            Caption         =   "代理人"
            Height          =   795
            Left            =   60
            TabIndex        =   296
            Top             =   4650
            Width           =   8565
            Begin VB.CommandButton cmdSerach 
               Caption         =   "搜尋(&1)"
               Height          =   255
               Index           =   5
               Left            =   2640
               TabIndex        =   297
               Top             =   210
               Width           =   945
            End
            Begin VB.Label Label1 
               Caption         =   "彼所案號："
               ForeColor       =   &H000000C0&
               Height          =   225
               Index           =   137
               Left            =   3900
               TabIndex        =   303
               Top             =   240
               Width           =   915
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   137
               Left            =   4860
               TabIndex        =   302
               Top             =   150
               Width           =   3495
               VariousPropertyBits=   671107099
               MaxLength       =   100
               Size            =   "6165;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   130
               Left            =   1410
               TabIndex        =   301
               Top             =   480
               Width           =   6945
               VariousPropertyBits=   671107099
               MaxLength       =   40
               Size            =   "12250;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   5
               Left            =   1410
               TabIndex        =   300
               Top             =   150
               Width           =   1095
               VariousPropertyBits=   671107099
               Size            =   "1931;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "代理人名稱："
               Height          =   255
               Index           =   119
               Left            =   180
               TabIndex        =   299
               Top             =   510
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "代理人編號："
               Height          =   255
               Index           =   118
               Left            =   180
               TabIndex        =   298
               Top             =   240
               Width           =   1215
            End
         End
         Begin VB.Frame FrameL 
            BackColor       =   &H00FFFFC0&
            Caption         =   "法務"
            Height          =   2265
            Left            =   2040
            TabIndex        =   445
            Top             =   3150
            Visible         =   0   'False
            Width           =   8595
            Begin VB.Frame Frame19 
               Height          =   525
               Left            =   60
               TabIndex        =   449
               Top             =   150
               Visible         =   0   'False
               Width           =   8060
               Begin VB.CheckBox Check3 
                  Caption         =   "公平交易法"
                  Height          =   255
                  Index           =   6
                  Left            =   5220
                  TabIndex        =   456
                  Top             =   240
                  Width           =   1300
               End
               Begin VB.CheckBox Check3 
                  Caption         =   "營業秘密法"
                  Height          =   255
                  Index           =   5
                  Left            =   3780
                  TabIndex        =   455
                  Top             =   240
                  Width           =   1300
               End
               Begin VB.CheckBox Check3 
                  Caption         =   "專利"
                  Height          =   255
                  Index           =   0
                  Left            =   3780
                  TabIndex        =   454
                  Top             =   -30
                  Width           =   680
               End
               Begin VB.CheckBox Check3 
                  Caption         =   "商標"
                  Height          =   255
                  Index           =   1
                  Left            =   4500
                  TabIndex        =   453
                  Top             =   -30
                  Width           =   680
               End
               Begin VB.CheckBox Check3 
                  Caption         =   "著作權"
                  Height          =   255
                  Index           =   2
                  Left            =   5220
                  TabIndex        =   452
                  Top             =   -30
                  Width           =   855
               End
               Begin VB.CheckBox Check3 
                  Caption         =   "其他智財權"
                  Height          =   255
                  Index           =   3
                  Left            =   6090
                  TabIndex        =   451
                  Top             =   -30
                  Width           =   1220
               End
               Begin VB.CheckBox Check3 
                  Caption         =   "一般"
                  Height          =   255
                  Index           =   4
                  Left            =   7320
                  TabIndex        =   450
                  Top             =   -30
                  Width           =   680
               End
               Begin MSForms.TextBox Text1 
                  Height          =   450
                  Index           =   127
                  Left            =   930
                  TabIndex        =   458
                  Top             =   0
                  Width           =   2775
                  VariousPropertyBits=   671107103
                  BackColor       =   -2147483633
                  MaxLength       =   200
                  Size            =   "4895;794"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label31 
                  Caption         =   "案件屬性："
                  Height          =   180
                  Left            =   0
                  TabIndex        =   457
                  Top             =   45
                  Width           =   945
               End
            End
            Begin VB.Frame Frame41 
               Height          =   705
               Left            =   60
               TabIndex        =   446
               Top             =   630
               Visible         =   0   'False
               Width           =   3525
               Begin VB.OptionButton Option9 
                  Caption         =   "提供書面分析"
                  Height          =   195
                  Index           =   0
                  Left            =   150
                  TabIndex        =   448
                  Top             =   180
                  Width           =   1755
               End
               Begin VB.OptionButton Option9 
                  Caption         =   "請律師向當事人說明"
                  Height          =   195
                  Index           =   1
                  Left            =   150
                  TabIndex        =   447
                  Top             =   420
                  Width           =   3255
               End
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   139
               Left            =   1140
               TabIndex        =   459
               Top             =   1380
               Width           =   1125
               VariousPropertyBits=   671107099
               MaxLength       =   7
               Size            =   "1984;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   140
               Left            =   2760
               TabIndex        =   460
               Top             =   1380
               Width           =   1125
               VariousPropertyBits=   671107099
               MaxLength       =   7
               Size            =   "1984;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "聘任期間：   　                        ∼"
               Height          =   255
               Index           =   140
               Left            =   120
               TabIndex        =   461
               Top             =   1440
               Width           =   3795
            End
         End
         Begin VB.Frame FrameP 
            BackColor       =   &H00C0FFC0&
            Caption         =   "專利"
            Height          =   2265
            Left            =   1680
            TabIndex        =   426
            Top             =   3000
            Visible         =   0   'False
            Width           =   8595
            Begin VB.Frame Frame16 
               Height          =   705
               Left            =   90
               TabIndex        =   438
               Top             =   660
               Visible         =   0   'False
               Width           =   3525
               Begin VB.OptionButton Option3 
                  Caption         =   "切勿超頁超項，本案無法向客戶收款"
                  Height          =   195
                  Index           =   1
                  Left            =   150
                  TabIndex        =   440
                  Top             =   420
                  Width           =   3255
               End
               Begin VB.OptionButton Option3 
                  Caption         =   "可以收超頁超項費"
                  Height          =   195
                  Index           =   0
                  Left            =   150
                  TabIndex        =   439
                  Top             =   180
                  Width           =   1755
               End
            End
            Begin VB.Frame Frame25 
               Height          =   465
               Left            =   3990
               TabIndex        =   435
               Top             =   750
               Width           =   2190
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   128
                  Left            =   1080
                  TabIndex        =   437
                  Top             =   60
                  Width           =   1005
                  VariousPropertyBits=   671107099
                  MaxLength       =   7
                  Size            =   "3016;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label14 
                  Caption         =   "優惠期事實發生日期："
                  Height          =   375
                  Left            =   45
                  TabIndex        =   436
                  Top             =   60
                  Width           =   915
               End
            End
            Begin VB.Frame Frame48 
               Height          =   315
               Left            =   90
               TabIndex        =   431
               Top             =   390
               Width           =   2445
               Begin VB.OptionButton OptNewDrug 
                  Caption         =   "是"
                  Height          =   180
                  Index           =   1
                  Left            =   1470
                  TabIndex        =   433
                  TabStop         =   0   'False
                  Top             =   90
                  Width           =   510
               End
               Begin VB.OptionButton OptNewDrug 
                  Caption         =   "否"
                  Height          =   180
                  Index           =   0
                  Left            =   2010
                  TabIndex        =   432
                  TabStop         =   0   'False
                  Top             =   90
                  Width           =   555
               End
               Begin VB.Label Label27 
                  AutoSize        =   -1  'True
                  Caption         =   "是否為新藥專利："
                  Height          =   180
                  Left            =   60
                  TabIndex        =   434
                  Top             =   90
                  Width           =   1440
               End
            End
            Begin VB.Frame Frame45 
               Height          =   345
               Left            =   90
               TabIndex        =   427
               Top             =   60
               Visible         =   0   'False
               Width           =   2295
               Begin VB.OptionButton Opt45 
                  Caption         =   "否"
                  Height          =   195
                  Index           =   1
                  Left            =   1800
                  TabIndex        =   429
                  Top             =   120
                  Width           =   585
               End
               Begin VB.OptionButton Opt45 
                  Caption         =   "是"
                  Height          =   195
                  Index           =   0
                  Left            =   1260
                  TabIndex        =   428
                  Top             =   120
                  Width           =   555
               End
               Begin VB.Label Label26 
                  AutoSize        =   -1  'True
                  Caption         =   "是否會簡體版："
                  Height          =   180
                  Left            =   30
                  TabIndex        =   430
                  Top             =   120
                  Width           =   1260
               End
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   4
               Left            =   5505
               TabIndex        =   441
               Top             =   120
               Width           =   375
               VariousPropertyBits=   671107099
               MaxLength       =   2
               Size            =   "661;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   114
               Left            =   5685
               TabIndex        =   444
               Top             =   420
               Width           =   375
               VariousPropertyBits=   671107099
               MaxLength       =   4
               Size            =   "661;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               AutoSize        =   -1  'True
               Caption         =   "申請技術報告項數："
               Height          =   180
               Index           =   125
               Left            =   4005
               TabIndex        =   443
               Top             =   510
               Width           =   1620
            End
            Begin VB.Label Label1 
               AutoSize        =   -1  'True
               Caption         =   "申請優先權證明書          份"
               Height          =   180
               Index           =   88
               Left            =   4005
               TabIndex        =   442
               Top             =   210
               Width           =   2190
            End
         End
         Begin VB.Frame FrameT 
            BackColor       =   &H00C0E0FF&
            Caption         =   "商標"
            Height          =   2265
            Left            =   60
            TabIndex        =   304
            Top             =   2310
            Visible         =   0   'False
            Width           =   8595
            Begin VB.Frame Frame27 
               Height          =   645
               Left            =   60
               TabIndex        =   422
               Top             =   1410
               Visible         =   0   'False
               Width           =   3465
               Begin VB.OptionButton Option8 
                  Caption         =   "有近似"
                  Height          =   195
                  Index           =   0
                  Left            =   2310
                  TabIndex        =   424
                  Top             =   120
                  Width           =   915
               End
               Begin VB.OptionButton Option8 
                  Caption         =   "無近似"
                  Height          =   195
                  Index           =   1
                  Left            =   2310
                  TabIndex        =   423
                  Top             =   360
                  Width           =   915
               End
               Begin VB.Label Label19 
                  Caption         =   "是否在該國有無近似案件："
                  Height          =   225
                  Left            =   60
                  TabIndex        =   425
                  Top             =   120
                  Width           =   2175
               End
            End
            Begin VB.Frame Frame21 
               Height          =   1005
               Left            =   60
               TabIndex        =   318
               Top             =   390
               Visible         =   0   'False
               Width           =   3135
               Begin VB.Frame Frame22 
                  BorderStyle     =   0  '沒有框線
                  Height          =   260
                  Left            =   60
                  TabIndex        =   331
                  Top             =   150
                  Width           =   2235
                  Begin VB.OptionButton OptEP06 
                     Caption         =   "否"
                     Height          =   255
                     Index           =   1
                     Left            =   1740
                     TabIndex        =   333
                     Top             =   -30
                     Width           =   435
                  End
                  Begin VB.OptionButton OptEP06 
                     Caption         =   "是"
                     Height          =   255
                     Index           =   0
                     Left            =   1290
                     TabIndex        =   332
                     Top             =   -30
                     Width           =   435
                  End
                  Begin VB.Label Label23 
                     AutoSize        =   -1  'True
                     Caption         =   "資料是否齊備："
                     Height          =   180
                     Left            =   0
                     TabIndex        =   334
                     Top             =   0
                     Width           =   1260
                  End
               End
               Begin VB.Frame Frame23 
                  BorderStyle     =   0  '沒有框線
                  Height          =   285
                  Left            =   60
                  TabIndex        =   327
                  Top             =   420
                  Width           =   2235
                  Begin VB.OptionButton OptEP34 
                     Caption         =   "否"
                     Height          =   255
                     Index           =   1
                     Left            =   1740
                     TabIndex        =   329
                     Top             =   30
                     Width           =   435
                  End
                  Begin VB.OptionButton OptEP34 
                     Caption         =   "是"
                     Height          =   255
                     Index           =   0
                     Left            =   1290
                     TabIndex        =   328
                     Top             =   30
                     Width           =   435
                  End
                  Begin VB.Label Label12 
                     Alignment       =   1  '靠右對齊
                     AutoSize        =   -1  'True
                     Caption         =   "是否會稿："
                     Height          =   180
                     Left            =   0
                     TabIndex        =   330
                     Top             =   30
                     Width           =   1260
                  End
               End
               Begin VB.Frame Frame42 
                  BackColor       =   &H00FFFFC0&
                  BorderStyle     =   0  '沒有框線
                  Height          =   285
                  Left            =   870
                  TabIndex        =   323
                  Top             =   390
                  Width           =   2235
                  Begin VB.OptionButton OptCP143 
                     Caption         =   "是"
                     Height          =   255
                     Index           =   0
                     Left            =   1290
                     TabIndex        =   325
                     Top             =   0
                     Width           =   435
                  End
                  Begin VB.OptionButton OptCP143 
                     Caption         =   "否"
                     Height          =   255
                     Index           =   1
                     Left            =   1740
                     TabIndex        =   324
                     Top             =   0
                     Width           =   435
                  End
                  Begin VB.Label Label24 
                     AutoSize        =   -1  'True
                     Caption         =   "查名是否齊備："
                     Height          =   180
                     Left            =   0
                     TabIndex        =   326
                     Top             =   30
                     Width           =   1260
                  End
               End
               Begin VB.Frame Frame43 
                  BackColor       =   &H80000004&
                  BorderStyle     =   0  '沒有框線
                  Height          =   285
                  Left            =   60
                  TabIndex        =   319
                  Top             =   690
                  Width           =   2235
                  Begin VB.OptionButton OptCRL133 
                     Caption         =   "否"
                     Height          =   255
                     Index           =   1
                     Left            =   1755
                     TabIndex        =   321
                     Top             =   0
                     Value           =   -1  'True
                     Width           =   435
                  End
                  Begin VB.OptionButton OptCRL133 
                     Caption         =   "是"
                     Height          =   255
                     Index           =   0
                     Left            =   1290
                     TabIndex        =   320
                     Top             =   0
                     Width           =   435
                  End
                  Begin VB.Label Label21 
                     AutoSize        =   -1  'True
                     Caption         =   "可否延期："
                     Height          =   180
                     Left            =   360
                     TabIndex        =   322
                     Top             =   30
                     Width           =   900
                  End
               End
            End
            Begin VB.Frame Frame58 
               Caption         =   "T,TF,CFT"
               Height          =   375
               Left            =   60
               TabIndex        =   315
               Top             =   30
               Visible         =   0   'False
               Width           =   7670
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   138
                  Left            =   990
                  TabIndex        =   317
                  Top             =   30
                  Width           =   2900
                  VariousPropertyBits=   671107099
                  MaxLength       =   100
                  Size            =   "5115;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "商品類別：                                                              (台灣商品類別須為2碼) 以逗號分隔 "
                  ForeColor       =   &H000000C0&
                  Height          =   180
                  Index           =   138
                  Left            =   60
                  TabIndex        =   316
                  Top             =   60
                  Width           =   6820
               End
            End
            Begin VB.Frame Frame20 
               Caption         =   "加註"
               Height          =   1785
               Left            =   3570
               TabIndex        =   305
               Top             =   420
               Visible         =   0   'False
               Width           =   4845
               Begin VB.OptionButton Option6 
                  Caption         =   "相同文字／圖形，申請人已註冊"
                  Height          =   195
                  Index           =   5
                  Left            =   1020
                  TabIndex        =   311
                  Top             =   1080
                  Width           =   2925
               End
               Begin VB.OptionButton Option6 
                  Caption         =   "不查名，請逕提出申請"
                  Height          =   195
                  Index           =   4
                  Left            =   1020
                  TabIndex        =   310
                  Top             =   1560
                  Width           =   2925
               End
               Begin VB.OptionButton Option6 
                  Caption         =   "尚待查名"
                  Height          =   195
                  Index           =   3
                  Left            =   1020
                  TabIndex        =   309
                  Top             =   852
                  Width           =   2925
               End
               Begin VB.OptionButton Option6 
                  Caption         =   "已查名，無近似"
                  Height          =   195
                  Index           =   0
                  Left            =   1020
                  TabIndex        =   308
                  Top             =   150
                  Width           =   3255
               End
               Begin VB.OptionButton Option6 
                  Caption         =   "已查名，有近似，建議客戶申請"
                  Height          =   195
                  Index           =   2
                  Left            =   1020
                  TabIndex        =   307
                  Top             =   618
                  Width           =   2925
               End
               Begin VB.OptionButton Option6 
                  Caption         =   "已查名，有近似，客戶自願嘗試"
                  Height          =   195
                  Index           =   1
                  Left            =   1020
                  TabIndex        =   306
                  Top             =   384
                  Width           =   3255
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   133
                  Left            =   1740
                  TabIndex        =   312
                  Top             =   1260
                  Width           =   2325
                  VariousPropertyBits=   671107099
                  MaxLength       =   60
                  Size            =   "4101;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label22 
                  Caption         =   "有第                                                        號"
                  Height          =   180
                  Left            =   1275
                  TabIndex        =   314
                  Top             =   1320
                  Width           =   3255
               End
               Begin VB.Label Label11 
                  Caption         =   "查名狀態："
                  Height          =   180
                  Left            =   90
                  TabIndex        =   313
                  Top             =   210
                  Width           =   945
               End
            End
         End
         Begin VB.Frame Frame18 
            Height          =   315
            Left            =   120
            TabIndex        =   692
            Top             =   1980
            Visible         =   0   'False
            Width           =   8090
            Begin VB.Frame Frame3 
               Height          =   340
               Left            =   5100
               TabIndex        =   706
               Top             =   -60
               Width           =   2260
               Begin VB.OptionButton OptCP164 
                  Caption         =   "之前"
                  Height          =   195
                  Index           =   1
                  Left            =   720
                  TabIndex        =   709
                  Top             =   95
                  Width           =   705
               End
               Begin VB.OptionButton OptCP164 
                  Caption         =   "當天"
                  Height          =   195
                  Index           =   0
                  Left            =   30
                  TabIndex        =   708
                  Top             =   95
                  Width           =   705
               End
               Begin VB.OptionButton OptCP164 
                  Caption         =   "之後"
                  Height          =   195
                  Index           =   2
                  Left            =   1410
                  TabIndex        =   707
                  Top             =   95
                  Width           =   705
               End
            End
            Begin VB.OptionButton OptSendType 
               Caption         =   "指定日期"
               Height          =   315
               Index           =   2
               Left            =   3000
               TabIndex        =   695
               Top             =   -30
               Width           =   1040
            End
            Begin VB.OptionButton OptSendType 
               Caption         =   "收款後"
               Height          =   315
               Index           =   1
               Left            =   2100
               TabIndex        =   694
               Top             =   -30
               Width           =   1220
            End
            Begin VB.OptionButton OptSendType 
               Caption         =   "立即"
               Height          =   315
               Index           =   0
               Left            =   900
               TabIndex        =   693
               Top             =   -30
               Width           =   1220
            End
            Begin VB.Label Label1 
               Caption         =   "送件方式："
               Height          =   255
               Index           =   121
               Left            =   30
               TabIndex        =   697
               Top             =   30
               Width           =   915
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   126
               Left            =   4050
               TabIndex        =   696
               Top             =   0
               Width           =   1040
               VariousPropertyBits=   671107099
               MaxLength       =   7
               Size            =   "1834;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
         End
         Begin VB.TextBox txtMonth 
            Alignment       =   2  '置中對齊
            Enabled         =   0   'False
            Height          =   285
            Index           =   0
            Left            =   -72660
            MaxLength       =   2
            TabIndex        =   282
            Top             =   1620
            Width           =   285
         End
         Begin VB.TextBox txtYear 
            Alignment       =   2  '置中對齊
            Enabled         =   0   'False
            Height          =   285
            Index           =   0
            Left            =   -73380
            MaxLength       =   3
            TabIndex        =   281
            Top             =   1620
            Width           =   420
         End
         Begin VB.TextBox txtDay 
            Alignment       =   2  '置中對齊
            Enabled         =   0   'False
            Height          =   285
            Index           =   0
            Left            =   -72120
            MaxLength       =   2
            TabIndex        =   277
            Top             =   1620
            Width           =   285
         End
         Begin VB.TextBox txtYear 
            Alignment       =   2  '置中對齊
            Enabled         =   0   'False
            Height          =   285
            Index           =   1
            Left            =   -70995
            MaxLength       =   3
            TabIndex        =   280
            Top             =   1620
            Width           =   420
         End
         Begin VB.TextBox txtMonth 
            Alignment       =   2  '置中對齊
            Enabled         =   0   'False
            Height          =   285
            Index           =   1
            Left            =   -70320
            MaxLength       =   2
            TabIndex        =   279
            Top             =   1620
            Width           =   285
         End
         Begin VB.TextBox txtDay 
            Alignment       =   2  '置中對齊
            Enabled         =   0   'False
            Height          =   285
            Index           =   1
            Left            =   -69735
            MaxLength       =   2
            TabIndex        =   278
            Top             =   1620
            Width           =   285
         End
         Begin VB.TextBox txtItemCount 
            Enabled         =   0   'False
            Height          =   270
            Left            =   -72345
            TabIndex        =   276
            Top             =   660
            Width           =   375
         End
         Begin VB.CheckBox chkItem 
            Caption         =   "請求撤銷全部請求項：共計　　　項"
            Height          =   210
            Index           =   0
            Left            =   -74820
            TabIndex        =   290
            Top             =   690
            Width           =   3225
         End
         Begin VB.CheckBox chkItem 
            Caption         =   "請求撤銷部分之請求項："
            Height          =   210
            Index           =   1
            Left            =   -74820
            TabIndex        =   289
            Top             =   900
            Width           =   2400
         End
         Begin VB.CheckBox chkItem 
            Caption         =   "共有專利申請權非由全體共有人提出申請者"
            Height          =   210
            Index           =   4
            Left            =   -71580
            TabIndex        =   288
            Top             =   1110
            Width           =   4335
         End
         Begin VB.CheckBox chkItem 
            Caption         =   "專利權人為非專利申請權人者"
            Height          =   210
            Index           =   3
            Left            =   -71580
            TabIndex        =   287
            Top             =   900
            Width           =   4335
         End
         Begin VB.CheckBox chkItem 
            Caption         =   "專利權人所屬國家對中華民國申請專利不予受理者"
            Height          =   210
            Index           =   5
            Left            =   -71580
            TabIndex        =   286
            Top             =   1320
            Width           =   4335
         End
         Begin VB.CheckBox chkItem 
            Caption         =   "請求撤銷設計專利權"
            Enabled         =   0   'False
            Height          =   210
            Index           =   2
            Left            =   -71580
            TabIndex        =   285
            Top             =   690
            Width           =   4335
         End
         Begin VB.TextBox txtItemList 
            Enabled         =   0   'False
            Height          =   300
            Left            =   -74550
            TabIndex        =   284
            Text            =   "第項"
            Top             =   1110
            Width           =   2715
         End
         Begin VB.CheckBox chkItem 
            Caption         =   "請求撤銷自「        年      月      日」至「        年      月      日」之專利權期間延長"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   9
               Charset         =   136
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   210
            Index           =   6
            Left            =   -74820
            TabIndex        =   283
            Top             =   1650
            Width           =   7440
         End
         Begin VB.Label Label16 
            Caption         =   "訊息區："
            Height          =   180
            Left            =   5010
            TabIndex        =   641
            Top             =   390
            Width           =   945
         End
         Begin MSForms.TextBox Text1 
            Height          =   1575
            Index           =   119
            Left            =   60
            TabIndex        =   295
            Top             =   360
            Width           =   4905
            VariousPropertyBits=   -1466941413
            ScrollBars      =   2
            Size            =   "8652;2778"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox txtCRL70 
            Height          =   1305
            Left            =   4980
            TabIndex        =   294
            Top             =   630
            Width           =   3645
            VariousPropertyBits=   -1466941409
            BackColor       =   -2147483633
            BorderStyle     =   1
            ScrollBars      =   2
            Size            =   "6429;2302"
            SpecialEffect   =   0
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin VB.Label Label18 
            AutoSize        =   -1  'True
            Caption         =   "請求撤銷發明(新型)專利權"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   9
               Charset         =   136
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   180
            Left            =   -74820
            TabIndex        =   293
            Top             =   450
            Width           =   2295
         End
         Begin VB.Label Label15 
            AutoSize        =   -1  'True
            Caption         =   "請求撤銷全部專利權"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   9
               Charset         =   136
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   180
            Left            =   -71580
            TabIndex        =   292
            Top             =   450
            Width           =   1755
         End
         Begin VB.Label Label17 
            AutoSize        =   -1  'True
            Caption         =   "( 例如：第 1,3,5-12 項 )"
            Height          =   180
            Left            =   -74550
            TabIndex        =   291
            Top             =   1410
            Width           =   1800
         End
      End
      Begin VB.Frame FRTMQ 
         Caption         =   "委查結果"
         Height          =   2655
         Left            =   -74670
         TabIndex        =   462
         Top             =   2430
         Width           =   4335
         Begin VB.CommandButton cmdTMQApp 
            Caption         =   "查名單輸入"
            Height          =   300
            Left            =   1850
            TabIndex        =   488
            Top             =   240
            Width           =   1080
         End
         Begin VB.CommandButton cmdTMQ 
            Caption         =   "查覆區"
            Height          =   300
            Left            =   3000
            TabIndex        =   489
            Top             =   240
            Width           =   1080
         End
         Begin MSHierarchicalFlexGridLib.MSHFlexGrid GrdTMQ 
            Height          =   1935
            Left            =   120
            TabIndex        =   490
            Top             =   600
            Width           =   4095
            _ExtentX        =   7218
            _ExtentY        =   3408
            _Version        =   393216
            Cols            =   5
            FixedCols       =   0
            AllowUserResizing=   3
            FormatString    =   "V|已讀(Y)|申請編號|委查編號|結果"
            _NumberOfBands  =   1
            _Band(0).Cols   =   5
         End
         Begin VB.Label Label20 
            Caption         =   "勾選""V"" 表示收文"
            ForeColor       =   &H00FF0000&
            Height          =   255
            Left            =   360
            TabIndex        =   463
            Top             =   300
            Width           =   1935
         End
      End
      Begin VB.Frame Frame29 
         Height          =   375
         Left            =   -74520
         TabIndex        =   492
         Top             =   510
         Width           =   4335
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   129
            Left            =   720
            TabIndex        =   474
            Top             =   0
            Width           =   1305
            VariousPropertyBits=   671107099
            MaxLength       =   20
            Size            =   "3016;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   132
            Left            =   2910
            TabIndex        =   475
            Top             =   0
            Width           =   1305
            VariousPropertyBits=   671107099
            MaxLength       =   20
            Size            =   "3016;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin VB.Label Label1 
            Caption         =   "審定號："
            Height          =   255
            Index           =   126
            Left            =   0
            TabIndex        =   494
            Top             =   60
            Width           =   765
         End
         Begin VB.Label Label1 
            Caption         =   "申請案號："
            Height          =   255
            Index           =   23
            Left            =   2050
            TabIndex        =   493
            Top             =   60
            Width           =   1005
         End
      End
      Begin VB.PictureBox pic1 
         Height          =   255
         Left            =   -70440
         ScaleHeight     =   204
         ScaleWidth      =   204
         TabIndex        =   473
         Top             =   4710
         Visible         =   0   'False
         Width           =   255
      End
      Begin VB.Frame Frame17 
         Height          =   255
         Left            =   -72660
         TabIndex        =   472
         Top             =   1530
         Visible         =   0   'False
         Width           =   2160
         Begin VB.OptionButton optColor 
            Caption         =   "黑白/灰階"
            Height          =   180
            Index           =   0
            Left            =   0
            TabIndex        =   482
            Top             =   30
            Value           =   -1  'True
            Width           =   1125
         End
         Begin VB.OptionButton optColor 
            Caption         =   "彩色"
            Height          =   180
            Index           =   1
            Left            =   1380
            TabIndex        =   483
            Top             =   45
            Width           =   675
         End
      End
      Begin VB.Frame Frame15 
         Height          =   465
         Left            =   -74610
         TabIndex        =   471
         Top             =   870
         Width           =   4515
         Begin VB.OptionButton opt1 
            Caption         =   "圖形附檔"
            Height          =   255
            Index           =   1
            Left            =   780
            TabIndex        =   477
            Top             =   180
            Width           =   1065
         End
         Begin VB.OptionButton opt1 
            Caption         =   "文字"
            Height          =   255
            Index           =   0
            Left            =   30
            TabIndex        =   476
            Top             =   180
            Width           =   675
         End
         Begin VB.OptionButton opt1 
            Caption         =   "圖後補"
            Height          =   255
            Index           =   2
            Left            =   1890
            TabIndex        =   478
            Top             =   180
            Width           =   915
         End
         Begin VB.OptionButton opt1 
            Caption         =   "其他"
            Height          =   255
            Index           =   4
            Left            =   3750
            TabIndex        =   480
            Top             =   180
            Width           =   675
         End
         Begin VB.OptionButton opt1 
            Caption         =   "同卷號"
            Height          =   255
            Index           =   3
            Left            =   2820
            TabIndex        =   479
            Top             =   180
            Width           =   915
         End
      End
      Begin VB.CommandButton cmdPic 
         Caption         =   "選擇圖檔"
         Enabled         =   0   'False
         Height          =   465
         Left            =   -73860
         TabIndex        =   481
         Top             =   1410
         Width           =   1125
      End
      Begin VB.PictureBox tmpPic 
         Height          =   4455
         Left            =   -70050
         ScaleHeight     =   367
         ScaleMode       =   3  '像素
         ScaleWidth      =   295
         TabIndex        =   491
         Top             =   570
         Width           =   3588
         Begin VB.Image tmpImg 
            Height          =   1770
            Left            =   1425
            Stretch         =   -1  'True
            Top             =   1095
            Visible         =   0   'False
            Width           =   1890
         End
      End
      Begin VB.Frame Frame5 
         Height          =   550
         Left            =   -74715
         TabIndex        =   468
         Top             =   1812
         Width           =   4430
         Begin VB.TextBox TxtC1 
            Height          =   300
            Index           =   0
            Left            =   1320
            MaxLength       =   3
            TabIndex        =   484
            Top             =   120
            Width           =   465
         End
         Begin VB.TextBox TxtC1 
            Height          =   300
            Index           =   1
            Left            =   1830
            MaxLength       =   6
            TabIndex        =   485
            Top             =   120
            Width           =   765
         End
         Begin VB.TextBox TxtC1 
            Height          =   300
            Index           =   2
            Left            =   2640
            MaxLength       =   1
            TabIndex        =   486
            Top             =   120
            Width           =   225
         End
         Begin VB.TextBox TxtC1 
            Height          =   300
            Index           =   3
            Left            =   2930
            MaxLength       =   2
            TabIndex        =   487
            Top             =   120
            Width           =   345
         End
         Begin VB.Line Line22 
            X1              =   1740
            X2              =   3200
            Y1              =   270
            Y2              =   270
         End
         Begin VB.Label Label1 
            Caption         =   "圖同本所案號："
            Height          =   255
            Index           =   24
            Left            =   50
            TabIndex        =   470
            Top             =   165
            Width           =   1305
         End
         Begin VB.Label Label1 
            Caption         =   "第4欄跳離開才帶圖"
            ForeColor       =   &H00FF0000&
            Height          =   405
            Index           =   36
            Left            =   3300
            TabIndex        =   469
            Top             =   120
            Width           =   1005
         End
      End
      Begin VB.Frame Frame47 
         BackColor       =   &H00FFFFC0&
         BorderStyle     =   0  '沒有框線
         Height          =   1215
         Left            =   -74610
         TabIndex        =   465
         Top             =   3780
         Width           =   3945
         Begin VB.Label fra47Title 
            Caption         =   "商標說明："
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   11.4
               Charset         =   136
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   30
            TabIndex        =   467
            Top             =   0
            Width           =   2535
         End
         Begin MSForms.TextBox Text7 
            Height          =   915
            Left            =   0
            TabIndex        =   466
            Top             =   270
            Width           =   3855
            VariousPropertyBits=   671107099
            MaxLength       =   140
            Size            =   "6800;1614"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
      End
      Begin VB.PictureBox G_SeekPicColor 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         BackColor       =   &H80000009&
         Enabled         =   0   'False
         Height          =   300
         Left            =   -74790
         ScaleHeight     =   21
         ScaleMode       =   3  '像素
         ScaleWidth      =   16
         TabIndex        =   464
         Top             =   420
         Visible         =   0   'False
         Width           =   240
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   9
         Left            =   -66510
         TabIndex        =   405
         Top             =   4815
         Width           =   285
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   8
         Left            =   -66510
         TabIndex        =   400
         Top             =   4395
         Width           =   285
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   7
         Left            =   -66510
         TabIndex        =   395
         Top             =   4035
         Width           =   285
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   6
         Left            =   -66510
         TabIndex        =   390
         Top             =   3615
         Width           =   285
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   5
         Left            =   -66510
         TabIndex        =   385
         Top             =   3225
         Width           =   285
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   4
         Left            =   -66510
         TabIndex        =   380
         Top             =   2865
         Width           =   285
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   3
         Left            =   -66510
         TabIndex        =   375
         Top             =   2505
         Width           =   285
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   2
         Left            =   -66510
         TabIndex        =   370
         Top             =   2085
         Width           =   285
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   1
         Left            =   -66510
         TabIndex        =   365
         Top             =   1635
         Width           =   285
      End
      Begin VB.CheckBox ChkAddress 
         Height          =   480
         Index           =   0
         Left            =   -66510
         TabIndex        =   360
         Top             =   1275
         Width           =   285
      End
      Begin VB.CommandButton cmdInventor 
         Caption         =   "選取既有發明人資料"
         Height          =   315
         Left            =   -74670
         TabIndex        =   355
         Top             =   825
         Width           =   1845
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   9
         Left            =   -73320
         TabIndex        =   402
         Top             =   4875
         Width           =   1575
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   9
         Left            =   -71700
         TabIndex        =   403
         Top             =   4875
         Width           =   1335
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   8
         Left            =   -73320
         TabIndex        =   397
         Top             =   4485
         Width           =   1575
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   8
         Left            =   -71700
         TabIndex        =   398
         Top             =   4485
         Width           =   1335
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   7
         Left            =   -73320
         TabIndex        =   392
         Top             =   4095
         Width           =   1575
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   7
         Left            =   -71700
         TabIndex        =   393
         Top             =   4095
         Width           =   1335
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   6
         Left            =   -73320
         TabIndex        =   387
         Top             =   3705
         Width           =   1575
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   6
         Left            =   -71700
         TabIndex        =   388
         Top             =   3705
         Width           =   1335
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   5
         Left            =   -73320
         TabIndex        =   382
         Top             =   3315
         Width           =   1575
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   5
         Left            =   -71700
         TabIndex        =   383
         Top             =   3315
         Width           =   1335
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   4
         Left            =   -73320
         TabIndex        =   377
         Top             =   2925
         Width           =   1575
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   4
         Left            =   -71700
         TabIndex        =   378
         Top             =   2925
         Width           =   1335
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   3
         Left            =   -73320
         TabIndex        =   372
         Top             =   2535
         Width           =   1575
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   3
         Left            =   -71700
         TabIndex        =   373
         Top             =   2535
         Width           =   1335
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   2
         Left            =   -73320
         TabIndex        =   367
         Top             =   2145
         Width           =   1575
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   2
         Left            =   -71700
         TabIndex        =   368
         Top             =   2145
         Width           =   1335
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   1
         Left            =   -73320
         TabIndex        =   362
         Top             =   1755
         Width           =   1575
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   1
         Left            =   -71700
         TabIndex        =   363
         Top             =   1755
         Width           =   1335
      End
      Begin VB.ComboBox Combo3 
         Height          =   260
         Index           =   0
         Left            =   -73320
         TabIndex        =   357
         Top             =   1370
         Width           =   1580
      End
      Begin VB.TextBox Text3 
         Height          =   315
         Index           =   0
         Left            =   -71700
         TabIndex        =   358
         Top             =   1365
         Width           =   1335
      End
      Begin VB.Frame Frame56 
         BackColor       =   &H00C0C0FF&
         Caption         =   "Frame49"
         Height          =   465
         Left            =   -70815
         TabIndex        =   342
         Top             =   390
         Visible         =   0   'False
         Width           =   4605
         Begin VB.CommandButton cmd146 
            Caption         =   "應收帳款查詢"
            CausesValidation=   0   'False
            Height          =   360
            Left            =   60
            TabIndex        =   594
            Top             =   30
            Width           =   1245
         End
         Begin VB.CommandButton cmdQueryNext 
            Caption         =   "下一筆(&N)"
            Height          =   360
            Left            =   3540
            TabIndex        =   597
            Top             =   30
            Width           =   1005
         End
         Begin VB.CommandButton cmdBack 
            Caption         =   "退回(&B)"
            CausesValidation=   0   'False
            Height          =   360
            Left            =   2580
            TabIndex        =   596
            Top             =   30
            Width           =   915
         End
         Begin VB.CommandButton cmdAgree 
            Caption         =   "同意(&O)"
            CausesValidation=   0   'False
            Height          =   360
            Left            =   1620
            TabIndex        =   595
            Top             =   30
            Width           =   915
         End
      End
      Begin VB.TextBox txtF0309 
         BackColor       =   &H8000000F&
         BorderStyle     =   0  '沒有框線
         ForeColor       =   &H000000C0&
         Height          =   240
         Left            =   -73605
         Locked          =   -1  'True
         TabIndex        =   341
         Text            =   "txtF0309"
         Top             =   840
         Width           =   1845
      End
      Begin VB.TextBox txtF0310 
         BackColor       =   &H8000000F&
         BorderStyle     =   0  '沒有框線
         BeginProperty Font 
            Name            =   "新細明體-ExtB"
            Size            =   9
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000012&
         Height          =   255
         Left            =   -73995
         Locked          =   -1  'True
         TabIndex        =   340
         Text            =   "txtF0310"
         Top             =   540
         Width           =   645
      End
      Begin VB.Frame Frame57 
         Appearance      =   0  '平面
         Caption         =   "Frame57"
         ForeColor       =   &H80000008&
         Height          =   1425
         Left            =   -69765
         TabIndex        =   335
         Top             =   840
         Visible         =   0   'False
         Width           =   3555
         Begin MSForms.TextBox Text1 
            Height          =   630
            Index           =   136
            Left            =   60
            TabIndex        =   673
            Top             =   750
            Width           =   3435
            VariousPropertyBits=   -1476376557
            ForeColor       =   16512
            MaxLength       =   12
            ScrollBars      =   2
            Size            =   "6059;1111"
            Value           =   "計件值(2)"
            SpecialEffect   =   0
            FontName        =   "新細明體-ExtB"
            FontEffects     =   1073741825
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
            FontWeight      =   700
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   134
            Left            =   1500
            TabIndex        =   339
            Top             =   150
            Width           =   1965
            VariousPropertyBits=   671107103
            MaxLength       =   12
            Size            =   "3466;529"
            Value           =   "CRL67"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin VB.Label Label1 
            Caption         =   "一案兩請："
            Height          =   255
            Index           =   134
            Left            =   60
            TabIndex        =   338
            Top             =   210
            Width           =   1005
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   135
            Left            =   1500
            TabIndex        =   337
            Top             =   450
            Width           =   1965
            VariousPropertyBits=   671107103
            MaxLength       =   12
            Size            =   "3466;529"
            Value           =   "CRL68"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin VB.Label Label1 
            Caption         =   "擬制喪失新穎性："
            Height          =   255
            Index           =   135
            Left            =   60
            TabIndex        =   336
            Top             =   510
            Width           =   1485
         End
      End
      Begin VB.Frame Frame33 
         Height          =   5565
         Index           =   0
         Left            =   -74940
         TabIndex        =   98
         Top             =   330
         Width           =   8805
         Begin VB.Frame Frame33 
            BackColor       =   &H00FFFFC0&
            BorderStyle     =   0  '沒有框線
            Height          =   804
            Index           =   1
            Left            =   72
            TabIndex        =   701
            Top             =   4800
            Width           =   3492
            Begin VB.CheckBox Check7 
               Caption         =   "否"
               ForeColor       =   &H00FF0000&
               Height          =   225
               Index           =   3
               Left            =   1800
               TabIndex        =   703
               Top             =   576
               Width           =   495
            End
            Begin VB.CheckBox Check7 
               Caption         =   "是"
               ForeColor       =   &H00FF0000&
               Height          =   225
               Index           =   2
               Left            =   840
               TabIndex        =   702
               Top             =   576
               Width           =   495
            End
            Begin MSForms.OptionButton optDB 
               Height          =   300
               Index           =   1
               Left            =   96
               TabIndex        =   705
               Top             =   288
               Width           =   3360
               BackColor       =   -2147483633
               ForeColor       =   -2147483630
               DisplayStyle    =   5
               Size            =   "5927;529"
               Value           =   "0"
               Caption         =   "待通知後開立，是否要加印國內收據：　　　"
               FontName        =   "新細明體"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.OptionButton optDB 
               Height          =   228
               Index           =   0
               Left            =   96
               TabIndex        =   704
               Top             =   48
               Width           =   2532
               BackColor       =   -2147483633
               ForeColor       =   -2147483630
               DisplayStyle    =   5
               Size            =   "4466;402"
               Value           =   "0"
               Caption         =   "立即開立DEBIT NOTE"
               FontName        =   "新細明體"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
         End
         Begin VB.CommandButton cmdCRL119 
            BackColor       =   &H00C0C0C0&
            Caption         =   "特殊收據"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   9
               Charset         =   136
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   6450
            Style           =   1  '圖片外觀
            TabIndex        =   48
            Top             =   5280
            Visible         =   0   'False
            Width           =   1005
         End
         Begin VB.CommandButton cmdAddAtt 
            BackColor       =   &H00C0C0C0&
            Caption         =   "文件匯入"
            CausesValidation=   0   'False
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   10.2
               Charset         =   136
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   405
            Left            =   7560
            Style           =   1  '圖片外觀
            TabIndex        =   25
            Top             =   630
            Width           =   1275
         End
         Begin VB.Frame FrameCRC 
            BackColor       =   &H00C0FFFF&
            Caption         =   "案件性質編輯區"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   9
               Charset         =   136
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000040C0&
            Height          =   2175
            Left            =   30
            TabIndex        =   243
            Top             =   2280
            Width           =   7035
            Begin VB.CheckBox chkEnglish 
               BackColor       =   &H00C0FFFF&
               Caption         =   "同時申請三國(含)以上之美日德"
               ForeColor       =   &H00FF0000&
               Height          =   255
               Left            =   4140
               TabIndex        =   688
               Top             =   120
               Visible         =   0   'False
               Width           =   2800
            End
            Begin VB.CommandButton cmdUpd 
               BackColor       =   &H0080FF80&
               Caption         =   "加入"
               Height          =   320
               Left            =   2190
               Style           =   1  '圖片外觀
               TabIndex        =   22
               Top             =   30
               Width           =   525
            End
            Begin VB.CommandButton cmdDel 
               BackColor       =   &H0080FF80&
               Caption         =   "刪除"
               Height          =   320
               Left            =   2790
               Style           =   1  '圖片外觀
               TabIndex        =   23
               Top             =   30
               Width           =   525
            End
            Begin VB.CommandButton cmdClear2 
               BackColor       =   &H0080FF80&
               Caption         =   "清除"
               Height          =   320
               Left            =   3390
               Style           =   1  '圖片外觀
               TabIndex        =   24
               Top             =   30
               Width           =   525
            End
            Begin VB.ComboBox Combo1 
               Height          =   260
               Index           =   1
               Left            =   240
               TabIndex        =   17
               Top             =   540
               Width           =   2145
            End
            Begin MSHierarchicalFlexGridLib.MSHFlexGrid GridCase 
               Height          =   1275
               Left            =   60
               TabIndex        =   38
               Top             =   840
               Width           =   6915
               _ExtentX        =   12192
               _ExtentY        =   2265
               _Version        =   393216
               Cols            =   6
               FixedCols       =   0
               FormatString    =   "順序|案件性質|費用|規費|點數|備註"
               _NumberOfBands  =   1
               _Band(0).Cols   =   6
            End
            Begin MSForms.ComboBox Combo2 
               Height          =   300
               Index           =   0
               Left            =   5460
               TabIndex        =   21
               Top             =   540
               Width           =   1515
               VariousPropertyBits=   679495707
               DisplayStyle    =   3
               Size            =   "2672;529"
               MatchEntry      =   1
               ShowDropButtonWhen=   2
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   101
               Left            =   2370
               TabIndex        =   18
               Top             =   540
               Width           =   1125
               VariousPropertyBits=   671107099
               Size            =   "1984;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   103
               Left            =   4560
               TabIndex        =   20
               Top             =   540
               Width           =   915
               VariousPropertyBits=   671107099
               Size            =   "1614;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   102
               Left            =   3510
               TabIndex        =   19
               Top             =   540
               Width           =   1065
               VariousPropertyBits=   671107099
               Size            =   "1879;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label LblCnt 
               BackColor       =   &H00C0FFFF&
               Caption         =   "1"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   9
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H000000FF&
               Height          =   255
               Left            =   30
               TabIndex        =   250
               Top             =   570
               Width           =   225
            End
            Begin VB.Label Label1 
               BackColor       =   &H00C0FFFF&
               Caption         =   "備註："
               Height          =   225
               Index           =   4
               Left            =   5520
               TabIndex        =   248
               Top             =   360
               Width           =   555
            End
            Begin VB.Label Label1 
               BackColor       =   &H00C0FFFF&
               Caption         =   "點數："
               Height          =   225
               Index           =   101
               Left            =   4650
               TabIndex        =   247
               Top             =   360
               Width           =   765
            End
            Begin VB.Label Label1 
               BackColor       =   &H00C0FFFF&
               Caption         =   "規費："
               Height          =   225
               Index           =   100
               Left            =   3540
               TabIndex        =   246
               Top             =   360
               Width           =   765
            End
            Begin VB.Label Label1 
               BackColor       =   &H00C0FFFF&
               Caption         =   "費用："
               Height          =   225
               Index           =   99
               Left            =   2400
               TabIndex        =   245
               Top             =   360
               Width           =   765
            End
            Begin VB.Label Label1 
               BackColor       =   &H00C0FFFF&
               Caption         =   "案件性質："
               Height          =   225
               Index           =   10
               Left            =   270
               TabIndex        =   244
               Top             =   360
               Width           =   1005
            End
         End
         Begin VB.CheckBox Check1 
            Caption         =   "請貼印花"
            Height          =   285
            Left            =   6240
            TabIndex        =   45
            Top             =   4770
            Width           =   1065
         End
         Begin VB.Frame Frame14 
            Height          =   285
            Left            =   2820
            TabIndex        =   219
            Top             =   360
            Width           =   2835
            Begin VB.OptionButton OptChoose 
               Caption         =   "外至台"
               Height          =   315
               Index           =   1
               Left            =   1935
               TabIndex        =   4
               Top             =   0
               Width           =   855
            End
            Begin VB.OptionButton OptChoose 
               Caption         =   "國內"
               Height          =   315
               Index           =   0
               Left            =   1200
               TabIndex        =   3
               Top             =   0
               Value           =   -1  'True
               Width           =   705
            End
            Begin VB.Label Label1 
               Caption         =   "接洽單種類："
               Height          =   255
               Index           =   120
               Left            =   0
               TabIndex        =   220
               Top             =   60
               Width           =   1185
            End
         End
         Begin VB.Frame Frame1 
            Height          =   315
            Left            =   3960
            TabIndex        =   189
            Top             =   630
            Width           =   1545
            Begin VB.OptionButton Option1 
               Caption         =   "舊案"
               Height          =   315
               Index           =   1
               Left            =   810
               TabIndex        =   7
               Top             =   30
               Width           =   705
            End
            Begin VB.OptionButton Option1 
               Caption         =   "新案"
               Height          =   315
               Index           =   0
               Left            =   60
               TabIndex        =   6
               Top             =   30
               Value           =   -1  'True
               Width           =   705
            End
         End
         Begin VB.ComboBox Combo1 
            Height          =   260
            Index           =   0
            Left            =   1050
            TabIndex        =   13
            Top             =   1380
            Width           =   2625
         End
         Begin VB.CheckBox Check7 
            Caption         =   "是"
            ForeColor       =   &H00FF0000&
            Height          =   225
            Index           =   0
            Left            =   7680
            TabIndex        =   32
            Top             =   2550
            Width           =   495
         End
         Begin VB.CheckBox Check7 
            Caption         =   "否"
            ForeColor       =   &H00FF0000&
            Height          =   225
            Index           =   1
            Left            =   8220
            TabIndex        =   33
            Top             =   2550
            Width           =   495
         End
         Begin VB.CommandButton cmdOK 
            Caption         =   "期限資料(&L)"
            CausesValidation=   0   'False
            Enabled         =   0   'False
            Height          =   285
            Index           =   3
            Left            =   5220
            TabIndex        =   26
            Top             =   1028
            Width           =   1215
         End
         Begin VB.CheckBox Check2 
            Caption         =   "收據暫不列印"
            Height          =   285
            Left            =   6240
            TabIndex        =   46
            Top             =   5010
            Width           =   1395
         End
         Begin VB.ComboBox Combo4 
            Height          =   260
            ItemData        =   "frm090801_New.frx":00E0
            Left            =   5070
            List            =   "frm090801_New.frx":00ED
            Style           =   2  '單純下拉式
            TabIndex        =   44
            Top             =   5100
            Width           =   1125
         End
         Begin VB.TextBox txtPrintType 
            Height          =   270
            Left            =   3240
            MaxLength       =   1
            TabIndex        =   159
            Text            =   "2"
            Top             =   1110
            Visible         =   0   'False
            Width           =   240
         End
         Begin VB.ComboBox Combo5 
            Height          =   260
            ItemData        =   "frm090801_New.frx":0107
            Left            =   7380
            List            =   "frm090801_New.frx":0114
            TabIndex        =   15
            Top             =   1380
            Visible         =   0   'False
            Width           =   1365
         End
         Begin VB.CheckBox ChkPCT 
            Caption         =   "是否PCT案"
            Height          =   180
            Left            =   4050
            TabIndex        =   158
            Top             =   960
            Width           =   1155
         End
         Begin VB.ComboBox Combo6 
            Height          =   260
            ItemData        =   "frm090801_New.frx":0138
            Left            =   4890
            List            =   "frm090801_New.frx":013A
            TabIndex        =   14
            Top             =   1380
            Visible         =   0   'False
            Width           =   1365
         End
         Begin VB.Frame Frame26 
            Height          =   1065
            Left            =   7035
            TabIndex        =   128
            Top             =   3180
            Width           =   1635
            Begin VB.CheckBox Check8 
               Caption         =   "送件日"
               Height          =   255
               Index           =   0
               Left            =   60
               TabIndex        =   35
               Top             =   210
               Width           =   1395
            End
            Begin VB.CheckBox Check8 
               Caption         =   "代理人請款日"
               Height          =   225
               Index           =   1
               Left            =   60
               TabIndex        =   36
               Top             =   450
               Width           =   1395
            End
            Begin VB.CheckBox Check8 
               Caption         =   "代理人請款之匯款日"
               Height          =   375
               Index           =   2
               Left            =   60
               TabIndex        =   37
               Top             =   660
               Width           =   1395
            End
            Begin VB.Label Label1 
               Caption         =   "收據自動列印時間點"
               Height          =   255
               Index           =   103
               Left            =   60
               TabIndex        =   157
               Top             =   30
               Width           =   1635
            End
         End
         Begin VB.Frame Frame28 
            Height          =   285
            Left            =   30
            TabIndex        =   127
            Top             =   1680
            Width           =   4425
            Begin VB.OptionButton OptEntity 
               Caption         =   "法人"
               Height          =   315
               Index           =   0
               Left            =   30
               TabIndex        =   27
               TabStop         =   0   'False
               Top             =   0
               Width           =   1080
            End
            Begin VB.OptionButton OptEntity 
               Caption         =   "法人小個體"
               Height          =   315
               Index           =   1
               Left            =   1110
               TabIndex        =   28
               TabStop         =   0   'False
               Top             =   0
               Width           =   1380
            End
            Begin VB.OptionButton OptEntity 
               Caption         =   "個人/新創公司"
               Height          =   315
               Index           =   2
               Left            =   2535
               TabIndex        =   29
               TabStop         =   0   'False
               Top             =   0
               Width           =   1845
            End
         End
         Begin VB.CheckBox Check4 
            Caption         =   "電子送件"
            Height          =   180
            Left            =   7695
            TabIndex        =   31
            Top             =   1740
            Visible         =   0   'False
            Width           =   1065
         End
         Begin VB.CheckBox Check5 
            Caption         =   "附英文摘要"
            Height          =   180
            Left            =   6420
            TabIndex        =   30
            Top             =   1740
            Visible         =   0   'False
            Width           =   1245
         End
         Begin VB.CheckBox Check9 
            Caption         =   "特殊收據"
            ForeColor       =   &H000000C0&
            Height          =   255
            Left            =   6240
            TabIndex        =   47
            Top             =   5280
            Width           =   1155
         End
         Begin VB.Frame Frame2 
            Height          =   450
            Left            =   990
            TabIndex        =   218
            Top             =   4335
            Width           =   4755
            Begin VB.OptionButton Option2 
               Caption         =   "以 DEBIT NOTE 請款"
               Height          =   255
               Index           =   2
               Left            =   1140
               TabIndex        =   40
               Top             =   150
               Width           =   1935
            End
            Begin VB.OptionButton Option2 
               Caption         =   "其他(請寫全銜)"
               Height          =   255
               Index           =   1
               Left            =   3180
               TabIndex        =   41
               Top             =   150
               Width           =   1545
            End
            Begin VB.OptionButton Option2 
               Caption         =   "同申請人"
               Height          =   255
               Index           =   0
               Left            =   60
               TabIndex        =   39
               Top             =   150
               Width           =   1215
            End
         End
         Begin VB.Frame Frame605 
            Caption         =   "Frame605"
            Height          =   290
            Left            =   4140
            TabIndex        =   637
            Top             =   1650
            Width           =   2265
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   143
               Left            =   1860
               TabIndex        =   640
               Top             =   0
               Width           =   375
               VariousPropertyBits=   671107097
               MaxLength       =   2
               Size            =   "661;529"
               FontName        =   "新細明體-ExtB"
               FontEffects     =   1073750016
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   142
               Left            =   1320
               TabIndex        =   639
               Top             =   0
               Width           =   375
               VariousPropertyBits=   671107097
               MaxLength       =   2
               Size            =   "661;529"
               FontName        =   "新細明體-ExtB"
               FontEffects     =   1073750016
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label labelYF 
               AutoSize        =   -1  'True
               Caption         =   "繳費年度：          ~"
               ForeColor       =   &H000000FF&
               Height          =   180
               Left            =   390
               TabIndex        =   638
               Top             =   60
               Width           =   1440
            End
         End
         Begin VB.Label Label38 
            Caption         =   "(有文件)"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000FF&
            Height          =   240
            Left            =   7680
            TabIndex        =   687
            Top             =   720
            Width           =   1035
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   145
            Left            =   4572
            TabIndex        =   43
            Top             =   4776
            Width           =   348
            VariousPropertyBits=   671107099
            MaxLength       =   1
            Size            =   "609;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin VB.Label Label28 
            Caption         =   "(1.電子 2.紙本)"
            Height          =   312
            Index           =   1
            Left            =   4968
            TabIndex        =   683
            Top             =   4836
            Width           =   1212
         End
         Begin VB.Label Label1 
            Caption         =   "證書形式："
            Height          =   288
            Index           =   141
            Left            =   3648
            TabIndex        =   682
            Top             =   4836
            Width           =   948
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   11
            Left            =   1050
            TabIndex        =   16
            Top             =   1950
            Width           =   7545
            VariousPropertyBits=   671107099
            MaxLength       =   160
            Size            =   "13309;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "對造為本所客戶："
            ForeColor       =   &H00FF0000&
            Height          =   180
            Index           =   86
            Left            =   7110
            TabIndex        =   226
            Top             =   2295
            Width           =   1440
         End
         Begin MSForms.ComboBox cboTitle 
            Height          =   300
            Left            =   5760
            TabIndex        =   42
            Top             =   4440
            Width           =   2745
            VariousPropertyBits=   679495707
            DisplayStyle    =   3
            Size            =   "4842;529"
            MatchEntry      =   1
            ShowDropButtonWhen=   2
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   6
            Left            =   5520
            TabIndex        =   8
            Top             =   690
            Width           =   465
            VariousPropertyBits=   675301403
            MaxLength       =   3
            Size            =   "820;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   0
            Left            =   1050
            TabIndex        =   0
            Top             =   0
            Width           =   615
            VariousPropertyBits=   671107097
            MaxLength       =   3
            Size            =   "1085;529"
            FontName        =   "新細明體-ExtB"
            FontEffects     =   1073750016
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   1
            Left            =   1050
            TabIndex        =   1
            Top             =   330
            Width           =   1125
            VariousPropertyBits=   671107099
            MaxLength       =   7
            Size            =   "1984;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   3
            Left            =   1056
            TabIndex        =   2
            Top             =   696
            Width           =   1128
            VariousPropertyBits=   671107099
            MaxLength       =   7
            Size            =   "1984;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   7
            Left            =   6060
            TabIndex        =   9
            Top             =   690
            Width           =   765
            VariousPropertyBits=   675301401
            MaxLength       =   6
            Size            =   "1349;529"
            FontName        =   "新細明體-ExtB"
            FontEffects     =   1073750016
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   8
            Left            =   6900
            TabIndex        =   10
            Top             =   690
            Width           =   225
            VariousPropertyBits=   675301401
            MaxLength       =   1
            Size            =   "397;529"
            FontName        =   "新細明體-ExtB"
            FontEffects     =   1073750016
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   9
            Left            =   7230
            TabIndex        =   11
            Top             =   690
            Width           =   345
            VariousPropertyBits=   675301401
            MaxLength       =   2
            Size            =   "609;529"
            FontName        =   "新細明體-ExtB"
            FontEffects     =   1073750016
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   10
            Left            =   6810
            TabIndex        =   5
            Top             =   330
            Width           =   705
            VariousPropertyBits=   671107099
            MaxLength       =   6
            Size            =   "1244;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   113
            Left            =   7590
            TabIndex        =   34
            Top             =   2820
            Width           =   1140
            VariousPropertyBits=   671107099
            Size            =   "2011;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   18
            Left            =   7380
            TabIndex        =   12
            Top             =   1050
            Width           =   1430
            VariousPropertyBits=   671107099
            MaxLength       =   50
            Size            =   "2522;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin MSForms.TextBox Text1 
            Height          =   300
            Index           =   115
            Left            =   5805
            TabIndex        =   188
            Top             =   4455
            Visible         =   0   'False
            Width           =   1590
            VariousPropertyBits=   671107099
            Size            =   "2805;529"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin VB.Label Label1 
            Caption         =   "區　　別："
            Height          =   255
            Index           =   0
            Left            =   120
            TabIndex        =   241
            Top             =   45
            Width           =   1005
         End
         Begin VB.Label Label1 
            Caption         =   "法定期限："
            Height          =   255
            Index           =   1
            Left            =   120
            TabIndex        =   240
            Top             =   390
            Width           =   1005
         End
         Begin VB.Label Label1 
            Caption         =   "本所期限："
            Height          =   252
            Index           =   3
            Left            =   120
            TabIndex        =   239
            Top             =   732
            Width           =   1008
         End
         Begin VB.Label Label1 
            Caption         =   "申  請  國："
            Height          =   255
            Index           =   9
            Left            =   120
            TabIndex        =   238
            Top             =   1410
            Width           =   1005
         End
         Begin VB.Label Label1 
            Caption         =   "主　　題："
            Height          =   255
            Index           =   11
            Left            =   120
            TabIndex        =   237
            Top             =   1980
            Width           =   1005
         End
         Begin VB.Label lblZone 
            BackColor       =   &H00FFFFFF&
            Height          =   255
            Left            =   1710
            TabIndex        =   236
            Top             =   30
            Width           =   1005
         End
         Begin VB.Label Label1 
            Caption         =   "本所案號："
            Height          =   255
            Index           =   6
            Left            =   3000
            TabIndex        =   235
            Top             =   720
            Width           =   1005
         End
         Begin VB.Line Line1 
            X1              =   5820
            X2              =   7530
            Y1              =   840
            Y2              =   840
         End
         Begin VB.Label Label1 
            Caption         =   "填表日期："
            Height          =   255
            Index           =   7
            Left            =   5760
            TabIndex        =   234
            Top             =   30
            Width           =   1005
         End
         Begin VB.Label lblDate 
            BackColor       =   &H00FFFFFF&
            Height          =   255
            Left            =   6810
            TabIndex        =   233
            Top             =   0
            Width           =   1725
         End
         Begin VB.Label Label1 
            Caption         =   "員工代號："
            Height          =   255
            Index           =   8
            Left            =   5760
            TabIndex        =   232
            Top             =   390
            Width           =   1005
         End
         Begin MSForms.Label lblStaffName 
            Height          =   255
            Left            =   7560
            TabIndex        =   231
            Top             =   360
            Width           =   1155
            BackColor       =   16777215
            VariousPropertyBits=   27
            Size            =   "2037;450"
            FontName        =   "新細明體-ExtB"
            FontHeight      =   180
            FontCharSet     =   136
            FontPitchAndFamily=   34
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "後金："
            Height          =   180
            Index           =   102
            Left            =   7065
            TabIndex        =   230
            Top             =   2880
            Width           =   540
         End
         Begin VB.Label Label1 
            Caption         =   "收據抬頭："
            Height          =   285
            Index           =   104
            Left            =   90
            TabIndex        =   229
            Top             =   4500
            Width           =   1005
         End
         Begin VB.Label Label1 
            Caption         =   "客戶案號(型號)："
            Height          =   360
            Index           =   16
            Left            =   6570
            TabIndex        =   228
            Top             =   1020
            Width           =   720
         End
         Begin VB.Label Label2 
            Caption         =   "按此鈕可列出此客戶↑所有收據抬頭"
            ForeColor       =   &H000000FF&
            Height          =   645
            Index           =   2
            Left            =   7650
            TabIndex        =   227
            Top             =   4800
            Width           =   1080
         End
         Begin VB.Label Label1 
            Caption         =   "收據公司："
            Height          =   285
            Index           =   90
            Left            =   4170
            TabIndex        =   225
            Top             =   5160
            Width           =   915
         End
         Begin VB.Label Label1 
            Caption         =   "輸出方式： 　   ( 1.螢幕 2.印表機 )"
            Height          =   180
            Index           =   122
            Left            =   2250
            TabIndex        =   224
            Top             =   1170
            Visible         =   0   'False
            Width           =   2745
         End
         Begin VB.Label Label1 
            Caption         =   "案件屬性:"
            Height          =   180
            Index           =   168
            Left            =   6570
            TabIndex        =   223
            Top             =   1410
            Visible         =   0   'False
            Width           =   765
         End
         Begin VB.Label Label1 
            Caption         =   "請先點選接洽單種類"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000C0&
            Height          =   255
            Index           =   123
            Left            =   3060
            TabIndex        =   222
            Top             =   30
            Width           =   2415
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "商標種類:"
            Height          =   180
            Index           =   124
            Left            =   4080
            TabIndex        =   221
            Top             =   1410
            Visible         =   0   'False
            Width           =   770
         End
      End
      Begin TabDlg.SSTab SSTab2 
         Height          =   5505
         Left            =   150
         TabIndex        =   55
         Top             =   375
         Width           =   8625
         _ExtentX        =   15219
         _ExtentY        =   9694
         _Version        =   393216
         Tabs            =   5
         TabsPerRow      =   5
         TabHeight       =   520
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "新細明體"
            Size            =   9
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         TabCaption(0)   =   "申請人1"
         TabPicture(0)   =   "frm090801_New.frx":013C
         Tab(0).ControlEnabled=   -1  'True
         Tab(0).Control(0)=   "Frame36"
         Tab(0).Control(0).Enabled=   0   'False
         Tab(0).Control(1)=   "FrameCase"
         Tab(0).Control(1).Enabled=   0   'False
         Tab(0).ControlCount=   2
         TabCaption(1)   =   "申請人2"
         TabPicture(1)   =   "frm090801_New.frx":0158
         Tab(1).ControlEnabled=   0   'False
         Tab(1).Control(0)=   "Frame37"
         Tab(1).ControlCount=   1
         TabCaption(2)   =   "申請人3"
         TabPicture(2)   =   "frm090801_New.frx":0174
         Tab(2).ControlEnabled=   0   'False
         Tab(2).Control(0)=   "Frame38"
         Tab(2).ControlCount=   1
         TabCaption(3)   =   "申請人4"
         TabPicture(3)   =   "frm090801_New.frx":0190
         Tab(3).ControlEnabled=   0   'False
         Tab(3).Control(0)=   "Frame39"
         Tab(3).ControlCount=   1
         TabCaption(4)   =   "申請人5"
         TabPicture(4)   =   "frm090801_New.frx":01AC
         Tab(4).ControlEnabled=   0   'False
         Tab(4).Control(0)=   "Frame40"
         Tab(4).ControlCount=   1
         Begin VB.Frame FrameCase 
            BackColor       =   &H00FFC0C0&
            Caption         =   "編輯 本案與總號"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   9
               Charset         =   136
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00C00000&
            Height          =   1485
            Left            =   1920
            TabIndex        =   661
            Top             =   4110
            Visible         =   0   'False
            Width           =   4275
            Begin VB.CommandButton cmdRemove 
               Caption         =   "移除"
               Height          =   315
               Left            =   2490
               TabIndex        =   668
               Top             =   960
               Width           =   705
            End
            Begin VB.CommandButton cmdAdd 
               Caption         =   "加入"
               Height          =   315
               Left            =   2490
               TabIndex        =   667
               Top             =   600
               Width           =   705
            End
            Begin VB.ListBox lstCase 
               Height          =   228
               ItemData        =   "frm090801_New.frx":01C8
               Left            =   480
               List            =   "frm090801_New.frx":01CF
               TabIndex        =   670
               Top             =   600
               Width           =   1905
            End
            Begin VB.TextBox txtSystem 
               Height          =   300
               Left            =   1080
               MaxLength       =   3
               TabIndex        =   662
               Top             =   210
               Width           =   525
            End
            Begin VB.TextBox txtCode 
               Height          =   300
               Index           =   2
               Left            =   3090
               MaxLength       =   2
               TabIndex        =   665
               Top             =   210
               Width           =   492
            End
            Begin VB.TextBox txtCode 
               Height          =   300
               Index           =   1
               Left            =   2670
               MaxLength       =   1
               TabIndex        =   664
               Top             =   210
               Width           =   372
            End
            Begin VB.TextBox txtCode 
               Height          =   300
               Index           =   0
               Left            =   1650
               MaxLength       =   6
               TabIndex        =   663
               Top             =   210
               Width           =   975
            End
            Begin VB.CommandButton cmdCRL55_OK 
               Caption         =   "確定"
               Height          =   315
               Left            =   3360
               TabIndex        =   669
               Top             =   600
               Width           =   825
            End
            Begin VB.Label Label2 
               BackColor       =   &H00FFC0C0&
               Caption         =   "本所案號："
               Height          =   255
               Index           =   1
               Left            =   150
               TabIndex        =   666
               Top             =   240
               Width           =   975
            End
         End
         Begin VB.Frame Frame40 
            Caption         =   "Frame40"
            Height          =   4575
            Left            =   -74940
            TabIndex        =   610
            Top             =   330
            Width           =   8505
            Begin VB.Frame Frame54 
               Height          =   735
               Left            =   -30
               TabIndex        =   614
               Top             =   1650
               Width           =   8535
               Begin MSForms.ComboBox cboContact 
                  Height          =   300
                  Index           =   5
                  Left            =   2940
                  TabIndex        =   194
                  Top             =   90
                  Width           =   1230
                  VariousPropertyBits=   679495707
                  DisplayStyle    =   3
                  Size            =   "2170;529"
                  MatchEntry      =   1
                  ShowDropButtonWhen=   2
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "手機："
                  Height          =   180
                  Index           =   64
                  Left            =   6630
                  TabIndex        =   621
                  Top             =   390
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "傳真："
                  Height          =   180
                  Index           =   67
                  Left            =   6630
                  TabIndex        =   620
                  Top             =   120
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "電話："
                  Height          =   180
                  Index           =   68
                  Left            =   4200
                  TabIndex        =   619
                  Top             =   120
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "接洽人："
                  Height          =   180
                  Index           =   69
                  Left            =   2190
                  TabIndex        =   618
                  Top             =   120
                  Width           =   720
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "客戶編號："
                  Height          =   180
                  Index           =   70
                  Left            =   90
                  TabIndex        =   617
                  Top             =   120
                  Width           =   900
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "ID No.："
                  Height          =   180
                  Index           =   81
                  Left            =   90
                  TabIndex        =   616
                  Top             =   420
                  Width           =   660
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "LINE ID："
                  BeginProperty Font 
                     Name            =   "新細明體"
                     Size            =   8.4
                     Charset         =   136
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   165
                  Index           =   93
                  Left            =   4200
                  TabIndex        =   615
                  Top             =   420
                  Width           =   690
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   84
                  Left            =   7170
                  TabIndex        =   200
                  Top             =   390
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   76
                  Left            =   1020
                  TabIndex        =   193
                  Top             =   90
                  Width           =   1095
                  VariousPropertyBits=   671107099
                  Size            =   "1931;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   78
                  Left            =   4935
                  TabIndex        =   195
                  Top             =   90
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   79
                  Left            =   4935
                  TabIndex        =   199
                  Top             =   390
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   20
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   80
                  Left            =   7170
                  TabIndex        =   196
                  Top             =   90
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   77
                  Left            =   2940
                  TabIndex        =   198
                  Top             =   390
                  Visible         =   0   'False
                  Width           =   1230
                  VariousPropertyBits=   671107099
                  Size            =   "2170;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   96
                  Left            =   1020
                  TabIndex        =   197
                  Top             =   390
                  Width           =   1755
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "3096;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
            End
            Begin VB.Frame Frame4 
               Height          =   405
               Index           =   4
               Left            =   1365
               TabIndex        =   625
               Top             =   2295
               Width           =   1695
               Begin VB.OptionButton optCP815 
                  Caption         =   "是"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   0
                  Left            =   120
                  TabIndex        =   201
                  Top             =   120
                  Width           =   615
               End
               Begin VB.OptionButton optCP815 
                  Caption         =   "否"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   1
                  Left            =   930
                  TabIndex        =   202
                  Top             =   120
                  Width           =   660
               End
            End
            Begin VB.Frame Frame10 
               Height          =   1740
               Left            =   30
               TabIndex        =   622
               Top             =   -60
               Width           =   8430
               Begin VB.Frame Frame30 
                  Caption         =   "特例簽核"
                  ForeColor       =   &H00000000&
                  Height          =   495
                  Index           =   4
                  Left            =   2130
                  TabIndex        =   655
                  Top             =   60
                  Width           =   2085
                  Begin VB.CheckBox ChkCRA26 
                     Caption         =   "有對造"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   4
                     Left            =   90
                     TabIndex        =   657
                     Top             =   180
                     Width           =   885
                  End
                  Begin VB.CheckBox ChkCRA27 
                     Caption         =   "有跨所"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   4
                     Left            =   1080
                     TabIndex        =   656
                     Top             =   180
                     Width           =   975
                  End
               End
               Begin VB.OptionButton Option35 
                  Caption         =   "新客戶"
                  Height          =   285
                  Index           =   0
                  Left            =   990
                  TabIndex        =   190
                  Top             =   240
                  Width           =   1785
               End
               Begin VB.OptionButton Option35 
                  Caption         =   "舊客戶"
                  Height          =   285
                  Index           =   1
                  Left            =   5580
                  TabIndex        =   191
                  Top             =   225
                  Value           =   -1  'True
                  Width           =   975
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   598
                  Left            =   4550
                  TabIndex        =   192
                  Top             =   650
                  Width           =   2780
                  VariousPropertyBits=   671107099
                  Size            =   "4904;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Shape Shape5 
                  Height          =   1515
                  Left            =   60
                  Top             =   180
                  Width           =   8325
               End
               Begin VB.Label Label1 
                  Caption         =   "與                                                          為關係企業"
                  Height          =   260
                  Index           =   109
                  Left            =   4310
                  TabIndex        =   624
                  Top             =   680
                  Width           =   4040
               End
               Begin VB.Line Line18 
                  X1              =   4245
                  X2              =   4245
                  Y1              =   570
                  Y2              =   1680
               End
               Begin VB.Line Line19 
                  X1              =   495
                  X2              =   8355
                  Y1              =   555
                  Y2              =   555
               End
               Begin VB.Line Line20 
                  X1              =   495
                  X2              =   495
                  Y1              =   195
                  Y2              =   1680
               End
               Begin VB.Label Label2 
                  Alignment       =   2  '置中對齊
                  Caption         =   "案件來源說明"
                  Height          =   1110
                  Index           =   6
                  Left            =   135
                  TabIndex        =   623
                  Top             =   465
                  Width           =   315
               End
               Begin VB.Line Line21 
                  X1              =   510
                  X2              =   8370
                  Y1              =   975
                  Y2              =   975
               End
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "申請地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   9
               Left            =   30
               TabIndex        =   613
               TabStop         =   0   'False
               Top             =   3915
               Width           =   980
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "聯絡地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   8
               Left            =   30
               TabIndex        =   612
               TabStop         =   0   'False
               Top             =   3615
               Width           =   980
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   9
               Left            =   7995
               TabIndex        =   216
               Top             =   3915
               Width           =   480
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   8
               Left            =   7995
               TabIndex        =   213
               Top             =   3615
               Width           =   480
            End
            Begin VB.CommandButton cmdSerach 
               Caption         =   "搜尋(&5)"
               Height          =   585
               Index           =   4
               Left            =   4515
               TabIndex        =   208
               Top             =   3015
               Width           =   345
            End
            Begin VB.CommandButton cmdQual 
               Caption         =   "中小企業減免資格"
               Height          =   285
               Index           =   5
               Left            =   1350
               TabIndex        =   203
               Top             =   2715
               Visible         =   0   'False
               Width           =   1725
            End
            Begin VB.CommandButton CmdSame 
               Caption         =   "同上"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   5
               Left            =   1005
               TabIndex        =   611
               Top             =   3915
               Visible         =   0   'False
               Width           =   550
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   189
               Left            =   1005
               TabIndex        =   217
               Top             =   4215
               Width           =   7305
               VariousPropertyBits=   671107099
               MaxLength       =   180
               Size            =   "12885;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   91
               Left            =   1005
               TabIndex        =   214
               Top             =   3915
               Width           =   6285
               VariousPropertyBits=   679495707
               MaxLength       =   80
               Size            =   "11086;529"
               FontName        =   "新細明體"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   90
               Left            =   1005
               TabIndex        =   211
               Top             =   3615
               Width           =   6285
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "11086;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   86
               Left            =   1365
               TabIndex        =   207
               Top             =   3315
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   120
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   85
               Left            =   1365
               TabIndex        =   206
               Top             =   3015
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   83
               Left            =   3945
               TabIndex        =   204
               Top             =   2385
               Width           =   4425
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7805;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   98
               Left            =   3945
               TabIndex        =   205
               Top             =   2685
               Width           =   4425
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7805;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   285
               Index           =   81
               Left            =   6990
               TabIndex        =   636
               Top             =   2460
               Visible         =   0   'False
               Width           =   1335
               VariousPropertyBits=   671107097
               BackColor       =   -2147483648
               MaxLength       =   16
               Size            =   "2355;503"
               FontName        =   "新細明體-ExtB"
               FontEffects     =   1073750016
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "聯絡地址："
               Height          =   255
               Index           =   95
               Left            =   105
               TabIndex        =   635
               Top             =   3630
               Width           =   945
            End
            Begin VB.Label Label1 
               Caption         =   "申請地址："
               Height          =   255
               Index           =   76
               Left            =   105
               TabIndex        =   634
               Top             =   3930
               Width           =   945
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   89
               Left            =   7275
               TabIndex        =   212
               Top             =   3615
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   88
               Left            =   6465
               TabIndex        =   210
               Top             =   3315
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   87
               Left            =   6465
               TabIndex        =   209
               Top             =   3015
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   124
               Left            =   7275
               TabIndex        =   215
               Top             =   3915
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "代表人(中文)"
               Height          =   255
               Index           =   73
               Left            =   4965
               TabIndex        =   633
               Top             =   3045
               Width           =   1455
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   72
               Left            =   105
               TabIndex        =   632
               Top             =   3375
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "申請人(中文)："
               Height          =   255
               Index           =   71
               Left            =   105
               TabIndex        =   631
               Top             =   3045
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "E-Mail："
               Height          =   255
               Index           =   65
               Left            =   3255
               TabIndex        =   630
               Top             =   2415
               Width           =   765
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   74
               Left            =   4965
               TabIndex        =   629
               Top             =   3330
               Width           =   1455
            End
            Begin VB.Label Label1 
               AutoSize        =   -1  'True
               Caption         =   "符合年費減免："
               Height          =   180
               Index           =   66
               Left            =   105
               TabIndex        =   628
               Top             =   2445
               Width           =   1260
            End
            Begin VB.Label Label1 
               Caption         =   "國籍："
               Height          =   255
               Index           =   113
               Left            =   3255
               TabIndex        =   627
               Top             =   2715
               Width           =   705
            End
            Begin VB.Label Label1 
               Caption         =   "英文地址："
               Height          =   255
               Index           =   117
               Left            =   105
               TabIndex        =   626
               Top             =   4245
               Width           =   1305
            End
         End
         Begin VB.Frame Frame39 
            Caption         =   "Frame39"
            Height          =   4575
            Left            =   -74940
            TabIndex        =   577
            Top             =   330
            Width           =   8505
            Begin VB.Frame Frame53 
               Height          =   705
               Left            =   0
               TabIndex        =   581
               Top             =   1650
               Width           =   8535
               Begin MSForms.ComboBox cboContact 
                  Height          =   300
                  Index           =   4
                  Left            =   2970
                  TabIndex        =   164
                  Top             =   60
                  Width           =   1230
                  VariousPropertyBits=   679495707
                  DisplayStyle    =   3
                  Size            =   "2170;529"
                  MatchEntry      =   1
                  ShowDropButtonWhen=   2
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "手機："
                  Height          =   180
                  Index           =   51
                  Left            =   6630
                  TabIndex        =   588
                  Top             =   360
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "傳真："
                  Height          =   180
                  Index           =   54
                  Left            =   6630
                  TabIndex        =   587
                  Top             =   90
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "電話："
                  Height          =   180
                  Index           =   55
                  Left            =   4230
                  TabIndex        =   586
                  Top             =   90
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "接洽人："
                  Height          =   180
                  Index           =   56
                  Left            =   2220
                  TabIndex        =   585
                  Top             =   90
                  Width           =   720
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "客戶編號："
                  Height          =   180
                  Index           =   57
                  Left            =   120
                  TabIndex        =   584
                  Top             =   90
                  Width           =   900
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "ID No.："
                  Height          =   180
                  Index           =   80
                  Left            =   120
                  TabIndex        =   583
                  Top             =   390
                  Width           =   660
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "LINE ID："
                  BeginProperty Font 
                     Name            =   "新細明體"
                     Size            =   8.4
                     Charset         =   136
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   165
                  Index           =   91
                  Left            =   4230
                  TabIndex        =   582
                  Top             =   390
                  Width           =   690
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   68
                  Left            =   7170
                  TabIndex        =   170
                  Top             =   360
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   60
                  Left            =   1050
                  TabIndex        =   163
                  Top             =   60
                  Width           =   1095
                  VariousPropertyBits=   671107099
                  Size            =   "1931;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   62
                  Left            =   4935
                  TabIndex        =   165
                  Top             =   60
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   63
                  Left            =   4935
                  TabIndex        =   169
                  Top             =   360
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   20
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   64
                  Left            =   7170
                  TabIndex        =   166
                  Top             =   60
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   95
                  Left            =   1050
                  TabIndex        =   167
                  Top             =   360
                  Width           =   1755
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "3096;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   61
                  Left            =   2970
                  TabIndex        =   168
                  Top             =   360
                  Visible         =   0   'False
                  Width           =   1230
                  VariousPropertyBits=   671107099
                  Size            =   "2170;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
            End
            Begin VB.Frame Frame4 
               Height          =   405
               Index           =   3
               Left            =   1335
               TabIndex        =   598
               Top             =   2295
               Width           =   1695
               Begin VB.OptionButton optCP814 
                  Caption         =   "是"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   0
                  Left            =   120
                  TabIndex        =   171
                  Top             =   120
                  Width           =   615
               End
               Begin VB.OptionButton optCP814 
                  Caption         =   "否"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   1
                  Left            =   930
                  TabIndex        =   172
                  Top             =   120
                  Width           =   660
               End
            End
            Begin VB.Frame Frame9 
               Height          =   1740
               Left            =   30
               TabIndex        =   589
               Top             =   -60
               Width           =   8430
               Begin VB.Frame Frame30 
                  Caption         =   "特例簽核"
                  ForeColor       =   &H00000000&
                  Height          =   495
                  Index           =   3
                  Left            =   2130
                  TabIndex        =   652
                  Top             =   60
                  Width           =   2085
                  Begin VB.CheckBox ChkCRA27 
                     Caption         =   "有跨所"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   3
                     Left            =   1080
                     TabIndex        =   654
                     Top             =   180
                     Width           =   975
                  End
                  Begin VB.CheckBox ChkCRA26 
                     Caption         =   "有對造"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   3
                     Left            =   90
                     TabIndex        =   653
                     Top             =   180
                     Width           =   885
                  End
               End
               Begin VB.OptionButton Option34 
                  Caption         =   "新客戶"
                  Height          =   285
                  Index           =   0
                  Left            =   990
                  TabIndex        =   160
                  Top             =   240
                  Width           =   1785
               End
               Begin VB.OptionButton Option34 
                  Caption         =   "舊客戶"
                  Height          =   285
                  Index           =   1
                  Left            =   5580
                  TabIndex        =   161
                  Top             =   225
                  Value           =   -1  'True
                  Width           =   975
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   498
                  Left            =   4580
                  TabIndex        =   162
                  Top             =   650
                  Width           =   2780
                  VariousPropertyBits=   671107099
                  Size            =   "4904;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Shape Shape4 
                  Height          =   1515
                  Left            =   60
                  Top             =   180
                  Width           =   8325
               End
               Begin VB.Label Label1 
                  Caption         =   "與                                                          為關係企業"
                  Height          =   260
                  Index           =   108
                  Left            =   4310
                  TabIndex        =   592
                  Top             =   680
                  Width           =   4070
               End
               Begin VB.Line Line14 
                  X1              =   4245
                  X2              =   4245
                  Y1              =   570
                  Y2              =   1680
               End
               Begin VB.Line Line15 
                  X1              =   495
                  X2              =   8355
                  Y1              =   555
                  Y2              =   555
               End
               Begin VB.Line Line16 
                  X1              =   495
                  X2              =   495
                  Y1              =   195
                  Y2              =   1680
               End
               Begin VB.Label Label2 
                  Alignment       =   2  '置中對齊
                  Caption         =   "案件來源說明"
                  Height          =   1110
                  Index           =   5
                  Left            =   135
                  TabIndex        =   590
                  Top             =   465
                  Width           =   315
               End
               Begin VB.Line Line17 
                  X1              =   510
                  X2              =   8370
                  Y1              =   975
                  Y2              =   975
               End
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "申請地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   7
               Left            =   0
               TabIndex        =   580
               TabStop         =   0   'False
               Top             =   3915
               Width           =   980
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "聯絡地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   6
               Left            =   0
               TabIndex        =   579
               TabStop         =   0   'False
               Top             =   3615
               Width           =   980
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   7
               Left            =   7965
               TabIndex        =   186
               Top             =   3915
               Width           =   480
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   6
               Left            =   7965
               TabIndex        =   183
               Top             =   3615
               Width           =   480
            End
            Begin VB.CommandButton cmdSerach 
               Caption         =   "搜尋(&4)"
               Height          =   585
               Index           =   3
               Left            =   4485
               TabIndex        =   178
               Top             =   3015
               Width           =   345
            End
            Begin VB.CommandButton cmdQual 
               Caption         =   "中小企業減免資格"
               Height          =   285
               Index           =   4
               Left            =   1320
               TabIndex        =   173
               Top             =   2715
               Visible         =   0   'False
               Width           =   1725
            End
            Begin VB.CommandButton CmdSame 
               Caption         =   "同上"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   4
               Left            =   975
               TabIndex        =   578
               Top             =   3915
               Visible         =   0   'False
               Width           =   550
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   70
               Left            =   1335
               TabIndex        =   177
               Top             =   3315
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   120
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   69
               Left            =   1335
               TabIndex        =   176
               Top             =   3015
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   74
               Left            =   975
               TabIndex        =   181
               Top             =   3615
               Width           =   6285
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "11086;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   173
               Left            =   975
               TabIndex        =   187
               Top             =   4215
               Width           =   7305
               VariousPropertyBits=   671107099
               MaxLength       =   180
               Size            =   "12885;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   75
               Left            =   975
               TabIndex        =   184
               Top             =   3915
               Width           =   6285
               VariousPropertyBits=   679495707
               MaxLength       =   80
               Size            =   "11086;529"
               FontName        =   "新細明體"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   67
               Left            =   3915
               TabIndex        =   174
               Top             =   2385
               Width           =   4425
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7805;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   82
               Left            =   3915
               TabIndex        =   175
               Top             =   2685
               Width           =   4425
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7805;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   65
               Left            =   6960
               TabIndex        =   609
               Top             =   2400
               Visible         =   0   'False
               Width           =   1335
               VariousPropertyBits=   671107097
               BackColor       =   -2147483648
               MaxLength       =   16
               Size            =   "2355;529"
               FontName        =   "新細明體-ExtB"
               FontEffects     =   1073750016
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "聯絡地址："
               Height          =   255
               Index           =   131
               Left            =   75
               TabIndex        =   608
               Top             =   3660
               Width           =   945
            End
            Begin VB.Label Label1 
               Caption         =   "申請地址："
               Height          =   255
               Index           =   129
               Left            =   75
               TabIndex        =   607
               Top             =   3960
               Width           =   945
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   73
               Left            =   7245
               TabIndex        =   182
               Top             =   3615
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   72
               Left            =   6435
               TabIndex        =   180
               Top             =   3315
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   71
               Left            =   6435
               TabIndex        =   179
               Top             =   3015
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   123
               Left            =   7245
               TabIndex        =   185
               Top             =   3915
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "代表人(中文)"
               Height          =   255
               Index           =   60
               Left            =   4935
               TabIndex        =   606
               Top             =   3045
               Width           =   1455
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   59
               Left            =   75
               TabIndex        =   605
               Top             =   3375
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "申請人(中文)："
               Height          =   255
               Index           =   58
               Left            =   75
               TabIndex        =   604
               Top             =   3045
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "E-Mail："
               Height          =   255
               Index           =   52
               Left            =   3225
               TabIndex        =   603
               Top             =   2415
               Width           =   705
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   61
               Left            =   4935
               TabIndex        =   602
               Top             =   3330
               Width           =   1455
            End
            Begin VB.Label Label1 
               AutoSize        =   -1  'True
               Caption         =   "符合年費減免："
               Height          =   180
               Index           =   53
               Left            =   75
               TabIndex        =   601
               Top             =   2445
               Width           =   1260
            End
            Begin VB.Label Label1 
               Caption         =   "國籍："
               Height          =   255
               Index           =   112
               Left            =   3225
               TabIndex        =   600
               Top             =   2715
               Width           =   705
            End
            Begin VB.Label Label1 
               Caption         =   "英文地址："
               Height          =   255
               Index           =   116
               Left            =   75
               TabIndex        =   599
               Top             =   4245
               Width           =   1305
            End
         End
         Begin VB.Frame Frame38 
            Caption         =   "Frame38"
            Height          =   4575
            Left            =   -74940
            TabIndex        =   550
            Top             =   330
            Width           =   8505
            Begin VB.Frame Frame52 
               Height          =   735
               Left            =   0
               TabIndex        =   551
               Top             =   1650
               Width           =   8535
               Begin MSForms.ComboBox cboContact 
                  Height          =   300
                  Index           =   3
                  Left            =   2940
                  TabIndex        =   133
                  Top             =   90
                  Width           =   1230
                  VariousPropertyBits=   679495707
                  DisplayStyle    =   3
                  Size            =   "2170;529"
                  MatchEntry      =   1
                  ShowDropButtonWhen=   2
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "手機："
                  Height          =   180
                  Index           =   38
                  Left            =   6630
                  TabIndex        =   558
                  Top             =   390
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "傳真："
                  Height          =   180
                  Index           =   41
                  Left            =   6630
                  TabIndex        =   557
                  Top             =   120
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "電話："
                  Height          =   180
                  Index           =   42
                  Left            =   4200
                  TabIndex        =   556
                  Top             =   120
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "接洽人："
                  Height          =   180
                  Index           =   43
                  Left            =   2220
                  TabIndex        =   555
                  Top             =   120
                  Width           =   720
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "客戶編號："
                  Height          =   180
                  Index           =   44
                  Left            =   90
                  TabIndex        =   554
                  Top             =   120
                  Width           =   900
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "ID No.："
                  Height          =   180
                  Index           =   79
                  Left            =   90
                  TabIndex        =   553
                  Top             =   420
                  Width           =   660
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "LINE ID："
                  BeginProperty Font 
                     Name            =   "新細明體"
                     Size            =   8.4
                     Charset         =   136
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   165
                  Index           =   89
                  Left            =   4200
                  TabIndex        =   552
                  Top             =   420
                  Width           =   690
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   52
                  Left            =   7170
                  TabIndex        =   139
                  Top             =   390
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   44
                  Left            =   1020
                  TabIndex        =   132
                  Top             =   90
                  Width           =   1095
                  VariousPropertyBits=   671107099
                  Size            =   "1931;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   46
                  Left            =   4905
                  TabIndex        =   134
                  Top             =   90
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   47
                  Left            =   4905
                  TabIndex        =   138
                  Top             =   390
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   20
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   48
                  Left            =   7170
                  TabIndex        =   135
                  Top             =   90
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   94
                  Left            =   1020
                  TabIndex        =   136
                  Top             =   390
                  Width           =   1755
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "3096;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   45
                  Left            =   2940
                  TabIndex        =   137
                  Top             =   390
                  Visible         =   0   'False
                  Width           =   1230
                  VariousPropertyBits=   671107099
                  Size            =   "2170;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
            End
            Begin VB.Frame Frame8 
               Height          =   1710
               Left            =   30
               TabIndex        =   563
               Top             =   -30
               Width           =   8430
               Begin VB.Frame Frame30 
                  Caption         =   "特例簽核"
                  ForeColor       =   &H00000000&
                  Height          =   495
                  Index           =   2
                  Left            =   2130
                  TabIndex        =   649
                  Top             =   30
                  Width           =   2085
                  Begin VB.CheckBox ChkCRA27 
                     Caption         =   "有跨所"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   2
                     Left            =   1080
                     TabIndex        =   651
                     Top             =   180
                     Width           =   975
                  End
                  Begin VB.CheckBox ChkCRA26 
                     Caption         =   "有對造"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   2
                     Left            =   90
                     TabIndex        =   650
                     Top             =   180
                     Width           =   885
                  End
               End
               Begin VB.OptionButton Option33 
                  Caption         =   "新客戶"
                  Height          =   285
                  Index           =   0
                  Left            =   990
                  TabIndex        =   129
                  Top             =   240
                  Width           =   1785
               End
               Begin VB.OptionButton Option33 
                  Caption         =   "舊客戶"
                  Height          =   285
                  Index           =   1
                  Left            =   5580
                  TabIndex        =   130
                  Top             =   225
                  Value           =   -1  'True
                  Width           =   975
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   398
                  Left            =   4520
                  TabIndex        =   131
                  Top             =   620
                  Width           =   2810
                  VariousPropertyBits=   671107099
                  Size            =   "4957;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Shape Shape3 
                  Height          =   1515
                  Left            =   60
                  Top             =   150
                  Width           =   8325
               End
               Begin VB.Label Label1 
                  Caption         =   "與                                                          為關係企業"
                  Height          =   260
                  Index           =   106
                  Left            =   4310
                  TabIndex        =   565
                  Top             =   650
                  Width           =   4070
               End
               Begin VB.Line Line10 
                  X1              =   4245
                  X2              =   4245
                  Y1              =   540
                  Y2              =   1650
               End
               Begin VB.Line Line11 
                  X1              =   495
                  X2              =   8355
                  Y1              =   525
                  Y2              =   525
               End
               Begin VB.Line Line12 
                  X1              =   495
                  X2              =   495
                  Y1              =   165
                  Y2              =   1650
               End
               Begin VB.Label Label2 
                  Alignment       =   2  '置中對齊
                  Caption         =   "案件來源說明"
                  Height          =   1110
                  Index           =   4
                  Left            =   135
                  TabIndex        =   564
                  Top             =   465
                  Width           =   315
               End
               Begin VB.Line Line13 
                  X1              =   510
                  X2              =   8370
                  Y1              =   945
                  Y2              =   945
               End
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "申請地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   5
               Left            =   30
               TabIndex        =   562
               TabStop         =   0   'False
               Top             =   3915
               Width           =   980
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "聯絡地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   4
               Left            =   30
               TabIndex        =   561
               TabStop         =   0   'False
               Top             =   3615
               Width           =   980
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   5
               Left            =   7995
               TabIndex        =   155
               Top             =   3915
               Width           =   480
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   4
               Left            =   7995
               TabIndex        =   152
               Top             =   3615
               Width           =   480
            End
            Begin VB.CommandButton cmdSerach 
               Caption         =   "搜尋(&3)"
               Height          =   585
               Index           =   2
               Left            =   4515
               TabIndex        =   147
               Top             =   3015
               Width           =   345
            End
            Begin VB.Frame Frame4 
               Height          =   405
               Index           =   2
               Left            =   1365
               TabIndex        =   560
               Top             =   2295
               Width           =   1695
               Begin VB.OptionButton optCP813 
                  Caption         =   "是"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   0
                  Left            =   120
                  TabIndex        =   140
                  Top             =   120
                  Width           =   615
               End
               Begin VB.OptionButton optCP813 
                  Caption         =   "否"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   1
                  Left            =   930
                  TabIndex        =   141
                  Top             =   120
                  Width           =   660
               End
            End
            Begin VB.CommandButton cmdQual 
               Caption         =   "中小企業減免資格"
               Height          =   285
               Index           =   3
               Left            =   1350
               TabIndex        =   142
               Top             =   2715
               Visible         =   0   'False
               Width           =   1725
            End
            Begin VB.CommandButton CmdSame 
               Caption         =   "同上"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   3
               Left            =   1005
               TabIndex        =   559
               Top             =   3915
               Visible         =   0   'False
               Width           =   550
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   157
               Left            =   1005
               TabIndex        =   156
               Top             =   4215
               Width           =   7305
               VariousPropertyBits=   671107099
               MaxLength       =   180
               Size            =   "12885;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "英文地址："
               Height          =   255
               Index           =   115
               Left            =   105
               TabIndex        =   566
               Top             =   4245
               Width           =   1305
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   54
               Left            =   1365
               TabIndex        =   146
               Top             =   3315
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   120
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   53
               Left            =   1365
               TabIndex        =   145
               Top             =   3015
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   58
               Left            =   1005
               TabIndex        =   150
               Top             =   3615
               Width           =   6285
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "11086;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   59
               Left            =   1005
               TabIndex        =   153
               Top             =   3915
               Width           =   6285
               VariousPropertyBits=   679495707
               MaxLength       =   80
               Size            =   "11086;529"
               FontName        =   "新細明體"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   51
               Left            =   3915
               TabIndex        =   143
               Top             =   2385
               Width           =   4455
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7858;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   66
               Left            =   3915
               TabIndex        =   144
               Top             =   2685
               Width           =   4455
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7858;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   49
               Left            =   6960
               TabIndex        =   576
               Top             =   2430
               Visible         =   0   'False
               Width           =   1335
               VariousPropertyBits=   671107097
               BackColor       =   -2147483648
               MaxLength       =   16
               Size            =   "2355;529"
               FontName        =   "新細明體-ExtB"
               FontEffects     =   1073750016
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "聯絡地址："
               Height          =   255
               Index           =   133
               Left            =   105
               TabIndex        =   575
               Top             =   3720
               Width           =   945
            End
            Begin VB.Label Label1 
               Caption         =   "申請地址："
               Height          =   255
               Index           =   132
               Left            =   105
               TabIndex        =   574
               Top             =   4020
               Width           =   945
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   57
               Left            =   7275
               TabIndex        =   151
               Top             =   3615
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   56
               Left            =   6465
               TabIndex        =   149
               Top             =   3315
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   55
               Left            =   6465
               TabIndex        =   148
               Top             =   3015
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   122
               Left            =   7275
               TabIndex        =   154
               Top             =   3915
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "代表人(中文)"
               Height          =   255
               Index           =   47
               Left            =   4965
               TabIndex        =   573
               Top             =   3045
               Width           =   1455
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   46
               Left            =   105
               TabIndex        =   572
               Top             =   3375
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "申請人(中文)："
               Height          =   255
               Index           =   45
               Left            =   105
               TabIndex        =   571
               Top             =   3045
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "E-Mail："
               Height          =   255
               Index           =   39
               Left            =   3255
               TabIndex        =   570
               Top             =   2415
               Width           =   765
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   48
               Left            =   4965
               TabIndex        =   569
               Top             =   3330
               Width           =   1455
            End
            Begin VB.Label Label1 
               AutoSize        =   -1  'True
               Caption         =   "符合年費減免："
               Height          =   180
               Index           =   40
               Left            =   105
               TabIndex        =   568
               Top             =   2445
               Width           =   1260
            End
            Begin VB.Label Label1 
               Caption         =   "國籍："
               Height          =   255
               Index           =   111
               Left            =   3255
               TabIndex        =   567
               Top             =   2715
               Width           =   705
            End
         End
         Begin VB.Frame Frame37 
            Caption         =   "Frame37"
            Height          =   4575
            Left            =   -74940
            TabIndex        =   523
            Top             =   330
            Width           =   8505
            Begin VB.Frame Frame51 
               Height          =   705
               Left            =   30
               TabIndex        =   525
               Top             =   1680
               Width           =   8445
               Begin MSForms.ComboBox cboContact 
                  Height          =   300
                  Index           =   2
                  Left            =   2910
                  TabIndex        =   103
                  Top             =   60
                  Width           =   1230
                  VariousPropertyBits=   679495707
                  DisplayStyle    =   3
                  Size            =   "2170;529"
                  MatchEntry      =   1
                  ShowDropButtonWhen=   2
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "手機："
                  Height          =   180
                  Index           =   25
                  Left            =   6540
                  TabIndex        =   532
                  Top             =   360
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "傳真："
                  Height          =   180
                  Index           =   28
                  Left            =   6540
                  TabIndex        =   531
                  Top             =   90
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "電話："
                  Height          =   180
                  Index           =   29
                  Left            =   4170
                  TabIndex        =   530
                  Top             =   90
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "接洽人："
                  Height          =   180
                  Index           =   30
                  Left            =   2190
                  TabIndex        =   529
                  Top             =   90
                  Width           =   720
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "客戶編號："
                  Height          =   180
                  Index           =   31
                  Left            =   60
                  TabIndex        =   528
                  Top             =   90
                  Width           =   900
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "ID No.："
                  Height          =   180
                  Index           =   78
                  Left            =   60
                  TabIndex        =   527
                  Top             =   390
                  Width           =   660
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "LINE ID："
                  BeginProperty Font 
                     Name            =   "新細明體"
                     Size            =   8.4
                     Charset         =   136
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   165
                  Index           =   87
                  Left            =   4170
                  TabIndex        =   526
                  Top             =   390
                  Width           =   690
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   36
                  Left            =   7080
                  TabIndex        =   109
                  Top             =   360
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   28
                  Left            =   990
                  TabIndex        =   102
                  Top             =   60
                  Width           =   1095
                  VariousPropertyBits=   671107099
                  MaxLength       =   9
                  Size            =   "1931;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   30
                  Left            =   4845
                  TabIndex        =   104
                  Top             =   60
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   31
                  Left            =   4845
                  TabIndex        =   108
                  Top             =   360
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   20
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   32
                  Left            =   7080
                  TabIndex        =   105
                  Top             =   60
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   93
                  Left            =   990
                  TabIndex        =   106
                  Top             =   360
                  Width           =   1755
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "3096;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   29
                  Left            =   2910
                  TabIndex        =   107
                  Top             =   360
                  Visible         =   0   'False
                  Width           =   1230
                  VariousPropertyBits=   671107099
                  Size            =   "2170;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
            End
            Begin VB.Frame Frame6 
               Height          =   1740
               Left            =   30
               TabIndex        =   536
               Top             =   -30
               Width           =   8430
               Begin VB.Frame Frame30 
                  Caption         =   "特例簽核"
                  ForeColor       =   &H00000000&
                  Height          =   495
                  Index           =   1
                  Left            =   2130
                  TabIndex        =   646
                  Top             =   60
                  Width           =   2085
                  Begin VB.CheckBox ChkCRA26 
                     Caption         =   "有對造"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   1
                     Left            =   90
                     TabIndex        =   648
                     Top             =   180
                     Width           =   885
                  End
                  Begin VB.CheckBox ChkCRA27 
                     Caption         =   "有跨所"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   1
                     Left            =   1080
                     TabIndex        =   647
                     Top             =   180
                     Width           =   975
                  End
               End
               Begin VB.OptionButton Option32 
                  Caption         =   "舊客戶"
                  Height          =   285
                  Index           =   1
                  Left            =   5580
                  TabIndex        =   100
                  Top             =   225
                  Value           =   -1  'True
                  Width           =   975
               End
               Begin VB.OptionButton Option32 
                  Caption         =   "新客戶"
                  Height          =   285
                  Index           =   0
                  Left            =   990
                  TabIndex        =   99
                  Top             =   240
                  Width           =   1785
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   298
                  Left            =   4580
                  TabIndex        =   101
                  Top             =   650
                  Width           =   2810
                  VariousPropertyBits=   671107099
                  Size            =   "4957;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Line Line5 
                  X1              =   510
                  X2              =   8370
                  Y1              =   975
                  Y2              =   975
               End
               Begin VB.Label Label2 
                  Alignment       =   2  '置中對齊
                  Caption         =   "案件來源說明"
                  Height          =   1110
                  Index           =   3
                  Left            =   135
                  TabIndex        =   538
                  Top             =   465
                  Width           =   315
               End
               Begin VB.Line Line6 
                  X1              =   495
                  X2              =   495
                  Y1              =   195
                  Y2              =   1680
               End
               Begin VB.Line Line8 
                  X1              =   495
                  X2              =   8355
                  Y1              =   555
                  Y2              =   555
               End
               Begin VB.Line Line9 
                  X1              =   4245
                  X2              =   4245
                  Y1              =   570
                  Y2              =   1680
               End
               Begin VB.Label Label1 
                  Caption         =   "與                                                          為關係企業"
                  Height          =   260
                  Index           =   107
                  Left            =   4340
                  TabIndex        =   537
                  Top             =   680
                  Width           =   4010
               End
               Begin VB.Shape Shape2 
                  Height          =   1515
                  Left            =   60
                  Top             =   180
                  Width           =   8325
               End
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "聯絡地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   2
               Left            =   60
               TabIndex        =   535
               TabStop         =   0   'False
               Top             =   3615
               Width           =   980
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "申請地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   3
               Left            =   60
               TabIndex        =   534
               TabStop         =   0   'False
               Top             =   3915
               Width           =   980
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   3
               Left            =   7995
               TabIndex        =   125
               Top             =   3915
               Width           =   480
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   2
               Left            =   7995
               TabIndex        =   122
               Top             =   3615
               Width           =   480
            End
            Begin VB.CommandButton cmdSerach 
               Caption         =   "搜尋(&2)"
               Height          =   585
               Index           =   1
               Left            =   4545
               TabIndex        =   117
               Top             =   3015
               Width           =   345
            End
            Begin VB.Frame Frame4 
               Height          =   405
               Index           =   1
               Left            =   1395
               TabIndex        =   533
               Top             =   2295
               Width           =   1695
               Begin VB.OptionButton optCP812 
                  Caption         =   "是"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   0
                  Left            =   120
                  TabIndex        =   110
                  Top             =   120
                  Width           =   615
               End
               Begin VB.OptionButton optCP812 
                  Caption         =   "否"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   1
                  Left            =   930
                  TabIndex        =   111
                  Top             =   120
                  Width           =   660
               End
            End
            Begin VB.CommandButton cmdQual 
               Caption         =   "中小企業減免資格"
               Height          =   285
               Index           =   2
               Left            =   1380
               TabIndex        =   112
               Top             =   2715
               Visible         =   0   'False
               Width           =   1725
            End
            Begin VB.CommandButton CmdSame 
               Caption         =   "同上"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   2
               Left            =   1035
               TabIndex        =   524
               Top             =   3915
               Visible         =   0   'False
               Width           =   550
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   38
               Left            =   1395
               TabIndex        =   116
               Top             =   3315
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   120
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   37
               Left            =   1395
               TabIndex        =   115
               Top             =   3015
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   35
               Left            =   3975
               TabIndex        =   113
               Top             =   2385
               Width           =   4425
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7805;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   50
               Left            =   3975
               TabIndex        =   114
               Top             =   2685
               Width           =   4425
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7805;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   42
               Left            =   1035
               TabIndex        =   120
               Top             =   3615
               Width           =   6255
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "11033;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   141
               Left            =   1035
               TabIndex        =   126
               Top             =   4215
               Width           =   7305
               VariousPropertyBits=   671107099
               MaxLength       =   180
               Size            =   "12885;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   43
               Left            =   1035
               TabIndex        =   123
               Top             =   3915
               Width           =   6255
               VariousPropertyBits=   679495707
               MaxLength       =   80
               Size            =   "11033;529"
               FontName        =   "新細明體"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   33
               Left            =   7050
               TabIndex        =   549
               Top             =   2430
               Visible         =   0   'False
               Width           =   1335
               VariousPropertyBits=   671107097
               BackColor       =   -2147483648
               MaxLength       =   16
               Size            =   "2355;529"
               FontName        =   "新細明體-ExtB"
               FontEffects     =   1073750016
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "聯絡地址："
               Height          =   255
               Index           =   62
               Left            =   135
               TabIndex        =   548
               Top             =   3615
               Width           =   945
            End
            Begin VB.Label Label1 
               Caption         =   "申請地址："
               Height          =   255
               Index           =   50
               Left            =   135
               TabIndex        =   547
               Top             =   3915
               Width           =   945
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   41
               Left            =   7275
               TabIndex        =   121
               Top             =   3615
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   40
               Left            =   6495
               TabIndex        =   119
               Top             =   3315
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   39
               Left            =   6495
               TabIndex        =   118
               Top             =   3015
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   121
               Left            =   7275
               TabIndex        =   124
               Top             =   3915
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "代表人(中文)"
               Height          =   255
               Index           =   34
               Left            =   4995
               TabIndex        =   546
               Top             =   3045
               Width           =   1455
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   33
               Left            =   135
               TabIndex        =   545
               Top             =   3375
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "申請人(中文)："
               Height          =   255
               Index           =   32
               Left            =   135
               TabIndex        =   544
               Top             =   3045
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "E-Mail："
               Height          =   255
               Index           =   26
               Left            =   3285
               TabIndex        =   543
               Top             =   2415
               Width           =   675
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   35
               Left            =   4995
               TabIndex        =   542
               Top             =   3330
               Width           =   1455
            End
            Begin VB.Label Label1 
               AutoSize        =   -1  'True
               Caption         =   "符合年費減免："
               Height          =   180
               Index           =   27
               Left            =   135
               TabIndex        =   541
               Top             =   2445
               Width           =   1260
            End
            Begin VB.Label Label1 
               Caption         =   "國籍："
               Height          =   255
               Index           =   110
               Left            =   3285
               TabIndex        =   540
               Top             =   2715
               Width           =   705
            End
            Begin VB.Label Label1 
               Caption         =   "英文地址："
               Height          =   255
               Index           =   114
               Left            =   135
               TabIndex        =   539
               Top             =   4245
               Width           =   945
            End
         End
         Begin VB.Frame Frame36 
            Caption         =   "Frame36"
            Height          =   5145
            Left            =   30
            TabIndex        =   496
            Top             =   330
            Width           =   8535
            Begin VB.Frame Frame50 
               Height          =   705
               Left            =   30
               TabIndex        =   497
               Top             =   2280
               Width           =   8445
               Begin MSForms.ComboBox cboContact 
                  Height          =   300
                  Index           =   1
                  Left            =   2850
                  TabIndex        =   70
                  Top             =   60
                  Width           =   1230
                  VariousPropertyBits=   679495707
                  DisplayStyle    =   3
                  Size            =   "2170;529"
                  MatchEntry      =   1
                  ShowDropButtonWhen=   2
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "ID No.："
                  Height          =   180
                  Index           =   77
                  Left            =   60
                  TabIndex        =   504
                  Top             =   390
                  Width           =   660
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "客戶編號："
                  Height          =   180
                  Index           =   12
                  Left            =   60
                  TabIndex        =   503
                  Top             =   90
                  Width           =   900
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "接洽人："
                  Height          =   180
                  Index           =   13
                  Left            =   2130
                  TabIndex        =   502
                  Top             =   90
                  Width           =   720
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "電話："
                  Height          =   180
                  Index           =   14
                  Left            =   4110
                  TabIndex        =   501
                  Top             =   90
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "傳真："
                  Height          =   180
                  Index           =   15
                  Left            =   6480
                  TabIndex        =   500
                  Top             =   90
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "手機："
                  Height          =   180
                  Index           =   18
                  Left            =   6480
                  TabIndex        =   499
                  Top             =   360
                  Width           =   540
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "LINE ID："
                  BeginProperty Font 
                     Name            =   "新細明體"
                     Size            =   8.4
                     Charset         =   136
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   165
                  Index           =   85
                  Left            =   4080
                  TabIndex        =   498
                  Top             =   390
                  Width           =   690
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   20
                  Left            =   7050
                  TabIndex        =   76
                  Top             =   360
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   12
                  Left            =   990
                  TabIndex        =   69
                  Top             =   60
                  Width           =   1095
                  VariousPropertyBits=   671107099
                  Size            =   "1931;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   14
                  Left            =   4785
                  TabIndex        =   71
                  Top             =   60
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   15
                  Left            =   4785
                  TabIndex        =   75
                  Top             =   360
                  Width           =   1650
                  VariousPropertyBits=   671107099
                  MaxLength       =   20
                  Size            =   "2910;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   16
                  Left            =   7050
                  TabIndex        =   72
                  Top             =   60
                  Width           =   1335
                  VariousPropertyBits=   671107099
                  MaxLength       =   17
                  Size            =   "2355;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   92
                  Left            =   990
                  TabIndex        =   73
                  Top             =   360
                  Width           =   1785
                  VariousPropertyBits=   671107099
                  MaxLength       =   18
                  Size            =   "3149;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   13
                  Left            =   2850
                  TabIndex        =   74
                  Top             =   360
                  Visible         =   0   'False
                  Width           =   1230
                  VariousPropertyBits=   671107099
                  Size            =   "2170;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
            End
            Begin VB.Frame Frame4 
               Height          =   405
               Index           =   0
               Left            =   1395
               TabIndex        =   505
               Top             =   2895
               Width           =   1695
               Begin VB.OptionButton optCP811 
                  Caption         =   "否"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   1
                  Left            =   930
                  TabIndex        =   78
                  Top             =   120
                  Width           =   660
               End
               Begin VB.OptionButton optCP811 
                  Caption         =   "是"
                  Enabled         =   0   'False
                  Height          =   255
                  Index           =   0
                  Left            =   120
                  TabIndex        =   77
                  Top             =   120
                  Width           =   615
               End
            End
            Begin VB.Frame Frame7 
               Height          =   2280
               Left            =   30
               TabIndex        =   506
               Top             =   -30
               Width           =   8430
               Begin VB.Frame Frame12 
                  Caption         =   "Frame12"
                  Height          =   825
                  Left            =   4350
                  TabIndex        =   658
                  Top             =   1350
                  Width           =   3975
                  Begin VB.OptionButton Option5 
                     Caption         =   "相同"
                     ForeColor       =   &H000000FF&
                     Height          =   315
                     Index           =   0
                     Left            =   90
                     TabIndex        =   67
                     Top             =   240
                     Width           =   675
                  End
                  Begin VB.OptionButton Option5 
                     Caption         =   "有關"
                     ForeColor       =   &H000000FF&
                     Height          =   315
                     Index           =   1
                     Left            =   90
                     TabIndex        =   68
                     Top             =   480
                     Width           =   675
                  End
                  Begin VB.CommandButton cmdCRL55 
                     BackColor       =   &H00C0C0C0&
                     Caption         =   "本案與總號"
                     Height          =   255
                     Left            =   0
                     Style           =   1  '圖片外觀
                     TabIndex        =   66
                     Top             =   -30
                     Width           =   1125
                  End
                  Begin VB.Label Label1 
                     Caption         =   "本案與總號："
                     ForeColor       =   &H00000000&
                     Height          =   255
                     Index           =   84
                     Left            =   60
                     TabIndex        =   660
                     Top             =   0
                     Width           =   1125
                  End
                  Begin MSForms.TextBox Text1 
                     Height          =   660
                     Index           =   100
                     Left            =   1200
                     TabIndex        =   659
                     Top             =   60
                     Width           =   2385
                     VariousPropertyBits=   -1467987939
                     BackColor       =   -2147483633
                     MaxLength       =   100
                     ScrollBars      =   2
                     Size            =   "4207;1164"
                     FontName        =   "新細明體-ExtB"
                     FontEffects     =   1073750016
                     FontHeight      =   180
                     FontCharSet     =   136
                     FontPitchAndFamily=   34
                  End
               End
               Begin VB.Frame Frame30 
                  Caption         =   "特例簽核"
                  ForeColor       =   &H00000000&
                  Height          =   495
                  Index           =   0
                  Left            =   2130
                  TabIndex        =   643
                  Top             =   60
                  Width           =   2085
                  Begin VB.CheckBox ChkCRA27 
                     Caption         =   "有跨所"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   0
                     Left            =   1080
                     TabIndex        =   645
                     Top             =   180
                     Width           =   975
                  End
                  Begin VB.CheckBox ChkCRA26 
                     Caption         =   "有對造"
                     Enabled         =   0   'False
                     BeginProperty Font 
                        Name            =   "新細明體"
                        Size            =   9
                        Charset         =   136
                        Weight          =   700
                        Underline       =   0   'False
                        Italic          =   0   'False
                        Strikethrough   =   0   'False
                     EndProperty
                     ForeColor       =   &H00FF0000&
                     Height          =   270
                     Index           =   0
                     Left            =   90
                     TabIndex        =   644
                     Top             =   180
                     Width           =   885
                  End
               End
               Begin VB.OptionButton Option4 
                  Caption         =   "自動來所"
                  Height          =   345
                  Index           =   3
                  Left            =   2460
                  TabIndex        =   60
                  Top             =   615
                  Width           =   1275
               End
               Begin VB.OptionButton Option4 
                  Caption         =   "同仁"
                  Height          =   345
                  Index           =   2
                  Left            =   540
                  TabIndex        =   63
                  Top             =   1290
                  Width           =   705
               End
               Begin VB.OptionButton Option4 
                  Caption         =   "客戶"
                  Height          =   255
                  Index           =   1
                  Left            =   540
                  TabIndex        =   62
                  Top             =   1050
                  Width           =   1275
               End
               Begin VB.OptionButton Option4 
                  Caption         =   "主動開拓"
                  Height          =   345
                  Index           =   0
                  Left            =   540
                  TabIndex        =   59
                  Top             =   600
                  Width           =   1275
               End
               Begin VB.Frame Frame11 
                  Height          =   255
                  Left            =   1020
                  TabIndex        =   507
                  Top             =   270
                  Width           =   5880
                  Begin VB.OptionButton Option31 
                     Caption         =   "舊客戶"
                     Height          =   285
                     Index           =   1
                     Left            =   4590
                     TabIndex        =   58
                     Top             =   -30
                     Value           =   -1  'True
                     Width           =   975
                  End
                  Begin VB.OptionButton Option31 
                     Caption         =   "新客戶"
                     Height          =   285
                     Index           =   0
                     Left            =   0
                     TabIndex        =   57
                     Top             =   -15
                     Width           =   975
                  End
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   198
                  Left            =   4580
                  TabIndex        =   61
                  Top             =   650
                  Width           =   2810
                  VariousPropertyBits=   671107099
                  Size            =   "4957;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   99
                  Left            =   4875
                  TabIndex        =   65
                  Top             =   1020
                  Width           =   3435
                  VariousPropertyBits=   671107099
                  Size            =   "6059;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin MSForms.TextBox Text1 
                  Height          =   300
                  Index           =   97
                  Left            =   1380
                  TabIndex        =   64
                  Top             =   1350
                  Width           =   1245
                  VariousPropertyBits=   671107099
                  Size            =   "2196;529"
                  FontName        =   "新細明體-ExtB"
                  FontHeight      =   180
                  FontCharSet     =   136
                  FontPitchAndFamily=   34
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "介紹"
                  Height          =   180
                  Index           =   37
                  Left            =   2730
                  TabIndex        =   511
                  Top             =   1380
                  Width           =   360
               End
               Begin VB.Line Line7 
                  X1              =   510
                  X2              =   8370
                  Y1              =   975
                  Y2              =   975
               End
               Begin VB.Label Label1 
                  AutoSize        =   -1  'True
                  Caption         =   "其他："
                  Height          =   180
                  Index           =   83
                  Left            =   4275
                  TabIndex        =   510
                  Top             =   1050
                  Width           =   540
               End
               Begin VB.Label Label2 
                  Alignment       =   2  '置中對齊
                  Caption         =   "案件來源說明"
                  Height          =   1110
                  Index           =   0
                  Left            =   135
                  TabIndex        =   509
                  Top             =   465
                  Width           =   315
               End
               Begin VB.Line Line2 
                  X1              =   495
                  X2              =   495
                  Y1              =   195
                  Y2              =   2220
               End
               Begin VB.Line Line3 
                  X1              =   495
                  X2              =   8355
                  Y1              =   555
                  Y2              =   555
               End
               Begin VB.Line Line4 
                  X1              =   4245
                  X2              =   4245
                  Y1              =   570
                  Y2              =   2220
               End
               Begin VB.Label Label1 
                  Caption         =   "與                                                          為關係企業"
                  Height          =   260
                  Index           =   82
                  Left            =   4340
                  TabIndex        =   508
                  Top             =   680
                  Width           =   4010
               End
               Begin VB.Shape Shape1 
                  Height          =   2055
                  Left            =   60
                  Top             =   180
                  Width           =   8325
               End
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "聯絡地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   0
               Left            =   30
               TabIndex        =   87
               TabStop         =   0   'False
               Top             =   4215
               Width           =   980
            End
            Begin VB.CommandButton cmdTW 
               Caption         =   "申請地址："
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   1
               Left            =   30
               TabIndex        =   91
               TabStop         =   0   'False
               Top             =   4515
               Width           =   980
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   0
               Left            =   8010
               TabIndex        =   90
               Top             =   4215
               Width           =   480
            End
            Begin VB.CommandButton cmdSearchZip 
               Caption         =   "Zip"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   270
               Index           =   1
               Left            =   8010
               TabIndex        =   95
               Top             =   4515
               Width           =   480
            End
            Begin VB.CommandButton cmdSerach 
               Caption         =   "搜尋(&1)"
               Height          =   585
               Index           =   0
               Left            =   4545
               TabIndex        =   84
               Top             =   3615
               Width           =   345
            End
            Begin VB.CommandButton cmdQual 
               Caption         =   "中小企業減免資格"
               Height          =   285
               Index           =   1
               Left            =   1380
               TabIndex        =   79
               Top             =   3315
               Visible         =   0   'False
               Width           =   1725
            End
            Begin VB.CommandButton CmdSame 
               Caption         =   "同上"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   8.4
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   300
               Index           =   1
               Left            =   1005
               TabIndex        =   92
               Top             =   4515
               Visible         =   0   'False
               Width           =   550
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   22
               Left            =   1395
               TabIndex        =   83
               Top             =   3915
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   120
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   21
               Left            =   1395
               TabIndex        =   82
               Top             =   3615
               Width           =   3075
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "5424;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   125
               Left            =   1005
               TabIndex        =   96
               Top             =   4815
               Width           =   7305
               VariousPropertyBits=   671107099
               MaxLength       =   180
               Size            =   "12885;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   26
               Left            =   1005
               TabIndex        =   88
               Top             =   4215
               Width           =   6300
               VariousPropertyBits=   671107099
               MaxLength       =   80
               Size            =   "11112;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   27
               Left            =   1005
               TabIndex        =   93
               Top             =   4515
               Width           =   6300
               VariousPropertyBits=   679495707
               MaxLength       =   80
               Size            =   "11112;529"
               FontName        =   "新細明體"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   19
               Left            =   3975
               TabIndex        =   80
               Top             =   2985
               Width           =   4425
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7805;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   34
               Left            =   3975
               TabIndex        =   81
               Top             =   3285
               Width           =   4425
               VariousPropertyBits=   671107099
               MaxLength       =   50
               Size            =   "7805;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   17
               Left            =   6990
               TabIndex        =   522
               Top             =   3030
               Visible         =   0   'False
               Width           =   1335
               VariousPropertyBits=   671107097
               BackColor       =   -2147483648
               MaxLength       =   16
               Size            =   "2355;529"
               FontName        =   "新細明體-ExtB"
               FontEffects     =   1073750016
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "英文地址："
               Height          =   255
               Index           =   92
               Left            =   75
               TabIndex        =   521
               Top             =   4845
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "聯絡地址："
               Height          =   255
               Index           =   75
               Left            =   75
               TabIndex        =   520
               Top             =   4350
               Width           =   945
            End
            Begin VB.Label Label1 
               Caption         =   "申請地址："
               Height          =   255
               Index           =   63
               Left            =   75
               TabIndex        =   519
               Top             =   4650
               Width           =   945
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   25
               Left            =   7305
               TabIndex        =   89
               Top             =   4215
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   24
               Left            =   6495
               TabIndex        =   86
               Top             =   3915
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   23
               Left            =   6495
               TabIndex        =   85
               Top             =   3615
               Width           =   1905
               VariousPropertyBits=   671107099
               MaxLength       =   30
               Size            =   "3360;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin MSForms.TextBox Text1 
               Height          =   300
               Index           =   120
               Left            =   7305
               TabIndex        =   94
               Top             =   4515
               Width           =   705
               VariousPropertyBits=   671107099
               Size            =   "1244;529"
               FontName        =   "新細明體-ExtB"
               FontHeight      =   180
               FontCharSet     =   136
               FontPitchAndFamily=   34
            End
            Begin VB.Label Label1 
               Caption         =   "代表人(中文)"
               Height          =   255
               Index           =   21
               Left            =   4995
               TabIndex        =   518
               Top             =   3645
               Width           =   1455
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   20
               Left            =   135
               TabIndex        =   517
               Top             =   3945
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "申請人(中文)："
               Height          =   255
               Index           =   19
               Left            =   135
               TabIndex        =   516
               Top             =   3615
               Width           =   1305
            End
            Begin VB.Label Label1 
               Caption         =   "E-Mail："
               Height          =   255
               Index           =   17
               Left            =   3285
               TabIndex        =   515
               Top             =   3015
               Width           =   675
            End
            Begin VB.Label Label1 
               Caption         =   "　　　(英文)："
               Height          =   255
               Index           =   22
               Left            =   4995
               TabIndex        =   514
               Top             =   3930
               Width           =   1455
            End
            Begin VB.Label Label1 
               AutoSize        =   -1  'True
               Caption         =   "符合年費減免："
               Height          =   180
               Index           =   5
               Left            =   135
               TabIndex        =   513
               Top             =   3045
               Width           =   1260
            End
            Begin VB.Label Label1 
               Caption         =   "國籍："
               Height          =   255
               Index           =   94
               Left            =   3285
               TabIndex        =   512
               Top             =   3315
               Width           =   675
            End
         End
      End
      Begin MSHierarchicalFlexGridLib.MSHFlexGrid GRD1 
         Bindings        =   "frm090801_New.frx":01DC
         Height          =   1590
         Left            =   -70425
         TabIndex        =   343
         Top             =   3960
         Width           =   4185
         _ExtentX        =   7387
         _ExtentY        =   2815
         _Version        =   393216
         FixedCols       =   0
         ScrollTrack     =   -1  'True
         AllowUserResizing=   3
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "新細明體-ExtB"
            Size            =   9
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         _NumberOfBands  =   1
         _Band(0).Cols   =   2
      End
      Begin MSForms.Label Label29 
         Height          =   255
         Left            =   -73005
         TabIndex        =   691
         Top             =   5610
         Width           =   6705
         Caption         =   "Create ID:           Date         Time             Update ID:                Date                  Time"
         Size            =   "11818;459"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label LblReason 
         Appearance      =   0  '平面
         BorderStyle     =   1  '單線固定
         Caption         =   "LblReason"
         ForeColor       =   &H80000008&
         Height          =   300
         Left            =   -73665
         TabIndex        =   672
         Top             =   2820
         Width           =   2505
      End
      Begin VB.Label Label36 
         AutoSize        =   -1  'True
         Caption         =   "(系統產生)"
         Height          =   240
         Left            =   -74895
         TabIndex        =   671
         Top             =   1350
         Width           =   840
      End
      Begin VB.Label Label37 
         AutoSize        =   -1  'True
         Caption         =   "(一般簽核)"
         Height          =   180
         Left            =   -74895
         TabIndex        =   642
         Top             =   1620
         Width           =   840
      End
      Begin MSForms.TextBox PicText 
         Height          =   300
         Left            =   -74580
         TabIndex        =   495
         Top             =   2070
         Width           =   3855
         VariousPropertyBits=   671107099
         MaxLength       =   48
         Size            =   "6800;529"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   0
         Left            =   -70320
         TabIndex        =   359
         Top             =   1365
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   9
         Left            =   -74670
         TabIndex        =   401
         Top             =   4875
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   8
         Left            =   -74670
         TabIndex        =   396
         Top             =   4485
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   7
         Left            =   -74670
         TabIndex        =   391
         Top             =   4095
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   6
         Left            =   -74670
         TabIndex        =   386
         Top             =   3705
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   5
         Left            =   -74670
         TabIndex        =   381
         Top             =   3315
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   4
         Left            =   -74670
         TabIndex        =   376
         Top             =   2925
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   3
         Left            =   -74670
         TabIndex        =   371
         Top             =   2535
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   2
         Left            =   -74670
         TabIndex        =   366
         Top             =   2145
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   1
         Left            =   -74670
         TabIndex        =   361
         Top             =   1755
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text2 
         Height          =   315
         Index           =   0
         Left            =   -74670
         TabIndex        =   356
         Top             =   1365
         Width           =   1335
         VariousPropertyBits=   671107099
         Size            =   "2355;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label Label6 
         Caption         =   "PS : 1. 請先選取既有發明人再輸入新發明人資料, 以免輸入的資料被覆蓋掉          2. 發明人未建檔者，標題顯示黃色"
         ForeColor       =   &H000000FF&
         Height          =   615
         Index           =   1
         Left            =   -72780
         TabIndex        =   421
         Top             =   420
         Width           =   5895
      End
      Begin VB.Label Label10 
         Caption         =   "同申請地址"
         Height          =   405
         Left            =   -66780
         TabIndex        =   420
         Top             =   915
         Width           =   585
      End
      Begin VB.Label Label5 
         Caption         =   "10."
         Height          =   255
         Index           =   9
         Left            =   -74910
         TabIndex        =   419
         Top             =   4905
         Width           =   285
      End
      Begin VB.Label Label5 
         Caption         =   "9."
         Height          =   255
         Index           =   8
         Left            =   -74910
         TabIndex        =   418
         Top             =   4545
         Width           =   285
      End
      Begin VB.Label Label5 
         Caption         =   "8."
         Height          =   255
         Index           =   7
         Left            =   -74910
         TabIndex        =   417
         Top             =   4155
         Width           =   285
      End
      Begin VB.Label Label5 
         Caption         =   "7."
         Height          =   255
         Index           =   6
         Left            =   -74910
         TabIndex        =   416
         Top             =   3735
         Width           =   285
      End
      Begin VB.Label Label5 
         Caption         =   "6."
         Height          =   255
         Index           =   5
         Left            =   -74910
         TabIndex        =   415
         Top             =   3375
         Width           =   285
      End
      Begin VB.Label Label5 
         Caption         =   "5."
         Height          =   255
         Index           =   4
         Left            =   -74910
         TabIndex        =   414
         Top             =   2985
         Width           =   285
      End
      Begin VB.Label Label5 
         Caption         =   "4."
         Height          =   255
         Index           =   3
         Left            =   -74910
         TabIndex        =   413
         Top             =   2595
         Width           =   285
      End
      Begin VB.Label Label5 
         Caption         =   "3."
         Height          =   255
         Index           =   2
         Left            =   -74910
         TabIndex        =   412
         Top             =   2205
         Width           =   285
      End
      Begin VB.Label Label5 
         Caption         =   "2."
         Height          =   255
         Index           =   1
         Left            =   -74910
         TabIndex        =   411
         Top             =   1785
         Width           =   285
      End
      Begin VB.Label Label5 
         Caption         =   "1."
         Height          =   255
         Index           =   0
         Left            =   -74910
         TabIndex        =   410
         Top             =   1395
         Width           =   285
      End
      Begin VB.Label Label9 
         Caption         =   "地址"
         Height          =   285
         Index           =   0
         Left            =   -70320
         TabIndex        =   409
         Top             =   1185
         Width           =   795
      End
      Begin VB.Label Label8 
         Caption         =   "國籍"
         Height          =   285
         Index           =   0
         Left            =   -73290
         TabIndex        =   408
         Top             =   1185
         Width           =   795
      End
      Begin VB.Label Label7 
         Caption         =   "ID"
         Height          =   285
         Index           =   0
         Left            =   -71610
         TabIndex        =   407
         Top             =   1155
         Width           =   795
      End
      Begin VB.Label Label6 
         Caption         =   "發明人姓名"
         Height          =   255
         Index           =   0
         Left            =   -74670
         TabIndex        =   406
         Top             =   1155
         Width           =   1215
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   9
         Left            =   -70320
         TabIndex        =   404
         Top             =   4875
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   8
         Left            =   -70320
         TabIndex        =   399
         Top             =   4485
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   7
         Left            =   -70320
         TabIndex        =   394
         Top             =   4095
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   6
         Left            =   -70320
         TabIndex        =   389
         Top             =   3705
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   5
         Left            =   -70320
         TabIndex        =   384
         Top             =   3315
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   4
         Left            =   -70320
         TabIndex        =   379
         Top             =   2925
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   3
         Left            =   -70320
         TabIndex        =   374
         Top             =   2535
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   2
         Left            =   -70320
         TabIndex        =   369
         Top             =   2145
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox Text4 
         Height          =   315
         Index           =   1
         Left            =   -70320
         TabIndex        =   364
         Top             =   1755
         Width           =   3705
         VariousPropertyBits=   671107099
         MaxLength       =   80
         Size            =   "6535;556"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox txtF0310_2 
         Height          =   255
         Left            =   -73335
         TabIndex        =   354
         Top             =   510
         Width           =   1035
         VariousPropertyBits=   679495711
         BackColor       =   -2147483633
         ForeColor       =   -2147483630
         ScrollBars      =   3
         Size            =   "1826;450"
         Value           =   "txtF0310_2"
         SpecialEffect   =   0
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin MSForms.TextBox txtF0407 
         Height          =   1590
         Left            =   -73995
         TabIndex        =   353
         Top             =   3960
         Width           =   3525
         VariousPropertyBits=   -1466939361
         ScrollBars      =   3
         Size            =   "6218;2805"
         SpecialEffect   =   0
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label Label30 
         AutoSize        =   -1  'True
         Caption         =   "簽核歷程："
         Height          =   180
         Left            =   -74895
         TabIndex        =   352
         Top             =   3960
         Width           =   900
      End
      Begin VB.Label Label32 
         AutoSize        =   -1  'True
         Caption         =   "目前表單狀態："
         ForeColor       =   &H000000C0&
         Height          =   180
         Left            =   -74910
         TabIndex        =   351
         Top             =   840
         Width           =   1260
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "填單人員："
         ForeColor       =   &H00000000&
         Height          =   180
         Index           =   128
         Left            =   -74895
         TabIndex        =   350
         Top             =   540
         Width           =   900
      End
      Begin MSForms.TextBox txtF0306 
         Height          =   510
         Left            =   -73995
         TabIndex        =   591
         Top             =   2280
         Width           =   7755
         VariousPropertyBits=   -1466939365
         MaxLength       =   500
         ScrollBars      =   3
         Size            =   "13679;900"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label Label33 
         AutoSize        =   -1  'True
         Caption         =   "智權備註："
         Height          =   180
         Left            =   -74895
         TabIndex        =   349
         Top             =   2280
         Width           =   900
      End
      Begin VB.Label Label1 
         Caption         =   "櫃檯退回原因："
         Height          =   180
         Index           =   130
         Left            =   -74895
         TabIndex        =   348
         Top             =   2850
         Width           =   1455
      End
      Begin VB.Label Label34 
         AutoSize        =   -1  'True
         Caption         =   "您的意見："
         Height          =   180
         Left            =   -74895
         TabIndex        =   347
         Top             =   3270
         Width           =   900
      End
      Begin MSForms.TextBox txtNote 
         Height          =   630
         Left            =   -73995
         TabIndex        =   593
         Top             =   3240
         Width           =   7755
         VariousPropertyBits=   -1466939365
         MaxLength       =   200
         ScrollBars      =   3
         Size            =   "13679;1111"
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label Label35 
         AutoSize        =   -1  'True
         Caption         =   "呈報主管："
         Height          =   180
         Left            =   -74895
         TabIndex        =   346
         Top             =   1140
         Width           =   900
      End
      Begin MSForms.TextBox txtCRL69 
         Height          =   1140
         Left            =   -73995
         TabIndex        =   345
         Top             =   1110
         Width           =   4215
         VariousPropertyBits=   -1466939361
         BackColor       =   12632319
         BorderStyle     =   1
         ScrollBars      =   2
         Size            =   "7435;2011"
         SpecialEffect   =   0
         FontName        =   "新細明體-ExtB"
         FontHeight      =   180
         FontCharSet     =   136
         FontPitchAndFamily=   34
      End
      Begin VB.Label LblRecved 
         Caption         =   "已收文"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   12
            Charset         =   136
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000C0&
         Height          =   255
         Left            =   -72015
         TabIndex        =   344
         Top             =   450
         Visible         =   0   'False
         Width           =   855
      End
   End
   Begin VB.TextBox Text5 
      Height          =   315
      Left            =   3890
      Locked          =   -1  'True
      MaxLength       =   10
      TabIndex        =   49
      Top             =   210
      Visible         =   0   'False
      Width           =   1070
   End
   Begin VB.CommandButton cmdOK 
      BackColor       =   &H0000C0C0&
      Caption         =   "案源輸入(&I)"
      Height          =   350
      Index           =   5
      Left            =   4990
      Style           =   1  '圖片外觀
      TabIndex        =   242
      Top             =   60
      Visible         =   0   'False
      Width           =   1050
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "查詢"
      CausesValidation=   0   'False
      Height          =   350
      Index           =   4
      Left            =   7620
      TabIndex        =   53
      Top             =   7140
      Visible         =   0   'False
      Width           =   825
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   117
      Left            =   4344
      TabIndex        =   700
      Top             =   7776
      Width           =   1128
      VariousPropertyBits=   671107099
      MaxLength       =   7
      Size            =   "1984;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin VB.Label Label28 
      Caption         =   "Ex: 930820 "
      Height          =   312
      Index           =   0
      Left            =   5544
      TabIndex        =   699
      Top             =   7812
      Width           =   948
   End
   Begin VB.Label Label1 
      Caption         =   "到期日："
      Height          =   288
      Index           =   139
      Left            =   3564
      TabIndex        =   698
      Top             =   7836
      Width           =   768
   End
   Begin VB.Label Label28 
      Caption         =   "民國年月日"
      ForeColor       =   &H00FF0000&
      Height          =   288
      Index           =   2
      Left            =   2580
      TabIndex        =   684
      Top             =   8040
      Width           =   948
   End
   Begin VB.Label lblAPPLQ 
      AutoSize        =   -1  'True
      Caption         =   "有對造"
      BeginProperty Font 
         Name            =   "新細明體"
         Size            =   9
         Charset         =   136
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   180
      Left            =   3200
      TabIndex        =   681
      Top             =   300
      Visible         =   0   'False
      Width           =   640
   End
   Begin VB.Label lblZip 
      AutoSize        =   -1  'True
      Caption         =   "有跨所"
      BeginProperty Font 
         Name            =   "新細明體"
         Size            =   9
         Charset         =   136
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   180
      Left            =   3210
      TabIndex        =   680
      Top             =   60
      Visible         =   0   'False
      Width           =   640
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   144
      Left            =   5760
      TabIndex        =   679
      Top             =   8160
      Width           =   1128
      VariousPropertyBits=   671107099
      MaxLength       =   7
      Size            =   "1984;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin VB.Label Label1 
      Caption         =   "關連表單編號："
      Height          =   288
      Index           =   136
      Left            =   4500
      TabIndex        =   678
      Top             =   8196
      Width           =   1272
   End
   Begin VB.Label Label1 
      Caption         =   "預定收款日期："
      Height          =   288
      Index           =   105
      Left            =   144
      TabIndex        =   274
      Top             =   8040
      Width           =   1272
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   118
      Left            =   1404
      TabIndex        =   273
      Top             =   8016
      Width           =   1128
      VariousPropertyBits=   671107099
      MaxLength       =   7
      Size            =   "1984;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   116
      Left            =   1020
      TabIndex        =   272
      Top             =   7716
      Width           =   1128
      VariousPropertyBits=   671107099
      MaxLength       =   20
      Size            =   "1984;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo2 
      Height          =   300
      Index           =   2
      Left            =   5940
      TabIndex        =   269
      Top             =   7092
      Width           =   1512
      VariousPropertyBits=   679495707
      DisplayStyle    =   3
      Size            =   "2672;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo2 
      Height          =   300
      Index           =   1
      Left            =   5940
      TabIndex        =   268
      Top             =   6768
      Width           =   1512
      VariousPropertyBits=   679495707
      DisplayStyle    =   3
      Size            =   "2672;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.ComboBox Combo2 
      Height          =   300
      Index           =   3
      Left            =   5940
      TabIndex        =   267
      Top             =   7428
      Width           =   1512
      VariousPropertyBits=   679495707
      DisplayStyle    =   3
      Size            =   "2672;529"
      MatchEntry      =   1
      ShowDropButtonWhen=   2
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   107
      Left            =   2820
      TabIndex        =   266
      Top             =   7092
      Width           =   1128
      VariousPropertyBits=   671107099
      Size            =   "1984;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   104
      Left            =   2820
      TabIndex        =   265
      Top             =   6768
      Width           =   1128
      VariousPropertyBits=   671107099
      Size            =   "1984;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   109
      Left            =   5040
      TabIndex        =   264
      Top             =   7092
      Width           =   912
      VariousPropertyBits=   671107099
      Size            =   "1614;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   108
      Left            =   3960
      TabIndex        =   263
      Top             =   7092
      Width           =   1092
      VariousPropertyBits=   671107099
      Size            =   "1931;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   106
      Left            =   5040
      TabIndex        =   262
      Top             =   6768
      Width           =   912
      VariousPropertyBits=   671107099
      Size            =   "1614;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   105
      Left            =   3960
      TabIndex        =   261
      Top             =   6768
      Width           =   1092
      VariousPropertyBits=   671107099
      Size            =   "1931;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   110
      Left            =   2820
      TabIndex        =   260
      Top             =   7428
      Width           =   1128
      VariousPropertyBits=   671107099
      Size            =   "1984;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   112
      Left            =   5040
      TabIndex        =   259
      Top             =   7428
      Width           =   912
      VariousPropertyBits=   671107099
      Size            =   "1614;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin MSForms.TextBox Text1 
      Height          =   300
      Index           =   111
      Left            =   3960
      TabIndex        =   258
      Top             =   7428
      Width           =   1092
      VariousPropertyBits=   671107099
      Size            =   "1931;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin VB.Label Label1 
      Caption         =   "2."
      Height          =   252
      Index           =   96
      Left            =   144
      TabIndex        =   257
      Top             =   6792
      Width           =   1008
   End
   Begin VB.Label Label1 
      Caption         =   "3."
      Height          =   252
      Index           =   97
      Left            =   144
      TabIndex        =   256
      Top             =   7128
      Width           =   1008
   End
   Begin VB.Label Label1 
      Caption         =   "4."
      Height          =   252
      Index           =   98
      Left            =   144
      TabIndex        =   255
      Top             =   7452
      Width           =   1008
   End
   Begin VB.Label LblText5 
      Caption         =   "編號："
      Height          =   250
      Left            =   3930
      TabIndex        =   251
      Top             =   40
      Visible         =   0   'False
      Width           =   590
   End
End
Attribute VB_Name = "frm090801_New"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'Modify By Sindy 2022/9/8 案件性質原寫固定4筆,改寫用Grid方式,呈現/輸入多筆
'Memo by Morgan 2022/1/20 改成Form2.0 (Text1,Text6,Text2,Text4,Text7,Combo2,cboTitle,cboContact,lblStaffName)
'Memo by Lydia 2019/07/01 表單名稱:國內案件接洽記錄單=>案件接洽單
'Memo By Sindy 2012/12/3 智權人員欄已修改
'Memo By Sindy 2011/2/16 SQLDate已檢查
'Memo By Sindy 2010/8/3 日期欄已修改
'Modified by Morgan 2022/3/10 跳行控制統一用 vbCrLf 取代(原來程式還有 chr(13),chr(13)+chr(10),chr(10)+chr(13) 3種寫法，但在 2.0物件會有不同的顯示，正確應該是 chr(13)+chr(10)才對)
Option Explicit

Dim m_intTotPage As Integer '總頁數
Public m_strCustCode As String '申請人代號
Public m_blnOneRec As Boolean  '一筆資料
Dim m_strPA08 As String
Dim m_strPA16 As String
Dim m_strPA10 As String     '2010/3/31 ADD BY SONIA
Dim m_intCustCnt As Integer '計算申請人個數
Dim m_strST06 As String '所別
'Add by Morgan 2004/1/8
Dim intCopies As Integer
Dim m_strPA14 As String     '2010/8/17 add by sonia

'Add by Morgan 2004/5/20
Dim stCountry As String '申請國家
Dim stCustNo1 As String  '申請人1
'add by nick 2004/08/05
Dim stCustNo2 As String  '申請人2
Dim stCustNo3 As String  '申請人3
Dim stCustNo4 As String  '申請人4
Dim stCustNo5 As String  '申請人5
'Add By Sindy 2022/12/23 記錄基本檔的申請人
Dim strAppl1 As String
Dim strAppl2 As String
Dim strAppl3 As String
Dim strAppl4 As String
Dim strAppl5 As String
Dim strPA149 As String
'2022/12/23 END
'每行往下移多少
Const CustMove = 80
Dim iiiii As Integer
Dim PrinterPages As Integer
'add by nick 2004/10/05
Dim IsoptCP81 As Boolean
'add by nickc 2005/05/27
Dim Is307or308 As Boolean
Dim CountBy307308 As String
Dim NowCount As Integer
'add by nickc 2006/07/19
Dim Is308New As Boolean
Dim Is308Old As Boolean
Dim Is308Child As Boolean
'add by nickc 2007/11/12 加入特殊客戶檢查
Dim IsSpecCu As Boolean
Dim SpecCUName As String
Dim SpecMemo As String
'add by nickc 2008/01/18 加入智權人員的客戶備註
Dim IsCuMemo As Boolean
Dim CuMemoName As String
Dim CuMemo As String
Dim m_strTM12 As String '2008/3/21 ADD BY SONIA
Dim m_strTM15 As String '2008/3/21 ADD BY SONIA
Dim m_strTM09 As String 'Add By Sindy 2022/12/29 商品類別
Dim m_strTM22 As String 'Add By Sindy 2022/12/29 專用期間(止日)
Dim strInventorNo As String   '2008/8/25  ADD BY TONI
Dim strInventorName As String '2011/1/31  ADD BY Sindy
Dim strPetition  As String    '2008/8/29  ADD BY TONI

Public IsWmf As Boolean 'Add By Sindy 2009/08/31
Dim m_416Fee             '2010/1/6 ADD BY SONIA 檢查台灣發明實審
Dim m_Note1 As String, m_Note2 As String 'Add By Sindy 2010/4/6
Public m_strGetNP01 As String 'Add By Sindy 2015/9/17
'Dim strYF05From As String 'Add By Sindy 2010/7/9 起始年度
'Dim strYF05To As String   'Add By Sindy 2010/7/9 終止年度
Dim pa() As String         'Add By Sindy 2010/7/9
Dim m_strTitleName As String
'Add By Sindy 2010/6/21
Dim PicRs As ADODB.Recordset
Dim file_num As Integer
Dim bytes() As Byte
Dim m_Image As New cImage
Dim m_Jpeg  As cJpeg
'Modified by Lydia 2018/12/10
'Dim strCRL(1 To 135) As String 'Modify By Amy 2016/09/01
'Modified by Lydia 2019/11/05 137=>138
'Modified by Lydia 2021/02/24 138=>139
'Modified by Lydia 2021/07/22 139=>140 (新藥專利設定)
Dim strCRL() As String
Dim strCRA(1 To 27) As String
'2010/6/21 End
'Add By Sindy 2022/8/29
Dim strCRC(1 To 8) As String
Dim m_strSys As String '專利(1,5) 商標(2,6) 法務(3,7) 顧問(4,8)
'2022/8/29 End
Public m_blnCallPrint As Boolean  'Add By Sindy 2010/6/21 外部呼叫查詢/列印
Public m_blnCallPrint_CRL119 As Boolean 'Add By Sindy 2014/2/7 是否列印特殊收據頁
Dim m_Device 'Add By Sindy 2010/7/7
Public bolPrint As Boolean, intPCnt As Integer 'Add By Sindy 2010/7/7 從frm12040152傳來的變數值
Dim bolRuleFeeErr As Boolean 'Add By Sindy 2010/11/22
Dim m_bCaseClosed As Boolean 'Add by Morgan 2010/12/10 是否已閉卷
Dim m_CP05 As String, m_CP09 As String, m_CP14 As String 'Add by Morgan 2010/12/20
Dim m_strCRL57 As String 'Add by Morgan 2011/1/13 暫存案件說明事項處理情形
Public m_bolPrintMark As Boolean 'Add by Morgan 2010/1/14 是否列印非整批發文字樣
'Add By Sindy 2011/1/24
Dim m_ChkOCaseAndCAddrNotAlike As Boolean
Public rsAddrNotAlike As New ADODB.Recordset
Dim PLeft(1 To 9) As Integer
Dim iLine As Integer
Dim strTemp(1 To 9) As String
'2011/1/24 End
'Add by Morgan 2011/3/2
Dim m_bolDueDayAlert As Boolean '當日法限提醒
Dim m_lngRefund As Long 'Add by Morgan 2010/10/12
Dim m_lstCaseNo As String 'Add by Morgan 2011/4/7
Dim bolPrintNewCase As Boolean 'Add By Sindy 2011/6/7 為新案
Public m_AppAddr As String, m_Zipcode As String 'Add By Sindy 2011/7/8
Public m_AppAddrChange As Boolean, m_CaseAndCAddrNotAlikePrint As Boolean 'Add By Sindy 2011/7/11
'2011/9/5 ADD BY SONIA
Dim stCustCAddr(1 To 5) As String  '申請人客戶檔中文地址
Dim stCustEAddr(1 To 5) As String  '申請人客戶檔英文地址
'2011/9/5 END
Dim m_CRL02 As String '填表日期 Add By Sindy 2011/10/18
Dim strCAddr As String, strEAddr As String, strZip As String   '2011/10/21add by sonia 自SetCustTxt移過來
Dim m_NA59 As String 'Add By Sindy 2011/11/11
Dim dblMoney As Double 'Add By Sindy 2012/3/16
Dim arrCaseProperty, arrNation 'Add By Sindy 2012/6/28
Dim m_strLiveProofMemo As String 'Added by Morgan 2012/11/23 存活證明備註
Dim dblAmt As Double, dblPFee As Double, dblTFee As Double 'Add By Sindy 2012/11/08
Dim dblChkAmt As Double 'Add By Sindy 2012/12/10
'Added by Lydia 2020/02/03
Dim dblCu183 As Double '個人之應收帳款上限
Dim dblAmtR As Double, dblPFeeR As Double, dblTFeeR As Double '關係企業之應收帳款金額
'end 2020/02/03

Dim oChk As CheckBox 'Added by Morgan 2013/1/15
Dim m_bolAdd803Memo As Boolean 'Added by Morgan 2013/1/15
'Added by Morgan 2013/4/2
Public m_stAD15 As String, m_stAD16 As String
Public m_stAD10 As String 'Added by Morgan 2019/4/12
Dim arrAD1516(5, 7) As String 'Modified by Morgan 2019/4/12 第2維 3,4,5,6,7要放AD10(新),CU15,AD10(原),AD15(原),AD16(原)
Dim m_CU143 As String 'Add By Sindy 2013/11/20 預定收款日放寬月數
Dim m_CU144(1 To 5) As String 'Add By Sindy 2013/12/16 不可開立發票
'Add By Sindy 2014/2/6
Public m_stCRL01 As String
Public m_stCRL97 As String, m_stCRL118 As String
Public m_stCRL98 As String, m_stCRL99 As String, m_stCRL100 As String, m_stCRL101 As String
Public m_stCRL102 As String, m_stCRL103 As String, m_stCRL104 As String, m_stCRL105 As String
Public m_stCRL106 As String, m_stCRL107 As String, m_stCRL108 As String, m_stCRL109 As String
Public m_stCRL110 As String, m_stCRL111 As String, m_stCRL112 As String, m_stCRL113 As String
Public m_stCRL120 As String, m_stCRL121 As String, m_stCRL122 As String, m_stCRL123 As String
'2014/2/6 END
'Add By Sindy 2015/8/28
'電話,傳真,E-Mail
Public m_stCRL114 As String, m_stCRL115 As String, m_stCRL116 As String
Public m_stCRL117 As String, m_stCRL124 As String, m_stCRL126 As String
Public m_stCRL127 As String, m_stCRL128 As String, m_stCRL129 As String
Public m_stCRL130 As String, m_stCRL131 As String, m_stCRL132 As String
'2015/8/28 END
'Public m_stCRL134 As String, m_stCRL135 As String '對造 陳報主管員編/原因 'Add by Amy 2016/09/02
Dim m_strCRL146 As Double '點數低於底價
Dim strTawT102MClassFee As String 'Add By Sindy 2014/2/19 舊案時檢查台灣商標延展跨類的規費
Public bolExternalCall As Boolean 'Add By Sindy 2014/5/23 外部程式(寄件查詢)呼叫此作業
Dim m_PrevForm As Form '前一畫面 Add By Sindy 2014/6/3
Public m_strSaveFiles As String 'Add By Sindy 2014/7/21 新增附件1區
Public m_strSaveFiles2 As String 'Add By Sindy 2022/10/11 新增附件2區
Dim strCase(1 To 4) As String, bolCaseIsExists As Boolean 'Add By Sindy 2014/7/28
Dim intCN308Field As Integer 'Add by Amy 2014/10/08 案件性質308欄位-for 大陸T分割案
Dim mPYFee As Boolean 'Add by Lydia 2014/12/22
'Add by Lydia 2015/01/14 分所保留判斷的性質=>屬於印2份,不屬於印3份
Private Const 分所保留 = "401,405,406,412,414,416,417,421,429,436,601,604,605,608,609,610,611,701,702,703,704,705,706,707,708,709,807,904,905,908,915,919,920,921,928"
'Added by Lydia 2015/10/14
Dim TMQList As String
'Add by Amy 2015/10/22
Public BackIntField As Integer '申請人地址欄位 ex: BackIntField=3 為申請人2聯絡地址欄
'臺灣地址確認 0:未確認過/1:是台灣地址/2:新案舊客戶郵遞區號多筆或抓不到/3:電子接洽單最後確認為台灣(以前只有列印,不需留細項判斷結果)
'                       10:新客戶印過後需判斷是否再修改地址(1130829 [紙本]用,[電子]不使用)
'                       11:舊案舊客戶(案件申請地址)/12:新案舊客戶原有Zip(因地址可不打區,若zip多筆不易判斷是否正確-秀玲)
'                       13:新案舊客戶抓取接洽人聯絡地址不需判斷地址正確性,zip也不需回寫接洽人檔(秀玲)
'                       20:信箱不檢查(1130829 紙本時由櫃台查ZIP,[電子]要與客戶檔一致否則櫃台無法存檔,改為智權先查-秀玲)/99:非台灣地址
Dim intTWAddr(1 To 10) As Integer
'Added by Lydia 2016/03/21 增加查名單輸入
Public Tmpfrm090126 As Form
Dim mTQC01 As String 'Added by Lydia 2016/04/06 記錄查名代號(民國年+流水號6碼)
Dim pTMQList As String 'Modified by Lydia 2023/08/02 改成記錄原本勾選的委查結果 'Added by Lydia 2016/05/05記錄已列印的委查結果
'Added by Lydia 2024/11/11 查名單(網中)
Dim nfrm090126_New As Form '查名單(網中)輸入
Dim nfrm090127_New As Form '查覆區
Dim nfrm090128_New As Form '查名單(網中)明細
Dim m_UseTmqTma As String '使用原查名單TMQ=1／查名單(網中)TMA=2做為查名的來源
'end 2024/11/11
Private Const m_TAutoRecv = "303,201,206,211" 'Add By Sindy 2016/5/11 T案可以自動收文的案件性質
'Dim strMemoPrt As String 'Added by Lydia 2016/05/27
'Add by Amy 2016/06/06 for 臺灣地址判斷
Dim strOldAddr(1 To 10) As String '列印後記錄前次地址
'Add by Amy 2016/09/01
Public strCaseNo1 As String, strCaseNo2 As String, StrCaseNo3 As String, strCaseNo4 As String '商標相同號數之本所案號 'Memo by Lydia 2020/12/15 增加：CFT緬甸重新申請案
Public strTM28 As String '商標相同號數之本所案號的卷宗性質
Dim bolNotShow As Boolean 'for 當601異議/603評定/605廢止原新商標案改收舊案時不重抓資料
Dim bolCusCAddr(1 To 5) As Boolean 'Add by Amy 2016/12/23 是否有客戶中文地址-舊案用
'*****************************************************************************************
'Added by Lydia 2019/01/30 記錄代理人D/N備註
Dim m_FA45 As String    '專利D/N備註
Dim m_FA110 As String   '商標D/N備註
Dim m_Tuser As String 'Added by Lydia 2019/02/14 創新業務部預設收文人員
Dim m_LAmsg As String 'Added by Lydia 2019/04/10 顧問服務件數
Dim m_LAchk As String 'Added by Lydia 2024/04/15 顧問服務管制:若本次簽約有簽約時數CP15有值時，也要做已服務時數及簽約時數的管制及提醒；參考ACS智財顧問112的控制。
'Add by Amy 2020/02/14
Public bolNotClsVal As Boolean '不清特殊收據資訊
Dim stChReceipt As String '收據抬頭顯示 1.收據抬頭/2.特殊收據
'Added by Lydia 2020/03/30 收據公司別(簡稱)
Dim m_CompName1 As String '1公司
Dim m_Comp1forIdx As Integer  '1公司的combo4.index
Dim m_CompName2 As String '2公司
Dim m_Comp2forIdx As Integer  '1公司的combo4.index
Dim m_CompNameJ As String 'J公司
Dim m_CompJforIdx As Integer  'J公司的combo4.index
Dim m_CompNameL As String 'L公司
Dim m_CompLforIdx As Integer  'L公司的combo4.index

'Added by Morgan 2020/4/21
'介紹案源回傳欄位
Public iReturn As Integer, strLawMan As String, strIntroducer As String, strCtrlDate As String, strTTCP09 As String, strTTCP10 As String, strTTSaveFiles As String
Public strLSourceType As String, strLC47 As String '案源類型: A,B1,B2,C; 法務案類型

Dim strCheckStatus As String '案源待補輸狀態
Dim bolIsPTCCase As Boolean, bolIsIPCase As Boolean, bolIsSuitCase As Boolean, bolSuYuan As Boolean '是否PTC案,是否智財權案,是否訴訟案,是否訴願案
Dim bolLawOfficeCase As Boolean, bolLawOfficeCase2 As Boolean '是否為介紹案源的法律案接洽單,是否為介紹案源的法律案接洽單2
Dim strLOS15 As String, strLOS17 As String, strLOS18 As String '案源單號,法務案接洽單號,P/T案接洽單號
Dim strLCaseCP10 As String '法律案預設收文案件性質
Dim strPTCP10 As String 'PT案預設收文案件性質
'P/T案:系統別,原說明事項,是否新案,規費
Dim strPTSysCode As String, strPTMemo As String, bolPTIsNew As Boolean, lngPTOFee As Long
Dim lngPTcost As Long 'Add By Sindy 2025/4/14
'出庭費提醒,是否為補收B2案源的出庭費,法務案號
Dim bolCourtFeeAlert As Boolean, bolIsB2CourtFee As Boolean, strLCaseNo(4) As String
Dim strCUNo(5) As String
Dim strSalesDep As String '智權人員部門
Dim strLang As String '代理人查詢語文
'end 2020/4/21
Dim bolIsTmp As Boolean 'Added by Morgan 2020/8/3
Dim strCaseNA239 As String, bolCase201 As Boolean 'Added by Lydia 2020/11/19 CFP和CFT英國脫歐案管制：歐盟案案號、新案第一次先不清除畫面
Dim strCaseNA239new As String 'Added by Lydia 2021/03/05 CFT歐盟尚未註冊案轉換英國申請案：記錄歐盟案案號
Private Const strACSdate1 = "20210428"  'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅：啟用日控制 'Memo by Lydia 2021/04/27  先上線
Dim strGetNp15 As String 'Added by Lydia 2021/04/15 CFP和CFT英國脫歐委任代理之後續處理：將下一程序備註欄之「脫歐英國案代理人：Y…」印在案件說明處理事項欄
Dim m_bol919Received As Boolean, m_lng605Fee As Long, m_lngRefunded As Long 'Added by Morgan 2021/4/29
Dim m_ACS112msg As String 'Added by Lydia 2021/05/07 ACS智財顧問專業分配比例管制：各專業部門、服務次數、工作時數小計、未發文次數
Dim m_ACS112chk As String 'Added by Lydia 2021/05/07 ACS智財顧問專業分配比例管制：已過該案之最大智財顧問112期間、總工作時數>=有效智財顧問112之CP15簽約時數，則檢查是否收文ACS智財顧問112

Dim strSameTrade As String 'Add by Amy 2021/11/29 國內同業msg
Dim m_strContactList(5) As String 'Added by Morgan 2022/1/20
'Added by Morgan 2022/1/25
Dim m_bWordFormat As Boolean '是否以Word輸出
Dim m_WordVar() As String '4 x N 1=變數名稱, 2=輸出內容, 3=非變數(Y), 4=旗標名稱(從此處開始尋找)
Dim m_iSizeD2 As Integer 'Word變數數量
'end 2022/1/25
Dim m_bolText1SetFocus As Boolean, m_objControl As Control 'Added by Morgan 2022/3/17
'Modified by Lydia 2022/09/06 改抓特殊設定
'Private Const cnt應收帳款檢查排除 As String = "74018,70005" 'Added by Lydia 2022/06/15 應收帳款上限檢查排除特定人員: 如果人員有異動, 請一併修改接洽單frm090801和收文frm010004~frm010007
Dim m_ChkAmtExcept As String   'cnt應收帳款檢查排除=>m_ChkAmtExcept（程式碼用取代的）
Dim dblPrevRow As Double
'Add By Sindy 2022/9/6
Dim m_strCaseCPM As String, m_bolNewCase As Boolean, m_strNewCP10 As String, m_bolHad10Point As Boolean
Dim m_dblTotOFee As Double, m_dblTotRvFee As Double, m_dbltotPoint As Double
Dim ff1 As Integer
Dim m_Msgbox As String
Public m_SignFlowEmp As String '簽核人員(因有可能人員休假職代代為操作)
Dim m_F0316 As String, m_F0307 As String, m_F0308 As String, m_F0309 As String
'2022/9/6
'Dim m_F0310 As String 'Add By Sindy 2025/3/25 填單人員
Dim strIDentity As String 'Add By Sindy 2022/12/24
Dim m_strTransCase As String 'Add By Sindy 2023/3/24
Dim m_IsQueryNow As Boolean 'Added by Morgan 2023/4/27
Dim strAddrText As String 'Add By Sindy 2023/5/30
'Add by Amy 2024/01/17
Public m_stCRL156 As String, m_stCRL157 As String, m_stCRL158 As String '對造 中、英、日 名稱
Public m_stCRL159 As String ', bol090801_14Back As Boolean '對造身份證號or統編/風險檢查名單/從frm090801_14回來
Public bolSendRiskChkMail As Boolean, m_RiskMsg As String '是否寄風險檢查對象通知信/風險檢查對象訊息
'2024/01/17 END
Dim strOldCRL70 As String 'Added by Lydia 2025/02/18
Dim m_P601or605cp06 As String, m_P601or605cp07 As String 'Added by Lydia 2025/02/20 P領證/年費的法限,所限
Dim strIDRepeat As String, strReSetCust As String 'Add by Amy 2025/07/21 ID重覆寄信通知信內容 / 鎖住ID欄
Public m_FlowUserNum As String 'Add By Sindy 2025/8/4 案件流程所屬人員
Dim m_strCRC14 As String '指定下一收文總收文號的類別 Add By Sindy 2025/8/15


'Add By Sindy 2014/6/3
Public Sub SetParent(ByRef fm As Form)
   Set m_PrevForm = fm
End Sub

'檢查減免身分
'edit by nick 2004/08/05
Private Sub setCP811()
   Dim stCustID As String
   Dim stAD10 As String, stAD15 As String, stAD16 As String 'Added by Morgan 2013/4/2
   Dim stCU15 As String 'Added by Morgan 2019/4/12

   'Added by Morgan 2013/4/2
   arrAD1516(1, 0) = ""
   arrAD1516(1, 1) = ""
   arrAD1516(1, 2) = ""
   arrAD1516(1, 3) = "" 'Added by Morgan 2019/4/12
   arrAD1516(1, 4) = "" 'Added by Morgan 2019/4/12
   arrAD1516(1, 5) = "" 'Added by Morgan 2019/4/15
   arrAD1516(1, 6) = "" 'Added by Morgan 2019/4/15
   arrAD1516(1, 7) = "" 'Added by Morgan 2019/9/25
   'end 2013/4/2

On Error GoTo ErrHnd
   
      optCP811(0).Value = 0: optCP811(1).Value = 0
      If stCountry <> "" And stCustNo1 <> "" Then
         'edit by nickc 2005/04/07 皆以客戶個人為主
         'Modified by Morgan 2013/4/2+stAD10, stAD15, stAD16
         stCustID = PUB_GetAD03(stCustNo1, stCountry, stAD10, stCU15, stAD15, stAD16)
         arrAD1516(1, 4) = stCU15 'Added by Morgan 2019/4/23 日本案減免資格選項要用
         'end 2019/4/23
         If stCustID = "Y" Then
            optCP811(0).Value = 1
            'Added by Morgan 2013/4/2
            '台灣中小企業可減免紀錄原設定資格並設為可更改
            arrAD1516(1, 0) = "Y" 'Modified by Morgan 2019/4/12 +日本案也可減免(不限定中小企業，個人/學校也要設定資格)
            'Modified by Morgan 2019/4/12 +日本案也可減免(不限定中小企業，個人/學校也要設定資格)
            'If stCountry = "000" And stAD10 = "3" Then
            If (stCountry = "000" And stAD10 = "3") Or stCountry = "011" Then
               arrAD1516(1, 1) = stAD15
               arrAD1516(1, 2) = stAD16
               'Added by Morgan 2019/4/15
               arrAD1516(1, 3) = stAD10
               '記錄原設定已便判斷是否有更改
               arrAD1516(1, 5) = stAD10
               arrAD1516(1, 6) = stAD15
               arrAD1516(1, 7) = stAD16
               'end 2019/4/15
            End If
            'end 2013/4/2
         'edit by nick 2004/08/18
         '有設定過在給值
         ElseIf stCustID = "N" Then
         'EDIT BY NICK 2004/07/30 要給預設值
         'ElseIf stCustID = "N" Then
         'Else
            optCP811(1).Value = 1
            arrAD1516(1, 0) = "N" 'Added by Morgan 2013/4/9
         End If
      End If
   
ErrHnd:
   'Modified by Lydia 2019/08/12 +Titile
   'If Err.Number <> 0 Then MsgBox Err.Description, vbCritical
   If Err.Number <> 0 Then MsgBox Err.Description, vbCritical, "SetCP811"
End Sub

'檢查減免身分
'add by nick 2004/08/05
Private Sub setCP812()

   Dim stCustID As String
   Dim stAD10 As String, stAD15 As String, stAD16 As String 'Added by Morgan 2013/4/2
   Dim stCU15 As String 'Added by Morgan 2019/4/12
   
   'Added by Morgan 2013/4/2
   arrAD1516(2, 0) = ""
   arrAD1516(2, 1) = ""
   arrAD1516(2, 2) = ""
   arrAD1516(2, 3) = "" 'Added by Morgan 2019/4/12
   arrAD1516(2, 4) = "" 'Added by Morgan 2019/4/12
   arrAD1516(2, 5) = "" 'Added by Morgan 2019/4/15
   arrAD1516(2, 6) = "" 'Added by Morgan 2019/4/15
   arrAD1516(2, 7) = "" 'Added by Morgan 2019/9/25
   'end 2013/4/2


On Error GoTo ErrHnd
      
      optCP812(0).Value = 0: optCP812(1).Value = 0
      If stCountry <> "" And stCustNo2 <> "" Then
         'edit by nickc 2005/04/07 皆以客戶個人為主
         'Modified by Morgan 2013/4/2+stAD10, stAD15, stAD16
         stCustID = PUB_GetAD03(stCustNo2, stCountry, stAD10, stCU15, stAD15, stAD16)
         arrAD1516(2, 4) = stCU15 'Added by Morgan 2019/4/23 日本案減免資格選項要用
         If stCustID = "Y" Then
            optCP812(0).Value = 1
            'Added by Morgan 2013/4/2
            arrAD1516(2, 0) = "Y"
            'Modified by Morgan 2019/9/25 修正ad10會被清除問題
            'If (stCountry = "000" And stAD10 = "3") Then
            '   arrAD1516(2, 1) = stAD15
            '   arrAD1516(2, 2) = stAD16
            ''Added by Morgan 2019/4/12
            'ElseIf stCountry = "011" Then
            If (stCountry = "000" And stAD10 = "3") Or stCountry = "011" Then
             'end 2019/9/25
               '記錄原設定已便判斷是否有更改
               arrAD1516(2, 1) = stAD15
               arrAD1516(2, 2) = stAD16
               arrAD1516(2, 3) = stAD10
               arrAD1516(2, 5) = stAD10
               arrAD1516(2, 6) = stAD15
               arrAD1516(2, 7) = stAD16 'Added by Morgan 2019/9/25
            End If
            'end 2013/4/2
            
         'edit by nick 2004/08/18
         '有設定過在給值
         ElseIf stCustID = "N" Then
         'Else
            optCP812(1).Value = 1
            arrAD1516(2, 0) = "N" 'Added by Morgan 2013/4/9
         End If
      End If

ErrHnd:
   'Modified by Lydia 2019/08/12 +Titile
   'If Err.Number <> 0 Then MsgBox Err.Description, vbCritical
   If Err.Number <> 0 Then MsgBox Err.Description, vbCritical, "SetCP812"
End Sub

'檢查減免身分
'add by nick 2004/08/05
Private Sub setCP813()

   Dim stCustID As String
   Dim stAD10 As String, stAD15 As String, stAD16 As String 'Added by Morgan 2013/4/2
   Dim stCU15 As String 'Added by Morgan 2019/4/12
   
   'Added by Morgan 2013/4/2
   arrAD1516(3, 0) = ""
   arrAD1516(3, 1) = ""
   arrAD1516(3, 2) = ""
   arrAD1516(3, 3) = "" 'Added by Morgan 2019/4/12
   arrAD1516(3, 4) = "" 'Added by Morgan 2019/4/12
   arrAD1516(3, 5) = "" 'Added by Morgan 2019/4/15
   arrAD1516(3, 6) = "" 'Added by Morgan 2019/4/15
   arrAD1516(3, 7) = "" 'Added by Morgan 2019/9/25
   'end 2013/4/2


On Error GoTo ErrHnd
   
      optCP813(0).Value = 0: optCP813(1).Value = 0
      If stCountry <> "" And stCustNo3 <> "" Then
         'edit by nickc 2005/04/07 皆以客戶個人為主
         'Modified by Morgan 2013/4/2+stAD10, stAD15, stAD16
         stCustID = PUB_GetAD03(stCustNo3, stCountry, stAD10, stCU15, stAD15, stAD16)
         arrAD1516(3, 4) = stCU15 'Added by Morgan 2019/4/23 日本案減免資格選項要用
         If stCustID = "Y" Then
            optCP813(0).Value = 1
            
            'Added by Morgan 2013/4/2
            arrAD1516(3, 0) = "Y"
            'Modified by Morgan 2019/9/25 修正ad10會被清除問題
            'If stCountry = "000" And stAD10 = "3" Then
            '   arrAD1516(3, 1) = stAD15
            '   arrAD1516(3, 2) = stAD16
            ''Added by Morgan 2019/4/12
            'ElseIf stCountry = "011" Then
            If (stCountry = "000" And stAD10 = "3") Or stCountry = "011" Then
            'end 2019/9/25
               arrAD1516(3, 1) = stAD15
               arrAD1516(3, 2) = stAD16
               arrAD1516(3, 3) = stAD10
               '記錄原減免身分&資格
               arrAD1516(3, 5) = stAD10
               arrAD1516(3, 6) = stAD15
               arrAD1516(3, 7) = stAD16 'Added by Morgan 2019/9/25
            End If
            'end 2013/4/2
            
         'edit by nick 2004/08/18
         '有設定過在給值
         ElseIf stCustID = "N" Then
         'Else
            optCP813(1).Value = 1
            arrAD1516(3, 0) = "N" 'Added by Morgan 2013/4/9
         End If
      End If
  
ErrHnd:
   'Modified by Lydia 2019/08/12 +Titile
   'If Err.Number <> 0 Then MsgBox Err.Description, vbCritical
   If Err.Number <> 0 Then MsgBox Err.Description, vbCritical, "SetCP813"
End Sub

'檢查減免身分
'add by nick 2004/08/05
Private Sub setCP814()

   Dim stCustID As String
   Dim stAD10 As String, stAD15 As String, stAD16 As String 'Added by Morgan 2013/4/2
   Dim stCU15 As String 'Added by Morgan 2019/4/12
   
   'Added by Morgan 2013/4/2
   arrAD1516(4, 0) = ""
   arrAD1516(4, 1) = ""
   arrAD1516(4, 2) = ""
   arrAD1516(4, 3) = "" 'Added by Morgan 2019/4/12
   arrAD1516(4, 4) = "" 'Added by Morgan 2019/4/12
   arrAD1516(4, 5) = "" 'Added by Morgan 2019/4/15
   arrAD1516(4, 6) = "" 'Added by Morgan 2019/4/15
   arrAD1516(4, 7) = "" 'Added by Morgan 2019/9/25
   'end 2013/4/2

On Error GoTo ErrHnd
   
      optCP814(0).Value = 0: optCP814(1).Value = 0
      If stCountry <> "" And stCustNo4 <> "" Then
         'edit by nickc 2005/04/07 皆以客戶個人為主
         'Modified by Morgan 2013/4/2+stAD10, stAD15, stAD16
         stCustID = PUB_GetAD03(stCustNo4, stCountry, stAD10, stCU15, stAD15, stAD16)
         arrAD1516(4, 4) = stCU15 'Added by Morgan 2019/4/23 日本案減免資格選項要用
         If stCustID = "Y" Then
            optCP814(0).Value = 1
            
            'Added by Morgan 2013/4/2
            arrAD1516(4, 0) = "Y"
            'Modified by Morgan 2019/9/25 修正ad10會被清除問題
            'If stCountry = "000" And stAD10 = "3" Then
            '   arrAD1516(4, 1) = stAD15
            '   arrAD1516(4, 2) = stAD16
            ''Added by Morgan 2019/4/12
            'ElseIf stCountry = "011" Then
            If (stCountry = "000" And stAD10 = "3") Or stCountry = "011" Then
            'end 2019/9/25
               arrAD1516(4, 1) = stAD15
               arrAD1516(4, 2) = stAD16
               arrAD1516(4, 3) = stAD10
               '記錄原減免身分&資格
               arrAD1516(4, 5) = stAD10
               arrAD1516(4, 6) = stAD15
               arrAD1516(4, 7) = stAD16 'Added by Morgan 2019/9/25
            End If
            'end 2013/4/2
            
         'edit by nick 2004/08/18
         '有設定過在給值
         ElseIf stCustID = "N" Then
         'Else
            optCP814(1).Value = 1
            arrAD1516(4, 0) = "N" 'Added by Morgan 2013/4/9
         End If
      End If

ErrHnd:
   'Modified by Lydia 2019/08/12 +Titile
   'If Err.Number <> 0 Then MsgBox Err.Description, vbCritical
   If Err.Number <> 0 Then MsgBox Err.Description, vbCritical, "SetCP814"
End Sub

'檢查減免身分
'add by nick 2004/08/05
Private Sub setCP815()

   Dim stCustID As String
   Dim stAD10 As String, stAD15 As String, stAD16 As String 'Added by Morgan 2013/4/2
   Dim stCU15 As String 'Added by Morgan 2019/4/12
   
   'Added by Morgan 2013/4/2
   arrAD1516(5, 0) = ""
   arrAD1516(5, 1) = ""
   arrAD1516(5, 2) = ""
   arrAD1516(5, 3) = "" 'Added by Morgan 2019/4/12
   arrAD1516(5, 4) = "" 'Added by Morgan 2019/4/12
   arrAD1516(5, 5) = "" 'Added by Morgan 2019/4/15
   arrAD1516(5, 6) = "" 'Added by Morgan 2019/4/15
   arrAD1516(5, 7) = "" 'Added by Morgan 2019/9/25
   'end 2013/4/2
   
On Error GoTo ErrHnd
   
      optCP815(0).Value = 0: optCP815(1).Value = 0
      If stCountry <> "" And stCustNo5 <> "" Then
         'edit by nickc 2005/04/07 皆以客戶個人為主
         'Modified by Morgan 2013/4/2+stAD10, stAD15, stAD16
         stCustID = PUB_GetAD03(stCustNo5, stCountry, stAD10, stCU15, stAD15, stAD16)
         arrAD1516(5, 4) = stCU15 'Added by Morgan 2019/4/23 日本案減免資格選項要用
         If stCustID = "Y" Then
            optCP815(0).Value = 1
            'Added by Morgan 2013/4/2
            arrAD1516(5, 0) = "Y"
            'Modified by Morgan 2019/9/25 修正ad10會被清除問題
            'If stCountry = "000" And stAD10 = "3" Then
            '   arrAD1516(5, 1) = stAD15
            '   arrAD1516(5, 2) = stAD16
            ''Added by Morgan 2019/4/12
            'ElseIf stCountry = "011" Then
            If (stCountry = "000" And stAD10 = "3") Or stCountry = "011" Then
             'end 2019/9/25
               arrAD1516(5, 1) = stAD15
               arrAD1516(5, 2) = stAD16
               arrAD1516(5, 3) = stAD10
               '記錄原減免身分&資格
               arrAD1516(5, 5) = stAD10
               arrAD1516(5, 6) = stAD15
               arrAD1516(5, 7) = stAD16 'Added by Morgan 2019/9/25
            End If
            'end 2013/4/2
            
         'edit by nick 2004/08/18
         '有設定過在給值
         ElseIf stCustID = "N" Then
         'Else
            optCP815(1).Value = 1
            arrAD1516(5, 0) = "N" 'Added by Morgan 2013/4/9
         End If
      End If
   
ErrHnd:
   'Modified by Lydia 2019/08/12 +Titile
   'If Err.Number <> 0 Then MsgBox Err.Description, vbCritical
   If Err.Number <> 0 Then MsgBox Err.Description, vbCritical, "SetCP815"
End Sub

'Add by Morgan 2008/9/16
Private Sub cboContact_Change(Index As Integer)
   'Modify By Sindy 2010/6/21
   If m_blnCallPrint = True Then
      '外部呼叫列印
      '不執行下段else程式
   '2010/6/21 End
   Else
      If cboContact(Index).Tag <> "1" Then
         If cboContact(Index).ListIndex = -1 Then 'Added by Morgan 2022/1/21 2.0 點選也會觸發,增加判斷 .ListIndex = -1
            cboContact(Index) = ""
         End If
      End If
   End If
End Sub

Private Sub cboContact_Click(Index As Integer)
   SetAddress Index
End Sub

Private Sub SetAddress(p_index As Integer)
   Dim stCU01 As String, stCU02 As String, stContNo As String
   Dim oText1 As Object, oText2 As Object, oText3 As Object
   'Modified by Morgan 2022/1/20 改2.0
   'stContNo = Format(cboContact(p_index).ItemData(cboContact(p_index).ListIndex), "00")
   stContNo = Format(PUB_GetItemData(m_strContactList(p_index), cboContact(p_index).ListIndex), "00")
   'end 2022/1/20
   Select Case p_index
      Case 1
         Set oText1 = Text1(12)
         Set oText2 = Text1(25)
         Set oText3 = Text1(26)
      Case 2
         Set oText1 = Text1(28)
         Set oText2 = Text1(41)
         Set oText3 = Text1(42)
      Case 3
         Set oText1 = Text1(44)
         Set oText2 = Text1(57)
         Set oText3 = Text1(58)
      Case 4
         Set oText1 = Text1(60)
         Set oText2 = Text1(73)
         Set oText3 = Text1(74)
      Case 5
         Set oText1 = Text1(76)
         Set oText2 = Text1(89)
         Set oText3 = Text1(90)
   End Select
   If oText1.Text <> "" Then
      stCU01 = Left(oText1.Text, 8)
      stCU02 = Mid(oText1.Text, 9, 1)
      'Modify by Amy 2016/01/08 +IsPcc 是否抓potcustcont for 臺灣地址判斷
      strExc(0) = "select nvl(pcc21,cu30),nvl(pcc22,cu31),Nvl(pcc21,'Y') as IsPcc from customer,potcustcont where cu01='" & stCU01 & "' and cu02='" & stCU02 & "' and pcc01(+)=cu01 and pcc02(+)='" & stContNo & "'"
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 1 Then
         oText2 = "" & RsTemp.Fields(0)
         oText3 = "" & RsTemp.Fields(1)
         intTWAddr(p_index * 2 - 1) = 13 'Add by Amy 2016/01/07 抓取接洽人檔不檢查臺灣地址
      End If
   End If
End Sub

'Add by Amy 2016/06/24
Private Sub cboTitle_Change()
    '修改cboTitle欄清除Check9特殊收據的CheckBox
    '特殊收據frm090801_7的欄位也一併清除
    'Modify by  Amy 2020/02/14 +if
    If bolNotClsVal = False Then
        Check9.Value = 0
        m_stCRL01 = ""
        m_stCRL97 = ""
        m_stCRL98 = ""
        m_stCRL99 = ""
        m_stCRL100 = ""
        m_stCRL101 = ""
        m_stCRL102 = ""
        m_stCRL103 = ""
        m_stCRL104 = ""
        m_stCRL105 = ""
        m_stCRL106 = ""
        m_stCRL107 = ""
        m_stCRL108 = ""
        m_stCRL109 = ""
        m_stCRL110 = ""
        m_stCRL111 = ""
        m_stCRL112 = ""
        m_stCRL113 = ""
        m_stCRL114 = ""
        m_stCRL115 = ""
        m_stCRL116 = ""
        m_stCRL117 = ""
        m_stCRL118 = ""
        m_stCRL120 = ""
        m_stCRL121 = ""
        m_stCRL122 = ""
        m_stCRL123 = ""
        m_stCRL124 = ""
        m_stCRL126 = ""
        m_stCRL127 = ""
        m_stCRL128 = ""
        m_stCRL129 = ""
        m_stCRL130 = ""
        m_stCRL131 = ""
        m_stCRL132 = ""
    End If
End Sub

'Add By Sindy 2024/11/13
Private Sub cboTitle_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
   cboTitle.ToolTipText = cboTitle.Text
End Sub

'Add By Sindy 2013/1/14
Private Sub cboTitle_Validate(Cancel As Boolean)
   If cboTitle.Text = "" Then Exit Sub
   cboTitle.Text = PUB_StringFilter(cboTitle.Text) 'Add By Sindy 2017/12/5 去掉跳行符號
   If Not CheckLengthIsOK(cboTitle, 100, , , True) Then
      cboTitle.SetFocus
      Cancel = True
   End If
End Sub

'Add By Sindy 2022/11/4
Private Sub Check11_Click()
   If Check11.Value = 1 Then
      Check11.BackColor = &H8080FF '紅色
   Else
      Check11.BackColor = &H8000000F '灰色
   End If
End Sub

Private Sub Check12_Click()
   If Check12.Value = 1 Then
      Check12.BackColor = &H80FFFF '黃色
   Else
      Check12.BackColor = &H8000000F '灰色
   End If
End Sub

Private Sub ChkCRL66_Click()
   If ChkCRL66.Value = 1 Then
      ChkCRL66.BackColor = &HC000& '綠色
   Else
      ChkCRL66.BackColor = &H8000000F '灰色
   End If
End Sub

'Add By Sindy 2012/11/12
Private Sub Check2_LostFocus()
   m_strCaseCPM = GetAllCaseCPM(, , , , , m_dblTotRvFee) 'Add By Sindy 2022/9/9 取得案件性質代碼
   
   'If m_blnCallPrint = True Then Exit Sub 'Add By Sindy 2014/7/25
   'If Val(Text1(101)) = 0 And Val(Text1(104)) = 0 And Val(Text1(107)) = 0 And Val(Text1(110)) = 0 Then Exit Sub
   If Val(m_dblTotRvFee) = 0 Then Exit Sub
   
   '收據暫不列印時
   If Check2.Value = 1 Then
      '系統預設為1.送件日
      If Check8(0).Value = 0 And Check8(1).Value = 0 And Check8(2).Value = 0 Then
         Check8(0).Value = 1
         'Modify By Sindy 2023/4/18
         Check8(1).Value = 0
         Check8(2).Value = 0
         '2023/4/18 END
      End If
      arrNation = Split(Me.Combo1(0).Text, " ") '申請國家
      '台灣案,則為送件日
      If arrNation(0) = "000" Then
         Check8(0).Value = 1
         'Modify By Sindy 2023/4/18
         Check8(1).Value = 0
         Check8(2).Value = 0
         '2023/4/18 END
      End If
   Else
      Check8(0).Value = 0
      Check8(1).Value = 0
      Check8(2).Value = 0
   End If
End Sub

'Add By Sindy 2011/6/7
Private Sub Check3_Click(Index As Integer)
   If Check3(Index).Value = 1 Then
      If InStr(Text1(127).Text, Trim(Check3(Index).Caption)) = 0 Then
         If Text1(127).Text = "" Then
            Text1(127).Text = Trim(Check3(Index).Caption)
         Else
            Text1(127).Text = Text1(127).Text & "," & Trim(Check3(Index).Caption)
         End If
      End If
   Else
      '案件屬性=xx,xx,xx
      If Left(Text1(127), Len(Trim(Check3(Index).Caption))) = Trim(Check3(Index).Caption) Then
         Text1(127).Text = Replace(Text1(127).Text, Trim(Check3(Index).Caption) & ",", "")
         Text1(127).Text = Replace(Text1(127).Text, Trim(Check3(Index).Caption), "")
      Else
         Text1(127).Text = Replace(Text1(127).Text, "," & Trim(Check3(Index).Caption), "")
      End If
   End If
End Sub

Private Sub Check4_Click()
   If Check4.Value = 1 Then
      'Modify By Sindy 2015/1/26 經理說生醫案大家均可做電子送件
      'Modify By Sindy 2014/1/10 若智權人員為專利處人員時, 開放生醫案可勾選電子送件
'      If Not (PUB_GetStaffST15(Text1(10), "1") >= "P10" And PUB_GetStaffST15(Text1(10), "1") <= "P14") _
'         And Left(Combo5, 1) = "3" Then
'         MsgBox "生醫案不可電子送件！", vbExclamation
'         Check4.Value = 0
'      End If
   End If
End Sub

'2011/4/22 ADD BY SONIA 現金或支票計算預定收款日
Private Sub Check6_Click(Index As Integer)
   If Check6(0) = 1 Or Check6(1) = 1 Then
      If PUB_GetST06(Text1(10)) <> "1" Then
         Text1(118) = PUB_GetWorkDayAfterSysDate(CDbl(strSrvDate(1)), 6)
      Else
         Text1(118) = PUB_GetWorkDayAfterSysDate(CDbl(strSrvDate(1)), 5)
      End If
      Text1(118).Locked = True
      Text1(118).Enabled = False
   Else
      Text1(118).Locked = False
      Text1(118).Enabled = True
   End If
End Sub
'2011/4/22 END

'Modify By Sindy 2022/9/13
Private Sub Check7_Click(Index As Integer)
   If Index <= 1 Then 'Added by Lydia 2023/11/13
      If Index = 0 Then
         If Check7(0).Value = 1 Then
            Check7(1).Value = 0
         End If
      Else
         If Check7(1).Value = 1 Then
            Check7(0).Value = 0
         End If
      End If
   'Added by Lydia 2023/11/13
   ElseIf Index <= 3 Then 'DEBIT NOTE請款選項
      If Index = 2 Then
         If Check7(2).Value = 1 Then
            Check7(3).Value = 0
         End If
      Else
         If Check7(3).Value = 1 Then
            Check7(2).Value = 0
         End If
      End If
   End If
   'end 2023/11/13
End Sub

'Add By Sindy 2013/11/25
Private Sub Check8_GotFocus(Index As Integer)
   Check8(0).Value = 0
   Check8(1).Value = 0
   Check8(2).Value = 0
End Sub

'Add By Sindy 2014/2/6
Private Sub Check9_Click()
   'Modify by Amy 2016/07/07 +勾DEBIT NOTE 請款,不可勾選特殊收據控制
   If Check9.Value = 1 And Option2(2).Value = False Then
      cmdCRL119.Visible = True
      If m_blnCallPrint = False And Check9.Tag <> "NotShow" Then
         Call cmdCRL119_Click
      End If
      Check9.Tag = ""
   Else
      cmdCRL119.Visible = False
   End If
End Sub

Private Sub ChkAddress_Click(Index As Integer)
Dim i As Integer
  
If ChkAddress(Index).Value = 1 Then
   If InStr(Text1(12), Text3(Index).Tag) > 0 Then
      Text4(Index).Text = "發明人地址同申請人地址"
   ElseIf InStr(Text1(28), Text3(Index).Tag) > 0 Then
      Text4(Index).Text = "發明人地址同申請人地址"
   ElseIf InStr(Text1(44), Text3(Index).Tag) > 0 Then
      Text4(Index).Text = "發明人地址同申請人地址"
   ElseIf InStr(Text1(60), Text3(Index).Tag) > 0 Then
      Text4(Index).Text = "發明人地址同申請人地址"
   ElseIf InStr(Text1(76), Text3(Index).Tag) > 0 Then
      Text4(Index).Text = "發明人地址同申請人地址"
   End If
Else
   Text4(Index).Text = Text4(Index).Tag
End If
End Sub

'Add By Sindy 2011/7/8
'若有舊案申請地址與接洽紀錄單上新址提申不同者
Private Sub CheckAppAddr(Index As Integer)
Dim strApplID As String, strName As String, strAddr As String
   
   If Me.Combo1(0).Text = "" Then Exit Sub
   arrNation = Split(Me.Combo1(0).Text, " ") '申請國家
   
   '新案時,系統別為T或TF,並且非台灣案
   If Option1(0).Value = True And (Text1(6) = "T" Or Text1(6) = "TF") And arrNation(0) <> "000" Then
      strApplID = "": strName = "": strAddr = ""
      Select Case Index
         Case 1
            If Trim(Text1(12)) <> "" Then '申請人1
               strApplID = Trim(Text1(12))
               strName = Trim(Text1(21))
               strAddr = Trim(Text1(120)) & Trim(Text1(27))
            End If
         Case 2
            If Trim(Text1(28)) <> "" Then '申請人2
               strApplID = Trim(Text1(28))
               strName = Trim(Text1(37))
               strAddr = Trim(Text1(121)) & Trim(Text1(43))
            End If
         Case 3
            If Trim(Text1(44)) <> "" Then '申請人3
               strApplID = Trim(Text1(44))
               strName = Trim(Text1(53))
               strAddr = Trim(Text1(122)) & Trim(Text1(59))
            End If
         Case 4
            If Trim(Text1(60)) <> "" Then '申請人4
               strApplID = Trim(Text1(60))
               strName = Trim(Text1(69))
               strAddr = Trim(Text1(123)) & Trim(Text1(75))
            End If
         Case 5
            If Trim(Text1(76)) <> "" Then '申請人5
               strApplID = Trim(Text1(76))
               strName = Trim(Text1(85))
               strAddr = Trim(Text1(124)) & Trim(Text1(91))
            End If
      End Select
      If strApplID <> "" And strAddr <> "" Then
         If ChkOCaseAndCAddrNotAlikeChoose(strApplID, arrNation(0), Text1(6), "", rsAddrNotAlike, False) = True Then
            Me.m_AppAddr = ""
            Me.m_Zipcode = ""
            Set frm090801_4.UpForm = Me
            frm090801_4.Label2 = strApplID
            frm090801_4.lblName = strName
            frm090801_4.strAddr = strAddr
            If Index = 1 Then frm090801_4.Label1(1) = "申請人1："
            If Index = 2 Then frm090801_4.Label1(1) = "申請人2："
            If Index = 3 Then frm090801_4.Label1(1) = "申請人3："
            If Index = 4 Then frm090801_4.Label1(1) = "申請人4："
            If Index = 5 Then frm090801_4.Label1(1) = "申請人5："
            If frm090801_4.QueryData = True Then
               Me.Hide
               frm090801_4.Show vbModal
               If Me.m_AppAddrChange = True Then
                  Select Case Index
                     Case 1
                        Me.Text1(120) = Me.m_Zipcode
                        Me.Text1(27) = Me.m_AppAddr
                        Me.Text1(125) = ""
                     Case 2
                        Me.Text1(121) = Me.m_Zipcode
                        Me.Text1(43) = Me.m_AppAddr
                        Me.Text1(141) = ""
                     Case 3
                        Me.Text1(122) = Me.m_Zipcode
                        Me.Text1(59) = Me.m_AppAddr
                        Me.Text1(157) = ""
                     Case 4
                        Me.Text1(123) = Me.m_Zipcode
                        Me.Text1(75) = Me.m_AppAddr
                        Me.Text1(173) = ""
                     Case 5
                        Me.Text1(124) = Me.m_Zipcode
                        Me.Text1(91) = Me.m_AppAddr
                        Me.Text1(189) = ""
                  End Select
               End If
            End If
         End If
      End If
   End If
End Sub

'Added by Morgan 2013/1/15
Private Sub chkItem_Click(Index As Integer)
   Dim ii As Integer
   
   'Add By Sindy 2023/3/23 Form Load Read Error : Mark
   If Not Me.ActiveControl Is Nothing Then
   '2023/3/23 END
      If Me.ActiveControl <> chkItem(Index) Then Exit Sub
   End If
   
   txtItemCount.Enabled = False
   txtItemList.Enabled = False
   txtYear(0).Enabled = False
   txtYear(1).Enabled = False
   txtMonth(0).Enabled = False
   txtMonth(1).Enabled = False
   txtDay(0).Enabled = False
   txtDay(1).Enabled = False
   
   If Index = 0 Or Index = 1 Then
      If chkItem(Index).Value = vbChecked Then
         For Each oChk In chkItem
            If oChk.Index <> Index Then
               oChk.Value = vbUnchecked
            End If
         Next
         
         Select Case Index
         Case 0
            txtItemCount.Enabled = True
            txtItemCount.SetFocus
         Case 1
            txtItemList.Enabled = True
            txtItemList.SetFocus
            If Left(txtItemList, 1) = "第" Then
               txtItemList.SelStart = 1
               txtItemList.SelLength = 0
            End If
         End Select
      End If
   ElseIf Index = 6 Then
      If chkItem(Index).Value = vbChecked Then
         For Each oChk In chkItem
            If oChk.Index <> Index Then
               oChk.Value = vbUnchecked
            End If
         Next
         txtYear(0).Enabled = True
         txtYear(0).SetFocus
         txtYear(1).Enabled = True
         txtMonth(0).Enabled = True
         txtMonth(1).Enabled = True
         txtDay(0).Enabled = True
         txtDay(1).Enabled = True
      End If
   ElseIf chkItem(Index).Value = vbChecked Then
      chkItem(0).Value = vbUnchecked
      chkItem(1).Value = vbUnchecked
      chkItem(6).Value = vbUnchecked
   End If
End Sub

Private Sub cmd146_Click()
Dim nFrm As Form
   
   '外部呼叫應收帳款查詢
   Set nFrm = Forms(0).GetForm("frm210146")
   If Not nFrm Is Nothing Then
      Load nFrm
      Call nFrm.CallQueryData(Text1(10).Text, Left(Text1(12).Text, 8), Left(Text1(28).Text, 8), Left(Text1(44).Text, 8), Left(Text1(60).Text, 8), Left(Text1(76).Text, 8))
   End If
   
   Set nFrm = Nothing
End Sub

'Add By Sindy 2014/7/18 新增附件
'Modify By Sindy 2022/10/11
Private Sub cmdAddAtt_Click()
   '若為舊案
   If Me.Option1(1).Value = True And Me.Text1(6).Text <> "" And Me.Text1(7).Text <> "" Then
       If Me.Text1(8).Text = "" Then Me.Text1(8).Text = "0"
       If Me.Text1(9).Text = "" Then Me.Text1(9).Text = "00"
   End If
   
   'Add By Sindy 2023/2/18
   If cmdAddAtt.Caption = "卷宗區" Then
      Screen.MousePointer = vbHourglass
      frm100101_L.m_strKey = GridCase.TextMatrix(1, 7) '第一筆的總收文號
      frm100101_L.m_CPP11 = Text5 '電子表單單號
      frm100101_L.SetParent Me
      If frm100101_L.QueryData = True Then
         frm100101_L.Show
         Me.Hide
      Else
         Unload frm100101_L
      End If
      Screen.MousePointer = vbDefault
      Exit Sub
   End If
   '2023/2/18 END
   
   Call frm090801_13.SetParent(Me)
   If Option1(0).Value = True Then
      frm090801_13.bolNewCase = True '是新案
   Else
      frm090801_13.bolNewCase = False
   End If
   If Text5.Visible = True Then
      frm090801_13.m_strCRL01 = Text5
   Else
      frm090801_13.m_strCRL01 = ""
   End If
   frm090801_13.m_blnCallQuery = m_blnCallPrint '查詢
   frm090801_13.strCaseNA239 = strCaseNA239
   frm090801_13.lblCaseNo = Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9)
   frm090801_13.m_strSaveFiles = Me.m_strSaveFiles
   frm090801_13.m_strSaveFiles2 = Me.m_strSaveFiles2
   If UCase(TypeName(m_PrevForm)) = UCase("frm210148") Then
      frm090801_13.cmdAddAtt(0).Enabled = False
      frm090801_13.cmdAddAtt(1).Enabled = False
      frm090801_13.cmdRemAtt(0).Enabled = False
      frm090801_13.cmdRemAtt(1).Enabled = False
   End If
   Call frm090801_13.QueryData(True)
   frm090801_13.Show vbModal
   If Me.m_strSaveFiles = "" And Me.m_strSaveFiles2 = "" Then
      Me.cmdAddAtt.BackColor = &H808080 '灰色
   Else
      Me.cmdAddAtt.BackColor = &HC0C0FF '粉紅色
   End If
End Sub

'Add By Sindy 2014/2/6
Private Sub cmdCRL119_Click()
   frm090801_7.SetParent Me
   'Add by Amy 2016/09/01
   frm090801_7.stCaseNo1 = Text1(6)
   frm090801_7.stCaseNo2 = Text1(7)
   frm090801_7.stCaseNo3 = Text1(8)
   frm090801_7.stCaseNo4 = Text1(9)
   'end 2016/09/01
   frm090801_7.m_stCRL01 = m_stCRL01
   frm090801_7.m_stCRL97 = m_stCRL97
   frm090801_7.m_stCRL98 = m_stCRL98
   frm090801_7.m_stCRL99 = m_stCRL99
   frm090801_7.m_stCRL100 = m_stCRL100
   frm090801_7.m_stCRL101 = m_stCRL101
   frm090801_7.m_stCRL102 = m_stCRL102
   frm090801_7.m_stCRL103 = m_stCRL103
   frm090801_7.m_stCRL104 = m_stCRL104
   frm090801_7.m_stCRL105 = m_stCRL105
   frm090801_7.m_stCRL106 = m_stCRL106
   frm090801_7.m_stCRL107 = m_stCRL107
   frm090801_7.m_stCRL108 = m_stCRL108
   frm090801_7.m_stCRL109 = m_stCRL109
   frm090801_7.m_stCRL110 = m_stCRL110
   frm090801_7.m_stCRL111 = m_stCRL111
   frm090801_7.m_stCRL112 = m_stCRL112
   frm090801_7.m_stCRL113 = m_stCRL113
   frm090801_7.m_stCRL114 = m_stCRL114
   frm090801_7.m_stCRL115 = m_stCRL115
   frm090801_7.m_stCRL116 = m_stCRL116
   frm090801_7.m_stCRL117 = m_stCRL117
   frm090801_7.m_stCRL118 = m_stCRL118
   frm090801_7.m_stCRL120 = m_stCRL120
   frm090801_7.m_stCRL121 = m_stCRL121
   frm090801_7.m_stCRL122 = m_stCRL122
   frm090801_7.m_stCRL123 = m_stCRL123
   frm090801_7.m_stCRL124 = m_stCRL124
   frm090801_7.m_stCRL126 = m_stCRL126
   frm090801_7.m_stCRL127 = m_stCRL127
   frm090801_7.m_stCRL128 = m_stCRL128
   frm090801_7.m_stCRL129 = m_stCRL129
   frm090801_7.m_stCRL130 = m_stCRL130
   frm090801_7.m_stCRL131 = m_stCRL131
   frm090801_7.m_stCRL132 = m_stCRL132
   'Modify By Sindy 2019/6/24 隱藏的順序有差
   frm090801_7.Show vbModal
   'Me.Hide 'Modify By Sindy 2023/11/27 mark
   '2019/6/24 END
End Sub

'Add By Sindy 2022/9/13 對造為本所客戶
Private Sub cmdCRL134_Click()
'   frm090801_9.SetParent Me
'   If m_blnCallPrint = True Then frm090801_9.m_blnCallQuery = True
'   frm090801_9.Show vbModal
'   If m_stCRL134 = "" And m_stCRL135 = "" Then
'      Check7(0).Value = 0
'   End If
End Sub

'Add By Sindy 2022/10/20
'本案與總號
Private Sub cmdCRL55_Click()
Dim arrVar As Variant, jj As Integer

   '讀取資料
   lstCase.Clear
   Me.txtSystem.Text = ""
   Me.txtCode(0).Text = ""
   Me.txtCode(1).Text = ""
   Me.txtCode(2).Text = ""
   If Text1(100) <> "" Then
      arrVar = Split(Text1(100).Text, ",")
      For jj = 0 To UBound(arrVar)
         lstCase.AddItem arrVar(jj)
      Next jj
   End If
   
   FrameCase.Visible = True
   txtSystem.SetFocus
End Sub
'本案與總號-確定
Private Sub cmdCRL55_OK_Click()
Dim idx As Integer
Dim strCP01 As String, strCP02 As String, strCP03 As String, strCP04 As String
Dim strAddCase As String, bolChk As Boolean

   If txtSystem.Text <> "" And txtCode(0).Text <> "" Then
      '檢查案號
      strCP01 = txtSystem.Text
      strCP02 = Format(txtCode(0).Text, "000000")
      If Trim(txtCode(1).Text) = "" Then
         strCP03 = 0
      Else
         strCP03 = txtCode(1).Text
      End If
      strCP03 = Format(strCP03, "0")
      If Trim(txtCode(2).Text) = "" Then
         strCP04 = 0
      Else
         strCP04 = txtCode(2).Text
      End If
      strCP04 = Format(strCP04, "00")
      
      strAddCase = strCP01 & "-" & strCP02 & _
         IIf(strCP03 & strCP04 <> "000", "-" & strCP03 & "-" & strCP04, "")
      bolChk = False
      For idx = 0 To lstCase.ListCount - 1
         If lstCase.List(idx) = strAddCase Then
            bolChk = True
            Exit For
         End If
      Next
      If bolChk = False Then
         If MsgBox("此案號尚未加入，確定放棄要【離開】此編輯區嗎？", vbYesNo + vbCritical + vbDefaultButton2, "詢問") = vbNo Then
            Exit Sub
         End If
      End If
   End If
   
   '更新欄位值
   Text1(100) = ""
   For idx = 0 To lstCase.ListCount - 1
      Text1(100) = Text1(100) & "," & lstCase.List(idx)
   Next
   If Text1(100) <> "" Then Text1(100) = Mid(Text1(100), 2)
   
   FrameCase.Visible = False
End Sub

Private Sub Combo1_GotFocus(Index As Integer)
   'Add By Sindy 2024/12/6
   If Index = 1 Then
      Call frm090801_New_SetComboCase(Index, Combo1(Index).Text, Combo1(Index), Me.Text1(6).Text, _
                     Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
   End If
End Sub

Private Sub lstCase_Click()
Dim strCase(1 To 4) As String
Dim idx As Integer
   
   '選取
   If lstCase.ListCount > 0 Then
      For idx = 0 To lstCase.ListCount - 1
         If lstCase.Selected(idx) = True Then
            ChgCaseNo Replace(Trim(lstCase.List(idx)), "-", ""), strCase
            Me.txtSystem.Text = strCase(1)
            Me.txtCode(0).Text = strCase(2)
            Me.txtCode(1).Text = strCase(3)
            Me.txtCode(2).Text = strCase(4)
         End If
      Next
   End If
End Sub

Private Sub txtSystem_GotFocus()
   CloseIme
   
   If txtSystem.Enabled = True Then
      txtSystem.SetFocus
      txtSystem.SelStart = 0
      txtSystem.SelLength = Len(txtSystem)
   End If
End Sub
Private Sub txtSystem_KeyPress(KeyAscii As Integer)
   KeyAscii = UpperCase(KeyAscii)
End Sub
Private Sub txtCode_GotFocus(Index As Integer)
   CloseIme
   
   txtCode(Index).SelStart = 0
   txtCode(Index).SelLength = Len(txtCode(Index))
End Sub
Private Sub txtCode_KeyPress(Index As Integer, KeyAscii As Integer)
   KeyAscii = UpperCase(KeyAscii)
End Sub
'加入
Private Sub cmdAdd_Click()
Dim strCP01 As String, strCP02 As String, strCP03 As String, strCP04 As String
Dim idx As Integer, bFound As Boolean
Dim strUserId As String, strAddCase As String
   
   If txtSystem.Text = "" Or txtCode(0).Text = "" Then
      MsgBox "本所案號不可空白！", vbExclamation
      Exit Sub
   End If
   
   strCP01 = txtSystem.Text
   strCP02 = Format(txtCode(0).Text, "000000")
   If Trim(txtCode(1).Text) = "" Then
      strCP03 = 0
   Else
      strCP03 = txtCode(1).Text
   End If
   strCP03 = Format(strCP03, "0")
   If Trim(txtCode(2).Text) = "" Then
      strCP04 = 0
   Else
      strCP04 = txtCode(2).Text
   End If
   strCP04 = Format(strCP04, "00")
   
   '檢查是否重覆
   strAddCase = strCP01 & "-" & strCP02 & _
      IIf(strCP03 & strCP04 <> "000", "-" & strCP03 & "-" & strCP04, "")
   For idx = 0 To lstCase.ListCount - 1
      If lstCase.List(idx) = strAddCase Then
         MsgBox "案號重覆！", vbExclamation
         Exit Sub
      End If
   Next
   '檢查案號
   Call PUB_CaseClosed(strCP01, strCP02, strCP03, strCP04, bolCaseIsExists, False)
   If bolCaseIsExists = False Then
      Exit Sub
   End If
   
   lstCase.AddItem strAddCase
   txtSystem.Text = ""
   txtCode(0).Text = ""
   txtCode(1).Text = ""
   txtCode(2).Text = ""
   txtSystem.SetFocus
End Sub
'移除
Private Sub cmdRemove_Click()
Dim idx As Integer, ii As Integer
   
   If lstCase.ListCount > 0 Then
      For idx = lstCase.ListCount - 1 To 0 Step -1
         If lstCase.Selected(idx) = True Then
            lstCase.RemoveItem idx
            txtSystem = ""
            txtCode(0) = ""
            txtCode(1) = ""
            txtCode(2) = ""
         End If
      Next
   End If
   
   txtSystem.SetFocus
End Sub
'2022/10/20 END

'Add By Sindy 2022/10/3
'刪除接洽單及簽核流程
Private Sub cmdDelCRL_Click()
   '防止程式沒控管好，增加檢查此條件
   If Me.LblRecved.Visible = True Then
      MsgBox "已收文，不可再此刪除！" & vbCrLf & vbCrLf & "請通知電腦中心有此狀況（未鎖到按鍵）！謝謝∼∼", vbExclamation, "警告"
      Exit Sub
   End If
   
   If MsgBox("確定要刪除此筆接洽單資料嗎？", vbYesNo + vbCritical + vbDefaultButton2, "詢問") = vbNo Then
      Exit Sub
   End If
   
   If PUB_DelCRLAllData(Text5) = False Then
      Exit Sub
   End If
   
   Unload Me
End Sub

'Add By Sindy 2022/12/12 沒有接洽單簽核主管設定者不可操作接洽單
Public Function ChkSetflow() As Boolean
   
   ChkSetflow = True
   
   '主管-案件簽核作業
   '不用檢查此設定
   If UCase(TypeName(m_PrevForm)) = UCase("frm210148") Then Exit Function
   
   If Len(Trim(Text1(10))) > 0 Then
      strExc(0) = "SELECT * FROM flow001 WHERE f0101='" & Text1(10) & "' and f0102='3'"
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 0 Then
         ChkSetflow = False
         MsgBox lblStaffName.Caption & "(" & Text1(10) & ")沒有接洽單簽核主管設定者，不可操作接洽單！", vbExclamation + vbOKOnly
         Me.SSTab1.Tab = 0
         If Text1(10).Visible = True Then Text1(10).SetFocus
         Exit Function
      End If
   End If
   
   '專利處程序
   If Pub_StrUserSt03 = "P12" Then
      strExc(0) = "SELECT * FROM flow001 WHERE f0101='" & strUserNum & "' and f0102='3'"
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 0 Then
         ChkSetflow = False
         MsgBox lblStaffName.Caption & "(" & strUserNum & ")沒有接洽單簽核主管設定者，不可操作接洽單！", vbExclamation + vbOKOnly
         Me.SSTab1.Tab = 0
         Exit Function
      End If
   End If
End Function

Public Sub cmdok_Click(Index As Integer)
Dim j As Integer, ii As Integer, jj As Integer
'add by nickc 2005/05/27
Dim strCP10(1 To 4) As String
Dim temp() As String, bQuery As Boolean 'Add Sindy 2014/10/31
Dim iChkIndex As Integer 'Added by Morgan 2020/4/22
'Dim lngFee As Long 'Added by Morgan 2020/5/27
Dim arrCP10() As String 'Added by Morgan 2020/6/15
Dim bolPrintPT As Boolean 'Added by Morgan 2020/6/20 是否列印P/T案
Dim strShowType As String 'Added by Morgan 2020/6/22 顯示案源類型
Dim bolCancel As Boolean
Dim varTemp As Variant
Dim Cancel As Boolean
Dim strTo As String, arrTmp 'Add by Amy 2025/07/21
      
   'add by nickc 2006/07/19
   Is308New = False
   Is308Old = False
   intCN308Field = 0 'Add by Amy 2014/10/08
   'add by nickc 2008/02/13
   NowCount = 0
   CountBy307308 = "1" 'Modify By Sindy 2016/2/17 此變數預設值移至此處
   
    Select Case Index
    Case 1 '結束
         'Added by Morgan 2020/5/28
         If strLOS18 <> "" Then
            If MsgBox("介紹案源之法務案尚未輸入完成，是否確定要結束???", vbYesNo + vbDefaultButton2 + vbQuestion) = vbNo Then
               Exit Sub
            End If
            
         ElseIf strLOS15 <> "" Then
            If strLOS17 <> "" Then
               If MsgBox("本單為【B1案源】的 P/T案 接洽單且尚未操作完畢，是否確定要結束???", vbYesNo + vbDefaultButton2 + vbQuestion) = vbNo Then
                  Exit Sub
               End If
            ElseIf strPTCP10 <> "" Then
               If MsgBox("補填【" & SrcGetProperty(Text1(6), strPTCP10) & "】接洽單尚未操作完畢，是否確定要結束???", vbYesNo + vbDefaultButton2 + vbQuestion) = vbNo Then
                  Exit Sub
               End If
            End If
         End If
         'end 2020/5/28
         
         Unload Me
         
    Case 2 '清除畫面
         'add by nickc 2007/08/29 中所智權人員會不小心按到，所以薛就說要詢問
         'Modified by Morgan 2020/5/28
         'If MsgBox("是否清除畫面???", vbExclamation + vbYesNo) = vbYes Then
         intI = 0
         If strLOS18 <> "" Then
            intI = MsgBox("介紹案源之法務案尚未輸入完成，是否確定清除畫面???", vbYesNo + vbDefaultButton2 + vbQuestion)
         ElseIf strLOS15 <> "" And strLOS17 <> "" Then
            'Modify By Sindy 2022/10/6
            'intI = MsgBox("本單為【B1案源】的 P/T案 接洽單且尚未列印，是否確定要結束???", vbYesNo + vbDefaultButton2 + vbQuestion)
            intI = MsgBox("本單為【B1案源】的 P/T案 接洽單且尚未新增，是否確定要結束???", vbYesNo + vbDefaultButton2 + vbQuestion)
            '2022/10/6 END
         ElseIf strLOS15 <> "" And strPTCP10 <> "" Then
            'Modify By Sindy 2022/10/6
            'intI = MsgBox("補填【" & SrcGetProperty(Text1(6), strPTCP10) & "】接洽單尚未列印，是否確定要結束???", vbYesNo + vbDefaultButton2 + vbQuestion)
            intI = MsgBox("補填【" & SrcGetProperty(Text1(6), strPTCP10) & "】接洽單尚未新增，是否確定要結束???", vbYesNo + vbDefaultButton2 + vbQuestion)
            '2022/10/6 END
         Else
            intI = MsgBox("是否清除畫面???", vbExclamation + vbYesNo)
         End If
         If intI = vbYes Then
            SrcLOSReset
         'end 2020/5/28
            Call cmdClear 'Modify By Sindy 2010/6/21
         End If
    'Add By Sindy 2010/4/6
    Case 3 '期限資料
         '若為舊案
         If Me.Option1(1).Value = True And Me.Text1(6).Text <> "" And Me.Text1(7).Text <> "" Then
            Call CallFrm090801_2
         End If
    'Add By Sindy 2010/6/21
    Case 4 '查詢
         Screen.MousePointer = vbHourglass
         Call cmdClear(True)
         '***** 一定要下,強制表單不能再呼叫非強制表單 *****
'         Check7(0).Tag = "NotShow"
         Check9.Tag = "NotShow"
         '*****
         Call QueryData
         If m_blnCallPrint = True Then
            Call SetCtrlReadOnly(True) 'Add By Sindy 2022/9/21
            Call SetCtrlReadOnly_Flow(True) 'Add By Sindy 2022/9/21
            Label1(36).Visible = False 'Add By Sindy 2023/6/14 第4欄跳離開才帶圖
            cmdOK(0).Visible = False '新增/修改
            cmdOK(1).Visible = True: cmdOK(1).Enabled = True '結束
            cmdOK(2).Visible = False '清除畫面
            If InStr(UCase(Text1(6).Text), "L") > 0 And PUB_ChkLCompStaff(Text1(10).Text) = False Then
               cmdOK(5).Caption = "案源(&I)"
               cmdOK(5).Visible = True
'               'Add By Sindy 2024/9/24
               Label1(123).Visible = False
'               '2024/9/24 END
            Else
               cmdOK(5).Visible = False '案源輸入(&I)
            End If
         Else
            If InStr(UCase(Text1(6).Text), "L") > 0 And PUB_ChkLCompStaff(Text1(10).Text) = False Then
'               Call SetCtrlReadOnly(True) 'Modify By Sindy 2024/9/24 Mark
'               'Call SetCtrlReadOnly_Flow(True)
            Else
               'SrcLOSReset 'Add By Sindy 2022/12/25 'Modify By Sindy 2024/9/25 Mark
               '某些欄位應該鎖住
               Text1(6).Enabled = False
               Text1(7).Enabled = False
               Text1(8).Enabled = False
               Text1(9).Enabled = False
               Option1(0).Enabled = False: Option1(1).Enabled = False
               'cmdDel.Enabled = False
               'cmdClear2.Enabled = False
            End If
            SrcSetButton 'Added by Morgan 2020/4/17
         End If
         Screen.MousePointer = vbDefault
         
    'Modified by Morgan 2020/4/22 +介紹案源 5
    'Case 0 '列印
    Case 0, 5 '新增, 案源輸入/案源
         strIDRepeat = "": strReSetCust = "" 'Add by Amy 2025/07/21
         If ChgCusDis = True Then Exit Sub 'Added by Morgan 2023/4/18 P案領證、年費減免身分變更檢查
         
         If ChkSetflow = False Then Exit Sub 'Add By Sindy 2022/9/14 沒有接洽單簽核主管設定者不可操作接洽單
         
         If ChkGridCaseIsOK = False Then Exit Sub 'Add By Sindy 2022/10/21
         
         'Add By Sindy 2024/1/25
         Call txtF0306_Validate(Cancel)
         If Cancel = True Then
            Exit Sub
         End If
         '2024/1/25 END
         
         'Added by Lydia 2024/10/07 商標案針對商標文字欄位中，若未填寫內容進行檢核，以利跳出提醒---杜協理
         'Modified by Lydia 2025/04/01 再重新調整，僅有查名/查覆區進入收文的狀況，才出現此須填寫的資訊，若為正常收文路徑進行收文的案件，請勿出現此檢查功能。
         'If (opt1(0).Value = True Or opt1(4).Value = True) And InStr(Text1(6), "T") > 0 And Trim(PicText.Text) = "" And PicText.Enabled = True And Left(Trim(Combo1(0)), 3) = "000" Then
         If (opt1(0).Value = True Or opt1(4).Value = True) And InStr(Text1(6), "T") > 0 And Trim(PicText.Text) = "" And PicText.Enabled = True And Left(Trim(Combo1(0)), 3) = "000" _
              And (cmdTMQ.Tag <> "" Or pTMQList <> "") Then
            MsgBox "請輸入商標文字!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 4
            Exit Sub
         End If
         'end 2024/10/07
         
         m_strCaseCPM = GetAllCaseCPM(m_bolNewCase, , m_strNewCP10, m_bolHad10Point, m_dblTotOFee, m_dblTotRvFee, m_dbltotPoint) 'Add By Sindy 2022/9/6 取得案件性質代碼
         'Add By Sindy 2024/11/15 檢查連動的案件性質
         If ChkCaseNationRcv = False Then
            Exit Sub
         End If
         '2024/11/15 END
         strSalesDep = PUB_GetST03(Text1(10))
         iChkIndex = 0
         'end 2020/4/22
         m_strLiveProofMemo = "" 'Added by Morgan 2012/11/23
         m_bolAdd803Memo = False 'Added by Morgan 2013/1/15
'         strMemoPrt = "" 'Added by Lydia 2016/05/27
         
'**********
         'Add By Sindy 2022/10/3 A類法律案源(m_blnCallPrint = True)重送
         If Index = 0 And cmdOK(0).Caption = "重送" And m_blnCallPrint = True Then
            On Error GoTo CheckingErr
            Screen.MousePointer = vbHourglass
            cnnConnection.BeginTrans
            strSql = "update FLOW003 set F0306='" & txtF0306 & "',F0316='" & Text1(10) & "' where F0301='" & Text5 & "'"
            cnnConnection.Execute strSql, intI
            '送出表單
            If PUB_AddConsultRecvFlow(Text5, IIf(cmdOK(0).Caption = "重送", True, False)) = False Then
               GoTo CheckingErr
            End If
            cnnConnection.CommitTrans
            PUB_SendMailCache '發信
            Screen.MousePointer = vbDefault
            Unload Me
            Exit Sub
         End If
         '2022/10/3 END
'**********
         
'****************************************************
'下列程式段若是外部呼叫(m_blnCallPrint=True)時, 不執行
''m_blnCallPrint=False Start
'****************************************************
         If m_blnCallPrint = False Then 'Added by Morgan 2020/6/22 從下面移上來
            'Modify By Sindy 2023/4/19 Mark:新增時有負點數,後來修改後存檔,訊息需重整(接洽單:1120007283)
'            'Modify By Sindy 2023/3/1
'            If cmdOK(0).Caption <> "存檔" Then
'            '2023/3/1 END
               txtCRL69 = "": txtCRL70 = "" 'Add By Sindy 2022/10/18
'            End If
            
            'Added by Morgan 2022/1/22 檢查畫面輸入欄位是否含有Unicode文字
            If PUB_ChkUniText(Me, , True) = False Then
               Exit Sub
            End If
            'end 2022/1/22
            
            'Added by Morgan 2020/4/29
            If Index = 5 Then
               If Text1(119) = "" Then
                  MsgBox "請輸入介紹案源內容(案件說明處理事項)！", vbExclamation
                  Screen.MousePointer = vbDefault
                  SSTab1.Tab = 2
                  Exit Sub
               End If
               If SrcCheckSameCust(strLOS18) = False Then
                  Screen.MousePointer = vbDefault
                  Exit Sub
               End If
               
               'Add By Sindy 2022/9/28
               If Text1(6) = "L" And Text1(7) = "888888" Then
                  '檢查費用必須為 0
                  If SrcZoroFeeChk() = False Then
                     MsgBox "費用必須為 0，不可收費！", vbExclamation
                     Screen.MousePointer = vbDefault
                     Exit Sub
                  End If
               End If
               '2022/9/28 END
               
               'B2類案源要檢查規費
               If strLSourceType = "B2" Then
   '               For ii = 1 To 4
   '                  lngFee = lngFee + Val(Text1(102 + 3 * (ii - 1)))
   '               Next
   '
   '               If lngFee < lngPTOFee Then
                  If m_dblTotOFee < lngPTOFee Then
                     Screen.MousePointer = vbDefault
                     MsgBox "規費不可少於" & lngPTOFee & "(P/T案規費)！", vbExclamation
                     SSTab1.Tab = 0
                     Text1(102).SetFocus
                     Exit Sub
                  End If
                  'Add By Sindy 2025/4/14 費用
                  If InStr(Trim(GridCase.TextMatrix(1, 5)), "低底") > 0 Then GridCase.TextMatrix(1, 5) = Replace(GridCase.TextMatrix(1, 5), "低底", "")
                  If m_dblTotRvFee < lngPTcost Then
                     If Len(Trim(GridCase.TextMatrix(1, 5))) = 0 Then
                        GridCase.TextMatrix(1, 5) = "低底"
                     ElseIf InStr(Trim(GridCase.TextMatrix(1, 5)), "低底") = 0 Then
                        GridCase.TextMatrix(1, 5) = Trim(GridCase.TextMatrix(1, 5)) & ",低底"
                     End If
                     m_strCRL146 = Format((lngPTcost - m_dblTotRvFee) / 1000, "####0.000")
                     m_Msgbox = "點數低於底價"
                     If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
                        txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
                     End If
'                     Screen.MousePointer = vbDefault
'                     MsgBox "費用不可少於" & lngPTcost & "(P/T案費用)！", vbExclamation
'                     SSTab1.Tab = 0
'                     Text1(101).SetFocus
'                     Exit Sub
                  End If
                  '2025/4/14 END
               End If
               
               'Added by Morgan 2020/6/5 C類案源也不要輸金額(收款系統依規則分配)
               'Removed by Morgan 2021/7/19 取消 C類案源
               'If strLSourceType = "C" Then
               '   If SrcZoroFeeChk() = False Then
               '      SSTab1.Tab = 0
               '      Text1(101).SetFocus
               '      Exit Sub
               '   End If
               'End If
               'end 2021/7/19
               
            '案源輸入法務案或已有案源後補填配合開庭
            ElseIf strLOS15 <> "" Then
               '檢查收文性質
               If strPTCP10 <> "" Then
                  arrCP10 = Split(strPTCP10, ",")
                  ii = 5 'Add By Sindy 2022/9/8
                  For jj = 0 To UBound(arrCP10)
                     If arrCP10(jj) <> "" Then
   '                     For ii = 1 To 4
   '                        If InStr(Combo1(ii), arrCP10(jj)) > 0 Then
   '                           Exit For
   '                        End If
   '                     Next
                        If InStr(m_strCaseCPM, arrCP10(jj)) > 0 Then
                           ii = 1
                           Exit For
                        End If
                     End If
                  Next
                  If ii = 5 Then
                     MsgBox "請收文【" & SrcGetProperty(Text1(6), strPTCP10) & "】！", vbExclamation
                     Screen.MousePointer = vbDefault
                     Exit Sub
                  End If
               End If
               
               If Left(strLSourceType, 1) = "B" Then
                  '檢查費用必須為 0
                  If SrcZoroFeeChk() = False Then
                     MsgBox "費用必須為 0，不可收費！", vbExclamation 'Add By Sindy 2022/9/30
                     Screen.MousePointer = vbDefault
                     Exit Sub
                  End If
               End If
               
               '檢查申請人
               If strLOS17 <> "" Then
                  If SrcCheckSameCust(strLOS17) = False Then
                     Screen.MousePointer = vbDefault
                     Exit Sub
                  End If
                  
               ElseIf SrcCheckSameCust(strLOS18) = False Then
                  Screen.MousePointer = vbDefault
                  Exit Sub
               End If
               
            End If
            'end 2020/4/29

            'Add Sindy 2014/10/31
            If Me.Option1(1).Value = True Then '舊案才檢查
               If Text1(6) <> "" And Text1(7) <> "" Then
                  '依本所案號讀取基本檔案
                  Select Case Text1(6)
                     ' 讀取商標基本檔
                     Case "T", "TF", "CFT", "FCT":
                        ReDim Preserve temp(TF_TM) As String
                        bQuery = PUB_ReadTradeMarkData(temp(), Text1(6), Text1(7), Text1(8), Text1(9))
                     ' 讀取專利基本檔
                     Case "P", "CFP", "FCP":
                        ReDim Preserve temp(TF_PA) As String
                        bQuery = PUB_ReadPatentData(temp(), Text1(6), Text1(7), Text1(8), Text1(9))
                     ' 讀取法務基本檔
                     'Modify By Sindy 2009/07/24 增加LIN系統類別
                     'modify by sonia 2019/7/30 +ACS系統類別
                     Case "L", "CFL", "FCL", "LIN", "ACS":
                        ReDim Preserve temp(TF_LC) As String
                        bQuery = PUB_ReadLawCaseData(temp(), Text1(6), Text1(7), Text1(8), Text1(9))
                     ' 讀取顧問案件基本檔
                     Case "LA":
                        ReDim Preserve temp(TF_HC) As String
                        bQuery = PUB_ReadHireCaseData(temp(), Text1(6), Text1(7), Text1(8), Text1(9))
                     ' 讀取服務業務基本檔
                     Case Else:
                        ReDim Preserve temp(tf_SP) As String
                        bQuery = PUB_ReadServicePracticeData(temp(), Text1(6), Text1(7), Text1(8), Text1(9))
                  End Select
                  If bQuery = False Then
                     ShowMsg MsgText(9141)
                     Screen.MousePointer = vbDefault
                     SSTab1.Tab = 0
                     Exit Sub
                  End If
               End If
               '2014/10/31 END
            End If
            
'            'Add By Sindy 2023/4/7
'            If ChkCRL152.Value = 1 Then
'               If MsgBox("已勾選〔自行送簽核〕是否繼續作業？", vbQuestion + vbYesNo + vbDefaultButton2, "要呈報主管") = vbNo Then
'                  Screen.MousePointer = vbDefault
'                  SSTab1.Tab = 0
'                  Exit Sub
'               End If
'            End If
'            '2023/4/7 END
            
            'Add By Sindy 2010/5/27
            If OptChoose(0).Visible = True Then
               If OptChoose(0).Value = False And OptChoose(1).Value = False Then
                  MsgBox "請點選記錄單種類!!!", vbExclamation + vbOKOnly
                  Screen.MousePointer = vbDefault
                  SSTab1.Tab = 0
                  Exit Sub
               End If
            End If
            
            '新案
            'Add by Amy 2016/06/06 專利設計案控制
            'Modify by Amy 2016/07/25 +if 新案才判斷 (ex:P113878 案件屬性601不彈)
            If Option1(0).Value = True Then
               'Add By Sindy 2024/9/4 CF案申請國家不可為台灣
               If Left(Trim(Text1(6)), 2) = "CF" And Left(Trim(Combo1(0).Text), 3) = "000" Then
                  MsgBox "CF案申請國家不可為台灣！", vbExclamation
                  Screen.MousePointer = vbDefault
                  SSTab1.Tab = 0
                  If Combo1(0).Visible = True Then Me.Combo1(0).SetFocus
                  Exit Sub
               End If
               '2024/9/4 END
               
               If Left(Label1(124).Caption, 4) = "專利種類" And Left(Combo6, 1) = "3" Then
                  If Left(Trim(Combo1(0).Text), 3) <> "000" And Trim(Combo5) <> MsgText(601) Then
                      MsgBox "非台灣設計案不可輸入案件屬性！", vbExclamation
                      Screen.MousePointer = vbDefault
                      SSTab1.Tab = 0
                      If Combo5.Visible = True Then Me.Combo5.SetFocus
                      Exit Sub
                  ElseIf Left(Trim(Combo1(0).Text), 3) = "000" And Trim(Combo5) = MsgText(601) Then
                      MsgBox "台灣設計案一定要輸案件屬性！", vbExclamation
                      Screen.MousePointer = vbDefault
                      SSTab1.Tab = 0
                      If Combo5.Visible = True Then Me.Combo5.SetFocus
                      Exit Sub
                  End If
               End If
            End If
            'end 2016/06/06
            
            'Add By Sindy 2022/10/14
            If Text1(139).Visible = True Then
               If Trim(Text1(139)) = "" Then
                  MsgBox "聘任期間起日不可空白！", vbCritical, "檢核資料"
                  Me.SSTab1.Tab = 2
                  Text1(139).SetFocus
                  Call Text1_GotFocus(139)
                  Exit Sub
               End If
               If Trim(Text1(140)) = "" Then
                  MsgBox "聘任期間止日不可空白！", vbCritical, "檢核資料"
                  Me.SSTab1.Tab = 2
                  Text1(140).SetFocus
                  Call Text1_GotFocus(140)
                  Exit Sub
               'Add By Sindy 2023/12/12 ex:ACS-000203
               ElseIf Val(Text1(140)) <= Val(strSrvDate(2)) Then
                  MsgBox "聘任期間止日必須大於系統日！", vbCritical, "檢核資料"
                  Me.SSTab1.Tab = 2
                  Text1(140).SetFocus
                  Call Text1_GotFocus(140)
                  Exit Sub
               '2023/12/12 END
               End If
            End If
            '商品類別
            If Frame58.Visible = True Then
               Text1_Validate 138, bolCancel
               If bolCancel = True Then
                  Me.SSTab1.Tab = 2
                  Text1(138).SetFocus
                  Exit Sub
               End If
               If Trim(Text1(138)) = "" Then
                  If Me.Option1(0).Value = True And _
                     (Text1(6) = "T" Or Text1(6) = "TF" Or Text1(6) = "CFT") Then
                     MsgBox "商品類別不可空白！", vbCritical, "檢核資料"
                     Me.SSTab1.Tab = 2
                     Text1(138).SetFocus
                     Call Text1_GotFocus(138)
                     Exit Sub
                  'Add By Sindy 2023/8/16
                  ElseIf Me.Option1(1).Value = True And _
                        (Text1(6) = "S" Or Text1(6) = "TS" Or Text1(6) = "TT") And _
                        (InStr(m_strCaseCPM, "001") > 0 Or InStr(m_strCaseCPM, "738") > 0) And _
                        InStr(Text1(100), "ACS") > 0 Then
                     '多個案號
                     varTemp = Split(Trim(Text1(100)), ",")
                     For jj = LBound(varTemp) To UBound(varTemp)
                        ChgCaseNo Replace(Trim(varTemp(jj)), "-", ""), strCase
                        strExc(0) = "SELECT cp09 FROM Caseprogress " & _
                                    "WHERE cp01='" & strCase(1) & "' AND cp02='" & strCase(2) & "' AND cp03='" & strCase(3) & "' AND cp04='" & strCase(4) & "'" & _
                                    " AND cp10='112'"
                        intI = 1
                        Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                        If intI = 1 Then
                           MsgBox "商品類別不可空白！", vbCritical, "檢核資料"
                           Me.SSTab1.Tab = 2
                           Text1(138).SetFocus
                           Call Text1_GotFocus(138)
                           Exit Sub
                        End If
                     Next jj
                     '2023/8/16 END
                  End If
               End If
            End If
            '2022/10/14 END
            
            'Modified by Morgan 2020/7/13
            'Text1(115).Text = cboTitle.Text  'Add by Morgan 2004/6/11
            Text1(115).Text = Trim(cboTitle.Text)
            'end 2020/7/13
            
            'Added by Lydia 2020/03/30 法務案(L、CFL)及顧問案LA之智權人員只能是法律所人員
            'Modified by Lydia 2020/04/08 改成共用模組
            'If ChkSalesL(Text1(6).Text, Text1(10).Text) = False Then
            'Modified by Morgan 2020/4/17 非法務人員收法務案改自動收文介紹案源
            'If PUB_ChkSalesL(Text1(6).Text, Text1(10).Text) = False Then
            '   Text1(10).SetFocus
            '   Text1_GotFocus 10
            '   Screen.MousePointer = vbDefault
            '   SSTab1.Tab = 0
            '   Exit Sub
            'End If
            SrcSetButton
            'end 2020/4/17
            'end 2020/03/30
            
   '         'Add By Sindy 2018/3/16 控管案件性質要依序輸入
   '         For intI = 4 To 2 Step -1
   '            If Me.Combo1(intI).Text <> "" Then
   '               For ii = intI - 1 To 1 Step -1
   '                  If Me.Combo1(ii).Text = "" Then
   '                     MsgBox "請依序輸入案件性質欄位!!!", vbExclamation + vbOKOnly
   '                     Screen.MousePointer = vbDefault
   '                     SSTab1.Tab = 0
   '                     Exit Sub
   '                  End If
   '               Next ii
   '            End If
   '         Next intI
   '         '2018/3/16 END

            'Modfiy by Amy 原Call MsgDiscSet (台灣P案未設定減免身份提示訊息)搬至CheckShowMsg1
            ' 設定滑鼠游標為等待狀態
'            Screen.MousePointer = vbHourglass 'Modify By Sindy 2025/8/19 mark

         'If m_blnCallPrint = False Then 'Added by Morgan 2014/10/20 列印不必檢查 'Removed by Morgan 2020/6/22 移到上面
            
'            'Add By Sindy 2022/11/21
'            'Modify By Sindy 2023/3/8
'            strExc(10) = ""
'            'Add By Sindy 2024/4/10 + if 法定期限欄位鎖住時,無須計算本所期限
'            If Text1(1).Enabled = True Then
'            '2024/4/10 END
'               If Text1(3).Enabled = True Then
'                  If PUB_CRLUseCP07CheckCP06(IIf(Option1(0).Value = True, "Y", ""), Left(Trim(Combo1(0).Text), 3), Text1(6), _
'                     m_strCaseCPM, Text1(3), Text1(1), strExc(10), False) = False Then
'                     SSTab1.Tab = 0
'                     If Text1(3).Enabled = True Then Text1(3).SetFocus
'                     Screen.MousePointer = vbDefault
'                     Exit Sub
'                  Else
'                     '有計算出本所期限,填入日期鎖住欄位
'                     If Val(strExc(10)) > 0 Then
'                        Text1(3).Text = strExc(10)
'                        Text1(3).Enabled = False
'                     End If
'                  End If
'               End If
'            End If
'            '2022/11/21 END
            Call Text1_LostFocus(1) 'Modify By Sindy 2024/4/12
            'Add By Sindy 2024/4/25 擋住ERR訊息
            If Text1(3).Tag = "ERR" Then
               Screen.MousePointer = vbDefault
               Text1(3).SetFocus
               SSTab1.Tab = 0
               Exit Sub
            End If
            '2024/4/25 END
            
            'Add By Sindy 2022/12/30
            '本所期限過期或到期
            If Val(Text1(3)) <> 0 And Val(Text1(3)) <= Val(strSrvDate(2)) Then
               'Add By Sindy 2022/11/4 急件
               Check11.Value = 1
               FrameCRL90.Enabled = False
               '2022/11/4 END
         '   Else
         '      'Add By Sindy 2022/11/4 急件
         '      Check11.Value = 0
         '      FrameCRL90.Enabled = True
         '      '2022/11/4 END
            End If
            '2022/12/30 END
            
            'Modified by Morgan 2020/4/22
            'If CheckDataValidate1(Index) = False Then
            If CheckDataValidate1(iChkIndex) = False Then
            'end 2020/4/22
                Screen.MousePointer = vbDefault
                Exit Sub
            End If
            'Modified by Morgan 2020/4/22
            'If CheckDataValidate2(Index) = False Then
            If CheckDataValidate2(iChkIndex) = False Then
            'end 2020/4/22
                Screen.MousePointer = vbDefault
                Exit Sub
            End If
            'Added by Lydia 2017/06/19
            'Modified by Morgan 2020/4/22
            'If CheckDataValidate3(Index) = False Then
            If CheckDataValidate3(iChkIndex) = False Then
            'end 2020/4/22
                Screen.MousePointer = vbDefault
                Exit Sub
            End If
            'end 2017/06/19
            'Added by Lydia 2022/06/13
            If CheckDataValidate4(iChkIndex) = False Then
                Screen.MousePointer = vbDefault
                Exit Sub
            End If
            'end 2022/06/13
            'Added by Lydia 2023/11/13
            If CheckDataValidate5(iChkIndex) = False Then
                Screen.MousePointer = vbDefault
                Exit Sub
            End If
            'end 2023/11/13
            If CheckDataYN1(Index) = False Then
                Screen.MousePointer = vbDefault
                Exit Sub
            End If
            Call CheckShowMsg1
            'end 2016/06/24
            'Move by Lydia 2025/02/18　英國脫歐案因為只能轉一次，所以只能放在最後面；檢查都要放在脫歐案檢查之前
            '呈報主管：從顯示系統加註內容下面移過來
            If Trim(txtCRL69) <> "" Then
                If MsgBox(Trim(txtCRL69) & vbCrLf & "是否繼續作業？", vbQuestion + vbYesNo + vbDefaultButton2, "呈報主管內容, 如下：") = vbNo Then
                   Screen.MousePointer = vbDefault
                   Exit Sub
                End If
            End If
            'end 2025/02/18
            '*****************************************
            Call GetCRL57 'Modify By Sindy 2022/9/15 寫入 CRL70 系統加註
            'Memo by Lydia 2025/02/18　英國脫歐案因為只能轉一次，所以只能放在最後面；檢查都要放在脫歐案檢查之前
            '顯示系統加註內容
            If Trim(txtCRL70) <> "" Then
                MsgBox Trim(txtCRL70), vbInformation, "系統加註內容, 如下："
            End If
            '*****************************************
            
            'Added by Morgan 2020/4/29
            If strLOS15 = "" Then
               If Left(strLSourceType, 1) = "B" Then
                  If bolIsB2CourtFee = False Then
                     'Modify By Sindy 2022/10/6
                     'MsgBox "本單為【" & strLSourceType & "類】案源，請繼續輸入法務案收文內容，系統將於建立案源資料後列印本接洽單！", vbInformation
                     MsgBox "本單為【" & strLSourceType & "類】案源，請繼續輸入法務案收文內容！", vbInformation
                     '2022/10/6 END
                  End If
               'Removed by Morgan 2021/7/19 取消 C類案源
               'ElseIf Left(strLSourceType, 1) = "C" Then
               '   'Modified by Morgan 2020/6/17 改與分案預設同步(目前為要法律所配合)
               '   'If MsgBox("本單為【C類】案源，是否需要法律所配合？" & vbCrLf & vbCrLf & "若選【是】，請繼續輸入法務案收文內容，系統將於建立案源資料後列印本接洽單！", vbYesNo + vbQuestion + vbDefaultButton1) = vbNo Then
               '   '   strLSourceType = ""
               '   'End If
               '   MsgBox "本單為【" & strLSourceType & "類】案源，請繼續輸入法務案收文內容，系統將於建立案源資料後列印本接洽單！", vbInformation
               '   'end 2020/6/17
               'end 2021/7/19
               End If
            End If
            'end 2020/4/29
            
'            'Add by Amy 2016/09/01 本所客戶為對造時,需填寫「對造為本所客戶陳報資料 」
'            'Modify By Sindy 2022/9/13 + And (m_stCRL134 = "" And m_stCRL135 = "")
'            If Check7(0).Value = 1 And (m_stCRL134 = "" And m_stCRL135 = "") Then
'               'm_stCRL134 = "": m_stCRL135 = ""
'               frm090801_9.SetParent Me
'               frm090801_9.Show vbModal
'               Screen.MousePointer = vbHourglass
'            ElseIf Check7(0).Value = 0 Then
'               m_stCRL134 = "": m_stCRL135 = ""
'            End If
'            'end 2016/09/01
            
            'Added by Lydia 2020/11/19 CFP和CFT英國脫歐案管制：提示並將畫面資料變更
            'Modified by Lydia 2020/12/01
'            If Option1(1).Value = True And (Text1(6) = "CFP" And Trim(Left(Combo1(1).Text, 4)) = "613") Or (Text1(6) = "CFT" And Trim(Left(Combo1(1).Text, 4)) = "110") Then
'                 strCaseNA239 = Text1(6) & Text1(7) & Trim(Text1(8)) & Trim(Text1(9))
'                 strExc(1) = IIf(Text1(6) = "CFP", "607", "102")
'                 Call ClsPDGetCaseProperty(Text1(6), strExc(1), strExc(0))
'                 strExc(1) = strExc(1) & " " & strExc(0)
'                 bolCase201 = True
'                 MsgBox "脫歐案自動改為英國新案並收文 〔" & strExc(1) & "〕", vbInformation, "英國脫歐案管制"
'                 Combo1(1).Text = strExc(1)
'                 Option1(0).Value = True
'                 Text1(7).Text = "": Text1(8).Text = "": Text1(9).Text = ""
'                 Call ClsPDGetNation("201", strExc(0))
'                 Combo1(0).Text = "201 " & strExc(0)
            'Modified by Morgan 2020/12/17 +判斷歐盟案 And Trim(Left(Combo1(0), 4)) = "239", Ex:CFT-010644
            m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/8/29 取得案件性質代碼
            'Memo by Lydia 2025/02/18 英國脫歐案因為只能轉一次，所以只能放在最後面；ex,(2/17收文)歐盟案CFT-010428，因為有逾期帳款所以彈呈報檢核並且中斷存檔作業
            If Option1(1).Value = True And Trim(Left(Combo1(0), 4)) = "239" And ((Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "613,") > 0) _
                  Or (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "110,") > 0) _
                  Or (Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "444,") > 0) _
                  Or (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "710,") > 0)) Then
                        If ((Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "613,") > 0) _
                             Or (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "110,") > 0)) Then
                           strExc(1) = IIf(Text1(6) = "CFP", "607", "102")
                           Call ClsPDGetCaseProperty(Text1(6), strExc(1), strExc(0))
                           strExc(1) = strExc(1) & " " & strExc(0)
                           MsgBox "脫歐案自動改為英國新案並收文 〔" & strExc(1) & "〕", vbInformation, "英國脫歐案管制"
                           For ii = 1 To GridCase.Rows - 1
                              If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = IIf(Text1(6) = "CFP", "613", "110") Then
                                 GridCase.TextMatrix(ii, 1) = strExc(1)
                                 Call GetGridCaseData(ii): Text1(101).SetFocus
                                 Exit For
                              End If
                           Next ii
'                           If Trim(Left(Combo1(1).Text, 4)) = IIf(Text1(6) = "CFP", "613", "110") Then
'                               Combo1(1).Text = strExc(1)
'                           ElseIf Trim(Left(Combo1(2).Text, 4)) = IIf(Text1(6) = "CFP", "613", "110") Then
'                               Combo1(2).Text = strExc(1)
'                           ElseIf Trim(Left(Combo1(3).Text, 4)) = IIf(Text1(6) = "CFP", "613", "110") Then
'                               Combo1(3).Text = strExc(1)
'                           ElseIf Trim(Left(Combo1(4).Text, 4)) = IIf(Text1(6) = "CFP", "613", "110") Then
'                               Combo1(4).Text = strExc(1)
'                           End If
                        Else
                           MsgBox "脫歐案自動改為英國新案", vbInformation, "英國脫歐案管制"
                        End If
                        strCaseNA239 = Text1(6) & Text1(7) & Trim(Text1(8)) & Trim(Text1(9))
                        bolCase201 = True
                        Option1(0).Value = True
                        Text1(7).Text = "": Text1(8).Text = "": Text1(9).Text = ""
                        Call ClsPDGetNation("201", strExc(0))
                        Combo1(0).Text = "201 " & strExc(0)
            'end 2020/12/01
            Else
               'Modiofy By Sindy 2022/10/12 重查資料會存檔,不要清掉
               If strCaseNA239 <> "" And cmdOK(0).Caption = "新增" Then
               '2022/10/12 END
                  strCaseNA239 = ""
               End If
               strGetNp15 = ""  'Added by Lydia 2022/05/02 清空下一程序備註
               bolCase201 = False
            End If
            'end 2020/11/19
            
            'Added by Lydia 2025/02/18 因為txtCRL預設清空，所以另外保留系統訊息
            If cmdOK(0).Caption <> "新增" Then
               If strCaseNA239 <> "" And strOldCRL70 <> "" And InStr(strOldCRL70, "脫歐英國案代理人：") > 0 And InStr(txtCRL70, "脫歐英國案代理人：") = 0 Then
                  txtCRL70 = txtCRL70 & vbCrLf & Mid(strOldCRL70, InStr(strOldCRL70, "脫歐英國案代理人："), Len("脫歐英國案代理人：") + 9)
               End If
            End If
            'end 2025/02/18
         End If
'****************************************************
'以上程式段若是外部呼叫(m_blnCallPrint=True)時, 不執行
'm_blnCallPrint=False End
'****************************************************
         Screen.MousePointer = vbHourglass 'Added by Morgan 2020/6/22
         
         m_intTotPage = 0
         m_intCustCnt = 0
         If Trim(Me.Text1(21).Text) <> "" Or Trim(Me.Text1(22).Text) <> "" Then
             m_intTotPage = 1
             m_intCustCnt = m_intCustCnt + 1
         End If
         '若為新案
         'edit by nick 加入有些案子例外
         'If Me.Option1(0).Value = True Then
         'edit by nickc 2005/04/06 若申請人 2 - 5 有新客戶則要印第 2 頁
         'If Me.Option1(0).Value = True Or CheckCaseProperty = True Then
         
         'Modify by Morgan 2011/1/14 原 CheckCaseProperty 固定傳 True 故移除
         'If Me.Option1(0).Value = True Or CheckCaseProperty = True Or Option32(0).Value = True Or Option33(0).Value = True Or Option34(0).Value = True Or Option35(0).Value = True Then
             
             If Trim(Me.Text1(37).Text) <> "" Or Trim(Me.Text1(38).Text) <> "" Then
                 m_intTotPage = 2
                 m_intCustCnt = m_intCustCnt + 1
             End If
             If Trim(Me.Text1(53).Text) <> "" Or Trim(Me.Text1(54).Text) <> "" Then
                 m_intTotPage = 2
                 m_intCustCnt = m_intCustCnt + 1
             End If
             If Trim(Me.Text1(69).Text) <> "" Or Trim(Me.Text1(70).Text) <> "" Then
                 m_intTotPage = 2
                 m_intCustCnt = m_intCustCnt + 1
             End If
             If Trim(Me.Text1(85).Text) <> "" Or Trim(Me.Text1(86).Text) <> "" Then
                 m_intTotPage = 2
                 m_intCustCnt = m_intCustCnt + 1
             End If
         'End If
        'Modify by Amy 2016/06/24
        '原判斷查名單對應搬至CheckDataValidate2,原外部呼叫(m_blnCallPrint=True)不執行執判斷往上搬
         
         'Add by Amy 2016/08/15
         'Remove by Lydia 2020/08/21 不顯示在Text1(119)
         'If InStr(Text1(119), "業務備註") > 0 Then
         '   Text1(119) = Replace(Text1(119), Mid(Text1(119), InStr(Text1(119), "業務備註"), InStr(CuMemo, "<End>") + 6), "")
         'End If
         'end 2020/08/21
        
         'add by nickc 2007/11/12 加入檢查是否是特殊客戶
         IsSpecCu = False
         SpecCUName = ""
         SpecMemo = ""
         'add by nickc 2008/01/18
         IsCuMemo = False
         CuMemoName = ""
         CuMemo = ""
'Modify by Morgan 2011/1/10 改寫成函數以方便共用
'         For iiiii = 1 To 5
'             'edit by nickc 2008/01/18 加入客戶業務備註
'             strSql = "select cu01,cu02,cu121,nvl(cu04,nvl(cu05||cu88||cu89||cu90,cu06)) cu04,cl04,cu125 from customer, (select * from custspeciallog  where (cl01,cl02,cl03) in (select cl01,cl02,max(cl03) from custspeciallog where cl01='" & Me.Text1(12 + (iiiii - 1) * 16).Text & "' " & _
'                            " and cl02 in (select max(cl02) from custspeciallog where cl01='" & Me.Text1(12 + (iiiii - 1) * 16).Text & "' ) group by cl01,cl02)) Ncl " & _
'                            " Where CU01='" & Mid(Me.Text1(12 + (iiiii - 1) * 16).Text, 1, 8) & "' And CU02='" & Mid(Me.Text1(12 + (iiiii - 1) * 16).Text, 9, 1) & "' and cu01||cu02=Ncl.cl01(+) "
'             CheckOC3
'             AdoRecordSet3.CursorLocation = adUseClient
'             AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
'             If AdoRecordSet3.RecordCount <> 0 Then
'                 If CheckStr(AdoRecordSet3.Fields("cu121")) = "Y" Then
'                     IsSpecCu = True
'                     SpecCUName = SpecCUName & CheckStr(AdoRecordSet3.Fields("cu04")) & "==>" & CheckStr(AdoRecordSet3.Fields("cl04")) & vbCrLf
'                     If SpecMemo = "" Then    '秀玲說只要記錄第一筆
'                         SpecMemo = CheckStr(AdoRecordSet3.Fields("cl04"))
'                     End If
'                 End If
'                 'add by nickc 2008/01/18 加入客戶業務備註
'                 If CheckStr(AdoRecordSet3.Fields("cu125")) <> "" Then
'                     IsCuMemo = True
'                     CuMemoName = CuMemoName & CheckStr(AdoRecordSet3.Fields("cu04")) & "==>" & CheckStr(AdoRecordSet3.Fields("cu125")) & vbCrLf
'                     If CuMemo = "" Then    '記錄第一筆
'                         CuMemo = CheckStr(AdoRecordSet3.Fields("cu125"))
'                     End If
'                 End If
'             End If
'         Next iiiii
         'CuMemo = ""
         SetCuData IsSpecCu, SpecCUName, SpecMemo, IsCuMemo, CuMemoName, CuMemo
         'Modify by Amy 2016/08/15 +Tag 因顯示於Text1(119),但列印於最後
         'Modified by Lydia 2020/08/21 不顯示在Text1(119)
         'If CuMemo <> MsgText(601) Then
         '      CuMemo = Replace(CuMemo, "@;@", vbCrLf)
         '      Text1(119) = Text1(119) & vbCrLf & "業務備註：" & vbCrLf & CuMemo
         '      CuMemo = CuMemo & "<End>"
         'End If
         ''end 2016/08/15
         CuMemo = Replace(CuMemo, "@;@", vbCrLf)
         'end 2020/08/21
         
'end 2011/1/10
         
        m_strST06 = PUB_GetST06(Me.Text1(10).Text)
        'intCopies = GetCopies(Me.Text1(10).Text)
'        intCopies = txtPCnt
        'add by nickc 2006/07/19 分割新規則
        Is308Child = False
        'add by nickc 2008/02/13
        'NowCount = 0 'Modify by Sindy 2016/2/17 往上搬
        
        
        Dim bolNoPrint As Boolean 'Add by Morgan 2011/1/10
        'Added by Morgan 2020/4/17
        '介紹案源
        If Index = 5 Then
            Screen.MousePointer = vbDefault
            bolNoPrint = True
            Set frm090801_11.frmParent = Me
            
            '查詢
            If m_blnCallPrint = True Then
               If strLOS15 = "" Then strLOS15 = SrcGetLOS15(Text5)
               frm090801_11.strLOS15 = strLOS15
               frm090801_11.SetReadOnly
               frm090801_11.Show vbModal
               Exit Sub
            Else
               If strLSourceType = "" Then
                  bolIsSuitCase = False
                  bolIsPTCCase = False
                  bolIsIPCase = False
                  
                  'Added by Morgan 2020/8/4 顧問固定為A3
                  If Text1(6) = "LA" Then
                     strLSourceType = "A3"
                     
                  'Modified by Morgan 2020/10/13 規則調整
                  '非訴訟案
                  ElseIf SrcChkLIsSuitCase() = False Then
                     strLSourceType = "A3"
                     '舊案若有A1案源則仍為A1
                     If Option1(1).Value = True Then
                        If PUB_ChkExistA1Src(Text1(6), Text1(7)) = True Then
                           strLSourceType = "A1"
                        End If
                     End If
                     
                  '訴訟案
                  Else
                     bolIsSuitCase = True
                     strLC47 = SrcGetLC47()
                     'PTC智財權
                     If SrcChkLIsIPCase(strLC47, True) = True Then
                        bolIsPTCCase = True
                        bolIsIPCase = True
                        '國外人員手動選擇 BC類案源(P/T接洽單人工產生)
                        If Left(strSalesDep, 1) <> "F" Then
                           SetPTByLC47 strLC47, strPTSysCode, strPTCP10
                           If strPTSysCode = "P" Then
                              strExc(0) = "專利"
                           ElseIf strPTSysCode = "T" Then
                              strExc(0) = "商標"
                           Else
                              strExc(0) = "著作權"
                           End If
                           '要智慧所配合
                           strExc(1) = "本單為【" & strExc(0) & "訴訟】案件，是否需要智慧所配合？"
                           If Left(strSalesDep, 1) <> "F" Then
                              'Modify By Sindy 2022/10/6
                              'strExc(1) = strExc(1) & vbCrLf & vbCrLf & "若選【是】，請於案源建立後繼續完成【" & strExc(0) & "案】的接洽單列印！" & vbCrLf & vbCrLf & strExc(0) & "案預設收文性質：【" & SrcGetProperty(strPTSysCode, strPTCP10) & "】"
                              strExc(1) = strExc(1) & vbCrLf & vbCrLf & "若選【是】，請於案源建立後繼續完成【" & strExc(0) & "案】的接洽單輸入！" & vbCrLf & vbCrLf & strExc(0) & "案預設收文性質：【" & SrcGetProperty(strPTSysCode, strPTCP10) & "】"
                              '2022/10/6 END
                           End If
                           If MsgBox(strExc(1), vbYesNo + vbQuestion + vbDefaultButton1) = vbYes Then
                              strLSourceType = "B1"
                              
                           '無需智慧所配合
                           Else
                              strLSourceType = "A4"
                              strPTSysCode = ""
                              strPTCP10 = ""
                           End If
                        End If
                        
                     '其他智財權
                     ElseIf SrcChkLIsIPCase(strLC47, False) = True Then
                           bolIsIPCase = True
                           'Modified by Morgan 2020/9/30
                           'strLSourceType = "A3"
                           strLSourceType = "A4"
                           'end 2020/9/30
                           
                     '一般法律
                     Else
                        'Modified by Morgan 2020/9/30
                        'strLSourceType = "A"
                        strLSourceType = "A1"
                        'end 2020/9/30
                     End If
                     
                  End If 'Added by Morgan 2020/8/4
                  
               End If
                         
               With frm090801_11
               .strLOS04 = Text1(10)
               If strLSourceType <> "" Then
                  .strLOS02 = strLSourceType
               Else
                  .bolIsPTCCase = bolIsPTCCase
                  .bolIsIPCase = bolIsIPCase
                  .bolIsSuitCase = bolIsSuitCase
               End If
               .Show vbModal
               End With
               
               '取消
               If iReturn = 0 Then
                  '不同審級取消時要改回原案號
                  If bolPrintNewCase = True And Text1(8).Tag <> "" Then
                     Text1(8) = Text1(8).Tag
                  End If
                  Exit Sub
               End If
               
               Screen.MousePointer = vbHourglass
               If OnSaveData() = False Then
                  MsgBox "存檔失敗，請洽系統管理員 !", vbCritical
                  Screen.MousePointer = vbDefault
                  Me.SSTab1.Tab = 0
                  Me.Text1(10).SetFocus
                  Exit Sub
               Else
                  'Add by Amy 2025/07/21 身份證/統編 重覆發信
                  If strIDRepeat <> "" Then
                     strTo = Pub_GetSpecMan("程式管理人員")
                     PUB_SendMail strUserNum, strTo, "", "接洽單 更新客戶檔身份證字號/統一編號重覆通知！", strIDRepeat
                  End If
                  
                  'A類案源
                  If Left(strLSourceType, 1) = "A" Then
                     PUB_SendMailCache
                     MsgBox "案源資料已建立！", vbInformation
                     SrcLOSReset
                     cmdClear
                     
                  '國外部人員輸入案源
                  ElseIf Left(strSalesDep, 1) = "F" Then
                     Clipboard.Clear
                     Clipboard.SetText "案源單號：" & strLOS15
                     MsgBox "案源資料已建立，「案源單號：" & strLOS15 & "」已複製到剪貼簿，請自行貼(填)到FCP/FCT接洽單「左上角空白處」！", vbInformation
                     
                     SrcLOSReset
                     cmdClear
                     
                  'Added by Morgan 2020/6/17
                  'B1類案源輸完L後預設P/T案
                  ElseIf strLSourceType = "B1" Then
                     '補收款
                     If strLCaseCP10 = "78" Or strLOS18 <> "" Then
'Modify By Sindy 2022/9/22 Mark
'                        SrcPrintSheet strLOS15, strLOS18, Me.cboPrinter.Text
                        
                        'Modify By Sindy 2022/10/6
                        'MsgBox "P/T案接洽單已列印，案源資料已建立 !", vbInformation
                        MsgBox "P/T案接洽單已新增，案源資料已建立！", vbInformation
                        '2022/10/6 END
                        SrcLOSReset
                        cmdClear
                     Else
                        SrcSetMemo
                        SrcSetField strPTSysCode
                        '預設收文性質
                        If strPTCP10 <> "" Then
                           arrCP10 = Split(strPTCP10, ",")
                           For jj = 0 To UBound(arrCP10)
                              If arrCP10(jj) = "" Then Exit For
                              'Modify By Sindy 2022/8/29
'                              For ii = 0 To Combo1(1 + jj).ListCount - 1
'                                 If InStr(Combo1(1 + jj).List(ii), arrCP10(jj) & " ") = 1 Then
'                                    Combo1(1 + jj).ListIndex = ii
'                                    Combo1_LostFocus 1 + jj
'                                    Text1(101 + 3 * jj).Text = "0"
'                                    Text1(102 + 3 * jj).Text = "0"
'                                    Text1(103 + 3 * jj).Text = "0.000"
'                                    Exit For
'                                 End If
'                              Next ii
                              For ii = 0 To Combo1(1).ListCount - 1
                                 If InStr(Combo1(1).List(ii), arrCP10(jj) & " ") = 1 Then
                                    Combo1(1).ListIndex = ii
                                    Combo1_LostFocus 1
                                    Text1(101).Text = "0"
                                    Text1(102).Text = "0"
                                    Text1(103).Text = "0.000"
                                    Call cmdUpd_Click '新增
                                    Exit For
                                 End If
                              Next ii
                              '2022/8/29 END
                           Next jj
                        End If
                     End If
                  'end 2020/6/17
                     
                  'B2、C類案源列印 P/T 案接洽單
                  Else
                     'Modified by Morgan 2020/6/20
                     'strLSourceType = "" '此處要先清除，否則會再觸發BC類案源存檔
                     'Text5 = strLOS18
                     'm_blnCallPrint = True
                     'Call cmdClear
                     'Call QueryData
                     'txtPCnt.Visible = True
                     'cmdOK(0).Value = True
                     'Text5 = ""
                     'm_blnCallPrint = False
                     ''還原說明事項原始內容(因CRL57含列印時系統補上的內容)
                     'If strPTMemo <> "" Then
                     '   Text1(119) = strPTMemo
                     'Else
                     '   SrcSetMemo
                     'End If
                     
'Modify By Sindy 2022/9/22 Mark
'                     SrcPrintSheet strLOS15, strLOS18, Me.cboPrinter.Text
                     'end 2020/6/20
                     
                     'Modify By Sindy 2022/10/6
                     'MsgBox "P/T案接洽單已列印，案源資料已建立 !", vbInformation
                     MsgBox "P/T案接洽單已新增，案源資料已建立！", vbInformation
                     '2022/10/6 END
                     SrcLOSReset
                     cmdClear
                  End If
               End If
            End If
        'end 2020/4/17
        
        'Added by Morgan 2020/6/18 B1類案源存檔
         ElseIf strLSourceType = "B1" Then
            
            If strCheckStatus = "2" Then
               If MsgBox("是否有【補收款】？" & vbCrLf & vbCrLf & "若【是】，請繼續操作法務案補收款接洽單", vbQuestion + vbYesNo + vbDefaultButton2) = vbYes Then
                  bolNoPrint = True
                  strLCaseCP10 = "78"
               Else
                  bolPrintPT = True
               End If
            
            ElseIf strLOS15 = "" Then
               bolNoPrint = True
               
            Else
               bolPrintPT = True
            End If
            
            If OnSaveData() = False Then
               MsgBox "存檔失敗，請洽系統管理員 !", vbCritical
               Screen.MousePointer = vbDefault
               Me.SSTab1.Tab = 0
               Me.Text1(10).SetFocus
               Exit Sub
            'Add by Amy 2025/07/21 +else 身份證/統編 重覆發信
            Else
               If strIDRepeat <> "" Then
                  strTo = Pub_GetSpecMan("程式管理人員")
                  PUB_SendMail strUserNum, strTo, "", "接洽單 更新客戶檔身份證字號/統一編號重覆通知！", strIDRepeat
               End If
            End If
            
            If bolNoPrint = True Then
               strPTSysCode = Text1(6) 'P/T系統別
               'P/T是否新案
               bolPTIsNew = Option1(0).Value
               SrcSetField "L"
               
               '預設收文性質
               If strLCaseCP10 <> "" Then
                  For ii = 0 To Combo1(1).ListCount - 1
                     If InStr(Combo1(1).List(ii), strLCaseCP10 & " ") = 1 Then
                        Combo1(1).ListIndex = ii
                        Combo1_LostFocus 1
                        Call cmdUpd_Click '新增 Add By Sindy 2022/8/29
                        Exit For
                     End If
                  Next ii
               End If
            End If
        'Added by Morgan 2020/4/29
        'BC類案源的P/T接洽單保存
        ElseIf strLSourceType <> "" And strLOS15 = "" Then
            bolNoPrint = True
            strPTMemo = Text1(119) 'P/T案的原始說明事項
            
            '法務案預設收文性質(LOS19)
            strLCaseCP10 = ""
            '計算B2類PT案源規費
            If strLSourceType = "B2" Then
               lngPTOFee = 0
               lngPTcost = 0 'Add By Sindy 2025/4/14 費用
               'Modify By Sindy 2022/8/29
               'For ii = 1 To 4
               For ii = 1 To GridCase.Rows - 1
                  'If Combo1(ii) <> "" Then
                  If GridCase.TextMatrix(ii, 1) <> "" Then
                     'Modify By Sindy 2025/4/14 改成共用函數
                     'strExc(0) = "SELECT cf08 FROM CASEFEE WHERE CF01 = '" & Text1(6) & "' AND CF02 = '000' AND CF03 = '" & Left(Combo1(ii), 3) & "' and cf08>0"
'                     strExc(0) = "SELECT cf08 FROM CASEFEE WHERE CF01 = '" & Text1(6) & "' AND CF02 = '000' AND CF03 = '" & Left(Trim(GridCase.TextMatrix(ii, 1)), 3) & "' and cf08>0"
'                     intI = 1
'                     Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
'                     If intI = 1 Then
'                        lngPTOFee = lngPTOFee + RsTemp("cf08")
'                     End If
                     Call PUB_GetCaseFee_000("", strExc(1), strExc(2), strExc(3), Text1(6), Left(Trim(GridCase.TextMatrix(ii, 1)), 3))
                     lngPTOFee = lngPTOFee + Val(strExc(3))
                     lngPTcost = lngPTcost + Val(strExc(1)) 'Add By Sindy 2025/4/14 費用
                     '2025/4/14 END
             
                     'Added by Morgan 2022/11/3 35代擬行政訴狀
                     If (Text1(6) = "P" And InStr("512,513,514", Left(Trim(GridCase.TextMatrix(ii, 1)), 3)) > 0) Or _
                        (Text1(6) = "T" And InStr("418,419,420", Left(Trim(GridCase.TextMatrix(ii, 1)), 3)) > 0) Then 'Left(Combo1(ii), 3)
                        strLCaseCP10 = "35"
                     End If
                     'end 2022/11/3
                  End If
               Next ii
               
               If Option1(1).Value = True Then
                  SrcCheckExistLOS Text1(6), Text1(7), Text1(8), Text1(9), strLCaseNo
               End If
               
               '補收出庭費時法務案預設78補收款，否則預設34行政訴訟程序
               If bolIsB2CourtFee = True Then
                  strLCaseCP10 = "78"
               'Modified by Morgan 2022/11/3
               'Else
               ElseIf strLCaseCP10 = "" Then
               'end 2022/11/3
                  strLCaseCP10 = "34"
               End If
              
            'C類案源若為訴願案時法務案預設33訴願，否則預設34行政訴訟程序
            'Removed by Morgan 2021/7/19 取消 C類案源
            'ElseIf strLSourceType = "C" Then
            '   If bolSuYuan = True Then
            '      strLCaseCP10 = "33"
            '   Else
            '      strLCaseCP10 = "34"
            '      'Added by Morgan 2020/8/3 C類也會有舊法務案( 先B2後C,Ex:P087216 行政訴訟上訴->行政訴訟)
            '      If Option1(1).Value = True Then
            '         SrcCheckExistLOS Text1(6), Text1(7), Text1(8), Text1(9), strLCaseNo
            '      End If
            '      'end 2020/8/3
            '   End If
            'end 2021/7/19
            
            End If
            
            If OnSaveData() = False Then
               MsgBox "P/T接洽單保存失敗，請洽系統管理員 !", vbCritical
               Screen.MousePointer = vbDefault
               Me.SSTab1.Tab = 0
               Me.Text1(10).SetFocus
               Exit Sub
            Else
               'Add by Amy 2025/07/21 身份證/統編 重覆發信
               If strIDRepeat <> "" Then
                  strTo = Pub_GetSpecMan("程式管理人員")
                  PUB_SendMail strUserNum, strTo, "", "接洽單 更新客戶檔身份證字號/統一編號重覆通知！", strIDRepeat
               End If
               
               'MsgBox "P/T案接洽單已保存，請繼續輸入法務案收文內容，完成案源資料建立 !", vbInformation
               strPTSysCode = Text1(6) 'P/T系統別
               'P/T是否新案
               bolPTIsNew = Option1(0).Value
               SrcSetField "L", bolPTIsNew
               
               '預設收文性質
               If strLCaseCP10 <> "" Then
                  For ii = 0 To Combo1(1).ListCount - 1
                     If InStr(Combo1(1).List(ii), strLCaseCP10 & " ") = 1 Then
                        Combo1(1).ListIndex = ii
                        Combo1_LostFocus 1
                        Call cmdUpd_Click '新增 Add By Sindy 2022/8/29
                        'C類案源預設費用0
                        'Removed by Morgan 2021/7/19 取消 C類案源
                        'If strLSourceType = "C" Then
                        '   Text1(101).Text = "0"
                        '   Text1(102).Text = "0"
                        '   Text1(103).Text = "0.000"
                        'End If
                        'end 2021/7/19
                        Exit For
                     End If
                  Next
               End If
               
            End If
               
        'end 2020/4/29
         
'*** 存檔
        'Add By Sindy 2010/6/21 存檔
        Else 'If m_blnCallPrint = False Then
            'Add by Morgan 2010/12/10
            m_bCaseClosed = IfCaseClosed
            If m_bCaseClosed Then
               'Modify By Sindy 2023/1/6 秀玲:閉卷案收文彈訊息「請注意！此案已閉卷是否確定要收文？」即可
               '，取消「( 若確定要收文會取消閉卷!! )。」的文字，並開放仍可收文但不可取消閉卷；只有P案的年費可以取消閉卷。
               '也不必發MAIL給專業部，經理說現在很快就會分案。
               'If MsgBox("請注意！此案已閉卷是否確定要收文？" & vbCrLf & vbCrLf & "    ( 若確定要收文會取消閉卷!! )", vbYesNo + vbExclamation + vbDefaultButton2) = vbNo Then
               If MsgBox("請注意！此案已閉卷是否確定要收文？", vbYesNo + vbExclamation + vbDefaultButton2) = vbNo Then
                  Screen.MousePointer = vbDefault
                  Exit Sub
               End If
            End If
            'end 2010/12/10
            
            'Added by Morgan 2023/7/28
            '大陸專利讓與701/專利權讓與708提醒
            If Text1(6) = "P" And arrNation(0) = "020" And InStr(m_strCaseCPM, "701") + InStr(m_strCaseCPM, "708") > 0 Then
               '舊案舊客戶才檢查，新案或新客戶國籍不確定只在指示信/發文時提醒
               If Option1(1).Value = True Then
                  PUB_CNP701708Check strAppl1 & "," & strAppl2 & "," & strAppl3 & "," & strAppl4 & "," & strAppl5, stCustNo1 & "," & stCustNo2 & "," & stCustNo3 & "," & stCustNo4 & "," & stCustNo5
               End If
            End If
            'end 2023/7/28
            
            'Add By Sindy 2025/8/6
            If Label1(84) = "C類來函：" And cmdOK(0).Caption = "送出" Then
               If Text1(119).Tag = Text1(119) Then
                  MsgBox "請智權人員於[說明處理事項]中,說明希補強之分析方向，而後進行收文!", vbCritical
                  Screen.MousePointer = vbDefault
                  Me.SSTab1.Tab = 0
                  'Me.Text1(10).SetFocus
                  Exit Sub
               End If
            End If
            '2025/8/6
            
            m_bolDueDayAlert = False
            If OnSaveData = False Then
               MsgBox "存檔失敗，請洽系統管理員 !", vbCritical
               Screen.MousePointer = vbDefault
               Me.SSTab1.Tab = 0
               'Me.Text1(10).SetFocus
               Exit Sub
            Else
               'Add by Amy 2025/07/21 身份證/統編 重覆發信
               If strIDRepeat <> "" Then
                  strTo = Pub_GetSpecMan("程式管理人員")
                  PUB_SendMail strUserNum, strTo, "", "接洽單 更新客戶檔身份證字號/統一編號重覆通知！", strIDRepeat
               End If
               
               PUB_SendMailCache 'Add by Morgan 2010/12/10
               If m_bolDueDayAlert Then MsgBox "請立刻電話通知專業部門作業!", vbExclamation 'Add by Morgan 2011/3/2
               
               m_strSaveFiles = "": m_strSaveFiles2 = "": Me.cmdAddAtt.BackColor = &H808080 '灰色 'Add By Sindy 2015/1/7
               strCaseNA239new = "" 'Added by Lydia 2021/03/05 列印後直接清空，避免連續輸入新申請案帶錯
               strGetNp15 = ""  'Added by Lydia 2022/05/02 清空下一程序備註
               strOldCRL70 = "" 'Added by Lydia 2025/02/18
               
               'Added by Lydia 2016/05/10 避免重覆委查單,印完就清空
               If TMQList <> "" Then
                  opt1(0).Value = False
                  opt1(1).Value = False
                  opt1(2).Value = False
                  Set G_SeekPicColor.Picture = LoadPicture()
                  Set tmpImg.Picture = LoadPicture()
                  Set tmpPic.Picture = LoadPicture()
                  cmdTMQ.Tag = ""
                  'Modified by Lydia 2023/08/02 直接改成傳入變數+True
                  Call SetGrdTMQ(True)
                   
                  'Added by Lydia 2024/11/11 查名單(網中)
                  If m_UseTmqTma = "2" Then
                     If Not nfrm090126_New Is Nothing Then cmdTMQApp.Visible = True
                     If Not nfrm090127_New Is Nothing Then
                        Unload nfrm090127_New
                     End If
                  Else
                  'end 2024/11/11
                     If TypeName(Tmpfrm090126) <> "Nothing" Then cmdTMQApp.Visible = True
                     If TypeName(m_PrevForm) = "frm090127" Then
                        Unload frm090127
                     End If
                  End If 'Added by Lydia 2024/11/11
               End If
               'end 2016/05/10
               
               'Add By Sindy 2022/9/21
               If cmdOK(0).Caption = "存檔" Then
                  Screen.MousePointer = vbDefault
                  Call cmdSend_Click '回待收文區
                  Exit Sub
               '外部呼叫的收文,可以直接送出
               ElseIf cmdOK(0).Caption = "送出" Or cmdOK(0).Caption = "重送" Then
                  bolExternalCall = False
                  Screen.MousePointer = vbDefault
                  Unload Me '關閉
                  Exit Sub
               End If
               '2022/9/21 END
               MsgBox "新增完畢！", vbInformation
               'cmdClear 'Added by Morgan 2012/8/23
               
               'Add By Sindy 2011/1/24 檢查相同國家若有舊案申請地址與客戶目前申請地址不同時，提醒操作人員
               If m_ChkOCaseAndCAddrNotAlike = True Then
                 If m_AppAddrChange = True Then
                    If m_CaseAndCAddrNotAlikePrint = True Then
                       Call PrintAddrNotAlike
                    End If
                 Else
                    Call PrintAddrNotAlike
                 End If
               End If
               '2011/1/24 End
            End If
        End If
       
'*** 尾聲
      'Added by Morgan 2020/4/22
      If m_blnCallPrint = True Or bolLawOfficeCase = True Then
         Me.SSTab1.Tab = 0
         Screen.MousePointer = vbDefault
         If bolLawOfficeCase = True Then
            If strLOS15 <> "" Then SrcUpdPrintTime '回寫案源檔列印時間
            Unload Me
         End If
      Else
      
         Call ProcToFinal(bolPrintPT) 'Added by Lydia 2021/06/16
         'end 2021/06/16
         
      End If 'Added by Morgan 2020/4/22
      'Add by Amy 2025/07/21 舊客戶有更新ID要鎖住ID欄,才不會重覆寄ID重覆之通知信
      If strReSetCust <> "" Then
         arrTmp = Split(strReSetCust, ",")
         For ii = LBound(arrTmp) To UBound(arrTmp)
            Me.Text1(92 + arrTmp(ii)).Enabled = False
         Next ii
         strReSetCust = ""
      End If
    End Select
   
   Exit Sub
   
CheckingErr:
   If Err.Description <> "" Then
      cnnConnection.RollbackTrans
      MsgBox (Err.Description), , "法律案源-重送"
   End If
End Sub

'Add By Sindy 2022/12/24 strIDentity : 案件屬性/身份種類(個體別)
Private Sub GetstrIDentity()
   strIDentity = ""
   If Frame28.Visible = True Then
      If OptEntity(0).Value = True And OptEntity(0).Visible = True Then
         strIDentity = "1"
      ElseIf OptEntity(1).Value = True And OptEntity(1).Visible = True Then
         strIDentity = "2"
      ElseIf OptEntity(2).Value = True And OptEntity(2).Visible = True Then
         strIDentity = "3"
      End If
   ElseIf Combo5.Visible = True Then
      strIDentity = Left(Combo5.Text, 1)
   'Add By Sindy 2023/2/14
   Else
      If Text1(6) = "T" And Check4.Visible = True Then
         If Check4.Value = 1 Then
            strIDentity = "Y"
         Else
            strIDentity = "N"
         End If
      End If
      '2023/2/14 END
   End If
End Sub

'Modify By Sindy 2010/6/21
'Modify by Morgan 2011/3/28 +pbolPreserve
Private Sub cmdClear(Optional pbolPreserve As Boolean = False)
   Dim i As Integer 'Add by Amy 2015/10/22
   
   Call SetCtrlReadOnly(False) 'Add By Sindy 2022/12/25
   Call SetCtrlReadOnly_Flow(False) 'Add By Sindy 2022/12/25
'   m_stCRL134 = "": m_stCRL135 = ""
'   cmdCRL134.Visible = False
   txtCRL69.Text = "": txtCRL70.Text = ""
   GridCase.Tag = ""
   cmdInventor.Tag = ""
'   cmdPic.Tag = ""
   mTQC01 = "" 'Add By Sindy 2022/10/12
   lblAPPLQ.Visible = False
   lblZip.Visible = False
   chkEnglish.Value = 0
   cmdCRL55.Visible = True
   
   'Add By Sindy 2022/12/23 記錄基本檔的申請人
   strAppl1 = "": strAppl2 = "": strAppl3 = "": strAppl4 = "": strAppl5 = ""
   
   ClearAll pbolPreserve
'        If Me.Text1(10).Text <> "" Then
'            If MsgBox("是否清除員工編號???", vbExclamation + vbYesNo) = vbYes Then

   'txtEnabled1 True 'Removed by Morgan 2011/11/3
   
   If pbolPreserve = False Then 'Add by Morgan 2011/3/28 考慮輸多張接洽單只有改案號情形
      txtEnabled1 True 'Add by Morgan 2011/11/3 從外面搬進來,否則舊客戶會變可改編號 Ex.P79422
      Me.Text1(0).Text = ""
      Me.lblZone.Caption = ""
      'Modify By Sindy 2012/5/30 Mark
'      Me.Text1(10).Text = ""
'      Me.lblStaffName.Caption = ""
   End If
'            End If
'        End If
   
   Me.SSTab2.Tab = 0
   Me.SSTab1.Tab = 0
   'Add By Sindy 2009/08/31
   opt1(0).Value = False
   opt1(1).Value = False
   opt1(2).Value = False
   Set G_SeekPicColor.Picture = LoadPicture()
   Set tmpImg.Picture = LoadPicture()
   Set tmpPic.Picture = LoadPicture()
   Check7(0).Value = 0
   Check7(1).Value = 0
   '2009/08/31 End
   
   Option1(0).Enabled = True: Option1(1).Enabled = True 'Add By Sindy 2022/9/15
   '預設為新案
   If pbolPreserve = False Then 'Add by Morgan 2011/3/28 考慮輸多張接洽單只有改案號情形
      Me.Option1(0).Value = True
      Me.Text1(6).Enabled = True 'Add By Sindy 2022/9/15
      Me.Text1(7).Enabled = False
      Me.Text1(8).Enabled = False
      Me.Text1(9).Enabled = False
      'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 + And Me.Visible = True
      If Me.Text1(10).Enabled = True And Me.Visible = True And Me.Text1(10) = "" Then
         Me.Text1(10).SetFocus
      'Add By Sindy 2023/5/24 新案停在系統別欄位上
      ElseIf Option1(0).Enabled = True And Option1(0).Visible = True And Option1(0).Value = True Then
         Me.Text1(6).SetFocus
         '2023/5/24 END
      End If
   End If
   
   'Added by Lydia 2023/11/13 DEBIT NOTE請款選項
   optDB(0).Value = 0: optDB(1).Value = 0
   Check7(2).Value = 0: Check7(3).Value = 0
   Frame33(1).BackColor = &H8000000F
   Frame33(1).Visible = False
   'end 2023/11/13
   
   'Add by Morgan 2011/4/7
   m_Note1 = "": m_Note2 = ""
   m_strGetNP01 = "" 'Add By Sindy 2015/9/17
   Text1(142).Text = "": Text1(143).Text = "" 'strYF05From = "": strYF05To = ""
   cmdOK(3).Caption = "期限資料(&L)" 'Add By Sindy 2015/4/2
   'Add by Lydia 2014/12/22
   mPYFee = False
   Frame605.Visible = False
   
   'Add by Amy 2016/09/19
   m_strTM15 = ""
   m_strTM12 = ""
   'Add By Sindy 2014/2/6
   Check9.Value = 0: cmdCRL119.Visible = False
   m_stCRL01 = ""
   m_stCRL97 = "": m_stCRL118 = ""
   m_stCRL98 = "": m_stCRL99 = "": m_stCRL100 = "": m_stCRL101 = ""
   m_stCRL102 = "": m_stCRL103 = "": m_stCRL104 = "": m_stCRL105 = ""
   m_stCRL106 = "": m_stCRL107 = "": m_stCRL108 = "": m_stCRL109 = ""
   m_stCRL110 = "": m_stCRL111 = "": m_stCRL112 = "": m_stCRL113 = ""
   m_stCRL120 = "": m_stCRL121 = "": m_stCRL122 = "": m_stCRL123 = ""
   '2014/2/6 END
   'Add By Sindy 2015/8/28
   m_stCRL114 = "": m_stCRL115 = "": m_stCRL116 = ""
   m_stCRL117 = "": m_stCRL124 = "": m_stCRL126 = ""
   m_stCRL127 = "": m_stCRL128 = "": m_stCRL129 = ""
   m_stCRL130 = "": m_stCRL131 = "": m_stCRL132 = ""
   '2015/8/28 END
   If strSrvDate(1) >= 風險警示啟用日 Then
      m_stCRL156 = "": m_stCRL157 = ":m_stCRL158="":m_stCRL159" 'Add by Amy 2024/01/17 對造
   End If

   m_lstCaseNo = "" 'add by sonia 2015/9/15 自動收文已清畫面,再輸第二筆案號又會詢問是否清除畫面,故加入此
   'Added by Lydia 2015/10/14
   cmdTMQ.Tag = ""
   'Modified by Lydia 2023/08/02 直接改成傳入變數+True
   Call SetGrdTMQ(True)

   TMQList = ""
   pTMQList = "" 'Added by Lydia 2016/05/05
   
   'Modified by Morgan 2020/4/28
   SrcSetButton
   bolPrintNewCase = False 'Added by Morgan 2020/6/3
   
   ClearField_Flow 'Add By Sindy 2022/9/19
End Sub

'Added by Morgan 2013/4/2
Private Sub cmdQual_Click(Index As Integer)
   frm090801_6.SetParent Me 'Add By Sindy 2022/9/1
   m_stAD15 = arrAD1516(Index, 1)
   m_stAD16 = arrAD1516(Index, 2)
   'Added by Morgan 2019/4/12
   m_stAD10 = arrAD1516(Index, 3)
   frm090801_6.m_stAD02 = stCountry
   frm090801_6.m_stAD10 = m_stAD10
   frm090801_6.m_stCU15 = arrAD1516(Index, 4)
   'end 2019/4/12
   frm090801_6.m_stAD15 = m_stAD15
   frm090801_6.m_stAD16 = m_stAD16
   frm090801_6.Show vbModal
   arrAD1516(Index, 1) = m_stAD15
   arrAD1516(Index, 2) = m_stAD16
   arrAD1516(Index, 3) = m_stAD10 'Added by Morgan 2019/4/12
End Sub

Private Sub CmdSame_Click(Index As Integer)
    If Text1(26 + (Index - 1) * 16) = MsgText(601) Then Exit Sub
     
     Call ChkZipData(0, Me.Text1(27 + (Index - 1) * 16))
'    Text1(27 + (Index - 1) * 16) = Text1(26 + (Index - 1) * 16)
'    If Text1(25 + (Index - 1) * 16) <> MsgText(601) Then Text1(119 + Index) = Text1(25 + (Index - 1) * 16)
End Sub

Private Sub cmdSearchZip_Click(Index As Integer)
    Dim stBackField As String, stText As String
    
    Select Case Index
        Case 0
            stBackField = "Text1(25)"
            stText = Text1(26)
        Case 1
            stBackField = "Text1(120)"
            stText = Text1(27)
        Case 2
            stBackField = "Text1(41)"
            stText = Text1(42)
        Case 3
            stBackField = "Text1(121)"
            stText = Text1(43)
        Case 4
            stBackField = "Text1(57)"
            stText = Text1(58)
        Case 5
            stBackField = "Text1(122)"
            stText = Text1(59)
        Case 6
            stBackField = "Text1(73)"
            stText = Text1(74)
        Case 7
            stBackField = "Text1(123)"
            stText = Text1(75)
        Case 8
            stBackField = "Text1(89)"
            stText = Text1(90)
        Case 9
            stBackField = "Text1(124)"
            stText = Text1(91)
    End Select
    Call frm100134.SetParent(Me)
    Me.Hide
    frm100134.BFormZip = stBackField
    If stText <> MsgText(601) Then
        frm100134.GetStreet stText, 2
        Call frm100134.QueryData
    End If
    frm100134.Show
End Sub

'Add By Sindy 2022/8/24 檢查是否有接洽單未送簽核資料
Private Function SrcGetCRLFlow() As Integer
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   
On Error GoTo ErrHnd
   
   SrcGetCRLFlow = 0
   stSQL = "select CRL01 From ConsultRecordList,ConsultRecCMP,flow003" & _
           " where crl02>=" & 接洽單電子收文啟用日 & " and CRL01=f0301(+) and f0309 is null" & _
           " and CRL01=crc01(+) and crc02 is not null" & _
           " and crl78='" & strUserNum & "'" & _
           " group by CRL01"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      SrcGetCRLFlow = RsQ.RecordCount
   End If
   
ErrHnd:
   Set RsQ = Nothing
End Function

'Add By Sindy 2022/8/24 待收文區
Private Sub cmdSend_Click()
Dim intRow As Integer

   Set frm090801_12.frmParent = Me
   Me.Hide
   frm090801_12.Show vbModal
'   If Me.cmdSend.Tag = "關閉" Then
'      Unload Me
'   Else
   
   'Add By Sindy 2024/9/24 沒更新到按鍵筆數
   cmdSend.Caption = "待收文區"
   intRow = SrcGetCRLFlow
   If intRow > 0 Then
      cmdSend.Caption = "待收文區(" & intRow & ")"
   End If
   '2024/9/24 END
   
   If Me.cmdSend.Tag = "無資料" Then
      Text5 = ""
      cmdClear
      If strCheckStatus = "" Then SrcLOSReset 'Add By Sindy 2023/3/21
   ElseIf Text5 = "" And cmdOK(0).Caption = "存檔" Then
      '有操作過修改鍵的返回,必須清除欄位值
      cmdClear 'Added by Morgan 2024/9/19
      If strLOS15 <> "" Then SrcLoadCheck 'Add By Sindy 2022/12/26
      If strCheckStatus = "" Then SrcLOSReset 'Add By Sindy 2023/3/21
      'cmdClear 'Removed by Morgan 2024/9/19 移到上面,否則案源載入的資料會被清除而單號卻殘留
   End If
   Me.cmdSend.Tag = ""
   Exit Sub
End Sub

Private Sub cmdSerach_Click(Index As Integer)
Dim bolUseEngName As Boolean

Select Case Index
'Modified by Morgan 2013/4/13 +英文也要能查
Case 0 '申請人1
    If Me.Text1(21).Text = "" And Me.Text1(22).Text = "" Then
        MsgBox "請輸入申請人中文或英文名稱的關鍵字!!!", vbExclamation + vbOKOnly
        Me.Text1(21).SetFocus
        Text1_GotFocus 21
        Exit Sub
    Else
        If Me.Text1(21).Text = "" Then
            frm090801_1.Label1(1).Caption = "申請人英文："
            frm090801_1.m_strCustChnName = Me.Text1(22).Text
            frm090801_1.m_Type = "2"
            bolUseEngName = True
        Else
            frm090801_1.Label1(1).Caption = "申請人中文：" 'Add By Sindy 2010/6/28
            frm090801_1.m_strCustChnName = Me.Text1(21).Text
            frm090801_1.m_Type = "0"
        End If
    End If
Case 1 '申請人2
    If Me.Text1(37).Text = "" And Me.Text1(38).Text = "" Then
        MsgBox "請輸入申請人中文或英文名稱的關鍵字!!!", vbExclamation + vbOKOnly
        Me.Text1(37).SetFocus
        Text1_GotFocus 37
        Exit Sub
    Else
        If Me.Text1(37).Text = "" Then
            frm090801_1.Label1(1).Caption = "申請人英文："
            frm090801_1.m_strCustChnName = Me.Text1(38).Text
            frm090801_1.m_Type = "2"
            bolUseEngName = True
        Else
            frm090801_1.Label1(1).Caption = "申請人中文：" 'Add By Sindy 2010/6/28
            frm090801_1.m_strCustChnName = Me.Text1(37).Text
            frm090801_1.m_Type = "0"
        End If
    End If
Case 2 '申請人3
    If Me.Text1(53).Text = "" And Me.Text1(54).Text = "" Then
        MsgBox "請輸入申請人中文或英文名稱的關鍵字!!!", vbExclamation + vbOKOnly
        Me.Text1(53).SetFocus
        Text1_GotFocus 53
        Exit Sub
    Else
        If Me.Text1(53).Text = "" Then
            frm090801_1.Label1(1).Caption = "申請人英文："
            frm090801_1.m_strCustChnName = Me.Text1(54).Text
            frm090801_1.m_Type = "2"
            bolUseEngName = True
        Else
            frm090801_1.Label1(1).Caption = "申請人中文：" 'Add By Sindy 2010/6/28
            frm090801_1.m_strCustChnName = Me.Text1(53).Text
            frm090801_1.m_Type = "0"
        End If
    End If
Case 3 '申請人4
    If Me.Text1(69).Text = "" And Me.Text1(70).Text = "" Then
        MsgBox "請輸入申請人中文名稱的關鍵字!!!", vbExclamation + vbOKOnly
        Me.Text1(69).SetFocus
        Text1_GotFocus 69
        Exit Sub
    Else
        If Me.Text1(69).Text = "" Then
            frm090801_1.Label1(1).Caption = "申請人英文："
            frm090801_1.m_strCustChnName = Me.Text1(70).Text
            frm090801_1.m_Type = "2"
            bolUseEngName = True
        Else
            frm090801_1.Label1(1).Caption = "申請人中文：" 'Add By Sindy 2010/6/28
            frm090801_1.m_strCustChnName = Me.Text1(69).Text
            frm090801_1.m_Type = "0"
        End If
    End If
Case 4 '申請人5
    If Me.Text1(85).Text = "" And Me.Text1(86).Text = "" Then
        MsgBox "請輸入申請人中文或英文名稱的關鍵字!!!", vbExclamation + vbOKOnly
        Me.Text1(85).SetFocus
        Text1_GotFocus 85
        Exit Sub
    Else
        If Me.Text1(85).Text = "" Then
            frm090801_1.Label1(1).Caption = "申請人英文："
            frm090801_1.m_strCustChnName = Me.Text1(86).Text
            frm090801_1.m_Type = "2"
            bolUseEngName = True
        Else
            frm090801_1.Label1(1).Caption = "申請人中文：" 'Add By Sindy 2010/6/28
            frm090801_1.m_strCustChnName = Me.Text1(85).Text
            frm090801_1.m_Type = "0"
        End If
    End If
'Add By Sindy 2010/5/27
Case 5 '代理人
    If Me.Text1(130).Text = "" Then
        MsgBox "請輸入代理人中文名稱的關鍵字!!!", vbExclamation + vbOKOnly
        Me.Text1(130).SetFocus
        Text1_GotFocus 130
        Exit Sub
    Else
        'Modified by Morgan 2020/7/2
        'frm090801_1.Label1(1).Caption = "代理人中文：" 'Add By Sindy 2010/6/28
        frm090801_1.Caption = "代理人資料查詢"
        frm090801_1.Label1(1).Caption = "代理人名稱："
        'end 2020/7/2
        frm090801_1.m_strCustChnName = Me.Text1(130).Text
        frm090801_1.m_Type = "1"
    End If
End Select

strTemp(1) = frm090801_1.m_strCustChnName 'Add By Sindy 2012/8/20
frm090801_1.lblName.Caption = frm090801_1.m_strCustChnName
m_blnOneRec = False
m_strCustCode = ""
If frm090801_1.StrMenu = True Then
   If frm090801_1.m_blnOneRec = False Then
      frm090801_1.Show vbModal
   End If
   m_blnOneRec = frm090801_1.m_blnOneRec
   m_strCustCode = frm090801_1.m_strCustCode
   strLang = frm090801_1.m_Lang 'Added by Morgan 2020/7/2
   Unload frm090801_1
Else
   Unload frm090801_1
End If
If m_blnOneRec = True And m_strCustCode <> "" Then
   Select Case Index
      Case 0 '申請人1
         Option31(1).Value = True 'Add By Sindy 2016/12/12 點選舊客戶
         Me.Text1(12).Text = m_strCustCode
         Text1_Validate 12, False
         'add by nickc 2005/04/07
         txtEnabled2 IIf(Option31(0).Value = True, True, False), Index + 1
      Case 1 '申請人2
         Option32(1).Value = True 'Add By Sindy 2016/12/12 點選舊客戶
         Me.Text1(28).Text = m_strCustCode
         Text1_Validate 28, False
         'add by nickc 2005/04/07
         txtEnabled2 IIf(Option32(0).Value = True, True, False), Index + 1
      Case 2 '申請人3
         Option33(1).Value = True 'Add By Sindy 2016/12/12 點選舊客戶
         Me.Text1(44).Text = m_strCustCode
         Text1_Validate 44, False
         'add by nickc 2005/04/07
         txtEnabled2 IIf(Option33(0).Value = True, True, False), Index + 1
      Case 3 '申請人4
         Option34(1).Value = True 'Add By Sindy 2016/12/12 點選舊客戶
         Me.Text1(60).Text = m_strCustCode
         Text1_Validate 60, False
         'add by nickc 2005/04/07
         txtEnabled2 IIf(Option34(0).Value = True, True, False), Index + 1
      Case 4 '申請人5
         Option35(1).Value = True 'Add By Sindy 2016/12/12 點選舊客戶
         Me.Text1(76).Text = m_strCustCode
         Text1_Validate 76, False
         'add by nickc 2005/04/07
         txtEnabled2 IIf(Option35(0).Value = True, True, False), Index + 1
      'Add By Sindy 2010/5/27
      Case 5 '代理人
         Me.Text1(5).Text = m_strCustCode
         Text1_Validate 5, False
         strLang = "" 'Added by Morgan 2020/7/2
   End Select
'Add By Sindy 2012/8/20 葉經理提輸入資料後才發現新客戶,點選新客戶後資料會被清掉,
'                       秀玲提議輸入名稱檢索後,若非舊客戶時,系統自動帶至新客戶選項
Else
   Select Case Index
      Case 0 '申請人1
         Option31(0).Value = True
         If bolUseEngName = True Then
            Me.Text1(22).Text = strTemp(1)
         Else
            Me.Text1(21).Text = strTemp(1)
         End If
      Case 1 '申請人2
         Option32(0).Value = True
         If bolUseEngName = True Then
            Me.Text1(38).Text = strTemp(1)
         Else
            Me.Text1(37).Text = strTemp(1)
         End If
      Case 2 '申請人3
         Option33(0).Value = True
         If bolUseEngName = True Then
            Me.Text1(54).Text = strTemp(1)
         Else
            Me.Text1(53).Text = strTemp(1)
         End If
      Case 3 '申請人4
         Option34(0).Value = True
         If bolUseEngName = True Then
            Me.Text1(70).Text = strTemp(1)
         Else
            Me.Text1(69).Text = strTemp(1)
         End If
      Case 4 '申請人5
         Option35(0).Value = True
         If bolUseEngName = True Then
            Me.Text1(86).Text = strTemp(1)
         Else
            Me.Text1(85).Text = strTemp(1)
         End If
   End Select
'2012/8/20 End
End If
End Sub

Private Sub Combo1_Click(Index As Integer)
    Select Case Index
    Case 1 ', 2, 3, 4
         If Val(LblCnt.Caption) > 0 And Combo1(Index).Text = Combo1(Index).Tag Then Exit Sub 'Add by Sindy 2022/8/29 修改相同案件性質,不需清空欄位值
         Me.Text1(101).Text = "" ' + (Index - 1) * 3
         Me.Text1(102).Text = "" '+ (Index - 1) * 3
         Me.Text1(103).Text = "" ' + (Index - 1) * 3
         Me.Combo2(Index - 1).Text = "" 'Add by Sindy 2022/8/29
         'Modified by Morgan 2020/4/17
         SrcSetButton
                        
    'Added by Morgan 2013/3/19
    Case 0
'         SetEntity
         SetElecApp 'Added by Morgan 2013/9/23
         SetEngAbs 'Added by Morgan 2013/9/26
         SetNewDrug 'Added by Morgan 2021/7/20
         SetCombo6 'Add By Sindy 2023/2/15
    End Select
End Sub

'Added by Morgan 2013/4/9
Private Sub SetOpt81(pCountry As String)
   Dim ii As Integer
   Dim bolCP81old As Boolean
   
   bolCP81old = IsoptCP81 'Added by Morgan 2019/4/26
   
   'Modified by Morgan 2016/3/25
   'If pCountry = "000" Or pCountry = "101" Or pCountry = "102" Then
   If (Text1(6) = "P" Or Text1(6) = "CFP") And (pCountry = "000" Or pCountry = "101" Or pCountry = "102") Then
   'end 2016/3/25
      IsoptCP81 = True
   'Added by Morgan 2019/4/12 +日本發明案有收文實審、領證、年費
   ElseIf Text1(6) = "CFP" And (pCountry = "011" And Left(Combo6, 1) = "1") Then
      IsoptCP81 = False
      '領證、年費必須適用減免才可設定(有實審在2019/4/1以後發文)
      m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/8/29 取得案件性質代碼
      'For ii = 1 To 4
         'If Trim(Left(Me.Combo1(ii).Text, 4)) = "416" Then
         If InStr(m_strCaseCPM, "416") > 0 Then
            IsoptCP81 = True
            'Exit For
         'ElseIf Trim(Left(Me.Combo1(ii).Text, 4)) = "601" Then
         ElseIf InStr(m_strCaseCPM, "601") > 0 Then
            IsoptCP81 = PUB_ChkJpDiscount(Text1(6), Text1(7), Right("0" & Text1(8), 1), Right("00" & Text1(9), 2), True)
            'Exit For
         'ElseIf Trim(Left(Me.Combo1(ii).Text, 4)) = "605" Then
         ElseIf InStr(m_strCaseCPM, "605") > 0 Then
            If Val(Text1(142).Text) <= 10 Then
               IsoptCP81 = PUB_ChkJpDiscount(Text1(6), Text1(7), Right("0" & Text1(8), 1), Right("00" & Text1(9), 2), True)
            End If
            'Exit For
         End If
      'Next ii
      
      'Added by Morgan 2019/4/26
      '若狀態有改時需讀取減免身分
      If IsoptCP81 = True And bolCP81old = False Then
         Call setCP811  '設定減免身分
         Call setCP812  '設定減免身分
         Call setCP813  '設定減免身分
         Call setCP814  '設定減免身分
         Call setCP815  '設定減免身分
      End If
      'end 2019/4/26
      
   'end 2019/4/19
   Else
      IsoptCP81 = False
   End If
   
   If IsoptCP81 Then
      optCP811(0).Enabled = True
      optCP811(1).Enabled = True
      optCP812(0).Enabled = True
      optCP812(1).Enabled = True
      optCP813(0).Enabled = True
      optCP813(1).Enabled = True
      optCP814(0).Enabled = True
      optCP814(1).Enabled = True
      optCP815(0).Enabled = True
      optCP815(1).Enabled = True
   Else
      optCP811(0).Enabled = False
      optCP811(1).Enabled = False
      optCP812(0).Enabled = False
      optCP812(1).Enabled = False
      optCP813(0).Enabled = False
      optCP813(1).Enabled = False
      optCP814(0).Enabled = False
      optCP814(1).Enabled = False
      optCP815(0).Enabled = False
      optCP815(1).Enabled = False
      Erase arrAD1516 'Added by Morgan 2016/3/25
   End If
End Sub

'Add By Sindy 2019/6/24
Private Sub Combo1_DropDown(Index As Integer)
   'If Index >= 1 And Index <= 4 Then
      'Modify By Sindy 2024/2/21
      'Call SetComboCase(Index, Combo1(Index).Text)
      Call frm090801_New_SetComboCase(Index, Combo1(Index).Text, Combo1(Index), Me.Text1(6).Text, _
            Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
      '2024/2/21 END
   'End If
End Sub

Private Sub Combo1_LostFocus(Index As Integer)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim ii As Integer
Dim bolShowMsg As Boolean
   
   'If m_blnCallPrint = True Then Exit Sub 'Add By Sindy 2014/7/25
   
   Select Case Index
      Case 0 '申請國家
'         SetEntity 'Added by Morgan 2013/3/19
         
          If Me.Combo1(Index).Text = "" Then
              'For ii = 1 To 4
                  Me.Combo1(1).Clear
                  GridCase.Clear: LblCnt.Caption = "": Call SetGrd 'Add By Sindy 2022/8/31
                  'Modify By Sindy 2024/2/21
                  'Call SetComboCase(1, "") '設定下拉選單 Add By Sindy 2022/10/14
                  Call frm090801_New_SetComboCase(1, "", Combo1(1), Me.Text1(6).Text, _
                        Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
                  '2024/2/21 END
              'Next ii
          Else
             arrNation = Split(Me.Combo1(Index).Text, " ")
             
            'Added by Morgan 2013/1/15
            If Text1(6) = "P" And arrNation(0) = "000" Then
               SSTab3.TabVisible(1) = True
            Else
               SSTab3.TabVisible(1) = False
            End If
            'end 2013/1/15
            
            'Mark by Amy 2015/10/22 秀玲:取消此控制
'            'Add By Sindy 2013/12/14 新案時申請國家為中國大陸020者收據公司別預設為智權公司
'            If strSrvDate(1) >= InvoiceStartDate Then
'               If Option1(0).Value = True And arrNation(0) = "020" Then
'                  Combo4.ListIndex = 3
'               End If
'            End If
'            '2013/12/14 END
               
'Modified by Morgan 2013/4/9 移到下面改呼叫函數
'              'add by nick 2004/10/05  若是台灣，美國，加拿大才要管減免
'              If arrNation(0) = "000" Or arrNation(0) = "101" Or arrNation(0) = "102" Then
'                  IsoptCP81 = True
'                  optCP811(0).Enabled = True
'                  optCP811(1).Enabled = True
'                  optCP812(0).Enabled = True
'                  optCP812(1).Enabled = True
'                  optCP813(0).Enabled = True
'                  optCP813(1).Enabled = True
'                  optCP814(0).Enabled = True
'                  optCP814(1).Enabled = True
'                  optCP815(0).Enabled = True
'                  optCP815(1).Enabled = True
'              Else
'                  IsoptCP81 = False
'                  optCP811(0).Enabled = False
'                  optCP811(1).Enabled = False
'                  optCP812(0).Enabled = False
'                  optCP812(1).Enabled = False
'                  optCP813(0).Enabled = False
'                  optCP813(1).Enabled = False
'                  optCP814(0).Enabled = False
'                  optCP814(1).Enabled = False
'                  optCP815(0).Enabled = False
'                  optCP815(1).Enabled = False
'              End If
            SetOpt81 "" & arrNation(0)
'end 2013/4/9

              '2011/9/15 add by sonia 系統類別+申請國家有改變才要重新預設案件性質的下拉選單,否則會把由期限資料畫面點選回來的案件性質清除(連續操作多件時)
              If Text1(6).Tag = Text1(6).Text And Combo1(0).Tag = Combo1(0).Text Then
                 Exit Sub
              End If
              '2011/9/15 end
              
              'Add By Sindy 2022/10/6
              'Modify By Sindy 2019/6/24
              'For ii = 1 To 4
                 Me.Combo1(1).Clear
                 GridCase.Clear: LblCnt.Caption = "": Call SetGrd
                 'Modify By Sindy 2024/2/21
                 'Call SetComboCase(1, "") '設定下拉選單
                 '抓案件性質下拉式選單
                 Call frm090801_New_SetComboCase(1, "", Combo1(1), Me.Text1(6).Text, _
                        Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
                 '2024/2/21 END
              'Next ii
              '2022/10/6 END
              
'              'Modify By Cheng 2004/03/15
'              '若系統類別為L, LA, FCL, CFL則案件性質代碼不要限制三碼及三碼以內
'              'edit by nickc 2005/03/02 案件性質台灣抓 cpm03 其餘抓 cpm04
'              'edit by nickc 2007/03/23  加入PCT 案件性質
'              StrSQLa = "Select CPM02||' '||" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, "decode(cpm02,'101','發明進入國家','102','新型進入國家' ,", "") & "Decode('" & arrNation(0) & "', '000', CPM03,CPM04)" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, ") ", "") & ",cpm02 From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<Decode(instr(CPM01,'L'), 0, 4, 5) And CPM01 Not In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000', CPM03, CPM04)<>'（無）' "
'              'Modify By Sindy 2016/5/11 取消查名轉換顯示[查名請改系統類別TS(內商)或S(外商)]字樣
'              'StrSQLa = StrSQLa & " Union Select CPM02||' '||Decode('" & arrNation(0) & "', '000',cpm03,'020', Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04), Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04)),cpm02 From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<4 And CPM01 In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000',cpm03,'020', Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04), Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04))<>'（無）' "
'              StrSQLa = StrSQLa & " Union Select CPM02||' '||Decode('" & arrNation(0) & "', '000',cpm03,CPM04),cpm02 From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<4 And CPM01 In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000',cpm03,CPM04)<>'（無）' "
'              '2016/5/11 END
'              'Added by Morgan 2012/12/25
'              '20130101 起台灣專利案105聯合申請與125衍生設計申請交換下拉功能列出的順序
'              If strSrvDate(1) >= "20130101" And Me.Text1(6).Text = "P" And arrNation(0) = "000" Then
'                  StrSQLa = "select * from (" & StrSQLa & ") Order By decode(cpm02,'105','125','125','105',cpm02)"
'              Else
'              'end 2012/12/25
'                  StrSQLa = StrSQLa & " Order By 1 "
'              End If
'              rsA.CursorLocation = adUseClient
'              rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
'              If rsA.RecordCount > 0 Then
'                  For ii = 1 To 4
'                      Me.Combo1(ii).Clear
'                  Next ii
'                  While Not rsA.EOF
'                     '2010/1/6 917 超頁、超項費不再使用
'                     'Modify By Sindy 2010/8/5 閉卷,不續辦,取消收文,緩衝期限不顯示出來
'                     'Modified by Morgan 2012/12/25 有 "目前無" 字樣不列
'                     'Modify by Amy 2017/01/20 +法務、顧問案雖不限碼數, 但不可為 9001通知開庭,9002其他來函
'                     If "" & rsA.Fields(0).Value <> "917 超頁、超項費" And _
'                        "" & rsA.Fields(0).Value <> "913 閉卷" And _
'                        "" & rsA.Fields(0).Value <> "704 閉卷" And _
'                        "" & rsA.Fields(0).Value <> "907 不續辦" And _
'                        "" & rsA.Fields(0).Value <> "703 不續辦" And _
'                        "" & rsA.Fields(0).Value <> "925 取消收文" And _
'                        "" & rsA.Fields(0).Value <> "718 取消收文" And _
'                        "" & rsA.Fields(0).Value <> "312 緩衝期限" And _
'                        "" & rsA.Fields(0).Value <> "9001 通知開庭" And _
'                        "" & rsA.Fields(0).Value <> "9002 其他來函" And _
'                        InStr("" & rsA.Fields(0).Value, "目前無") = 0 Then
'                        Me.Combo1(1).AddItem "" & rsA.Fields(0).Value
'                        Me.Combo1(2).AddItem "" & rsA.Fields(0).Value
'                        Me.Combo1(3).AddItem "" & rsA.Fields(0).Value
'                        Me.Combo1(4).AddItem "" & rsA.Fields(0).Value
'                     End If
'                     rsA.MoveNext
'                  Wend
'              Else
'                  For ii = 1 To 4
'                      Me.Combo1(ii).Clear
'                  Next ii
'              End If
'              If rsA.State <> adStateClosed Then rsA.Close
'              Set rsA = Nothing
              '2019/6/24 END
              
              '2010/3/1 ADD BY SONIA 抓台灣發明案實審規費
              arrNation = Split(Me.Combo1(0).Text, " ")
              m_416Fee = 0
              '2010/8/17 modify by sonia
              'm_416Fee = GetPatentOfficialFee(Text1(6), "416", "", m_strPA08, arrNation(0), "", , Text1(7), IIf(Text1(8) = "", "0", Text1(8)), IIf(Text1(9) = "", "00", Text1(9)))
              m_416Fee = GetPatentOfficialFee(Text1(6), "416", "", m_strPA08, arrNation(0), m_strPA16, m_strPA14, Text1(7), IIf(Text1(8) = "", "0", Text1(8)), IIf(Text1(9) = "", "00", Text1(9)))
              '2010/3/1 END
          End If
          Combo1(0).Tag = Combo1(0).Text   '2011/9/15 add by sonia
      Case 1 '案件性質, 2, 3, 4
          If Me.Combo1(Index).Text = "" Then
              Me.Text1(101).Text = "" ' + (Index - 1) * 3
              Me.Text1(102).Text = "" ' + (Index - 1) * 3
              Me.Text1(103).Text = "" ' + (Index - 1) * 3
          Else
              If Me.Text1(6).Text = "" Then
                  MsgBox "請輸入系統類別!!!", vbExclamation + vbOKOnly
                  Me.Text1(6).SetFocus
                  Exit Sub
              End If
              If Me.Combo1(0).Text = "" Then
                  MsgBox "請挑選申請國!!!", vbExclamation + vbOKOnly
                  Me.Combo1(0).SetFocus
                  Exit Sub
              End If
              
              'Add By Sindy 2010/01/19
              arrCaseProperty = Split(Me.Combo1(Index).Text, " ")
              '2014/3/7 modify by sonia 新案不清除,否則多國案時輸美國同時收701時會被清掉
              'Modified by Lydia 2018/07/16 +繼承(703)
              'Modify By Sindy 2023/2/15 +合併(702)
              If Option1(1).Value = True And ((Trim(Text1(6).Text) = "P" Or _
                  Trim(Text1(6).Text) = "FCP" Or _
                  Trim(Text1(6).Text) = "CFP") And _
                  (arrCaseProperty(0) = "701" Or arrCaseProperty(0) = "702" Or arrCaseProperty(0) = "703" Or arrCaseProperty(0) = "708")) Or _
                  ((Trim(Text1(6).Text) = "CFT" Or _
                  Trim(Text1(6).Text) = "CFC" Or _
                  Trim(Text1(6).Text) = "FCT" Or _
                  Trim(Text1(6).Text) = "T" Or _
                  Trim(Text1(6).Text) = "TB" Or _
                  Trim(Text1(6).Text) = "TC" Or _
                  Trim(Text1(6).Text) = "TF") And _
                  arrCaseProperty(0) = "501") Then
                  '申請人1
                  ClearCustTxt 1
'                  'Add By Sindy 2016/12/8 上列案件性質才有可能舊案新客戶
'                  Option31(0).Enabled = True
'                  Option31(1).Enabled = True
'                  '2016/12/8 END
                  '申請人2
                  ClearCustTxt 2
'                  'Add By Sindy 2016/12/8 上列案件性質才有可能舊案新客戶
'                  Option32(0).Enabled = True
'                  Option32(1).Enabled = True
'                  '2016/12/8 END
                  '申請人3
                  ClearCustTxt 3
'                  'Add By Sindy 2016/12/8 上列案件性質才有可能舊案新客戶
'                  Option33(0).Enabled = True
'                  Option33(1).Enabled = True
'                  '2016/12/8 END
                  '申請人4
                  ClearCustTxt 4
'                  'Add By Sindy 2016/12/8 上列案件性質才有可能舊案新客戶
'                  Option34(0).Enabled = True
'                  Option34(1).Enabled = True
'                  '2016/12/8 END
                  '申請人5
                  ClearCustTxt 5
'                  'Add By Sindy 2016/12/8 上列案件性質才有可能舊案新客戶
'                  Option35(0).Enabled = True
'                  Option35(1).Enabled = True
'                  '2016/12/8 END
              
              'Add By Sindy 2023/1/13
              '舊案,有人輸入移轉後客戶欄開放了輸入其他申請人資料,再把移轉改成延展送出
              ElseIf Option1(1).Value = True And Text1(9).Text <> "" _
                  And Combo1(Index).Tag <> Combo1(Index).Text And Val(Me.LblCnt) > 0 Then
                  bolShowMsg = False
                  
                  '申請人1
                  If Me.Text1(12 + (0) * 16).Text <> strAppl1 Then
                     bolShowMsg = True
                     ClearCustTxt 1
                     If strAppl1 <> "" Then
                         SetCustTxt 1, strAppl1
                         PUB_AddContact strAppl1, cboContact(1), strPA149, True, True, m_strContactList(1)
                     End If
                  End If
                  '申請人2
                  If Me.Text1(12 + (1) * 16).Text <> strAppl2 Then
                     bolShowMsg = True
                     ClearCustTxt 2
                     If strAppl2 <> "" Then
                         SetCustTxt 2, strAppl2
                         PUB_AddContact strAppl2, cboContact(2), , True, True, m_strContactList(2)
                     End If
                  End If
                  '申請人3
                  If Me.Text1(12 + (2) * 16).Text <> strAppl3 Then
                     bolShowMsg = True
                     ClearCustTxt 3
                     If strAppl3 <> "" Then
                         SetCustTxt 3, strAppl3
                         PUB_AddContact strAppl3, cboContact(3), , True, True, m_strContactList(3)
                     End If
                  End If
                  '申請人4
                  If Me.Text1(12 + (3) * 16).Text <> strAppl4 Then
                     bolShowMsg = True
                     ClearCustTxt 4
                     If strAppl4 <> "" Then
                         SetCustTxt 4, strAppl4
                         PUB_AddContact strAppl4, cboContact(4), , True, True, m_strContactList(4)
                     End If
                  End If
                  '申請人5
                  If Me.Text1(12 + (4) * 16).Text <> strAppl5 Then
                     bolShowMsg = True
                     ClearCustTxt 5
                     If strAppl5 <> "" Then
                         SetCustTxt 5, strAppl5
                         PUB_AddContact strAppl5, cboContact(5), , True, True, m_strContactList(5)
                     End If
                  End If
                  If bolShowMsg = True Then
                     MsgBox "申請人已被還原！", vbExclamation
                  End If
              End If
              '2010/01/19 End
              
              'Add by Morgan 2010/10/12
              'TwPtRefundAlert m_lngRefund
              'end 2010/10/12
              
               'Added by Morgan 2013/8/29
               '台灣專利授權(專屬授權)檢查
               If Option1(1).Value = True And Trim(Text1(6).Text) = "P" And Left(Combo1(0), 3) = "000" Then
               
                  'Added by Morgan 2019/10/28
                  '108.11.1新法 --玲玲(只提醒不預設)
                  If strSrvDate(1) >= 20191101 Then
                     '舉發案-補充說明
                     If Left(Combo1(Index), 3) = "206" Then
                        strExc(0) = "select pa23 from patent where pa01='" & Text1(6) & "' and pa02='" & Text1(7) & "' and pa03='" & Text1(8) & "' and pa04='" & Text1(9) & "' and pa23='3'"
                        intI = 1
                        Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                        If intI = 1 Then
                           MsgBox "舉發案要提出補充說明要在三個月內才受理，須繳納規費2000(舉發的發文日起算三個月)!!", vbExclamation
                        End If
                     End If
                     '新型案-更正
                     If Left(Combo1(Index), 3) = "402" And m_strPA08 = "2" Then
                        MsgBox "提更正必須是被舉發或申請技術報告審查中才能受理，須繳納規費2000!!", vbExclamation
                     End If
                  End If
                  'end 2019/10/28
                  
                  '授權
                  If Left(Combo1(Index), 3) = "704" Then
                     strExc(0) = "select * from caseprogress a where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Text1(8) & "' and cp04='" & Text1(9) & "' and cp10='709' and cp57 is null and cp54>=" & strSrvDate(1) & _
                        " and not exists(select * from caseprogress b where b.cp43=a.cp09 and b.cp10='705' and b.cp57 is null)"
                     intI = 1
                     Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                     If intI = 1 Then
                        MsgBox "本案已辦理專屬授權，無法再辦理授權!!", vbExclamation
                     End If
                  '專屬授權
                  ElseIf Left(Combo1(Index), 3) = "709" Then
                     strExc(0) = "select * from caseprogress a where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Text1(8) & "' and cp04='" & Text1(9) & "' and cp10 in ('704','709') and cp57 is null and cp54>=" & strSrvDate(1) & _
                     " and not exists(select * from caseprogress b where b.cp43=a.cp09 and b.cp10='705' and b.cp57 is null)"
                     intI = 1
                     Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                     If intI = 1 Then
                        If RsTemp("cp10") = "704" Then
                           MsgBox "本案授權期間尚未期滿，欲辦理專屬授權須待先前授權案期滿或撤回授權案，請與申請人確認!!", vbExclamation
                        Else
                           MsgBox "本案已辦理專屬授權，無法再辦理專屬授權!!", vbExclamation
                        End If
                     End If
                  
                  End If
               End If
               'end 2013/8/29
               
'               'Added by Morgan 2020/2/13
'               '收文442在途期間提醒
'               If Option1(1).Value = True And Trim(Text1(6).Text) = "P" And Left(Combo1(Index), 3) = "442" Then
'                  m_Msgbox = "收文【" & Combo1(Index) & "】須報請區主管"
'                  MsgBox m_Msgbox & "核可！", vbExclamation
'                  'Add By Sindy 2022/9/14
'                  If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
'                     txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
'                  End If
'                  '2022/9/14 END
'               End If
'               'end 2020/2/13
               
               'Added by Lydia 2021/04/16 接洽單CFP加拿大案(102)不可收文延期404；收答辯案(107)彈提醒並印在接洽單上！
               If Text1(6) = "CFP" And Trim(Left(Combo1(0), 4)) = "102" And Index >= 1 And Index <= 4 Then
                  If Trim(Left(Combo1(Index), 4)) = "404" Then
                     MsgBox "CFP加拿大案不可收文延期 !", vbExclamation
                     Combo1(Index).Text = ""
                     Combo1(Index).SetFocus
                  End If
                  If Trim(Left(Combo1(Index), 4)) = "107" Then
                     MsgBox "加拿大專利申請案之延期須備具正當理由，一旦專利局認為不符延期規定，本案將被視為放棄，請務必於期限前及時提出答辯。", vbInformation
                  End If
               End If
               'end 2021/04/16
               
               'Added by Lydia 2022/07/20 案件性質中文名稱中有「目前無」或「不再用」的字樣不可收文。
               If InStr(Trim(Combo1(Index)) & ",", "目前無") > 0 Or InStr(Trim(Combo1(Index)) & ",", "不再用") > 0 Then
                    MsgBox "【" & Combo1(Index) & "】不可收文！", vbCritical
                    Combo1(Index).Text = ""
                    Combo1(Index).SetFocus
               End If
               'end 2022/07/20
               
               'Add By Sindy 2015/4/1 延期案時,才顯示欲延期期限
               If ((Trim(Text1(6)) = "P" Or Trim(Text1(6)) = "CFP") And Left(Combo1(Index), 3) = "404") Or _
                  ((Trim(Text1(6)) = "T" Or Trim(Text1(6)) = "CFT") And Left(Combo1(Index), 3) = "303") Then
                  If Me.Option1(1).Value = True And Me.Text1(6).Text <> "" And Me.Text1(7).Text <> "" Then
                     Call CallFrm090801_2
                  End If
               End If
               '2015/4/1 END
               If Left(Label1(124).Caption, 4) = "專利種類" Then
                  Call SetCombo5_P 'Add by Amy 2016/06/06 +專利設計案案件性質
               End If
               
               SrcSetLCase False, Index 'Added by Morgan 2020/4/28 檢查
               
               'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅：
               '若填案件性質有113專利布局分析者則自動取消收據公司；或是客戶設定為不開發票CU144='N'者也自動取消收據公司；
               If strSrvDate(1) >= strACSdate1 Then
                    If Option1(0).Value = True And Text1(6) = "ACS" And Index >= 1 And Index <= 4 And Combo4.Text <> "" Then
                        If Trim(Left(Combo1(Index), 4)) = "113" Then
                           Combo4.ListIndex = 0
                           'Modify By Sindy 2022/9/9
'                           For intI = 1 To 4
'                              If intI <> Index Then
'                                 Call SetACSautoFee(intI) '重算其他收文
'                              End If
'                           Next intI
                           For intI = 1 To GridCase.Rows - 1
                              If (Val(LblCnt) <> Val(GridCase.TextMatrix(intI, 0)) And Val(LblCnt) > 0) Or _
                                 Val(LblCnt) = 0 Then
                                 '填欄位值方便SetACSautoFee檢查使用
                                 Combo1(2).Text = Trim(GridCase.TextMatrix(intI, 1)) '案件性質
                                 Text1(104).Text = Format(GridCase.TextMatrix(intI, 2), "###0")  '費用
                                 Text1(105).Text = Format(GridCase.TextMatrix(intI, 3), "###0") '規費
                                 Text1(106).Text = Format(GridCase.TextMatrix(intI, 4), "###0.000") '點數
                                 Combo2(1).Text = GridCase.TextMatrix(intI, 5) '備註
                                 Call SetACSautoFee(2) '重算其他收文
                              End If
                           Next intI
                           '2022/9/9 END
                        End If
                    End If
                    
                    'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅：案件性質為101~103Z時鎖住規費及點數欄(改案件性質>103Z時要放開)，當輸入費用後，自動依下列規則計算：
                    If Text1(6) = "ACS" And Index >= 1 And Index <= 4 Then
                        Call SetACSautoFee(Index) '模組化：提供重新計算
                    End If
               End If
               'end 2021/03/29
               
               'Added by Lydia 2022/10/14 ACS案TIPS提出驗證時客戶須向資策會繳交規費(類似專利申請之官方規費)，通常客戶會要求由本所先進行代收代付，
                                    '收文代收代付(706)時，系統判斷該道(706)前是否有收過案件性質(101)、(1012)、(1013)、(302)，於接洽單「案件說明事項處理情形」代入以下說明
               If Text1(6) = "ACS" And Option1(1).Value = True And Text1(7) <> "" And Trim(Left(Combo1(Index), 4)) = "706" And InStr(Text1(119), "匯款後請將收據掃描提供予顧服組") = 0 Then
                  strExc(0) = "select cp09,cp10 from caseprogress where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Left(Text1(8) & "0", 1) & "' and cp04='" & Left(Text1(9) & "00", 2) & "' and cp10 in ('101','1012','1013','302') and cp159=0 "
                  intI = 1
                  Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                  If intI = 1 Then
                     'Text1(119) = Text1(119).Text & vbCrLf & "匯款：" & vbCrLf & _
                                        "（華南銀行和平分行）98365070990017，戶名：財團法人資訊工業策進會，匯款後請將收據掃描提供予顧服組。"
                     'Modify By Sindy 2023/8/29 調整顯示內容
                     Text1(119) = Text1(119).Text & vbCrLf & _
                                  "(1)請於○/○前付款完成。" & vbCrLf & _
                                  "(2)請款單內容：品名：代收代付TIPS驗證/驗證申請費用(代收代付TIPS再驗證/驗證申請費用)/(代收代付TIPS抽驗/驗證申請費用)" & vbCrLf & _
                                  "(3)匯款：（兆豐國際商業銀行南台北分行）017-03009016889，戶名：財團法人資訊工業策進會，匯款後請將收據掃描提供予顧服組。"
                     '2023/8/29 END
                  End If
               End If
               'end 2022/10/14
          End If
          Combo1(Index).Tag = Combo1(Index).Text 'Add By Sindy 2023/1/13
   End Select
End Sub

'Modify By Sindy 2022/9/9 維持寫法,因檢查時有"重算其他收文"狀況
'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅：
'案件性質為101~103Z時鎖住規費及點數欄(改案件性質>103Z時要放開)，當輸入費用後，自動依下列規則計算：
Private Sub SetACSautoFee(ByVal tInx As Integer, Optional ByRef strCheck As String)
'tInx：案件性質輸入Combo1的Index
   
   'Added by Lydia 2021/04/27 因為10%尚未溝通好，先上其他控制
   Dim pRate As Double
   pRate = 0
   'end 2021/04/27
   m_strCaseCPM = GetAllCaseCPM ' 取得案件性質代碼
   
   If Me.Text1(6).Text = "ACS" And tInx >= 1 And tInx <= 4 And Trim(Combo1(tInx)) <> "" Then
      'Add By Sindy 2024/9/23 ACS之112智財顧問案件性質，開放可以智慧所出名
      If Me.Option1(0).Value = True Then '新案
         If (InStr(m_strCaseCPM, "112") > 0 Or Trim(Left(Combo1(tInx), 4)) = "112") Then
            Me.Combo4.Enabled = True
         Else
            Me.Combo4.Enabled = False
            If (InStr(m_strCaseCPM, "113") > 0 Or Trim(Left(Combo1(tInx), 4)) = "113") Then
               Combo4.ListIndex = 0
            Else
               'Modify By Sindy 2025/5/28 客戶設定為不開發票CU144='N'者也自動取消收據公司
               If Option1(0).Value = True And Text1(6) = "ACS" And _
                  (m_CU144(1) = "N" Or m_CU144(2) = "N" Or m_CU144(3) = "N" Or _
                   m_CU144(4) = "N" Or m_CU144(5) = "N") Then
                  Combo4.ListIndex = -1
               Else
               '2025/5/28 END
                  Combo4.Text = m_CompNameJ
               End If
            End If
         End If
      End If
      '2024/9/23 END
      If InStr("101,102,103", Trim(Left(Combo1(tInx), 3))) > 0 Then
         If Me.Text1(102 + (tInx - 1) * 3).Enabled = True Then
            Me.Text1(102 + (tInx - 1) * 3).Enabled = False
            Me.Text1(103 + (tInx - 1) * 3).Enabled = False
         End If
         If Val(Me.Text1(101 + (tInx - 1) * 3)) > 0 Then  '費用>0
             If Combo4.Text = m_CompNameJ Then
                  '甲、J公司時規費＝[費用－(費用/1.05)]+[(費用/1.05)*10%]，點數＝(費用－規費)/1000；例：費用210,000、規費＝10,000+20,000=30,000、點數180；
                  Me.Text1(102 + (tInx - 1) * 3) = (CDbl(Val(Me.Text1(101 + (tInx - 1) * 3))) - Round((CDbl(Val(Me.Text1(101 + (tInx - 1) * 3))) / 1.05), 0)) + Round((CDbl(Val(Me.Text1(101 + (tInx - 1) * 3))) / 1.05) * pRate, 0)
             Else
                  '乙、非J公司時規費=費用*10%，點數＝(費用－規費)/1000；例：費用210,000、規費＝21,000、點數189；
                  Me.Text1(102 + (tInx - 1) * 3) = Round(Val(Me.Text1(101 + (tInx - 1) * 3)) * pRate, 0)
             End If
             Me.Text1(103 + (tInx - 1) * 3) = Format((CDbl(Val(Me.Text1(101 + (tInx - 1) * 3))) - CDbl(Val(Me.Text1(102 + (tInx - 1) * 3)))) / 1000, "####0.000")
             strCheck = ""
         'Added by Lydia 2021/04/30 費用<=0,預設規費=0; ex.ACS-00064 舊案收101,因為先前已有收錢,所以無費用
         Else '包含點數
             Me.Text1(102 + (tInx - 1) * 3) = "0"
             Me.Text1(103 + (tInx - 1) * 3) = "0.000"
             strCheck = ""
         'end 2021/04/30
         End If
      ElseIf Trim(Left(Combo1(tInx), 4)) = "706" Then
          '案件性質706代收代付時，鎖住規費及點數欄，當輸入費用後，規費設定為輸入之費用，點數=0
          If Me.Text1(102 + (tInx - 1) * 3).Enabled = True Then
             Me.Text1(102 + (tInx - 1) * 3).Enabled = False
             Me.Text1(103 + (tInx - 1) * 3).Enabled = False
          End If
          If Val(Me.Text1(101 + (tInx - 1) * 3)) > 0 Then  '費用>0
              Me.Text1(102 + (tInx - 1) * 3) = Me.Text1(101 + (tInx - 1) * 3)
              Me.Text1(103 + (tInx - 1) * 3) = "0.000"
          End If
          strCheck = ""
      ElseIf Trim(Left(Combo1(tInx), 3)) > "103" Then '案件性質>103Z時
          If Combo4.Text = m_CompNameJ Then
              If Me.Text1(102 + (tInx - 1) * 3).Enabled = True Then
                 Me.Text1(102 + (tInx - 1) * 3).Enabled = False
                 Me.Text1(103 + (tInx - 1) * 3).Enabled = False
              End If
              '甲、J公司時鎖住規費及點數欄，當輸入費用後，自動計算規費＝[費用－(費用/1.05)]， 點數＝(費用－規費)/1000；例：費用420,000、規費＝20,000、點數40；
              Me.Text1(102 + (tInx - 1) * 3) = (CDbl(Val(Me.Text1(101 + (tInx - 1) * 3))) - Round((CDbl(Val(Me.Text1(101 + (tInx - 1) * 3))) / 1.05), 0))
              Me.Text1(103 + (tInx - 1) * 3) = Format((CDbl(Val(Me.Text1(101 + (tInx - 1) * 3))) - CDbl(Val(Me.Text1(102 + (tInx - 1) * 3)))) / 1000, "####0.000")
              strCheck = ""
          Else
             '乙、非J公司時如一般接洽單不鎖住規費及點數欄，由人員自行填寫費用、規費、點數欄，但檢查點數＝(費用－規費)/1000；例：費用420,000、規費＝0、點數42；
             GoTo JumpPart01
          End If
      Else
JumpPart01:
         If Me.Text1(102 + (tInx - 1) * 3).Enabled = False Then   '從鎖住規費改成非鎖住時，彈提醒
              If strCheck = "Y" Then  '列印前檢查
                  strCheck = MsgBox("[" & Combo1(tInx) & "]規費和點數請人工輸入!!" & vbCrLf & "是否繼續作業？", vbYesNo + vbDefaultButton2 + vbExclamation, "ACS案件收文")
                  If Val(strCheck) = vbYes Then
                      strCheck = ""
                  End If
              ElseIf strCheck = "A" Then '第2客戶以後有設定為不開發票,已先彈訊息
                  strCheck = ""
              Else
                  MsgBox "[" & Combo1(tInx) & "]規費和點數請人工輸入!!", vbExclamation, "ACS案件收文"
                  Me.SSTab1.Tab = 0 'Add By Sindy 2025/5/28
              End If
              Me.Text1(102 + (tInx - 1) * 3).Enabled = True
              Me.Text1(103 + (tInx - 1) * 3).Enabled = True
         Else
               strCheck = ""
         End If
      End If
   Else
      strCheck = ""
   End If
   
End Sub
'end 2021/03/29

''Modify By Sindy 2019/6/24
'Private Sub SetComboCase(ii As Integer, strText As String)
'Dim StrSQLa As String
'Dim rsA As New ADODB.Recordset
'Dim strText1 As String 'Added by Morgan 2022/7/14
'
'   If ii = 0 Then '申請國家
'      '申請國及發明人國籍
'      'Modify By Sindy 2023/3/2 排除224.UP
'      StrSQLa = "Select NA01, NA03 From Nation Where Length(NA01)=3 And NA01<='9999' And substr(NA02,3,1)='0'" & _
'                " And NA01 not in('224')"
'      'Add By Sindy 2019/7/9
'      If Me.Combo1(ii).ListIndex >= 0 Then
'         Me.Combo1(ii).Tag = Me.Combo1(ii).List(Me.Combo1(ii).ListIndex)
'      End If
'      If Me.Combo1(ii).Tag <> Me.Combo1(ii).Text Then
'         StrSQLa = StrSQLa & " and (na01||' '||na03 like '%" & strText & "%')"
'         'Added by Morgan 2022/7/14
'         strText1 = PUB_ConvFullChar(strText)
'         If strText1 <> strText Then
'            StrSQLa = StrSQLa & " or na01||' '||na03 like '%" & strText1 & "%'"
'         End If
'         'end 2022/7/14
'      End If
'      StrSQLa = StrSQLa & " Order By NA01"
'      '2019/7/9 END
'      rsA.CursorLocation = adUseClient
'      rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
'      Me.Combo1(0).Clear
'      While Not rsA.EOF
'          Me.Combo1(0).AddItem "" & rsA.Fields(0).Value & " " & rsA.Fields(1).Value
''          For i = 0 To 9
''             Me.Combo3(i).AddItem "" & rsA.Fields(0).Value & " " & rsA.Fields(1).Value
''          Next i
'          rsA.MoveNext
'      Wend
'
'   '案件性質
'   Else
'      'Modify By Sindy 2019/7/22
'      arrNation = Split(Me.Combo1(0).Text, " ") '申請國家
'      If UBound(arrNation) > 0 Then
'      '2019/7/22 END
'         'Modify By Cheng 2004/03/15
'         '若系統類別為L, LA, FCL, CFL則案件性質代碼不要限制三碼及三碼以內
'         'edit by nickc 2005/03/02 案件性質台灣抓 cpm03 其餘抓 cpm04
'         'edit by nickc 2007/03/23  加入PCT 案件性質
'         'Modified by Lydia 2020/11/06  ACS的4碼的10XX且小於103、12XX、19XX不出現。L、CFL、FCL、LIN、LA的4碼90XX不出現
'         'StrSQLa = "Select CPM02||' '||" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, "decode(cpm02,'101','發明進入國家','102','新型進入國家' ,", "") & "Decode('" & arrNation(0) & "', '000', CPM03,CPM04)" & IIf(ChkPCT.Value = vbChecked And 3.Enabled = True, ") ", "") & " as AA,cpm02 From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<Decode(instr(CPM01,'L'), 0, 4, 5) And CPM01 Not In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000', CPM03, CPM04)<>'（無）' "
'         'Memo by Lydia 2020/11/06 注意修改條件要一併修改Combo1_Validate
'         StrSQLa = "Select CPM02||' '||" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, "decode(cpm02,'101','發明進入國家','102','新型進入國家' ,", "")
'         StrSQLa = StrSQLa & "Decode('" & arrNation(0) & "', '000', CPM03,CPM04)" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, ") ", "") & " as AA,cpm02 "
'         StrSQLa = StrSQLa & "From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And CPM01 Not In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000', CPM03, CPM04)<>'（無）' "
'         If Me.Text1(6).Text = "ACS" Then
'              'Modified by Lydia 2020/11/23 改為ACS的4碼的100X、12XX、19XX不出現
'              'StrSQLa = StrSQLa & "and not(length(cpm02)=4 and (cpm02 <'103' or cpm02 like '12%' or cpm02 like '19%')) "
'              StrSQLa = StrSQLa & "and not(length(cpm02)=4 and (cpm02 like '100%' or cpm02 like '12%' or cpm02 like '19%')) "
'         ElseIf InStr(Me.Text1(6).Text, "L") > 0 Then '法務
'              StrSQLa = StrSQLa & "and not(length(cpm02)=4 and cpm02 > '900') "
'         Else  '其他：專利
'              StrSQLa = StrSQLa & "and Length(CPM02)<Decode(instr(CPM01,'L'), 0, 4, 5)"
'         End If
'         'end 2020/11/06
'
'         'Modify By Sindy 2016/5/11 取消查名轉換顯示[查名請改系統類別TS(內商)或S(外商)]字樣
'         'StrSQLa = StrSQLa & " Union Select CPM02||' '||Decode('" & arrNation(0) & "', '000',cpm03,'020', Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04), Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04)),cpm02 From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<4 And CPM01 In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000',cpm03,'020', Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04), Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04))<>'（無）' "
'         StrSQLa = StrSQLa & " Union Select CPM02||' '||Decode('" & arrNation(0) & "', '000',cpm03,CPM04) as AA,cpm02 From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<4 And CPM01 In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000',cpm03,CPM04)<>'（無）' "
'         '2016/5/11 END
'         'Added by Morgan 2012/12/25
'         '20130101 起台灣專利案105聯合申請與125衍生設計申請交換下拉功能列出的順序
'         If strSrvDate(1) >= "20130101" And Me.Text1(6).Text = "P" And arrNation(0) = "000" Then
'             StrSQLa = "select * from (" & StrSQLa & ") Order By decode(cpm02,'105','125','125','105',cpm02)"
'         Else
'         'end 2012/12/25
'             StrSQLa = StrSQLa & " Order By 1 "
'         End If
'
'         'Add By Sindy 2019/7/9
'         If Me.Combo1(ii).ListIndex >= 0 Then
'            Me.Combo1(ii).Tag = Me.Combo1(ii).List(Me.Combo1(ii).ListIndex)
'         End If
'         If Me.Combo1(ii).Tag <> Me.Combo1(ii).Text Then
'            StrSQLa = "select * from (" & StrSQLa & ") where AA like '%" & strText & "%'"
'         End If
'         '2019/7/9 END
'
'         rsA.CursorLocation = adUseClient
'   '      'Add By Sindy 2019/6/24
'   '      If strText <> "" Then
'   '         rsA.Open "select * from (" & StrSQLa & ") where AA like '%" & strText & "%'", cnnConnection, adOpenStatic, adLockReadOnly
'   '      Else
'   '      '2019/6/24 END
'            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
'   '      End If
'         If rsA.RecordCount > 0 Then
'      '       For ii = 1 To 4
'                 Me.Combo1(ii).Clear
'
'                 'Added by Morgan 2020/5/4
'                 If strText = "" Then
'                     Me.Text1(101).Text = "" ' + (ii - 1) * 3
'                     Me.Text1(102).Text = "" ' + (ii - 1) * 3
'                     Me.Text1(103).Text = "" ' + (ii - 1) * 3
'                 End If
'                 'end 2020/5/4
'      '       Next ii
'             While Not rsA.EOF
'                '2010/1/6 917 超頁、超項費不再使用
'                'Modify By Sindy 2010/8/5 閉卷,不續辦,取消收文,緩衝期限不顯示出來
'                'Modified by Morgan 2012/12/25 有 "目前無" 字樣不列
'                'Modify by Amy 2017/01/20 +法務、顧問案雖不限碼數, 但不可為 9001通知開庭,9002其他來函
'                'Modify By Sindy 2023/1/17 排除陳述聲明
'                If "" & rsA.Fields(0).Value <> "917 超頁、超項費" And _
'                   "" & rsA.Fields(0).Value <> "913 閉卷" And _
'                   "" & rsA.Fields(0).Value <> "704 閉卷" And _
'                   "" & rsA.Fields(0).Value <> "907 不續辦" And _
'                   "" & rsA.Fields(0).Value <> "703 不續辦" And _
'                   "" & rsA.Fields(0).Value <> "925 取消收文" And _
'                   "" & rsA.Fields(0).Value <> "718 取消收文" And _
'                   "" & rsA.Fields(0).Value <> "312 緩衝期限" And _
'                   "" & rsA.Fields(0).Value <> "9001 通知開庭" And _
'                   "" & rsA.Fields(0).Value <> "9002 其他來函" And _
'                   InStr("" & rsA.Fields(0).Value, "目前無") = 0 And _
'                   "" & rsA.Fields(0).Value <> "214 陳述聲明" Then
'
'                  'Add By Sindy 2024/2/21
'                  strExc(10) = "" & rsA.Fields(0).Value
'                  arrCaseProperty = Split(strExc(10), " ")
'                  If UBound(arrCaseProperty) > 0 Then
'                     If Me.Text1(6).Text = "CFT" Then
'                        If arrNation(0) = "018" Or arrNation(0) = "022" Then '馬來西亞、汶萊
'                           '馬來西亞、汶萊：不出現「304申請英文證明」
'                           If arrCaseProperty(0) = "304" Then '申請英文證明
'                              strExc(10) = ""
'                           End If
'                        Else
'                           '非馬來西亞、汶萊：不出現「111英譯證明(CFT用) 」
'                           If arrCaseProperty(0) = "111" Then '英譯證明(CFT用)
'                              strExc(10) = ""
'                           End If
'                        End If
'                     End If
'                     'Me.Combo1(ii).AddItem "" & rsA.Fields(0).Value
'                     If strExc(10) <> "" Then
'                        Me.Combo1(ii).AddItem strExc(10)
'                     End If
'                  End If
'                  '2024/2/21 END
'      '            Me.Combo1(2).AddItem "" & rsA.Fields(0).Value
'      '            Me.Combo1(3).AddItem "" & rsA.Fields(0).Value
'      '            Me.Combo1(4).AddItem "" & rsA.Fields(0).Value
'                End If
'                rsA.MoveNext
'             Wend
'         Else
'      '       For ii = 1 To 4
'                 Me.Combo1(ii).Clear
'      '       Next ii
'         End If
'      End If
'   End If
'
'   'Add By Sindy 2019/6/24
'   If strText <> "" Then
'      If Me.Combo1(ii).ListCount = 1 Then
'         Me.Combo1(ii).ListIndex = 0
'         Me.Combo1(ii).Tag = Me.Combo1(ii).Text 'Add By Sindy 2019/7/9
'      Else
'         Me.Combo1(ii) = strText
''         'Add By Sindy 2019/7/9
''         If Me.Combo1(ii).ListIndex >= 0 Then
''            Me.Combo1(ii).Tag = Me.Combo1(ii).List(Me.Combo1(ii).ListIndex)
''         End If
''         '2019/7/9 END
'      End If
'   End If
'   '2019/6/24 END
'
'   If rsA.State <> adStateClosed Then rsA.Close
'   Set rsA = Nothing
'End Sub

'Add by Morgan 2010/10/12
'台灣專利年費檢查是否有預繳年費可退
'Modified by Morgan 2021/4/19 +bol919Exists:是否已收文減免退費919,pChkLetter:是否檢查已通知可減免退費者
Private Sub TwPtRefundAlert(ByRef lngRefund As Long, Optional bolAlert As Boolean = True, Optional ByRef bol919Received As Boolean = False, Optional pChkLetter As Boolean = True)
   
   lngRefund = 0
   m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/8/29 取得案件性質代碼
   If Option1(1).Value = True And Trim(Text1(6).Text) = "P" And Left(Combo1(0), 3) = "000" And _
      (InStr(m_strCaseCPM, "605") > 0 Or Trim(Left(Me.Combo1(1).Text, 4)) = "605") Then
      ReDim Preserve pa(1 To TF_PA) As String
      pa(1) = Text1(6)
      pa(2) = Text1(7)
      pa(3) = Text1(8)
      pa(4) = Text1(9)
      If PUB_ChkRefund(pa, lngRefund, , , , , pChkLetter) Then
         bol919Received = PUB_ChkCPExist(pa, 減免退費, 1) 'Added by Morgan 2021/4/19
         
         If lngRefund > 0 And bolAlert Then
            'Modify by Morgan 2011/3/7
            'MsgBox "本案目前尚有預繳年費 " & Format(lngRefund, DDollar) & " 元未退，若欲扣除預繳年費請人工收文!!", vbInformation
            'MsgBox "本案目前尚有預繳年費 " & Format(lngRefund, DDollar) & " 元未退，此案只可人工收文!!", vbInformation
            m_Msgbox = "本案目前尚有預繳年費 " & Format(lngRefund, DDollar) & " 元未退！"
            If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
               txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
            End If
         End If
      End If
   End If
End Sub

Private Sub Combo1_Validate(Index As Integer, Cancel As Boolean)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim arrNA01
Dim strMsg As String 'Add by Amy 2016/08/16
Dim bolFind As Boolean 'Add By Sindy 2024/12/6
    
    Select Case Index
    Case 0 '申請國家
        If Me.Combo1(Index).Text <> "" Then
            arrNA01 = Split(Me.Combo1(Index).Text, " ")
            
'Modified by Morgan 2013/4/9
'            'add by nick 2004/10/05  若是台灣，美國，加拿大才要管減免
'            If arrNA01(0) = "000" Or arrNA01(0) = "101" Or arrNA01(0) = "102" Then
'                IsoptCP81 = True
'                optCP811(0).Enabled = True
'                optCP811(1).Enabled = True
'                optCP812(0).Enabled = True
'                optCP812(1).Enabled = True
'                optCP813(0).Enabled = True
'                optCP813(1).Enabled = True
'                optCP814(0).Enabled = True
'                optCP814(1).Enabled = True
'                optCP815(0).Enabled = True
'                optCP815(1).Enabled = True
'            Else
'                IsoptCP81 = False
'                optCP811(0).Enabled = False
'                optCP811(1).Enabled = False
'                optCP812(0).Enabled = False
'                optCP812(1).Enabled = False
'                optCP813(0).Enabled = False
'                optCP813(1).Enabled = False
'                optCP814(0).Enabled = False
'                optCP814(1).Enabled = False
'                optCP815(0).Enabled = False
'                optCP815(1).Enabled = False
'            End If
            SetOpt81 "" & arrNA01(0)
'end 2013/4/9

            'Modify By Sindy 2011/11/11 增加NA59
            StrSQLa = "Select NA01,NA03,NA59 From Nation Where Length(NA01)=3 And NA01<='9999' And substr(NA02,3,1)='0' And NA01='" & arrNA01(0) & "' Order By NA01 "
            rsA.CursorLocation = adUseClient
            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
            If rsA.RecordCount > 0 Then
                Me.Combo1(Index).Text = "" & rsA.Fields(0).Value & " " & rsA.Fields(1).Value
                'Add by Morgan 2004/5/20
                stCountry = "" & rsA.Fields(0).Value
                
                'edit by nick 2004/08/05
                'Call setCP81  '設定減免身分
                'edit by nick 2004/10/05
                If IsoptCP81 = True Then
                    Call setCP811  '設定減免身分
                    'add by nick 2004/08/05
                    Call setCP812  '設定減免身分
                    Call setCP813  '設定減免身分
                    Call setCP814  '設定減免身分
                    Call setCP815  '設定減免身分
                End If
                'Add By Sindy 2011/11/11
                m_NA59 = "" & rsA.Fields("NA59").Value
                'Call SetFrame16
                '2011/11/11 End
                'Call setFrame21 'Add By Sindy 2012/5/8
                
               If rsA.State <> adStateClosed Then rsA.Close
               Set rsA = Nothing
            Else
               If rsA.State <> adStateClosed Then rsA.Close
               Set rsA = Nothing
               'Modify By Sindy 2024/2/21
               'Modify By Sindy 2019/7/2
               'Call SetComboCase(0, Combo1(0).Text)
               Call frm090801_New_SetComboCase(0, Combo1(0).Text, Combo1(0), Me.Text1(6).Text, _
                     Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
               '2024/2/21 END
               If Combo1(0).Text <> "" And Combo1(0).ListCount > 1 Then
                  Cancel = True
                  SendMessage Combo1(0).hWnd, CB_SHOWDROPDOWN, True, ByVal 0&
                  Exit Sub
               Else
               '2019/7/2 END
                  If UBound(Split(Combo1(0).Text, " ")) = 0 Then
                     Cancel = True
                     MsgBox "申請國代號輸入錯誤!!!", vbExclamation + vbOKOnly
                     Exit Sub
                  End If
               End If
            End If
            
            'add by nickc 2007/05/17 加入馬德里一定要是 TF
            If arrNA01(0) = "238" And Text1(6) <> "TF" Then
                MsgBox "馬德里必須要收 TF !!!", vbExclamation + vbOKOnly
                Cancel = True
                Exit Sub
            End If
        End If
        SetElecApp 'Added by Morgan 2013/9/23
        SetEngAbs 'Added by Morgan 2013/9/26
        SetNewDrug 'Added by Morgan 2021/7/20
        Call SetFrmCol 'Add By Sindy 2022/12/26
        'SetCombo6 'Add By Sindy 2023/2/15 3/2:Mark,輸入申請人時會呼叫到此處,導致專利種類被清掉
        'Modify By Sindy 2023/4/24 人員若用輸入申請國家再按tab時須重抓商標類別
        If (Text1(6) = "T" Or Text1(6) = "TF") And Option1(0).Value = True Then
            SetCombo6
        End If
        '2023/4/24 END
        
        'Add by Amy 2019/12/04 同客戶(X16880030)新案先新增T台灣案(收據公司預帶專利商標),未清畫面直改新增CFT 日本案,收據公司別不會重帶
        If Me.Combo1(0).Tag <> Me.Combo1(0) And Text1(12) <> MsgText(601) Then
            CheckComp
        End If
        
    Case 1 '案件性質, 2, 3, 4
        If Me.Combo1(Index).Text <> "" Then
            If Me.Combo1(Index).ListCount > 0 Then
'               'Add By Sindy 2017/11/24 控管案件性質要依序輸入
'               For intI = 1 To Index - 1
'                  If Me.Combo1(intI).Text = "" Then
'                     MsgBox "請依序輸入案件性質欄位!!!", vbExclamation + vbOKOnly
'                     Cancel = True
'                     Exit Sub
'                  End If
'               Next intI
'               '2017/11/24 END
               
               arrNation = Split(Me.Combo1(0).Text, " ")
               arrCaseProperty = Split(Me.Combo1(Index).Text, " ")
               m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/8/31 取得案件性質代碼
               If m_strCaseCPM <> "" Then
                  'Modify by Amy 2016/09/14 +CFP集體設計/CFT跨類可重覆
                  'Modify by Amy 2016/12/23 +商標 502授權/504再授權 專利 704授權可重覆
                  'Modify by Sindy 2023/3/24 +ACS 1013抽驗 可重覆
                  'Modify By Sindy 2023/4/19 +CFP之113、114、122可重覆
                  'Modify By Sindy 2024/9/4 +CFT之304.申請英文證明 可重覆
                  If Not (Me.Text1(6).Text = "CFT" And InStr(m_strCaseCPM, "107") > 0 And arrCaseProperty(0) = "107") _
                    And Not (Me.Text1(6).Text = "CFT" And InStr(m_strCaseCPM, "304") > 0 And arrCaseProperty(0) = "304") _
                    And Not (Me.Text1(6).Text = "CFP" And ((InStr(m_strCaseCPM, "105") > 0 And arrCaseProperty(0) = "105") _
                                                        Or (InStr(m_strCaseCPM, "113") > 0 And arrCaseProperty(0) = "113") _
                                                        Or (InStr(m_strCaseCPM, "114") > 0 And arrCaseProperty(0) = "114") _
                                                        Or (InStr(m_strCaseCPM, "122") > 0 And arrCaseProperty(0) = "122"))) _
                    And Not (InStr(Me.Text1(6).Text, "T") > 0 And ((InStr(m_strCaseCPM, "502") > 0 And arrCaseProperty(0) = "502") Or (InStr(m_strCaseCPM, "504") > 0 And arrCaseProperty(0) = "504"))) _
                    And Not (InStr(Me.Text1(6).Text, "P") > 0 And InStr(m_strCaseCPM, "704") > 0 And arrCaseProperty(0) = "704") _
                    And Not (InStr(Me.Text1(6).Text, "ACS") > 0 And InStr(m_strCaseCPM, "1013") > 0 And arrCaseProperty(0) = "1013") Then
                       If Val(LblCnt.Caption) > 0 Then m_strCaseCPM = Replace(m_strCaseCPM, Left(Trim(GridCase.TextMatrix(Val(LblCnt.Caption), 1)), 3), "")
                       If InStr(m_strCaseCPM, arrCaseProperty(0)) > 0 Then
                          MsgBox "案件性質不得重覆!!!", vbExclamation + vbOKOnly
                          Cancel = True
                          Exit Sub
                       End If
                  End If
               End If
               
               'Modify By Cheng 2004/03/15
               '若系統類別為L, LA, CFL, FCL不要限制三碼及三碼以內
               'edit by nickc 2007/03/23  加入PCT 案件性質
               'edit by nickc 2007/05/25 案件性質改成，台灣抓CPM03 ，其他CPM04
               'Modified by Lydia 2020/11/06 ACS的4碼的10XX且小於103、12XX、19XX不出現。L、CFL、FCL、LIN、LA的4碼90XX不出現
               StrSQLa = "Select CPM02||' '||" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, "decode(cpm02,'101','發明進入國家','102','新型進入國家' ,", "") & "Decode('" & arrNation(0) & "', '000', CPM03, CPM04)" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, ") ", "") & " From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<Decode(instr(CPM01,'L'), 0, 4, 5) And CPM02='" & arrCaseProperty(0) & "' And CPM01 Not In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000', CPM03, CPM04)<>'（無）' "
               StrSQLa = "Select CPM02||' '||" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, "decode(cpm02,'101','發明進入國家','102','新型進入國家' ,", "")
                StrSQLa = StrSQLa & "Decode('" & arrNation(0) & "', '000', CPM03,CPM04)" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, ") ", "") & " "
                StrSQLa = StrSQLa & "From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And CPM01 Not In ('T','CFT','FCT') And CPM02='" & arrCaseProperty(0) & "' And Decode('" & arrNation(0) & "', '000', CPM03, CPM04)<>'（無）' "
                If Me.Text1(6).Text = "ACS" Then
                     'Modified by Lydia 2020/11/23 改為ACS的4碼的100X、12XX、19XX不出現
                     'StrSQLa = StrSQLa & "and not(length(cpm02)=4 and (cpm02 <'103' or cpm02 like '12%' or cpm02 like '19%')) "
                     StrSQLa = StrSQLa & "and not(length(cpm02)=4 and (cpm02 like '100%' or cpm02 like '12%' or cpm02 like '19%')) "
                ElseIf InStr(Me.Text1(6).Text, "L") > 0 Then '法務
                     StrSQLa = StrSQLa & "and not(length(cpm02)=4 and cpm02 > '900') "
                Else  '其他：專利
                     StrSQLa = StrSQLa & "and Length(CPM02)<Decode(instr(CPM01,'L'), 0, 4, 5)"
                End If
                'end 2020/11/06
         
               'Modify By Sindy 2016/5/11 取消查名轉換顯示[查名請改系統類別TS(內商)或S(外商)]字樣
               'StrSQLa = StrSQLa & " Union Select CPM02||' '||Decode('" & arrNation(0) & "', '000',cpm03,'020', Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04), Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04)) From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<4 And CPM02='" & arrCaseProperty(0) & "' And CPM01 In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000',cpm03,'020', Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04), Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04))<>'（無）' "
               StrSQLa = StrSQLa & " Union Select CPM02||' '||Decode('" & arrNation(0) & "', '000',cpm03,CPM04) From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<4 And CPM02='" & arrCaseProperty(0) & "' And CPM01 In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000',cpm03,CPM04)<>'（無）' "
               '2016/5/11 END
               StrSQLa = StrSQLa & " Order By 1 "
               If rsA.State = 1 Then rsA.Close
               rsA.CursorLocation = adUseClient
               rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
               If rsA.RecordCount > 0 Then
                   Me.Combo1(Index).Text = "" & rsA.Fields(0).Value
                   arrCaseProperty = Split(Me.Combo1(Index).Text, " ")
                   'Modify By Sindy 2024/12/6 改檢查案件性質的下拉式選單裡沒有此案件性質時,就不能輸入
                   bolFind = False
                   For intI = 0 To Me.Combo1(Index).ListCount - 1
                     If Me.Combo1(Index).List(intI) = Me.Combo1(Index).Text Then
                        bolFind = True
                        Exit For
                     End If
                   Next intI
                   If bolFind = False Then
                     MsgBox "案件性質不可為" & arrCaseProperty(1) & " !!!", vbExclamation + vbOKOnly
                     Cancel = True
                   End If
                   '2024/12/6 END
                   
'                   'Add By Sindy 2010/8/5 案件性質不可為閉卷,不續辦,取消收文,緩衝期限
'                   If (arrCaseProperty(0) = "913" Or arrCaseProperty(0) = "704") And _
'                       arrCaseProperty(1) = "閉卷" Then
'                       MsgBox "案件性質不可為閉卷 !!!", vbExclamation + vbOKOnly
'                       Cancel = True
'                   ElseIf (arrCaseProperty(0) = "907" Or arrCaseProperty(0) = "703") And _
'                             arrCaseProperty(1) = "不續辦" Then
'                       MsgBox "案件性質不可為不續辦 !!!", vbExclamation + vbOKOnly
'                       Cancel = True
'                   ElseIf (arrCaseProperty(0) = "925" Or arrCaseProperty(0) = "718") And _
'                             arrCaseProperty(1) = "取消收文" Then
'                       MsgBox "案件性質不可為取消收文 !!!", vbExclamation + vbOKOnly
'                       Cancel = True
'                   ElseIf (arrCaseProperty(0) = "312") And _
'                             arrCaseProperty(1) = "緩衝期限" Then
'                       MsgBox "案件性質不可為緩衝期限 !!!", vbExclamation + vbOKOnly
'                       Cancel = True
'                   'Add by Amy 2017/01/20 +法務、顧問案雖不限碼數, 但不可為 9001通知開庭,9002其他來函
'                   ElseIf arrCaseProperty(0) = "9001" And arrCaseProperty(1) = "通知開庭" Then
'                       MsgBox "案件性質不可為通知開庭 !!!", vbExclamation + vbOKOnly
'                       Cancel = True
'                   ElseIf arrCaseProperty(0) = "9002" And arrCaseProperty(1) = "其他來函" Then
'                       MsgBox "案件性質不可為其他來函 !!!", vbExclamation + vbOKOnly
'                       Cancel = True
'                   'end 2017/01/20
'                   'Modify By Sindy 2023/1/17 排除陳述聲明
'                   ElseIf arrCaseProperty(0) = "214" And arrCaseProperty(1) = "陳述聲明" Then
'                       MsgBox "案件性質不可為陳述聲明 !!!", vbExclamation + vbOKOnly
'                       Cancel = True
'                   'Add By Sindy 2024/6/19 CFT增設案件性質，代號112，使用證據(申請)。請於接洽記錄單控制僅CFT且為美國案方可收文
'                   ElseIf arrCaseProperty(0) = "112" And arrCaseProperty(1) = "使用證據" _
'                     And Not (Me.Text1(6).Text = "CFT" And arrNation(0) = "101") Then
'                        MsgBox "案件性質不可為" & arrCaseProperty(1) & " !!!", vbExclamation + vbOKOnly
'                        Cancel = True
'                   'Modify By Sindy 2024/11/20 CFP要增加案件性質209檢視中說，但僅限於內部收文用，故接洽記錄單要剔除不列在下拉選單，也要檢查不能收文。
'                   ElseIf Me.Text1(6).Text = "CFP" And arrCaseProperty(0) = "209" And arrCaseProperty(1) = "檢視中說" Then
'                        MsgBox "CFP案件性質不可為" & arrCaseProperty(1) & " !!!", vbExclamation + vbOKOnly
'                        Cancel = True
'                   End If
                   
                   'add by nickc 2005/05/27
'edit by nickc 2006/10/23 作廢
'                      If (arrCaseProperty(0) = "308" And (Text1(6) = "CFT" Or Text1(6) = "FCT" Or Text1(6) = "T" Or Text1(6) = "TF")) Or (arrCaseProperty(0) = "307" And (Text1(6) = "CFP" Or Text1(6) = "FCP" Or Text1(6) = "P")) Then
'                          MsgBox "分割案，請於   案件說明事項處理情形   輸入母案案號！", vbExclamation, "警告！"
'                      End If
                  If rsA.State <> adStateClosed Then rsA.Close
                  Set rsA = Nothing
               Else
                  If rsA.State <> adStateClosed Then rsA.Close
                  Set rsA = Nothing
                  'Modify By Sindy 2024/2/21
                  'Modify By Sindy 2019/7/2
                  'Call SetComboCase(Index, Combo1(Index).Text)
                  Call frm090801_New_SetComboCase(Index, Combo1(Index).Text, Combo1(Index), Me.Text1(6).Text, _
                        Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
                  '2024/2/21 END
                  If Combo1(Index).Text <> "" And Combo1(Index).ListCount > 1 Then
                     Cancel = True
                     SendMessage Combo1(Index).hWnd, CB_SHOWDROPDOWN, True, ByVal 0&
                     Exit Sub
                  Else
                  '2019/7/2 END
                     If UBound(Split(Combo1(Index).Text, " ")) = 0 Then
                        MsgBox "案件性質代號輸入錯誤!!!", vbExclamation + vbOKOnly
                        Cancel = True
                     End If
                  End If
                  'Cancel = True
               End If
               
               'Modify by Amy 2024/10/09 原程式改至ChkP429Or1606NoAdd605,避免漏改
               'Add by Amy 2016/08/16 +已收放棄專利權(429)且已發文及已通知專利權公告作廢(1606),不能再收文年費控制 ex:P-104016
               If InStr(Text1(6), "P") > 0 And (arrCaseProperty(0) = "605" Or arrCaseProperty(0) = "606" Or arrCaseProperty(0) = "607") Then
                  If ChkP429Or1606NoAdd605(Text1(6), Text1(7), Text1(8), Text1(9), Left(Me.Combo1(0).Text, 3), strMsg) = True Then
                     MsgBox strMsg, vbExclamation + vbOKOnly
                     Cancel = True
                     Exit Sub
                  End If
               End If
               'end 2016/08/16
               'end 2024/10/09
               
               'Added by Lydia 2021/08/11 增加提醒; (110/8/6周哲丞直接輸入接洽單為英國延展新案CFT-022505，沒有從歐盟舊案CFT-014360做收文；人工修正資料。)
               If Option1(0).Value = True And (Text1(6) = "CFP" Or Text1(6) = "CFT") And Trim(Left(Combo1(0).Text, 4)) = "201" And Trim(Text1(7) & Text1(8) & Text1(9)) = "" Then
                   'Modified by Lydia 2021/08/20 +增加委任代理人的提醒; ex.CFT-14933收文委任代理人+移轉
                   If Index = 1 And ((Text1(6) = "CFP" And (arrCaseProperty(0) = "607" Or arrCaseProperty(0) = "444")) Or (Text1(6) = "CFT" And (arrCaseProperty(0) = "102" Or arrCaseProperty(0) = "710"))) Then
                        MsgBox "是否為脫歐之英國案？" & vbCrLf & "若歐盟案為本所案件請改以歐盟案號收文，以便系統做案件之衍接管理。", vbInformation
                   End If
               End If
               'end 2021/08/11
               
               'Added by Morgan 2025/3/13
               '台灣申請案自請撤回提醒--韻丞
               'Modified by Morgan 2025/4/21 調整內容--韻丞
               If Text1(6) = "P" And Trim(Left(Combo1(0).Text, 4)) = "000" And arrCaseProperty(0) = "413" And Combo1(1).Tag <> Combo1(1) Then
                  MsgBox "若自申請日／優先權日已超過15個月撤回發明案仍會公開；申請案已收到審定書／處分書，因已不係屬審查程序中，申請案不能撤回。", vbInformation
               End If
               'end 2025/3/13
               
               'Add By Sindy 2010/11/22 送件方式
               'Added by Lydia 2015/11/26 所有T*案之送件方改為勾選"收款後送件",可不勾選
               Call SetFrame18
               
               'Add By Sindy 2012/6/6 依案件性質預設專利種類
               'Modified by Morgan 2012/12/27 +衍生設計125
               If InStr(Text1(6), "P") > 0 And Combo6.Visible = True Then
                 If arrCaseProperty(0) = "101" Or _
                    arrCaseProperty(0) = "109" Or _
                    arrCaseProperty(0) = "110" Or _
                    arrCaseProperty(0) = "118" Or _
                    arrCaseProperty(0) = "120" Then
                    Combo6 = "1": Call Combo6_Validate(Cancel)
                 ElseIf arrCaseProperty(0) = "102" Or _
                        arrCaseProperty(0) = "112" Then
                    Combo6 = "2": Call Combo6_Validate(Cancel)
                 ElseIf arrCaseProperty(0) = "103" Or _
                        arrCaseProperty(0) = "105" Or _
                        arrCaseProperty(0) = "125" Then
                    Combo6 = "3": Call Combo6_Validate(Cancel)
                 ElseIf arrCaseProperty(0) = "117" Then
                    Combo6 = "4": Call Combo6_Validate(Cancel)
                 End If
               End If
               '2012/6/6 End
               
               Call SetFrmCol 'Add By Sindy 2022/12/26
               Call SetEngAbs 'Add By Sindy 2023/8/16
               SetElecApp 'Add by Sindy 2023/2/24
               
               'Add By Sindy 2022/11/15
               If (Text1(6) = "P" Or Text1(6) = "FCP") And (arrCaseProperty(0) = "801" Or arrCaseProperty(0) = "802") Then
                  MsgBox "P 或 FCP 案已無 異議 或 異議答辯 程序!!!", vbExclamation
                  Cancel = True
                  '2022/11/15 END
               '2010/1/6 ADD BY SONIA 專利917超頁、超項費不再使用
               ElseIf arrCaseProperty(0) = "917" Then
                    MsgBox "專利917超頁、超項費不再使用，請改收 938超頁費 939超項費 !!!", vbExclamation '+ vbOKOnly
                    Cancel = True
               '2010/3/31 ADD BY SONIA 大陸專利案檢查421或423
               ElseIf Text1(6) = "P" And arrNation(0) = "020" Then
                  If Option1(1).Value = True And _
                     (arrCaseProperty(0) = "421" Or arrCaseProperty(0) = "423") And m_strPA10 <> "" Then
                     If m_strPA08 = "3" And Val(m_strPA10) < 20091001 Then
                        MsgBox "大陸外觀設計,申請日小於2009/10/1，不可收此案件性質 !!!", vbExclamation
                        Cancel = True
                     ElseIf arrCaseProperty(0) = "421" And (m_strPA08 <> "2" Or Val(m_strPA10) >= 20091001) Then
                        MsgBox "大陸實用新型或外觀設計,申請日大於2009/10/1，請改收 423申請專利權評價報告 !!!", vbExclamation
                        Cancel = True
                     ElseIf arrCaseProperty(0) = "423" And m_strPA08 = "2" And Val(m_strPA10) < 20091001 Then
                        MsgBox "大陸實用新型申請日小於2009/10/1, 請改收 421申請檢索報告 !!!", vbExclamation
                        Cancel = True
                     End If
                  End If
                  'Add By Sindy 2025/7/7 P大陸案不可收文105集體設計申請；同時彈訊息提醒
                  '「若為大陸外觀設計案之多項設計，請收原外觀設計案之案號，案件性質為966多項設計 !」
                  If Trim(Left(Combo1(Index), 4)) = "105" Then
                     MsgBox "若為大陸外觀設計案之多項設計，請收原外觀設計案之案號，" & vbCrLf & "案件性質為966多項設計 !", vbExclamation
                     Cancel = True
                  End If
                  '2025/7/7 END
'               Else
'                  'Modify By Cheng 2004/03/15
'                  '若系統類別為L, LA, CFL, FCL不要限制三碼及三碼以內
'                  'edit by nickc 2007/03/23  加入PCT 案件性質
'                  'edit by nickc 2007/05/25 案件性質改成，台灣抓CPM03 ，其他CPM04
'                  StrSQLa = "Select CPM02||' '||" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, "decode(cpm02,'101','發明進入國家','102','新型進入國家' ,", "") & "Decode('" & arrNation(0) & "', '000', CPM03, CPM04)" & IIf(ChkPCT.Value = vbChecked And ChkPCT.Enabled = True, ") ", "") & " From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<Decode(instr(CPM01,'L'), 0, 4, 5) And CPM02='" & arrCaseProperty(0) & "' And CPM01 Not In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000', CPM03, CPM04)<>'（無）' "
'                  'Modify By Sindy 2016/5/11 取消查名轉換顯示[查名請改系統類別TS(內商)或S(外商)]字樣
'                  'StrSQLa = StrSQLa & " Union Select CPM02||' '||Decode('" & arrNation(0) & "', '000',cpm03,'020', Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04), Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04)) From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<4 And CPM02='" & arrCaseProperty(0) & "' And CPM01 In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000',cpm03,'020', Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04), Decode(CPM02,'001','查名請改系統類別TS(內商)或S(外商)',CPM04))<>'（無）' "
'                  StrSQLa = StrSQLa & " Union Select CPM02||' '||Decode('" & arrNation(0) & "', '000',cpm03,CPM04) From CasePropertyMap Where CPM01='" & Me.Text1(6).Text & "' And Length(CPM02)<4 And CPM02='" & arrCaseProperty(0) & "' And CPM01 In ('T','CFT','FCT') And Decode('" & arrNation(0) & "', '000',cpm03,CPM04)<>'（無）' "
'                  '2016/5/11 END
'                  StrSQLa = StrSQLa & " Order By 1 "
'                  If rsA.State = 1 Then rsA.Close
'                  rsA.CursorLocation = adUseClient
'                  rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
'                  If rsA.RecordCount > 0 Then
'                      Me.Combo1(Index).Text = "" & rsA.Fields(0).Value
'                      arrCaseProperty = Split(Me.Combo1(Index).Text, " ")
'                      'Add By Sindy 2010/8/5 案件性質不可為閉卷,不續辦,取消收文,緩衝期限
'                      If (arrCaseProperty(0) = "913" Or arrCaseProperty(0) = "704") And _
'                          arrCaseProperty(1) = "閉卷" Then
'                          MsgBox "案件性質不可為閉卷 !!!", vbExclamation + vbOKOnly
'                          Cancel = True
'                      ElseIf (arrCaseProperty(0) = "907" Or arrCaseProperty(0) = "703") And _
'                                arrCaseProperty(1) = "不續辦" Then
'                          MsgBox "案件性質不可為不續辦 !!!", vbExclamation + vbOKOnly
'                          Cancel = True
'                      ElseIf (arrCaseProperty(0) = "925" Or arrCaseProperty(0) = "718") And _
'                                arrCaseProperty(1) = "取消收文" Then
'                          MsgBox "案件性質不可為取消收文 !!!", vbExclamation + vbOKOnly
'                          Cancel = True
'                      ElseIf (arrCaseProperty(0) = "312") And _
'                                arrCaseProperty(1) = "緩衝期限" Then
'                          MsgBox "案件性質不可為緩衝期限 !!!", vbExclamation + vbOKOnly
'                          Cancel = True
'                      'Add by Amy 2017/01/20 +法務、顧問案雖不限碼數, 但不可為 9001通知開庭,9002其他來函
'                      ElseIf arrCaseProperty(0) = "9001" And arrCaseProperty(1) = "通知開庭" Then
'                          MsgBox "案件性質不可為通知開庭 !!!", vbExclamation + vbOKOnly
'                          Cancel = True
'                      ElseIf arrCaseProperty(0) = "9002" And arrCaseProperty(1) = "其他來函" Then
'                          MsgBox "案件性質不可為其他來函 !!!", vbExclamation + vbOKOnly
'                          Cancel = True
'                      'end 2017/01/20
'                      End If
'                      'add by nickc 2005/05/27
''edit by nickc 2006/10/23 作廢
''                      If (arrCaseProperty(0) = "308" And (Text1(6) = "CFT" Or Text1(6) = "FCT" Or Text1(6) = "T" Or Text1(6) = "TF")) Or (arrCaseProperty(0) = "307" And (Text1(6) = "CFP" Or Text1(6) = "FCP" Or Text1(6) = "P")) Then
''                          MsgBox "分割案，請於   案件說明事項處理情形   輸入母案案號！", vbExclamation, "警告！"
''                      End If
'                  Else
'                     MsgBox "案件性質代號輸入錯誤!!!", vbExclamation + vbOKOnly
'                     Cancel = True
'                  End If
'                  If rsA.State <> adStateClosed Then rsA.Close
'                  Set rsA = Nothing
               End If
               
               Call ReadNextProgress(CStr(arrCaseProperty(0))) 'Add By Sindy 2015/9/15
            Else
               If Me.Text1(6).Text = "" Or Me.Combo1(0).Text = "" Then
                   MsgBox "請先設定系統類別或申請國!!!", vbExclamation + vbOKOnly
                   Me.Combo1(Index).Text = ""
               'Add By Sindy 2019/7/2
               Else
                  Cancel = True
                  MsgBox "案件性質代號輸入錯誤!!!", vbExclamation + vbOKOnly
                  Combo1(Index).Text = ""
                  'Modify By Sindy 2024/2/21
                  'Call SetComboCase(Index, Combo1(Index).Text)
                  Call frm090801_New_SetComboCase(Index, Combo1(Index).Text, Combo1(Index), Me.Text1(6).Text, _
                        Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
                  '2024/2/21 END
               '2019/7/2 END
               End If
            End If
        Else
            Call SetFrmCol 'Add By Sindy 2022/12/26
            SetElecApp 'Add by Sindy 2023/2/24
        End If
        
    End Select
    If Cancel = True Then
        'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 + And Me.Visible = True
        If Me.Combo1(Index).Enabled = True And Me.Visible = True Then Me.Combo1(Index).SetFocus

        Me.Combo1(Index).SelStart = 0
        Me.Combo1(Index).SelLength = Len(Me.Combo1(Index).Text)
    End If
End Sub

'Add By Sindy 2015/9/15
Private Sub ReadNextProgress(strCP10 As String)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset

   If Text1(1).Enabled = False Then Exit Sub
   
   Select Case Text1(6)
      Case "T"
         '補正,檢送同意書,放棄專用權
         If strCP10 = "201" Or strCP10 = "211" Or strCP10 = "206" Then
            '先讀 申請意見書且NP06 is null
            'Modify By Sindy 2024/12/6 秀玲說過期的法定期限不抓
            StrSQLa = "select * from nextprogress where " & ChgNextProgress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & _
                      " and np06 is null and np07='202' and np09>=" & strSrvDate(1) & _
                      " order by np08 asc"
            If rsA.State = 1 Then rsA.Close
            rsA.CursorLocation = adUseClient
            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
            If rsA.RecordCount > 0 Then
               rsA.MoveFirst
               Text1(1).Text = ChangeWStringToTString("" & rsA.Fields("np09")) '法定期限
               'Text1(2).Text = ChangeWStringToTString("" & rsA.Fields("np23")) '約定期限
               Text1(3).Text = ChangeWStringToTString("" & rsA.Fields("np08")) '本所期限
               If Trim(Text1(1)) <> "" Then Text1(1).Enabled = False
               If Trim(Text1(3)) <> "" Then Text1(3).Enabled = False
               'm_strGetNP01 = rsA.Fields("np01") '總收文號
            Else
               rsA.Close
               '再讀 申請意見書且np06='N'
               'Modify By Sindy 2024/12/6 秀玲說過期的法定期限不抓
               StrSQLa = "select * from nextprogress where " & ChgNextProgress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & _
                         " and np06='N' and np07='202' and np09>=" & strSrvDate(1) & _
                         " order by np08 desc"
               If rsA.State = 1 Then rsA.Close
               rsA.CursorLocation = adUseClient
               rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
               If rsA.RecordCount > 0 Then
                  rsA.MoveFirst
                  Text1(1).Text = ChangeWStringToTString("" & rsA.Fields("np09")) '法定期限
                  'Text1(2).Text = ChangeWStringToTString("" & rsA.Fields("np23")) '約定期限
                  Text1(3).Text = ChangeWStringToTString("" & rsA.Fields("np08")) '本所期限
                  If Trim(Text1(1)) <> "" Then Text1(1).Enabled = False
                  If Trim(Text1(3)) <> "" Then Text1(3).Enabled = False
                  'm_strGetNP01 = rsA.Fields("np01")  '總收文號
               End If
            End If
            If rsA.State <> adStateClosed Then rsA.Close
            Set rsA = Nothing
         End If
      Case Else
   End Select
End Sub

'Copy From frmacc1121 By Morgan 2004/6/10
'取得此客戶所開的收據抬頭, 並預設最近一次開的收據抬頭, 若無則預設申請人
Private Sub GetReceiptTitle()
   Dim strCustNo As String
   'add by nick 2004/08/05
   Dim AllCust As Integer
   Dim strTmp As String 'Add by Amy 2016/09/01 避免選單內資料重覆ex:P-094328
   
   m_strTitleName = Me.cboTitle.Text
   Me.cboTitle.Clear
   'add by nick 2004/08/05
   For AllCust = 1 To 5
        Select Case AllCust
        Case 1
            Me.cboTitle.AddItem Text1(21).Text
            strTmp = strTmp & ";" & Text1(21).Text 'Add by Amy 2016/09/01
            strCustNo = Text1(12)
        Case 2
            'Add by Amy 2016/09/01 +if
            If InStr(strTmp, ";" & Text1(37).Text) = 0 Then
                Me.cboTitle.AddItem Text1(37).Text
                strTmp = strTmp & ";" & Text1(28).Text
            End If
            strCustNo = Text1(28)
        Case 3
            'Add by Amy 2016/09/01 +if
            If InStr(strTmp, ";" & Text1(53).Text) = 0 Then
                Me.cboTitle.AddItem Text1(53).Text
                strTmp = strTmp & ";" & Text1(53).Text
            End If
            strCustNo = Text1(44)
        Case 4
            'Add by Amy 2016/09/01 +if
            If InStr(strTmp, ";" & Text1(69).Text) = 0 Then
                Me.cboTitle.AddItem Text1(69).Text
                strTmp = strTmp & ";" & Text1(69).Text
            End If
            strCustNo = Text1(60)
        Case 5
            'Add by Amy 2016/09/01 +if
            If InStr(strTmp, ";" & Text1(85).Text) = 0 Then
                Me.cboTitle.AddItem Text1(85).Text
                strTmp = strTmp & ";" & Text1(85).Text
            End If
            strCustNo = Text1(76)
        Case Else
        End Select
            If strCustNo <> "" Then
               'Modify By Sindy 2012/12/19 +and A0K09 is null剔除已作廢收據
               strSql = "Select Distinct A0K04 From ACC0K0 Where A0K03='" & strCustNo & "' and nvl(A0K09,0)=0 Order By 1 "
               CheckOC
               
               adoRecordset.CursorLocation = adUseClient
               adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
               If adoRecordset.RecordCount > 0 Then
                  While Not adoRecordset.EOF
                     'Modify by Amy 2016/09/01 避免選單內資料重覆
                     If "" & adoRecordset.Fields(0).Value <> Me.cboTitle.List(0) And InStr(strTmp, ";" & adoRecordset.Fields(0).Value) = 0 Then
                        Me.cboTitle.AddItem "" & adoRecordset.Fields(0).Value
                         strTmp = strTmp & ";" & "" & adoRecordset.Fields(0).Value
                     End If
                     adoRecordset.MoveNext
                  Wend
               End If
               CheckOC
               'Modify By Sindy 2012/12/19 +and A0K09 is null剔除已作廢收據
               strSql = "Select A0K04 From ACC0K0 Where A0K03='" & strCustNo & "' and nvl(A0K09,0)=0 Order By A0K02 Desc "
               adoRecordset.CursorLocation = adUseClient
               adoRecordset.MaxRecords = 1
               adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
               If adoRecordset.RecordCount > 0 Then
                  'Add By Sindy 2010/4/28 增加判斷若收據抬頭沒有點選其他時才帶入值
                  If Option2(1).Value = False Then
                     cboTitle = "" & adoRecordset.Fields(0).Value
                  Else
                     cboTitle = m_strTitleName
                  End If
               End If
               CheckOC
               adoRecordset.MaxRecords = 0
               
               'Add By Sindy 2010/4/15 代出該案號的最後一次的抬頭
               'Modify By Sindy 2012/12/19 +and A0K09 is null剔除已作廢收據
               If Me.Option1(1).Value = True And Me.Text1(6).Text <> "" And Me.Text1(7).Text <> "" Then
                  If Me.Text1(8).Text = "" Then Me.Text1(8).Text = "0"
                  If Me.Text1(9).Text = "" Then Me.Text1(9).Text = "00"
                  strSql = "select A0K04 from caseprogress,ACC0K0 " & _
                              "where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Text1(8) & "' and cp04='" & Text1(9) & "' " & _
                              "and cp60=A0K01(+) and A0K04 is not null and nvl(A0K09,0)=0 " & _
                              "Order By A0K02 Desc "
                  adoRecordset.CursorLocation = adUseClient
                  adoRecordset.MaxRecords = 1
                  adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
                  If adoRecordset.RecordCount > 0 Then
                     'Add By Sindy 2010/4/28 增加判斷若收據抬頭沒有點選其他時才帶入值
                     If Option2(1).Value = False Then
                        cboTitle = "" & adoRecordset.Fields(0).Value
                     Else
                        cboTitle = m_strTitleName
                     End If
                  End If
                  CheckOC
                  adoRecordset.MaxRecords = 0
               End If
               '2010/4/15 End
            End If
    'add by nick 2004/08/05
    Next AllCust
End Sub

'2008/9/3 add by sonia
Private Sub Combo3_Validate(Index As Integer, Cancel As Boolean)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim arrNA01

   If Trim(Me.Combo3(Index).Text) <> "" Then
      arrNA01 = Split(Me.Combo3(Index).Text, " ")
      'Modify By Sindy 2023/3/2 排除224.UP
      StrSQLa = "Select NA01, NA03 From Nation Where Length(NA01)=3 And NA01<='9999' And substr(NA02,3,1)='0' And NA01='" & arrNA01(0) & "'" & _
                " And NA01 not in('224') Order By NA01"
      rsA.CursorLocation = adUseClient
      rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
      If rsA.RecordCount > 0 Then
         If rsA.Fields(0) = "000" Then
             Me.Combo3(Index).Text = rsA.Fields(0).Value & " " & rsA.Fields(1).Value
             Me.Combo3(Index).Tag = rsA.Fields(0).Value & " " & "中華民國"
         Else
            Me.Combo3(Index).Text = rsA.Fields(0).Value & " " & rsA.Fields(1).Value
            Me.Combo3(Index).Tag = rsA.Fields(0).Value & " " & rsA.Fields(1).Value
         End If
      Else
          MsgBox "發明人國籍輸入錯誤!!!", vbExclamation + vbOKOnly
          Cancel = True
          Exit Sub
      End If
         
   Else
      If rsA.State <> adStateClosed Then rsA.Close
      Set rsA = Nothing
   End If
End Sub

'Add By Toni 2008/08/25
Private Sub cmdInventor_Click()
Dim i As Integer, varInventorNo As Variant
Dim strSql As String
'Add By Sindy 2012/4/26
Dim BolChkDataIsDel As Boolean
Dim intI As Integer, j As Integer
Dim old_strInventorNo As String
'2012/4/26 End
Dim bolInsData As Boolean 'Add By Sindy 2013/8/1
   
   strPetition = ""
   strInventorName = "" 'Add By Sindy 2011/1/31 +strInventorName
   For i = 0 To 4
      If Text1(12 + (i * 16)) <> "" Then
         strPetition = strPetition + Text1(12 + (i * 16)) + ","
      End If
   Next i
   If Right(strPetition, 1) = "," Then strPetition = Left(strPetition, Len(strPetition) - 1)
   old_strInventorNo = strInventorNo 'Add By Sindy 2012/4/26
   ModifyInventor strPetition, strInventorNo
   
   'Modify By Sindy 2014/12/11 暫時先鎖只能放10個發明人
   varInventorNo = Split(strInventorNo, ",")
   If UBound(varInventorNo) >= 10 Then
      strInventorNo = ""
      '截取前10個
      For i = 0 To UBound(varInventorNo)
         If i >= 10 Then Exit For
         strInventorNo = strInventorNo & "," & varInventorNo(i)
      Next i
      strInventorNo = Mid(strInventorNo, 2)
   End If
   '2014/12/11 END
   
   If strInventorNo <> "" Then
      'Add By Sindy 2012/4/26
      'If old_strInventorNo <> strInventorNo Then
         If Trim(Text2(0).Text) <> "" Or Trim(Text2(1).Text) <> "" Or Trim(Text2(2).Text) <> "" Or _
            Trim(Text2(3).Text) <> "" Or Trim(Text2(4).Text) <> "" Or Trim(Text2(5).Text) <> "" Or _
            Trim(Text2(6).Text) <> "" Or Trim(Text2(7).Text) <> "" Or Trim(Text2(8).Text) <> "" Or _
            Trim(Text2(9).Text) <> "" Then
            If MsgBox("畫面上已有發明人資料，是否要保留？", vbExclamation + vbYesNo) = vbYes Then
               BolChkDataIsDel = False
            Else
               BolChkDataIsDel = True
            End If
         Else
            BolChkDataIsDel = True
         End If
      '2012/4/26 End
         
         'Move by Lydia 2019/06/10 清空發明人資料;從下面移到上面 (杜燕文遇到選不保留發明人資料,但是地址沒清空)
         If BolChkDataIsDel = True Then
'            For i = 0 To 9
'               Text2(i) = ""
'               Text3(i) = ""
'               Combo3(i) = ""
'               Text4(i) = ""
'               ChkAddress(i).Value = 0 'Add By Sindy 2023/1/18
'               Label5(i).Tag = "" 'Add By Sindy 2023/1/18
'            Next
'            Call SetInventorCol 'Add By Sindy 2023/12/7
            Call ClearInventorCol 'Modify By Sindy 2024/7/8 清空畫面上發明人欄位值
         End If
         'end 2019/06/10
         
         varInventorNo = Split(strInventorNo, ",")
         For i = 0 To UBound(varInventorNo)
           'Modify by Morgan 2010/12/31 姓名,地址若無中文時改抓英日
           'strSql = "Select IN03,IN04,IN07,NA03,IN01,in11 From Inventor,Nation Where IN01||IN02='" & varInventorNo(i) & "' and IN11=NA01 Order By 1 "
           strSql = "Select IN03,nvl(nvl(IN04,IN05),IN06) IN04,nvl(nvl(IN07,IN08),IN09) IN07,NA03,IN01,in11,IN02 From Inventor,Nation Where IN01||IN02='" & varInventorNo(i) & "' and IN11=NA01 Order By 1 "
           
           CheckOC
           adoRecordset.CursorLocation = adUseClient
           adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
           bolInsData = False 'Add By Sindy 2013/8/1
           If adoRecordset.RecordCount <> 0 Then
               'Add By Sindy 2012/4/26
               If BolChkDataIsDel = True Then
                  intI = i
                  bolInsData = True 'Add By Sindy 2013/8/1
               Else
                  For j = 0 To 9
                     If Trim(Text2(j)) = "" Then
                        intI = j
                        bolInsData = True 'Add By Sindy 2013/8/1
                        Exit For
                     End If
                  Next j
               End If
               '2012/4/26 End
               
               'Modify By Sindy 2012/4/26 把i改為intI
   '            Text2(i) = adoRecordset.Fields(1)   'name
   '            'Add By Sindy 2011/1/31 +strInventorName
   '            If strInventorName <> "" Then strInventorName = strInventorName & ","
   '            strInventorName = strInventorName & Trim(Text2(i))
   '            '2011/1/31 End
   '
   '            If adoRecordset.Fields(5) = "000" Then
   '               Combo3(i) = adoRecordset.Fields(5) & " " & adoRecordset.Fields(3)
   '               Combo3(i).Tag = adoRecordset.Fields(5) & " " & "中華民國" 'nation
   '            Else
   '               Combo3(i) = adoRecordset.Fields(5) & " " & adoRecordset.Fields(3)
   '               Combo3(i).Tag = adoRecordset.Fields(5) & " " & adoRecordset.Fields(3)
   '            End If
   '
   '            If Not IsNull(adoRecordset.Fields(0)) Then
   '               Text3(i) = adoRecordset.Fields(0)    'ID
   '               Text3(i).Tag = adoRecordset("IN01") & "0"
   '            End If
   '
   '            If Not IsNull(adoRecordset.Fields(2)) Then
   '               Text4(i) = adoRecordset.Fields(2) 'address
   '               Text4(i).Tag = adoRecordset("IN07")
   '            End If
               If bolInsData = True Then 'Add By Sindy 2013/8/1 +if
                  'Modify By Sindy 2023/3/22 改成共用函數
                  '取得客戶發明人檔資料
                  Call GetInventorData(adoRecordset.Fields("IN01") & adoRecordset.Fields("IN02"), "", intI, "" & adoRecordset.Fields("IN03"))
                  Call SetInventorCol(CStr(intI)) 'Add By Sindy 2023/12/7 ex:P-132472(陳威廷 * 2位,A130974327的沒有新增到; 同時使用到 X530940125)
                  '2023/3/22 END
'                  Text2(intI) = adoRecordset.Fields(1)   'name
'                  'Add By Sindy 2011/1/31 +strInventorName
'                  If strInventorName <> "" Then strInventorName = strInventorName & ","
'                  strInventorName = strInventorName & Trim(Text2(intI))
'                  '2011/1/31 End
'
'                  If adoRecordset.Fields(5) = "000" Then
'                     Combo3(intI) = adoRecordset.Fields(5) & " " & adoRecordset.Fields(3)
'                     Combo3(intI).Tag = adoRecordset.Fields(5) & " " & "中華民國" 'nation
'                  Else
'                     Combo3(intI) = adoRecordset.Fields(5) & " " & adoRecordset.Fields(3)
'                     Combo3(intI).Tag = adoRecordset.Fields(5) & " " & adoRecordset.Fields(3)
'                  End If
'
'                  If Not IsNull(adoRecordset.Fields(0)) Then
'                     Text3(intI) = adoRecordset.Fields(0)    'ID
'                     Text3(intI).Tag = adoRecordset("IN01") & "0"
'                  'Add By Sindy 2016/12/7
'                  Else
'                     Text3(intI) = ""
'                     Text3(intI).Tag = ""
'                  End If
'                  '2016/12/7 End
'                  Label5(intI).Tag = adoRecordset("IN01") & adoRecordset("IN02") 'Add By Sindy 2023/1/18
'
'                  If Not IsNull(adoRecordset.Fields(2)) Then
'                     Text4(intI) = adoRecordset.Fields(2) 'address
'                     Text4(intI).Tag = adoRecordset("IN07")
'                  End If
               End If
           End If
         Next i
         Call SetColColor 'Add By Sindy 2023/1/18
         
         'Modify By Sindy 2011/1/31
         'For i = i + 1 To 9
         'Modify By Sindy 2012/4/26
         'For i = i To 9
         'Remove by Lydia 2019/06/10 先做清空
         'If BolChkDataIsDel = True Then
         '   For i = intI + 1 To 9
         ''2012/4/26 End
          '     Text2(i) = ""
          '     Text3(i) = ""
          '     Combo3(i) = ""
          '     Text4(i) = ""
          '  Next
         'End If
         'end 2019/06/10
      'End If
   Else  '清空
     Call ClearInventorCol 'Modify By Sindy 2024/7/8 清空畫面上發明人欄位值
   End If
End Sub

'Add By Sindy 2024/7/8 清空畫面上發明人欄位值
Private Sub ClearInventorCol()
Dim i As Integer
   
   For i = 0 To 9
      Text2(i) = ""
      Text3(i) = ""
      Combo3(i) = ""
      Text4(i) = ""
      ChkAddress(i).Value = 0 'Add By Sindy 2023/12/7
      Label5(i).Tag = "" 'Add By Sindy 2023/12/7
   Next
   Call SetInventorCol 'Add By Sindy 2023/12/7
End Sub

'Add By Sindy 2023/3/22 改寫共用函數
'取得客戶發明人檔資料
Private Sub GetInventorData(strINnber As String, strINname As String, intRow As Integer, strID As String)
   If strINnber = "" Then Exit Sub
   If Len(strINnber) < 8 Then Exit Sub
   
   strSql = "Select IN03,nvl(nvl(IN04,IN05),IN06) IN04,nvl(nvl(IN07,IN08),IN09) IN07,NA03,IN01,in11,IN02" & _
            " From Inventor,Nation" & _
            " Where IN11=NA01"
   If Len(strINnber) = 10 Then
      strSql = strSql & " and IN01||IN02='" & strINnber & "'"
   Else
      strSql = strSql & " and IN01='" & strINnber & "'"
      If strINname <> "" Then
         strSql = strSql & " and (IN04='" & strINname & "' or upper(IN05)=upper('" & strINname & "') or IN06='" & strINname & "')"
      End If
   End If
   'Add By Sindy 2023/12/7
   If strID <> "" Then
      strSql = strSql & " and IN03='" & strID & "'"
   End If
   '2023/12/7 END
   strSql = strSql & " Order By 1"
   CheckOC
   adoRecordset.CursorLocation = adUseClient
   adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
   'Modify By Sindy 2024/5/8
   'If adoRecordset.RecordCount <> 0 Then
   If adoRecordset.RecordCount = 1 Then
   '2024/5/8 END
      Text2(intRow) = adoRecordset.Fields(1) 'name
      
      If Not IsNull(adoRecordset.Fields(0)) Then
         Text3(intRow) = adoRecordset.Fields(0) 'ID
         Text3(intRow).Tag = adoRecordset("IN01") & "0"
      'Add By Sindy 2016/12/7
      Else
         Text3(intRow) = ""
         Text3(intRow).Tag = ""
      End If
      '2016/12/7 End
      
      'Add By Sindy 2011/1/31 +strInventorName
      'Modify By Sindy 2024/5/8 +ID P-133476 X530940125,27 發明人的中文同名同姓
      If InStr(strInventorName, Trim(Text2(intRow)) & Trim(Text3(intRow))) = 0 Then
         If strInventorName <> "" Then strInventorName = strInventorName & "|" '"," Modify By Sindy 2023/6/2
         strInventorName = strInventorName & Trim(Text2(intRow)) & Trim(Text3(intRow))
      End If
      '2011/1/31 End
      'Add By Sindy 2023/3/22
      If InStr(strInventorNo, adoRecordset.Fields("IN01") & adoRecordset.Fields("IN02")) = 0 Then
         If strInventorNo <> "" Then strInventorNo = strInventorNo & ","
         strInventorNo = strInventorNo & adoRecordset.Fields("IN01") & adoRecordset.Fields("IN02")
      End If
      '2023/3/22 END
      
      If adoRecordset.Fields(5) = "000" Then
         Combo3(intRow) = adoRecordset.Fields(5) & " " & adoRecordset.Fields(3)
         Combo3(intRow).Tag = adoRecordset.Fields(5) & " " & "中華民國" 'nation
      Else
         Combo3(intRow) = adoRecordset.Fields(5) & " " & adoRecordset.Fields(3)
         Combo3(intRow).Tag = adoRecordset.Fields(5) & " " & adoRecordset.Fields(3)
      End If
      
      If Not IsNull(adoRecordset.Fields(2)) Then
         Text4(intRow) = adoRecordset.Fields(2) 'address
         Text4(intRow).Tag = adoRecordset("IN07")
      End If
      
      Label5(intRow).Tag = adoRecordset("IN01") & adoRecordset("IN02") 'Add By Sindy 2023/1/18
   Else
      Label5(intRow).Tag = "" 'Add By Sindy 2023/12/7
   End If
End Sub
'2023/3/22 END

Private Sub Combo5_Click()
   'Added by Morgan 2013/9/26
   If Combo5.Tag <> Combo5 Then
      SetElecApp True
      SetNewDrug 'Added by Morgan 2021/7/20
   End If
   Combo5.Tag = Combo5
   'end 2013/9/26
End Sub

'Add By Sindy 2010/10/28
Private Sub Combo5_Validate(Cancel As Boolean)
   If Combo5 <> "" Then
      'Modify by Amy 2016/06/06 +專利設計案案件屬性
      If InStr(Text1(6), "P") > 0 And Left(Combo6, 1) = "3" Then
        Combo5 = Left(Combo5, 1) + "." + PUB_GetCaseAttributeName(Left(Combo5, 1), "3")
      Else
        Combo5 = Left(Combo5, 1) + "." + PUB_GetCaseAttributeName(Left(Combo5, 1))
      End If
      'end 2016/06/06
      If Combo5 = Left(Combo5, 1) + "." Then
         Combo5 = Left(Combo5, 1)
         Cancel = True
         SSTab1.Tab = 0
         'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用  +And Me.Visible = True
         If Combo5.Enabled = True And Me.Visible = True Then Combo5.SetFocus
      End If
   End If
   'Added by Morgan 2013/9/26
   If Combo5.Tag <> Combo5 Then
      SetElecApp True
   End If
   Combo5.Tag = Combo5
   'end 2013/9/26
End Sub
'2010/10/28 End

'Added by Morgan 2021/7/20
Private Sub Combo6_Click()
   If Combo6.Tag <> Combo6 Then
      SetNewDrug
   End If
   'Combo6.Tag = Combo6 'Removed by Morgan 2021/9/24
End Sub

'Add By Sindy 2012/4/26
Private Sub Combo6_Validate(Cancel As Boolean)
'Dim strTemp As String
'Dim arrCaseKind As Variant
'Dim i As Integer
'
'   If Combo6 <> "" Then
'      arrCaseKind = Split(Combo6.Text, ".")
'      '判斷是否需要詢問
'      For i = 0 To UBound(arrCaseKind)
'         If ClsPDGetPatentTrademarkKind(商標, CStr(arrCaseKind(0)), strTemp, False) = 1 Then
'            Exit For
'         Else
'            Cancel = True
'            SSTab1.Tab = 0
'            Combo6.SetFocus
'         End If
'      Next i
'   End If
   
   If Combo6 <> "" Then
      If InStr(Text1(6), "P") > 0 Then
         'Add by Amy 2016/06/06 +專利設計案案件性質
         Call SetCombo5_P
         Combo6 = Left(Combo6, 1) + "." + GetPKindName(Left(Combo6, 1))
         'Combo6.Tag = Combo6 'Removed by Morgan 2021/9/24 移到下面
         'end 2016/06/06
         'Modify By Sindy 2014/7/16 Mark
         'Call SetCombo5 'Add By Sindy 2012/9/3
      ElseIf InStr(Text1(6), "T") > 0 Then
         Combo6 = Left(Combo6, 1) + "." + GetTKindName(Left(Combo6, 1))
         'Add By Sindy 2024/10/1 商品類別 取消:(Left(Trim(Combo1(0)), 3) = "000" Or Left(Trim(Combo1(0)), 3) = "020") And
         If Option1(0).Value = True Then  '新案
            Text1(138).Enabled = True
            If Left(Combo6.Text, 1) = "7" Then '證明標章
               Text1(138) = "證"
               Text1(138).Enabled = False
            ElseIf Left(Combo6.Text, 1) = "8" Then '團體標章
               Text1(138) = "團"
               Text1(138).Enabled = False
            ElseIf Text1(138) = "證" Or Text1(138) = "團" Then
               Text1(138) = ""
            End If
         End If
         '2024/10/1 END
      End If
      If Combo6 = Left(Combo6, 1) + "." Then
         Combo6 = Left(Combo6, 1)
         Cancel = True
         SSTab1.Tab = 0
         'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 +And Me.Visible = True
         If Combo6.Enabled = True And Me.Visible = True Then Combo6.SetFocus
      End If
      
      Call SetCombo5 'Add By Sindy 2023/5/10
   End If
   Combo6.Tag = Combo6 'Added by Morgan 2021/9/24
End Sub
'2012/4/26 End

'Add by Sindy 2012/6/6
'專利種類代碼轉中文
Private Function GetPKindName(p_Code As String) As String
   GetPKindName = ""
   strSql = "select ptm02,ptm03 from patenttrademarkmap where ptm01='1' and ptm02 in('1','2','3') and ptm02='" & p_Code & "' order by ptm02 asc"
   intI = 1
   Set RsTemp = ClsLawReadRstMsg(intI, strSql)
   If intI = 1 Then
      If RsTemp.RecordCount > 0 Then
         GetPKindName = RsTemp.Fields("ptm03")
      End If
   End If
   Select Case p_Code
'      Case "1"
'         GetPKindName = "發明"
'      Case "2"
'         GetPKindName = "新型"
'      Case "3"
'         GetPKindName = "設計"
      Case "4"
         GetPKindName = "積體電路"
   End Select
   If GetPKindName = "" And p_Code <> "" Then
      MsgBox "專利種類錯誤！", vbExclamation
   End If
End Function

'商標種類代碼轉中文
Private Function GetTKindName(p_Code As String) As String
   GetTKindName = ""
   'Modify By Sindy 2023/11/15
   'strSql = "select ptm02,ptm03 from patenttrademarkmap where ptm01='2' and ptm02 in('1','7','8','9') and ptm02='" & p_Code & "' order by ptm02 asc"
   strSql = GetCombo6_T_SQL(p_Code)
   '2023/11/15 END
   intI = 1
   Set RsTemp = ClsLawReadRstMsg(intI, strSql)
   If intI = 1 Then
      If RsTemp.RecordCount > 0 Then
         GetTKindName = RsTemp.Fields("ptm03")
      End If
   End If
'   Select Case p_Code
'      Case "1"
'         GetTKindName = "商標"
'      Case "7"
'         GetTKindName = "證明標章"
'      Case "8"
'         GetTKindName = "團體標章"
'      Case "9"
'         GetTKindName = "團體商標"
'   End Select
   If GetTKindName = "" And p_Code <> "" Then
      MsgBox "商標種類錯誤！", vbExclamation
   End If
End Function
'2012/6/6 End

'Add By Sindy 2022/9/21
' 更新各控制項的狀態
Private Sub SetCtrlReadOnly(ByVal bEnable As Boolean)
Dim objText As Object
Dim objChk As Object
Dim objCbo As Object
Dim objOpt As Object
Dim objCom As Object
Dim objFra As Object
   
   Me.Text5.Locked = bEnable
   
   cmdUpd.Visible = Not bEnable
   cmdDel.Visible = Not bEnable
   cmdClear2.Visible = Not bEnable
   'cmdOK(3).Visible = Not bEnable
   For Each objCom In Me.cmdQual
      objCom.Visible = Not bEnable
   Next
   For Each objCom In Me.cmdSerach
      objCom.Visible = Not bEnable
   Next
   For Each objCom In Me.cmdTW
      objCom.Visible = Not bEnable
   Next
   For Each objCom In Me.CmdSame
      objCom.Visible = Not bEnable
   Next
   For Each objCom In Me.cmdSearchZip
      objCom.Visible = Not bEnable
   Next
   cmdInventor.Visible = Not bEnable
   cmdPic.Visible = Not bEnable
   cmdTMQApp.Visible = Not bEnable
   cmdTMQ.Visible = Not bEnable
   'Added by Lydia 2024/11/11 查名單(網中)
   If m_UseTmqTma = "2" Then
      If Not nfrm090126_New Is Nothing Then
         cmdTMQApp.Visible = False
      End If
   Else
   'end 2024/11/11
      'Added by Lydia 2023/08/17 判斷是否有查名單輸入
      If TypeName(Tmpfrm090126) = "Nothing" Then
         cmdTMQApp.Visible = False
      End If
      'end 2023/08/17
   End If 'Added by Lydia 2024/11/11
   
'   Me.txtCRL69.Locked = bEnable: Me.txtCRL70.Locked = bEnable
   For Each objText In Me.TxtC1
      objText.Locked = bEnable
   Next
   For Each objText In Me.txtYear
      objText.Locked = bEnable
   Next
   For Each objText In Me.txtMonth
      objText.Locked = bEnable
   Next
   For Each objText In Me.txtDay
      objText.Locked = bEnable
   Next
   Me.txtItemCount.Locked = bEnable
   Me.txtItemList.Locked = bEnable
   
   For Each objText In Me.Text1
      objText.Locked = bEnable
      'objText.Enabled = Not bEnable
   Next
   Text1(100).Locked = True '相同案號欄位,固定鎖住
   
   For Each objText In Me.Text2
      objText.Locked = bEnable
      'objText.Enabled = Not bEnable
   Next
   For Each objText In Me.Text3
      objText.Locked = bEnable
      'objText.Enabled = Not bEnable
   Next
   For Each objText In Me.Text4
      objText.Locked = bEnable
      'objText.Enabled = Not bEnable
   Next
   Me.Text7.Locked = bEnable
   'Me.Text7.Enabled = Not bEnable
   
   'Modify By Sindy 2023/6/14 原有執行過查詢(圖形附檔),但又變(其他)
'   For Each objOpt In Me.opt1
'      objOpt.Enabled = Not bEnable
'   Next
   Frame15.Enabled = Not bEnable
   '2023/6/14 END
   
   For Each objOpt In Me.Opt45
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.OptChoose
      objOpt.Enabled = Not bEnable
   Next
   
   'Modify By Sindy 2023/6/14
'   For Each objOpt In Me.optColor
'      objOpt.Enabled = Not bEnable
'   Next
   Frame17.Enabled = Not bEnable
   '2023/6/14 END
   
'   For Each objOpt In Me.OptCP122
'      objOpt.Enabled = Not bEnable
'   Next
   For Each objOpt In Me.OptCRL133
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.OptEntity
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.OptEP06
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.OptEP34
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.OptCP143
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.optCP811
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.optCP812
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.optCP813
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.optCP814
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.optCP815
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option1
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option2
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option3
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option31
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option32
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option33
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option34
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option35
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option4
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option5
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option6
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option8
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.Option9
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.OptNewDrug
      objOpt.Enabled = Not bEnable
   Next
   For Each objOpt In Me.OptSendType
      objOpt.Enabled = Not bEnable
   Next
   
   For Each objCbo In Me.Combo1
      objCbo.Locked = bEnable
   Next
   For Each objCbo In Me.Combo2
      objCbo.Locked = bEnable
   Next
   For Each objCbo In Me.Combo3
      objCbo.Locked = bEnable
   Next
   Me.Combo4.Locked = bEnable
   Me.Combo5.Locked = bEnable
   Me.Combo6.Locked = bEnable
'   Me.Combo7.Locked = bEnable
   For Each objCbo In Me.cboContact
      objCbo.Locked = bEnable
   Next
   Me.cboTitle.Locked = bEnable
   
   Me.Check1.Enabled = Not bEnable
   
   Me.FrameCRL66.Enabled = Not bEnable
   Me.FrameCRL90.Enabled = Not bEnable
   Me.FrameCRL147.Enabled = Not bEnable
   Me.ChkCRL152.Enabled = Not bEnable 'Add By Sindy 2023/4/7
   Me.Check10.Enabled = Not bEnable 'Add By Sindy 2025/4/14
   
   Frame3.Enabled = Not bEnable 'Add By Sindy 2023/12/12
   
   Me.Check2.Enabled = Not bEnable
   For Each objChk In Me.Check3
      objChk.Enabled = Not bEnable
   Next
   Me.Check4.Enabled = Not bEnable
   Me.Check5.Enabled = Not bEnable
   For Each objChk In Me.Check6
      objChk.Enabled = Not bEnable
   Next
   For Each objChk In Me.Check7
      objChk.Enabled = Not bEnable
   Next
   For Each objChk In Me.Check8
      objChk.Enabled = Not bEnable
   Next
   Me.Check9.Enabled = Not bEnable
   For Each objChk In Me.ChkAddress
      objChk.Enabled = Not bEnable
   Next
   For Each objFra In Me.Frame30
      objFra.Enabled = Not bEnable
   Next
'   For Each objChk In Me.ChkCRA26
'      objChk.Enabled = Not bEnable
'   Next
'   For Each objChk In Me.ChkCRA27
'      objChk.Enabled = Not bEnable
'   Next
   For Each objChk In Me.chkItem
      objChk.Enabled = Not bEnable
   Next
   Me.ChkPCT.Enabled = Not bEnable
End Sub

Private Sub Form_Activate()
   If Me.Enabled = True Then
      'Modify By Sindy 2019/2/15 + And cmdOK(1).Tag = ""
      '在高國碩86047電腦作業方式如下:
      '1.執行接洽單
      '2.執行申請人查詢(三晃股公司)
      '3.執行案件(P120493)----進卷宗區
      '出現附檔畫面：頁面跳動不停、當機。
      'Modify By Sindy 2024/3/25
      'If Text1(10).Enabled = True And cmdOK(1).Tag = "" Then Text1(10).SetFocus
      If Me.Text1(10).Enabled = True And Me.Visible = True And cmdOK(1).Tag = "" Then
         Me.Text1(10).SetFocus
      End If
      '2024/3/25 END
      '2019/2/15 END
      '判斷回傳之申請人地址欄位　ex:BackIntField=1為申請人1聯絡地址
      'Memo 進地址查詢後,若原沒輸鄉/鎮/市/區會加入帶回原地址欄
      If Val(BackIntField) <> 0 Then
            intTWAddr(BackIntField) = 1
            Select Case BackIntField
                Case 1
                    Text1(26).Tag = Me.Tag
                Case 2
                    Text1(27).Tag = Me.Tag
                Case 3
                    Text1(42).Tag = Me.Tag
                Case 4
                    Text1(43).Tag = Me.Tag
                Case 5
                    Text1(58).Tag = Me.Tag
                Case 6
                    Text1(59).Tag = Me.Tag
                Case 7
                    Text1(74).Tag = Me.Tag
                Case 8
                    Text1(75).Tag = Me.Tag
                Case 9
                    Text1(92).Tag = Me.Tag
                Case 10
                    Text1(91).Tag = Me.Tag
            End Select
            Me.Tag = MsgText(601)
            BackIntField = 0
      End If
   End If
   
   'Added by Morgan 2020/5/14
   If cmdOK(1).Tag = "" Then
      SrcLoadCheck
      If strCheckStatus <> "" Then SrcSetButton 'Add By Sindy 2024/9/24
   End If
   'end 2020/5/14
   cmdOK(1).Tag = "接洽單第一次開啟" 'Add By Sindy 2019/2/15
   
   'Add By Sindy 2023/2/18
   If cmdAddAtt.Visible = True And cmdAddAtt.Caption = "卷宗區" Then
      strExc(0) = "Select * " & _
                    "From CasePaperPDF " & _
                  "Where cpp11 ='" & Trim(Text5) & "' and cpp10<>'D' and substr(upper(cpp02),-4)<>upper('.del') and substr(upper(cpp02),-6)<>upper('.order') " & _
                  "order by cpp02 asc "
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 1 Then
         Me.cmdAddAtt.BackColor = &HC0C0FF '粉紅色
      End If
   End If
   '2023/2/18 END
End Sub

'Add by Morgan 2010/12/14 只要鍵盤有動作就不斷線
Private Sub Form_KeyPress(KeyAscii As Integer)
   If UCase(Forms(0).Name) = "MDIMAIN" Then Forms(0).tmrConnect.Tag = 0
End Sub

'Add By Sindy 2022/9/12
Private Sub SetListScroll(oList As ListBox)
   Dim ii As Integer
   Dim lWnow As Long, lWmax As Long
   
   lWmax = 0
   For ii = 0 To oList.ListCount - 1
      lWnow = TextWidth(oList.List(ii) & " ")
      If lWnow > lWmax Then
         lWmax = lWnow
      End If
   Next
  
   If ScaleMode = vbTwips Then lWmax = lWmax / Screen.TwipsPerPixelX  ' if twips change to pixels
   SendMessageByNum oList.hWnd, LB_SETHORIZONTALEXTENT, lWmax, 0
End Sub

Private Sub Form_Load()
Dim ii As Integer
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim i As Integer
Dim objCbo As Object
   
   MoveFormToCenter Me
   Me.lblDate.BackColor = &H8000000F
   Me.lblStaffName.BackColor = &H8000000F
   Me.lblZone.BackColor = &H8000000F
   Me.SSTab1.Tab = 0
   Me.SSTab2.Tab = 0
   Me.SSTab3.Tab = 0 'Add By Sindy 2014/7/28
   'SSTab1.TabEnabled(4) = False 'Add By Sindy 2009/08/31
   SSTab1.TabEnabled(4) = True 'Add By Sindy 2010/6/21
   ReDim Preserve strCRL(TF_CRL) As String
       
   'Added by Lydia 2015/10/14
   If strSrvDate(1) >= TMQ電子化啟用日 Then 'Added by Lydia 2016/03/28
      Call PUB_GetTMQans("1", True) 'Added by Lydia 2016/06/02 求近似本所案
      
      If TypeName(m_PrevForm) <> "Nothing" Then
         If m_PrevForm.Name = "frm090127" Or m_PrevForm.Name = "frm090128" Then
            cmdTMQ.Visible = False
            cmdTMQApp.Visible = False 'Added by Lydia 2016/03/21
         End If
      End If
      'Added by Lydia 2016/03/21 判斷是否有查名單輸入
      If TypeName(Tmpfrm090126) = "Nothing" Then
         cmdTMQApp.Visible = False
      End If
      'end 2016/03/21
      
      'Added by Lydia 2024/11/11 查名單(網中)
      m_UseTmqTma = "1" '預設使用原查名單
      If strSrvDate(1) >= 查名單網中系統平行測試 Then
         Set nfrm090126_New = Forms(0).GetForm("frm090126_New")
         Set nfrm090127_New = Forms(0).GetForm("frm090127_New")
         Set nfrm090128_New = Forms(0).GetForm("frm090128_New")
         If TypeName(m_PrevForm) = "frm090127_New" Or TypeName(m_PrevForm) = "frm090128_New" Then
            m_UseTmqTma = "2"
            cmdTMQ.Visible = False
            cmdTMQApp.Visible = False
         ElseIf TypeName(m_PrevForm) = "Nothing" Then
            If InStr(UCase(Pub_GetModuleFileName), "VB6.EXE") <> 0 And Not nfrm090127_New Is Nothing And Pub_StrUserSt03 = "M51" Then
               If MsgBox("是否使用查名單(網中)？", vbInformation + vbYesNo + vbDefaultButton2, "測試—查名單(網中)") = vbYes Then
                  m_UseTmqTma = "2"
               End If
            End If
         End If
      End If
      'end 2024/11/11
      
      'Modified by Lydia 2023/08/02 直接改成傳入變數+True
      Call SetGrdTMQ(True)
   End If
   'end 2015/10/14
   
   Me.lblDate.Caption = Val(Mid(strSrvDate(1), 1, 4)) - 1911 & "年" & Mid(strSrvDate(1), 5, 2) & "月" & Mid(strSrvDate(1), 7, 2) & "日"
   For ii = Me.Combo1.LBound To Me.Combo1.UBound
       Me.Combo1(ii).Clear
   Next ii
   '申請國及發明人國籍
   'Modify By Sindy 2023/3/2 排除224.UP
   StrSQLa = "Select NA01, NA03 From Nation Where Length(NA01)=3 And NA01<='9999' And substr(NA02,3,1)='0' And NA01 not in('224') Order By NA01"
   rsA.CursorLocation = adUseClient
   rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
   While Not rsA.EOF
       Me.Combo1(0).AddItem "" & rsA.Fields(0).Value & " " & rsA.Fields(1).Value
       For i = 0 To 9
          Me.Combo3(i).AddItem "" & rsA.Fields(0).Value & " " & rsA.Fields(1).Value
       Next i
       rsA.MoveNext
   Wend
   If rsA.State <> adStateClosed Then rsA.Close
   Set rsA = Nothing
   
   'Add By Sindy 2010/5/27
   ClearChoose1Item (False)
   'Modified by Morgan 2020/5/13 +法律所
   'Modified by Morgan 2020/6/3 +國外部
   If Left(Pub_StrUserSt03, 1) = "F" Or _
      Left(Pub_StrUserSt03, 1) = "L" Or _
      Left(Pub_StrUserSt03, 2) = "P1" Or _
      Left(Pub_StrUserSt03, 2) = "P2" Or _
      Left(Pub_StrUserSt03, 3) = "M51" Then
     Label1(123).Visible = True 'Add by Morgan 2011/1/13
'     Label1(121).Visible = True
     Label1(120).Visible = True
     OptChoose(0).Visible = True
     OptChoose(1).Visible = True
     'Added by Morgan 2020/6/22 國外部預設外對台
     If Left(Pub_StrUserSt03, 1) = "F" Then
      OptChoose(1).Value = True
     Else
     'end 2020/6/22
      OptChoose(0).Value = True
      OptChoose(1).Value = False
     End If
     
'      Option1(0).Enabled = False
'      Option1(1).Enabled = False
   Else
     Label1(123).Visible = False 'Add by Morgan 2011/1/13
'     Label1(121).Visible = False
     Label1(120).Visible = False
     OptChoose(0).Visible = False
     OptChoose(1).Visible = False
     OptChoose(0).Value = True
'      Option1(0).Enabled = True
'      Option1(1).Enabled = True
   End If
   
   'Added by Lydia 2019/02/14 創新業務部人員收文控管
   Call PUB_ChkIsT10T20("1", strUserNum, m_Tuser, strExc(1))
   If m_Tuser <> "" Then
       Text1(10) = m_Tuser
       lblStaffName.Caption = strExc(1)
   Else
   'end 2019/02/14
        'Add By Sindy 2012/5/30
        Text1(10) = strUserNum
        lblStaffName.Caption = strUserName
        '2012/5/30 End
   End If
   'end 2019/02/14
   
   Call Text1_Validate(10, False) 'Add By Sindy 2014/7/4

   ChkPCT.Visible = False
   Frame19.Visible = False 'Add By Sindy 2011/6/7
   
   'Add By Sindy 2013/12/13
   'Added by Lydia 2020/03/30 改用模組
   'If strSrvDate(1) >= InvoiceStartDate Then
   '   Combo4.AddItem "智權公司"
   'End If
   ''2013/12/13 END
   Call SetCombo4  '設定收據公司別(簡稱)
   
   txtPrintType = "2" ''輸出方式,印表機 Add By Sindy 2010/7/7
'   'Add By Sindy 2010/6/21
'   If Pub_StrUserSt03 = "M51" Then
'      cmdOK(4).Visible = True
'      Text5.Visible = True
'    Else
'      cmdOK(4).Visible = False
'      Text5.Visible = False
'   End If
   
   '暫時隱藏發明人
'   SSTab1.TabVisible(3) = False
   SSTab1.Tab = 0
   
   'Add By Sindy 2014/7/28 Frame設定值
   Frame1.BorderStyle = 0: Frame1.Caption = ""
   Frame10.BorderStyle = 0: Frame10.Caption = ""
   Frame11.BorderStyle = 0: Frame11.Caption = ""
   Frame12.BorderStyle = 0: Frame12.Caption = ""
   Frame13.BorderStyle = 0: Frame13.Caption = ""
   Frame14.BorderStyle = 0: Frame14.Caption = ""
   Frame15.BorderStyle = 0: Frame15.Caption = ""
   Frame16.BorderStyle = 0: Frame16.Caption = ""
   Frame17.BorderStyle = 0: Frame17.Caption = ""
   Frame18.BorderStyle = 0: Frame18.Caption = ""
   Frame19.BorderStyle = 0: Frame19.Caption = ""
   Frame2.BorderStyle = 0: Frame2.Caption = ""
   Frame20.BorderStyle = 0: Frame20.Caption = ""
   Frame21.BorderStyle = 0: Frame21.Caption = ""
   Frame22.BorderStyle = 0: Frame22.Caption = ""
   Frame23.BorderStyle = 0: Frame23.Caption = ""
'   Frame24.BorderStyle = 0: Frame24.Caption = "" '是否急件
   Frame25.BorderStyle = 0: Frame25.Caption = ""
   Frame26.BorderStyle = 0: Frame26.Caption = ""
   Frame27.BorderStyle = 0: Frame27.Caption = ""
   Frame28.BorderStyle = 0: Frame28.Caption = ""
   Frame29.BorderStyle = 0: Frame29.Caption = ""
   'Modified by Lydia 2023/11/13 預防Frame數量超過最大數,將第一頁的主Frame改為Index
   'Frame33.BorderStyle = 0: Frame33.Caption = ""
   Frame33(0).BorderStyle = 0: Frame33(0).Caption = ""
   Frame36.BorderStyle = 0: Frame36.Caption = ""
   Frame37.BorderStyle = 0: Frame37.Caption = ""
   Frame38.BorderStyle = 0: Frame38.Caption = ""
   Frame39.BorderStyle = 0: Frame39.Caption = ""
   Frame40.BorderStyle = 0: Frame40.Caption = ""
   Frame57.BorderStyle = 0: Frame57.Caption = "" 'Add By Sindy 2022/9/29
   Frame56.BorderStyle = 0: Frame56.Caption = "": GRD1.Clear: SetGrd2 'Add By Sindy 2022/9/19
   Frame58.BorderStyle = 0: Frame58.Caption = "" 'Add By Sindy 2022/10/14
   'Add By Sindy 2022/10/14
   FrameT.BorderStyle = 0: FrameT.Caption = "": FrameT.BackColor = &H8000000F
   FrameP.BorderStyle = 0: FrameP.Caption = "": FrameP.BackColor = &H8000000F: FrameP.Top = FrameT.Top: FrameP.Left = FrameT.Left
   FrameL.BorderStyle = 0: FrameL.Caption = "": FrameL.BackColor = &H8000000F: FrameL.Top = FrameT.Top: FrameL.Left = FrameT.Left
   Frame605.BorderStyle = 0: Frame605.Caption = ""
   Frame12.BorderStyle = 0: Frame12.Caption = ""
   FrameCase.Top = 1620: FrameCase.Left = 4170: lstCase.Clear '編輯相同案號
   '2022/10/14 END
   'Added by Lydia 2023/11/13 預防Frame數量超過最大數,將第一頁的主Frame改為Index
   Frame33(1).BackColor = &H8000000F  'DEBIT NOTE請款選項
   'end 2023/11/13
   
   cmdClear
   
   Frame4(0).BorderStyle = 0: Frame4(0).Caption = ""
   Frame4(1).BorderStyle = 0: Frame4(1).Caption = ""
   Frame4(2).BorderStyle = 0: Frame4(2).Caption = ""
   Frame4(3).BorderStyle = 0: Frame4(3).Caption = ""
   Frame4(4).BorderStyle = 0: Frame4(4).Caption = ""
   Frame6.BorderStyle = 0: Frame6.Caption = ""
   Frame7.BorderStyle = 0: Frame7.Caption = ""
   Frame8.BorderStyle = 0: Frame8.Caption = ""
   Frame9.BorderStyle = 0: Frame9.Caption = ""
   '2014/7/28 END
   Frame41.BorderStyle = 0: Frame41.Caption = "" 'Add by Amy 2015/11/13
   Frame5.Visible = False 'Add by Amy 2017/01/20
   'Added by Lydia 2018/12/10 查名是否齊備
   Frame42.BorderStyle = 0: Frame42.Caption = "": Frame42.BackColor = &H8000000F
   Frame42.Left = 60
   'Added by Lydia 2018/12/10 是否延期
   Frame43.BorderStyle = 0: Frame43.Caption = ""
   'Added by Lydia 2018/08/22 (應收帳款管控)取消預定收款日,改成付款週期
   Label1(105).Visible = False
   Text1(118).Visible = False
   
   'Added by Lydia 2021/02/24
   Frame47.BackColor = &H8000000F
   Frame47.Top = 2100
   
   'Added by Morgan 2021/7/20 大陸發明生醫案是否新藥專利設定
   Frame48.BorderStyle = 0
   Frame48.Visible = False
   
   'Frame20.Top = 2800 '2700 'Added by Lydia 2022/08/10 商標查名加註，回到原位
   
   m_ChkAmtExcept = Pub_GetSpecMan("應收帳款上限檢查排除") 'Added by Lydia 2022/09/06 改抓特殊設定
   
   'Add By Sindy 2022/8/29
   LblCnt.Caption = "": GridCase.Clear: Call SetGrd
   FrameCRC.Caption = "案件性質編輯區（" & Val(GridCase.Rows - 1) - IIf(Trim(GridCase.TextMatrix(1, 1)) = "", 1, 0) & "）"
   Me.Height = 6850
   If m_SignFlowEmp = "" Then m_SignFlowEmp = strUserNum '簽核人員
   '2022/8/29 END
   
   'Added by Lydia 2022/10/26 載入前次結束時的大小及位置
   If UCase(TypeName(m_PrevForm)) = UCase("frm210156") Or _
      UCase(TypeName(m_PrevForm)) = UCase("frm040101_1") Or _
      UCase(TypeName(m_PrevForm)) = UCase("frm050101_2") Or _
      UCase(TypeName(m_PrevForm)) = UCase("frm210148_2") Or _
      UCase(TypeName(m_PrevForm)) = UCase("frm020101_02") Or _
      UCase(TypeName(m_PrevForm)) = UCase("frm030201_02") Then
      PUB_SetPdfForm Me, False
   Else
   'end 2022/10/26
      MoveFormToCenter Me
   End If 'Added by Lydia 2022/10/26
   
   'Add By Sindy 2022/9/15
   For Each objCbo In Me.Combo2
      objCbo.Clear
      objCbo.AddItem ""
      objCbo.AddItem "業務失誤"
      objCbo.AddItem "專業失誤"
      objCbo.AddItem "專業支援點"
   Next
   '2022/9/15 END
   
   'Add By Sindy 2022/12/24 記錄位置
   OptEntity(0).Tag = OptEntity(0).Left
   OptEntity(1).Tag = OptEntity(1).Left
   OptEntity(2).Tag = OptEntity(2).Left
   '2022/12/24 END
   
   ChkSetflow 'Add By Sindy 2022/12/12 沒有接洽單簽核主管設定者不可操作接洽單
   'SSTab1.SetFocus
   
   'Add By Sindy 2023/9/13
   If TypeName(m_PrevForm) = "Nothing" Then 'Add By Sindy 2023/9/28 +if 僅接洽單輸入才要檢查此條件
      strSql = "select f0301 from flow003" & _
                  " where f0308='" & strUserNum & "' and f0309='" & Flow_退回 & "'"
         intI = 1
         Set RsTemp = ClsLawReadRstMsg(intI, strSql)
         If intI = 1 Then
            MsgBox "提醒！有被主管退回的案件表單。" & vbCrLf & vbCrLf & _
                   "請至案件管理系統的 一般作業->案件表單查詢及簽核->目前表單 項目中，進行表單處理。", vbInformation
         End If
   End If
   '2023/9/13 END
   
   'Add By Sindy 2023/12/12
   If strSrvDate(1) < 指定日期啟用日 Then
      Frame3.Visible = False
   End If
   '2023/12/12 END
End Sub

'Add By Sindy 2010/5/27
Private Sub ClearChoose1Item(blnTF As Boolean)
   '申請人國籍
   'Modify By Sindy 2023/12/19 mark:接洽單開放國籍欄，不限制外至台，國內接洽單不一定要輸
'   Label1(94).Visible = blnTF
'   Me.Text1(34).Visible = blnTF
'   Label1(110).Visible = blnTF
'   Me.Text1(50).Visible = blnTF
'   Label1(111).Visible = blnTF
'   Me.Text1(66).Visible = blnTF
'   Label1(112).Visible = blnTF
'   Me.Text1(82).Visible = blnTF
'   Label1(113).Visible = blnTF
'   Me.Text1(98).Visible = blnTF
   '2023/12/19 END
   
   'Modify By Sindy 2023/2/7 國內接洽單也請顯示英文地址欄
'   '申請人地址(英)
'   Label1(92).Visible = blnTF
'   Me.Text1(125).Visible = blnTF
'   Label1(114).Visible = blnTF
'   Me.Text1(141).Visible = blnTF
'   Label1(115).Visible = blnTF
'   Me.Text1(157).Visible = blnTF
'   Label1(116).Visible = blnTF
'   Me.Text1(173).Visible = blnTF
'   Label1(117).Visible = blnTF
'   Me.Text1(189).Visible = blnTF
   '代理人
   Frame13.Visible = blnTF
   'Modified by Morgan 2020/5/7
   'Me.Text1(119).Text = "如案件內容摘要、引用條文與客戶洽談要旨等等......" & vbCrLf & _
                                       "商品類別：" & vbCrLf & _
                                       "商品名稱：" & vbCrLf & _
                                       "註冊號數：" & vbCrLf & _
                                       "優先權日：" & vbCrLf & _
                                       "優先權號：" & vbCrLf
   'If blnTF = True Then
   '   Me.Text1(119).Text = Me.Text1(119).Text & _
   '                                       "聯絡人：" & vbCrLf & _
   '                                       "彼所案號：" & vbCrLf
   'End If
   SrcSetMemo blnTF
   'end 2020/5/7
End Sub

Private Sub Form_Unload(Cancel As Integer)
   'Add By Sindy 2024/3/25
   '特殊收據畫面存在時,要關閉
   If PUB_CheckFormExist("frm090801_7") = True Then
      Unload frm090801_7
   End If
   '2024/3/25 END
   
   If bolIsTmp = False Then 'Added by Morgan 2020/8/3
      Set frm090801_New = Nothing
   End If
'Add By Sindy 2014/6/3
   If TypeName(m_PrevForm) <> "Nothing" Then
      m_PrevForm.Show
      'Modify By Sindy 2022/9/15
      If UCase(TypeName(m_PrevForm)) = UCase("frm210147") Or _
         UCase(TypeName(m_PrevForm)) = UCase("frm210148") Then
         m_PrevForm.QueryData
      'Modify By Sindy 2025/8/1 專利／商標會稿
      'ElseIf UCase(TypeName(m_PrevForm)) = UCase("frm090202_3") Then
      ElseIf UCase(TypeName(m_PrevForm)) = UCase("frm090202_2") Then '電子承辦單簽辦作業
         If InStr(m_PrevForm.CboEEP04.Text, "收文分析") = 0 Then
            Call m_PrevForm.cmdExit_Click
         End If
         '2025/8/1 END
      'Added by Lydia 2022/10/26
      ElseIf UCase(TypeName(m_PrevForm)) = UCase("frm210156") Or _
             UCase(TypeName(m_PrevForm)) = UCase("frm040101_1") Or _
             UCase(TypeName(m_PrevForm)) = UCase("frm050101_2") Or _
             UCase(TypeName(m_PrevForm)) = UCase("frm210148_2") Or _
             UCase(TypeName(m_PrevForm)) = UCase("frm020101_02") Or _
             UCase(TypeName(m_PrevForm)) = UCase("frm030201_02") Then
         PUB_SavePdfForm Me '紀錄視窗最後的大小及位置
      'end 2022/10/26
      Else
         If UCase(TypeName(m_PrevForm)) = UCase("frm077003") Then
            m_PrevForm.cmdSearch_Click
         Else
      '2022/9/15 END
            m_PrevForm.PubShowNextData
         End If
      End If
      Set m_PrevForm = Nothing
   End If
'2014/6/3 END
End Sub

'Add By Sindy 2009/08/31
Private Sub Opt1_Click(Index As Integer)
'   'Add By Sindy 2023/6/14 原有執行過查詢(圖形附檔),但又跳進來變(其他)
'   If cmdOK(1).Tag <> "" And opt1(0).Enabled = False Then
'      Exit Sub
'   End If
'   '2023/6/14 ENd
   Set G_SeekPicColor.Picture = LoadPicture()
   Set tmpPic.Picture = LoadPicture()
   Set tmpImg.Picture = LoadPicture()
   tmpImg.Visible = False
   cmdPic.Enabled = False
   Frame17.Visible = False: cmdPic.Visible = False
   'Add By Sindy 2009/11/02
   PicText.Visible = False
   PicText.Text = ""
   '2009/11/02 End
   'Add by Amy 2017/01/20 選擇同卷號時, PicText欄的位置改為本所案號欄
   Frame5.Visible = False
   TxtC1(0) = "": TxtC1(1) = "": TxtC1(2) = "": TxtC1(3) = ""
   'end 2017/01/20
   
   If opt1(0).Value = True Then
      Call LoadPic("000", "000000", "0", "03")
      'Add By Sindy 2009/11/02
      PicText.Visible = True
      'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 + And Me.Visible = True
      If PicText.Enabled = True And Me.Visible = True Then PicText.SetFocus
      '2009/11/02 End
   ElseIf opt1(1).Value = True Then
      tmpImg.Visible = True
      cmdPic.Enabled = True
      'If Pub_StrUserSt03 = "M51" Then
         Frame17.Visible = True: Frame17.Enabled = True: cmdPic.Visible = True
      'End If
   ElseIf opt1(2).Value = True Then
      Call LoadPic("000", "000000", "0", "02")
   'Add By Sindy 2009/11/02
   ElseIf opt1(3).Value = True Then
      'Add by Amy +系統別T/TF/CFT選擇同卷號時, PicText欄的位置改為本所案號欄
      If Trim(Text1(6)) = "T" Or Trim(Text1(6)) = "TF" Or Trim(Text1(6)) = "CFT" Then
        tmpImg.Visible = True
        Frame5.Width = 4335
        Frame5.Visible = True
        If TxtC1(0).Enabled = True And Me.Visible = True Then TxtC1(0).SetFocus
        Frame17.Visible = True 'Add By Sindy 2023/6/14
      Else
        PicText.Visible = True
        PicText.Text = "圖同"
        'Modified by Lydia 2023/01/03 程式會出錯
        'If PicText.Enabled = True Then PicText.SetFocus
        If PicText.Enabled = True And Me.Visible = True Then
          PicText.SetFocus
        End If
      End If
   ElseIf opt1(4).Value = True Then
      PicText.Visible = True
      'Modified by Lydia 2023/01/03 程式會出錯
      'If PicText.Enabled = True Then PicText.SetFocus
      If PicText.Enabled = True And Me.Visible = True Then
          PicText.SetFocus
      End If
   '2009/11/02 End
   End If
End Sub

'Add By Sindy 2009/08/31 選擇圖檔
Private Sub CmdPic_Click()
'cmdPic.Tag = "有異動"
Set G_SeekPicColor.Picture = LoadPicture()
Set tmpImg.Picture = LoadPicture()
Set frmPic001.oPic = G_SeekPicColor
Set frmPic001.oImg = tmpImg
Set frmPic001.UpForm = Me
frmPic001.oRtPic = True
frmPic001.cmdOK(4).Visible = False
frmPic001.cmdOK(5).Visible = False
frmPic001.cmdOK(6).Visible = False
frmPic001.cmdOK(7).Visible = False
frmPic001.cmdOK(2).Caption = "確定(&O)"
frmPic001.cmdOK(3).Caption = "取消(&X)"
frmPic001.Label11.Caption = "選擇圖片"
frmPic001.cmdOK(0).Left = frmPic001.cmdOK(0).Left - 250
frmPic001.cmdOK(1).Left = frmPic001.cmdOK(1).Left - 250
frmPic001.cmdOK(2).Left = frmPic001.cmdOK(2).Left - 250
frmPic001.cmdOK(3).Left = frmPic001.cmdOK(3).Left - 250
frmPic001.Width = 3800
MoveFormToCenter frmPic001
Unload frmpic002
frmPic001.SetSeekCmdok 'Add by Amy 2018/07/20
frmPic001.Show vbModal
End Sub

'Add By Sindy 2010/5/27
Private Sub optChoose_Click(Index As Integer)
   Option1(0).Enabled = True
   Option1(1).Enabled = True
   'Option1(0).Value = True
   'Call Option1_Click(0)
   Select Case Index
      Case 0 '國內
         Call ClearChoose1Item(False)
      Case 1 '大至台
         Call ClearChoose1Item(True)
   End Select
End Sub

''Add by Amy 2016/06/06 商標爭議案用
'Private Sub OptCP122_Click(Index As Integer)
'    If Index = 1 Then Exit Sub
'
'    OptCRL133(1).Value = True
'End Sub

'Added by Morgan 2013/4/10
Private Sub optCP811_Click(Index As Integer)
   ChkOptCP81
   Call ChgCusDis 'Added by Morgan 2023/4/18
End Sub

Private Sub optCP812_Click(Index As Integer)
   ChkOptCP81
   Call ChgCusDis 'Added by Morgan 2023/4/18
End Sub

Private Sub optCP813_Click(Index As Integer)
   ChkOptCP81
   Call ChgCusDis 'Added by Morgan 2023/4/18
End Sub

Private Sub optCP814_Click(Index As Integer)
   ChkOptCP81
   Call ChgCusDis 'Added by Morgan 2023/4/18
End Sub

Private Sub optCP815_Click(Index As Integer)
   ChkOptCP81
   Call ChgCusDis 'Added by Morgan 2023/4/18
End Sub
'end 2013/4/10

'Private Sub OptCRL133_Click(Index As Integer)
'    If Index = 0 And OptCRL133(Index).Value = True Then
'        OptCP122(1).Value = True
'    End If
'End Sub

Private Sub Option1_Click(Index As Integer)
   'If m_blnCallPrint = True Then Exit Sub 'Add By Sindy 2014/7/25
    Select Case Index
    Case 0 '新案
        cmdAddAtt.Caption = "文件匯入" 'Add By Sindy 2022/9/6
        'Added by Lydia 2020/11/19 CFP和CFT英國脫歐案管制：帶入期限後，新案第一次先不清除畫面
        If bolCase201 = True Then
            bolCase201 = False
            Exit Sub
        End If
        'end 2020/11/19
        
        'Added by Morgan 2020/2/5 舊案點選新案時詢問是否清除，否則會有舊案期限資料殘留問題(Ex:P)--經理
        If Text1(7) <> "" And strLOS18 = "" And _
            Text5.Visible = False And cmdOK(0).Visible = True Then 'Modified by Morgan 2020/5/27 案源輸入不用問
            
            If MsgBox("是否清除原畫面資料？", vbYesNo + vbDefaultButton2) = vbYes Then
               cmdClear True
            End If
        End If
        'end 2020/2/5
        
        txtCRL69.Text = "": txtCRL70.Text = "" 'Add By Sindy 2022/9/15
        m_Note1 = "": m_Note2 = "" 'Add By Sindy 2010/4/23
        m_strGetNP01 = "" 'Add By Sindy 2015/9/17
        Text1(142).Text = "": Text1(143).Text = "" 'strYF05From = "": strYF05To = "" 'Add By Sindy 2010/7/9
        Me.Text1(7).Text = ""
        Me.Text1(8).Text = ""
        Me.Text1(9).Text = ""
        Me.Text1(7).Enabled = False
        Me.Text1(8).Enabled = False
        Me.Text1(9).Enabled = False
        Me.Text1(18).Enabled = True
        txtEnabled1 True
        cmdOK(3).Enabled = False
         
         ClearCustTxt 1
         ClearCustTxt 2
         ClearCustTxt 3
         ClearCustTxt 4
         ClearCustTxt 5
         ClearFagentTxt 'Add By Sindy 2010/5/27
         cboTitle.Clear
         'Add By Sindy 2013/12/13
         'Modified by Lydia 2020/03/30 改用模組
         'If strSrvDate(1) >= InvoiceStartDate Then
         '   Combo4.Enabled = True
         '   If Combo4.ListCount < 4 Then
         '      Combo4.AddItem "智權公司"
         '   End If
         'End If
         ''2013/12/13 END
         Call SetCombo4 '設定收據公司別(簡稱)
         'end 2020/03/30
         
         Call Combo1_LostFocus(0) 'Add By Sindy 2013/12/14 執行預設動作
         
         'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 + And Me.Visible = True
         If Me.Text1(6).Enabled = True And Me.Visible = True Then Me.Text1(6).SetFocus
         
         'Added by Morgan 2020/5/27
         '案源輸入法務案時預設國家及申請人
         If (strLOS18 <> "" Or strLOS15 <> "" And strLCaseNo(1) = "") And m_blnCallPrint = False Then
            'Modify By Sindy 2024/2/21
            'SetComboCase 0, "000"
            'SetComboCase 0, Combo1(0).Text
            Call frm090801_New_SetComboCase(0, "000", Combo1(0), Me.Text1(6).Text, _
                  Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
            Call frm090801_New_SetComboCase(0, Combo1(0).Text, Combo1(0), Me.Text1(6).Text, _
                  Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
            '2024/2/21 END
            If strLOS18 <> "" Then
               SrcLoadCustbyCRL01 strLOS18
            Else
               SrcSetCustByVar
            End If
         End If
         'end 2020/5/27
         
    Case 1 '舊案
        cmdOK(3).Enabled = True 'Add By Sindy 2024/5/9
        cmdAddAtt.Caption = "回覆單匯入" 'Add By Sindy 2022/9/6
        m_Note1 = "": m_Note2 = "" 'Add By Sindy 2010/4/23
        m_strGetNP01 = "" 'Add By Sindy 2015/9/17
        Text1(142).Text = "": Text1(143).Text = "" 'strYF05From = "": strYF05To = "" 'Add By Sindy 2010/7/9
        Me.Text1(7).Enabled = True
        Me.Text1(8).Enabled = True
        Me.Text1(9).Enabled = True
        Me.Text1(18).Enabled = False
        txtEnabled1 False
        Me.Text1(18).Text = ""
        'edit by nickc 2005/04/06
        'Me.Option3(1).Value = True
        Option31(1).Value = True
        Option32(1).Value = True
        Option33(1).Value = True
        Option34(1).Value = True
        Option35(1).Value = True

        'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 + And Me.Visible = True
        If Me.Text1(6).Enabled = True And Me.Visible = True Then Me.Text1(6).SetFocus

         'Add By Sindy 2013/12/13
         If strSrvDate(1) >= InvoiceStartDate Then
            'Modified by Lydia 2020/03/30
            'If Combo4.ListCount = 4 Then
            '   Combo4.RemoveItem 3
            'Memo by Lydia 2022/09/22 移除選項是因為舊案不可更換收據公司別；
            '  若確定要更換公司別，需先請財務修改之前收據後會自動發Email通知「程式管理人員」，
            '  經過人員修改資料後接洽單才可以更換收據公司別。
            If Combo4.ListCount = m_CompJforIdx + 1 Then
               Combo4.RemoveItem m_CompJforIdx
            'end 2020/03/30
            End If
         End If
         '2013/12/13 END
    End Select
    
    'Add by Morgan 2004/5/20
    'edit by nick 2004/08/05
    'Call setCP81
    Call setCP811
    'add by nick 2004/08/05
    Call setCP812
    Call setCP813
    Call setCP814
    Call setCP815
    LockContact 'Add by Morgan 2008/9/16
'    SetEntity 'Added by Morgan 2013/3/19
    SetElecApp 'Added by Morgan 2103/9/23
    SetEngAbs 'Added by Morgan 2013/9/26
    SetNewDrug 'Addd by Morgan 2021/7/20
    Call SetCombo4 'Added by Lydia 2020/03/30 設定收據公司別(簡稱)
End Sub

'Add by Amy 2016/03/25
Private Sub Option2_Click(Index As Integer)
    Frame33(1).Visible = False  'Added by Lydia 2023/11/13 DEBIT NOTE請款選項;預設不顯示
    'Add by Amy 2016/06/24 +勾選Debit Note不可點選特殊收據
    If Index = 2 Then
        If Option2(2).Value = True Then
            If Check9.Value = 1 Then Check9.Value = 0
            Call Check9_Click
            Check9.Enabled = False
            If OptChoose(0).Value = True Then 'Added by Lydia 2023/11/14 排除外至台案件(MCTF)
               Frame33(1).Visible = True  'Added by Lydia 2023/11/13 DEBIT NOTE請款選項
            End If
        End If
    Else
        'Add by Amy 2016/12/23 +舊案多申請人勾同申請人,自動勾特殊收據(P-091969)
        If Index = 0 Then
            If Option1(1).Value = True And (Me.Text1(21) <> "" Or Me.Text1(22) <> "") And _
              (Me.Text1(37) <> "" Or Me.Text1(38) <> "") And Check9.Value = 0 Then
                Check9.Value = 1
                Call Check9_Click
            End If
        End If
        'end 2016/12/23
        Check9.Enabled = True
    End If
End Sub

Private Sub Option31_Click(Index As Integer)
   Select Case Index
   Case 0 '新客戶
       txtEnabled2 True, 1
       ClearCustTxt 1
       If IsoptCP81 = True Then
           optCP811(0).Enabled = True
           optCP811(1).Enabled = True
       End If
   Case 1 '舊客戶
       txtEnabled2 False, 1
       If IsoptCP81 = True Then
           optCP811(0).Enabled = False
           optCP811(1).Enabled = False
       End If
       Call Combo1_Validate(0, False)
   End Select
   LockContact 1
   'Add by Amy 2016/01/04
   ClearAddrVar 2, 1
   
   SetQualVisible 'Added by Morgan 2013/4/11
End Sub

Private Sub Option32_Click(Index As Integer)
   Select Case Index
   Case 0 '新客戶
       txtEnabled2 True, 2
       ClearCustTxt 2
       If IsoptCP81 = True Then
           optCP812(0).Enabled = True
           optCP812(1).Enabled = True
       End If
   Case 1 '舊客戶
       txtEnabled2 False, 2
       If IsoptCP81 = True Then
           optCP812(0).Enabled = False
           optCP812(1).Enabled = False
       End If
       Call Combo1_Validate(0, False)
   End Select
   LockContact 2
   'Add by Amy 2016/01/04
   ClearAddrVar 2, 2
   
   SetQualVisible 'Added by Morgan 2013/4/11
End Sub

Private Sub Option33_Click(Index As Integer)
   Select Case Index
   Case 0 '新客戶
       txtEnabled2 True, 3
       ClearCustTxt 3
       If IsoptCP81 = True Then
           optCP813(0).Enabled = True
           optCP813(1).Enabled = True
       End If
   Case 1 '舊客戶
       txtEnabled2 False, 3
       If IsoptCP81 = True Then
           optCP813(0).Enabled = False
           optCP813(1).Enabled = False
       End If
       Call Combo1_Validate(0, False)
   End Select
   LockContact 3
   'Add by Amy 2016/01/04
   ClearAddrVar 2, 3
   
   SetQualVisible 'Added by Morgan 2013/4/11
End Sub

Private Sub Option34_Click(Index As Integer)
   Select Case Index
   Case 0 '新客戶
       txtEnabled2 True, 4
       ClearCustTxt 4
       If IsoptCP81 = True Then
           optCP814(0).Enabled = True
           optCP814(1).Enabled = True
       End If
   Case 1 '舊客戶
       txtEnabled2 False, 4
       If IsoptCP81 = True Then
           optCP814(0).Enabled = False
           optCP814(1).Enabled = False
       End If
       Call Combo1_Validate(0, False)
   End Select
   LockContact 4
   'Add by Amy 2016/01/04
   ClearAddrVar 2, 4
   
   SetQualVisible 'Added by Morgan 2013/4/11
End Sub

Private Sub Option35_Click(Index As Integer)
   Select Case Index
   Case 0 '新客戶
       txtEnabled2 True, 5
       ClearCustTxt 5
       If IsoptCP81 = True Then
           optCP815(0).Enabled = True
           optCP815(1).Enabled = True
       End If
   Case 1 '舊客戶
       txtEnabled2 False, 5
       If IsoptCP81 = True Then
           optCP815(0).Enabled = False
           optCP815(1).Enabled = False
       End If
       Call Combo1_Validate(0, False)
   End Select
   LockContact 5
   'Add by Amy 2016/01/04
   ClearAddrVar 2, 5
   
   SetQualVisible 'Added by Morgan 2013/4/11
End Sub

Private Sub Option4_Click(Index As Integer)
    Select Case Index
    Case 0
        Me.Option4(1).Value = Not Me.Option4(0).Value
        Me.Option4(2).Value = Not Me.Option4(0).Value
    Case 1
        Me.Option4(0).Value = Not Me.Option4(1).Value
        Me.Option4(2).Value = Not Me.Option4(1).Value
    Case 2
        Me.Option4(0).Value = Not Me.Option4(2).Value
        Me.Option4(1).Value = Not Me.Option4(2).Value
        'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 + And Me.Visible = True
        If Me.Text1(97).Enabled = True And Me.Visible = True Then Me.Text1(97).SetFocus

    End Select
End Sub

'Add By Sindy 2022/12/16
Private Sub SSTab1_KeyDown(KeyCode As Integer, Shift As Integer)
   'Debug.Print KeyCode
   '39:右 38:上 40:下 37:左
   If SSTab1.Tab = 1 Then
      If KeyCode = 40 Then
         SSTab2.SetFocus
      End If
   Else
      If KeyCode = 40 Then
         SSTab3.SetFocus
      End If
   End If
End Sub
Private Sub SSTab2_KeyDown(KeyCode As Integer, Shift As Integer)
   'Debug.Print KeyCode
   '39:右 38:上 40:下 37:左
   If KeyCode = 38 Then
      SSTab1.SetFocus
   End If
End Sub
Private Sub SSTab3_KeyDown(KeyCode As Integer, Shift As Integer)
   'Debug.Print KeyCode
   '39:右 38:上 40:下 37:左
   If KeyCode = 38 Then
      SSTab1.SetFocus
   End If
End Sub
'2022/12/16 END

Private Sub SSTab1_Click(PreviousTab As Integer)
Dim Cancel As Boolean  'Add By Sindy 2025/3/26
   
On Error Resume Next
   
   m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   If Me.SSTab1.Tab = 0 Then
      'Modified by Lydia 2019/08/12
      'If Me.Text1(10).Enabled = True Then Me.Text1(10).SetFocus
      'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用
      'If Me.Text1(10).Enabled = True And cmdOK(1).Tag <> "" Then Me.Text1(10).SetFocus
      If Me.Text1(10).Enabled = True And Me.Visible = True And cmdOK(1).Tag <> "" Then
          Me.Text1(10).SetFocus
      End If
      'end 2021/06/18
   ElseIf Me.SSTab1.Tab = 1 Then
      'add by nickc 2005/04/06 加入切頁時的預設值
      If Me.SSTab2.Tab = 0 Then
          If Text1(21).Enabled Then Text1(21).SetFocus
      ElseIf Me.SSTab2.Tab = 1 Then
          If Text1(37).Enabled Then Text1(37).SetFocus
      ElseIf Me.SSTab2.Tab = 2 Then
          If Text1(53).Enabled Then Text1(53).SetFocus
      ElseIf Me.SSTab2.Tab = 3 Then
          If Text1(69).Enabled Then Text1(69).SetFocus
      Else
          If Text1(85).Enabled Then Text1(85).SetFocus
      End If
       
      SetQualVisible 'Added by Morgan 2013/4/10
         
   ElseIf Me.SSTab1.Tab = 2 Then
      SSTab3.Tab = 0 'Added by Morgan 2013/1/15
      'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 + And Me.Visible = True
      If Me.Text1(119).Enabled = True And Me.Visible = True Then Me.Text1(119).SetFocus

   ElseIf Me.SSTab1.Tab = 3 Then 'Added by Lydia 2015/10/14
      '發明人欄位
      'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 + And Me.Visible = True
      If cmdInventor.Enabled = True And Me.Visible = True Then cmdInventor.SetFocus
       
'   'Added by Lydia 2015/10/14
'   ElseIf Me.SSTab1.Tab = 4 Then
'      'Modified by Lydia 2016/04/25 顯示判斷 + TS案
'      'Modified by Lydia 2021/11/23 因為T案增加737智財協作,調整判斷
'      'strExc(1) = IIf(Trim(Left(Trim(Combo1(1)), 4)) <> "", Trim(Left(Trim(Combo1(1)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(2)), 4)) <> "", Trim(Left(Trim(Combo1(2)), 4)), "") & _
'             "," & IIf(Trim(Left(Trim(Combo1(3)), 4)) <> "", Trim(Left(Trim(Combo1(3)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(4)), 4)) <> "", Trim(Left(Trim(Combo1(4)), 4)), "")
'      'If strSrvDate(1) >= TMQ電子化啟用日 And Left(Trim(Combo1(0)), 3) = "000" And Option1(0).Value = True And ((Text1(6).Text = "T" And Text1(7) & Text1(8) = "" And InStr(strExc(1), TMQ_T案) > 0) _
'          Or (Text1(6).Text = "TS" And Text1(7) & Text1(8) = "" And InStr(strExc(1), TMQ_TS案) > 0)) Then
'      If GetTMQArea = True Then
'      'end 2021/11/23
'         FRTMQ.Visible = True
'      Else
'         FRTMQ.Visible = False
'      End If
'   'end 2015/10/14
'      'Added by Lydia 2021/02/24 大陸商標申請案及CFT申請案，均強迫填入相關資訊。
'      Frame47.Visible = False
'      'Added by Lydia 2022/04/28 debug: 補上抓所有案件性質
'   '           strExc(1) = IIf(Trim(Left(Trim(Combo1(1)), 4)) <> "", Trim(Left(Trim(Combo1(1)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(2)), 4)) <> "", Trim(Left(Trim(Combo1(2)), 4)), "") & _
'   '                  "," & IIf(Trim(Left(Trim(Combo1(3)), 4)) <> "", Trim(Left(Trim(Combo1(3)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(4)), 4)) <> "", Trim(Left(Trim(Combo1(4)), 4)), "")
'      'end 2022/04/28
'      If (Left(Trim(Combo1(0)), 3) = "020" And Text1(6).Text = "T" And InStr(m_strCaseCPM, "101") > 0) Or Text1(6).Text = "CFT" And InStr(m_strCaseCPM, "101") > 0 Then
'         Frame47.Visible = True
'         If Text1(6).Text = "T" Then
'            fra47Title.Caption = "商標說明："
'         Else
'            fra47Title.Caption = "商標英文大寫："
'         End If
'      End If
'      'end 2021/02/24
   End If
   
   'Add By Sindy 2022/8/30
   If PreviousTab = 0 Then
      Call ChkGridCaseIsOK
   End If
   '2022/8/30 END
   
   'Add By Sindy 2025/3/26
   Cancel = False
   Combo6_Validate Cancel
   If Cancel = True Then
      SSTab1.Tab = 0
      Combo6.SetFocus
      Exit Sub
   End If
   '2025/3/26 END
End Sub

'Add By Sindy 2022/8/31
'檢查案件性質是否正在編輯中
Private Function ChkIsModify() As Boolean
   ChkIsModify = False
   If Trim(Combo1(1).Text) <> "" And Val(LblCnt) > 0 And _
      (Combo1(1).Text <> Combo1(1).Tag Or Text1(101).Text <> Text1(101).Tag Or _
       Text1(102).Text <> Text1(102).Tag Or Text1(103).Text <> Text1(103).Tag Or _
       Combo2(0).Text <> Combo2(0).Tag) Then
      ChkIsModify = True
   ElseIf Trim(Combo1(1).Text) <> "" And Val(LblCnt) = 0 Then
      ChkIsModify = True
   End If
End Function
Private Function ChkGridCaseIsOK() As Boolean
   ChkGridCaseIsOK = False
   If Me.FrameCase.Visible = True Then
      MsgBox "編輯相同案號的畫面開啟中，請操作完畢！", vbExclamation, "編輯相同案號"
      SSTab1.Tab = 1
      SSTab2.Tab = 0
      Me.txtSystem.SetFocus
      Exit Function
   End If

   If ChkIsModify = False Then
      Call cmdClear2_Click '清除
   Else
      If Val(LblCnt) = 0 Then
         MsgBox "案件性質資料尚未加入，請操作完畢！", vbExclamation, "案件性質編輯區"
         SSTab1.Tab = 0
         Text1(101).SetFocus
         Exit Function
      Else
         MsgBox "案件性質資料有異動，尚未按加入鍵，請操作完畢！", vbExclamation, "案件性質編輯區"
         SSTab1.Tab = 0
         Text1(101).SetFocus
         Exit Function
      End If
   End If
   ChkGridCaseIsOK = True
End Function

Private Sub SSTab2_Click(PreviousTab As Integer)
   If SSTab1.Tab <> 1 Then Exit Sub
    If Me.SSTab2.Tab = 0 Then
        If Text1(21).Enabled Then Text1(21).SetFocus
    ElseIf Me.SSTab2.Tab = 1 Then
        If Text1(37).Enabled Then Text1(37).SetFocus
    ElseIf Me.SSTab2.Tab = 2 Then
        If Text1(53).Enabled Then Text1(53).SetFocus
    ElseIf Me.SSTab2.Tab = 3 Then
        If Text1(69).Enabled Then Text1(69).SetFocus
    Else
        If Text1(85).Enabled Then Text1(85).SetFocus
    End If
    
   SetQualVisible 'Added by Morgan 2013/4/10
End Sub

'Added by Morgan 2013/1/15
Private Sub SSTab3_Click(PreviousTab As Integer)
   If SSTab3.Tab = 1 Then
      If Left(Combo6, 1) = "3" Then
         chkItem(0).Enabled = False
         chkItem(0).Value = vbUnchecked
         txtItemCount.Enabled = False
         txtItemCount = ""
         chkItem(1).Enabled = False
         chkItem(1).Value = vbUnchecked
         txtItemList = "第項"
         chkItem(2).Enabled = True
      Else
         chkItem(0).Enabled = True
         chkItem(1).Enabled = True
         chkItem(2).Value = vbUnchecked
         chkItem(2).Enabled = False
      End If
   End If
End Sub

'Add by Morgan 2011/3/8
Private Sub Text1_Change(Index As Integer)
   If Index = 6 Then
'      SetEntity 'Added by Morgan 2013/3/19
      SetElecApp 'Added by Morgan 2013/9/23
      SetEngAbs 'Added by Morgan 2013/9/26
      SetNewDrug 'Added by Morgan 2021/7/20
      SrcSetMemo OptChoose(1).Value, True  'Added by Morgan 2020/5/7
      
      'Add By Sindy 2009/08/31 商標
      If Text1(6) = "T" Or Text1(6) = "TF" Or Text1(6) = "FCT" Or _
          Text1(6) = "TS" Or Text1(6) = "S" Or Text1(6) = "CFT" Then
          SSTab1.TabEnabled(4) = True
      Else
          SSTab1.TabEnabled(4) = False
      End If
      '2009/08/31 END
      
      'Add By Sindy 2023/5/12 鎖外專、外商介紹案源
      If Left(Pub_StrUserSt03, 1) = "F" Then
         If InStr(Text1(6).Text, "L") > 0 Then
            Screen.MousePointer = vbDefault
            MsgBox "請使用〔案件接洽單(法務案件)〕填寫案源！", vbCritical, "檢核資料"
            Text1(6).Text = ""
            Text1(6).SetFocus
         End If
      End If
      '2023/5/12 END
   End If
   
   'Added by Morgan 2016/7/20
   'Modified by Morgan 2016/12/27 減免身分資料也要清除
   Select Case Index
   Case 12: stCustNo1 = "": If IsoptCP81 = True Then Call setCP811
   Case 28: stCustNo2 = "": If IsoptCP81 = True Then Call setCP812
   Case 44: stCustNo3 = "": If IsoptCP81 = True Then Call setCP813
   Case 60: stCustNo4 = "": If IsoptCP81 = True Then Call setCP814
   Case 76: stCustNo5 = "": If IsoptCP81 = True Then Call setCP815
   'Add by Amy 2024/06/24 +聯絡/申請 地址 清變數及Zip欄位
   Case 26, 42, 58, 74, 90 '聯絡地址
      If Text1(Index).Tag <> Text1(Index) Then
         intTWAddr(((Index - 26) / 16) * 2 + 1) = 0
         Text1(Index - 1) = ""
      End If
   Case 27, 43, 59, 75, 91 '申請地址
      If Text1(Index).Tag <> Text1(Index) Then
         intTWAddr(((Index - 11) / 16) * 2) = 0
         Text1(120 + (Index - 27) / 16) = ""
      End If
   End Select
   'end 2016/12/27
   'end 2016/7/20
   
   'Added by Morgan 2022/3/14
   If Index = 119 Then
      PUB_RefreshText Text1(119)
   End If
   'end 2022/3/14

End Sub

Private Sub Text1_GotFocus(Index As Integer)
   
   'Added by Morgan 2022/3/17
   '修正Tab鍵無法正常跳至下一駐點問題(因TextBox的Visible設True會自動取得駐點)
   'Modify By Sindy 2022/11/29
   'Modify By Sindy 2023/5/24 + And Not m_objControl Is Nothing
   If Not Me.ActiveControl Is Nothing And Not m_objControl Is Nothing Then
   '2022/11/29 END
      If Me.ActiveControl.Name = "Text1" Then
         If Me.ActiveControl.Index = Index Then
            If m_bolText1SetFocus Then
               If m_objControl.Enabled And m_objControl.Visible Then
                  'Modified by Morgan 2022/3/25 非目前欄位才設駐點
                  If Index <> m_objControl.Index Then
                     m_objControl.SetFocus
                  End If
               End If
               'm_bolText1SetFocus = False 'Add By Sindy 2023/9/27 mark,改下列統一清除變數值
            End If
         End If
      End If
   End If
   'end 2022/3/17
   m_bolText1SetFocus = False 'Add By Sindy 2023/9/27 統一清除變數值
   
    Select Case Index
    Case 6
        'Add By Sindy 2010/5/27
        If OptChoose(0).Visible = True Then
            If OptChoose(0).Value = False And OptChoose(1).Value = False Then
               MsgBox "請點選接洽單種類!!!", vbExclamation + vbOKOnly
               SSTab1.Tab = 0
               Exit Sub
            End If
        End If
         TextInverse Me.Text1(Index) 'Add by Lydia 2014/12/39 案號反白
    Case 119
        Me.Text1(Index).SelStart = Len(Me.Text1(Index).Text)
    Case Else
        TextInverse Me.Text1(Index)
    End Select
    'add by nickc 2007/07/13 將輸入法改成使用API
    If Index = 598 Or Index = 498 Or Index = 398 Or Index = 298 Or Index = 97 Or _
       Index = 198 Or Index = 21 Or Index = 23 Or Index = 26 Or Index = 27 Or _
       Index = 37 Or Index = 39 Or Index = 42 Or Index = 43 Or Index = 53 Or _
       Index = 55 Or Index = 58 Or Index = 59 Or Index = 69 Or Index = 71 Or _
       Index = 74 Or Index = 75 Or Index = 85 Or Index = 87 Or Index = 90 Or Index = 91 Then
        OpenIme
    Else
        CloseIme
    End If
        
End Sub

Private Sub Text1_KeyPress(Index As Integer, KeyAscii As MSForms.ReturnInteger)
'Add by Amy 2015/11/02
Dim strAddr As String, strNewArea As String, strZipCode As String, strROC As String, strIndArea As String
Dim intArea As Integer, intTW As Integer, intFocus As Integer
Dim bolMany As Boolean
    
    Select Case Index
    'Add By Sindy 2010/4/22
    'Modify by Morgan 2010/12/23 +118 預定收款日
    'Modify By Sindy 2012/8/17 +126,128
    'Modified by Morgan 2012/12/18 +114
    Case 4, 118, 126, 128, 114, 139, 140, 142, 143
        KeyAscii = Pub_NumAscii(KeyAscii)
    'Case 0, 4, 6, 12, 28, 44, 60, 76, 100
    'Modify By Sindy 2014/9/11 +, 92, 93, 94, 95, 96
    'Modified by Lydia 2018/11/13 +133
    Case 0, 5, 6, 10, 12, 28, 44, 60, 76, 100, 92, 93, 94, 95, 96, 133
    '2010/4/22 End
        KeyAscii = UpperCase(KeyAscii)
    Case 11 '主題
        If KeyAscii = 91 Or KeyAscii = 93 Or KeyAscii = -24219 Or KeyAscii = -24218 Then
            MsgBox "主題欄禁止打中括號!!!", vbExclamation + vbOKOnly
            KeyAscii = 0
        End If
    'edit by nickc 2006/02/08
    'Modify by Amy 2015/11/02 區分 郵遞區號及地址欄位(舊客戶欄位鎖住)
    'Case 25, 26, 27
    '郵遞區號
    Case 25, 41, 57, 73, 89, 120, 121, 122, 123, 124
        'Modify By Amy 2022/10/06 + Text1(Index) : 地址輸數字會出現文字問題
        KeyAscii = ChangeZIP(KeyAscii, Text1(Index))
    '聯絡/申請地址
    Case 26, 27, 42, 43, 58, 59, 74, 75, 90, 91
        'Modify By Amy 2022/10/06 + Text1(Index) : 地址輸數字會出現文字問題
        KeyAscii = ChangeZIP(KeyAscii, Text1(Index))
        intTW = IIf(Index Mod 2 = 0, ((Index - 26) / 16) * 2 + 1, ((Index - 11) / 16) * 2)
        '臺灣地址判斷
        If LTrim(Me.Text1(Index)) <> MsgText(601) And intTWAddr(intTW) <= 1 Then
            strROC = ""
            strAddr = Me.Text1(Index)
            If Left(strAddr, 4) = "中華民國" Then strROC = strROC & Left(strAddr, 4): strAddr = Mid(strAddr, 5)
            If Left(strAddr, 3) = "臺灣省" Or Left(strAddr, 3) = "台灣省" Then strROC = strROC & Left(strAddr, 3): strAddr = Mid(strAddr, 4)
            If Left(strAddr, 2) = "臺灣" Or Left(strAddr, 2) = "台灣" Then strROC = strROC & Left(strAddr, 2): strAddr = Mid(strAddr, 3)
            '去除xx工業區查(台中工業區/台塑工業園區不取代,可能抓錯zip)
            strIndArea = "True"
            strAddr = ReplaceIndArea(strAddr, strIndArea)
            If strIndArea = "True" Then strIndArea = MsgText(601)
            If Left(strAddr, 4) = "新竹新竹" And (strIndArea = "科學工業園區" Or strIndArea = "科學園區") Then
                strIndArea = "新竹" & strIndArea
                strAddr = Mid(strAddr, 3)
            End If
            
            If Len(LTrim(strAddr)) > 4 And (Mid(strAddr, 3, 1) = "市" Or Mid(strAddr, 3, 1) = "縣") Then
                '輸到路/街/段
                If Asc("路") = KeyAscii Or Asc("街") = KeyAscii Or Asc("段") = KeyAscii Then
                    intFocus = Val(Me.Text1(Index).SelStart) - Len(strROC) - Len(strIndArea)
                    strAddr = Mid(strAddr, 1, intFocus) & Chr(KeyAscii) & Mid(strAddr, intFocus + 1) 'KeyPress未完成時地址欄位尚未顯示目前字,故先加入當下的字查
                    '有鄉/鎮/市/區
                    'Modify by Amy 2020/08/31 +判斷第七個字 ex:嘉義縣阿里山鄉 X80024
                    If Mid(strAddr, 7, 1) = "市" Or Mid(strAddr, 7, 1) = "區" Or Mid(strAddr, 7, 1) = "鄉" Or Mid(strAddr, 7, 1) = "鎮" _
                        Or Mid(strAddr, 6, 1) = "市" Or Mid(strAddr, 6, 1) = "區" Or Mid(strAddr, 6, 1) = "鄉" Or Mid(strAddr, 6, 1) = "鎮" _
                        Or Mid(strAddr, 5, 1) = "市" Or Mid(strAddr, 5, 1) = "區" Or Mid(strAddr, 5, 1) = "鄉" Or Mid(strAddr, 5, 1) = "鎮" Then
                        strZipCode = GetZipCode_Tai(1, strAddr, , bolMany)
                        If strZipCode <> MsgText(601) Then
                            If bolMany = False Then
                                Call ChkZipData(2, Me.Text1(Index), strZipCode)
                                Me.Text1(Index).SelStart = intFocus + Len(strROC) + Len(strIndArea)
                                Me.Text1(Index).SelLength = 0
                            Else
                                '多筆以縣/市+鄉/鎮/市/區及路名查
                                bolMany = False
                                strZipCode = GetZipCode_Tai(3, Mid(strAddr, 1, intFocus + 1), intArea, bolMany)
                                If strZipCode <> MsgText(601) And bolMany = False Then
                                    Call ChkZipData(2, Me.Text1(Index), strZipCode)
                                    Me.Text1(Index).SelStart = intFocus + Len(strROC) + Len(strIndArea)
                                    Me.Text1(Index).SelLength = 0
                                End If
                            End If
                        End If
                    '沒鄉/鎮/市/區
                    Else
                        '取 段/路/街 查
                        strZipCode = GetZipCode_Tai(2, Mid(strAddr, 1, intFocus + 1), intArea, bolMany, strNewArea)
                        If strZipCode <> MsgText(601) And bolMany = False Then
                            '補上查到的區,避免輸入兩個同樣的字(路/街/段)被取代,故不用Replace
                            Me.Text1(Index) = strROC & Left(strAddr, 3) & strNewArea & strIndArea & Mid(strAddr, 4, intArea - 4) & Mid(strAddr, intFocus + 2)
                            Call ChkZipData(2, Me.Text1(Index), strZipCode)
                            Me.Text1(Index).SelStart = intFocus + Len(strROC) + Len(strNewArea) + Len(strIndArea)
                            Me.Text1(Index).SelLength = 0
                        End If
                    End If
                End If

            End If
        End If
    'end 2015/11/02
    'Modify by Amy 2016/06/06 將點數拆出
    '費用,規費
    Case 101, 102 ', 104, 105, 107, 108, 110, 111
        If KeyAscii = 44 Or KeyAscii = 45 Then '禁打","及"-"(負數)
            KeyAscii = 0
        End If
    '點數
    Case 103 ', 106, 109, 112
    'end 2015/11/18
        If KeyAscii = 44 Then '禁打","
            KeyAscii = 0
        End If
    'Modify By Sindy 2022/12/5
    '證書形式
    Case 145
         If (KeyAscii < 49 Or KeyAscii > 50) And KeyAscii <> 8 Then
            KeyAscii = 0
            Beep
         End If
         '2022/12/5 END
    Case Else
    End Select
    
   'Add By Sindy 98/02/11
   Dim intLen As Integer
   Select Case Index
      Case 11, 14, 15, 16, 17, 20, 30, 31, 32, 33, 36, 46, 47, 48, 49, 52, 62, 63, 64, 65, 68, _
           78, 79, 80, 81, 84, 18, 19, 35, 51, 67, 83, 21, 37, 53, 69, 85, 22, 38, 54, 70, 86, _
           23, 39, 55, 71, 87, 24, 40, 56, 72, 88, 26, 42, 58, 74, 90, 27, 43, 59, 75, 91
         If KeyAscii <> 8 Then
            'Modify By Sindy 2023/5/16
            'intLen = GetTextLength(Text1(Index))
            'intLen = intLen + GetTextLength(Chr(KeyAscii))
            intLen = Len(Text1(Index))
            intLen = intLen + Len(Chr(KeyAscii))
            '2023/5/16 END
            If intLen > Text1(Index).MaxLength Then KeyAscii = 0
         End If
      Case Else
   End Select
   '98/02/11 End
End Sub

'Add By Sindy 2022/12/26
Private Sub SetFrmCol()
   m_strCaseCPM = GetAllCaseCPM() '取得案件性質代碼
   Call SetFrame41 'Add by Amy 2015/11/13
   Call SetFrame16 'Add By Sindy 2011/11/11
   Call SetFrame27 'Add By Sindy 2013/2/25
   Call SetFrame20 'Add By Sindy 2012/3/6
   Call setFrame21 'Add By Sindy 2012/5/8
   Call SetFrame25 'Add By Sindy 2012/8/17
   Call SetCRL59 'Add By Sindy 2022/12/5 證書形式
   Call SetFrameChg 'Add By Sindy 2022/12/16
   Call SetFrame28 'Add By Sindy 2022/12/24
   Call SetFrame29 'Add By Sindy 2014/2/19
End Sub

'Add By Sindy 2022/12/30
Private Sub GetSysApp()
   If Trim(Text1(6)) = "" Then Exit Sub
   m_strSys = CheckSys(Text1(6))
      
   'Add By Sindy 2022/10/14
   FrameP.Visible = False: FrameT.Visible = False: FrameL.Visible = False
   If m_strSys = "1" Or m_strSys = "5" Then
      FrameP.Visible = True
   ElseIf m_strSys = "2" Or m_strSys = "6" Then
      FrameT.Visible = True
   Else
      FrameL.Visible = True
   End If
   '2022/10/14 END
End Sub

'Modify By Sindy 2014/5/23
'Private Sub Text1_LostFocus(Index As Integer)
Public Sub Text1_LostFocus(Index As Integer)
'2014/5/23 END
   'Added by Morgan 2022/3/17
   '修正Tab鍵無法正常跳至下一駐點問題(因TextBox的Visible設True會自動取得駐點)
   'Modify By Sindy 2022/11/29
   If Not Me.ActiveControl Is Nothing Then
   '2022/11/29 END
      'If Not m_bolText1SetFocus Then
      If m_bolText1SetFocus = False Then 'Modify By Sindy 2023/9/27
         If Screen.ActiveForm.Name = Me.Name Then 'Added by Morgan 2022/3/25 視窗切換的觸發不必管
            If Me.ActiveControl.Name = "Text1" Then
               Set m_objControl = Me.ActiveControl '記錄原SetFocus的物件
               m_bolText1SetFocus = True
            End If
         End If
      End If
   End If
   'end 2022/3/17
   
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
'Add By Sindy 2009/08/31
Dim strText119 As String
Dim i As Integer, j As Integer
Dim strCP10(1 To 4) As String
Dim blnCancel As Boolean
Dim bolNoAsk As Boolean 'Add by Morgan 2011/3/28
'Add by Amy 2015/10/22 +新客戶確認臺灣地址格式
Dim strZipCode As String, strAddr As String, strCityN As String, strIndArea As String, strNewArea As String, strROC As String
Dim bolTWSame As Boolean, bolMany As Boolean, intArea As Integer
Dim intTW As Integer 'Add by Amy 2017/06/07 for 判斷台灣地址回傳用
Dim stNation As String, stMsg As String 'Add by Amy 2024/10/09
   
   If Index = 6 Then
      GetSysApp 'Add By Sindy 2022/8/30
   End If
   
   If m_blnCallPrint = True Then Exit Sub 'Add By Sindy 2014/7/25
   
    Select Case Index
    'Add By Sindy 2023/3/17
    Case 138 '商品類別
         If Text1(138) <> "" Then
            '全型轉半型
            Text1(138) = Replace(PUB_ChgNumeralStyle(Text1(138)), "，", ",")
         End If
         '2023/3/17 END
         
    'Add By Sindy 2023/3/9
    Case 1 '法定期限
         'If Text1(3).Enabled = True Then
         'Modify By Sindy 2024/1/26
         Text1(3).Tag = ""
         If Text1(Index) = "" Then
            Text1(3) = ""
         Else
         '2024/1/26 END
            strExc(10) = ""
            'Add By Sindy 2024/4/10 + if 法定期限欄位鎖住時,無須計算本所期限
            If Text1(1).Enabled = True Then
            '2024/4/10 END
               'Modify By Sindy 2024/4/25 取消 bolOnlyCountCP06 = True
               If PUB_CRLUseCP07CheckCP06(IIf(Option1(0).Value = True, "Y", ""), Left(Trim(Combo1(0).Text), 3), Text1(6), _
                  m_strCaseCPM & IIf(Trim(Combo1(1)) <> "", "," & Trim(Left(Trim(Combo1(1)), 4)), ""), Text1(3), Text1(1), strExc(10), False) = True Then
                  '有計算出本所期限,填入日期鎖住欄位
                  If Val(strExc(10)) > 0 Then
                     Text1(3).Text = strExc(10)
                     Text1(3).Enabled = False
                     'Add By Sindy 2023/9/27
                     'Modify By Sindy 2024/12/16 不要為了解決游標不見的問題,而停到系統別,反而會導致觸發了一些不必要的預設值或檢查
                     If Me.Option1(0).Value = True Then '新案跳到系統別
                        'If Me.Text1(6).Enabled = True Then Text1(6).SetFocus
                        If Me.Option1(0).Enabled = True Then Me.Option1(0).SetFocus '改跳到新案
                        '2024/12/16 END
                     ElseIf Me.Option1(1).Value = True Then '舊案跳到舊案
                        If Me.Option1(1).Enabled = True Then Me.Option1(1).SetFocus
                     End If
                     '2023/9/27 END
                  End If
               'Add By Sindy 2024/4/25
               Else
                  Text1(3).Tag = "ERR"
                  Text1(3).SetFocus
                  Exit Sub
               '2024/4/25 END
               End If
            End If
         End If
         '2023/3/9 END
            
    Case 6 '系統類別
        Combo1_LostFocus 0
        'add by nickc 2007/03/23
        If Index = 6 Then
            ChkPCT.Visible = False
            If Text1(6) = "P" Or Text1(6) = "CFP" Then
               ChkPCT.Visible = True
            End If
            'Add By Sindy 2011/6/7 系統類別為L,CFL且為新案時,可輸入案件屬性
            Frame19.Visible = False
            'Modified by Morgan 2020/6/22 +FCL
            If (Text1(6) = "L" Or Text1(6) = "CFL" Or Text1(6) = "FCL") And Option1(0).Value = True Then
               Frame19.Visible = True
            End If
            '2011/6/7 End
            
            Call SetFrmCol 'Add By Sindy 2022/12/26
            'Add By Sindy 2014/7/16
            If Me.Option1(0).Value = True Then
            '2014/7/16 END
               Call SetCombo6 'Add By Sindy 2012/6/6
               Call SetCombo5 'Add By Sindy 2012/9/3
            End If
            'Added by Lydia 2015/11/26 所有T*案之送件方改為勾選"收款後送件"
            Call SetFrame18
            
            'Added by Lydia 2020/03/30
            If Text1(6).Text <> Text1(6).Tag Then
                Call SetCombo4 '設定收據公司別(簡稱)
                'Modified by Lydia 2020/04/08 改成共用模組
                'If ChkSalesL(Text1(6).Text, Text1(10).Text) = False Then  '法務案(L、CFL)及顧問案LA之智權人員只能是法律所人員
                'Modified by Morgan 2020/4/17 非法務人員收法務案改自動收文介紹案源
                'If PUB_ChkSalesL(Text1(6).Text, Text1(10).Text) = False Then
                'End If
                SrcSetButton
                'end 2020/4/17
                'Added by Lydia 2021/02/24  CFT申請案：欄位「商標英文大寫」
                If Text7.Text <> "" Then
                    Text7.Text = UCase(Text7.Text)
                End If
                'end 2021/02/24
            End If
            'end 2020/03/30
        End If
        
        'Modify By Sindy 2014/2/21 Mark
'        'Add By Sindy 2010/4/29
'        '商標 or 專利
'        If Text1(6) = "T" Or Text1(6) = "TF" Or Text1(6) = "FCT" Or _
'            Text1(6) = "TS" Or Text1(6) = "S" Or Text1(6) = "CFT" Or _
'            Text1(6) = "P" Or Text1(6) = "CFP" Or Text1(6) = "PS" Or Text1(6) = "CPS" Then
            Label1(90).Visible = True
            Combo4.Visible = True
'        Else
'            Label1(90).Visible = False
'            Combo4.Visible = False
'            Combo4.ListIndex = 0
'        End If
        '2010/4/29 End
        
        'Add By Sindy 2009/08/31
        '商標
        If Text1(6) = "T" Or Text1(6) = "TF" Or Text1(6) = "FCT" Or _
            Text1(6) = "TS" Or Text1(6) = "S" Or Text1(6) = "CFT" Then
            SSTab1.TabEnabled(4) = True
        Else
            SSTab1.TabEnabled(4) = False
        End If
        
        SetFrame58 '商品類別 Modify By Sindy 2023/8/16
        
        '專利
        Dim bolMsgQ As Boolean, bolAnsYN As Boolean
        bolMsgQ = False   '是否有詢問過
        bolAnsYN = False '是否要保留
        If Text1(6) = "P" Or Text1(6) = "CFP" Or Text1(6) = "PS" Or Text1(6) = "CPS" Then
            If Text1(119) <> "" Then
               strText119 = ""
               arrCaseProperty = Split(Text1(119).Text, vbCrLf)
               '判斷是否需要詢問
               For iiiii = 0 To UBound(arrCaseProperty)
                  If (InStr(1, arrCaseProperty(iiiii), "商品類別：") <> 0 And _
                        Len("商品類別：") <> Len(arrCaseProperty(iiiii))) Or _
                     (InStr(1, arrCaseProperty(iiiii), "商品名稱：") <> 0 And _
                        Len("商品名稱：") <> Len(arrCaseProperty(iiiii))) Or _
                     (InStr(1, arrCaseProperty(iiiii), "註冊號數：") <> 0 And _
                        Len("註冊號數：") <> Len(arrCaseProperty(iiiii))) Then
                     If bolMsgQ = False Then
                        If MsgBox("商品資料已輸入,是否要保留?", vbExclamation + vbYesNo) = vbYes Then
                           bolAnsYN = True
                        End If
                        bolMsgQ = True
                     End If
                  End If
               Next iiiii
               '開始截取資料
               For iiiii = 0 To UBound(arrCaseProperty)
                  If InStr(1, arrCaseProperty(iiiii), "商品類別：") <> 0 Or _
                     InStr(1, arrCaseProperty(iiiii), "商品名稱：") <> 0 Or _
                     InStr(1, arrCaseProperty(iiiii), "註冊號數：") <> 0 Then
                     If bolAnsYN = True Then
                        strText119 = strText119 & arrCaseProperty(iiiii) & vbCrLf
                     End If
                  Else
                     If arrCaseProperty(iiiii) <> "" Then
                        strText119 = strText119 & arrCaseProperty(iiiii) & vbCrLf
                     End If
                  End If
               Next iiiii
               If Text1(119).Tag = Trim(Text1(119)) Then Text1(119).Tag = Trim(strText119) 'Added by Morgan 2020/5/7
               Me.Text1(119).Text = strText119
            End If
        End If
        '2009/08/31 End
        '2010/1/6 ADD BY SONIA 抓台灣發明案實審規費
        m_416Fee = 0
        '2010/8/17 MODIFY BY SONIA
        'm_416Fee = GetPatentOfficialFee(Text1(6), "416", "", m_strPA08, stCountry, "", , Text1(7), IIf(Text1(8) = "", "0", Text1(8)), IIf(Text1(9) = "", "00", Text1(9)))
        m_416Fee = GetPatentOfficialFee(Text1(6), "416", "", m_strPA08, stCountry, m_strPA16, m_strPA14, Text1(7), IIf(Text1(8) = "", "0", Text1(8)), IIf(Text1(9) = "", "00", Text1(9)))
        '2010/1/6 END
        
        'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅：不管新舊案，系統類別ACS跳離時都先彈訊息提醒
        If Text1(6).Tag <> Text1(6).Text And Text1(6) = "ACS" And strSrvDate(1) >= strACSdate1 Then
            MsgBox "ACS案件官方規費請與服務費分開填案件性質，" & vbCrLf & "官方規費請填案件性質706代收代付！", vbInformation, "ACS案件收文"
        End If
        'end 2021/03/29
        
        Text1(6).Tag = Text1(6).Text   '2011/9/15 add by sonia
                
         'Added by Morgan 2013/1/15
         If Text1(6) = "P" And Left(Trim(Combo1(0)), 3) = "000" Then
            SSTab3.TabVisible(1) = True
         Else
            SSTab3.TabVisible(1) = False
         End If
         'end 2013/1/15
         'Add By Sindy 2023/4/28
         If Me.Option1(0).Value = True Then
            If Trim(Combo1(0).Text) = "" Then '申請國家
               If Combo1(0).Enabled = True Then Combo1(0).SetFocus
            ElseIf Trim(Combo6.Text) = "" And Combo6.Visible = True Then '商標/專利種類
               If Combo6.Enabled = True Then Combo6.SetFocus
            End If
         End If
         '2023/4/28 END
         
    Case 7, 9 '本所案號
        'Add By Sindy 2010/6/10
        If Me.ActiveControl.Name = "Text1" Then
            If (Me.ActiveControl.Index = 8 Or Me.ActiveControl.Index = 9) Then
               'Add By Sindy 2024/11/1
               If Me.Option1(1).Value = True Then '舊案
                  If Me.Text1(8).Text = "" Then Me.Text1(8).Text = "0"
                  If Me.Text1(9).Text = "" Then Me.Text1(9).Text = "00"
               End If
               '2024/11/1 END
               '正常步驟，繼續操作...
               Exit Sub
            End If
        End If
        '2010/6/10 End
        
        If Me.Text1(7).Text = "" Then
            Me.Combo1(0).Text = ""
            Me.Combo1(1).Text = ""
'            Me.Combo1(2).Text = ""
'            Me.Combo1(3).Text = ""
'            Me.Combo1(4).Text = ""
            Me.Text1(11).Text = ""
            'Add by Lydia 2014/12/22 清空費用
            For i = 101 To 112
               Text1(i).Text = ""
            Next i
                
            Combo5.Text = "" 'Add By Sindy 2010/10/28
            ClearCustTxt 1
            ClearCustTxt 2
            ClearCustTxt 3
            ClearCustTxt 4
            ClearCustTxt 5
            m_strPA08 = "1"    '2010/3/1 MODIFY BY SONIA 改預設"1",原為""
            m_strPA16 = ""
            m_strPA14 = ""     '2010/8/17 add by sonia
            m_strPA10 = ""
            m_strTM15 = ""
            m_strTM12 = ""
            m_strTM09 = "" 'Add By Sindy 2022/12/29 商品類別
            m_strTM22 = "" 'Add By Sindy 2022/12/29 專用期間(止日)
            Call GetReceiptTitle 'Add by Morgan 2004/6/11
            Exit Sub
        Else
            'Me.Option3(1).Value = True
            Me.Option31(1).Value = True
        End If
        '若為舊案
        If Me.Option1(1).Value = True Then 'Modify By Sindy 2024/11/1 if拿掉 And Me.Text1(6).Text <> "" And Me.Text1(7).Text <> ""
            'Modify By Sindy 2024/11/1
            If Me.Text1(8).Text = "" Then Me.Text1(8).Text = "0"
            If Me.Text1(9).Text = "" Then Me.Text1(9).Text = "00"
            If Me.Text1(6).Text <> "" And Me.Text1(7).Text <> "" Then
            '2024/11/1 END
               Call ClearInventorCol 'Add By Sindy 2024/7/8 清空畫面上發明人欄位值
            End If
        End If
        
        m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/9/6 取得案件性質代碼
        'Add By Sindy 2022/9/28 L-888888案號,設定對造為本所客戶為是。
        If Text1(6) = "L" And Text1(7) = "888888" Then
            Check7(0).Value = 1 '是
            Check7(0).Enabled = False
            Check7(1).Enabled = False
        Else
            Check7(0).Enabled = True
            Check7(1).Enabled = True
        End If
        '2022/9/38 END
        
        'Added by Lydia 2021/05/07 ACS智財顧問專業分配比例管制
        If Text1(6).Text & Text1(7).Text & Text1(8).Text & Text1(9).Text <> Text1(6).Tag & Text1(7).Tag & Text1(8).Tag & Text1(9).Tag Then
             Call SetACS112data
        End If
        'end 2021/05/07
        
        'Added by Lydia 2020/02/05
        Call setFrame21  '如果連續收同一種案件,需要重設文件齊備、是否急件、查名齊備
        '暫存本所案號
        Me.Text1(7).Tag = Me.Text1(7).Text
        Me.Text1(8).Tag = Me.Text1(8).Text
        Me.Text1(9).Tag = Me.Text1(9).Text
        'end 2020/02/05
        
        '若有輸入本所案號
        If Me.Text1(6).Text <> "" And Me.Text1(7).Text <> "" Then
            
            If Text1(6) = "LA" Then Me.Text1(11).Enabled = True 'Add By Sindy 2011/6/17
            
            '2008/3/21 modify by sonia 商標案加抓tm15,tm12
            'Modify by Morgan 2008/8/1 加抓個案申請人聯絡人編號
            'Modify by Sindy 2009/05/21 加抓商標檔申請人2,3,4,5及服務檔申請人4,5
            '2010/3/31 MODIFY BY SONIA 專利案加申請日
            '2010/8/17 modify by sonia 專利案加公告日pa14
            'Modify By Sindy 2011/2/21 增加LC43,LC44,LC45,LC46,HC24,HC25,HC26,HC27
            'Modify By Sindy 2013/12/16 +pa161
            StrSQLa = "Select NA01||' '||NA03, Nvl(PA05, Nvl(PA06, PA07)), PA26, PA27, PA28, PA29, PA30, PA08, PA16, PA48, '', '',PA149,PA10,PA75,PA14,PA158,pa161 From Patent, Nation,Customer Where PA09=NA01(+) And PA01='" & Me.Text1(6).Text & "' And PA02='" & Me.Text1(7).Text & "' And PA03='" & Me.Text1(8).Text & "' And PA04='" & Me.Text1(9).Text & "' and cu01(+)=substr(pa26,1,8) and cu02(+)=substr(pa26,9,1) "
            StrSQLa = StrSQLa & " Union Select NA01||' '||NA03, Nvl(TM05, Nvl(TM06, TM07)), TM23, TM78, TM79, TM80, TM81, '', '', TM35,TM15,TM12,TM123,0,TM44,0,'',tm130 as pa161 From Trademark, Nation,Customer Where TM10=NA01(+) And TM01='" & Me.Text1(6).Text & "' And TM02='" & Me.Text1(7).Text & "' And TM03='" & Me.Text1(8).Text & "' And TM04='" & Me.Text1(9).Text & "' and cu01(+)=substr(TM23,1,8) and cu02(+)=substr(TM23,9,1)  "
            StrSQLa = StrSQLa & " Union Select NA01||' '||NA03, Nvl(LC05, Nvl(LC06, LC07)), LC11, LC43, LC44, LC45, LC46, '', '', LC17, '', '',LC42,0,LC22,0,'',lc48 as pa161 From Lawcase, Nation,Customer Where LC15=NA01(+) And LC01='" & Me.Text1(6).Text & "' And LC02='" & Me.Text1(7).Text & "' And LC03='" & Me.Text1(8).Text & "' And LC04='" & Me.Text1(9).Text & "' and cu01(+)=substr(LC11,1,8) and cu02(+)=substr(LC11,9,1) "
            StrSQLa = StrSQLa & " Union Select NA01||' '||NA03, HC06, HC05, HC24, HC25, HC26, HC27, '', '', '', '', '',HC23,0,'',0,'','' as pa161 From Hirecase, Nation,Customer Where '000'=NA01(+) And HC01='" & Me.Text1(6).Text & "' And HC02='" & Me.Text1(7).Text & "' And HC03='" & Me.Text1(8).Text & "' And HC04='" & Me.Text1(9).Text & "' and cu01(+)=substr(HC05,1,8) and cu02(+)=substr(HC05,9,1) "
            StrSQLa = StrSQLa & " Union Select NA01||' '||NA03, Nvl(SP05, Nvl(SP06, SP07)), SP08, SP58, SP59, SP65, SP66, '', '', SP29, '', '',SP78,0,SP26,0,'',sp85 as pa161 From Servicepractice, Nation,Customer Where SP09=NA01(+) And SP01='" & Me.Text1(6).Text & "' And SP02='" & Me.Text1(7).Text & "' And SP03='" & Me.Text1(8).Text & "' And SP04='" & Me.Text1(9).Text & "' and cu01(+)=substr(SP08,1,8) and cu02(+)=substr(SP08,9,1) "
            rsA.CursorLocation = adUseClient
            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
            If rsA.RecordCount > 0 Then
               'Add by Amy 2024/10/09
               stNation = "" & rsA.Fields(0)
               If stNation <> MsgText(601) Then stNation = Left(stNation, Val(InStr(stNation, " ")) - 1)
               'Add by Amy 2016/09/01 當601異議/603評定/605廢止原新商標案改收舊案時不彈
               If bolNotShow = False Then
                    'Add by Morgan 2011/3/28 考慮輸多張接洽單只有改案號情形
                    If m_lstCaseNo <> "" And m_lstCaseNo <> Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text Then
                       'Add By Sindy 2014/5/23 外部呼叫時一定要先清除再使用
                       'Modified by Morgan 2020/6/29
                       'If bolExternalCall = True Then
                       If bolExternalCall = True Or strLCaseNo(1) = "L" Then
                       'end 2020/6/29
                          cmdClear True
                       Else
                       '2014/5/23 END
                          If MsgBox("是否清除原畫面資料？", vbYesNo + vbDefaultButton2) = vbYes Then
                             cmdClear True
                          '2013/10/7 ADD BY SONIA 改案號無論如何都清本所期限及法定期限,否則操作人員若不清畫面會有不同案號不同期限的問題(先收T-086187延展,再收T-134151延展)
                          Else
                            ' Text1(1) = "": Text1(3) = ""
                            'Add by Lydia 2015/01/06 清除費用資料
                            Call FreeClear
                          '2013/10/7 END
                          End If
                       End If
                       bolNoAsk = True
                    Else
                       bolNoAsk = False
                    End If
               End If
               'end 2016/09/01
               
               'Add by Amy 2024/10/09 專利案已收放棄專利權(429)且已發文及已通知專利權公告作廢(1606),彈訊息不能再收文年費,可操作 ex:P-130087
               If ChkP429Or1606NoAdd605(Text1(6), Text1(7), Text1(8), Text1(9), Left(stNation, 3), stMsg) = True Then
                  MsgBox stMsg, vbExclamation + vbOKOnly
               End If
               
               'Add By Sindy 2022/12/23 記錄基本檔的申請人
               strAppl1 = "" & rsA.Fields("PA26")
               strAppl2 = "" & rsA.Fields("PA27")
               strAppl3 = "" & rsA.Fields("PA28")
               strAppl4 = "" & rsA.Fields("PA29")
               strAppl5 = "" & rsA.Fields("PA30")
               strPA149 = "" & rsA.Fields("PA149")
               Call GetMainData '抓取主檔資料
               Text1(138).Text = m_strTM09
               
               'Add By Sindy 2013/12/16 舊案若為智權公司則收據公司別設定為智權公司則鎖住
               If strSrvDate(1) >= InvoiceStartDate Then
                  Combo4.Enabled = True
                  If "" & rsA.Fields("pa161").Value = "J" Then
                     'Modified by Lydia 2020/03/30
                     'If Combo4.ListCount < 4 Then
                     '   Combo4.AddItem "智權公司"
                     'End If
                     'Combo4.ListIndex = 3
                     If Combo4.ListCount < m_CompJforIdx + 1 Then
                        Combo4.AddItem m_CompNameJ
                     End If
                     Combo4.ListIndex = m_CompJforIdx
                     'end 2020/03/30
                     Combo4.Enabled = False
                  Else
                     'Modified by Lydia 2020/03/30
                     'If Combo4.ListCount = 4 Then
                     '   Combo4.RemoveItem 3
                     If Combo4.ListCount = m_CompJforIdx + 1 Then
                        Combo4.RemoveItem m_CompJforIdx
                     'end 2020/03/30
                     End If
                  End If
               End If
               '2013/12/16 END
               
               '2011/10/19 cancel by sonia移到下面去
               'm_lstCaseNo = Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text
'                '專利種類
'                m_strPA08 = "" & rsA.Fields(7).Value
                'Add By Sindy 2014/7/15
                Call SetCombo6 'Add By Sindy 2014/7/16
                If m_strPA08 <> "" Then
                  If Combo6.Visible = True Then 'Modify By Sindy 2014/7/18 +if
                     Combo6.ListIndex = m_strPA08 - 1
                  End If
                End If
                '案件屬性
                Call SetCombo5
                If "" & rsA.Fields("pa158").Value <> "" Then
                  If Combo5.Visible = True Then 'Modify By Sindy 2014/7/18 +if
                     'Add By Sindy 2024/4/8 ex:P-131675收文領證時案件屬性會有錯
                     If "" & rsA.Fields("pa158").Value > Combo5.ListCount Then
                        Combo5.Text = "" & rsA.Fields("pa158").Value + "."
                     Else
                     '2024/4/8 END
                        Combo5.ListIndex = "" & rsA.Fields("pa158").Value - 1
                     End If
                  End If
                End If
                '2014/7/15 END
'                m_strPA16 = "" & rsA.Fields(8).Value
'                '2010/8/17 add by sonia
'                m_strPA14 = "" & rsA.Fields(15).Value
'                If m_strPA14 = "0" Then m_strPA14 = ""
'                '2010/8/17 END
'                m_strPA10 = "" & rsA.Fields(13).Value  '2010/3/31 ADD BY SONIA
'                '2008/3/21 ADD BY SONIA
'                m_strTM15 = "" & rsA.Fields(10).Value
'                m_strTM12 = "" & rsA.Fields(11).Value
'                '2008/3/21 END
'                'Add By Sindy 2010/7/9
'                If m_strPA08 <> "" Then '代表有pa資料
'                  ReDim pa(1 To TF_PA) As String
'                  Call PUB_ReadPatentData(pa(), Text1(6), Text1(7), Text1(8), Text1(9))
'                End If
                '舊案
                Me.Option1(0).Value = False
                Me.Option1(1).Value = True
                '申請國
                Me.Combo1(0).Text = "" & rsA.Fields(0).Value
                stCountry = Trim(Mid(Combo1(0).Text, 1, 4))
                
'                'Modified by Lydia 2014/12/25 電子化(2015/1/1)後可減少列印(大陸案例外)
'                Call settxtPCnt
                
                SetOpt81 stCountry 'Added by Morgan 2013/4/9
                
                '主題
                Me.Text1(11).Text = "" & rsA.Fields(1).Value
                
                'Add By Sindy 2010/10/28 案件屬性
                'Modified by Lydia 2019/08/12 +""
                'If IsNull(rsA.Fields(16).Value) Then
                If "" & rsA.Fields(16).Value = "" Then
                  Combo5 = ""
                Else
                  'Modified by Lydia 2024/04/24 +專利種類IIf(Combo6.Text <> "", Left(Combo6, 1), "")
                  Combo5 = rsA.Fields(16).Value + "." + PUB_GetCaseAttributeName(rsA.Fields(16).Value, IIf(Combo6.Text <> "", Left(Combo6, 1), ""))
                End If
                '2010/10/28 End
                
                'Add By Sindy 2010/5/27
                '代理人
                ClearFagentTxt
                If "" & rsA.Fields(14).Value <> "" Then
                    SetFagentTxt "" & rsA.Fields(14).Value
                    'Added by Lydia 2019/01/30 大至台案件彈出代理人D/N備註
                    If OptChoose(1).Value = True Then
                        If Left(Text1(6), 1) = "T" And m_FA110 <> "" Then '商標D/N備註
                            MsgBox "代理人D/N備註：" & vbCrLf & m_FA110, vbExclamation, "代理人D/N備註"
                        ElseIf m_FA45 <> "" Then  '專利D/N備註
                            MsgBox "代理人D/N備註：" & vbCrLf & m_FA45, vbExclamation, "代理人D/N備註"
                        End If
                    End If
                    'end 2019/01/30
                End If
                
                '申請人1
                ClearCustTxt 1
                If "" & rsA.Fields(2).Value <> "" Then
                    SetCustTxt 1, "" & rsA.Fields(2).Value
                    'Add by Morgan 2008/8/1
                    'Modified by Morgan 2022/1/20
                    PUB_AddContact rsA.Fields(2), cboContact(1), "" & rsA.Fields("PA149"), True, True, m_strContactList(1)
                    'Added by Lydia 2019/08/15 提醒及列印顧問服務件數,放在最後會出現未知錯誤(P.S.陳建宏輸入LA-003308-0-00在輸入完４欄位用滑鼠跳回第２欄，有程式錯誤messag之後才彈"聘任期間xxxxx")
                   ' Call SetLAdata 'Mark by Lydia 2025/07/04 改在CheckDataValidate5才彈訊息
                End If
                '申請人2
                ClearCustTxt 2
                If "" & rsA.Fields(3).Value <> "" Then
                    SetCustTxt 2, "" & rsA.Fields(3).Value
                    'Add by Morgan 2008/8/1
                    'Modified by Morgan 2022/1/20 改2.0
                    PUB_AddContact rsA.Fields(3), cboContact(2), , True, True, m_strContactList(2)
                End If
                '申請人3
                ClearCustTxt 3
                If "" & rsA.Fields(4).Value <> "" Then
                    SetCustTxt 3, "" & rsA.Fields(4).Value
                    'Add by Morgan 2008/8/1
                    'Modified by Morgan 2022/1/20 改2.0
                    PUB_AddContact rsA.Fields(4), cboContact(3), , True, True, m_strContactList(3)
                End If
                '申請人4
                ClearCustTxt 4
                If "" & rsA.Fields(5).Value <> "" Then
                    SetCustTxt 4, "" & rsA.Fields(5).Value
                    'Add by Morgan 2008/8/1
                    'Modified by Morgan 2022/1/20 改2.0
                    PUB_AddContact rsA.Fields(5), cboContact(4), , True, True, m_strContactList(4)
                End If
                '申請人5
                ClearCustTxt 5
                If "" & rsA.Fields(6).Value <> "" Then
                    SetCustTxt 5, "" & rsA.Fields(6).Value
                    'Add by Morgan 2008/8/1
                    'Modified by Morgan 2022/1/20 改2.0
                    PUB_AddContact rsA.Fields(6), cboContact(5), , True, True, m_strContactList(5)
                End If
                Combo1_LostFocus 0
                
                'Add By Sindy 2015/7/27 原在按下列印鍵時提醒,改先提醒
                IsSpecCu = False
                SpecCUName = ""
                SpecMemo = ""
                IsCuMemo = False
                CuMemoName = ""
                CuMemo = ""
                SetCuData IsSpecCu, SpecCUName, SpecMemo, IsCuMemo, CuMemoName, CuMemo
                If m_blnCallPrint = False Then
                   If IsCuMemo Then
                      MsgBox CuMemoName & "此客戶有業務備註！！", vbInformation, "業務備註！"
                   End If
                   'Added by Morgan 2020/3/16
                   'P台灣申請中案件(無公告日,專用期間)，最後發文之A或B類(不續辦、閉卷、取消收文除外)之出名代理人有76012桂所長的案件，檢查若該申請人無總委案件則顯示訊息
                   If Text1(6) = "P" And stCountry = "000" Then
                     strExc(1) = ""
                     If PUB_ChkIsGuiCase(pa(1), pa(2), pa(3), pa(4), , strExc(1)) Then
                        If strExc(1) <> "" Then
                           MsgBox "本案須辦理變更代理人為閻+林,請協助簽署下列申請人總(個)委任書！" & vbCrLf & vbCrLf & strExc(1), vbExclamation
                        End If
                     End If
                   End If
                   'end 2020/3/16
                End If
                '2015/7/27 END
                
                '客戶案號(型號)
                Me.Text1(18).Text = "" & rsA.Fields(9).Value
                If Me.Text1(18).Text = "" Then Me.Text1(18).Enabled = True
                
                '2011/10/19 add by sonia舊案檢查申請地址與客戶中文地址是否相同,若不同則提醒
                If m_lstCaseNo = "" Or (m_lstCaseNo <> "" And m_lstCaseNo <> Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text) Then
                   '申請人地址
                   For i = 1 To 5
                      If Text1(27 + (i - 1) * 16) <> "" Then
                         Call CheckCustAddr(Text1(27 + (i - 1) * 16), Text1(12 + (i - 1) * 16), i)
                      End If
                   Next i
                End If
                
                m_lstCaseNo = Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text  '2011/10/19 從上面移下來
                '2011/10/19 end
                
                'Add by Amy 2016/09/01 當601異議/603評定/605廢止原新商標案改收舊案時不檢查
                If bolNotShow = False Then
                    'Add By Sindy 2010/4/6
                    Call CallFrm090801_2(bolNoAsk)
                    '2010/4/6 End
                    
                    SetElecApp '2014/11/28 add by sonia P-099681因改請案也可電子送件且規費可減免故郭說台灣舊案也可點選
                End If
                'end 2016/09/01
                
               'Add By Sindy 2025/8/1 專利／商標會稿-收文分析:預設收文性質為分析
               '目前僅一個案件性質
               If UCase(TypeName(m_PrevForm)) = UCase("frm090202_2") Then
                  If m_strGetNP01 <> "" And InStr(m_strGetNP01, ":") > 0 Then
                     strCP10(1) = Mid(m_strGetNP01, 1, InStr(m_strGetNP01, ":") - 1)
                     m_strGetNP01 = Mid(m_strGetNP01, InStr(m_strGetNP01, ":") + 1)
                     For i = 0 To Combo1(1).ListCount - 1
                        If InStr(Combo1(1).List(i), strCP10(1) & " ") = 1 Then
                           Combo1(1).ListIndex = i
                           Combo1_LostFocus 1
                           '預設費用為0
                           Text1(101).Text = "0"
                           Text1(102).Text = "0"
                           Text1(103).Text = "0.000"
                           Call cmdUpd_Click '新增
                           Exit For
                        End If
                     Next i
                  End If
               End If
               '2025/8/1 END
               
               'Call SetLAdata 'Added by Lydia 2019/04/10 提醒及列印顧問服務件數 'Mark by Lydia 2019/08/15
                
            Else
                m_strPA08 = "1"    '2010/3/1 MODIFY BY SONIA 改預設"1",原為""
                m_strPA16 = ""
                m_strPA14 = ""     '2010/8/17 add by sonia
                m_strPA10 = ""
                m_strTM15 = ""
                m_strTM12 = ""
                m_strTM09 = "" 'Add By Sindy 2022/12/29 商品類別
                m_strTM22 = "" 'Add By Sindy 2022/12/29 專用期間(止日)
                MsgBox "查無此本所案號資料!!!", vbExclamation + vbOKOnly
                Text1(7).Text = "" 'Add By Sindy 2023/3/30 不清除會一直彈訊息"查無此本所案號資料"
                Me.Combo1(0).Text = ""
                Me.Combo1(1).Text = ""
'                Me.Combo1(2).Text = ""
'                Me.Combo1(3).Text = ""
'                Me.Combo1(4).Text = ""
                Me.Combo1(1).Clear
'                Me.Combo1(2).Clear
'                Me.Combo1(3).Clear
'                Me.Combo1(4).Clear
                Me.Text1(11).Text = ""
                Combo5.Text = "" 'Add By Sindy 2010/10/28
                ClearCustTxt 1
                ClearCustTxt 2
                ClearCustTxt 3
                ClearCustTxt 4
                ClearCustTxt 5
                'Add by Lydia 2014/12/22 清空費用
                For i = 101 To 112
                   Text1(i).Text = ""
                Next i
                Frame605.Visible = False
                
                Me.Text1(18).Text = ""
                'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用 + And Me.Visible = True
                If Me.Text1(6).Enabled = True And Me.Visible = True Then Me.Text1(6).SetFocus

                Text1_GotFocus 6
            End If
            If rsA.State <> adStateClosed Then rsA.Close
            Set rsA = Nothing
        End If
        Call GetReceiptTitle 'Add by Morgan 2004/6/11
        '2010/1/6 ADD BY SONIA 抓台灣發明案實審規費
        m_416Fee = 0
        '2010/8/17 MODIFY BY SONIA
        'm_416Fee = GetPatentOfficialFee(Text1(6), "416", "", m_strPA08, stCountry, "", , Text1(7), IIf(Text1(8) = "", "0", Text1(8)), IIf(Text1(9) = "", "00", Text1(9)))
        m_416Fee = GetPatentOfficialFee(Text1(6), "416", "", m_strPA08, stCountry, m_strPA16, m_strPA14, Text1(7), IIf(Text1(8) = "", "0", Text1(8)), IIf(Text1(9) = "", "00", Text1(9)))
        '2010/1/6 END
    
    'Add By Sindy 2023/4/7 Text1_KeyPress有時因輸入法失效沒執行到,所以此處再Run一次轉全型
    '郵遞區號
    Case 25, 41, 57, 73, 89, 120, 121, 122, 123, 124
        Text1(Index) = PUB_ChangeZIPToSir(Text1(Index))
'    '英文地址
'    Case 125, 141, 157, 173, 189
'        Text1(Index) = StrConv(Text1(Index), vbNarrow) '將字串中的寬(全形)字元轉換成窄(半形)字元 ==> 不能用Unicode會有問題
    '2023/4/7 END
    
    'Add by Amy 2015/11/02 +新客戶確認臺灣地址格式(舊客戶欄位鎖住)
    Case 26, 42, 58, 74, 90 '聯絡地址
        'Modify by Amy 2016/07/27 印過判斷前5個字不同才改變 intTWAddr()值
        If Me.Text1(Index) <> MsgText(601) Then
            Me.Text1(Index) = ReplaceAddrTW(Me.Text1(Index))
            'Add by Amy 2017/08/22 +if 判斷若郵件信箱只檢查CheckTaiwanAddr
            'Modify by Amy 2024/08/29 拿掉 2017/08/22 +if 判斷若郵件信箱只檢查CheckTaiwanAddr-秀玲:智權查 ex:接洽單號 1130018318 聯絡地址-台中市西區公益路第93號信箱 會設成跨所
            '                             電子接洽單上線[前] 郵政信箱格式不對時,由櫃台建新客戶時,櫃台至郵局網頁查,電子接洽單上線[後]應由智權查,以避免櫃台新建客戶資料與接洽單不一致無法存
'            If InStr(Me.Text1(Index), "信箱") > 0 Then
'                If CheckTaiwanAddr(Text1(26 + (i - 1) * 16), "000", "申請人" & (Index - 10) / 16 & "的聯絡地址") = False Then
'                   Call ChkZipData(9, Me.Text1(Index))
'                   Exit Sub
'                Else
'                    intTWAddr(((Index - 26) / 16) * 2 + 1) = 20
'                End If
'            Else
AgainCheck1:
            strROC = ""
            strAddr = Me.Text1(Index)
            If Left(strAddr, 4) = "中華民國" Then strROC = strROC & Left(strAddr, 4): strAddr = Mid(strAddr, 5)
            If Left(strAddr, 3) = "臺灣省" Or Left(strAddr, 3) = "台灣省" Then strROC = strROC & Left(strAddr, 3): strAddr = Mid(strAddr, 4)
            If Left(strAddr, 2) = "臺灣" Or Left(strAddr, 2) = "台灣" Then strROC = strROC & Left(strAddr, 2): strAddr = Mid(strAddr, 3)
            '去除xx工業區查(台中工業區/台塑工業園區不取代,可能抓錯zip)
            strIndArea = "True"
            strAddr = ReplaceIndArea(strAddr, strIndArea)
            If strIndArea = "True" Then strIndArea = MsgText(601)
            If Left(strAddr, 4) = "新竹新竹" And (strIndArea = "科學工業園區" Or strIndArea = "科學園區") Then
                strIndArea = "新竹" & strIndArea
                strAddr = Mid(strAddr, 3)
            End If
            
            '第3個字是 縣 / 市
            If Mid(strAddr, 3, 1) = "市" Or Mid(strAddr, 3, 1) = "縣" Or Mid(strAddr, 1, 3) = "釣魚臺" Or Mid(strAddr, 1, 3) = "海南島" Then
                'Modify by Amy 2020/08/31 +判斷第七個字 ex:嘉義縣阿里山鄉 X80024
                If Mid(strAddr, 7, 1) = "市" Or Mid(strAddr, 7, 1) = "區" Or Mid(strAddr, 7, 1) = "鄉" Or Mid(strAddr, 7, 1) = "鎮" _
                    Or Mid(strAddr, 6, 1) = "市" Or Mid(strAddr, 6, 1) = "區" Or Mid(strAddr, 6, 1) = "鄉" Or Mid(strAddr, 6, 1) = "鎮" _
                    Or Mid(strAddr, 5, 1) = "市" Or Mid(strAddr, 5, 1) = "區" Or Mid(strAddr, 5, 1) = "鄉" Or Mid(strAddr, 5, 1) = "鎮" Then
                    '傳入地址前6個字抓到郵遞區號
                    intArea = 6
                    strZipCode = GetPostZip(Left(strAddr, 6), 6, , , bolMany)
                    '傳入地址前5個字取郵遞區號
                    If strZipCode = MsgText(601) Then strZipCode = GetPostZip(Left(strAddr, 5), 5, , , bolMany): intArea = 5
                    '抓到郵遞區號
                    If strZipCode <> MsgText(601) Then
                        If bolMany = True Then
                            '多筆以縣/市+鄉/鎮/市/區及路名查
                            bolMany = False
                            strZipCode = GetZipCode_Tai(3, strAddr, , bolMany)
                            If strZipCode <> MsgText(601) Then
                                '限制縣/市+鄉/鎮/市/區及路名查:一筆-直接帶/多筆-進查詢畫面
                                If bolMany = False Then
                                    Call ChkZipData(2, Me.Text1(Index), strZipCode)
                                Else
                                    Call ChkZipData(1, Me.Text1(Index), strZipCode, intArea)
                                End If
                            End If
                        Else
                            '非多筆
                            Call ChkZipData(2, Me.Text1(Index), strZipCode, intArea)
                        End If
                    Else
                        '判斷是否有此區/鄉/鎮
                         strZipCode = GetPostZip(Mid(strAddr, 4, intArea - 3), intArea - 3, , , bolMany, "Pzd03")
                        If strZipCode <> MsgText(601) Then
                            '區別錯,進入查詢畫面
                            Call ChkZipData(3, Me.Text1(Index), strZipCode, intArea)
                        Else
                            '當作沒區只有路 ex:新竹縣or市園區二路
                            bolMany = False
                            strZipCode = GetZipCode_Tai(2, strAddr, intArea, bolMany, strNewArea)
                            If strZipCode <> MsgText(601) Then
                                '以縣/市及路名查:一筆-直接帶/多筆-進查詢畫面
                                If bolMany = False Then
                                    Me.Text1(Index) = strROC & Left(strAddr, 3) & strNewArea & strIndArea & Mid(strAddr, 4)
                                    Call ChkZipData(2, Me.Text1(Index), strZipCode, intArea)
                                Else
                                    intArea = 0
                                    Call ChkZipData(4, Me.Text1(Index), strZipCode, intArea)
                                    Exit Sub
                                End If
                            End If
                        End If
                    End If
                '無鄉/鎮/市/區
                Else
                    '以路/街 抓是否有zip
                    strZipCode = GetZipCode_Tai(2, strAddr, intArea, bolMany, strNewArea)
                    If strZipCode <> MsgText(601) Then
                        If bolMany = True Then
                            '多筆
                            intArea = 0
                            Call ChkZipData(4, Me.Text1(Index), strZipCode, intArea)
                        Else
                            '非多筆
                            Me.Text1(Index) = strROC & Left(strAddr, 3) & strNewArea & strIndArea & Mid(strAddr, 4)
                            Call ChkZipData(2, Me.Text1(Index), strZipCode, intArea)
                        End If
                    End If
                End If
                '都抓不到ZipCode
                If strZipCode = MsgText(601) Then
                    'Modify by Amy 2024/06/24 +SSTab1/2 存檔後修改先切畫面,才看的到資料輸什麼
                    'Modify by Amy 2024/08/29 +Me.Name
                    If CheckTaiwanAddr_Tai(Me.Text1(Index), Me.Text1(Index - 1), "000", "", strZipCode, , False, Me.Name, , intTW, SSTab1, SSTab2, Me.Name) = False Then
                        'Modify by Amy 2024/08/29 連續收不設地址變數=10,若為台灣改設3 原:intTWAddr(((Index - 26) / 16) * 2 + 1) = 10
                        If intTWAddr(((Index - 26) / 16) * 2 + 1) = 0 Or (intTWAddr(((Index - 26) / 16) * 2 + 1) = 3 And Left(strOldAddr(((Index - 26) / 16) * 2 + 1), 5) <> Left(Me.Text1(Index), 5)) Then
                            Call ChkZipData(9, Me.Text1(Index), strZipCode) 'Add by Amy 2024/06/24 存檔後修改, 切到相對畫面才能看到資料
                            If MsgBox("無法依地址帶出申請人" & (Index - 10) / 16 & " [聯絡地址]" & "的郵遞區號" & vbCrLf & "請問是臺灣地址嗎？", vbYesNo + vbCritical) = vbYes Then
                                intTWAddr(((Index - 26) / 16) * 2 + 1) = 1
                                If strZipCode = "格式錯誤" Then
                                    frm100135.Show vbModal
                                    Call ChkZipData(9, Me.Text1(Index), strZipCode)
                                Else
                                    Call ChkZipData(3, Me.Text1(Index), strZipCode)
                                End If
                                Exit Sub
                             Else
                                '非臺灣
                                 intTWAddr(((Index - 26) / 16) * 2 + 1) = 99
                                 Exit Sub
                             End If
                        ElseIf intTWAddr(((Index - 26) / 16) * 2 + 1) = 1 Then
                            '避免無法按zip鈕故此不判斷
                        End If
                    End If
                    
                End If
            '第3個字無 縣 / 市
            Else
                '傳入地址前2個字判斷是否有其縣/市
                strCityN = "Pzd02"
                strZipCode = GetPostZip(Left(strAddr, 2), 3, 1, , bolMany, "Pzd02", strCityN)
                If strZipCode <> MsgText(601) Then
                    If bolMany = False Then
                        '只有一筆
                        Me.Text1(Index) = strROC & strCityN & strIndArea & Mid(strAddr, 3)
                        GoTo AgainCheck1
                    Else
                        '新竹、嘉義會有2筆
                        intArea = 0
                        Call ChkZipData(5, Me.Text1(Index), strZipCode, intArea)
                    End If
                '查無郵遞區號
                Else
                    'Modify by Amy 2024/08/29 連續收不設地址變數=10,若為台灣改設3 原:intTWAddr(((Index - 26) / 16) * 2 + 1) = 10
                    If intTWAddr(((Index - 26) / 16) * 2 + 1) = 0 Or (intTWAddr(((Index - 26) / 16) * 2 + 1) = 3 And Left(strOldAddr(((Index - 26) / 16) * 2 + 1), 5) <> Left(Me.Text1(Index), 5)) Then
                        Call ChkZipData(9, Me.Text1(Index), strZipCode) 'Add by Amy 2024/06/24 存檔後修改, 切到相對畫面才能看到資料
                        If MsgBox("無法依地址帶出申請人" & (Index - 10) / 16 & " [聯絡地址]" & "的郵遞區號" & vbCrLf & "請問是臺灣地址嗎？", vbYesNo + vbCritical) = vbYes Then
                            intTWAddr(((Index - 26) / 16) * 2 + 1) = 1
                            frm100135.Show vbModal
                            If Text1(Index).Enabled = True And Me.Visible = True Then Me.Text1(Index).SetFocus
                            Exit Sub
                        Else
                            '非臺灣
                            intTWAddr(((Index - 26) / 16) * 2 + 1) = 99
                            Exit Sub
                        End If
                    End If
                
                End If
            End If
'            End If '檢查是否為郵件信箱
        End If
        Text1(Index).Tag = Text1(Index) 'Add by Amy 2024/06/24
        
    Case 27, 43, 59, 75, 91 '申請地址
AgainCheck2:
        bolTWSame = False
        If Trim(Me.Text1(Index)) = "同上" Or Trim(Me.Text1(Index)) = "同聯絡地址" _
           Or (Trim(Me.Text1(Index)) <> MsgText(601) And Trim(Me.Text1(Index)) = Trim(Me.Text1(Index - 1))) Then
            Call ChkZipData(0, Me.Text1(Index))
            bolTWSame = True
        End If

        If Me.Text1(Index) <> MsgText(601) And bolTWSame = False Then
            strROC = ""
            Me.Text1(Index) = ReplaceAddrTW(Me.Text1(Index))
            strAddr = Me.Text1(Index)
            If Left(strAddr, 4) = "中華民國" Then strROC = strROC & Left(strAddr, 4): strAddr = Mid(strAddr, 5)
            If Left(strAddr, 3) = "臺灣省" Or Left(strAddr, 3) = "台灣省" Then strROC = strROC & Left(strAddr, 3): strAddr = Mid(strAddr, 4)
            If Left(strAddr, 2) = "臺灣" Or Left(strAddr, 2) = "台灣" Then strROC = strROC & Left(strAddr, 2): strAddr = Mid(strAddr, 3)
            '去除xx工業區查(台中工業區/台塑工業園區不取代,可能抓錯zip)
            strIndArea = "True"
            strAddr = ReplaceIndArea(strAddr, strIndArea)
            If strIndArea = "True" Then strIndArea = MsgText(601)
            If Left(strAddr, 4) = "新竹新竹" And (strIndArea = "科學工業園區" Or strIndArea = "科學園區") Then
                strIndArea = "新竹" & strIndArea
                strAddr = Mid(strAddr, 3)
            End If
      
            '第3個字是 縣 / 市
            If Mid(strAddr, 3, 1) = "市" Or Mid(strAddr, 3, 1) = "縣" Or Mid(strAddr, 1, 3) = "釣魚臺" Or Mid(strAddr, 1, 3) = "海南島" Then
                'Modify by Amy 2020/08/31 +判斷第七個字 ex:嘉義縣阿里山鄉 X80024
                If Mid(strAddr, 7, 1) = "市" Or Mid(strAddr, 7, 1) = "區" Or Mid(strAddr, 7, 1) = "鄉" Or Mid(strAddr, 7, 1) = "鎮" _
                    Or Mid(strAddr, 6, 1) = "市" Or Mid(strAddr, 6, 1) = "區" Or Mid(strAddr, 6, 1) = "鄉" Or Mid(strAddr, 6, 1) = "鎮" _
                    Or Mid(strAddr, 5, 1) = "市" Or Mid(strAddr, 5, 1) = "區" Or Mid(strAddr, 5, 1) = "鄉" Or Mid(strAddr, 5, 1) = "鎮" Then
                    '傳入地址前6個字抓到郵遞區號
                    intArea = 6
                    strZipCode = GetPostZip(Left(strAddr, 6), 6, , , bolMany)
                    '傳入地址前5個字取郵遞區號
                    If strZipCode = MsgText(601) Then strZipCode = GetPostZip(Left(strAddr, 5), 5, , , bolMany): intArea = 5
                    '抓到郵遞區號
                    If strZipCode <> MsgText(601) Then
                        If bolMany = True Then
                            '多筆以縣/市+鄉/鎮/市/區及路名查
                            bolMany = False
                            strZipCode = GetZipCode_Tai(3, strAddr, , bolMany)
                            If strZipCode <> MsgText(601) Then
                                '限制縣/市+鄉/鎮/市/區及路名查:一筆-直接帶/多筆-進查詢畫面
                                If bolMany = False Then
                                    Call ChkZipData(2, Me.Text1(Index), strZipCode)
                                Else
                                    Call ChkZipData(1, Me.Text1(Index), strZipCode, intArea)
                                End If
                            End If
                        Else
                            '非多筆
                            Call ChkZipData(2, Me.Text1(Index), strZipCode, intArea)
                        End If
                    Else
                        '判斷是否有此區/鄉/鎮
                         strZipCode = GetPostZip(Mid(strAddr, 4, intArea - 3), intArea - 3, , , bolMany, "Pzd03")
                        If strZipCode <> MsgText(601) Then
                            Call ChkZipData(3, Me.Text1(Index), strZipCode, intArea)
                        Else
                            '當作沒區只有路 ex:新竹縣or市園區二路
                            bolMany = False
                            strZipCode = GetZipCode_Tai(2, strAddr, intArea, bolMany, strNewArea)
                            If strZipCode <> MsgText(601) Then
                                '以縣/市及路名查:一筆-直接帶/多筆-進查詢畫面
                                If bolMany = False Then
                                    Me.Text1(Index) = Left(Me.Text1(Index), 3) & strNewArea & Mid(Me.Text1(Index), 4)
                                    Call ChkZipData(2, Me.Text1(Index), strZipCode, intArea)
                                Else
                                    intArea = 0
                                    Call ChkZipData(4, Me.Text1(Index), strZipCode, intArea)
                                    Exit Sub
                                End If
                            End If
                        End If
                    End If
                '無鄉/鎮/市/區
                Else
                    '以路/街 抓是否有zip
                    strZipCode = GetZipCode_Tai(2, strAddr, intArea, bolMany, strNewArea)
                    If strZipCode <> MsgText(601) Then
                        If bolMany = True Then
                            '多筆
                            intArea = 0
                            Call ChkZipData(4, Me.Text1(Index), strZipCode, intArea)
                        Else
                            '非多筆
                            Me.Text1(Index) = strROC & Left(strAddr, 3) & strNewArea & strIndArea & Mid(strAddr, 4)
                            Call ChkZipData(2, Me.Text1(Index), strZipCode, intArea)
                        End If
                    End If
                End If
                '都抓不到ZipCode
                If strZipCode = MsgText(601) Then
                    'Modify by Amy 2024/06/24 +SSTab1/2 存檔後修改先切畫面,才看的到資料輸什麼
                    'Modify by Amy 2024/08/29 +Me.Name
                    If CheckTaiwanAddr_Tai(Me.Text1(Index), Text1(119 + (Index - 11) / 16), "000", "", strZipCode, , False, Me.Name, , intTW, SSTab1, SSTab2, Me.Name) = False Then
                        'Modify by Amy 2024/08/29 連續收不設地址變數=10,若為台灣改設3 原:intTWAddr(((Index - 26) / 16) * 2 + 1) = 10
                        If intTWAddr(((Index - 11) / 16) * 2) = 0 Or (intTWAddr(((Index - 11) / 16) * 2) = 3 And Left(strOldAddr(((Index - 11) / 16) * 2), 5) <> Left(Me.Text1(Index), 5)) Then
                            Call ChkZipData(9, Me.Text1(Index), strZipCode) 'Add by Amy 2024/06/24 存檔後修改, 切到相對畫面才能看到資料
                            If MsgBox("無法依地址帶出申請人" & (Index - 11) / 16 & " [申請地址]" & "的郵遞區號" & vbCrLf & "請問是臺灣地址嗎？", vbYesNo + vbCritical) = vbYes Then
                                intTWAddr(((Index - 11) / 16) * 2) = 1
                                If strZipCode = "格式錯誤" Then
                                    frm100135.Show vbModal
                                    Call ChkZipData(9, Me.Text1(Index), strZipCode)
                                Else
                                    Call ChkZipData(3, Me.Text1(Index), strZipCode)
                                End If
                                Exit Sub
                             Else
                                '非臺灣
                                 intTWAddr(((Index - 11) / 16) * 2) = 99
                                 Exit Sub
                             End If
                        ElseIf intTWAddr(((Index - 11) / 16) * 2) = 1 Then
                            '避免無法按zip鈕故此不判斷
                        End If
                    End If
                    
                End If
            '第三3個字無 縣 / 市
            Else
                '傳入地址前2個字判斷是否有其縣/市
                strCityN = "Pzd02"
                strZipCode = GetPostZip(Left(strAddr, 2), 3, 1, , bolMany, "Pzd02", strCityN)
                If strZipCode <> MsgText(601) Then
                    If bolMany = False Then
                        '只有一筆
                        Me.Text1(Index) = strROC & strCityN & strIndArea & Mid(strAddr, 3)
                        GoTo AgainCheck2
                    Else
                        '新竹、嘉義會有2筆
                        intArea = 0
                        Call ChkZipData(5, Me.Text1(Index), strZipCode, intArea)
                    End If
                '查無郵遞區號
                Else
                    'Modify by Amy 2024/08/29 連續收不設地址變數=10,若為台灣改設3 原:intTWAddr(((Index - 26) / 16) * 2 + 1) = 10
                    If intTWAddr(((Index - 11) / 16) * 2) = 0 Or (intTWAddr(((Index - 11) / 16) * 2) = 3 And Left(strOldAddr(((Index - 11) / 16) * 2), 5) <> Left(Me.Text1(Index), 5)) Then
                        Call ChkZipData(9, Me.Text1(Index), strZipCode) 'Add by Amy 2024/06/24 存檔後修改, 切到相對畫面才能看到資料
                        If MsgBox("無法依地址帶出申請人" & (Index - 11) / 16 & " [申請地址]" & "的郵遞區號" & vbCrLf & "請問是臺灣地址嗎？", vbYesNo + vbCritical) = vbYes Then
                            intTWAddr(((Index - 11) / 16) * 2) = 1
                            frm100135.Show vbModal
                            If Text1(Index).Enabled = True And Me.Visible = True Then Me.Text1(Index).SetFocus
                            Exit Sub
                        Else
                            '非臺灣
                            intTWAddr(((Index - 11) / 16) * 2) = 99
                            Exit Sub
                        End If
                    End If
                
                End If
            End If
        End If
        Text1(Index).Tag = Text1(Index) 'Add by Amy 2024/06/24
        
    'end 2015/11/02
    Case 101 '費用, 104, 107, 110
        If Me.Combo1((Index - 101) / 3 + 1).Text <> "" Then
            If Me.Text1(Index).Text = "" Then Me.Text1(Index).Text = "0"
            'edit by nickc 2005/03/02 控制小數點
            Me.Text1(Index + 2).Text = Format((CDbl(Val(Me.Text1(Index).Text)) - CDbl(Val(Me.Text1(Index + 1).Text))) / 1000, "####0.000")
            Call Check613612 'Add By Sindy 2012/8/31
            'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅
            If strSrvDate(1) >= strACSdate1 Then
               'Modify By Sindy 2022/8/31
               'Call SetACSautoFee(IIf(Index = 101, 1, IIf(Index = 104, 2, IIf(Index = 107, 3, 4))))
               Call SetACSautoFee(1)
            End If
            'end 2021/03/29
        Else
            Me.Text1(Index).Text = ""
            Me.Text1(Index + 1).Text = ""
            Me.Text1(Index + 2).Text = ""
        End If
    Case 102 '規費, 105, 108, 111
        If Me.Combo1((Index - 102) / 3 + 1).Text <> "" Then
            If Me.Text1(Index).Text = "" Then Me.Text1(Index).Text = "0"
            'edit by nickc 2005/03/02 控制小數點
            Me.Text1(Index + 1).Text = Format((CDbl(Val(Me.Text1(Index - 1).Text)) - CDbl(Val(Me.Text1(Index).Text))) / 1000, "####0.000")
            Call Check613612 'Add By Sindy 2012/8/31
        Else
            Me.Text1(Index - 1).Text = ""
            Me.Text1(Index).Text = ""
            Me.Text1(Index + 1).Text = ""
        End If
    Case 103 '點數, 106, 109, 112
        Text1(Index - 1).Tag = Text1(Index - 1) 'Add by Morgan 2011/3/7
        If Me.Combo1((Index - 103) / 3 + 1).Text <> "" Then
            If Me.Text1(Index).Text = "" Then Me.Text1(Index).Text = "0"
            'edit by nickc 2005/03/02 控制小數點
            'Modify By Sindy 2025/11/11 + Val()
            Me.Text1(Index - 1).Text = Val(CDbl(Val(Me.Text1(Index - 2).Text))) - Val(CDbl(Val(Me.Text1(Index).Text) * 1000))
            '2025/11/11 END
            Call Check613612 'Add By Sindy 2012/8/31
        Else
            Me.Text1(Index - 2).Text = ""
            Me.Text1(Index - 1).Text = ""
            Me.Text1(Index).Text = ""
        End If
        
         If Text1(Index - 1) <> Text1(Index - 1).Tag Then 'Add by Morgan 2011/3/7 規費有變才做,否則會重複提醒
            '2010/11/19 add by sonia 重新檢查規費
            Text1_Validate Index - 1, blnCancel
            If blnCancel = True Then
               If Me.Text1(Index - 1).Enabled = True Then Me.Text1(Index - 1).SetFocus
            End If
            '2010/11/19 end
         End If
    End Select
End Sub

'Add By Sindy 2012/8/31 案件性質為613補充答辯或612補充理由時，若點數>=8時預設為會稿，反之預設為不會稿且鎖住欄位
'Modify By Sindy 2013/3/12 改為點數>=5時預設為會稿，反之預設為不會稿且鎖住欄位
Private Sub Check613612()
Dim ii As Integer

   'Modified by Lydia 2018/12/10 判斷會稿才預設
   'If Frame21.Visible = True Then
   If Frame21.Visible = True And Frame23.Visible = True Then
      OptEP34(0).Enabled = True
      OptEP34(1).Enabled = True
      'Added by Lydia 2022/07/15 TC案之文件齊備日管控; T大陸案之齊備日管控
      If Trim(Text1(6)) = "TC" Then
          '台灣TC案不會稿(不顯示),但大陸TC案要會稿 => setFrame21有設定
      Else
      'end 2022/07/15
        If Trim(Left(Trim(Combo1(1)), 4)) = "613" Or Trim(Left(Trim(Combo1(1)), 4)) = "612" Then
           If Text1(103) >= 5 Then
              OptEP34(0).Value = True '會稿
           Else
              OptEP34(1).Value = True '不會稿
              OptEP34(0).Enabled = False
              OptEP34(1).Enabled = False
           End If
        Else
            For ii = 1 To GridCase.Rows - 1
                If Trim(GridCase.TextMatrix(ii, 1)) <> "" Then
                   If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "613" Or Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "612" Then
                      If Val(Trim(GridCase.TextMatrix(ii, 4))) >= 5 Then
                         OptEP34(0).Value = True '會稿
                      Else
                         OptEP34(1).Value = True '不會稿
                         OptEP34(0).Enabled = False
                         OptEP34(1).Enabled = False
                      End If
                      Exit For
                   End If
                Else
                   Exit For
                End If
            Next ii
        End If
        'Modify By Sindy 2022/8/29 Mark
'        If Trim(Left(Trim(Combo1(2)), 4)) = "613" Or Trim(Left(Trim(Combo1(2)), 4)) = "612" Then
'           If Text1(106) >= 5 Then
'              OptEP34(0).Value = True '會稿
'           Else
'              OptEP34(1).Value = True '不會稿
'              OptEP34(0).Enabled = False
'              OptEP34(1).Enabled = False
'           End If
'        End If
'        If Trim(Left(Trim(Combo1(3)), 4)) = "613" Or Trim(Left(Trim(Combo1(3)), 4)) = "612" Then
'           If Text1(109) >= 5 Then
'              OptEP34(0).Value = True '會稿
'           Else
'              OptEP34(1).Value = True '不會稿
'              OptEP34(0).Enabled = False
'              OptEP34(1).Enabled = False
'           End If
'        End If
'        If Trim(Left(Trim(Combo1(4)), 4)) = "613" Or Trim(Left(Trim(Combo1(4)), 4)) = "612" Then
'           If Text1(112) >= 5 Then
'              OptEP34(0).Value = True '會稿
'           Else
'              OptEP34(1).Value = True '不會稿
'              OptEP34(0).Enabled = False
'              OptEP34(1).Enabled = False
'           End If
'        End If
      End If 'Added by Lydia 2022/07/15
   End If
End Sub

'Add By Sindy 2011/11/11
Private Sub SetFrame16()
Dim bolNewCase As Boolean
   
   m_strCaseCPM = GetAllCaseCPM(bolNewCase) 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   'CFP且非英語系國家且為新申請案案件性質時,開放Frame16欄位
   Frame16.Visible = False
   If Text1(6) = "CFP" And m_NA59 = "N" And ( _
      (InStr(NewCasePtyList, Trim(Left(Trim(Combo1(1)), 4))) > 0 And Trim(Left(Trim(Combo1(1)), 4)) <> "") Or _
      bolNewCase = True _
      ) Then
'      Or _
'      (InStr(NewCasePtyList, Trim(Left(Trim(Combo1(2)), 4))) > 0 And Trim(Left(Trim(Combo1(2)), 4)) <> "") Or _
'      (InStr(NewCasePtyList, Trim(Left(Trim(Combo1(3)), 4))) > 0 And Trim(Left(Trim(Combo1(3)), 4)) <> "") Or _
'      (InStr(NewCasePtyList, Trim(Left(Trim(Combo1(4)), 4))) > 0 And Trim(Left(Trim(Combo1(4)), 4)) <> "")
      Frame16.Visible = True
      '但若已收938超頁費,939超項費,則不顯示Frame16欄位
'      If Trim(Left(Trim(Combo1(1)), 4)) = "938" Or _
'         Trim(Left(Trim(Combo1(2)), 4)) = "938" Or _
'         Trim(Left(Trim(Combo1(3)), 4)) = "938" Or _
'         Trim(Left(Trim(Combo1(4)), 4)) = "938" Or _
'         Trim(Left(Trim(Combo1(1)), 4)) = "939" Or _
'         Trim(Left(Trim(Combo1(2)), 4)) = "939" Or _
'         Trim(Left(Trim(Combo1(3)), 4)) = "939" Or _
'         Trim(Left(Trim(Combo1(4)), 4)) = "939" Then
      If InStr(m_strCaseCPM, "938") > 0 Or Trim(Left(Trim(Combo1(1)), 4)) = "938" _
         Or InStr(m_strCaseCPM, "939") > 0 Or Trim(Left(Trim(Combo1(1)), 4)) = "939" Then
         Frame16.Visible = False
      End If
   Else
      Option3(0).Value = False
      Option3(1).Value = False
   End If
End Sub

'Add By Sindy 2013/2/25
Private Sub SetFrame27()
   
   'm_strCaseCPM = GetAllCaseCPM() 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   '填寫CFT移轉案之接洽記錄單時，不管新舊案一定要勾選才可列印接洽單
   Frame27.Visible = False
   If Text1(6) = "CFT" And ( _
      (InStr("501", Trim(Left(Trim(Combo1(1)), 4))) > 0 And Trim(Left(Trim(Combo1(1)), 4)) <> "") Or _
      (InStr(m_strCaseCPM, "501") > 0 And m_strCaseCPM <> "") _
      ) Then
'      Or _
'      (InStr("501", Trim(Left(Trim(Combo1(2)), 4))) > 0 And Trim(Left(Trim(Combo1(2)), 4)) <> "") Or _
'      (InStr("501", Trim(Left(Trim(Combo1(3)), 4))) > 0 And Trim(Left(Trim(Combo1(3)), 4)) <> "") Or _
'      (InStr("501", Trim(Left(Trim(Combo1(4)), 4))) > 0 And Trim(Left(Trim(Combo1(4)), 4)) <> "")
      Frame27.Visible = True
   Else
      Option8(0).Value = False
      Option8(1).Value = False
   End If
End Sub

'Add By Sindy 2014/2/19 顯示審定號欄位
Private Sub SetFrame29()
   
   'm_strCaseCPM = GetAllCaseCPM() 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   Text1(132).Visible = False: Label1(23).Visible = False 'Add by Amy 2016/09/01
   Frame29.Visible = False
   '當102延展新案商標不論申請國家，均要輸入審定號
   If (Text1(6) = "T" Or Text1(6) = "TF" Or Text1(6) = "CFT") And _
      (Trim(Left(Trim(Combo1(1)), 4)) = "102" Or InStr(m_strCaseCPM, "102") > 0) And _
      Option1(0).Value = True Then
'      (Trim(Left(Trim(Combo1(1)), 4)) = "102" Or Trim(Left(Trim(Combo1(2)), 4)) = "102" Or _
'       Trim(Left(Trim(Combo1(3)), 4)) = "102" Or Trim(Left(Trim(Combo1(4)), 4)) = "102") And
      Frame29.Visible = True
   'Add by Amy 2016/09/01 當601異議/603評定/605廢止新案商標案，開放輸入審定號及申請案號
   ElseIf (Text1(6).Text = "CFT" Or Text1(6).Text = "T" Or Text1(6).Text = "FCT" Or Text1(6).Text = "TF") And _
      (Trim(Left(Combo1(1).Text, 4)) <> "101" And InStr(m_strCaseCPM, "101") = 0) And _
      (Trim(Left(Combo1(1).Text, 4)) = "601" Or Trim(Left(Combo1(1).Text, 4)) = "603" Or Trim(Left(Combo1(1).Text, 4)) = "605" Or _
       InStr(m_strCaseCPM, "601") > 0 Or InStr(m_strCaseCPM, "603") > 0 Or InStr(m_strCaseCPM, "605") > 0 _
      ) Then
'      ((Trim(Left(Combo1(1).Text, 4)) <> "101" And Trim(Left(Combo1(2).Text, 4)) <> "101" And Trim(Left(Combo1(3).Text, 4)) <> "101" And Trim(Left(Combo1(4).Text, 4)) <> "101") And _
'       (Trim(Left(Combo1(1).Text, 4)) = "601" Or Trim(Left(Combo1(2).Text, 4)) = "601" Or Trim(Left(Combo1(3).Text, 4)) = "601" Or Trim(Left(Combo1(4).Text, 4)) = "601") Or _
'       (Trim(Left(Combo1(1).Text, 4)) = "603" Or Trim(Left(Combo1(2).Text, 4)) = "603" Or Trim(Left(Combo1(3).Text, 4)) = "603" Or Trim(Left(Combo1(4).Text, 4)) = "603") Or _
'       (Trim(Left(Combo1(1).Text, 4)) = "605" Or Trim(Left(Combo1(2).Text, 4)) = "605" Or Trim(Left(Combo1(3).Text, 4)) = "605" Or Trim(Left(Combo1(4).Text, 4)) = "605")
      Text1(132).Visible = True: Label1(23).Visible = True
      Frame29.Visible = True
   'Added by Lydia 2020/12/11 CFT英國脫歐案管制：英國(201) CFT委任代理人710之新案接洽單
   ElseIf Option1(0).Value = True And Text1(6) = "CFT" And Trim(Left(Combo1(0), 4)) = "201" And _
      (Trim(Left(Trim(Combo1(1)), 4)) = "710" Or InStr(m_strCaseCPM, "710") > 0) Then
'      (Trim(Left(Trim(Combo1(1)), 4)) = "710" Or Trim(Left(Trim(Combo1(2)), 4)) = "710" Or _
'       Trim(Left(Trim(Combo1(3)), 4)) = "710" Or Trim(Left(Trim(Combo1(4)), 4)) = "710")
      Frame29.Visible = True
   'Add By Sindy 2023/3/21 商標的新案除了申請之外，開放輸入審定號或申請案號
   ElseIf (Text1(6) = "T" Or Text1(6) = "TF" Or Text1(6) = "CFT") And _
      (Trim(Left(Trim(Combo1(1)), 4)) <> "101" And InStr(m_strCaseCPM, "101") = 0) And _
      Option1(0).Value = True Then
      Text1(132).Visible = True: Label1(23).Visible = True
      Frame29.Visible = True
   End If
End Sub

'Add By Sindy 2012/3/6
Private Sub SetFrame20()
Dim bolNewCase As Boolean
   
   m_strCaseCPM = GetAllCaseCPM(bolNewCase) 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   'Modified by Lydia 2016/09/22
   ''台灣商標T並且案件性質為申請時,開放Frame20欄位
   '商標案並且案件性質為申請時,開放Frame20欄位
   Frame20.Visible = False
   Option6(4).Visible = False  'Added by Lydia 2016/09/22
   
   If (Text1(6) = "T" Or Text1(6) = "CFT" Or Text1(6) = "TF") And ( _
      (Trim(Left(Trim(Combo1(1)), 4)) = "101" And Trim(Left(Trim(Combo1(1)), 4)) <> "") Or _
      bolNewCase = True _
      ) Then
'      Or _
'      (Trim(Left(Trim(Combo1(2)), 4)) = "101" And Trim(Left(Trim(Combo1(2)), 4)) <> "") Or _
'      (Trim(Left(Trim(Combo1(3)), 4)) = "101" And Trim(Left(Trim(Combo1(3)), 4)) <> "") Or _
'      (Trim(Left(Trim(Combo1(4)), 4)) = "101" And Trim(Left(Trim(Combo1(4)), 4)) <> "")
      Frame20.Visible = True
      'Added by Lydia 2016/09/22 非台灣T,TF才有不查名
      If Trim(Left(Combo1(0).Text, 4)) <> "000" And Combo1(0).Text <> "" And (Text1(6) = "T" Or Text1(6) = "TF") Then
         Option6(4).Visible = True
      End If
   Else
      Option6(0).Value = False
      Option6(1).Value = False
      Option6(2).Value = False
      Option6(3).Value = False
      Option6(4).Value = False 'Added by Lydia 2016/09/22
      Option6(5).Value = False 'Added by Lydia 2018/11/13
   End If
End Sub

'Add By Sindy 2012/5/8
Private Sub setFrame21()
Dim intP As Integer 'Added by Lydia 2019/11/05
Dim bolNewCase As Boolean, bolTMdebate As Boolean
   
   m_strCaseCPM = GetAllCaseCPM(bolNewCase, bolTMdebate) 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   'Add By Sindy 2022/10/14 LA顧問案之0顧問聘任,ACS案之112智財顧問
   Label1(140).Visible = False: Text1(139).Visible = False: Text1(140).Visible = False
   If (Text1(6) = "LA" And (m_strCaseCPM = "0" Or Trim(Left(Trim(Combo1(1)), 2)) = "0")) Or _
      (Text1(6) = "ACS" And (InStr(m_strCaseCPM, "112") > 0 Or Trim(Left(Trim(Combo1(1)), 4)) = "112")) Then
       Label1(140).Visible = True: Text1(139).Visible = True: Text1(140).Visible = True
   End If
   '2022/10/14 END
   
   'Added by Lydia 2018/12/10 非專利案隱藏 申請優先權證明書 和 申請技術報告項數
   Label1(88).Visible = False: Text1(4).Visible = False
   Label1(125).Visible = False: Text1(114).Visible = False
   If Text1(6) = "P" Or Text1(6) = "CFP" Then
      'Modify By Sindy 2023/1/18
      If InStr(m_strCaseCPM, "405") > 0 Then '405.申請優先權證明書
      '2023/1/18 END
         Label1(88).Visible = True: Text1(4).Visible = True
      'Modify By Sindy 2023/1/18 421申請技術報告
      'Modify By Sindy 2023/5/12 + 807 第三人申請技術報告
      ElseIf InStr(m_strCaseCPM, "421") > 0 Or _
             InStr(m_strCaseCPM, "807") > 0 Then
      '2023/1/18 END
         Label1(125).Visible = True: Text1(114).Visible = True
      End If
'   Else
'       Label1(88).Visible = False: Text1(4).Visible = False
'       Label1(125).Visible = False: Text1(114).Visible = False
   End If
   
   Frame23.Visible = True  '預設會稿顯示
   Frame42.Visible = False  '查名是否齊備
   Frame43.Visible = True  '預設延期顯示
   Label23.Caption = "資料是否齊備："
   'Modified by Lydia 2020/02/05 判斷完整本所案號; ex.T-222561延期自動收文,但是文件齊備預設為N
   'If Text1(6).Text <> Text1(6).Tag Then '預設清空
   If Text1(6).Text & Text1(7).Text & Text1(8).Text & Text1(9).Text <> Text1(6).Tag & Text1(7).Tag & Text1(8).Tag & Text1(9).Tag Then
        OptEP06(0).Value = False: OptEP06(1).Value = False
        OptEP34(0).Value = False: OptEP34(1).Value = False
'        OptCP122(0).Value = False: OptCP122(1).Value = False
        OptCP143(0).Value = False: OptCP143(1).Value = False
   End If
   'end 2018/12/10
   
   If Val(strSrvDate(1)) >= Val(TMdebateStarDT) Then
      '台灣商標Ｔ案若收文爭議案件性質時,開放Frame21欄位
      Frame21.Visible = False
      'Modified by Lydia 2022/07/15 T大陸案之齊備日管控
      'If Text1(6) = "T" And Left(Trim(Combo1(0)), 3) = "000" And ( _
         (InStr(TMdebate, Trim(Left(Trim(Combo1(1)), 4))) > 0 And Trim(Left(Trim(Combo1(1)), 4)) <> "") Or _
         (InStr(TMdebate, Trim(Left(Trim(Combo1(2)), 4))) > 0 And Trim(Left(Trim(Combo1(2)), 4)) <> "") Or _
         (InStr(TMdebate, Trim(Left(Trim(Combo1(3)), 4))) > 0 And Trim(Left(Trim(Combo1(3)), 4)) <> "") Or _
         (InStr(TMdebate, Trim(Left(Trim(Combo1(4)), 4))) > 0 And Trim(Left(Trim(Combo1(4)), 4)) <> "") _
         ) Then
      If Text1(6) = "T" And InStr("000,020", Left(Trim(Combo1(0)), 3)) > 0 And ( _
         (InStr(TMdebate, Trim(Left(Trim(Combo1(1)), 4))) > 0 And Trim(Left(Trim(Combo1(1)), 4)) <> "") Or _
         bolTMdebate = True _
         ) Then
'         Or _
'         (InStr(TMdebate, Trim(Left(Trim(Combo1(2)), 4))) > 0 And Trim(Left(Trim(Combo1(2)), 4)) <> "") Or _
'         (InStr(TMdebate, Trim(Left(Trim(Combo1(3)), 4))) > 0 And Trim(Left(Trim(Combo1(3)), 4)) <> "") Or _
'         (InStr(TMdebate, Trim(Left(Trim(Combo1(4)), 4))) > 0 And Trim(Left(Trim(Combo1(4)), 4)) <> "")
         Frame21.Visible = True
         '案件性質為613補充答辯或612補充理由時，則只可不會稿
'         If Trim(Left(Trim(Combo1(1)), 4)) = "613" Or _
'            Trim(Left(Trim(Combo1(2)), 4)) = "613" Or _
'            Trim(Left(Trim(Combo1(3)), 4)) = "613" Or _
'            Trim(Left(Trim(Combo1(4)), 4)) = "613" Or _
'            Trim(Left(Trim(Combo1(1)), 4)) = "612" Or _
'            Trim(Left(Trim(Combo1(2)), 4)) = "612" Or _
'            Trim(Left(Trim(Combo1(3)), 4)) = "612" Or _
'            Trim(Left(Trim(Combo1(4)), 4)) = "612" Then
         If Trim(Left(Trim(Combo1(1)), 4)) = "613" Or Trim(Left(Trim(Combo1(1)), 4)) = "612" Or _
            InStr(m_strCaseCPM, "613") > 0 Or InStr(m_strCaseCPM, "612") > 0 Then
            OptEP34(1).Value = True
         End If
      'Added by Lydia 2018/12/10 T台灣案填寫接洽單管控文件及查名是否齊備
      'Modified by Lydia 2022/07/15 T大陸案之齊備日管控
      'ElseIf Text1(6) = "T" And Left(Trim(Combo1(0)), 3) = "000" Then
      ElseIf Text1(6) = "T" Then
            Frame21.Visible = True
            Frame43.Visible = False '非商爭案，無延期
            Label23.Caption = "文件是否齊備："  '原本是「資料是否齊備」
'            OptCP122(1).Value = True '急件：預設N
            '查名限101申請
            Frame23.Visible = False
            'If InStr(Trim(Left(Combo1(1).Text, 4)) & "," & Trim(Left(Combo1(2).Text, 4)) & "," & Trim(Left(Combo1(3).Text, 4)) & "," & Trim(Left(Combo1(4).Text, 4)), "101") > 0 Then
            If InStr(Trim(Left(Combo1(1).Text, 4)), "101") > 0 Or InStr(m_strCaseCPM, "101") Then
               Frame42.Visible = True '查名是否齊備
            End If
      'end 2018/12/10
      'Mark by Lydia 2020/02/05 前面以本所案號判斷是否清空
      'Else
      '   '預設清空
      '   OptEP06(0).Value = False: OptEP06(1).Value = False
      '   OptEP34(0).Value = False: OptEP34(1).Value = False
      '   OptCP122(0).Value = False: OptCP122(1).Value = False
      '   OptCP143(0).Value = False: OptCP143(1).Value = False
      'end 2020/02/05
      'Added by Lydia 2022/07/15 TC案之文件齊備日管控
      ElseIf Text1(6) = "TC" Then
            Frame21.Visible = True
            Frame43.Visible = False '非商爭案，無延期
            Label23.Caption = "文件是否齊備："  '原本是「資料是否齊備」
'            OptCP122(1).Value = True '急件：預設N
            Frame23.Visible = False   '會稿：不顯示
'            Frame24.Visible = False   '急件：不顯示
            If Left(Trim(Combo1(0)), 3) <> "000" Then '台灣TC案不會稿
               Frame23.Visible = True   '會稿：顯示
            End If
      'end 2022/07/15
      End If
     
      'Added by Lydia 2019/11/05 特定申請人會稿案件: 業務收文新申請案(發明、實用新型、外觀設計)，且申請國為中國大陸時，希望能於收文時跳出【請確認此申請人之中國大陸案是否要會稿】
      Frame45.Visible = False
      'P新案,申請國為大陸
      If Option1(0).Value = True And Text1(6).Text = "P" And Trim(Left(Combo1(0), 4)) = "020" Then
'           For intP = 1 To 4
'              If Trim(Left(Trim(Combo1(1)), 4)) <> "" And InStr(NewCasePtyList, Trim(Left(Trim(Combo1(1)), 4))) > 0 Then
              If bolNewCase = True Then
                  Frame45.Visible = True
                  Opt45(0).Value = False: Opt45(1).Value = False  'Added by Lydia 2020/02/26
              End If
'           Next intP
      End If
      
   End If
End Sub

'Add By Sindy 2022/12/24
Private Sub SetFrame28()
Dim arrText As Variant, intCnt As Integer
Dim arrCF209() As String

   'm_strCaseCPM = GetAllCaseCPM()
   chkEnglish.Visible = False
   Frame28.Visible = False
   OptEntity(0).Enabled = False
   OptEntity(1).Enabled = False
   OptEntity(2).Enabled = False
   If Me.Combo1(1).Text <> "" Then
      m_strCaseCPM = m_strCaseCPM & IIf(m_strCaseCPM <> "", ",", "") & Trim(Left(Combo1(1).Text, 4))
   End If
   'CFP美國,P大陸以外之各國身份種類(frm090801之Frame28)
   'CFP美國案用現有檢查
   'P大陸案Frame28改放(1)無(2)台灣專利說明書
   If Text1(6).Text <> "" And Trim(Combo1(0)) <> "" And ((Option1(0).Value = True And m_strCaseCPM <> "") Or Option1(1).Value = True) Then
      If m_strCaseCPM = "" Then m_strCaseCPM = " "
      arrText = Split(m_strCaseCPM, ",")
'      strSql = "select distinct cf205,cf209 from casefee2" & _
'               " where cf201='" & Text1(6).Text & "' and cf202='" & Left(Trim(Combo1(0)), 3) & "' and cf203='" & arrText(0) & "'" & _
'               " and cf210=(select max(cf210) from casefee2 where cf201='" & Text1(6).Text & "' and cf202='" & Left(Trim(Combo1(0)), 3) & "' and cf203='" & arrText(0) & "'" & _
'               " and cf210<=" & strSrvDate(1) & ")" & IIf(Text1(6).Text = "P" And Left(Trim(Combo1(0)), 3) = "020", "", " and cf209 is not null") & _
'               " order by cf205"
'      intI = 1
'      Set RsTemp = ClsLawReadRstMsg(intI, strSql)
'      If intI = 1 Then
      'Modify By Sindy 2025/3/10
      If Option1(1).Value = True And Text1(7).Text <> "" And m_strSys = "1" Then '專利資料
         If pa(179) <> "" Then '有個體別(Cassfee2不是全部案件性質都有設定,若傳入案件性質反而抓不到身份種類)
            arrText(0) = ""
         End If
      End If
      '2025/3/10 END
      If Pub_GetCF209(Text1(6).Text, Left(Trim(Combo1(0)), 3), arrText(0), arrCF209) = True Then
         If Text1(6).Text = "P" And Left(Trim(Combo1(0)), 3) = "020" Then '大陸案
            Frame28.Visible = True
            OptEntity(0).Left = OptEntity(0).Tag
            OptEntity(0).Width = 2000
            OptEntity(0).Caption = arrCF209(0) '"無台灣專利說明書" Modify By Sindy 2025/2/3
            OptEntity(0).Visible = True
            OptEntity(0).Enabled = True
            OptEntity(1).Left = OptEntity(1).Tag + 1000
            OptEntity(1).Width = 2000
            OptEntity(1).Caption = arrCF209(1) '"有台灣專利說明書" Modify By Sindy 2025/2/3
            OptEntity(1).Visible = True
            OptEntity(1).Enabled = True
            OptEntity(2).Visible = False
         Else 'If "" & RsTemp.Fields("cf209") <> "" Then
            Frame28.Visible = True
            OptEntity(0).Left = OptEntity(0).Tag
            OptEntity(0).Width = 1100 '870
            OptEntity(0).Visible = False
            OptEntity(1).Left = OptEntity(1).Tag
            OptEntity(1).Width = 1315
            OptEntity(1).Visible = False
            OptEntity(2).Visible = False
            'OptEntity(2).Left = OptEntity(2).Tag
'            RsTemp.MoveFirst
'            intCnt = 0
'            Do While Not RsTemp.EOF
            For intCnt = 0 To 2
               'Add By Sindy 2023/3/22
               If arrCF209(intCnt) <> "" Then
               '2023/3/22 END
                  OptEntity(intCnt).Caption = arrCF209(intCnt) 'RsTemp.Fields("cf209")
                  OptEntity(intCnt).Visible = True
                  OptEntity(intCnt).Enabled = True
               End If
'               intCnt = intCnt + 1
'               RsTemp.MoveNext
'            Loop
            Next intCnt
         End If
      End If
      
      '同時申請三國(含)以上之美日德可多5點
      If Text1(6).Text = "CFP" Then
         If (Left(Trim(Combo1(0)), 3) = "011" Or Left(Trim(Combo1(0)), 3) = "101" Or Left(Trim(Combo1(0)), 3) = "231") And _
            InStr(CaseMapIn, arrText(0)) > 0 Then
            chkEnglish.Visible = True
         Else
            chkEnglish.Value = 0
         End If
      Else
         chkEnglish.Value = 0
      End If
   End If
End Sub

'Add By Sindy 2012/9/3 案件屬性
Private Sub SetCombo5()
   'Add By Sindy 2010/10/28
   Label1(168).Visible = False
   Combo5.Visible = False
   'Combo5.Text = "" 'Modify By Sindy 2023/4/28 Mark
   'Modify By Sindy 2012/9/3 專利種類為3.設計或4.積體電路時,不可填寫案件屬性; 案件性質103,105,117,125時,案件屬性欄清空並鎖住
   'Modify By Sindy 2014/7/14
'   If (Text1(6) = "P" Or Text1(6) = "CFP") And _
'      Trim(Left(Trim(Combo1(1)), 4)) <> "103" And _
'      Trim(Left(Trim(Combo1(2)), 4)) <> "103" And _
'      Trim(Left(Trim(Combo1(3)), 4)) <> "103" And _
'      Trim(Left(Trim(Combo1(4)), 4)) <> "103" And _
'      Trim(Left(Trim(Combo1(1)), 4)) <> "105" And _
'      Trim(Left(Trim(Combo1(2)), 4)) <> "105" And _
'      Trim(Left(Trim(Combo1(3)), 4)) <> "105" And _
'      Trim(Left(Trim(Combo1(4)), 4)) <> "105" And _
'      Trim(Left(Trim(Combo1(1)), 4)) <> "117" And _
'      Trim(Left(Trim(Combo1(2)), 4)) <> "117" And _
'      Trim(Left(Trim(Combo1(3)), 4)) <> "117" And _
'      Trim(Left(Trim(Combo1(4)), 4)) <> "117" And _
'      Trim(Left(Trim(Combo1(1)), 4)) <> "125" And _
'      Trim(Left(Trim(Combo1(2)), 4)) <> "125" And _
'      Trim(Left(Trim(Combo1(3)), 4)) <> "125" And _
'      Trim(Left(Trim(Combo1(4)), 4)) <> "125" And _
'      (Trim(Left(Trim(Combo6), 1)) <> "3" And Trim(Left(Trim(Combo6), 1)) <> "4") Then
   'Modify By Sindy 2023/5/11 專利種類只有4.積體電路,不需填寫案件屬性
   If (Text1(6) = "P" Or Text1(6) = "CFP") And _
      ((Option1(0).Value = True And Trim(Left(Trim(Combo6), 1)) <> "4") Or _
       (Option1(1).Value = True And m_strPA08 <> "4")) Then
   '2014/7/14 END
      Label1(168).Visible = True
      Combo5.Visible = True
      'Modified by Lydia 2021/06/18 debug:接洽單查詢及列印使用
      'If Combo5.Enabled = True Then Combo5.SetFocus  '2010/11/19 ADD BY SONIA
      If Combo5.Enabled = True And Me.Visible = True Then
         If Combo5.Enabled = True And Me.Visible = True Then Combo5.SetFocus
      End If
      'end 2021/06/18
   'Add By Sindy 2023/5/11
   Else
      Combo5.Text = ""
      '2023/5/11 END
   End If
End Sub

'Add By Sindy 2023/11/15 讀取商標種類的語法
Private Function GetCombo6_T_SQL(Optional p_Code As String) As String
Dim strCon As String
   
   strSql = ""
   If p_Code <> "" Then strCon = " and ptm02='" & p_Code & "'"
   'Modify By Sindy 2023/2/15
   'T台灣案
   If Text1(6) = "T" And Left(Combo1(0), 3) = "000" Then
      'Modify By Sindy 2023/11/15
      'strSql = "Select Ptm02,Ptm03 From Patenttrademarkmap Where Ptm01='2' AND (PTM02='1' OR PTM02>='7') order by ptm02 asc"
      strSql = "Select Ptm02,Ptm03 From Patenttrademarkmap Where Ptm01='2' AND (PTM02='1' OR PTM02>='7')" & strCon & _
               " union Select spt02,spt03 From SpecialPatenttrademark Where spt01='2'" & Replace(strCon, "ptm02", "spt02") & _
               " order by ptm02 asc"
      '2023/11/15 END
   'T大陸案
   ElseIf Text1(6) = "T" And Left(Combo1(0), 3) = "020" Then
      'Modify By Sindy 2023/11/15
      'strSql = "Select Ptm02,Ptm04 as Ptm03 From Patenttrademarkmap Where Ptm01='2' And (Ptm02='1' Or Ptm02>='7') and instr(ptm04,'（無）')=0 order by ptm02 asc"
      strSql = "select * from (" & _
               " Select Ptm02,Ptm04 as ptm03 From Patenttrademarkmap Where Ptm01='2' AND (PTM02='1' OR PTM02>='7')" & _
               " union Select spt02,spt04 From SpecialPatenttrademark Where spt01='2')" & _
               " where ptm03<>'（無）'" & strCon & _
               " order by ptm02 asc"
      '2023/11/15 END
   'TF
   Else
   '2023/2/15 END
      strSql = "select ptm02,ptm03 from patenttrademarkmap where ptm01='2' AND (PTM02='1' OR PTM02>='7')" & strCon & _
               " order by ptm02 asc"
   End If
   GetCombo6_T_SQL = strSql
End Function

'Add By Sindy 2012/6/6 商標,專利種類
Private Sub SetCombo6()
Dim strCombo6 As String, ii As Integer 'Add By Sindy 2023/4/28

   Label1(124).Visible = False
   Combo6.Visible = False
   Combo6.Enabled = False
   strCombo6 = Trim(Combo6.Text) 'Add By Sindy 2023/4/28
   Combo6.Clear
   'Add By Sindy 2012/4/26
   'CFT維持不顯示商標種類欄
   If (Text1(6) = "T" Or Text1(6) = "TF") And Option1(0).Value = True Then
      Label1(124).Visible = True
      Label1(124).Caption = "商標種類:"
      Combo6.Visible = True
      Combo6.Enabled = True
      strSql = GetCombo6_T_SQL 'Modify By Sindy 2023/11/15
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strSql)
      If intI = 1 Then
         RsTemp.MoveFirst
         Do While Not RsTemp.EOF
            Combo6.AddItem RsTemp.Fields("ptm02") & "." & RsTemp.Fields("ptm03")
            RsTemp.MoveNext
         Loop
      End If
'      Combo6.AddItem "1.商標"
'      Combo6.AddItem "7.證明標章"
'      Combo6.AddItem "8.團體標章"
'      Combo6.AddItem "9.團體商標"
   End If
   '2012/4/26 End
   'Add By Sindy 2012/6/6
   'If (Text1(6) = "P" Or Text1(6) = "CFP") And Option1(0).Value = True Then
   If (Text1(6) = "P" Or Text1(6) = "CFP") Then
      Label1(124).Visible = True
      Label1(124).Caption = "專利種類:"
      'Modify By Sindy 2014/7/14
      If Option1(0).Value = True Then
         Combo6.Visible = True
         Combo6.Enabled = True
      Else
         Combo6.Visible = True
         Combo6.Enabled = False
      End If
      '2014/7/14 END
      strSql = "select ptm02,ptm03 from patenttrademarkmap where ptm01='1' and ptm02 in('1','2','3') order by ptm02 asc"
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strSql)
      If intI = 1 Then
         RsTemp.MoveFirst
         Do While Not RsTemp.EOF
            Combo6.AddItem RsTemp.Fields("ptm02") & "." & RsTemp.Fields("ptm03")
            RsTemp.MoveNext
         Loop
      End If
'      Combo6.AddItem "1.發明"
'      Combo6.AddItem "2.新型"
'      Combo6.AddItem "3.設計"
      Combo6.AddItem "4.積體電路"
   End If
   '2012/6/6 End
   
   'Add By Sindy 2023/4/28
   If strCombo6 <> "" Then
      For ii = 0 To Combo6.ListCount - 1
         If Combo6.List(ii) = strCombo6 Then
            Combo6.ListIndex = ii
            Exit For
         End If
      Next ii
   End If
   '2023/4/28 END
End Sub

'Add By Sindy 2012/8/17
Private Sub SetFrame25()
   
   'm_strCaseCPM = GetAllCaseCPM() 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   Frame25.Visible = False
   '當P,CFP案收文,主張新穎性優惠期時,下列欄位必須顯示出來
   If (Text1(6) = "P" Or Text1(6) = "CFP") And ( _
      (Trim(Left(Trim(Combo1(1)), 4)) = "123" And Trim(Left(Trim(Combo1(1)), 4)) <> "") Or _
      (InStr(m_strCaseCPM, "123") > 0 And m_strCaseCPM <> "") _
      ) Then
'      Or _
'      (Trim(Left(Trim(Combo1(2)), 4)) = "123" And Trim(Left(Trim(Combo1(2)), 4)) <> "") Or _
'      (Trim(Left(Trim(Combo1(3)), 4)) = "123" And Trim(Left(Trim(Combo1(3)), 4)) <> "") Or _
'      (Trim(Left(Trim(Combo1(4)), 4)) = "123" And Trim(Left(Trim(Combo1(4)), 4)) <> "")
      Frame25.Visible = True
   End If
End Sub

'Add By Sindy 2022/12/5 證書形式
Private Sub SetCRL59()
Dim ii As Integer
Dim varTmp As Variant
   
   m_strCaseCPM = GetAllCaseCPM() '取得案件性質代碼
   
   Label1(141).Visible = False
   Text1(145).Visible = False
   Label28(1).Visible = False
   '台灣T案717.註冊費,P案領證收文,下列欄位必須顯示出來
   If Left(Trim(Combo1(0)), 3) = "000" Then
'      If (Text1(6) = "P" And _
'         ((Trim(Left(Trim(Combo1(1)), 4)) = 領證及繳年費 And Trim(Left(Trim(Combo1(1)), 4)) <> "") Or _
'          (InStr(m_strCaseCPM, 領證及繳年費) > 0 And m_strCaseCPM <> ""))) _
'         Or _
'         (Text1(6) = "T" And _
'         ((Trim(Left(Trim(Combo1(1)), 4)) = "717" And Trim(Left(Trim(Combo1(1)), 4)) <> "") Or _
'          (InStr(m_strCaseCPM, "717") > 0 And m_strCaseCPM <> ""))) Then
'         Label1(141).Visible = True
'         Text1(145).Visible = True
'         Label28(1).Visible = True
'      End If
      If Trim(Left(Trim(Combo1(1)), 4)) <> "" Then
         If PUB_TWCertPty(Text1(6), Trim(Left(Trim(Combo1(1)), 4)), Text1(7), Text1(8), Text1(9)) = True Then
            Label1(141).Visible = True
            Text1(145).Visible = True
            Label28(1).Visible = True
            Exit Sub
         End If
      End If
      varTmp = Split(m_strCaseCPM, ",")
      For ii = LBound(varTmp) To UBound(varTmp)
         If PUB_TWCertPty(Text1(6), CStr(varTmp(ii)), Text1(7), Text1(8), Text1(9)) = True Then
            Label1(141).Visible = True
            Text1(145).Visible = True
            Label28(1).Visible = True
            Exit Sub
         End If
      Next ii
   End If
End Sub

'Add By Sindy 2022/12/16 系統別,申請國家,案件性質的欄位變化
Private Sub SetFrameChg()
   
   'm_strCaseCPM = GetAllCaseCPM() '取得案件性質代碼
   
   'Modified by Lydia 2016/04/25 顯示判斷 + TS案
   'Modified by Lydia 2021/11/23 因為T案增加737智財協作,調整判斷
   'strExc(1) = IIf(Trim(Left(Trim(Combo1(1)), 4)) <> "", Trim(Left(Trim(Combo1(1)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(2)), 4)) <> "", Trim(Left(Trim(Combo1(2)), 4)), "") & _
          "," & IIf(Trim(Left(Trim(Combo1(3)), 4)) <> "", Trim(Left(Trim(Combo1(3)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(4)), 4)) <> "", Trim(Left(Trim(Combo1(4)), 4)), "")
   'If strSrvDate(1) >= TMQ電子化啟用日 And Left(Trim(Combo1(0)), 3) = "000" And Option1(0).Value = True And ((Text1(6).Text = "T" And Text1(7) & Text1(8) = "" And InStr(strExc(1), TMQ_T案) > 0) _
       Or (Text1(6).Text = "TS" And Text1(7) & Text1(8) = "" And InStr(strExc(1), TMQ_TS案) > 0)) Then
   If GetTMQArea = True Then
   'end 2021/11/23
      FRTMQ.Visible = True
   Else
      FRTMQ.Visible = False
      'Added by Lydia 2024/03/14 人員先輸入T台灣案直接改畫面輸入T大陸案 >> 沒有清除查名流水號
      TMQList = ""
      mTQC01 = ""
      'end 2024/03/14
   End If
'end 2015/10/14
   'Added by Lydia 2021/02/24 大陸商標申請案及CFT申請案，均強迫填入相關資訊。
   Frame47.Visible = False
   'Added by Lydia 2022/04/28 debug: 補上抓所有案件性質
'           strExc(1) = IIf(Trim(Left(Trim(Combo1(1)), 4)) <> "", Trim(Left(Trim(Combo1(1)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(2)), 4)) <> "", Trim(Left(Trim(Combo1(2)), 4)), "") & _
'                  "," & IIf(Trim(Left(Trim(Combo1(3)), 4)) <> "", Trim(Left(Trim(Combo1(3)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(4)), 4)) <> "", Trim(Left(Trim(Combo1(4)), 4)), "")
   'end 2022/04/28
   If (Left(Trim(Combo1(0)), 3) = "020" And Text1(6).Text = "T" And InStr(m_strCaseCPM, "101") > 0) Or Text1(6).Text = "CFT" And InStr(m_strCaseCPM, "101") > 0 Then
      Frame47.Visible = True
      If Text1(6).Text = "T" Then
         fra47Title.Caption = "商標說明："
      Else
         fra47Title.Caption = "商標英文大寫："
      End If
   End If
   'end 2021/02/24
End Sub

Private Sub Text1_MouseUp(Index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
   'Added by Morgan 2022/1/22
   If Index = 11 Or Index = 119 Or Index = 130 _
      Or Index = 21 Or Index = 22 Or Index = 23 Or Index = 24 Or Index = 26 Or Index = 27 Or Index = 125 _
      Or Index = 37 Or Index = 38 Or Index = 39 Or Index = 40 Or Index = 42 Or Index = 43 Or Index = 141 _
      Or Index = 53 Or Index = 54 Or Index = 55 Or Index = 56 Or Index = 58 Or Index = 59 Or Index = 157 _
      Or Index = 69 Or Index = 70 Or Index = 71 Or Index = 72 Or Index = 74 Or Index = 75 Or Index = 173 _
      Or Index = 85 Or Index = 86 Or Index = 87 Or Index = 88 Or Index = 90 Or Index = 91 Or Index = 189 Then
      If Button = 2 Then Forms(0).PopupMenu2 Text1(Index)
   End If
   'end 2022/1/22
End Sub

Private Sub Text1_Validate(Index As Integer, Cancel As Boolean)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim strCaseNo As String 'Add By Sindy 2014/7/7
Dim strTmp As String, i As Integer 'Add By Sindy 2014/9/11
Dim strCustID As String 'Add By Sindy 2014/9/15
'Add by Amy 2015/10/22
Dim bolNewCus As Boolean '申請人是否為新客戶
Dim ii As Integer, arrTM09 As Variant
Dim strRetrunText As String
Dim strPassTM09 As String  'Added by Lydia 2023/02/10
Dim strMsg As String 'Add By Sindy 2023/9/13

    If m_blnCallPrint = True Then Exit Sub
    m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/10/14 取得案件性質代碼
    Select Case Index
    'Add By Sindy 2023/9/14
    Case 137 '彼所案號
         If Me.Text1(Index).Text = "" Then Exit Sub
         If m_strSys = "1" Then '專利
            If CheckLengthIsOK(Text1(Index), 100) = False Then
               Text1(Index).SetFocus
               Cancel = True
               Exit Sub
            End If
         Else
            If CheckLengthIsOK(Text1(Index), 50) = False Then
               Text1(Index).SetFocus
               Cancel = True
               Exit Sub
            End If
         End If
         '2023/9/14 END
    Case 0 '區別
        If Me.Text1(Index).Text = "" Then Exit Sub
        Me.lblZone.Caption = GetDepartmentName(Me.Text1(Index).Text)
        If Me.lblZone.Caption = "" Then
            MsgBox "區別輸入錯誤!!!", vbExclamation + vbOKOnly
            Cancel = True
        End If
    'Add By Sindy 2022/10/14
    Case 138 '商品類別
         If Text1(138).Enabled = True Then 'Add By Sindy 2025/3/26 +if
            '若有輸入商品類別
            If Me.Text1(Index).Text <> "" Then
               If CheckLengthIsOK(Text1(Index), Text1(Index).MaxLength) = False Then
                  Text1(Index).SetFocus
                  Cancel = True
                  Exit Sub
               End If
               Me.Text1(Index).Text = Replace(Me.Text1(Index).Text, " ", "") 'Added by Lydia 2025/03/06 去掉多餘空白
               arrTM09 = Split(Me.Text1(Index).Text, ",")
               strPassTM09 = "" 'Added by Lydia 2023/02/10
               For ii = LBound(arrTM09) To UBound(arrTM09)
                  If Left(Combo6.Text, 1) <> "7" And Left(Combo6.Text, 1) <> "8" Then
   '                  'Modify By Sindy 2024/4/8
   '                  If Left(Trim(Combo1(0)), 3) = "000" And (Len(arrTM09(ii)) < 2 Or Len(arrTM09(ii)) > 2) Then
   '                     MsgBox "台灣商品類別 <" & arrTM09(ii) & "> 只能輸入二碼!!!", vbExclamation + vbOKOnly
   '                     Cancel = True
   '                     Exit For
   '                  '2024/4/8 END
   '                  Else
                     'Added by Lydia 2025/03/06 CFT所有案件之商品類別TM09改為2碼(公告114030701)
                     If Text1(6) = "CFT" Then
                        If Len(arrTM09(ii)) <> 2 Then
                           MsgBox "商品類別 <" & arrTM09(ii) & "> 只能輸入二碼!!!", vbExclamation + vbOKOnly
                           Cancel = True
                           Exit For
                        End If
                     Else
                     'end 2025/03/06
                        If Len(arrTM09(ii)) < 2 Or Len(arrTM09(ii)) > 3 Then
                           MsgBox "商品類別 <" & arrTM09(ii) & "> 不可小於二碼且不可大於三碼!!!", vbExclamation + vbOKOnly
                           Cancel = True
                           Exit For
                        End If
                     End If 'Added by Lydia 2025/03/06
                  End If
                  'Added by Lydia 2025/03/04 CFT-023558輸入09類
                  If PUB_CheckStrNEC(arrTM09(ii), "N") = False Then
                      MsgBox "商品類別 <" & arrTM09(ii) & "> 不可輸入非數字!!!", vbExclamation + vbOKOnly
                      Cancel = True
                      Exit For
                  End If
                  'end 2025/03/04
                  'Added by Lydia 2023/02/10 商品類別不可重複
                  If InStr(strPassTM09 & ",", arrTM09(ii) & ",") > 0 Then
                        MsgBox "商品類別 <" & arrTM09(ii) & "> 重覆輸入!!!", vbExclamation + vbOKOnly
                        Cancel = True
                        Exit For
                  End If
                  strPassTM09 = strPassTM09 & arrTM09(ii) & ","
                  'end 2023/02/10
               Next ii
            End If
            If Left(Trim(Combo1(0)), 3) = "000" And InStr(m_strCaseCPM, "102") > 0 And Trim(Text1(Index)) = "" Then
               MsgBox "台灣延展新案件, 請輸入商品類別以便檢查規費！", vbCritical
               Cancel = True
            End If
         End If
         
    'Modify By Sindy 2025/7/16 mark:程式在 CheckDataYN1 已有控管(商標新案號加強檢查)
'    'Add By Sindy 2022/10/18
'    Case 129 '審定號
'         If Trim(Text1(Index).Text) <> "" And m_strSys = "2" Then
'            If PUB_ChkTm12Tm15Length("2", Text1(Index), Text1(6), Text1(7), Text1(8), Text1(9), Left(Combo1(0).Text, 3), , , strRetrunText) = False Then
'               Cancel = True
'               Exit Sub
'            Else
'               Text1(Index) = strRetrunText
'            End If
'            strSql = "select DECODE( TM01,'TF',TM01||'-'||SUBSTR(TM02,1,5)||'-'||SUBSTR(TM02,6,1)||'-'||TM03||'-'||TM04,TM01||'-'||TM02||'-'||TM03||'-'||TM04) as C1" & _
'               " from TRADEMARK where TM10='" & Left(Combo1(0).Text, 3) & "' AND TM16='1' and TM15='" & Text1(Index).Text & "' and TM08='" & Left(Combo6.Text, 1) & "'"
'            rsA.CursorLocation = adUseClient
'            rsA.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
'            If Not (rsA.BOF And rsA.EOF) Then
'               MsgBox "此審定號已有本所資料，本所案號為 " & rsA.Fields(0).Value & " ，不可收新案號！", vbCritical
'               Cancel = True
'               Exit Sub
'            End If
'            rsA.Close
'         End If
         
    'Modify by Morgan 2010/12/23 +118
    'Modify By Sindy 2012/8/17 +128
    'Add By Sindy 2022/10/14 +, 139, 140
    Case 1, 2, 3, 117, 126, 118, 128, 139, 140 '日期
        If Me.Text1(Index).Text = "" Then Exit Sub
         If m_blnCallPrint = False Then 'Add by Morgan 2011/3/14 列印不必再檢查
            If CheckIsTaiwanDate(Me.Text1(Index).Text, True) = False Then
                Cancel = True
            'Add by Morgan 2011/3/14
'            ElseIf Index = 118 Then
'                If DBDATE(Text1(Index)) < strSrvDate(1) Then
'                   MsgBox "預定收款日期不可早於系統日 !", vbExclamation
'                   Cancel = True
'                End If
            'Add by Morgan 2010/12/24 指定送件日期必須是工作天
            ElseIf Index = 126 Then
                If Not ChkWorkDay(DBDATE(Text1(Index))) Then
                   MsgBox "指定送件日期必須是工作天 !", vbExclamation
                   Cancel = True
                End If
            'Add By Sindy 2022/10/14
            ElseIf Index = 140 Then
               If Val(Text1(Index - 1)) >= Val(Text1(Index)) Then
                  ShowMsg MsgText(1042)
                  Cancel = True
               End If
            End If
            'Add By Sindy 2022/11/22
            '若本所期限非工作天則直接調整至最近的工作天
            'Add By Sindy 2024/4/10 + if 法定期限欄位鎖住時,無須計算本所期限
            If Text1(1).Enabled = True Then
            '2024/4/10 END
               If Index = 3 Then
                  Me.Text1(Index).Text = TransDate(PUB_GetWorkDay1(Me.Text1(Index).Text, True), 1)
               End If
            End If
            '2022/11/22 End
         End If
    Case 6 '系統類別
         'Add by Sindy 2023/6/7
         If Text1(10) = "W2001" And Trim(Text1(6).Text) <> "" Then
            ClsPDGetSystemKind Text1(6).Text, intI
            If intI = 專利 Or intI = 商標 Then
               MsgBox "顧服組不能收專利和商標案件 !", vbExclamation
               Text1(6).Text = ""
               Text1(6).SetFocus
               Cancel = True
            End If
         End If
         '2023/6/7 END
         
'        If Me.Text1(Index).Text = "" Then Exit Sub
'        strSQLA = "Select Distinct SG02 From Staff_Group, Staff Where ST11=SG01 And ST01='" & Me.Text1(10).Text & "' And SG02='" & Me.Text1(6).Text & "' "
'        rsA.CursorLocation = adUseClient
'        rsA.Open strSQLA, cnnConnection, adOpenStatic, adLockReadOnly
'        If rsA.RecordCount <= 0 Then
'            MsgBox "您無權使用系統類別<" & Me.Text1(Index).Text & ">!!!", vbExclamation + vbOKOnly
'            Cancel = True
'        End If
'        If rsA.State <> adStateClosed Then rsA.Close
'        Set rsA = Nothing
    Case 10 '員工代號
        m_strST06 = "" 'Add by Morgan 2011/1/7
        If Me.Text1(Index).Text = "" Then
            Me.lblStaffName.Caption = ""
            Me.Text1(0).Text = ""
            Me.lblZone.Caption = ""
            Exit Sub
        End If
        'Modify By Sindy 2022/10/19 +, IIf(m_blnCallPrint = True, True, False)
        Me.lblStaffName.Caption = GetStaffName(Me.Text1(Index).Text, IIf(m_blnCallPrint = True, True, False))
        If Me.lblStaffName.Caption = "" Then
            MsgBox "員工代號輸入錯誤!!!", vbExclamation + vbOKOnly
            Cancel = True
            Me.Text1(0).Text = ""
            Me.lblZone.Caption = ""
        Else
            'Added by Lydia 2019/02/14 創新業務部人員收文控管
            If PUB_ChkIsT10T20("2", Me.Text1(Index).Text, m_Tuser, strExc(1)) = True Then
                 Me.Text1(Index).Text = m_Tuser
                 Me.lblStaffName.Caption = strExc(1)
                 Cancel = True
                 Exit Sub
            End If
            'end 2019/02/14
            
            'Modify by Morgan 2011/1/11 +ST06,+ST58
            'Added by Lydia 2023/12/27
            If DBDATE(strCRL(2)) > 新部門啟用日 Or (strCRL(2) = "" And strSrvDate(1) >= 新部門啟用日) Then
                StrSQLa = "Select ST15, NVL(A0922,A0902) AS A0902,ST06,ST58 From Acc090, Staff,ACC090NEW Where ST15=A0901 AND ST93=A0921(+) And ST04='1' And ST01='" & Me.Text1(Index).Text & "' "
            Else
            'end 2023/12/27
                StrSQLa = "Select ST15, A0902,ST06,ST58 From Acc090, Staff Where ST15=A0901 And ST04='1' And ST01='" & Me.Text1(Index).Text & "' "
            End If
            rsA.CursorLocation = adUseClient
            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
            If rsA.RecordCount > 0 Then
                Me.Text1(0).Text = "" & rsA.Fields(0).Value
                Me.lblZone.Caption = "" & rsA.Fields(1).Value
                'Add by Morgan 2011/1/11
                m_strST06 = "" & rsA.Fields(2).Value
            Else
                Me.Text1(0).Text = ""
                Me.lblZone.Caption = ""
                'Add by Morgan 2011/1/11
                m_strST06 = ""
'                m_strST58 = ""
            End If
            If rsA.State <> adStateClosed Then rsA.Close
            Set rsA = Nothing
        End If
        'Add By Sindy 2010/11/22
        'Modify By Sindy 2024/8/8 + And Text1(10) <> "30015"
        If Text1(10).Text <> "" And Text1(10) < "63001" And Text1(10) <> "30015" Then
            MsgBox "智權人員不可小於 63001！", vbExclamation + vbOKOnly
            Cancel = True
        End If
        '2010/11/22 End
        
         'Added by Morgan 2020/4/29
         If Text1(10).Tag <> Text1(10) Then
            Text1(10).Tag = Text1(10)
            SrcSetButton
            If Me.Visible Then SrcLoadCheck
         End If
         'end 2020/4/29
    Case 11 '主題
        If CheckLengthIsOK(Me.Text1(Index).Text, Text1(Index).MaxLength, , , True) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    'Add By Sindy 2010/5/27
    Case 5 '代理人
        If Me.Text1(Index).Text = "" Then Me.Text1(Index).Tag = Me.Text1(Index).Text: Exit Sub
        Me.Text1(Index).Tag = Me.Text1(Index).Text
        ClearFagentTxt
        If Me.Text1(Index).Tag <> "" Then
            Me.Text1(Index).Text = Me.Text1(Index).Tag
            If SetFagentTxt(Me.Text1(Index).Tag) = False Then
                MsgBox "代理人編號輸入錯誤!!!", vbExclamation + vbOKOnly
                Cancel = True
            'Added by Lydia 2019/01/30 大至台案件彈出代理人D/N備註
            Else
                If OptChoose(1).Value = True Then
                    If Left(Text1(6), 1) = "T" And m_FA110 <> "" Then '商標D/N備註
                        MsgBox "代理人D/N備註：" & vbCrLf & m_FA110, vbExclamation, "代理人D/N備註"
                    ElseIf m_FA45 <> "" Then  '專利D/N備註
                        MsgBox "代理人D/N備註：" & vbCrLf & m_FA45, vbExclamation, "代理人D/N備註"
                    End If
                End If
            'end 2019/01/30
            End If
        End If
    Case 12, 28, 44, 60, 76 '申請人
        'Add By Sindy 2011/7/18
        If Trim(Combo1(0).Text) = "" Then
            MsgBox "申請國家不能空白 !!!", vbExclamation + vbOKOnly
            Me.Text1(Index).Text = ""
            SSTab1.Tab = 0
            Combo1(0).SetFocus
            Exit Sub
        End If
        If Trim(Text1(6).Text) = "" Then
            MsgBox "請先點選新/舊案及輸入系統別 !!!", vbExclamation + vbOKOnly
            Me.Text1(Index).Text = ""
            SSTab1.Tab = 0
            Text1(6).SetFocus
            Exit Sub
        End If
        '2011/7/18 End
        If Me.Text1(Index).Text = "" Then Me.Text1(Index).Tag = Me.Text1(Index).Text: Exit Sub
        m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/9/6 取得案件性質代碼
        '申請人
        strCustID = Me.Text1(Index).Text
        ClearCustTxt (Index - 12) / 16 + 1
        If strCustID <> "" Then
            Me.Text1(Index).Text = strCustID
            If SetCustTxt((Index - 12) / 16 + 1, strCustID) = False Then
                MsgBox "客戶編號輸入錯誤!!!", vbExclamation + vbOKOnly
                Cancel = True
            Else
               txtEnabled2 True, (Index - 12) / 16 + 1
               'Add By Sindy 2011/7/6
               m_AppAddrChange = False
               'Add By Sindy 2023/1/5 修改時不需再Run此函數
               If Me.Text5.Text = "" Then
               '2023/1/5 END
                  Call CheckAppAddr((Index - 12) / 16 + 1)
               End If
               'Add by Amy 2016/01/04 輸舊客戶編號要鎖地址欄
               Select Case Index
                    Case 12
                        bolNewCus = Option31(0).Value
                    Case 28
                        bolNewCus = Option32(0).Value
                    Case 44
                        bolNewCus = Option33(0).Value
                    Case 60
                        bolNewCus = Option34(0).Value
                    Case 76
                        bolNewCus = Option35(0).Value
               End Select
               txtEnabled2 bolNewCus, (Index - 12) / 16 + 1
               'end 2016/01/04
               '2011/7/6 End
            End If
        End If
        'Add by Amy 2015/10/22 +選新案確認收據公司別
        If Index = 12 And Option1(0).Value = True Then
            Call CheckComp
        End If
        'end 2015/10/22
        'Add by Morgan 2004/5/20
        If Index = 12 And Cancel = False Then
            'edit by nick 2004/08/05
            'stCustNo = Text1(Index).Text
            'Call setCP81  '設定減免身分
            stCustNo1 = Text1(Index).Text
            'add by nick 2004/10/05
            If IsoptCP81 = True Then
                Call setCP811  '設定減免身分
            End If
            'Add By Sindy 2015/7/27 原在按下列印鍵時提醒,改先提醒
            If Me.Text1(Index).Tag <> Me.Text1(Index).Text Then
               IsSpecCu = False
               SpecCUName = ""
               SpecMemo = ""
               IsCuMemo = False
               CuMemoName = ""
               CuMemo = ""
               SetCuData IsSpecCu, SpecCUName, SpecMemo, IsCuMemo, CuMemoName, CuMemo, 1
               If IsCuMemo Then
                  MsgBox CuMemoName & "此客戶有業務備註！！", vbInformation, "業務備註！"
               End If
            End If
            '2015/7/27 END
        End If
        'add by nick 2004/08/05
        If Index = 28 And Cancel = False Then
            stCustNo2 = Text1(Index).Text
            'add by nick 2004/10/05
            If IsoptCP81 = True Then
                Call setCP812             '設定減免身分
            End If
            'Add By Sindy 2015/7/27 原在按下列印鍵時提醒,改先提醒
            If Me.Text1(Index).Tag <> Me.Text1(Index).Text Then
               IsSpecCu = False
               SpecCUName = ""
               SpecMemo = ""
               IsCuMemo = False
               CuMemoName = ""
               CuMemo = ""
               SetCuData IsSpecCu, SpecCUName, SpecMemo, IsCuMemo, CuMemoName, CuMemo, 2
               If IsCuMemo Then
                  MsgBox CuMemoName & "此客戶有業務備註！！", vbInformation, "業務備註！"
               End If
            End If
            '2015/7/27 END
        End If
        If Index = 44 And Cancel = False Then
            stCustNo3 = Text1(Index).Text
            'add by nick 2004/10/05
            If IsoptCP81 = True Then
                Call setCP813             '設定減免身分
            End If
            'Add By Sindy 2015/7/27 原在按下列印鍵時提醒,改先提醒
            If Me.Text1(Index).Tag <> Me.Text1(Index).Text Then
               IsSpecCu = False
               SpecCUName = ""
               SpecMemo = ""
               IsCuMemo = False
               CuMemoName = ""
               CuMemo = ""
               SetCuData IsSpecCu, SpecCUName, SpecMemo, IsCuMemo, CuMemoName, CuMemo, 3
               If IsCuMemo Then
                  MsgBox CuMemoName & "此客戶有業務備註！！", vbInformation, "業務備註！"
               End If
            End If
            '2015/7/27 END
        End If
        If Index = 60 And Cancel = False Then
            stCustNo4 = Text1(Index).Text
            'add by nick 2004/10/05
            If IsoptCP81 = True Then
                Call setCP814             '設定減免身分
            End If
            'Add By Sindy 2015/7/27 原在按下列印鍵時提醒,改先提醒
            If Me.Text1(Index).Tag <> Me.Text1(Index).Text Then
               IsSpecCu = False
               SpecCUName = ""
               SpecMemo = ""
               IsCuMemo = False
               CuMemoName = ""
               CuMemo = ""
               SetCuData IsSpecCu, SpecCUName, SpecMemo, IsCuMemo, CuMemoName, CuMemo, 4
               If IsCuMemo Then
                  MsgBox CuMemoName & "此客戶有業務備註！！", vbInformation, "業務備註！"
               End If
            End If
            '2015/7/27 END
        End If
        If Index = 76 And Cancel = False Then
            stCustNo5 = Text1(Index).Text
            'add by nick 2004/10/05
            If IsoptCP81 = True Then
                Call setCP815  '設定減免身分
            End If
            'Add By Sindy 2015/7/27 原在按下列印鍵時提醒,改先提醒
            If Me.Text1(Index).Tag <> Me.Text1(Index).Text Then
               IsSpecCu = False
               SpecCUName = ""
               SpecMemo = ""
               IsCuMemo = False
               CuMemoName = ""
               CuMemo = ""
               SetCuData IsSpecCu, SpecCUName, SpecMemo, IsCuMemo, CuMemoName, CuMemo, 5
               If IsCuMemo Then
                  MsgBox CuMemoName & "此客戶有業務備註！！", vbInformation, "業務備註！"
               End If
            End If
            '2015/7/27 END
        End If
        Me.Text1(Index).Tag = Me.Text1(Index).Text
        
         'edit by nick 2004/08/05
         'If Index = 12 Then Call GetReceiptTitle 'Add by Morgan 2004/6/11
         Call GetReceiptTitle
         'Add By Sindy 2014/7/7 檢查是否有總委任書
         If strLOS18 = "" Then '案源列印P/T案時不必重複提醒
            If (Text1(6) = "P" Or Text1(6) = "FCP") And _
               Left(Trim(Combo1(0)), 3) = "000" And _
               Option1(0).Value = True Then
               If PUB_ChkPA165IsY(Text1(Index), strCaseNo) = True Then
                  MsgBox "此申請人已設定總委任書案件：" & IIf(Right(strCaseNo, 5) = "-0-00", Left(strCaseNo, Len(strCaseNo) - 5), strCaseNo), vbExclamation + vbOKOnly
               End If
            End If
         End If
         '2014/7/7 END
    '電話1,2, 傳真, 行動
    'Modified by Lydia 2021/08/26 拿掉電話2
    'Case 14, 15, 16, 17, 20, 30, 31, 32, 33, 36, 46, 47, 48, 49, 52, 62, 63, 64, 65, 68, 78, 79, 80, 81, 84
    Case 14, 16, 17, 20, 30, 32, 33, 36, 46, 48, 49, 52, 62, 64, 65, 68, 78, 80, 81, 84
        If CheckLengthIsOK(Me.Text1(Index).Text, 17) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    'Added by Lydia 2021/08/26 LINE ID (原本電話2)
    Case 15, 31, 47, 63, 79
        '新客戶輸入檢查20字
        If CheckLengthIsOK(Me.Text1(Index).Text, 20) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    'end 2021/08/26
    Case 18 '客戶案號(型號)
        'Modified by Lydia 2023/12/21 配合Table改成50字
        If CheckLengthIsOK(Me.Text1(Index).Text, 50) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    Case 19, 35, 51, 67, 83 'E-Mail
        ' Modify By Sindy 98/02/17 E-Mail長度從26改到50
        If CheckLengthIsOK(Me.Text1(Index).Text, 50) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    Case 21, 37, 53, 69, 85 '申請人中文
        If CheckLengthIsOK(Me.Text1(Index).Text, Text1(Index).MaxLength, , , True) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    Case 22, 38, 54, 70, 86 '申請人英文
        If CheckLengthIsOK(Me.Text1(Index).Text, Text1(Index).MaxLength, , , True) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    Case 23, 39, 55, 71, 87 '代表人中文
        If CheckLengthIsOK(Me.Text1(Index).Text, Text1(Index).MaxLength, , , True) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    Case 24, 40, 56, 72, 88 '代表人英文
        If CheckLengthIsOK(Me.Text1(Index).Text, Text1(Index).MaxLength, , , True) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    Case 26, 42, 58, 74, 90 '聯絡地址
        'Modify By Sindy 2023/1/17
        If CheckLengthIsOK(Me.Text1(Index).Text, Text1(Index).MaxLength, , , True) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    Case 27, 43, 59, 75, 91 '申請地址
        'Modify By Sindy 2023/1/17
        If CheckLengthIsOK(Me.Text1(Index).Text, Text1(Index).MaxLength, , , True) = False Then
            Text1(Index).SetFocus
            Cancel = True
        End If
    'Add by Amy 2024/06/24 台灣->臺灣
    Case 34, 50, 66, 82, 98 '國籍
      If Trim(Text1(Index).Text) = "" Then Exit Sub
      If Text1(Index).Enabled = False Then Exit Sub
      Text1(Index).Text = Replace(Text1(Index).Text, "台灣", "臺灣")
    'Add By Sindy 2014/9/11
    Case 92, 93, 94, 95, 96 'ID No.
         If Trim(Text1(Index).Text) = "" Then Exit Sub
         If Text1(Index).Enabled = False Then Exit Sub
         Text1(Index).Text = Trim(PUB_StringFilter(Text1(Index).Text))
         'Modify By Sindy 2014/9/25
         If Index = 92 Then strCustID = Trim(Text1(12).Text)
         If Index = 93 Then strCustID = Trim(Text1(28).Text)
         If Index = 94 Then strCustID = Trim(Text1(44).Text)
         If Index = 95 Then strCustID = Trim(Text1(60).Text)
         If Index = 96 Then strCustID = Trim(Text1(76).Text)
         'If Text1(Index).Tag <> "" Then
         '舊客戶
         If Text1(Index).Tag <> "" And strCustID <> "" Then
         '2014/9/25 END
            'Modify by Amy 2020/09/01 +if 申請人國籍為大陸於列印前才檢查身份證號(因會先輸此才輸地址)
            If Me.Text1(34 + (SSTab2.Tab) * 16) = "中國大陸" Then
                i = 99
            Else
                If Text1(Index).Tag = "0" Then
                   'Modify By Sindy 2023/5/16
                   'If GetTextLength(Text1(Index).Text) <> 10 Then
                   If Len(Text1(Index).Text) <> 10 Then
                   '2023/5/16 END
                      Call Text1_GotFocus(Index)
                      strTmp = "身份證必須是10碼 ! 請確定 ?"
                      If MsgBox(strTmp, vbYesNo + vbCritical) = vbNo Then
                         Cancel = True
                         Exit Sub
                      End If
                   End If
                   i = 0
                Else
                   'Modify By Sindy 2023/5/16
                   'If GetTextLength(Text1(Index).Text) <> 8 Then
                   If Len(Text1(Index).Text) <> 8 Then
                   '2023/5/16 END
                      Call Text1_GotFocus(Index)
                      strTmp = "統編必須是8碼 ! 請確定 ?"
                      If MsgBox(strTmp, vbYesNo + vbCritical) = vbNo Then
                         Cancel = True
                         Exit Sub
                      End If
                   End If
                   i = 1
                End If
            End If
            'end 2020/09/01
         '新客戶
         Else
            'Add By Sindy 2023/9/13 增加身份證字號檢查
            strMsg = ""
            If ChkCU11Same("", "", Text1(Index).Text, strMsg, 0) = True Then
               If MsgBox("身份證字號/統一編號[" & Text1(Index).Text & "]與" & IIf(InStr(strMsg, ",") > 0, vbCrLf, "") & strMsg & "相同" & vbCrLf & _
                         "請確認是否為「更名」？" & vbCrLf & vbCrLf & _
                         "選「是」更名，請放棄接洽單，更名後重新填寫。" & vbCrLf & _
                         "選「否」不是更名，程式繼續執行", vbExclamation + vbYesNo + vbDefaultButton2) = vbYes Then
                  Me.SSTab1.Tab = 1
                  If Index = 92 Then Me.SSTab2.Tab = 0
                  If Index = 93 Then Me.SSTab2.Tab = 1
                  If Index = 94 Then Me.SSTab2.Tab = 2
                  If Index = 95 Then Me.SSTab2.Tab = 3
                  If Index = 96 Then Me.SSTab2.Tab = 4
                  Cancel = True
                  Exit Sub
               End If
            End If
            '2023/9/13 END
            
            'Modify by Amy 2020/09/01 原只有台灣才會輸,因加大陸身份證號判斷(需輸完地址才能判斷),故改至列印前判斷
            i = 99
'            If GetTextLength(Text1(Index).Text) = 10 Then
'                i = 0
'            Else
'                i = 1
'            End If
            'end 2020/09/01
         End If
         'Modify by Amy 2020/09/01 +if 舊客戶且非大陸才先判斷
         'Memo by Amy 2024/06/24 國籍輸ID欄沒資料,故於存檔前再用Pub_CheckIDAll函數判斷
         If Text1(Index).Tag <> "" And strCustID <> "" And i <> 99 Then
            If CheckID(i, Text1(Index).Text) = False Then
               If i = 0 Then
                  strTmp = "身分證字號錯誤，是否確定 ?"
               Else
                  strTmp = "統一編號錯誤，是否確定 ?"
               End If
               If MsgBox(strTmp, vbYesNo + vbCritical) = vbNo Then
                  Cancel = True
               End If
            End If
         End If
    '2014/9/11 END
    
'    'Add By Sindy 2014/7/28
'    Case 100 '本案與總號
'        If Trim(Me.Text1(Index).Text) <> "" Then
'            'Added by Lydia 2017/12/11 預設只能一個案號，增加檢查程式。
'            If InStr(Trim(Me.Text1(Index).Text), ",") > 0 Or InStr(Trim(Me.Text1(Index).Text), ".") > 0 Then
'                 MsgBox "請輸入正確總號，總號只能輸入一個 !", vbCritical
'                 SSTab1.Tab = 1
'                 SSTab2.Tab = 0
'                 Text1(Index).SetFocus
'                 Text1_GotFocus Index
'                 Cancel = True
'                 Exit Sub
'            End If
'            'end 2017/12/11
'
'            'Modify By Sindy 2014/8/26
'            'ChgCaseNo Trim(Me.Text1(Index).Text), strCase
'            ChgCaseNo Replace(Trim(Me.Text1(Index).Text), "-", ""), strCase
'            '2014/8/26 END
'            Call PUB_CaseClosed(strCase(1), strCase(2), strCase(3), strCase(4), bolCaseIsExists, False)
'            If bolCaseIsExists = False Then
'               SSTab1.Tab = 1
'               SSTab2.Tab = 0
'               Text1(Index).SetFocus
'                'Added by Lydia 2017/12/11
'               Text1_GotFocus Index
'               Cancel = True
'               'end 2017/12/11
'               Exit Sub
'            End If
'        End If
    '2014/7/28 END
    
    'Add by Morgan 2007/9/7 行政訴訟503,行政訴訟上訴507,參加行政訴訟506 要檢查規費
    '2009/10/20 modify by sonia 取消參加行政訴訟, 因為主動的才要規費,被通知的則不要規費
    Case 102 '規費, 105, 108, 111
         'Modify By Sindy 2015/9/8 將此段程式改為Func,因在Validate不顯示訊息,在按下確定鍵時要顯示訊息
         Call ChkFeeAndAutoRecv(Index, Cancel, False)
         If Cancel = True Then
            Text1(102).SetFocus 'Add By Sindy 2022/9/13
            Exit Sub
         End If
    'Add By Sindy 2010/11/22
    Case 103 '點數, 106, 109, 112
         'Modify By Sindy 2022/9/14 搬到 CheckDataValidate1 檢查
         
    'Add By Sindy 2010/4/23
    'Modified by Morgan 2012/12/18 +114
    Case 4, 114
      If Text1(Index) <> "" Then
         Select Case Text1(Index)
            Case "0"
                MsgBox "不可以輸入0", vbInformation, "輸入錯誤！"
                Cancel = True
         End Select
      End If
   
   'Add By Sindy 2022/12/8
    Case 145 '證書形式
         '檢查客戶選擇的證書/註冊證形式是否與最後收文設定相同
         If Text1(12) <> "" And Text1(6) <> "" And Text1(145) <> "" Then
            Call PUB_ChkCustCertType(Text1(12), Text1(6), Text1(145), True)
         End If
   End Select
    
    Select Case Index
    Case 11, 21, 22, 37, 38, 53, 54, 69, 70, 85, 86, 26, 27, 42, 43, 58, 59, 74, 75, 90, 91
      '無動作
    Case Else
      If Cancel = True Then TextInverse Me.Text1(Index)
    End Select
    
   'Add by Morgan 2011/3/7
   '欄位長度檢查
   If Cancel = False Then
      If Text1(Index).MaxLength > 0 Then
         If Not CheckLengthIsOK(Text1(Index), Text1(Index).MaxLength, , , True) Then
            Text1(Index).SetFocus
            Cancel = True
         End If
      End If
      'Added by Lydia 2020/12/28 增加對「一般說明」的長度限制 ; ex.將商標類別的每一類別和明細都列出
      If Index = 119 Then
         If Not CheckLengthIsOK(Text1(Index), 2000, , , True) Then
            Text1(Index).SetFocus
            Cancel = True
         End If
      End If
      'end 2020/12/28
   End If
End Sub

'Modify By Sindy 2015/9/8 檢查規費, 將此段程式改為Func,因在Validate不顯示訊息,在按下確定鍵時要顯示訊息
Private Sub ChkFeeAndAutoRecv(Index As Integer, Cancel As Boolean, bolShowMsg As Boolean)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim m_msg As String   '2010/1/6 ADD BY SONIA
Dim m_strNP09 As String, m_strNP09_1 As String, strDouble As String, strCP81 As String 'Add By Sindy 2010/7/9
Dim intCaseTy As Integer 'Add By Sindy 2010/11/22 員工部門別
'Dim bolChkCustErr As Boolean 'Add By Sindy 2012/9/26
Dim dblTot As Double, dblPaTwFee As Double, dblTwFee As Double
Dim bolIsCaseBill As Boolean, strCaseCharge As String, strChkNP07 As String 'Add By Sindy 2015/8/27
Dim tmpCP14 As String 'Add by Amy 2018/08/09
Dim dblRelTot As Double 'Added by Lydia 2020/02/03 關係企業總金額
Dim HadChkFee As Boolean, strFee As String, strAppl As String 'Add By Sindy 2022/12/26
Dim intMoney As Long '倍數
Dim tmpArr As Variant
   
   Me.Check10.Tag = "" 'Add By Sindy 2025/4/14 預設沒有規費異常
   HadChkFee = False 'Add By Sindy 2022/12/26
   'Added by Morgan 2020/4/17 案源不檢查
   If cmdOK(0).Visible = False Then
      Exit Sub
   Else
      SrcSetLCase
      If strLSourceType = "B2" Then
         Exit Sub
      End If
   End If
   'end 2020/4/17
   
   Call GetstrIDentity 'Add By Sindy 2023/2/15
   bolRuleFeeErr = False
   If Text1(6) <> "" And Combo1(0).Text <> "" And Combo1((Index - 102) / 3 + 1).Text <> "" Then
      arrCaseProperty = Split(Combo1((Index - 102) / 3 + 1).Text, " ") 'Add by Morgan 2010/12/9 下面移上來
      strCaseCharge = Text1(Index - 1).Text 'Add By Sindy 2015/8/31
      arrNation = Split(Me.Combo1(0).Text, " ")
      strAppl = ChangeCustomerL(Text1(12)) & "," & ChangeCustomerL(Text1(28)) & "," & ChangeCustomerL(Text1(44)) & "," & ChangeCustomerL(Text1(60)) & "," & ChangeCustomerL(Text1(76))
      
      'Add By Sindy 2012/3/16
      '檢查時間點：規費欄跳離、點數欄跳離、列印時；
      '控制：T、台灣、101申請時，若規費欄非 2400, 2700, 3000 時，彈訊息
      If Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(arrCaseProperty(0)) = "101" And _
         (Val(Text1(Index)) <> 2400 And Val(Text1(Index)) <> 2700 And Val(Text1(Index)) <> 3000) Then
         If Combo6.Visible = True And Left(Combo6.Text, 1) <> "7" And Left(Combo6.Text, 1) <> "8" Then 'Add By Sindy 2012/4/26 +if
            MsgBox "台灣商標申請案規費不符，只可為 3,000元, 2,700元, 2,400元，" & vbCrLf & "若有跨類或超項費請分案件性質收文，跨類代號107，超項費代號714！", vbExclamation + vbOKOnly
            Cancel = True
            Exit Sub
         Else
            HadChkFee = True 'Add By Sindy 2022/12/26
         End If
      End If
      '2012/3/16 End

      'Added by Lydia 2020/07/20 T台灣案的團標標章及證明標章，固定規費為4700,5000
      If Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(arrCaseProperty(0)) = "101" And _
         (Val(Text1(Index)) <> 4700 And Val(Text1(Index)) <> 5000) Then
         If Combo6.Visible = True And (Left(Combo6.Text, 1) = "7" Or Left(Combo6.Text, 1) = "8") Then
            MsgBox "台灣商標申請案規費不符，只可為 5000元, 4,700元，" & vbCrLf & "若有跨類或超項費請分案件性質收文，跨類代號107，超項費代號714！", vbExclamation + vbOKOnly
            Cancel = True
            Exit Sub
         Else
            HadChkFee = True 'Add By Sindy 2022/12/26
         End If
      End If
      'end 2020/07/20
      
      'Added by Morgan 2013/9/23
      '台灣專利申請案要檢查規費
      'Modified by Morgan 2014/1/20 +125 衍生設計申請(無減免)
      'Modified by Morgan 2014/1/23 +衍生設計125又改可減免--莊敏惠
      'Modified by Morgan 2014/11/10 +分割及改請電子送件也可減免--郭
      If Text1(Index) <> "" And Trim(Text1(6)) = "P" And Left(Trim(Combo1(0)), 3) = "000" And (InStr("101,102,103,125,307", Trim(arrCaseProperty(0))) > 0 Or Left(Trim(arrCaseProperty(0)), 1) = "3") Then
         'Modify By Sindy 2025/4/14 改成共用函數
'         strExc(0) = "select cf08 from casefee where cf01='P' and cf02='000' and cf03='" & Trim(arrCaseProperty(0)) & "' and cf08>0"
'         intI = 1
'         Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
         Call PUB_GetCaseFee_000("", "", "", strExc(1), "P", Trim(arrCaseProperty(0)))
         'If intI = 1 Then
         If Val(strExc(1)) > 0 Then
         '2025/4/14 END
            strExc(2) = "": strExc(3) = ""
            'Add by Morgan 2103/9/26 台灣分割案規費 3500
            If Trim(arrCaseProperty(0)) = "307" And Left(Combo6, 1) = "1" Then
               strExc(1) = "3500"
            'Modify By Sindy 2025/4/14 mark
'            Else
'               strExc(1) = Val("" & RsTemp(0))
            '2025/4/14 END
            End If
            strExc(3) = strExc(1)
            
            '電子送件 -600
            If Check4.Value = 1 Then
               'Modified by Morgan 2014/1/20 +125
               'Modified by Morgan 2014/1/23 +衍生設計125又改可減免--莊敏惠
               'If Trim(arrCaseProperty(0)) <> "307" Then 'Add By Sindy 2014/1/10 307不能減
               'Modified by Morgan 2014/11/10 +分割及改請電子送件也可減免--郭
               'If Trim(arrCaseProperty(0)) <> "307" Then
                  strExc(1) = strExc(1) - 600
                  strExc(2) = strExc(2) & " - 600(電子送件)"
               'End If
            End If
            
            'Added by Morgan 2013/9/26 附英文摘要-800
            'Modified by Morgan 2015/2/3 +判斷發明分割才扣(同收文)
            If InStr("101,307", Trim(arrCaseProperty(0))) > 0 Then
               If Check5.Value = 1 Then
                  'Added by Morgan 2017/11/23 --茹曣
                  If bolShowMsg Then
                     'If Trim(Left(Me.Combo1(1).Text, 4)) <> "946" And Trim(Left(Me.Combo1(2).Text, 4)) <> "946" And Trim(Left(Me.Combo1(3).Text, 4)) <> "946" And Trim(Left(Me.Combo1(4).Text, 4)) <> "946" Then
                     If InStr(m_strCaseCPM, "946") = 0 Then
                        MsgBox "有勾選「附英文摘要」時，要收文【946 摘要英譯】！", vbExclamation
                        Cancel = True
                        Exit Sub
                     End If
                  End If
                  'end 2017/11/23
                  strExc(1) = strExc(1) - 800
                  strExc(2) = strExc(2) & " - 800(附英文摘要)"
               End If
            End If
            'end 2015/2/3
            If strExc(2) <> "" Then
               strExc(2) = "[ " & strExc(1) & " = " & strExc(3) & strExc(2) & " ]"
            End If
            If Val(Text1(Index)) <> Val(strExc(1)) Then
               MsgBox "【" & Trim(Mid(Combo1((Index - 102) / 3 + 1).Text, 4)) & "】規費應為 " & strExc(1) & " 元！" & vbCrLf & vbCrLf & strExc(2), vbExclamation
               Cancel = True
               Exit Sub
            Else
               HadChkFee = True 'Add By Sindy 2022/12/26
            End If
         End If
      End If
      'end 2013/9/23
      
      'Add By Sindy 2015/8/27 檢查應收帳款狀況,是否可自動收文
      bolIsCaseBill = False '電子收文已無紙本收文,有帳款問題要經程序人員分案
'原:P案的自動收文檢查
      'Add By Sindy 2010/7/9
      '舊案, P專利, 601領證或605年費, 有繳費起迄年度
      '2010/11/19 modify by sonia 取消只有台灣案的檢查
      'Modify by Morgan 2010/12/22 取消測試控制
      'If Pub_StrUserSt03 = "M51" And Option1(1).Value = True And _
         Text1(6) = "P" And (arrCaseProperty(0) = "601" Or arrCaseProperty(0) = "605") And _
         strYF05From > "" And strYF05To > "" Then
      'Modify By Morgan 2011/1/7 先做台灣案,且判斷員工檔設定為可自動收文
      'Modify By Sindy 2015/8/27 + And bolIsCaseBill = False
      'Modified by Morgan 2015/9/9 +非臺灣案
      'If Option1(1).Value = True And m_strST58 = "" And Left(Combo1(0), 3) = "000" And _
         (Text1(6) = "P" And (arrCaseProperty(0) = "601" Or arrCaseProperty(0) = "605") And strYF05From > "" And strYF05To > "" And bolIsCaseBill = False) Then
      'Modified by Morgan 2015/10/28 可自動收文判斷移到下面,因不管是否自動收文都要檢查規費
      'If Option1(1).Value = True And m_strST58 = "" And _
         (Text1(6) = "P" And (arrCaseProperty(0) = "601" Or arrCaseProperty(0) = "605") And strYF05From > "" And strYF05To > "" And bolIsCaseBill = False) Then
      If Option1(1).Value = True And _
         (Text1(6) = "P" And (arrCaseProperty(0) = "601" Or arrCaseProperty(0) = "605") And Text1(142).Text > "" And Text1(143).Text > "" And bolIsCaseBill = False) Then
         HadChkFee = True 'Add By Sindy 2023/1/10
      'end 2015/10/28
      'end 2015/9/9
         '取得下一程序的法定期限ChgNextProgress(pa(1) & pa(2) & pa(3) & pa(4))
         StrSQLa = "Select * From NextProgress,CaseProgress Where " & ChgNextProgress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " And Np07='" & arrCaseProperty(0) & "' and np01=cp09(+) Order By NP09 Desc "
         rsA.CursorLocation = adUseClient
         rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
         strCP81 = ""
         If rsA.RecordCount > 0 Then
            strCP81 = "" & rsA("CP81").Value
            m_strNP09 = "" & ChangeWStringToTString(rsA("NP09").Value)
'2010/11/19 cancel by sonia
'            Else
'               '是否符合年費減免
'               strCP81 = PUB_GetCaseDiscStat(Text1(6) & Text1(7) & Text1(8) & Text1(9))
'               m_strNP09 = "" & ChangeWStringToTString(rsA("CP07").Value)
         End If
         If rsA.State <> adStateClosed Then rsA.Close
         Set rsA = Nothing
         '是否符合年費減免 2010/11/19 add by sonia
         'Modified by Morgan 2013/4/9 改抓畫面上的設定
         'strCP81 = PUB_GetCaseDiscStat(Text1(6) & Text1(7) & Text1(8) & Text1(9))
         strCP81 = GetCP81()
         'end 2013/4/9
         '2010/11/19 end
         '若法定期限為假日時, 抓大於法定期限最近的工作天
         m_strNP09_1 = ""
         If m_strNP09 <> "" Then
             m_strNP09_1 = DBDATE(PUB_GetLawDay(DBDATE(m_strNP09)))
         End If
         
         '檢查費用是否要雙倍
         strDouble = ""
         If strSrvDate(1) > IIf(DBDATE(m_strNP09) >= DBDATE(m_strNP09_1), DBDATE(m_strNP09), DBDATE(m_strNP09_1)) Then
            strDouble = "Y"
         End If
         'Added by Lydia 2022/10/14 依智權單位之需求，請協助對中國大陸年費自動收文做如下的調整：智權同仁收文的時間點若是在法定期限+1個月(含),則仍允許自動收文。
         If pa(1) = "P" And arrCaseProperty(0) = "605" And pa(9) = "020" And strDouble = "Y" Then
             If strSrvDate(1) <= CompDate(1, 1, m_strNP09) Then
                  strDouble = ""
             End If
         End If
         'end 2022/10/14

         'Added by Morgan 2015/10/28 從下面移上來,不管是否自動收文都要檢查規費
         '檢查計算出的規費與畫面上使用者輸入的規費是否相同
         If ChkPatentYearFee(pa(9), pa(8), "Y00000001", "" & arrCaseProperty(0), Text1(142).Text, Text1(143).Text, IIf(strDouble = "Y", True, False), Val(Text1(Index)), strCP81, 1) = False Then
            m_Msgbox = "規費欄位與規定不符"
            'Added by Morgan 2015/9/9 +非臺灣案
            If Left(Combo1(0), 3) <> "000" Then
               'Modified by Morgan 2015/11/4
               If bolShowMsg = True Then
                  If MsgBox(m_Msgbox & "！是否要修改規費？", vbYesNo + vbExclamation) = vbYes Then
                     Cancel = True
                     Exit Sub
                  End If
               End If
               'end 2015/11/4
            Else
            'end 2015/9/9
               'Modify by Morgan 2011/3/8 沒有預繳年費才提醒
               'Modified by Morgan 2021/4/29 +m_lngRefunded=0 (身分變更後預繳年費的減免金額)
               'TwPtRefundAlert m_lngRefund, False
               'If m_lngRefund = 0 Then
               If m_lngRefunded = 0 Then
                  TwPtRefundAlert m_lngRefund, False
               End If
               If m_lngRefund = 0 And m_lngRefund = 0 Then
               'end 2021/4/29
                  'Modify by Morgan 2011/3/2
                  'MsgBox "規費欄位與規定不符，不可直接收文！請確認規費或列印後交櫃台人工收文。", vbExclamation + vbOKOnly
                  If bolShowMsg = True Then
                     'Modified by Morgan 2015/10/28
                     m_Msgbox = "規費欄位與規定不符(注意:為減免退費未退或預繳年費抵扣)"
                     If MsgBox(m_Msgbox & "！是否要修改規費？", vbYesNo + vbExclamation) = vbYes Then
                        Cancel = True
                        Exit Sub
                     End If
                  End If
               End If
            End If 'Added by Morgan 2015/9/9
            bolRuleFeeErr = True
            'Add By Sindy 2022/9/14
            If bolShowMsg = True Then
               If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
                  txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
               End If
            End If
            '2022/9/14 END
         End If
         
         'Add by Morgan 2010/12/13 領證逾期不可自動收文
         If arrCaseProperty(0) = "601" And strDouble = "Y" Then
            'Modify By Sindy 2022/9/14
            m_Msgbox = "領證逾期"
            If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
               txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
            End If
            '2022/9/14 END
            
         'Add by Morgan 2010/12/10
         ElseIf IfDiscFeeNotPaid(pa, strCP81) = True Then  '有減免退費未辦理
            'Modify By Sindy 2022/9/14
            m_Msgbox = "有減免退費未辦理"
            If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
               txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
            End If
            '2022/9/14 END
            
         ElseIf CompDate(1, 6, Val(DBDATE(m_strNP09))) < strSrvDate(1) Then  '年費逾半年者不可直接收文
            'Modify By Sindy 2022/9/14
            m_Msgbox = "年費逾半年"
            If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
               txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
            End If
            '2022/9/14 END
         Else
            'Add by Morgan 2011/3/7
            '若有預繳年費未退也不可收文,但加備註
            TwPtRefundAlert m_lngRefund, False, m_bol919Received 'Modified by Morgan 2021/4/19 +m_bol919Received
            If m_lngRefund > 0 Then
               'Modified by Morgan 2021/4/19
               m_Msgbox = "本案有預繳的減免年費共計 " & Format(m_lngRefund, DDollar) & " 元，可於本次繳年費時一併扣抵" & IIf(m_bol919Received, "(本案已收文減免退費)", "，系統將自動收文(919)減免退費")
'               MsgBox m_Msgbox & "！", vbInformation
               'Modify By Sindy 2022/9/14
               If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
                  txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
               End If
               '2022/9/14 END
               'Add By Sindy 2023/1/11
               If Val(Me.LblCnt.Caption) = 0 Then '防止重覆減免
               '2023/1/11 END
                  Text1(Index - 1) = Text1(Index - 1) - m_lngRefund '費用
                  Text1(Index) = Text1(Index) - m_lngRefund '規費
               End If
               'Add By Sindy 2022/9/16
'               intLblCnt = Val(LblCnt.Caption): If intLblCnt = 0 Then intLblCnt = 1 '記錄案件性質的筆數
               Call cmdUpd_Click '新增
               '2022/9/16 END
               If m_bol919Received = False Then AutoAdd919
               'end 2021/4/19
'               Call GetGridCaseData(intLblCnt)
            End If
         End If
         
'原:T案的自動收文檢查
      'Add By Sindy 2015/8/31 T案 Sindy 2022/9/14拿掉 And m_strST58 = ""
      ElseIf Option1(1).Value = True And _
         Text1(6) = "T" And _
         (arrCaseProperty(0) = "303" Or arrCaseProperty(0) = "201" Or arrCaseProperty(0) = "206" Or arrCaseProperty(0) = "211") Then
         
         strChkNP07 = arrCaseProperty(0)
         If arrCaseProperty(0) = "303" And Frame605.Visible = True And InStr(m_Note2, "延期案件性質:") > 0 Then
            arrNation = Split(Trim(Replace(m_Note2, "延期案件性質:", "")), " ")
            strChkNP07 = arrNation(0)
         End If
         '取得下一程序未收文
         StrSQLa = "Select cp14 From NextProgress,Caseprogress Where " & ChgNextProgress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & _
                   " And Np07='" & strChkNP07 & "' And Np06 is null and Np01=Cp09(+)" & _
                   " Order By NP09 Desc"
         rsA.CursorLocation = adUseClient
         rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
         If rsA.RecordCount > 0 Then
            '檢查人員是否存在或離職
            If ChkStaffST04("" & rsA.Fields("cp14"), False) = True Then
               'Modify by Amy 2018/08/09
               tmpCP14 = rsA.Fields("cp14")
               'end 2018/08/09
            Else
               m_CP14 = rsA.Fields("cp14")
            End If
         Else
            rsA.Close
            '進度檔A,B類最近收文的承辦人
            'Modify By Sindy 2015/9/15 改抓進度檔最大收文日最小總收文號
'            StrSQLa = "Select cp14 From Caseprogress Where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & _
'                      " And Cp09<'C' And Cp57 is null" & _
'                      " Order By CP05 Desc"
            '2016/10/14 Modify By Sindy 踢除承辦人是P22.程序人員
            StrSQLa = "select cp14 From Caseprogress Where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & _
                     " and cp05=(Select nvl(max(cp05),0) From Caseprogress,staff Where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " And cp57 is null and cp14 is not null and cp14=st01(+) and st03<>'P22')" & _
                     " order by cp09 asc"
            rsA.CursorLocation = adUseClient
            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
            If rsA.RecordCount > 0 Then
               rsA.MoveFirst
               '檢查人員是否存在或離職
               If ChkStaffST04("" & rsA.Fields("cp14"), False) = True Then
                  'Modify by Amy 2018/08/09
                  tmpCP14 = rsA.Fields("cp14")
               Else
                  m_CP14 = rsA.Fields("cp14")
               End If
            End If
         End If
         rsA.Close
         Set rsA = Nothing
'         'Add by Amy 2018/08/09 人員離職回圈抓ST52(A4030離職T-213918 收211無法自動收文)
'         If tmpCP14 <> MsgText(601) Then
'            If GetAllST52(tmpCP14, m_CP14) = False Then
'               MsgBox "原承辦人員已離職！"
'               'Modify By Sindy 2022/9/14
'               m_Msgbox = "原承辦人員已離職"
'               If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
'                  txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
'               End If
'               '2022/9/14 END
'            End If
'         End If
      End If
      
      'Modify By Sindy 2022/11/3 Mark,似乎不用檢查了
'      'Add By Sindy 2012/9/26 自動收文時,若案件申請人與收文申請人不同,仍改為人工收文
'      'Modify By Sindy 2022/9/23 + servicepractice,lawcase,hirecase 一同檢查
'      bolChkCustErr = False
'      strSql = "SELECT pa26,pa27,pa28,pa29,pa30 FROM patent WHERE pa01='" & Text1(6) & "' AND pa02='" & Text1(7) & "' AND pa03='" & Text1(8) & "' AND pa04='" & Text1(9) & "' " & _
'         "union SELECT tm23,tm78,tm79,tm80,tm81 FROM trademark WHERE tm01='" & Text1(6) & "' AND tm02='" & Text1(7) & "' AND tm03='" & Text1(8) & "' AND tm04='" & Text1(9) & "' " & _
'         "union SELECT sp08,sp58,sp59,sp65,sp66 FROM servicepractice WHERE sp01='" & Text1(6) & "' AND sp02='" & Text1(7) & "' AND sp03='" & Text1(8) & "' AND sp04='" & Text1(9) & "' " & _
'         "union SELECT lc11,lc43,lc44,lc45,lc46 FROM lawcase WHERE lc01='" & Text1(6) & "' AND lc02='" & Text1(7) & "' AND lc03='" & Text1(8) & "' AND lc04='" & Text1(9) & "' " & _
'         "union SELECT hc05,hc24,hc25,hc26,hc27 FROM hirecase WHERE hc01='" & Text1(6) & "' AND hc02='" & Text1(7) & "' AND hc03='" & Text1(8) & "' AND hc04='" & Text1(9) & "' "
'      intI = 1
'      Set RsTemp = ClsLawReadRstMsg(intI, strSql)
'      If intI = 1 Then
'         If Trim(Text1(12)) <> "" And "" & RsTemp.Fields(0) <> Trim(Text1(12)) Then bolChkCustErr = True
'         If Trim(Text1(28)) <> "" And "" & RsTemp.Fields(1) <> Trim(Text1(28)) Then bolChkCustErr = True
'         If Trim(Text1(44)) <> "" And "" & RsTemp.Fields(2) <> Trim(Text1(44)) Then bolChkCustErr = True
'         If Trim(Text1(60)) <> "" And "" & RsTemp.Fields(3) <> Trim(Text1(60)) Then bolChkCustErr = True
'         If Trim(Text1(76)) <> "" And "" & RsTemp.Fields(4) <> Trim(Text1(76)) Then bolChkCustErr = True
'      End If
'      If bolChkCustErr = True Then
'         If bolShowMsg = True Then
'            MsgBox "案件申請人與收文申請人不同！", vbExclamation + vbOKOnly
'            'Modify By Sindy 2022/9/14
'            m_Msgbox = "案件申請人與收文申請人不同！"
'            If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
'               txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
'            End If
'            '2022/9/14 END
'         End If
'      End If
      
      '非台灣案規費輸入0時,不檢查規費,因有可能是要"事後依代理人請款"
      'Modify By Sindy 2022/12/26 + And HadChkFee = False, B類案源不檢查規費點數
      'If Text1(Index) <> "" And arrNation(0) = "000" Then
      If (Val(Text1(Index)) > 0 Or arrNation(0) = "000") And Left(strLSourceType, 1) <> "B" And HadChkFee = False Then
         'm_strSys=專利(1,5) 商標(2,6) 法務(3,7) 顧問(4,8)
         If m_strSys = "1" Then '專利
            If PUB_CheckExceptFrm010005(Text1(6), arrNation(0), arrCaseProperty(0), strAppl) = False Then
               
               If arrNation(0) = "000" And _
                  ((Text1(6) = "P" Or Text1(6) = "FCP") And InStr("503,507", arrCaseProperty(0)) > 0) Then
                  'If Left(strLSourceType, 1) <> "B" Then 'Added by Morgan 2020/5/14 B類案源不檢查規費點數
                     'Modify By Sindy 2023/2/15 +參數
                     'Modify By Sindy 2025/4/8 傳入案件屬性
                     'Modify By Sindy 2025/4/14 + , IIf(Me.Check10.Value = 0, True, False)
                     If GetCaseMoney(Text1(6), CStr(arrNation(0)), CStr(arrCaseProperty(0)), Val(Text1(Index)), True, , _
                        IIf(Combo6.Visible = True, Left(Combo6, 1), ""), strIDentity, , _
                        IIf(OptChoose(1).Value = True, "2", "1"), Text1(6), Text1(7), Text1(8), Text1(9), _
                        IIf(Combo5.Visible = True, Left(Combo5, 1), ""), IIf(Me.Check10.Value = 0, True, False)) = 0 Then
                        'Modify By Sindy 2025/4/14
                        'Cancel = True
                        If Me.Check10.Value = 1 Then
                           Me.Check10.Tag = "Y" '記錄規費異常
                           Cancel = False
                        Else
                        '2025/4/14 END
                           Cancel = True
                        End If
                        Exit Sub
                     End If
                  'End If 'Added by Morgan 2020/5/14
               End If
               
               If arrNation(0) = "000" Then
                  '台灣發明實審調整規費
                  'Memo by Lydia 2018/02/07 不傳CP118,電子送件後面才算
                  strFee = GetPatentOfficialFee(Text1(6), arrCaseProperty(0), Text1(1), Left(Combo6, 1), arrNation(0), "", , Text1(7), Text1(8), Text1(9))
               End If
               '優先權份數
               'Modify By Sindy 2023/7/18 + And arrCaseProperty(0) = "405",才檢查if裡的程式段
               If Text1(4).Visible = True And arrCaseProperty(0) = "405" Then
                  If Text1(4).Text <> "" Then
                     'Modify By Sindy 2025/4/14 改成共用函數
'                     strExc(0) = "SELECT cf08 FROM CASEFEE WHERE CF01 = '" & Text1(6) & "' AND CF02 = '" & arrNation(0) & "' AND CF03 = '" & arrCaseProperty(0) & "' and cf08>0"
'                     intI = 1
'                     Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                     Call PUB_GetCaseFee_000("", "", "", strExc(1), Text1(6), arrCaseProperty(0))
                     'If intI = 1 Then
                     If Val(strExc(1)) > 0 Then
                     '2025/4/14 END
                        strFee = strExc(1)
                     End If
                     strFee = Val(Text1(4).Text) * Val(strFee)
                  ElseIf arrCaseProperty(0) = "405" Then
                     Exit Sub
                  End If
               End If
               If Val(strFee) > 0 Then
                  If Val(Text1(Index)) <> Val(strFee) Then
                     'Modify By Sindy 2025/4/14 若擬收文之案件規費與系統設定不符，可自行解開規費之設定，自行填入正確之規費
                     If Me.Check10.Value = 1 Then
                        Me.Check10.Tag = "Y" '記錄規費異常
                        Cancel = False
                     Else
                     '2025/4/14 END
                        MsgBox "規費應為<" & strFee & ">", vbExclamation, "檢核資料"
                        Cancel = True
                     End If
                     Exit Sub
                  End If
               'Modified by Lydia 2023/02/10 傳入專利種類
               'ElseIf GetCaseMoney(Text1(6), CStr(arrNation(0)), CStr(arrCaseProperty(0)), Val(Text1(Index)), False, chkEnglish.Value And chkEnglish.Visible) = 0 Then
               'Modify By Sindy 2023/2/15 +參數
               'ElseIf GetCaseMoney(Text1(6), CStr(arrNation(0)), CStr(arrCaseProperty(0)), Val(Text1(Index)), False, chkEnglish.Value And chkEnglish.Visible, IIf(Text1(6) = "P" And Combo6.Visible = True, Left(Combo6, 1), "")) = 0 Then
               'Modify By Sindy 2025/4/8 傳入案件屬性
               'Modify By Sindy 2025/4/14 + , IIf(Me.Check10.Value = 0, True, False)
               ElseIf GetCaseMoney(Text1(6), CStr(arrNation(0)), CStr(arrCaseProperty(0)), Val(Text1(Index)), False, chkEnglish.Value And chkEnglish.Visible, _
                     IIf(Combo6.Visible = True, Left(Combo6, 1), ""), strIDentity, , _
                     IIf(OptChoose(1).Value = True, "2", "1"), Text1(6), Text1(7), Text1(8), Text1(9), _
                     IIf(Combo5.Visible = True, Left(Combo5, 1), ""), IIf(Me.Check10.Value = 0, True, False)) = 0 Then
                  'Modify By Sindy 2025/4/14
                  'Cancel = True
                  If Me.Check10.Value = 1 Then
                     Me.Check10.Tag = "Y" '記錄規費異常
                     Cancel = False
                  Else
                  '2025/4/14 END
                     Cancel = True
                  End If
                  Exit Sub
               End If
               
               '2010/1/6 ADD BY SONIA 台灣發明實審99年起調整規費
               If arrNation(0) = "000" And arrCaseProperty(0) = "416" Then
                  '判斷台灣發明規費
                  If Text1(Index) <> m_416Fee Then
                     If m_416Fee = 7000 Then  '適用99年起新規費
                        m_msg = "適用99年起新規費，規費必須為 7,000元，"
                     Else
                        m_msg = "不適用99年起新規費，規費必須為 8,000元，"
                     End If
                     MsgBox m_msg & "若有超頁費938或超項費939的費用，請另行填寫案件性質 !!!", vbExclamation + vbOKOnly
                     Cancel = True
                     Exit Sub
                  End If
               End If
               '2010/1/6 END
            End If
            
         ElseIf m_strSys = "2" Then '商標
            If arrNation(0) = "000" And _
               ((Text1(6) = "T" Or Text1(6) = "FCT") And InStr("403,408", arrCaseProperty(0)) > 0) Then
               'If Left(strLSourceType, 1) <> "B" Then 'Added by Morgan 2020/5/14 B類案源不檢查規費點數
                  'Modify By Sindy 2023/2/15 +參數
                  'Modify By Sindy 2025/4/8 傳入案件屬性
                  'Modify By Sindy 2025/4/14 + , IIf(Me.Check10.Value = 0, True, False)
                  If GetCaseMoney(Text1(6), CStr(arrNation(0)), CStr(arrCaseProperty(0)), Val(Text1(Index)), True, , _
                     IIf(Combo6.Visible = True, Left(Combo6, 1), ""), strIDentity, , _
                     IIf(OptChoose(1).Value = True, "2", "1"), Text1(6), Text1(7), Text1(8), Text1(9), _
                     IIf(Combo5.Visible = True, Left(Combo5, 1), ""), IIf(Me.Check10.Value = 0, True, False)) = 0 Then
                     'Modify By Sindy 2025/4/14
                     'Cancel = True
                     If Me.Check10.Value = 1 Then
                        Me.Check10.Tag = "Y" '記錄規費異常
                        Cancel = False
                     Else
                     '2025/4/14 END
                        Cancel = True
                     End If
                     Exit Sub
                  End If
               'End If 'Added by Morgan 2020/5/14
            End If
            
            'Add By Sindy 2010/12/31 規費檢查提到存檔前檢查
            HadChkFee = False 'Add By Sindy 2013/12/27
            '郭 請作單 X14843050 不管
            'modify by sonia 2013/11/19 加X3928904,X69514 葉經理
            'modify by sonia 2014/9/11 取消X69514,已轉外專
            If InStr(strAppl, "X1484305") = 0 And InStr(strAppl, "X3928904") = 0 Then
               If Text1(138) <> "" Then
                  tmpArr = Split(IIf(Right(Text1(138), 1) = ",", Mid(Text1(138), 1, Len(Text1(138)) - 1), Text1(138)), ",")
               End If
               If (arrCaseProperty(0) = "501" Or arrCaseProperty(0) = "502") And arrNation(0) = "000" Then
                  If Val(Text1(Index)) <> "2000" Then
                     MsgBox "台灣商標移轉或授權規費為 2000, 請確認！", vbCritical
                     Cancel = True
                     Exit Sub
                  Else
                     HadChkFee = True 'Add By Sindy 2013/12/27
                  End If
               End If
               
               If arrNation(0) = "000" And Text1(138) <> "" Then
                  intMoney = 1
                  'Modify By Sindy 2011/3/14 若系統日的昨天為非工作天, 則以系統日的前一個工作天做比較
                  If ChkWorkDay(DBDATE(DateAdd("d", -1, ChangeWStringToWDateString(strSrvDate(1))))) = False Then
                     If Val(Text1(1)) < (Val(CompWorkDay(1, DBDATE(DateAdd("d", -1, ChangeWStringToWDateString(strSrvDate(1)))), 1)) - 19110000) And Val(Text1(1)) <> 0 Then
                        intMoney = 2
                     End If
                  '2011/3/14 End
                  Else
                     If Val(Text1(1)) < Val(GetTaiwanTodayDate) And Val(Text1(1)) <> 0 Then
                        intMoney = 2
                     End If
                  End If
                  'add by sonia 2021/3/31 台灣舊案延展以基本檔之專用期止日判斷是否過期FCT-029952
                  If arrNation(0) = "000" And Text1(7) <> "" And arrCaseProperty(0) = "102" Then
                     If ChkWorkDay(DBDATE(DateAdd("d", -1, ChangeWStringToWDateString(strSrvDate(1))))) = False Then
                        If Val(m_strTM22) < (Val(CompWorkDay(1, DBDATE(DateAdd("d", -1, ChangeWStringToWDateString(strSrvDate(1)))), 1)) - 19110000) Then
                           intMoney = 2
                        End If
                     Else
                        'modify by sonia 2021/7/20 延展新案修改時會錯誤,故加Val(m_strTM22)>0條件T-234834
                        'If Val(m_strTM22) < Val(GetTodayDate) Then
                        If Val(m_strTM22) > 0 And Val(m_strTM22) < Val(GetTodayDate) Then
                           intMoney = 2
                        End If
                     End If
                  End If
                  'end
                  If arrCaseProperty(0) = "717" Then
                     If Val(Text1(Index)) <> (2500# * (Val(UBound(tmpArr)) + 1) * intMoney) Then
'                       MsgBox "台灣商標全期註冊費規費要" & str(2500# * (Val(UBound(TmpArr)) + 1) * intMoney) & ", 請確認！", vbCritical
                        'Modify By Sindy 2012/6/27 商標修法全期字樣拿掉
                        MsgBox "台灣商標註冊費規費要" & str(2500# * (Val(UBound(tmpArr)) + 1) * intMoney) & ", 請確認！", vbCritical
                        '2012/6/27 End
                        Cancel = True
                        Exit Sub
                     Else
                        HadChkFee = True 'Add By Sindy 2013/12/27
                     End If
                  End If
                  '2014/5/5 modify by sonia 延展新案不檢查
                  If arrCaseProperty(0) = "102" Then
                     'Add By Sindy 2014/2/19
                     '檢查台灣商標延展跨類的規費
                     If arrNation(0) = "000" And (Val(UBound(tmpArr)) + 1) > 1 Then
                        If PUB_ChkTawT102MClassFee(Text1(6), Text1(7), Text1(8), Text1(9), Val(Text1(Index)), Text1(1)) = "N" Then
                           Cancel = True
                           Exit Sub
                        Else
                           HadChkFee = True
                        End If
                     Else
                     '2014/2/19 END
                        If Val(Text1(Index)) <> (4000# * (Val(UBound(tmpArr)) + 1) * intMoney) Then
                           MsgBox "台灣商標延展規費要" & str(4000# * (Val(UBound(tmpArr)) + 1) * intMoney) & ", 請確認！", vbCritical
                           Cancel = True
                           Exit Sub
                        Else
                           HadChkFee = True 'Add By Sindy 2013/12/27
                        End If
                     End If
                  End If
                  If arrCaseProperty(0) = "601" Then
                     If Val(Text1(Index)) <> (4000# * (Val(UBound(tmpArr)) + 1) * intMoney) Then
                        MsgBox "台灣商標異議規費要" & str(4000# * (Val(UBound(tmpArr)) + 1) * intMoney) & ", 請確認！", vbCritical
                        Cancel = True
                        Exit Sub
                     Else
                        HadChkFee = True 'Add By Sindy 2013/12/27
                     End If
                  End If
                  If (arrCaseProperty(0) = "603" Or arrCaseProperty(0) = "605") Then
                     If Val(Text1(Index)) <> (7000# * (Val(UBound(tmpArr)) + 1) * intMoney) Then
                        MsgBox "台灣商標評定或廢止規費要" & str(7000# * (Val(UBound(tmpArr)) + 1) * intMoney) & ", 請確認！", vbCritical
                        Cancel = True
                        Exit Sub
                     Else
                        HadChkFee = True 'Add By Sindy 2013/12/27
                     End If
                  End If
               End If
            End If
            
            '郭 請作單 X14843050 不管
            'modify by sonia 2013/11/19 加X3928904,X69514 葉經理
            'modify by sonia 2014/9/11 取消X69514,已轉外專
            If HadChkFee = False Then 'Add By Sindy 2013/12/27 +if
               If InStr(strAppl, "X1484305") = 0 And InStr(strAppl, "X3928904") = 0 Then
                  If arrNation(0) = "000" Then
                     strFee = GetTrademarkOfficialFee(Text1(6), arrCaseProperty(0), Text1(1))
                  End If
                  If Val(strFee) > 0 Then
                     If Val(Text1(Index)) <> Val(strFee) Then
                        'Modify By Sindy 2025/4/14 若擬收文之案件規費與系統設定不符，可自行解開規費之設定，自行填入正確之規費
                        If Me.Check10.Value = 1 Then
                           Me.Check10.Tag = "Y" '記錄規費異常
                           Cancel = False
                        Else
                        '2025/4/14 END
                           MsgBox "規費應為<" & strFee & ">", vbExclamation, "檢核資料"
                           Cancel = True
                        End If
                        Exit Sub
                     End If
                  End If
                  'Modified by Lydia 2023/02/10 傳入專利種類
                  'If GetCaseMoney(Text1(6), CStr(arrNation(0)), CStr(arrCaseProperty(0)), Val(Text1(Index))) = 0 Then
                  'Modify By Sindy 2023/2/15 +參數
                  'Modify By Sindy 2025/4/8 傳入案件屬性
                  'Modify By Sindy 2025/4/14 + , IIf(Me.Check10.Value = 0, True, False)
                  If GetCaseMoney(Text1(6), CStr(arrNation(0)), CStr(arrCaseProperty(0)), Val(Text1(Index)), , , _
                     IIf(Combo6.Visible = True, Left(Combo6, 1), ""), strIDentity, , _
                     IIf(OptChoose(1).Value = True, "2", "1"), Text1(6), Text1(7), Text1(8), Text1(9), _
                     IIf(Combo5.Visible = True, Left(Combo5, 1), ""), IIf(Me.Check10.Value = 0, True, False)) = 0 Then
                     'Modify By Sindy 2025/4/14
                     'Cancel = True
                     If Me.Check10.Value = 1 Then
                        Me.Check10.Tag = "Y" '記錄規費異常
                        Cancel = False
                     Else
                     '2025/4/14 END
                        Cancel = True
                     End If
                     Exit Sub
                  End If
               End If
            End If '2013/12/27 +if END
            
         Else
            If Not (Text1(6) = "ACS" And arrCaseProperty(0) = "112") Then
               '郭 請作單 X14843050 不管
               'Modify By Sindy 2011/1/18 增加當事人4,5檢查
               'modify by sonia 2013/11/19 加X3928904,X69514 葉經理
               'modify by sonia 2014/9/11 取消X69514,已轉外專
               If InStr(strAppl, "X1484305") = 0 And InStr(strAppl, "X3928904") = 0 Then
                  'Modify By Sindy 2023/2/15 +參數
                  'Modify By Sindy 2025/4/8 傳入案件屬性
                  'Modify By Sindy 2025/4/14 + , IIf(Me.Check10.Value = 0, True, False)
                  If GetCaseMoney(Text1(6), CStr(arrNation(0)), CStr(arrCaseProperty(0)), Val(Text1(Index)), , , _
                     IIf(Combo6.Visible = True, Left(Combo6, 1), ""), strIDentity, , _
                     IIf(OptChoose(1).Value = True, "2", "1"), Text1(6), Text1(7), Text1(8), Text1(9), _
                     IIf(Combo5.Visible = True, Left(Combo5, 1), ""), IIf(Me.Check10.Value = 0, True, False)) = 0 Then
                     'Modify By Sindy 2025/4/14
                     'Cancel = True
                     If Me.Check10.Value = 1 Then
                        Me.Check10.Tag = "Y" '記錄規費異常
                        Cancel = False
                     Else
                     '2025/4/14 END
                        Cancel = True
                     End If
                     Exit Sub
                  End If
               End If
            End If
         End If 'End
         
      End If
   End If
End Sub

'Add by Morgan 2004/1/9
Private Function CheckCaseProperty() As Boolean
   Dim bolReturn As Boolean, ii As Integer
   
   m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/9/8 取得案件性質代碼
   'Modify by Morgan 2011/1/14 移轉,讓與才傳true
   'bolReturn = True
   If (Text1(6) = "P" Or Text1(6) = "FCP" Or Text1(6) = "CFP") Then
'      For ii = 1 To 4
      'Modified by Lydia 2018/07/16 +繼承(703)
      'Modify By Sindy 2023/2/15 +合併(702)
'         If Left(Combo1(ii), 3) = "701" Or Left(Combo1(ii), 3) = "703" Or Left(Combo1(ii), 3) = "708" Then
         If InStr(m_strCaseCPM, "701") > 0 Or InStr(m_strCaseCPM, "702") > 0 Or InStr(m_strCaseCPM, "703") > 0 Or InStr(m_strCaseCPM, "708") > 0 Then
            bolReturn = True
'            Exit For
         End If
'      Next
   ElseIf (Text1(6) = "T" Or Text1(6) = "FCT" Or Text1(6) = "CFT") Then
'      For ii = 1 To 4
'         If Left(Combo1(ii), 3) = "501" Then
         If InStr(m_strCaseCPM, "501") > 0 Then
            bolReturn = True
'            Exit For
         End If
'      Next
   End If
   'end 2011/1/14
   CheckCaseProperty = bolReturn
End Function

'Add By Sindy 2010/5/27
Private Sub ClearFagentTxt()
   Me.Text1(5).Text = ""
   Me.Text1(130).Text = ""
   'Added by Lydia 2019/01/30
   m_FA45 = ""
   m_FA110 = ""
End Sub

Private Sub ClearCustTxt(intTab As Integer)
Dim ii As Integer
   
   m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/8/31 取得案件性質代碼
   'Add By Sindy 2022/11/2
   If Trim(Combo1(1).Text) <> "" Then
      arrCaseProperty = Split(Me.Combo1(1).Text, " ")
      m_strCaseCPM = arrCaseProperty(0) & IIf(m_strCaseCPM <> "", "," & m_strCaseCPM, "")
   End If
   '2022/11/2 END
   
   'Add By Sindy 2017/2/18
   Select Case intTab
   Case 1 '申請人1
      'Add By Sindy 2016/12/8 新案才能點選新客戶
      If Option1(0).Value = True Then '新案
         Option31(0).Enabled = True
         Option31(1).Enabled = True
      Else
         'Modify by Sindy 2017/2/18
         'Modified by Lydia 2018/07/16 +繼承(703)
         'Modify By Sindy 2023/2/15 +合併(702)
         If Option1(1).Value = True And _
            ((Trim(Text1(6).Text) = "P" Or Trim(Text1(6).Text) = "FCP" Or Trim(Text1(6).Text) = "CFP") And _
             (InStr(m_strCaseCPM, "701") > 0 Or InStr(m_strCaseCPM, "702") > 0 Or InStr(m_strCaseCPM, "703") > 0 Or InStr(m_strCaseCPM, "708") > 0) _
            ) Or _
            ((Trim(Text1(6).Text) = "CFT" Or Trim(Text1(6).Text) = "CFC" Or Trim(Text1(6).Text) = "FCT" Or _
              Trim(Text1(6).Text) = "T" Or Trim(Text1(6).Text) = "TB" Or Trim(Text1(6).Text) = "TC" Or _
              Trim(Text1(6).Text) = "TF") And _
             (InStr(m_strCaseCPM, "501") > 0)) Then
            Option31(0).Enabled = True
            Option31(1).Enabled = True
            Option31(0).Value = True 'Add by Amy 2020/04/28 預設新客戶才可輸入編號/名稱 查
         Else
         '2017/2/18 END
            Option31(0).Enabled = False
            Option31(1).Enabled = False
         End If
      End If
      '2016/12/8 END
      ChkCRA26(0).Value = 0 'Add By Sindy 2022/11/9
      ChkCRA27(0).Value = 0 'Add By Sindy 2022/11/9
      For ii = 12 To 17
          Me.Text1(ii).Text = ""
      Next ii
      For ii = 19 To 27
          Me.Text1(ii).Text = ""
      Next ii
      Me.Text1(92).Text = ""
      Me.Text1(92).Enabled = True 'Add By Sindy 2023/3/17 還原為可以輸入狀態
      'add by nickc 2007/05/23
      Text1(120).Text = ""
      'Add By Sindy 2010/5/27
      Text1(34).Text = ""
      Text1(125).Text = ""
      m_CU144(1) = "" 'Add By Sindy 2013/12/16 不可開立發票
   Case 2 '申請人2
      'Add By Sindy 2016/12/8 新案才能點選新客戶
      If Option1(0).Value = True Then '新案
         Option32(0).Enabled = True
         Option32(1).Enabled = True
      Else
         'Modify by Sindy 2017/2/18
         'Modified by Lydia 2018/07/16 +繼承(703)
         'Modify By Sindy 2023/2/15 +合併(702)
         If Option1(1).Value = True And _
            ((Trim(Text1(6).Text) = "P" Or Trim(Text1(6).Text) = "FCP" Or Trim(Text1(6).Text) = "CFP") And _
             (InStr(m_strCaseCPM, "701") > 0 Or InStr(m_strCaseCPM, "702") > 0 Or InStr(m_strCaseCPM, "703") > 0 Or InStr(m_strCaseCPM, "708") > 0) _
            ) Or _
            ((Trim(Text1(6).Text) = "CFT" Or Trim(Text1(6).Text) = "CFC" Or Trim(Text1(6).Text) = "FCT" Or _
              Trim(Text1(6).Text) = "T" Or Trim(Text1(6).Text) = "TB" Or Trim(Text1(6).Text) = "TC" Or _
              Trim(Text1(6).Text) = "TF") And _
             (InStr(m_strCaseCPM, "501") > 0)) Then
            Option32(0).Enabled = True
            Option32(1).Enabled = True
            Option32(0).Value = True 'Add by Amy 2020/04/28 預設新客戶才可輸入編號/名稱 查
         Else
         '2017/2/18 END
            Option32(0).Enabled = False
            Option32(1).Enabled = False
         End If
      End If
      '2016/12/8 END
      ChkCRA26(1).Value = 0 'Add By Sindy 2022/11/9
      ChkCRA27(1).Value = 0 'Add By Sindy 2022/11/9
      For ii = 28 To 33
          Me.Text1(ii).Text = ""
      Next ii
      For ii = 35 To 43
          Me.Text1(ii).Text = ""
      Next ii
      Me.Text1(93).Text = ""
      Me.Text1(93).Enabled = True 'Add By Sindy 2023/3/17 還原為可以輸入狀態
      'add by nickc 2007/05/23
      Text1(121).Text = ""
      'Add By Sindy 2010/5/27
      Text1(50).Text = ""
      Text1(141).Text = ""
      m_CU144(2) = "" 'Add By Sindy 2013/12/16 不可開立發票
   Case 3 '申請人3
      'Add By Sindy 2016/12/8 新案才能點選新客戶
      If Option1(0).Value = True Then '新案
         Option33(0).Enabled = True
         Option33(1).Enabled = True
      Else
         'Modify by Sindy 2017/2/18
         'Modified by Lydia 2018/07/16 +繼承(703)
         'Modify By Sindy 2023/2/15 +合併(702)
         If Option1(1).Value = True And _
            ((Trim(Text1(6).Text) = "P" Or Trim(Text1(6).Text) = "FCP" Or Trim(Text1(6).Text) = "CFP") And _
             (InStr(m_strCaseCPM, "701") > 0 Or InStr(m_strCaseCPM, "702") > 0 Or InStr(m_strCaseCPM, "703") > 0 Or InStr(m_strCaseCPM, "708") > 0) _
            ) Or _
            ((Trim(Text1(6).Text) = "CFT" Or Trim(Text1(6).Text) = "CFC" Or Trim(Text1(6).Text) = "FCT" Or _
              Trim(Text1(6).Text) = "T" Or Trim(Text1(6).Text) = "TB" Or Trim(Text1(6).Text) = "TC" Or _
              Trim(Text1(6).Text) = "TF") And _
             (InStr(m_strCaseCPM, "501") > 0)) Then
            Option33(0).Enabled = True
            Option33(1).Enabled = True
            Option33(0).Value = True 'Add by Amy 2020/04/28 預設新客戶才可輸入編號/名稱 查
         Else
         '2017/2/18 END
            Option33(0).Enabled = False
            Option33(1).Enabled = False
         End If
      End If
      '2016/12/8 END
      ChkCRA26(2).Value = 0 'Add By Sindy 2022/11/9
      ChkCRA27(2).Value = 0 'Add By Sindy 2022/11/9
      For ii = 44 To 49
          Me.Text1(ii).Text = ""
      Next ii
      For ii = 51 To 59
          Me.Text1(ii).Text = ""
      Next ii
      Me.Text1(94).Text = ""
      Me.Text1(94).Enabled = True 'Add By Sindy 2023/3/17 還原為可以輸入狀態
      'add by nickc 2007/05/23
      Text1(122).Text = ""
      'Add By Sindy 2010/5/27
      Text1(66).Text = ""
      Text1(157).Text = ""
      m_CU144(3) = "" 'Add By Sindy 2013/12/16 不可開立發票
   Case 4 '申請人4
      'Add By Sindy 2016/12/8 新案才能點選新客戶
      If Option1(0).Value = True Then '新案
         Option34(0).Enabled = True
         Option34(1).Enabled = True
      Else
         'Modify by Sindy 2017/2/18
         'Modified by Lydia 2018/07/16 +繼承(703)
         'Modify By Sindy 2023/2/15 +合併(702)
         If Option1(1).Value = True And _
            ((Trim(Text1(6).Text) = "P" Or Trim(Text1(6).Text) = "FCP" Or Trim(Text1(6).Text) = "CFP") And _
             (InStr(m_strCaseCPM, "701") > 0 Or InStr(m_strCaseCPM, "702") > 0 Or InStr(m_strCaseCPM, "703") > 0 Or InStr(m_strCaseCPM, "708") > 0) _
            ) Or _
            ((Trim(Text1(6).Text) = "CFT" Or Trim(Text1(6).Text) = "CFC" Or Trim(Text1(6).Text) = "FCT" Or _
              Trim(Text1(6).Text) = "T" Or Trim(Text1(6).Text) = "TB" Or Trim(Text1(6).Text) = "TC" Or _
              Trim(Text1(6).Text) = "TF") And _
             (InStr(m_strCaseCPM, "501") > 0)) Then
            Option34(0).Enabled = True
            Option34(1).Enabled = True
            Option34(0).Value = True 'Add by Amy 2020/04/28 預設新客戶才可輸入編號/名稱 查
         Else
         '2017/2/18 END
            Option34(0).Enabled = False
            Option34(1).Enabled = False
         End If
      End If
      '2016/12/8 END
      ChkCRA26(3).Value = 0 'Add By Sindy 2022/11/9
      ChkCRA27(3).Value = 0 'Add By Sindy 2022/11/9
      For ii = 60 To 65
          Me.Text1(ii).Text = ""
      Next ii
      For ii = 67 To 75
          Me.Text1(ii).Text = ""
      Next ii
      Me.Text1(95).Text = ""
      Me.Text1(95).Enabled = True 'Add By Sindy 2023/3/17 還原為可以輸入狀態
      'add by nickc 2007/05/23
      Text1(123).Text = ""
      'Add By Sindy 2010/5/27
      Text1(82).Text = ""
      Text1(173).Text = ""
      m_CU144(4) = "" 'Add By Sindy 2013/12/16 不可開立發票
   Case 5 '申請人5
      'Add By Sindy 2016/12/8 新案才能點選新客戶
      If Option1(0).Value = True Then '新案
         Option35(0).Enabled = True
         Option35(1).Enabled = True
      Else
         'Modify by Sindy 2017/2/18
         'Modified by Lydia 2018/07/16 +繼承(703)
         'Modify By Sindy 2023/2/15 +合併(702)
         If Option1(1).Value = True And _
            ((Trim(Text1(6).Text) = "P" Or Trim(Text1(6).Text) = "FCP" Or Trim(Text1(6).Text) = "CFP") And _
             (InStr(m_strCaseCPM, "701") > 0 Or InStr(m_strCaseCPM, "702") > 0 Or InStr(m_strCaseCPM, "703") > 0 Or InStr(m_strCaseCPM, "708") > 0) _
            ) Or _
            ((Trim(Text1(6).Text) = "CFT" Or Trim(Text1(6).Text) = "CFC" Or Trim(Text1(6).Text) = "FCT" Or _
              Trim(Text1(6).Text) = "T" Or Trim(Text1(6).Text) = "TB" Or Trim(Text1(6).Text) = "TC" Or _
              Trim(Text1(6).Text) = "TF") And _
             (InStr(m_strCaseCPM, "501") > 0)) Then
            Option35(0).Enabled = True
            Option35(1).Enabled = True
            Option35(0).Value = True 'Add by Amy 2020/04/28 預設新客戶才可輸入編號/名稱 查
         Else
         '2017/2/18 END
            Option35(0).Enabled = False
            Option35(1).Enabled = False
         End If
      End If
      '2016/12/8 END
      ChkCRA26(4).Value = 0 'Add By Sindy 2022/11/9
      ChkCRA27(4).Value = 0 'Add By Sindy 2022/11/9
      For ii = 76 To 81
          Me.Text1(ii).Text = ""
      Next ii
      For ii = 83 To 91
          Me.Text1(ii).Text = ""
      Next ii
      Me.Text1(96).Text = ""
      Me.Text1(96).Enabled = True 'Add By Sindy 2023/3/17 還原為可以輸入狀態
      'add by nickc 2007/05/23
      Text1(124).Text = ""
      'Add By Sindy 2010/5/27
      Text1(98).Text = ""
      Text1(189).Text = ""
      m_CU144(5) = "" 'Add By Sindy 2013/12/16 不可開立發票
   End Select
   'Add by Morgan 2008/8/1
   cboContact(intTab).Clear
   m_strContactList(intTab) = ""
End Sub

'Add By Sindy 2010/5/27
Private Function SetFagentTxt(strCUCode As String) As Boolean
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
   
   SetFagentTxt = False
   strCUCode = Left(strCUCode & "000000000", 9)
   StrSQLa = "Select * From Fagent Where FA01='" & Mid(strCUCode, 1, 8) & "' And FA02='" & Mid(strCUCode, 9, 1) & "' "
   rsA.CursorLocation = adUseClient
   rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
   If rsA.RecordCount > 0 Then
       SetFagentTxt = True
       '代理人
       Me.Text1(5).Text = "" & rsA("FA01").Value & rsA("FA02").Value
       '代理人中文名稱
       'Modified by Morgan 2020/7/2 +判斷查詢語文
       'Me.Text1(130).Text = "" & rsA("FA04").Value
       If strLang = "英" Then
         Me.Text1(130).Text = RTrim(rsA("FA05").Value & " " & rsA("FA63").Value & " " & rsA("FA64").Value & " " & rsA("FA65").Value)
       ElseIf strLang = "日" Then
         Me.Text1(130).Text = "" & rsA("FA06").Value
       ElseIf Not IsNull(rsA("FA04").Value) Then
         Me.Text1(130).Text = "" & rsA("FA04").Value
       ElseIf Not IsNull(rsA("FA05").Value) Then
         Me.Text1(130).Text = RTrim(rsA("FA05").Value & " " & rsA("FA63").Value & " " & rsA("FA64").Value & " " & rsA("FA65").Value)
       Else
         Me.Text1(130).Text = "" & rsA("FA06").Value
       End If
       'end 2020/7/2
       
'       Text1(5).Enabled = False
'       Text1(130).Enabled = False
       'Added by Lydia 2019/01/30 記錄代理人D/N備註
       m_FA45 = "" & rsA.Fields("FA45")
       m_FA110 = "" & rsA.Fields("FA110")
       'end 2019/01/30
   End If
   If rsA.State <> adStateClosed Then rsA.Close
   Set rsA = Nothing
End Function

Private Function SetCustTxt(intTab As Integer, strCUCode As String) As Boolean
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset, i As Integer

SetCustTxt = False
bolCusCAddr(intTab) = False 'Add by Amy 2017/07/12 先輸P-092481接洽單(案件無申請地址)再輸CFT-011714,印出接洽單會有 案件無中文地址但客戶檔有，請通知專業部補輸「案件中文地址」字樣
strCUCode = Left(strCUCode & "000000000", 9)
StrSQLa = "Select * From Customer Where CU01='" & Mid(strCUCode, 1, 8) & "' And CU02='" & Mid(strCUCode, 9, 1) & "' "
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
If intTab = 1 Then m_CU143 = "" 'Add By Sindy 2013/11/20
If rsA.RecordCount > 0 Then
    'Modify by Amy 2020/04/28 依不同頁籤設定,ex: 申請人2查詢 張復龍,會將原來設申請人1-新客戶,改成舊客戶
    Select Case intTab
        Case 1
            Option31(1).Value = True 'Add by Amy 2016/12/23 點新客戶發現為舊客戶,輸入客戶編號後自行點選舊客戶,導致intTWAdd被清空-雅娟
        Case 2
            Option32(1).Value = True
        Case 3
            Option33(1).Value = True
        Case 4
            Option34(1).Value = True
        Case 5
            Option35(1).Value = True
    End Select
    'end 2020/04/28
    SetCustTxt = True
    
    If intTab = 1 Then m_CU143 = "" & rsA("CU143").Value 'Add By Sindy 2013/11/20 預定收款日放寬月數
    m_CU144(intTab) = "" & rsA("CU144").Value 'Add By Sindy 2013/12/16 不可開立發票
    'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅：客戶設定為不開發票CU144='N'者也自動取消收據公司；
    If strSrvDate(1) >= strACSdate1 Then
        If Option1(0).Value = True And Text1(6) = "ACS" Then
            If m_CU144(intTab) = "N" And Combo4.Text <> "" Then
               Combo4.ListIndex = 0
               '填寫到第二頁客戶欄時，若此客戶有設定為不開發票者，因為第一頁之費用已填寫完畢，所以彈訊息提醒「此客戶設定為不開發票，將自動取消收據之智權公司，收費項目之費用、規費、點數欄請再自行調整！」。
               MsgBox "申請人" & intTab & "設定為不開發票，將自動取消收據之智權公司，" & vbCrLf & "收費項目之費用、規費、點數欄請再自行調整！", vbExclamation, "ACS案件收文"
            End If
            
            '重新計算規費和點數
            For intI = 1 To GridCase.Rows - 1 '4
               Call GetGridCaseData(intI)
               Call SetACSautoFee(1, IIf(intTab > 1, "A", "")) 'intI
            Next
        End If
    End If
    'end 2021/03/29
    
    '申請人
    Me.Text1(12 + (intTab - 1) * 16).Text = "" & rsA("CU01").Value & rsA("CU02").Value
'    '接洽人
'    Me.Text1(13 + (intTab - 1) * 16).Text = "" & rsA("CU08").Value
    '電話1
    Me.Text1(14 + (intTab - 1) * 16).Text = "" & rsA("CU16").Value
    'Modified by Lydia 2021/08/26 電話2=> LINE ID
    ''電話2
    'Me.Text1(15 + (intTab - 1) * 16).Text = "" & rsA("CU17").Value
    If Len("" & rsA("CU21").Value) > 20 Then ' 因為LINE ID可存50字, 但是列印最多20字,多出來的用...省略
      Me.Text1(15 + (intTab - 1) * 16).Text = Mid("" & rsA("CU21").Value, 1, 16) & " ..."
    Else
        Me.Text1(15 + (intTab - 1) * 16).Text = "" & rsA("CU21").Value
    End If
    'end 2021/08/26
    '傳真1
    Me.Text1(16 + (intTab - 1) * 16).Text = "" & rsA("CU18").Value
    '傳真2
    Me.Text1(17 + (intTab - 1) * 16).Text = "" & rsA("CU19").Value
    'E-Mail
    Me.Text1(19 + (intTab - 1) * 16).Text = "" & rsA("CU20").Value
    '手機
    Me.Text1(20 + (intTab - 1) * 16).Text = "" & rsA("CU22").Value
    '申請人中文
    'Modified by Lydia 2017/06/19 長度控制
    'Me.Text1(21 + (intTab - 1) * 16).Text = "" & rsA("CU04").Value
    'Modified by Lydia 2017/06/28 + trim 清空白
    'Modified by Lydia 2017/11/20 trim 會造成造字錯誤,拿掉
    'Me.Text1(21 + (intTab - 1) * 16).Text = Trim(IIf(Me.Text1(21 + (intTab - 1) * 16).MaxLength = 0, "" & rsA("CU04").Value, convForm("" & rsA("CU04").Value, Me.Text1(21 + (intTab - 1) * 16).MaxLength)))
    Me.Text1(21 + (intTab - 1) * 16).Text = IIf(Me.Text1(21 + (intTab - 1) * 16).MaxLength = 0, "" & rsA("CU04").Value, PUB_StrToStr("" & rsA("CU04").Value, Me.Text1(21 + (intTab - 1) * 16).MaxLength))
    'Added by Lydia 2017/06/19 記錄客戶檔的名稱
    Me.Text1(21 + (intTab - 1) * 16).Tag = Me.Text1(21 + (intTab - 1) * 16).Text
    '申請人英文
    'Modified by Lydia 2017/06/19 長度控制
    'Me.Text1(22 + (intTab - 1) * 16).Text = "" & rsA("CU05").Value & " " & rsA("CU88").Value & " " & rsA("CU89").Value & " " & rsA("CU90").Value
    'Modified by Lydia 2017/06/28 + trim 清空白
    'Modified by Lydia 2017/11/20 trim 會造成造字錯誤,拿掉
    'Me.Text1(22 + (intTab - 1) * 16).Text = Trim(IIf(Me.Text1(22 + (intTab - 1) * 16).MaxLength = 0, "" & rsA("CU05").Value & " " & rsA("CU88").Value & " " & rsA("CU89").Value & " " & rsA("CU90").Value, convForm("" & rsA("CU05").Value & " " & rsA("CU88").Value & " " & rsA("CU89").Value & " " & rsA("CU90").Value, Me.Text1(22 + (intTab - 1) * 16).MaxLength)))
    Me.Text1(22 + (intTab - 1) * 16).Text = IIf(Me.Text1(22 + (intTab - 1) * 16).MaxLength = 0, "" & rsA("CU05").Value & " " & rsA("CU88").Value & " " & rsA("CU89").Value & " " & rsA("CU90").Value, PUB_StrToStr("" & rsA("CU05").Value & " " & rsA("CU88").Value & " " & rsA("CU89").Value & " " & rsA("CU90").Value, Me.Text1(22 + (intTab - 1) * 16).MaxLength))
    'Added by Lydia 2017/06/19 記錄客戶檔的名稱
    Me.Text1(22 + (intTab - 1) * 16).Tag = Me.Text1(22 + (intTab - 1) * 16).Text

    '代表人1中文
'    If OptChoose(1).Value = True Then
'      Me.Text1(23 + (intTab - 1) * 16).Text = "" & rsA("CU39").Value '代表人1(中)
'    Else
      Me.Text1(23 + (intTab - 1) * 16).Text = "" & rsA("CU07").Value '公司負責人
'    End If
    '代表人1英文
    'Modify by Morgan 2004/4/27
    'Me.Text1(24 + (intTab - 1) * 16).Text = ""
    Me.Text1(24 + (intTab - 1) * 16).Text = "" & rsA("CU103").Value
    '2011/5/18 ADD BY SONIA 若帶出之長度超過16碼X29285(接洽單只能印16碼),則最後二碼改為..
    If GetTextLength("" & rsA("CU103").Value) > 16 Then
      Me.Text1(24 + (intTab - 1) * 16).Text = Left(Me.Text1(24 + (intTab - 1) * 16).Text, 14) & ".."
    End If
    '2011/5/18 END
    ''聯絡地址郵遞區號
    Me.Text1(25 + (intTab - 1) * 16).Text = "" & rsA("CU30").Value
    '聯絡地址
    Me.Text1(26 + (intTab - 1) * 16).Text = "" & rsA("CU31").Value
    '申請地址
    Me.Text1(27 + (intTab - 1) * 16).Text = "" & rsA("CU23").Value
    'ID No.
    Me.Text1(92 + (intTab - 1)).Text = "" & rsA("CU11").Value
    'Add By Sindy 2014/9/11
    Me.Text1(92 + (intTab - 1)).Tag = "" & rsA("CU15").Value '個人或公司
    '2014/9/11 END
    'Add By Sindy 2014/2/6 舊客戶為公司且無統一編號台灣客戶者開放使用者輸入
    'Modify By Sindy 2024/6/27 增加排除境外公司
    Me.Text1(92 + (intTab - 1)).Enabled = False
    If "" & rsA("CU15").Value = "1" And "" & rsA("CU11").Value = "" And "" & rsA("CU10").Value < "010" _
      And "" & rsA("cu158").Value <> "Y" Then
      Me.Text1(92 + (intTab - 1)).Enabled = True
    End If
    '2014/2/6 END
    
    'add by nickc 2006/02/08
    Me.Text1(120 + (intTab - 1)).Text = "" & rsA("CU112").Value
   
    'Add by Morgan 2008/8/1
    'Modified by Morgan 2022/1/20 改2.0
    PUB_AddContact rsA("CU01"), cboContact(intTab), "" & rsA("CU127"), , True, m_strContactList(intTab) '設定接洽人選單
    
    'Add by Amy 2016/01/04 +臺灣新案舊客戶且申請/聯絡地址有值但郵遞區號為空,抓PostZipData 郵遞區號
    If Me.Option1(0).Value = True Then
        '聯絡地址
        If "" & rsA("CU87") < "010" Then
            If Me.Text1(25 + (intTab - 1)) = MsgText(601) And Me.Text1(26 + (intTab - 1) * 16).Text <> MsgText(601) Then
                Me.Text1(25 + (intTab - 1) * 16).Tag = "" & rsA("CU30").Value
                Call SetCusZip(Me.Text1(26 + (intTab - 1) * 16))
            ElseIf Me.Text1(25 + (intTab - 1)) <> MsgText(601) And intTWAddr(intTab * 2 - 1) <> 13 Then '聯絡地址可能抓接洽人檔,抓接洽人檔不需檢查地址
                intTWAddr(intTab * 2 - 1) = 12
                Me.Text1(25 + (intTab - 1) * 16).Tag = ""
            End If
        Else
            intTWAddr(intTab * 2 - 1) = 99
        End If
        '申請地址
        If "" & rsA("CU10") < "010" Then
            If Me.Text1(120 + (intTab - 1)) = MsgText(601) And Me.Text1(27 + (intTab - 1) * 16).Text <> MsgText(601) And intTWAddr(intTab * 2) <> 13 Then
                Me.Text1(120 + (intTab - 1)).Tag = "" & rsA("CU112").Value
                Call SetCusZip(Me.Text1(27 + (intTab - 1) * 16))
            ElseIf Me.Text1(120 + (intTab - 1)) <> MsgText(601) Then
                intTWAddr(intTab * 2) = 12
                Me.Text1(120 + (intTab - 1)).Tag = ""
            End If
        Else
             intTWAddr(intTab * 2) = 99
        End If
    End If
    'end 2016/01/04
    
    'Add By Sindy 2010/5/27
    '國籍
    Me.Text1(34 + (intTab - 1) * 16).Text = GetPrjNationName("" & rsA("CU10").Value)
    '申請地址英文
    'Modify By Sindy 2023/2/8 + & "" & rsA("CU102").Value
    Me.Text1(125 + (intTab - 1) * 16).Text = "" & rsA("CU24").Value & "" & rsA("CU25").Value & "" & rsA("CU26").Value & "" & rsA("CU27").Value & "" & rsA("CU28").Value & "" & rsA("CU102").Value
    '2010/5/27 End
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing

'Add By Sindy 2011/1/21 專利商標的舊案抓案件基本檔的申請地址
'Dim strCAddr As String, strEAddr As String  '2011/10/21 cancel by sonia
Dim bolSetAddr As Boolean

If (Me.Option1(1).Value = True And Me.Text1(6).Text <> "" And Me.Text1(7).Text <> "") Then
   Select Case Me.Text1(6).Text
      '專利
      Case "P", "FCP", "CFP"
         'Add By Sindy 2011/3/3
         bolSetAddr = True
'         For i = 1 To 4
'            If Me.Combo1(i).Text <> "" Then
'               arrCaseProperty = Split(Me.Combo1(i).Text, " ") '案件性質
               'Modified by Lydia 2018/07/16 +繼承(703)
               'Modify By Sindy 2023/2/15 +合併(702)
               If InStr(m_strCaseCPM, "701") > 0 Or InStr(m_strCaseCPM, "702") > 0 Or InStr(m_strCaseCPM, "703") > 0 Or InStr(m_strCaseCPM, "708") > 0 Then
                  bolSetAddr = False
'                  Exit For
               End If
'            End If
'         Next i
         If bolSetAddr = True Then
         '2011/3/3 End
            StrSQLa = "Select * From Patent Where pa01='" & Text1(6) & "' And pa02='" & Text1(7) & "' And pa03='" & Text1(8) & "' And pa04='" & Text1(9) & "' "
            rsA.CursorLocation = adUseClient
            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
            If rsA.RecordCount > 0 Then
               If intTab = 1 Then
                  strCAddr = Trim("" & rsA("pa31").Value)
                  strEAddr = Trim("" & rsA("pa36").Value)
               ElseIf intTab = 2 Then
                  strCAddr = Trim("" & rsA("pa32").Value)
                  strEAddr = Trim("" & rsA("pa37").Value)
               ElseIf intTab = 3 Then
                  strCAddr = Trim("" & rsA("pa33").Value)
                  strEAddr = Trim("" & rsA("pa38").Value)
               ElseIf intTab = 4 Then
                  strCAddr = Trim("" & rsA("pa34").Value)
                  strEAddr = Trim("" & rsA("pa39").Value)
               ElseIf intTab = 5 Then
                  strCAddr = Trim("" & rsA("pa35").Value)
                  strEAddr = Trim("" & rsA("pa40").Value)
               End If
               AddrToZipAddr    '2011/10/21 add by sonia舊案申請地址拆成郵遞區號及地址
               '申請地址
               If Me.Text1(27 + (intTab - 1) * 16) <> MsgText(601) And strCAddr = MsgText(601) Then bolCusCAddr(intTab) = True 'Add by Amy 2016/12/23
               Me.Text1(27 + (intTab - 1) * 16).Text = strCAddr
               '申請地址英文
               Me.Text1(125 + (intTab - 1) * 16).Text = strEAddr
               '中文地址郵遞區號
               '2011/10/21 modify by sonia
               'Me.Text1(120 + (intTab - 1)).Text = "" 'Add By Sindy 2011/3/3
               Me.Text1(120 + (intTab - 1)).Text = strZip
               '2011/10/21 end
               'Mark by Amy 2017/03/30 往下搬
               'intTWAddr(intTab * 2) = 11 'Add by Amy 2015/12/03 舊案舊客戶(申請地址抓案件申請檔無zip獨立欄位)
            End If
            If rsA.State <> adStateClosed Then rsA.Close
            Set rsA = Nothing
         End If
      '商標
      Case "T", "FCT", "CFT", "TF"
         'Add By Sindy 2011/3/3
         bolSetAddr = True
'         For i = 1 To 4
'            If Me.Combo1(i).Text <> "" Then
'               arrCaseProperty = Split(Me.Combo1(i).Text, " ") '案件性質
               If InStr(m_strCaseCPM, "501") > 0 Then
                  bolSetAddr = False
'                  Exit For
               End If
'            End If
'         Next i
         If bolSetAddr = True Then
         '2011/3/3 End
            StrSQLa = "Select * From Trademark Where tm01='" & Text1(6) & "' And tm02='" & Text1(7) & "' And tm03='" & Text1(8) & "' And tm04='" & Text1(9) & "' "
            rsA.CursorLocation = adUseClient
            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
            If rsA.RecordCount > 0 Then
               If intTab = 1 Then
                  strCAddr = Trim("" & rsA("tm24").Value)
                  strEAddr = Trim("" & rsA("tm25").Value)
               ElseIf intTab = 2 Then
                  strCAddr = Trim("" & rsA("tm82").Value)
                  strEAddr = Trim("" & rsA("tm86").Value)
               ElseIf intTab = 3 Then
                  strCAddr = Trim("" & rsA("tm83").Value)
                  strEAddr = Trim("" & rsA("tm87").Value)
               ElseIf intTab = 4 Then
                  strCAddr = Trim("" & rsA("tm84").Value)
                  strEAddr = Trim("" & rsA("tm88").Value)
               ElseIf intTab = 5 Then
                  strCAddr = Trim("" & rsA("tm85").Value)
                  strEAddr = Trim("" & rsA("tm89").Value)
               End If
               AddrToZipAddr    '2011/10/21 add by sonia舊案申請地址拆成郵遞區號及地址
               '申請地址
               If Me.Text1(27 + (intTab - 1) * 16) <> MsgText(601) And strCAddr = MsgText(601) Then bolCusCAddr(intTab) = True 'Add by Amy 2016/12/23
               Me.Text1(27 + (intTab - 1) * 16).Text = strCAddr
               '申請地址英文
               Me.Text1(125 + (intTab - 1) * 16).Text = strEAddr
               '中文地址郵遞區號
               '2011/10/21 modify by sonia
               'Me.Text1(120 + (intTab - 1)).Text = "" 'Add By Sindy 2011/3/3
               Me.Text1(120 + (intTab - 1)).Text = strZip
               '2011/10/21 end
               'Mark by Amy 2017/03/30 往下搬
               'intTWAddr(intTab * 2) = 11 'Add by Amy 2015/12/03 舊案舊客戶
            End If
            If rsA.State <> adStateClosed Then rsA.Close
            Set rsA = Nothing
         End If
   End Select
   'Add by Amy 2017/03/30 舊案舊客戶 都不檢查 ex:LA-003114 會彈申請地址郵遞區號不可空白
    intTWAddr(intTab * 2) = 11 '申請地址抓案件申請檔無zip獨立欄位
End If
'2011/1/21 End

Select Case intTab
Case 1
    stCustNo1 = Me.Text1(12 + (intTab - 1) * 16).Text
    'add by nick 2004/10/05
    If IsoptCP81 = True Then
        Call setCP811
    End If
Case 2
    stCustNo2 = Me.Text1(12 + (intTab - 1) * 16).Text
    'add by nick 2004/10/05
    If IsoptCP81 = True Then
        Call setCP812
    End If
Case 3
    stCustNo3 = Me.Text1(12 + (intTab - 1) * 16).Text
    'add by nick 2004/10/05
    If IsoptCP81 = True Then
        Call setCP813
    End If
Case 4
    stCustNo4 = Me.Text1(12 + (intTab - 1) * 16).Text
    'add by nick 2004/10/05
    If IsoptCP81 = True Then
        Call setCP814
    End If
Case 5
    stCustNo5 = Me.Text1(12 + (intTab - 1) * 16).Text
    'add by nick 2004/10/05
    If IsoptCP81 = True Then
        Call setCP815
    End If
Case Else
End Select
End Function

'Modfiy by Amy 2016/06/24 程式過長出現sub太大錯誤,將檢查拆出,並分類
'CheckDataValidateX:彈訊息無法繼續執行
'CheckDataYNX:訊息為是否選項
'CheckShowMsgX:彈訊息提醒可繼續執行
'彈訊息無法繼續執行
Private Function CheckDataValidate1(Index As Integer) As Boolean
'Dim strStrCompare As String
Dim i As Integer, j As Integer, ii As Integer
Dim blnCancel As Boolean
Dim Cancel As Boolean
'Add by Morgan 2011/1/4
Dim bolEither As Boolean
Dim strErrMsg As String
Dim bolChkChkPointValue As Boolean, strTemp As String, bolNotChkPoint As Boolean 'Add By Sindy 2010/11/22 員工部門別
Dim dblPorint As Double
Dim bolIsChina As Boolean, CheckKeyIn As Integer
Dim varTemp As Variant, strCF03 As String, strCF15 As String
Dim rsA As New ADODB.Recordset
Dim bolOldCust As Boolean 'Add By Sindy 2014/2/6
Dim strChaName As String, strEngName As String 'Add By Sindy 2024/6/27
   
    'Add By Sindy 2012/4/26
    If Combo6.Visible = True Then
        'Modify By Sindy 2023/3/8 取消And Left(Combo1(0).Text, 3) = "000":都要輸入
        If InStr(Text1(6), "T") > 0 Then
            If Combo6.Text = "" Then
                MsgBox "商標種類不可空白!!!", vbExclamation + vbOKOnly
                SSTab1.Tab = 0
                Combo6.SetFocus
                Exit Function
            End If
        End If
        'Add By Sindy 2012/6/6
        If InStr(Text1(6), "P") > 0 Then
            If Combo6.Text = "" Then
                MsgBox "專利種類不可空白!!!", vbExclamation + vbOKOnly
                SSTab1.Tab = 0
                Combo6.SetFocus
                Exit Function
            End If
        End If
        '2012/6/6 End
        Cancel = False
        Combo6_Validate Cancel
        If Cancel = True Then
           SSTab1.Tab = 0
           Combo6.SetFocus
           Exit Function
        End If
    End If
    '2012/4/26 End
    'add by nick 2004/12/07 不能輸入歐盟
    Dim arrNA01
    'edit by nickc 2005/04/06
    If Combo1(0).Text <> "" Then
      arrNA01 = Split(Me.Combo1(0).Text, " ")
      If arrNA01(0) = "221" And (UCase(Trim(Text1(6).Text)) = "T" Or UCase(Trim(Text1(6).Text)) = "CFT" Or UCase(Trim(Text1(6).Text)) = "FCT" Or UCase(Trim(Text1(6).Text)) = "TF") Then
          MsgBox "申請國不能是 EPC !!!", vbExclamation + vbOKOnly
          SSTab1.Tab = 0
          Combo1(0).SetFocus
          Exit Function
      End If
      'Add By Sindy 2025/9/8 加入馬德里一定要是 TF
      'Modify By Sindy 2025/9/26 新案才檢查
      If Option1(0).Value = True Then
      '2025/9/26 END
         If (arrNA01(0) = "238" And Text1(6) <> "TF") Or (arrNA01(0) <> "238" And Text1(6) = "TF") Then
             MsgBox "馬德里必須要收 TF !!!", vbExclamation + vbOKOnly
             SSTab1.Tab = 0
             Combo1(0).SetFocus
             Exit Function
         End If
      End If
      '2025/9/8 END
      
      'Add By Sindy 2024/11/20 於收文新申請案時，不得同時收文416實體審查及215指定費程序
      '，但開放例外為PCT進入EPC階段之案件(畫面上有勾PCT案)
      '一般申請案可收文416實體審查及215指定費的時間
      '，開放於同時收文218回覆檢索報告或已收文回覆檢索報告之後，或於公開後(有公開日)。
      If arrNA01(0) = "221" Then
         If ChkCRL152.Value = 0 Then '若有勾自行送簽核(有先行呈報)走特例流程,除外
            If m_bolNewCase = True Then '新案
               'Modify By Sindy 2024/12/24 杜燕文協理說:分割307案件須剔除，因辦理的時間通常均是無法預設，
               '                           有時已到須同時提申的時間點，再麻煩協助剔除
               If InStr(m_strCaseCPM, "307") = 0 Then
               '2024/12/24 END
                  '為PCT進入EPC階段之案件,除外
                  If ChkPCT.Value = 0 Then
                     If InStr(m_strCaseCPM, "416") > 0 Or InStr(m_strCaseCPM, "215") > 0 Then
                        MsgBox "EPC案於收文新申請案時，不得同時收文實體審查及指定費程序 !!!", vbExclamation + vbOKOnly
                        SSTab1.Tab = 0
                        Exit Function
                     End If
                  End If
               End If
            Else '一般申請案
               If InStr(m_strCaseCPM, "416") > 0 Or InStr(m_strCaseCPM, "215") > 0 Then
                  'Modify By Sindy 2025/1/13
                  '為PCT進入EPC階段之案件,除外 ex:CFP-34894
                  If ChkPCT.Value = 0 Then
                  '2025/1/13 END
                     If InStr(m_strCaseCPM, "218") = 0 Then
                        If Option1(0).Value = True Then
                           MsgBox "EPC一般申請案可收文實體審查及指定費的時間，開放於" & vbCrLf & _
                                  "同時收文回覆檢索報告  或已收文回覆檢索報告之後，或於公開後 !!!", vbExclamation + vbOKOnly
                           SSTab1.Tab = 0
                           Exit Function
                        Else
                           If PUB_ChkCPExist(pa, "218") = False And Val(pa(12)) = 0 Then
                              MsgBox "EPC一般申請案可收文實體審查及指定費的時間，開放於" & vbCrLf & _
                                     "同時收文回覆檢索報告  或已收文回覆檢索報告之後，或於公開後 !!!", vbExclamation + vbOKOnly
                              SSTab1.Tab = 0
                              Exit Function
                           End If
                        End If
                     End If
                  End If
               End If
            End If
         End If
      End If
      '2024/11/20 END
    Else
      MsgBox "申請國家不能空白 !!!", vbExclamation + vbOKOnly
      SSTab1.Tab = 0
      If Combo1(0).Enabled = True Then 'Added by Lydia 2022/05/02
         Combo1(0).SetFocus
      End If
      Exit Function
    End If
    'add end
    
    '員工代號
    If Me.Text1(10).Text = "" Then
        MsgBox "請輸入員工代號!!!", vbExclamation + vbOKOnly
        Me.SSTab1.Tab = 0
        Me.Text1(10).SetFocus
        Exit Function
    'Added by Lydia 2019/02/14 創新業務部人員收文控管
    Else
        Call Text1_Validate(10, blnCancel)
        If blnCancel = True Then
               Me.SSTab1.Tab = 0
               Me.Text1(10).SetFocus
               Exit Function
        End If
    'end 2019/02/14
    End If
    '新案或舊案
    If Me.Option1(0).Value = False And Me.Option1(1).Value = False Then
        MsgBox "請點選本案為新案或舊案!!!", vbExclamation + vbOKOnly
        Me.SSTab1.Tab = 0
        Me.Option1(0).SetFocus
        Exit Function
    End If
    '若為新案
    If Me.Option1(0).Value = True Then
        If Me.Text1(6).Text = "" Then
            MsgBox "請輸入系統類別!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Text1(6).SetFocus
            Exit Function
        End If
    End If
    
    '若為舊案
    If Me.Option1(1).Value = True Then
        If Me.Text1(6).Text = "" Then
            MsgBox "請輸入系統類別!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Text1(6).SetFocus
            Exit Function
        End If
        If Me.Text1(7).Text = "" Then
            MsgBox "請輸入本所案號之流水號!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Text1(7).SetFocus
            Exit Function
        End If
    End If
    '申請國家
    If Me.Combo1(0).Text = "" Then
        MsgBox "請挑選申請國!!!", vbExclamation + vbOKOnly
        Me.SSTab1.Tab = 0
        Me.Combo1(0).SetFocus
        Exit Function
    End If
    arrNation = Split(Me.Combo1(0).Text, " ")
    Select Case Me.Text1(6).Text
    Case "P"
        If arrNation(0) <> "000" And arrNation(0) <> "013" And arrNation(0) <> "020" And arrNation(0) <> "056" And arrNation(0) <> "044" Then
            MsgBox "此申請國之系統類別應為 CFP !!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Combo1(0).SetFocus
            Exit Function
        End If
    Case "T"
        If arrNation(0) <> "000" And arrNation(0) <> "020" Then
            MsgBox "申請國輸入錯誤!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Combo1(0).SetFocus
            Exit Function
        End If
    Case "CFP"
        '2007/7/30 modify by sonia CFP也不能收044,056
        'Modified by Morgan 2013/3/5 056(PCT)改可收
        'If arrNation(0) = "000" Or arrNation(0) = "020" Or arrNation(0) = "044" Or arrNation(0) = "056" Then
        If arrNation(0) = "000" Or arrNation(0) = "020" Or arrNation(0) = "044" Then
            MsgBox "此申請國之系統類別應為 P !!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Combo1(0).SetFocus
            Exit Function
        End If
    Case "CFT"
        If arrNation(0) = "000" Or arrNation(0) = "020" Then
            MsgBox "申請國輸入錯誤!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Combo1(0).SetFocus
            Exit Function
        End If
    'Added by Morgan 2020/8/4
    Case "FCL"
      If arrNation(0) <> "000" Then
         MsgBox "申請國輸入錯誤!!!", vbExclamation + vbOKOnly
         Me.SSTab1.Tab = 0
         Me.Combo1(0).SetFocus
         Exit Function
      End If
    End Select
   'add by nickc 2006/02/24 下列案件性質，一定要收新案
   'CFT 新加坡(014)  的  107
   'P  FCP  CFP  306  307 101-105  801  803  109  110  112-115
   'P 的 904 要收 PS  'cancel by sonia 2020/1/8
   'T 的 101 601 603 605 618  '2007/6/1 加618註冊不當撤銷 BY SONIA
   'P  FCP  CFP  國家為 056 的不能收 101 應收 109
'   arrNation = Split(Me.Combo1(0).Text, " ")
   '2008/10/24 CANCEL BY SONIA 新加坡申請及跨類2007/7/27起已經可以收在一起了
   'If Text1(6).Text = "CFT" And arrNation(0) = "014" And (Trim(Left(Combo1(1).Text, 4)) = "107" Or Trim(Left(Combo1(2).Text, 4)) = "107" Or Trim(Left(Combo1(3).Text, 4)) = "107" Or Trim(Left(Combo1(4).Text, 4)) = "107") And Option1(0).Value = False Then
   '    MsgBox "新加坡跨類請收新案!!!", vbExclamation + vbOKOnly
   '    SSTab1.Tab = 0
   '    Option1(0).SetFocus
   '    Exit Function
   'End If
   '2008/10/24 END
   If (Text1(6).Text = "CFP" Or Text1(6).Text = "P" Or Text1(6).Text = "FCP") And arrNation(0) = "056" And _
      InStr(m_strCaseCPM, "101") > 0 Then
      MsgBox "申請國家為 PCT 時，發明請收 109 !!!", vbExclamation + vbOKOnly
      SSTab1.Tab = 0
      'Me.Combo1(1).SetFocus
      Exit Function
   End If
   If (Text1(6).Text = "CFP" Or Text1(6).Text = "P" Or Text1(6).Text = "FCP") And arrNation(0) = "056" And _
      InStr(m_strCaseCPM, "109") > 0 And _
      Option1(0).Value = False Then
      MsgBox "PCT 發明請收新案!!!", vbExclamation + vbOKOnly
      SSTab1.Tab = 0
      Option1(0).SetFocus
      Exit Function
   End If
'cancel by sonia 2020/1/8
'   If Text1(6).Text = "P" And (Trim(Left(Combo1(1).Text, 4)) = "904" Or Trim(Left(Combo1(2).Text, 4)) = "904" Or Trim(Left(Combo1(3).Text, 4)) = "904" Or Trim(Left(Combo1(4).Text, 4)) = "904") Then
'       MsgBox "專利(P)調卷，請收服務業務(PS) !!!", vbExclamation + vbOKOnly
'       SSTab1.Tab = 0
'       Text1(6).SetFocus
'       Exit Function
'   End If
'end 2020/1/8
   'Modified by Morgan 2012/12/27 +衍生設計125
   'Modified by Lydia 2021/09/10 取消專利案件306改請獨立一定要收新案號的限制
   'Modify By Sindy 2022/10/25 取消 105,125 另外判斷; InStr(m_strCaseCPM, "105") > 0 Or _
            InStr(m_strCaseCPM, "125") > 0 Or
   'Modify By Sindy 2023/4/19 取消CFP之113、114
   If (Text1(6).Text = "CFP" Or Text1(6).Text = "P" Or Text1(6).Text = "FCP") _
      And (InStr(m_strCaseCPM, "101") > 0 Or _
           InStr(m_strCaseCPM, "102") > 0 Or _
           (InStr(m_strCaseCPM, "103") > 0 And InStr(m_strCaseCPM, "105") = 0 And InStr(m_strCaseCPM, "125") = 0) Or _
           InStr(m_strCaseCPM, "104") > 0 Or _
           InStr(m_strCaseCPM, "110") > 0 Or _
           InStr(m_strCaseCPM, "112") > 0 Or _
           InStr(m_strCaseCPM, "115") > 0 Or _
           InStr(m_strCaseCPM, "307") > 0 Or _
           InStr(m_strCaseCPM, "801") > 0 Or _
           InStr(m_strCaseCPM, "803") > 0) And _
      Option1(0).Value = False Then
      
      'Added by Lydia 2021/09/07 修改若舊案只有903專利調查、426新穎性調查時，可以開放收文新申請案的案件性質。
      'Modify By Sindy 2023/8/22 +雅娟:新增912諮詢／評估分析也可以收文新申請案
      strExc(1) = "N"
      If (Text1(6) = "CFP" Or Text1(6) = "P") Then
          strExc(0) = "select count(*) cnt from caseprogress where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Left(Text1(8) & "0", 1) & "' and cp04='" & Left(Text1(9) & "00", 2) & "' " & _
                            "and substr(cp09,1,1)='A' and cp10 not in ('903','426','912') and cp159=0"
          intI = 1
          Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
          If intI = 1 Then
              If Val("" & RsTemp.Fields("cnt")) = 0 Then
                  strExc(1) = "Y"
              End If
          End If
      End If
      'end 2021/09/07
      If strExc(1) <> "Y" Then 'Added by Lydia 2021/09/07 判斷舊案只有903專利調查、426新穎性調查
         'Modified by Lydia 2021/09/10 取消專利案件306改請獨立一定要收新案號的限制; 拿掉”、改請獨立”
         'Modify By Sindy 2022/10/25 取消 105,125
         'MsgBox "專利(P、FCP、CFP)發明、新型、設計、追加、聯合、衍生設計、標準專利紀錄請求、短期專利、CIP、CPA、再發行、分割、異議、舉發，請收新案 !!!", vbExclamation + vbOKOnly
         'Modify By Sindy 2023/4/19 取消CFP之113、114
         'MsgBox "專利(P、FCP、CFP)發明、新型、設計、追加、標準專利紀錄請求、短期專利、CIP、CPA、再發行、分割、異議、舉發，請收新案 !!!", vbExclamation + vbOKOnly
         MsgBox "專利(P、FCP、CFP)發明、新型、設計、追加、標準專利紀錄請求、短期專利、再發行、分割、異議、舉發，請收新案 !!!", vbExclamation + vbOKOnly
         SSTab1.Tab = 0
         Option1(0).SetFocus
         Exit Function
      End If 'Added by Lydia 2021/09/07
   End If
   'Add By Sindy 2022/10/25
   '同一接洽單有案件性質時103及105,125，自動收文105,125收新案且為103案號的-1,-2…..
   'Modify By Sindy 2023/4/19 加入CFP之113、114、122
   If (Text1(6).Text = "CFP" Or Text1(6).Text = "P" Or Text1(6).Text = "FCP") _
      And (InStr(m_strCaseCPM, "105") > 0 Or _
           InStr(m_strCaseCPM, "125") > 0 Or _
           InStr(m_strCaseCPM, "113") > 0 Or _
           InStr(m_strCaseCPM, "114") > 0 Or _
           InStr(m_strCaseCPM, "122") > 0) Then
      'Modify By Sindy 2023/4/19 + Or InStr(m_strCaseCPM, "101") > 0
      If InStr(m_strCaseCPM, "103") > 0 Or InStr(m_strCaseCPM, "101") > 0 Then
         If Option1(0).Value = False Then
            'Modify By Sindy 2023/4/19 加入CFP之113、114、122
            MsgBox "專利(P、FCP、CFP) 聯合(集體設計)、衍生設計、CIP申請、CPA申請、CA申請與" & _
                   IIf(InStr(m_strCaseCPM, "103") > 0, "103設計", IIf(InStr(m_strCaseCPM, "101") > 0, "101發明", "")) & _
                   "同時收文時，請收新案！", vbExclamation + vbOKOnly
            SSTab1.Tab = 0
            'Option1(0).SetFocus
            Exit Function
         End If
      Else
         '接洽單只有105,125沒有103時，一定要用舊案收文，人員填入母案案號，自動收文時105,125收新案且為該母案案號的-1,-2…，要看該案號的集體案收到之幾。
         If Option1(1).Value = False Then
            'Modify By Sindy 2023/4/19 請另加入CFP之113、114、122單獨收文且勾選新案時，
            '彈提醒「母案為本所案件時，請以母案案號收文！」，僅提醒仍可以新案號收文。
            If InStr(m_strCaseCPM, "113") > 0 Or _
               InStr(m_strCaseCPM, "114") > 0 Or _
               InStr(m_strCaseCPM, "122") > 0 Then
               If MsgBox("母案為本所案件時，請以母案案號收文！確認要繼續嗎？", vbCritical + vbYesNo + vbDefaultButton1) = vbNo Then
                  SSTab1.Tab = 0
                  Exit Function
               End If
            Else
               MsgBox "專利(P、FCP、CFP) 聯合(集體設計)、衍生設計單獨收文，請收舊案（請輸入母案案號）！", vbExclamation + vbOKOnly
               SSTab1.Tab = 0
               'Option1(1).SetFocus
               Exit Function
            End If
         ElseIf InStr(m_strCaseCPM, "105") > 0 Or InStr(m_strCaseCPM, "125") > 0 Then
            strExc(0) = "select cp09 from caseprogress where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " and cp10='103' and cp57 is null"
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
            If intI = 0 Then
               MsgBox "此案號未收過設計申請，案號輸入錯誤！", vbExclamation + vbOKOnly
               SSTab1.Tab = 0
               'Option1(1).SetFocus
               Exit Function
            End If
         End If
      End If
   End If
   '2022/10/25 END
   'Add By Sindy 2023/3/17
   If (Text1(6).Text = "CFP" Or Text1(6).Text = "P" Or Text1(6).Text = "FCP") Then
      If arrNation(0) <> 台灣國家代號 Then bolIsChina = True Else bolIsChina = False
      CheckKeyIn = ClsPDGetPatentTrademarkKind(專利, Left(Combo6, 1), strTemp, bolIsChina, CStr(arrNation(0)))
      If CheckKeyIn = 0 Then
         Exit Function
      End If
   End If
   '2023/3/17 END
   
    '主題
    If Me.Text1(11).Text = "" Then
        MsgBox "請輸入主題!!!", vbExclamation + vbOKOnly
        Me.SSTab1.Tab = 0
        Me.Text1(11).SetFocus
        Exit Function
    End If
    
    '案件性質
    'Modify By Sindy 2016/5/11 +判斷新案才要檢查
    If (Me.Text1(6).Text = "T" Or Me.Text1(6).Text = "CFT" Or Me.Text1(6).Text = "FCT") And _
      Option1(0).Value = True Then
'       strStrCompare = "001 查名請改系統類別TS(內商)或S(外商)"
'       If Me.Combo1(1).Text = strStrCompare Or Me.Combo1(2).Text = strStrCompare Or _
'           Me.Combo1(3).Text = strStrCompare Or Me.Combo1(4).Text = strStrCompare Then
        
'        If Trim(Left(Me.Combo1(1).Text, 4)) = "001" Or Trim(Left(Me.Combo1(2).Text, 4)) = "001" Or _
'            Trim(Left(Me.Combo1(3).Text, 4)) = "001" Or Trim(Left(Me.Combo1(4).Text, 4)) = "001" Then
        If InStr(m_strCaseCPM, "001") > 0 Then 'Modify By Sindy 2022/8/31
            MsgBox "查名請改系統類別TS(內商)或S(外商)!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Text1(6).SetFocus
            Text1_GotFocus 6
            Exit Function
        End If
    '2016/5/11 END
    End If
   'If Me.Combo1(1).Text = "" And Me.Combo1(2).Text = "" And Me.Combo1(3).Text = "" And Me.Combo1(4).Text = "" Then
   If m_strCaseCPM = "" Then 'Modify By Sindy 2022/8/31
       MsgBox "請挑選案件性質!!!", vbExclamation + vbOKOnly
       Me.SSTab1.Tab = 0
       Me.Combo1(1).SetFocus
       Exit Function
   Else
      If InStr(m_strCaseCPM, ",") > 0 Then '案件性質1個以上
         arrCaseProperty = Split(m_strCaseCPM, ",")
         For ii = 0 To UBound(arrCaseProperty) - 1
            For j = ii + 1 To UBound(arrCaseProperty)
               If arrCaseProperty(ii) = arrCaseProperty(j) Then
                  'Modify by Amy 2016/09/14 +CFP集體設計/CFT跨類 可重覆
                  'Modify by Amy 2016/12/23 +商標 502授權/504再授權 專利 704授權可重覆
                  'Modify by Sindy 2023/3/24 +ACS 1013抽驗 可重覆
                  'Modify by Sindy 2023/4/19 +CFP之113、114、122可重覆
                  'Modify By Sindy 2024/9/4 +CFT之304.申請英文證明 可重覆
                  If Not (Me.Text1(6).Text = "CFT" And (arrCaseProperty(j) = "107" Or arrCaseProperty(j) = "304")) _
                    And Not (Me.Text1(6).Text = "CFP" And (arrCaseProperty(j) = "105" Or arrCaseProperty(j) = "113" Or arrCaseProperty(j) = "114" Or arrCaseProperty(j) = "122")) _
                    And Not (InStr(Me.Text1(6).Text, "T") > 0 And (arrCaseProperty(j) = "502" Or arrCaseProperty(j) = "504")) _
                    And Not (InStr(Me.Text1(6).Text, "P") > 0 And arrCaseProperty(j) = "704") _
                    And Not (InStr(Me.Text1(6).Text, "ACS") > 0 And arrCaseProperty(j) = "1013") Then
                     MsgBox "案件性質不得重覆!!!", vbExclamation + vbOKOnly
                     Cancel = True
                     Exit Function
                  End If
               End If
            Next j
         Next ii
      End If
   End If
   'Add By Sindy 2023/6/7
   If Me.Text1(6).Text = "T" And InStr(m_strCaseCPM, "102") > 0 And InStr(m_strCaseCPM, "107") > 0 Then
      Me.SSTab1.Tab = 0
      MsgBox "T案延展不可加收跨類!!!", vbExclamation + vbOKOnly
      Cancel = True
      Exit Function
   End If
   '2023/6/7 END
   'Add By Sindy 2023/8/16 檢查案件性質的下一程序是否有同時收文
   varTemp = Split(Trim(m_strCaseCPM), ",")
   txtF0306.Tag = "": strCF15 = ""
   For ii = LBound(varTemp) To UBound(varTemp)
      '抓出CF15下一救濟程序
      strExc(0) = "SELECT * FROM casefee " & _
                  "WHERE cf01='" & Text1(6) & "' AND cf02='" & arrNation(0) & "' AND cf03='" & varTemp(ii) & "' AND cf15 is not null"
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 1 Then
         '下一程序存在於目前此張接洽單的其他案件性質欄位中
         If InStr(m_strCaseCPM, RsTemp.Fields("cf15")) > 0 Then
            strCF15 = RsTemp.Fields("cf15")
         End If
      End If
      '特例處理:
      If strCF15 = "" Then
         If (Text1(6) = "P" Or Text1(6) = "CFP") And InStr(NewCasePtyList & ",801,802,803,804,809", varTemp(ii)) > 0 Then
            If InStr(m_strCaseCPM, "107") > 0 Then strCF15 = "107"
            If InStr(m_strCaseCPM, "601") > 0 Then strCF15 = "601"
         ElseIf (Text1(6) = "T" Or Text1(6) = "CFT") And InStr("101,601,602,603,604,605,606,607,609", varTemp(ii)) > 0 Then
            If InStr(m_strCaseCPM, "401") > 0 Then strCF15 = "401"
            If InStr(m_strCaseCPM, "701") > 0 Then strCF15 = "701"
         End If
      End If
      If strCF15 <> "" Then
         '要加的備註內容
         txtF0306.Tag = txtF0306.Tag & "「" & GetCaseTypeName(Text1(6), varTemp(ii), IIf(arrNation(0) = "000", 0, 1)) & "」及下一程序「" & GetCaseTypeName(Text1(6), strCF15, IIf(arrNation(0) = "000", 0, 1)) & "」欲同時收文;"
      End If
      '再加上不同接洽單的情形控制，但要以反尚方式檢查：
      '用CF15，抓出每一筆的CF03;以本所案號+CF03先抓進度檔，若尚有未發文未取消收文的資料
      If Text1(7) <> "" Then '有案號才須檢查
         strCF03 = ""
         strExc(0) = "SELECT cf03,cp09 FROM casefee,caseprogress " & _
                     "WHERE cf01='" & Text1(6) & "' AND cf02='" & arrNation(0) & "' AND cf15='" & varTemp(ii) & "' AND cf03 is not null " & _
                     "AND cp01='" & Text1(6) & "' AND cp02='" & Text1(7) & "' AND cp03='" & Text1(8) & "' AND cp04='" & Text1(9) & "' " & _
                     "AND cp10=cf03 and cp158=0 and cp159=0 "
         intI = 1
         Set rsA = ClsLawReadRstMsg(intI, strExc(0))
         If intI = 1 Then
            strCF03 = rsA.Fields("cf03")
            '要加的備註內容
            txtF0306.Tag = txtF0306.Tag & "上一程序「" & GetCaseTypeName(Text1(6), strCF03, IIf(arrNation(0) = "000", 0, 1)) & "」尚未發文，「" & GetCaseTypeName(Text1(6), varTemp(ii), IIf(arrNation(0) = "000", 0, 1)) & "」欲同時收文;"
         Else
            '以本所案號+CF03抓接洽記錄單檔尚未收文的案件性質資料
            strExc(0) = "SELECT cf03,CRL01,CRC03,CRC08 FROM casefee,consultrecordlist,consultreccmp " & _
                        "WHERE cf01='" & Text1(6) & "' AND cf02='" & arrNation(0) & "' AND cf15='" & varTemp(ii) & "' AND cf03 is not null " & _
                        "AND CRL07='" & Text1(6) & "' AND CRL08='" & Text1(7) & "' AND CRL09='" & Text1(8) & "' AND CRL10='" & Text1(9) & "' " & _
                        "AND CRL01=CRC01 and CRC03=cf03 and CRC08 is null "
            intI = 1
            Set rsA = ClsLawReadRstMsg(intI, strExc(0))
            If intI = 1 Then
               strCF03 = rsA.Fields("cf03")
               '要加的備註內容
               txtF0306.Tag = txtF0306.Tag & "上一程序「" & GetCaseTypeName(Text1(6), strCF03, IIf(arrNation(0) = "000", 0, 1)) & "」已填接洽單但尚未收文，「" & GetCaseTypeName(Text1(6), varTemp(ii), IIf(arrNation(0) = "000", 0, 1)) & "」欲同時收文;"
            End If
         End If
         '特例處理:
         If strCF03 = "" Then
            If (Text1(6) = "P" Or Text1(6) = "CFP") And (varTemp(ii) = "107" Or varTemp(ii) = "601") Then
               strCF03 = NewCasePtyList & ",801,802,803,804,809"
            ElseIf (Text1(6) = "T" Or Text1(6) = "CFT") And (varTemp(ii) = "401" Or varTemp(ii) = "701") Then
               strCF03 = "101,601,602,603,604,605,606,607,609"
            End If
            If strCF03 <> "" Then
               strExc(0) = "SELECT cp09,cp10 FROM caseprogress " & _
                           "WHERE cp01='" & Text1(6) & "' AND cp02='" & Text1(7) & "' AND cp03='" & Text1(8) & "' AND cp04='" & Text1(9) & "' " & _
                           "AND cp10 in(" & strCF03 & ") and cp158=0 and cp159=0 "
               intI = 1
               Set rsA = ClsLawReadRstMsg(intI, strExc(0))
               If intI = 1 Then
                  '要加的備註內容
                  txtF0306.Tag = txtF0306.Tag & "上一程序「" & GetCaseTypeName(Text1(6), rsA.Fields("cp10"), IIf(arrNation(0) = "000", 0, 1)) & "」尚未發文，「" & GetCaseTypeName(Text1(6), varTemp(ii), IIf(arrNation(0) = "000", 0, 1)) & "」欲同時收文;"
               Else
                  '以本所案號+CF03抓接洽記錄單檔尚未收文的案件性質資料
                  strExc(0) = "SELECT CRL01,CRC03,CRC08 FROM consultrecordlist,consultreccmp " & _
                              "WHERE CRL07='" & Text1(6) & "' AND CRL08='" & Text1(7) & "' AND CRL09='" & Text1(8) & "' AND CRL10='" & Text1(9) & "' " & _
                              "AND CRL01=CRC01 and CRC03 in(" & strCF03 & ") and CRC08 is null "
                  intI = 1
                  Set rsA = ClsLawReadRstMsg(intI, strExc(0))
                  If intI = 1 Then
                     '要加的備註內容
                     txtF0306.Tag = txtF0306.Tag & "上一程序「" & GetCaseTypeName(Text1(6), rsA.Fields("CRC03"), IIf(arrNation(0) = "000", 0, 1)) & "」已填接洽單但尚未收文，「" & GetCaseTypeName(Text1(6), varTemp(ii), IIf(arrNation(0) = "000", 0, 1)) & "」欲同時收文;"
                  End If
               End If
            End If
         End If
      End If
   Next ii
   If txtF0306.Tag <> "" Then
      If ChkCRL152.Value = 0 Then
         MsgBox Replace(txtF0306.Tag, "欲同時收文", "不可同時收文") & " 若必須收文請勾選「自行送簽核」。", vbExclamation + vbOKOnly, "要呈報主管"
         SSTab1.Tab = 0
         Cancel = True
         Exit Function
      End If
   Else
      'Add By Sindy 2023/4/7
      If ChkCRL152.Value = 1 Then
         If MsgBox("已勾選〔自行送簽核〕是否繼續作業？", vbQuestion + vbYesNo + vbDefaultButton2, "要呈報主管") = vbNo Then
            SSTab1.Tab = 0
            Exit Function
         End If
      End If
      '2023/4/7 END
   End If
   '2023/8/16 END
   
   'Added by Lydia 2023/04/11 增加管制CFP、CFT英國脫歐案的第一道收文必須為延展（英國）或委任代理人
   If Option1(1).Value = True And Trim(Left(Combo1(0), 4)) = "239" Then
      If Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "613,") > 0 And InStr("613,444,", Left(m_strCaseCPM, 4)) = 0 Then
         MsgBox "CFP英國脫歐案的第一道收文必須為延展費（英國）或委任代理人", vbExclamation + vbOKOnly
         Cancel = True
         Exit Function
      End If
      If Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "110,") > 0 And InStr("110,710,", Left(m_strCaseCPM, 4)) = 0 Then
         MsgBox "CFT英國脫歐案的第一道收文必須為延展（英國）或委任代理人", vbExclamation + vbOKOnly
         Cancel = True
         Exit Function
      End If
   End If
   'end 2023/04/11
   'Added by Lydia 2023/04/20 CFT緬甸重新申請案：第一道收文必須為101申請
   If Option1(0).Value = True And Text1(6).Text = "CFT" And Trim(Text1(7) & Text1(8) & Text1(9)) = "" _
       And Trim(Left(Combo1(0).Text, 4)) = "048" And InStr(m_strCaseCPM & ",", "101,") > 0 And strCaseNo1 <> "" And strCaseNo2 <> "" Then
       If Left(m_strCaseCPM, 3) <> "101" Then
           MsgBox "CFT緬甸重新申請案的第一道收文必須為申請", vbExclamation + vbOKOnly
           Cancel = True
           Exit Function
       End If
   End If
   'end 2023/04/20
   
   'Add By Sindy 2022/12/24
   If Frame28.Visible = True Then
      If OptEntity(0).Value = False And OptEntity(1).Value = False And OptEntity(2).Value = False Then
         If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
         MsgBox Text1(6) & Trim(Mid(Trim(Combo1(0)), 4)) & "新申請案請點選 " & _
            IIf(OptEntity(0).Visible = True, OptEntity(0).Caption, "") & _
            IIf(OptEntity(1).Visible = True, " 或 " & OptEntity(1).Caption, "") & _
            IIf(OptEntity(2).Visible = True, " 或 " & OptEntity(2).Caption, "") & _
            "！", vbInformation
         Exit Function
      'Modified by Morgan 2024/6/25 +判斷美國案
      'ElseIf OptEntity(2).Value = True And InStr(OptEntity(2).Caption, "微個體") > 0 Then
      ElseIf OptEntity(2).Value = True And InStr(OptEntity(2).Caption, "微個體") > 0 And Left(Trim(Combo1(0).Text), 3) = "101" Then
      'end 2024/6/25
         '申請人
         If Option31(1).Value = True And Text1(12) <> "" Then
            If PUB_CheckMicroEntity(Text1(12), 1, 1) = False Then
               If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
               frm090801_5.Show vbModal
               Exit Function
            End If
         End If
         If Option32(1).Value = True And Text1(28) <> "" Then
            If PUB_CheckMicroEntity(Text1(28), 1, 1) = False Then
               If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
               frm090801_5.Show vbModal
               Exit Function
            End If
         End If
         If Option33(1).Value = True And Text1(44) <> "" Then
            If PUB_CheckMicroEntity(Text1(44), 1, 1) = False Then
               If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
               frm090801_5.Show vbModal
               Exit Function
            End If
         End If
         If Option34(1).Value = True And Text1(60) <> "" Then
            If PUB_CheckMicroEntity(Text1(60), 1, 1) = False Then
               If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
               frm090801_5.Show vbModal
               Exit Function
            End If
         End If
         If Option35(1).Value = True And Text1(76) <> "" Then
            If PUB_CheckMicroEntity(Text1(76), 1, 1) = False Then
               If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
               frm090801_5.Show vbModal
               Exit Function
            End If
         End If
         '發明人
         For intI = 0 To 9
            If PUB_CheckMicroEntity(Text3(intI), 2, 1) = False Then
               If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
               frm090801_5.Show vbModal
               Exit Function
            End If
         Next
         frm090801_5.Show vbModal
      End If
   End If
   '2022/12/24 END
'   'Added by Morgan 2013/3/19
'   '美國新申請案需點選個體別
'   If OptEntity(0).Enabled = True Then
'      'For intI = 1 To 4
'      For ii = 1 To GridCase.Rows - 1
'         'Modify By Sindy 2014/8/12
'         'If Trim(Left(Me.Combo1(1).Text, 4)) = "101" Or Trim(Left(Me.Combo1(1).Text, 4)) = "103" Then
'         If InStr(CaseMapIn, Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4))) > 0 Then
'         '2014/8/12 END
'            Exit For
'         End If
'      Next ii
'      'If intI < 5 Then
'      If ii < GridCase.Rows Then
'         If OptEntity(0).Value = False And OptEntity(1).Value = False And OptEntity(2).Value = False Then
'            If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
'            'MsgBox "CFP美國新申請案請點選個體別！", vbInformation
'            MsgBox Text1(6) & Trim(Mid(Trim(Combo1(0)), 4)) & "新申請案請點選 " & _
'                  IIf(OptEntity(0).Visible = True, OptEntity(0).Caption, "") & _
'                  IIf(OptEntity(1).Visible = True, " 或 " & OptEntity(1).Caption, "") & _
'                  IIf(OptEntity(2).Visible = True, " 或 " & OptEntity(2).Caption, "") & _
'                  "！", vbInformation
'            Exit Function
'         ElseIf OptEntity(2).Value = True Then
'            '申請人
'            If Option31(1).Value = True And Text1(12) <> "" Then
'               If PUB_CheckMicroEntity(Text1(12), 1, 1) = False Then
'                  If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
'                  frm090801_5.Show vbModal
'                  Exit Function
'               End If
'            End If
'            If Option32(1).Value = True And Text1(28) <> "" Then
'               If PUB_CheckMicroEntity(Text1(28), 1, 1) = False Then
'                  If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
'                  frm090801_5.Show vbModal
'                  Exit Function
'               End If
'            End If
'            If Option33(1).Value = True And Text1(44) <> "" Then
'               If PUB_CheckMicroEntity(Text1(44), 1, 1) = False Then
'                  If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
'                  frm090801_5.Show vbModal
'                  Exit Function
'               End If
'            End If
'            If Option34(1).Value = True And Text1(60) <> "" Then
'               If PUB_CheckMicroEntity(Text1(60), 1, 1) = False Then
'                  If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
'                  frm090801_5.Show vbModal
'                  Exit Function
'               End If
'            End If
'            If Option35(1).Value = True And Text1(76) <> "" Then
'               If PUB_CheckMicroEntity(Text1(76), 1, 1) = False Then
'                  If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
'                  frm090801_5.Show vbModal
'                  Exit Function
'               End If
'            End If
'            '發明人
'            For intI = 0 To 9
'               If PUB_CheckMicroEntity(Text3(intI), 2, 1) = False Then
'                  If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
'                  frm090801_5.Show vbModal
'                  Exit Function
'               End If
'            Next
'            frm090801_5.Show vbModal
'         End If
'      ElseIf OptEntity(2).Value = True Then
'         If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
'         MsgBox "非美國發明或設計申請案不可點選微個體！", vbCritical
'         Exit Function
'      End If
'   End If
'   'end 2013/3/19
   
   Call GetstrIDentity 'Add By Sindy 2022/12/24
   'Modify By Sindy 2022/9/1
   m_strCRL146 = 0 '點數低於底價
   For ii = 1 To GridCase.Rows - 1
      If Trim(GridCase.TextMatrix(ii, 1)) <> "" Then
         If Trim(GridCase.TextMatrix(ii, 2)) = "" Then
            Call GetGridCaseData(ii)
            MsgBox "請輸入(第 " & ii & " 筆)費用!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Text1(101).SetFocus
            Exit Function
         Else
            'Add By Sindy 2022/12/30 檢查費用不要高於高標
            Call GetGridCaseData(ii)
            If Val(Format(Trim(GridCase.TextMatrix(ii, 2)), "###0")) > 0 Then
               'Modify By Sindy 2025/4/8 傳入案件屬性
               'Modify By Sindy 2025/8/26 +, Text1(5): 代理人編號
               If ChkPointValue(Trim(Text1(6)), Trim(Left(Trim(Combo1(0)), 3)), Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)), _
                  Format(Trim(GridCase.TextMatrix(ii, 4)), "###0.000"), Trim(Text1(10)), , , IIf(Combo6.Visible = True, Left(Combo6, 1), "") _
                  , strIDentity, , True, Val(Format(Trim(GridCase.TextMatrix(ii, 2)), "###0")), Val(Format(Trim(GridCase.TextMatrix(ii, 3)), "###0")), _
                  m_Msgbox, 1, IIf(OptChoose(1).Value = True, "2", "1"), Text1(6), Text1(7), Text1(8), Text1(9), _
                  IIf(Combo5.Visible = True, Left(Combo5, 1), ""), Text1(5)) = False Then
                  
'                  'Add By Sindy 2023/1/7
'                  If MsgBox(m_Msgbox & "！是否要修改費用？", vbYesNo + vbExclamation) = vbYes Then
'                     Me.SSTab1.Tab = 0
'                     Me.Text1(101).SetFocus
'                     Exit Function
'                  Else
'                     If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
'                        txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
'                     End If
'                  End If
'                  '2023/1/7 END
                  Me.SSTab1.Tab = 0
                  Me.Text1(101).SetFocus
                  Exit Function
               End If
            End If
            '2022/12/30 END
         End If
         If Trim(GridCase.TextMatrix(ii, 3)) = "" Then
            Call GetGridCaseData(ii)
            MsgBox "請輸入(第 " & ii & " 筆)規費!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Text1(102).SetFocus
            Exit Function
         'Add by Morgan 2007/9/7
         Else
            'Add By Sindy 2025/6/11
            If Val(Format(Trim(GridCase.TextMatrix(ii, 3)), "###0")) > 0 And _
               Trim(Text1(6)) = "P" And Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "444" Then
               MsgBox "規費必須為 0，不能有規費！", vbExclamation
               Me.SSTab1.Tab = 0
               Me.Text1(102).SetFocus
               Exit Function
            End If
            '2025/6/11 END
            
            'Modify By Sindy 2015/9/8 將此段程式改為Func,因在Validate不顯示訊息,在按下確定鍵時要顯示訊息
            'Text1_Validate 102, blnCancel
            'Modify By Sindy 2022/9/5 逐筆檢查
            Call GetGridCaseData(ii)
            '2022/9/5 END
            GridCase.TextMatrix(ii, 16) = "" 'Add By Sindy 2025/4/14 預設值
            Call ChkFeeAndAutoRecv(102, blnCancel, True)
            '2015/9/8 END
            If blnCancel = True Then
               Me.SSTab1.Tab = 0
               Me.Text1(102).SetFocus
               Exit Function
            'Modify By Sindy 2025/4/14
            ElseIf Me.Check10.Tag = "Y" Then '記錄規費異常
               GridCase.TextMatrix(ii, 16) = "Y"
               Me.Check10.Tag = "" '恢復預設值
            '2025/4/14 END
            End If
            'Add By Sindy 2010/11/22
            Text1_Validate 103, blnCancel
            If blnCancel = True Then
               Me.SSTab1.Tab = 0
               Me.Text1(103).SetFocus
               Exit Function
            End If
         End If
         'Modify By Sindy 2023/5/29 + 點數要 Format 為 "###0.000"
         If (Val(Trim(Format(GridCase.TextMatrix(ii, 2), "###0"))) - Val(Trim(Format(GridCase.TextMatrix(ii, 3), "###0")))) / 1000 <> Val(Trim(Format(GridCase.TextMatrix(ii, 4), "###0.000"))) Then
            Call GetGridCaseData(ii)
            MsgBox "(第 " & ii & " 筆)費用, 規費或點數輸入錯誤!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Me.Text1(101).SetFocus
            Exit Function
         End If
'*****
         'Modify By Sindy 2022/9/14 檢查點數,從 Text1_Validate(103) 搬過來
         bolChkChkPointValue = True
         bolNotChkPoint = False
         'Added by Lydia 2020/01/13 X38120030寧遠縣碩寧電子有限公司,其大陸年費605不要控制金額
         If Trim(Text1(6)) = "P" And _
            Trim(Left(Combo1(0).Text, 4)) = "020" And _
            InStr(Mid(Text1(12), 1, 8) & "," & Mid(Text1(28), 1, 8) & "," & Mid(Text1(44), 1, 8) & "," & Mid(Text1(60), 1, 8) & "," & Mid(Text1(76), 1, 8), "X3812003") > 0 Then
            If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "605" Then
'                Or _
'                (Index = 106 And Trim(Left(Combo1(2).Text, 4)) = "605") Or _
'                (Index = 109 And Trim(Left(Combo1(3).Text, 4)) = "605") Or _
'                (Index = 112 And Trim(Left(Combo1(4).Text, 4)) = "605")
'               Exit Sub
               bolNotChkPoint = True
            End If
         End If
         'end 2020/01/13
         If bolNotChkPoint = False Then
            '2008/05/30 郭 請作單 X14843050 不管
            'modify by sonia 2013/11/19 加X3928904,X6951400 葉經理
            'Modify By Sindy 2014/9/11 取消X69514控管
   '         If Mid(Text1(12), 1, 8) <> "X1484305" And Mid(Text1(28), 1, 8) <> "X1484305" And Mid(Text1(44), 1, 8) <> "X1484305" And Mid(Text1(60), 1, 8) <> "X1484305" And Mid(Text1(76), 1, 8) <> "X1484305" And _
   '            Mid(Text1(12), 1, 8) <> "X3928904" And Mid(Text1(28), 1, 8) <> "X3928904" And Mid(Text1(44), 1, 8) <> "X3928904" And Mid(Text1(60), 1, 8) <> "X3928904" And Mid(Text1(76), 1, 8) <> "X3928904" And _
   '            Mid(Text1(12), 1, 8) <> "X6951400" And Mid(Text1(28), 1, 8) <> "X6951400" And Mid(Text1(44), 1, 8) <> "X6951400" And Mid(Text1(60), 1, 8) <> "X6951400" And Mid(Text1(76), 1, 8) <> "X6951400" Then
            If Mid(Text1(12), 1, 8) <> "X1484305" And Mid(Text1(28), 1, 8) <> "X1484305" And Mid(Text1(44), 1, 8) <> "X1484305" And Mid(Text1(60), 1, 8) <> "X1484305" And Mid(Text1(76), 1, 8) <> "X1484305" And _
               Mid(Text1(12), 1, 8) <> "X3928904" And Mid(Text1(28), 1, 8) <> "X3928904" And Mid(Text1(44), 1, 8) <> "X3928904" And Mid(Text1(60), 1, 8) <> "X3928904" And Mid(Text1(76), 1, 8) <> "X3928904" Then
            '2014/9/11 END
               '2007/11/5 外專收文之P,CFP案不檢查規費
               If ClsPDGetStaffArea(Trim(Text1(10)), strTemp) Then
                  If strTemp = "F23" And (Trim(Text1(6)) = "P" Or Trim(Text1(6)) = "CFP") Then
                     bolChkChkPointValue = False
                  End If
               End If
               
               'Added by Morgan 2020/5/4 B類案源不檢查規費點數
               If Left(strLSourceType, 1) = "B" Then bolChkChkPointValue = False
               'end 2020/5/4
               
               If bolChkChkPointValue = True Then
   '               'Add By Sindy 2012/3/16
   '               '檢查時間點：規費欄跳離、點數欄跳離、列印時；
   '               '控制：T、台灣、101申請時，若規費欄非 2400, 2700, 3000 時，彈訊息
   '               If index = 103 Then dblMoney = Val(Text1(102))
   '               If index = 106 Then dblMoney = Val(Text1(105))
   '               If index = 109 Then dblMoney = Val(Text1(108))
   '               If index = 112 Then dblMoney = Val(Text1(111))
   '               If Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(Left(Trim(Combo1(intCaseTy)), 4)) = "101" And _
   '                  (dblMoney <> 0 And dblMoney <> 2400 And dblMoney <> 2700 And dblMoney <> 3000) Then
   '                  MsgBox "台灣商標申請案規費不符, 只可為 3,000元, 2,700元, 2,400元, " & vbCrLf & "若有跨類或超項費請分案件性質收文, 跨類代號107, 超項費代號714！", vbExclamation + vbOKOnly
   '                  'Cancel = True
   '                  Exit Sub
   '               End If
   '               '2012/3/16 End
                  If Trim(Text1(6)) <> "" And _
                     Trim(Left(Trim(Combo1(0)), 3)) <> "" And Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) <> "" And Trim(Text1(10)) <> "" Then
                     'Modify By Sindy 2025/4/8 傳入案件屬性
                     'Modify By Sindy 2025/8/26 +, Text1(5): 代理人編號
                     If ChkPointValue(Trim(Text1(6)), Trim(Left(Trim(Combo1(0)), 3)), Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)), _
                        Format(Trim(GridCase.TextMatrix(ii, 4)), "###0.000"), Trim(Text1(10)), False, dblPorint, IIf(Combo6.Visible = True, Left(Combo6, 1), "") _
                        , strIDentity, , , , , , , IIf(OptChoose(1).Value = True, "2", "1"), Text1(6), Text1(7), Text1(8), Text1(9), _
                        IIf(Combo5.Visible = True, Left(Combo5, 1), ""), Text1(5)) = False Then
                        
                        m_strCRL146 = m_strCRL146 + dblPorint 'Add By Sindy 2022/11/4
                        m_Msgbox = "點數低於底價"
'                        MsgBox m_Msgbox & "！呈主管簽核。", vbExclamation + vbOKOnly
                        'Add By Sindy 2022/9/14
                        If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
                           txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
                        End If
                        '2022/9/14 END
                        'Add by Amy 2016/08/09低於底價顯示-專利王副總
                        If InStr(Combo2(0), "低底") = 0 Then
                           GridCase.TextMatrix(ii, 5) = IIf(Len(Trim(GridCase.TextMatrix(ii, 5))) = 0, "低底", Trim(GridCase.TextMatrix(ii, 5)) & ",低底")
                        End If
                        'Cancel = True
                     Else
                        GridCase.TextMatrix(ii, 5) = Replace(Replace(Trim(GridCase.TextMatrix(ii, 5)), ",低底", ""), "低底", "") 'Add by Amy 2016/08/09
                     End If
                  End If
               End If
            End If
         End If
         '2022/9/14 END
'*****
      End If
   Next ii
   Call cmdClear2_Click 'Add By Sindy 2022/9/5 逐筆檢查完畢清空欄位值
   '2022/9/1 END
   'Add By Sindy 2025/7/1 檢查規費程式沒有發現異常,但人員若有勾規費調整,還是要記錄 ex:CFP-35269
   If Me.Check10.Value = 1 Then
      strExc(10) = ""
      For ii = 1 To GridCase.Rows - 1
         If GridCase.TextMatrix(ii, 16) = "Y" Then
            strExc(10) = "Y"
            Exit For
         End If
      Next ii
      If strExc(10) = "" Then
         m_Msgbox = "有勾規費調整"
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
   End If
   '2025/7/1 END
   
'   'Add by Sindy 2014/7/28 本案與總號
'   If Text1(100) <> "" Then
'      Text1_Validate 100, blnCancel
'      If blnCancel = True Then
'         SSTab1.Tab = 1
'         SSTab2.Tab = 0
'         Text1(100).SetFocus
'         Exit Function
'      End If
'   End If
   
   'Add by Morgan 2010/12/24 指定送件日期
   If Text1(126) <> "" Then
      Text1_Validate 126, blnCancel
      If blnCancel = True Then
         Me.SSTab1.Tab = 2
         Me.SSTab3.Tab = 0
         Text1(126).SetFocus
         Exit Function
      End If
   End If
   
'   'Add by Morgan 2011/3/8 預定收款日期
'   If Text1(118) <> "" Then
'      Text1_Validate 118, blnCancel
'      If blnCancel = True Then
'         Me.SSTab1.Tab = 0
'         Text1(118).SetFocus
'         Exit Function
'      End If
'   End If
        
   'Add by Sindy 2012/8/17 優惠期日
   If Text1(128) <> "" Then
      Text1_Validate 128, blnCancel
      If blnCancel = True Then
         Me.SSTab1.Tab = 2
         Me.SSTab3.Tab = 0
         Text1(128).SetFocus
         Exit Function
      End If
   End If
   
   'Add by Sindy 2023/8/30
   '法定期限
   If Text1(1) <> "" And Text1(1).Enabled = True Then
      Text1_Validate 1, blnCancel
      If blnCancel = True Then
         Me.SSTab1.Tab = 0
         Text1(1).SetFocus
         Exit Function
      End If
   End If
   '本所期限
   If Text1(3) <> "" And Text1(3).Enabled = True Then
      Text1_Validate 3, blnCancel
      If blnCancel = True Then
         Me.SSTab1.Tab = 0
         Text1(3).SetFocus
         Exit Function
      End If
   End If
   '2023/8/30 END
   
   '若有費用
   'If Val(Me.Text1(101).Text) > 0 Or Val(Me.Text1(104).Text) > 0 Or Val(Me.Text1(107).Text) > 0 Or Val(Me.Text1(110).Text) > 0 Then
   If Val(m_dblTotRvFee) > 0 Then
      If Me.Option2(0).Value = False And Me.Option2(1).Value = False And Option2(2).Value = False Then
         MsgBox "請點選收據抬頭!!!", vbExclamation + vbOKOnly
         Me.SSTab1.Tab = 0
         Exit Function
      End If
      If Me.Option2(1).Value = True Then
         'Modify by Amy 2020/02/14 +m_stCRL98 = "" ,因勾選特殊收據且有輸抬頭會清空抬頭
         If Me.Text1(115).Text = "" And m_stCRL98 = "" Then
            MsgBox "請點選或輸入收據抬頭!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Exit Function
         End If
      End If
   End If
'   'add by nick 2004/04/29 收據抬頭一定要選
'   If Option2(0).Value = False And Option2(1).Value = False And Option2(2).Value = False Then
'           MsgBox "請點選收據抬頭!!!", vbExclamation + vbOKOnly
'           Me.SSTab1.Tab = 0
'           Exit Function
'   End If
   If Me.Option31(0).Value = True Then
      'edit by nickc 2005/04/13
      'If Me.Option4(0).Value = False And Me.Option4(1).Value = False And Me.Option4(2).Value = False Then
      If Me.Option4(0).Value = False And Me.Option4(1).Value = False And Me.Option4(2).Value = False And Me.Option4(3).Value = False Then
          MsgBox "請點選主動開拓, 客戶介紹或同仁介紹!!!", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Exit Function
      End If
      'Modify By Sindy 2022/10/12 + And Text1(12).Enabled = True
      If Me.Text1(12).Text <> "" And Text1(12).Enabled = True Then
          MsgBox "新客戶不可輸客戶編號!!!", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 0
          Me.Text1(12).SetFocus
          Text1_GotFocus 12
          Exit Function
      End If
   'Added by Lydia 2017/06/19 檢查客戶代號和客戶名稱是否一致
   'Modify by Amy 2018/08/03 名稱有值也要檢查(選錯為舊客戶但只輸申請人名稱-林士堯)
   ElseIf Me.Text1(12) <> "" Or Trim(Me.Text1(21).Text) <> "" Or Trim(Me.Text1(22).Text) <> "" Then
      strErrMsg = ""
      If Trim(Me.Text1(12)) = MsgText(601) Then
        strErrMsg = "客戶編號不可為空!!!"
      Else
         If Mid(Trim(Me.Text1(21).Tag), 1, Len(Trim(Me.Text1(21).Text))) <> Trim(Me.Text1(21).Text) Then
            strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
         ElseIf Mid(Trim(Me.Text1(22).Tag), 1, Len(Trim(Me.Text1(22).Text))) <> Trim(Me.Text1(22).Text) Then
            strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
         'Add By Sindy 2025/11/11 發生舊客戶(X91073000)名稱確是錯的(呈虹食品有限公司)
         Else
            '抓客戶檔名稱(中-->英-->日)
            strExc(10) = GetPrjPeople1(Trim(Me.Text1(12)))
            If strExc(10) <> Trim(Me.Text1(21).Text) And Trim(Me.Text1(21).Text) <> "" Then
               strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
            ElseIf strExc(10) <> Trim(Me.Text1(22).Text) And Trim(Me.Text1(22).Text) <> "" And Trim(Me.Text1(21).Text) = "" Then
               strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
            End If
         '2025/11/11 END
         End If
      End If
      If strErrMsg <> MsgText(601) Then
         MsgBox "申請人1 " & strErrMsg, vbExclamation + vbOKOnly
         Me.SSTab1.Tab = 1
         Me.SSTab2.Tab = 0
         If Text1(12).Enabled = True Then
           Me.Text1(12).SetFocus
           Text1_GotFocus 12
         End If
         Exit Function
      End If
   'end 2017/06/19
      'Add By Sindy 2023/6/19 舊客戶且欄位是開放可以輸入的狀態(ex:舊案的移轉讓與受讓人編號)
      If Me.Text1(12) <> "" And Me.Text1(12).Enabled = True Then
         '若輸入9碼且最後一碼不為"0"
         If Len(Me.Text1(12).Text) = 9 And Right(Me.Text1(12).Text, 1) <> "0" Then
            'Add By Sindy 2024/2/16 修改在收文專利案件P、CFP的分割307時或商標案件T、CFT、TF的分割308時，改為彈訊息並可選擇是或否？
            If ((Text1(6) = "CFT" Or Text1(6) = "T" Or Text1(6) = "TF") And InStr(m_strCaseCPM, "308") > 0) Or _
               ((Text1(6) = "P" Or Text1(6) = "CFP") And InStr(m_strCaseCPM, "307") > 0) Then
               If MsgBox("申請人1為舊名稱編號，分割案確定是要用舊名稱編號收文嗎？", vbInformation + vbYesNo + vbDefaultButton2) = vbNo Then
                  Me.SSTab1.Tab = 1
                  Me.SSTab2.Tab = 0
                  If Text1(12).Enabled = True Then
                     Me.Text1(12).SetFocus
                     Text1_GotFocus 12
                  End If
                  Exit Function
               End If
            Else
            '2024/2/16 END
               MsgBox "此申請人1已變更名稱，請使用新名稱之編號收文!!!", vbExclamation + vbOKOnly
               Me.SSTab1.Tab = 1
               Me.SSTab2.Tab = 0
               If Text1(12).Enabled = True Then
                  Me.Text1(12).SetFocus
                  Text1_GotFocus 12
               End If
               Exit Function
            End If
         End If
      End If
      '2023/6/19 END
   End If
   'add by nickc 2005/04/06 start
   If Option32(0).Value = True Then
      'Add By Sindy 2023/5/19
      If (Trim(Me.Text1(37).Text) <> "" Or Trim(Me.Text1(38).Text) <> "") And Me.Option4(0).Value = False And Me.Option4(1).Value = False And Me.Option4(2).Value = False And Me.Option4(3).Value = False Then
          'Modify By Sindy 2024/12/9 增加訊息內容 (請切到 [申請人1] 填寫上列欄位)
          MsgBox "請點選主動開拓, 客戶介紹或同仁介紹!!!" & vbCrLf & vbCrLf & "(請切到 [申請人1] 填寫上列欄位)", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 0
          Exit Function
      End If
      '2023/5/19 END
      'Modify By Sindy 2022/10/12 + And Text1(28).Enabled = True
      If Me.Text1(28).Text <> "" And Text1(28).Enabled = True Then
          MsgBox "新客戶不可輸客戶編號!!!", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 1
          Me.Text1(28).SetFocus
          Text1_GotFocus 28
          Exit Function
      End If
   'Added by Lydia 2017/06/19 檢查客戶代號和客戶名稱是否一致
   ElseIf Me.Text1(28) <> "" Or Trim(Me.Text1(37).Text) <> "" Or Trim(Me.Text1(38).Text) <> "" Then
      strErrMsg = ""
      If Trim(Me.Text1(28)) = MsgText(601) Then
         strErrMsg = "客戶編號不可為空!!!"
      Else
         If Mid(Trim(Me.Text1(37).Tag), 1, Len(Trim(Me.Text1(37).Text))) <> Trim(Me.Text1(37).Text) Then
            strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
         ElseIf Mid(Trim(Me.Text1(38).Tag), 1, Len(Trim(Me.Text1(38).Text))) <> Trim(Me.Text1(38).Text) Then
            strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
         'Add By Sindy 2025/11/11 發生舊客戶(X91073000)名稱確是錯的(呈虹食品有限公司)
         Else
            '抓客戶檔名稱(中-->英-->日)
            strExc(10) = GetPrjPeople1(Trim(Me.Text1(28)))
            If strExc(10) <> Trim(Me.Text1(37).Text) And Trim(Me.Text1(37).Text) <> "" Then
               strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
            ElseIf strExc(10) <> Trim(Me.Text1(38).Text) And Trim(Me.Text1(38).Text) <> "" And Trim(Me.Text1(37).Text) = "" Then
               strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
            End If
         '2025/11/11 END
         End If
      End If
      If strErrMsg <> MsgText(601) Then
         MsgBox "申請人2 " & strErrMsg, vbExclamation + vbOKOnly
         Me.SSTab1.Tab = 1
         Me.SSTab2.Tab = 1
         Me.Text1(28).SetFocus
         Text1_GotFocus 28
         Exit Function
      End If
   'end 2017/06/19
      'Add By Sindy 2023/6/19 舊客戶且欄位是開放可以輸入的狀態(ex:舊案的移轉讓與受讓人編號)
      If Me.Text1(28) <> "" And Me.Text1(28).Enabled = True Then
         '若輸入9碼且最後一碼不為"0"
         If Len(Me.Text1(28).Text) = 9 And Right(Me.Text1(28).Text, 1) <> "0" Then
            'Add By Sindy 2024/2/16 修改在收文專利案件P、CFP的分割307時或商標案件T、CFT、TF的分割308時，改為彈訊息並可選擇是或否？
            If ((Text1(6) = "CFT" Or Text1(6) = "T" Or Text1(6) = "TF") And InStr(m_strCaseCPM, "308") > 0) Or _
               ((Text1(6) = "P" Or Text1(6) = "CFP") And InStr(m_strCaseCPM, "307") > 0) Then
               If MsgBox("申請人2為舊名稱編號，分割案確定是要用舊名稱編號收文嗎？", vbInformation + vbYesNo + vbDefaultButton2) = vbNo Then
                  Me.SSTab1.Tab = 1
                  Me.SSTab2.Tab = 1
                  If Text1(28).Enabled = True Then
                     Me.Text1(28).SetFocus
                     Text1_GotFocus 28
                  End If
                  Exit Function
               End If
            Else
            '2024/2/16 END
               MsgBox "此申請人2已變更名稱，請使用新名稱之編號收文!!!", vbExclamation + vbOKOnly
               Me.SSTab1.Tab = 1
               Me.SSTab2.Tab = 1
               If Text1(28).Enabled = True Then
                  Me.Text1(28).SetFocus
                  Text1_GotFocus 28
               End If
               Exit Function
            End If
         End If
      End If
      '2023/6/19 END
   End If
   If Option33(0).Value = True Then
      'Add By Sindy 2023/5/19
      If (Trim(Me.Text1(53).Text) <> "" Or Trim(Me.Text1(54).Text) <> "") And Me.Option4(0).Value = False And Me.Option4(1).Value = False And Me.Option4(2).Value = False And Me.Option4(3).Value = False Then
          'Modify By Sindy 2024/12/9 增加訊息內容 (請切到 [申請人1] 填寫上列欄位)
          MsgBox "請點選主動開拓, 客戶介紹或同仁介紹!!!" & vbCrLf & vbCrLf & "(請切到 [申請人1] 填寫上列欄位)", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 0
          Exit Function
      End If
      '2023/5/19 END
      'Modify By Sindy 2022/10/12 + And Text1(44).Enabled = True
      If Me.Text1(44).Text <> "" And Text1(44).Enabled = True Then
          MsgBox "新客戶不可輸客戶編號!!!", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 2
          Me.Text1(44).SetFocus
          Text1_GotFocus 44
          Exit Function
      End If
   'Added by Lydia 2017/06/19 檢查客戶代號和客戶名稱是否一致
   ElseIf Me.Text1(44) <> "" Or Trim(Me.Text1(53).Text) <> "" Or Trim(Me.Text1(54).Text) <> "" Then
      strErrMsg = ""
      If Trim(Me.Text1(44)) = MsgText(601) Then
         strErrMsg = "客戶編號不可為空!!!"
      Else
         If Mid(Trim(Me.Text1(53).Tag), 1, Len(Trim(Me.Text1(53).Text))) <> Trim(Me.Text1(53).Text) Then
            strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
         ElseIf Mid(Trim(Me.Text1(54).Tag), 1, Len(Trim(Me.Text1(54).Text))) <> Trim(Me.Text1(54).Text) Then
            strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
         'Add By Sindy 2025/11/11 發生舊客戶(X91073000)名稱確是錯的(呈虹食品有限公司)
         Else
            '抓客戶檔名稱(中-->英-->日)
            strExc(10) = GetPrjPeople1(Trim(Me.Text1(44)))
            If strExc(10) <> Trim(Me.Text1(53).Text) And Trim(Me.Text1(53).Text) <> "" Then
               strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
            ElseIf strExc(10) <> Trim(Me.Text1(54).Text) And Trim(Me.Text1(54).Text) <> "" And Trim(Me.Text1(53).Text) = "" Then
               strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
            End If
         '2025/11/11 END
         End If
      End If
      If strErrMsg <> MsgText(601) Then
         MsgBox "申請人3 " & strErrMsg, vbExclamation + vbOKOnly
         Me.SSTab1.Tab = 1
         Me.SSTab2.Tab = 2
         Me.Text1(44).SetFocus
         Text1_GotFocus 44
         Exit Function
      End If
   'end 2017/06/19
      'Add By Sindy 2023/6/19 舊客戶且欄位是開放可以輸入的狀態(ex:舊案的移轉讓與受讓人編號)
      If Me.Text1(44) <> "" And Me.Text1(44).Enabled = True Then
         '若輸入9碼且最後一碼不為"0"
         If Len(Me.Text1(44).Text) = 9 And Right(Me.Text1(44).Text, 1) <> "0" Then
            'Add By Sindy 2024/2/16 修改在收文專利案件P、CFP的分割307時或商標案件T、CFT、TF的分割308時，改為彈訊息並可選擇是或否？
            If ((Text1(6) = "CFT" Or Text1(6) = "T" Or Text1(6) = "TF") And InStr(m_strCaseCPM, "308") > 0) Or _
               ((Text1(6) = "P" Or Text1(6) = "CFP") And InStr(m_strCaseCPM, "307") > 0) Then
               If MsgBox("申請人3為舊名稱編號，分割案確定是要用舊名稱編號收文嗎？", vbInformation + vbYesNo + vbDefaultButton2) = vbNo Then
                  Me.SSTab1.Tab = 1
                  Me.SSTab2.Tab = 2
                  If Text1(44).Enabled = True Then
                     Me.Text1(44).SetFocus
                     Text1_GotFocus 44
                  End If
                  Exit Function
               End If
            Else
            '2024/2/16 END
               MsgBox "此申請人3已變更名稱，請使用新名稱之編號收文!!!", vbExclamation + vbOKOnly
               Me.SSTab1.Tab = 1
               Me.SSTab2.Tab = 2
               If Text1(44).Enabled = True Then
                  Me.Text1(44).SetFocus
                  Text1_GotFocus 44
               End If
               Exit Function
            End If
         End If
      End If
      '2023/6/19 END
   End If
   If Option34(0).Value = True Then
      'Add By Sindy 2023/5/19
      If (Trim(Me.Text1(69).Text) <> "" Or Trim(Me.Text1(70).Text) <> "") And Me.Option4(0).Value = False And Me.Option4(1).Value = False And Me.Option4(2).Value = False And Me.Option4(3).Value = False Then
          'Modify By Sindy 2024/12/9 增加訊息內容 (請切到 [申請人1] 填寫上列欄位)
          MsgBox "請點選主動開拓, 客戶介紹或同仁介紹!!!" & vbCrLf & vbCrLf & "(請切到 [申請人1] 填寫上列欄位)", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 0
          Exit Function
      End If
      '2023/5/19 END
      'Modify By Sindy 2022/10/12 + And Text1(60).Enabled = True
      If Me.Text1(60).Text <> "" And Text1(60).Enabled = True Then
          MsgBox "新客戶不可輸客戶編號!!!", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 3
          Me.Text1(60).SetFocus
          Text1_GotFocus 60
          Exit Function
      End If
   'Added by Lydia 2017/06/19 檢查客戶代號和客戶名稱是否一致
   ElseIf Me.Text1(60) <> "" Or Trim(Me.Text1(69).Text) <> "" Or Trim(Me.Text1(70).Text) <> "" Then
      strErrMsg = ""
      If Trim(Me.Text1(60)) = MsgText(601) Then
         strErrMsg = "客戶編號不可為空!!!"
      Else
         If Mid(Trim(Me.Text1(69).Tag), 1, Len(Trim(Me.Text1(69).Text))) <> Trim(Me.Text1(69).Text) Then
            strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
         ElseIf Mid(Trim(Me.Text1(70).Tag), 1, Len(Trim(Me.Text1(70).Text))) <> Trim(Me.Text1(70).Text) Then
            strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
         'Add By Sindy 2025/11/11 發生舊客戶(X91073000)名稱確是錯的(呈虹食品有限公司)
         Else
            '抓客戶檔名稱(中-->英-->日)
            strExc(10) = GetPrjPeople1(Trim(Me.Text1(60)))
            If strExc(10) <> Trim(Me.Text1(69).Text) And Trim(Me.Text1(69).Text) <> "" Then
               strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
            ElseIf strExc(10) <> Trim(Me.Text1(70).Text) And Trim(Me.Text1(70).Text) <> "" And Trim(Me.Text1(69).Text) = "" Then
               strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
            End If
         '2025/11/11 END
         End If
      End If
      If strErrMsg <> MsgText(601) Then
         MsgBox "申請人4 " & strErrMsg, vbExclamation + vbOKOnly
         Me.SSTab1.Tab = 1
         Me.SSTab2.Tab = 3
         Me.Text1(60).SetFocus
         Text1_GotFocus 60
         Exit Function
      End If
   'end 2017/06/19
      'Add By Sindy 2023/6/19 舊客戶且欄位是開放可以輸入的狀態(ex:舊案的移轉讓與受讓人編號)
      If Me.Text1(60) <> "" And Me.Text1(60).Enabled = True Then
         '若輸入9碼且最後一碼不為"0"
         If Len(Me.Text1(60).Text) = 9 And Right(Me.Text1(60).Text, 1) <> "0" Then
            'Add By Sindy 2024/2/16 修改在收文專利案件P、CFP的分割307時或商標案件T、CFT、TF的分割308時，改為彈訊息並可選擇是或否？
            If ((Text1(6) = "CFT" Or Text1(6) = "T" Or Text1(6) = "TF") And InStr(m_strCaseCPM, "308") > 0) Or _
               ((Text1(6) = "P" Or Text1(6) = "CFP") And InStr(m_strCaseCPM, "307") > 0) Then
               If MsgBox("申請人4為舊名稱編號，分割案確定是要用舊名稱編號收文嗎？", vbInformation + vbYesNo + vbDefaultButton2) = vbNo Then
                  Me.SSTab1.Tab = 1
                  Me.SSTab2.Tab = 3
                  If Text1(60).Enabled = True Then
                     Me.Text1(60).SetFocus
                     Text1_GotFocus 60
                  End If
                  Exit Function
               End If
            Else
            '2024/2/16 END
               MsgBox "此申請人4已變更名稱，請使用新名稱之編號收文!!!", vbExclamation + vbOKOnly
               Me.SSTab1.Tab = 1
               Me.SSTab2.Tab = 3
               If Text1(60).Enabled = True Then
                  Me.Text1(60).SetFocus
                  Text1_GotFocus 60
               End If
               Exit Function
            End If
         End If
      End If
      '2023/6/19 END
   End If
   If Option35(0).Value = True Then
      'Add By Sindy 2023/5/19
      If (Trim(Me.Text1(85).Text) <> "" Or Trim(Me.Text1(86).Text) <> "") And Me.Option4(0).Value = False And Me.Option4(1).Value = False And Me.Option4(2).Value = False And Me.Option4(3).Value = False Then
          'Modify By Sindy 2024/12/9 增加訊息內容 (請切到 [申請人1] 填寫上列欄位)
          MsgBox "請點選主動開拓, 客戶介紹或同仁介紹!!!" & vbCrLf & vbCrLf & "(請切到 [申請人1] 填寫上列欄位)", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 0
          Exit Function
      End If
      '2023/5/19 END
      'Modify By Sindy 2022/10/12 + And Text1(76).Enabled = True
      If Me.Text1(76).Text <> "" And Text1(76).Enabled = True Then
          MsgBox "新客戶不可輸客戶編號!!!", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 4
          Me.Text1(76).SetFocus
          Text1_GotFocus 76
          Exit Function
      End If
   'Added by Lydia 2017/06/19 檢查客戶代號和客戶名稱是否一致
   ElseIf Me.Text1(76) <> "" Or Trim(Me.Text1(85).Text) <> "" Or Trim(Me.Text1(86).Text) <> "" Then
      strErrMsg = ""
      If Trim(Me.Text1(76)) = MsgText(601) Then
         strErrMsg = "客戶編號不可為空!!!"
      Else
         If Mid(Trim(Me.Text1(85).Tag), 1, Len(Trim(Me.Text1(85).Text))) <> Trim(Me.Text1(85).Text) Then
            strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
         ElseIf Mid(Trim(Me.Text1(86).Tag), 1, Len(Trim(Me.Text1(86).Text))) <> Trim(Me.Text1(86).Text) Then
            strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
         'Add By Sindy 2025/11/11 發生舊客戶(X91073000)名稱確是錯的(呈虹食品有限公司)
         Else
            '抓客戶檔名稱(中-->英-->日)
            strExc(10) = GetPrjPeople1(Trim(Me.Text1(76)))
            If strExc(10) <> Trim(Me.Text1(85).Text) And Trim(Me.Text1(85).Text) <> "" Then
               strErrMsg = "客戶中文名稱與客戶代號不一致!!!"
            ElseIf strExc(10) <> Trim(Me.Text1(86).Text) And Trim(Me.Text1(86).Text) <> "" And Trim(Me.Text1(85).Text) = "" Then
               strErrMsg = "客戶英文名稱與客戶代號不一致!!!"
            End If
         '2025/11/11 END
         End If
      End If
      If strErrMsg <> MsgText(601) Then
         MsgBox "申請人5 " & strErrMsg, vbExclamation + vbOKOnly
         Me.SSTab1.Tab = 1
         Me.SSTab2.Tab = 4
         Me.Text1(76).SetFocus
         Text1_GotFocus 76
         Exit Function
      End If
   'end 2017/06/19
      'Add By Sindy 2023/6/19 舊客戶且欄位是開放可以輸入的狀態(ex:舊案的移轉讓與受讓人編號)
      If Me.Text1(76) <> "" And Me.Text1(76).Enabled = True Then
         '若輸入9碼且最後一碼不為"0"
         If Len(Me.Text1(76).Text) = 9 And Right(Me.Text1(76).Text, 1) <> "0" Then
            'Add By Sindy 2024/2/16 修改在收文專利案件P、CFP的分割307時或商標案件T、CFT、TF的分割308時，改為彈訊息並可選擇是或否？
            If ((Text1(6) = "CFT" Or Text1(6) = "T" Or Text1(6) = "TF") And InStr(m_strCaseCPM, "308") > 0) Or _
               ((Text1(6) = "P" Or Text1(6) = "CFP") And InStr(m_strCaseCPM, "307") > 0) Then
               If MsgBox("申請人5為舊名稱編號，分割案確定是要用舊名稱編號收文嗎？", vbInformation + vbYesNo + vbDefaultButton2) = vbNo Then
                  Me.SSTab1.Tab = 1
                  Me.SSTab2.Tab = 4
                  If Text1(76).Enabled = True Then
                     Me.Text1(76).SetFocus
                     Text1_GotFocus 76
                  End If
                  Exit Function
               End If
            Else
            '2024/2/16 END
               MsgBox "此申請人5已變更名稱，請使用新名稱之編號收文!!!", vbExclamation + vbOKOnly
               Me.SSTab1.Tab = 1
               Me.SSTab2.Tab = 4
               If Text1(76).Enabled = True Then
                  Me.Text1(76).SetFocus
                  Text1_GotFocus 76
               End If
               Exit Function
            End If
         End If
      End If
      '2023/6/19 END
   End If
   'end 2018/08/03
   
   'Add by Morgan 2011/1/4 大對台或TS的案件可只輸入代理人
   If OptChoose(1).Value = True Or Text1(6) = "TS" Then
      bolEither = True
      strErrMsg = "或代理人"
   Else
      bolEither = False
      strErrMsg = ""
   End If
   'Modify By Sindy 2011/7/11
   If Not (bolEither And Text1(5) <> "") Then
   'end 2011/1/4
      '若為舊客戶
      If Me.Option31(1).Value = True Then
          'Modify By Sindy 2025/5/27 +Trim()去空白,發生人員沒有輸入申請人
          If Trim(Me.Text1(12).Text) = "" And Trim(Me.Text1(28).Text) = "" And _
             Trim(Me.Text1(44).Text) = "" And Trim(Me.Text1(60).Text) = "" And _
             Trim(Me.Text1(76).Text) = "" Then
               MsgBox "請輸入申請人" & strErrMsg & "資料!!!", vbExclamation + vbOKOnly
               Me.SSTab1.Tab = 1
               Me.SSTab2.Tab = 0
               If Me.Text1(12).Enabled = True Then Me.Text1(12).SetFocus
               Exit Function
          End If
      End If
      'Modify By Sindy 2025/5/27 +Trim()去空白,發生人員沒有輸入申請人
      If Trim(Me.Text1(21).Text) & Trim(Me.Text1(22).Text) = "" And _
         Trim(Me.Text1(37).Text) & Trim(Me.Text1(38).Text) = "" And _
         Trim(Me.Text1(53).Text) & Trim(Me.Text1(54).Text) = "" And _
         Trim(Me.Text1(69).Text) & Trim(Me.Text1(70).Text) = "" And _
         Trim(Me.Text1(85).Text) & Trim(Me.Text1(86).Text) = "" Then
          MsgBox "請輸入申請人" & strErrMsg & "資料!!!", vbExclamation + vbOKOnly
          Me.SSTab1.Tab = 1
          Me.SSTab2.Tab = 0
          If Me.Text1(21).Enabled = True Then Me.Text1(21).SetFocus
          Exit Function
      End If
   End If 'Add by Morgan 2011/1/4 大對台或TS的案件可只輸入代理人
   
'   If Me.Text1(21).Text & Me.Text1(22).Text = "" And (Me.Text1(37).Text & Me.Text1(38).Text <> "" Or Me.Text1(53).Text & Me.Text1(54).Text <> "" Or Me.Text1(69).Text & Me.Text1(70).Text <> "") Then
'       MsgBox "請依頁籤順序輸入申請人!!!", vbExclamation + vbOKOnly
'       Me.SSTab1.Tab = 1
'       Exit Function
'   End If
'   If Me.Text1(37).Text & Me.Text1(38).Text = "" And (Me.Text1(53).Text & Me.Text1(54).Text <> "" Or Me.Text1(69).Text & Me.Text1(70).Text <> "") Then
'       MsgBox "請依頁籤順序輸入申請人!!!", vbExclamation + vbOKOnly
'       Me.SSTab1.Tab = 1
'       Exit Function
'   End If
'   If Me.Text1(53).Text & Me.Text1(54).Text = "" And Me.Text1(69).Text & Me.Text1(70).Text <> "" Then
'       MsgBox "請依頁籤順序輸入申請人!!!", vbExclamation + vbOKOnly
'       Me.SSTab1.Tab = 1
'       Exit Function
'   End If
   'Add By Sindy 2014/2/6
   For i = 0 To 4
       If i = 0 Then bolOldCust = Option31(1).Value
       If i = 1 Then bolOldCust = Option32(1).Value
       If i = 2 Then bolOldCust = Option33(1).Value
       If i = 3 Then bolOldCust = Option34(1).Value
       If i = 4 Then bolOldCust = Option35(1).Value
       '舊客戶有客戶編號且統一編號欄位開放可以輸入
       If bolOldCust = True And Trim(Me.Text1(12 + (16 * i)).Text) <> "" And Me.Text1(92 + i).Enabled = True Then
           If Me.Text1(92 + i).Text = "" Then
               SSTab1.Tab = 1
               If i = 0 Then SSTab2.Tab = 0
               If i = 1 Then SSTab2.Tab = 1
               If i = 2 Then SSTab2.Tab = 2
               If i = 3 Then SSTab2.Tab = 3
               If i = 4 Then SSTab2.Tab = 4
               Me.Text1(92 + i).SetFocus
               MsgBox "請輸入統一編號!!!"
               Screen.MousePointer = vbDefault
               Exit Function
               'Modify By Sindy 2014/9/11 Mark
'             Else
'                     If GetTextLength(Me.Text1(92 + i).Text) <> 8 Then
'                        SSTab1.Tab = 1
'                        If i = 0 Then SSTab2.Tab = 0
'                        If i = 1 Then SSTab2.Tab = 1
'                        If i = 2 Then SSTab2.Tab = 2
'                        If i = 3 Then SSTab2.Tab = 3
'                        If i = 4 Then SSTab2.Tab = 4
'                        Me.Text1(92 + i).SetFocus
'                        If MsgBox("統編必須是8碼 ! 請確定 ?", vbYesNo + vbCritical) = vbNo Then
'                           Screen.MousePointer = vbDefault
'                           exit function
'                        End If
'                     End If
'                     If CheckID(1, Me.Text1(92 + i).Text) = False Then
'                        SSTab1.Tab = 1
'                        If i = 0 Then SSTab2.Tab = 0
'                        If i = 1 Then SSTab2.Tab = 1
'                        If i = 2 Then SSTab2.Tab = 2
'                        If i = 3 Then SSTab2.Tab = 3
'                        If i = 4 Then SSTab2.Tab = 4
'                        Me.Text1(92 + i).SetFocus
'                        If MsgBox("統一編號錯誤，是否確定 ?", vbYesNo + vbCritical) = vbNo Then
'                           Screen.MousePointer = vbDefault
'                           exit function
'                        End If
'                     End If
           End If
           '2014/9/11 END
       End If
       'Modify By Sindy 2014/9/11 檢查ID No
       Text1_Validate (92 + i), Cancel
       If Cancel = True Then
           SSTab1.Tab = 1
           If i = 0 Then SSTab2.Tab = 0
           If i = 1 Then SSTab2.Tab = 1
           If i = 2 Then SSTab2.Tab = 2
           If i = 3 Then SSTab2.Tab = 3
           If i = 4 Then SSTab2.Tab = 4
           Me.Text1(92 + i).SetFocus
           Screen.MousePointer = vbDefault
           Exit Function
       End If
       '2014/9/11 END
   Next i
   '2014/2/6 END
   
   'Add By Sindy 2024/6/27
   For i = 1 To 4
     '申請人中or英文名稱,是否有重覆
     strChaName = Trim(Me.Text1(21 + ((i - 1) * 16)).Text)
     strEngName = Trim(Me.Text1(22 + ((i - 1) * 16)).Text)
     For j = i + 1 To 5
        If strChaName = "" And strEngName = "" Then
           If Trim(Me.Text1(21 + ((j - 1) * 16)).Text) <> "" Or _
              Trim(Me.Text1(22 + ((j - 1) * 16)).Text) <> "" Then
              SSTab1.Tab = 1
              SSTab2.Tab = j - 1
              MsgBox "請依頁籤順序輸入申請人!!!"
              Screen.MousePointer = vbDefault
              Exit Function
           End If
        Else
           If Trim(Me.Text1(21 + ((j - 1) * 16)).Text) = strChaName And _
              Trim(Me.Text1(22 + ((j - 1) * 16)).Text) = strEngName Then
              SSTab1.Tab = 1
              SSTab2.Tab = j - 1
              MsgBox "申請人重覆輸入了!!!"
              Screen.MousePointer = vbDefault
              Exit Function
           End If
        End If
     Next j
   Next i
   '2024/6/27 END
   
   'Modify By Sindy 2022/12/23 + And cmdCRL55.Visible = True
   If Me.Text1(100).Text <> "" And cmdCRL55.Visible = True Then
       If Me.Option5(0).Value = False And Me.Option5(1).Value = False Then
           MsgBox "請點選本案與總號相同或有關!!!", vbExclamation + vbOKOnly
           Me.SSTab1.Tab = 1
           Exit Function
       End If
   End If
   
   'edit by nick 2004/08/18 薛和協理談說不要控管
   'Add by Morgan 2004/5/20
   'P 台灣案才檢查
   'If Trim(Text1(6).Text) = "P" And Left(Combo1(0).Text, 3) = "000" Then
   '   'edit by nick 2004/08/05
   ''   If optCP81(0).Value = False And optCP81(1).Value = False Then
   ''      MsgBox "請設定客戶年費減免身分!!!", vbExclamation + vbOKOnly
   ''      Me.SSTab1.Tab = 1
   ''      Exit Function
   ''   End If
   '   If optCP811(0).Value = False And optCP811(1).Value = False Then
   '      MsgBox "請設定客戶年費減免身分!!!", vbExclamation + vbOKOnly
   '      Me.SSTab1.Tab = 1
   '      Exit Function
   '   End If
   '   'add by nick 2004/08/05
   '   If optCP812(0).Value = False And optCP812(1).Value = False Then
   '      MsgBox "請設定客戶年費減免身分!!!", vbExclamation + vbOKOnly
   '      Me.SSTab1.Tab = 2
   '      Exit Function
   '   End If
   '   If optCP813(0).Value = False And optCP813(1).Value = False Then
   '      MsgBox "請設定客戶年費減免身分!!!", vbExclamation + vbOKOnly
   '      Me.SSTab1.Tab = 3
   '      Exit Function
   '   End If
   '   If optCP814(0).Value = False And optCP814(1).Value = False Then
   '      MsgBox "請設定客戶年費減免身分!!!", vbExclamation + vbOKOnly
   '      Me.SSTab1.Tab = 4
   '      Exit Function
   '   End If
   '   If optCP815(0).Value = False And optCP815(1).Value = False Then
   '      MsgBox "請設定客戶年費減免身分!!!", vbExclamation + vbOKOnly
   '      Me.SSTab1.Tab = 5
   '      Exit Function
   '   End If
   'Else
   '   'EDIT BY NICK 2004/07/30 修正
   '   'optCP81(0).Value = False: optCP81(1).Value = False
   '   'edit by nick 2004/08/05
   '   'optCP81(0).Value = False: optCP81(1).Value = True
   '   optCP811(0).Value = False: optCP811(1).Value = True
   '   'add by nick 2004/08/05
   '   optCP812(0).Value = False: optCP812(1).Value = True
   '   optCP813(0).Value = False: optCP813(1).Value = True
   '   optCP814(0).Value = False: optCP814(1).Value = True
   '   optCP815(0).Value = False: optCP815(1).Value = True
   'End If
   
   'add by nickc 2006/07/19 新案分割須先收變更再收分割，舊案直接收分割
   Is308New = False
   Is308Old = False
   If InStr(m_strCaseCPM, "308") > 0 And _
      Trim(Left(Combo1(0).Text, 4)) = "000" And _
      (Text1(6).Text = "T" Or Text1(6).Text = "FCT") Then
       If Option1(0).Value = True Then    '新案
         If GridCase.Rows - 1 < 2 Then
            MsgBox "商標新案分割，必須先收[301 變更(變更代理人)]，再收[308 分割]", vbExclamation
            SSTab1.Tab = 0
            Exit Function
         Else
           If Trim(Left(Trim(GridCase.TextMatrix(1, 1)), 4)) <> "301" And Trim(Left(Trim(GridCase.TextMatrix(2, 1)), 4)) <> "308" Then
               MsgBox "商標新案分割，必須先收[301 變更(變更代理人)]，再收[308 分割]", vbExclamation
               SSTab1.Tab = 0
               'Combo1(1).SetFocus
               Exit Function
           Else
               Is308New = True
           End If
         End If
       Else
           Is308Old = True
       End If
   End If
   
    'Add by Amy 2014/10/08 T案大陸分割控制
    If Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6).Text = "T" Then
        If Option1(0).Value = True Then
            'For ii = 1 To 4
            For ii = 1 To GridCase.Rows - 1
                If Trim(GridCase.TextMatrix(ii, 1)) <> "" Then
                    arrCaseProperty = Split(Trim(GridCase.TextMatrix(ii, 1)), " ")
                    If arrCaseProperty(0) = "308" Then
                        Is308New = True
                        intCN308Field = ii
                        Exit For
                    End If
                End If
            Next ii
            '母案非本所案件(選新案)第一個先收變更、第二個收復審，再收分割
            If Is308New = True Then
               If GridCase.Rows - 1 < 3 Then
                  MsgBox "商標大陸案分割，第一個先收[301 變更(變更代理人)]" & vbCrLf & "第二個收[401 復審]，第三個收[308 分割]", vbExclamation
                  SSTab1.Tab = 0
                  Exit Function
               Else
                  If Not (Trim(Left(Trim(GridCase.TextMatrix(1, 1)), 4)) = "301" And Trim(Left(Trim(GridCase.TextMatrix(2, 1)), 4)) = "401" And Trim(Left(Trim(GridCase.TextMatrix(3, 1)), 4)) = "308") Then
                     MsgBox "商標大陸案分割，第一個先收[301 變更(變更代理人)]" & vbCrLf & "第二個收[401 復審]，第三個收[308 分割]", vbExclamation
                     SSTab1.Tab = 0
                     'Combo1(1).SetFocus
                     Exit Function
                  End If
               End If
            End If
        Else
            '母案為本所案件(選舊案)一定要有收復審
            strExc(0) = ""
            'For ii = 1 To 4
            For ii = 1 To GridCase.Rows - 1
                If Trim(GridCase.TextMatrix(ii, 1)) <> "" Then
                    arrCaseProperty = Split(Trim(GridCase.TextMatrix(ii, 1)), " ")
                    If arrCaseProperty(0) = "308" Then Is308Old = True: intCN308Field = ii
                    If arrCaseProperty(0) = "401" Then strExc(0) = "Y"
                End If
            Next ii
            If Is308Old = True And strExc(0) <> "Y" Then
                MsgBox "商標大陸案分割，一定要有收[401 復審]", vbExclamation
                SSTab1.Tab = 0
                'Combo1(1).SetFocus
                Exit Function
            End If
        End If
        
        '大陸分割案法定期限本所期限必填
        If Is308New = True Or Is308Old = True Then
            If Text1(1) = "" Then
                MsgBox "法定期限" & MsgText(52), vbExclamation
                SSTab1.Tab = 0
                Text1(1).SetFocus
                Exit Function
            End If
            If Text1(3) = "" Then
                MsgBox "本所期限" & MsgText(52), vbExclamation
                SSTab1.Tab = 0
                Text1(3).SetFocus
                Exit Function
            End If
        End If
   End If
   'end 2014/10/08
   
   'Add By Sindy 2013/5/16 T,TF,CFT案,不管新案或舊案,若案件性質有 102延展 或 717註冊費 時,一定要輸本所期限及法定期限
    If Trim(Text1(6)) = "T" Or Trim(Text1(6)) = "TF" Or Trim(Text1(6)) = "CFT" Then
      'Modify By Sindy 2023/3/8 當CFT收文之案件性質為「使用宣誓」，請在收文時設提醒：「收文案件性質為使用宣誓，法定期限不可空白」
      If InStr(m_strCaseCPM, "102") > 0 Or _
         InStr(m_strCaseCPM, "717") > 0 Or _
         (Trim(Text1(6)) = "CFT" And InStr(m_strCaseCPM, "105") > 0) Then
         If Trim(Text1(1)) = "" Or Trim(Text1(3)) = "" Then
            MsgBox "請輸入本所期限及法定期限!!!", vbExclamation + vbOKOnly
            SSTab1.Tab = 0
            If Trim(Text1(1)) = "" Then
               Text1(1).SetFocus
            Else
               Text1(3).SetFocus
            End If
            Screen.MousePointer = vbDefault
            Exit Function
         End If
      End If
   End If
   'end 2013/05/16
   
   'Add By Sindy 2015/4/1 有「延期」時一定要輸入本所期限及法定期限
   If ((Trim(Text1(6)) = "P" Or Trim(Text1(6)) = "CFP") And InStr(m_strCaseCPM, "404") > 0) Or _
       ((Trim(Text1(6)) = "T" Or Trim(Text1(6)) = "CFT") And InStr(m_strCaseCPM, "303") > 0) Then
       If Trim(Text1(1)) = "" Or Trim(Text1(3)) = "" Then
           MsgBox "有「延期」時一定要輸入本所期限及法定期限!!!", vbExclamation + vbOKOnly
           SSTab1.Tab = 0
           If Trim(Text1(1)) = "" Then
               Text1(1).SetFocus
           Else
               Text1(3).SetFocus
           End If
           Screen.MousePointer = vbDefault
           Exit Function
       End If
   End If
   '2015/4/1 End
   
   'Add By Sindy 2014/11/5
   '台灣案本所和法定期限只要有一項輸入另一期限也必須有輸入值
   '法定期限除非是當日,不然本所期限不可大於法定期限
   If Text1(1).Enabled = True Or Text1(3).Enabled = True Then 'Add By Sindy 2014/12/10 若從期限資料帶過來者,不須檢查期限
      'Added by Lydia 2019/09/11 CFP回覆代理人902,CFP其他翻譯927;P補文件202,P自請撤回413,P保密審查430：以上條件有輸本所期限, 可以不必輸法定期限。
      blnCancel = False
      If CheckCP06CP07(blnCancel) = True Then
         If blnCancel = True Then
            Exit Function
         End If
      Else
      'end 2019/09/11
          If Left(Trim(Combo1(0).Text), 3) = "000" Then
             If Val(Text1(1)) <> 0 Or Val(Text1(3)) <> 0 Then
                If Text1(1) = "" Then
                   MsgBox "法定期限" & MsgText(52), vbExclamation
                   SSTab1.Tab = 0
                   Text1(1).SetFocus
                   Exit Function
                End If
                If Text1(3) = "" Then
                   MsgBox "本所期限" & MsgText(52), vbExclamation
                   SSTab1.Tab = 0
                   Text1(3).SetFocus
                   Exit Function
                End If
    
                If Val(Text1(1)) <> Val(strSrvDate(2)) Then
                   If Val(Text1(3)) > Val(Text1(1)) Then
                      SSTab1.Tab = 0
                      'Modify By Sindy 2023/3/29
                      If Text1(3).Enabled = False Then
                        MsgBox "提醒！本所期限大於法定期限。" & vbCrLf & _
                               "（回掉訊息後，可繼續操作。）", vbExclamation
                      Else
                      '2023/3/29 END
                        MsgBox "本所期限不可大於法定期限！", vbExclamation
                        Text1(3).SetFocus
                        Exit Function
                      End If
                   End If
                End If
             End If
          End If
      End If 'end 2019/09/11
   End If
   '2014/11/5 END
   
   'Modify by Morgan 2008/8/1 接洽人改下拉選單
   If cboContact(1).Enabled = True And cboContact(1) <> "" And cboContact(1).ListIndex = -1 Then
      If Text1(21) = cboContact(1) Then MsgBox "接洽人與申請人相同，請勿輸入接洽人!!", , "輸入錯誤": cboContact(1).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 0: Exit Function
      If InStr(1, cboContact(1), Mid(Text1(21), 1, 1) & "先生") > 0 And Mid(Text1(92), 2, 1) = "1" And Len(Text1(92)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(1).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 0: Exit Function
      If InStr(1, cboContact(1), Mid(Text1(21), 1, 1) & "小姐") > 0 And Mid(Text1(92), 2, 1) = "2" And Len(Text1(92)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(1).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 0: Exit Function
   End If
   If cboContact(2).Enabled = True And cboContact(2) <> "" And cboContact(2).ListIndex = -1 Then
      If Text1(37) = cboContact(2) Then MsgBox "接洽人與申請人相同，請勿輸入接洽人!!", , "輸入錯誤": cboContact(2).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 1: Exit Function
      If InStr(1, cboContact(2), Mid(Text1(37), 1, 1) & "先生") > 0 And Mid(Text1(93), 2, 1) = "1" And Len(Text1(93)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(2).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 1: Exit Function
      If InStr(1, cboContact(2), Mid(Text1(37), 1, 1) & "小姐") > 0 And Mid(Text1(93), 2, 1) = "2" And Len(Text1(93)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(2).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 1: Exit Function
   End If
   If cboContact(3).Enabled = True And cboContact(3) <> "" And cboContact(3).ListIndex = -1 Then
      If Text1(53) = cboContact(3) Then MsgBox "接洽人與申請人相同，請勿輸入接洽人!!", , "輸入錯誤": cboContact(3).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 2: Exit Function
      If InStr(1, cboContact(3), Mid(Text1(53), 1, 1) & "先生") > 0 And Mid(Text1(94), 2, 1) = "1" And Len(Text1(94)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(3).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 2: Exit Function
      If InStr(1, cboContact(3), Mid(Text1(53), 1, 1) & "小姐") > 0 And Mid(Text1(94), 2, 1) = "2" And Len(Text1(94)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(3).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 2: Exit Function
   End If
   If cboContact(4).Enabled = True And cboContact(4) <> "" And cboContact(4).ListIndex = -1 Then
      If Text1(69) = cboContact(4) Then MsgBox "接洽人與申請人相同，請勿輸入接洽人!!", , "輸入錯誤": cboContact(4).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 3: Exit Function
      If InStr(1, cboContact(4), Mid(Text1(69), 1, 1) & "先生") > 0 And Mid(Text1(95), 2, 1) = "1" And Len(Text1(95)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(4).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 3: Exit Function
      If InStr(1, cboContact(4), Mid(Text1(69), 1, 1) & "小姐") > 0 And Mid(Text1(95), 2, 1) = "2" And Len(Text1(95)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(4).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 3: Exit Function
   End If
   If cboContact(5).Enabled = True And cboContact(5) <> "" And cboContact(5).ListIndex = -1 Then
      If Text1(85) = cboContact(5) Then MsgBox "接洽人與申請人相同，請勿輸入接洽人!!", , "輸入錯誤": cboContact(5).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 4: Exit Function
      If InStr(1, cboContact(5), Mid(Text1(85), 1, 1) & "先生") > 0 And Mid(Text1(96), 2, 1) = "1" And Len(Text1(96)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(5).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 4: Exit Function
      If InStr(1, cboContact(5), Mid(Text1(85), 1, 1) & "小姐") > 0 And Mid(Text1(96), 2, 1) = "2" And Len(Text1(96)) = 10 Then MsgBox "個人申請，接洽人為申請人本人時，請勿輸入接洽人!!", , "輸入錯誤": cboContact(5).SetFocus: Me.SSTab1.Tab = 1: Me.SSTab2.Tab = 4: Exit Function
   End If
   'end 2008/8/1
   
   'Added by Morgan 2020/11/9
   'TW-SUPA 434
   If Text1(6) = "P" And arrNation(0) = "000" Then
      If ChkTwSupa() = False Then Exit Function
   End If
   'end 2020/11/9
   
   'cancel by sonia 2016/4/28
'   'Added by Morgan 2012/3/30
'   If Text1(6) = "P" And arrNation(0) = "000" Then
'      For ii = 1 To 4
'         '台灣 PPH 431 必須同時收文提早公開 417
'         'Modified by Morgan 2013/5/28 改抓 434(TW-SUPA)
'         'If Trim(Left(Me.Combo1(ii).Text, 4)) = "431" Then
'         If Trim(Left(Me.Combo1(ii).Text, 4)) = "434" Then
'            For intI = 1 To 4
'               If Trim(Left(Me.Combo1(intI).Text, 4)) = "417" Then
'                  Exit For
'               End If
'            Next
'            If intI > 4 Then
'               strExc(1) = "1"
'               If Option1(1).Value = True Then
'                  strExc(0) = "select cp09 from caseprogress where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " and cp10='417' and cp57 is null"
'                  intI = 1
'                  Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
'                  If intI = 1 Then
'                     strExc(1) = ""
'                  End If
'               End If
'               If strExc(1) = "1" Then
'                  MsgBox "收文台灣專利 " & Me.Combo1(ii).Text & " 時，必須同時加收 417 提早公開!!", vbExclamation
'                  Exit Function
'               End If
'            End If
'         End If
'      Next
'   End If
'   'end 2012/3/30
'end 2016/4/28

   'Added by Morgan 2012/12/28
   '台灣被主張國內優先權者，不可領證
   'Modified by Morgan 2013/6/28 +舊案才要檢查
   If Option1(1).Value = True And Text1(6) = "P" And arrNation(0) = "000" And strSrvDate(1) >= "20130101" Then
'      For ii = 1 To 4
'         If Trim(Left(Me.Combo1(ii).Text, 4)) = "601" Then
'            Exit For
'         End If
'      Next
'      If ii <= 4 Then
      If InStr(m_strCaseCPM, "601") > 0 Then
         If pa(11) <> "" Then
            If PUB_ChkPriDate(pa(11), strExc(3), False) = True Then
               MsgBox "本案已被 " & strExc(3) & " 主張國內優先權，不可領證!!"
               Exit Function
            End If
         End If
      End If
   End If
   'end 2012/12/28
   
   'Added by Morgan 2012/12/25
   If Text1(6) = "P" And arrNation(0) = "000" And strSrvDate(1) >= "20130101" And Text1(1) <> "" Then
      If DBDATE(Text1(1)) < CompDate(1, -6, strSrvDate(1)) Then
'         For ii = 1 To 4
            '年費逾法定期限+半年時檢查要同時收文414回復原狀
'            If Trim(Left(Me.Combo1(ii).Text, 4)) = "605" Then
            If InStr(m_strCaseCPM, "605") > 0 Then
'               For intI = 1 To 4
'                  If Trim(Left(Me.Combo1(intI).Text, 4)) = "414" Then
'                     Exit For
'                  End If
'               Next
'               If intI > 4 Then
               If InStr(m_strCaseCPM, "414") = 0 Then
                  strExc(1) = "1"
                  If Option1(1).Value = True Then
                     strExc(0) = "select cp09 from caseprogress where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " and cp10='414' and cp57 is null"
                     intI = 1
                     Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                     If intI = 1 Then
                        strExc(1) = ""
                     End If
                  End If
                  If strExc(1) = "1" Then
                     MsgBox "收文台灣專利 " & Me.Combo1(ii).Text & " 若逾法定期限+半年時必須同時加收 414 回復原狀!!", vbExclamation
                     Exit Function
                  End If
               End If
            End If
'         Next
      End If
      
      If DBDATE(Text1(1)) < strSrvDate(1) Then
'         For ii = 1 To 4
            '領證逾法定期限時檢查要同時收文414回復原狀
'            If Trim(Left(Me.Combo1(ii).Text, 4)) = "601" Then
            If InStr(m_strCaseCPM, "601") > 0 Then
'               For intI = 1 To 4
'                  If Trim(Left(Me.Combo1(intI).Text, 4)) = "414" Then
'                     Exit For
'                  End If
'               Next
'               If intI > 4 Then
               If InStr(m_strCaseCPM, "414") = 0 Then
                  strExc(1) = "1"
                  If Option1(1).Value = True Then
                     strExc(0) = "select cp09 from caseprogress where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " and cp10='414' and cp57 is null"
                     intI = 1
                     Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                     If intI = 1 Then
                        strExc(1) = ""
                     End If
                  End If
                  If strExc(1) = "1" Then
                     MsgBox "收文台灣專利 " & Me.Combo1(ii).Text & " 若逾法定期限時，必須同時加收 414 回復原狀!!", vbExclamation
                     Exit Function
                  End If
               End If
            End If
'         Next
      End If
   End If
   'end 2012/12/25
   
   CheckDataValidate1 = True
End Function

'Added by Lydia 2017/06/19 從上面分出CheckDataValidate2
Private Function CheckDataValidate2(Index As Integer) As Boolean
    Dim i As Integer, j As Integer, ii As Integer
    Dim Cancel As Boolean
    Dim MsgStr  As String
    Dim blnNeedChk As Boolean
    Dim dblFee As Double 'Add By Sindy 2014/2/19
    'Add 2014/07/18
      
   'Add By Sindy 2012/6/6
   '台灣T行政訴訟403時,費用若超過2萬元者,必須同時收文準備程序204及言詞辯論205
   If Text1(6) = "T" And arrNation(0) = "000" Then
      'For ii = 1 To 4
      For ii = 1 To GridCase.Rows - 1
         If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "403" And Val(Format(Trim(GridCase.TextMatrix(ii, 2)), "###0")) > 20000 Then
            MsgStr = ""
'            strExc(1) = ""
'            For intI = 1 To 4
'               If Trim(Left(Me.Combo1(intI).Text, 4)) = "204" Then
'                  strExc(1) = "Y"
'                  Exit For
'               End If
'            Next intI
'            If strExc(1) = "" Then
            If InStr(m_strCaseCPM, "204") = 0 Then
               MsgStr = MsgStr & "204 收文準備程序"
            End If
'            strExc(1) = ""
'            For intI = 1 To 4
'               If Trim(Left(Me.Combo1(intI).Text, 4)) = "205" Then
'                  strExc(1) = "Y"
'                  Exit For
'               End If
'            Next intI
'            If strExc(1) = "" Then
            If InStr(m_strCaseCPM, "205") = 0 Then
               If MsgStr <> "" Then MsgStr = MsgStr & " 及 "
               MsgStr = MsgStr & "205 言詞辯論"
            End If
            If MsgStr <> "" Then
               'MsgBox "收文台灣商標 " & Me.Combo1(ii).Text & " 時，必須同時加收 " & MsgStr & "!!", vbExclamation
               MsgBox "收文台灣商標 " & Trim(GridCase.TextMatrix(ii, 1)) & " 時，必須同時加收 " & MsgStr & "!!", vbExclamation
               Exit Function
            End If
         End If
      Next ii
   End If
   '台灣P行政訴訟503時,費用若超過2萬元者,必須同時收文準備程序211及言詞辯論212
   If Text1(6) = "P" And arrNation(0) = "000" Then
      'For ii = 1 To 4
      For ii = 1 To GridCase.Rows - 1
         If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "503" And Val(Format(Trim(GridCase.TextMatrix(ii, 2)), "###0")) > 20000 Then
            MsgStr = ""
'            strExc(1) = ""
'            For intI = 1 To 4
'               If Trim(Left(Me.Combo1(intI).Text, 4)) = "211" Then
'                  strExc(1) = "Y"
'                  Exit For
'               End If
'            Next intI
'            If strExc(1) = "" Then
            If InStr(m_strCaseCPM, "211") = 0 Then
               MsgStr = MsgStr & "211 收文準備程序"
            End If
'            strExc(1) = ""
'            For intI = 1 To 4
'               If Trim(Left(Me.Combo1(intI).Text, 4)) = "212" Then
'                  strExc(1) = "Y"
'                  Exit For
'               End If
'            Next intI
'            If strExc(1) = "" Then
            If InStr(m_strCaseCPM, "212") = 0 Then
               If MsgStr <> "" Then MsgStr = MsgStr & " 及 "
               MsgStr = MsgStr & "212 言詞辯論"
            End If
            If MsgStr <> "" Then
               MsgBox "收文台灣專利 " & Trim(GridCase.TextMatrix(ii, 1)) & " 時，必須同時加收 " & MsgStr & "!!", vbExclamation
               Exit Function
            End If
         End If
      Next ii
   End If
   '2012/6/6 End
   
   'Added by Morgan 2013/4/9
   '台灣專利可減免中小企業需設定資格(領證或繳年費才做)
   'Modified by Morgan 2021/4/23 +T109預繳年費案件檢查
   'If Text1(6) = "P" And stCountry = "000" And Val(strYF05From) > 0 And Val(strYF05From) < 7 Then
   '   If GetCP81() = "Y" Then
   m_lngRefunded = 0
   If Text1(6) = "P" And stCountry = "000" And Val(Text1(142).Text) > 0 Then
      If GetCP81() = "Y" Then
         MsgStr = ""
         blnNeedChk = False
         TwPtRefundAlert m_lngRefund, False, m_bol919Received, False
         If Val(Text1(142).Text) < 7 Then
            blnNeedChk = True
         ElseIf m_lngRefund > 0 Then
            MsgStr = "為判斷本案先前預繳之年費是否可減免退費，"
            blnNeedChk = True
         End If
         If blnNeedChk Then
         'end 2021/4/23
      
            If Option31(1).Value = True Then
               SetQualVisible 0, blnNeedChk
               If cmdQual(1).Visible = True And arrAD1516(1, 1) = "" And blnNeedChk = True Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 0 Then SSTab2.Tab = 0
                  MsgBox "中小企業可減免者必須設定減免資格！", vbExclamation, stCustNo1 & "未設定減免資格"
                  Exit Function
               End If
            End If
            '申請人2
            If Option32(1).Value = True Then
               SetQualVisible 1
               If cmdQual(2).Visible = True And arrAD1516(2, 1) = "" And blnNeedChk = True Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 1 Then SSTab2.Tab = 1
                  MsgBox "中小企業可減免者必須設定減免資格！", vbExclamation, stCustNo2 & "未設定減免資格"
                  Exit Function
               End If
            End If
            '申請人3
            If Option33(1).Value = True Then
               SetQualVisible 2
               If cmdQual(3).Visible = True And arrAD1516(3, 1) = "" And blnNeedChk = True Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 2 Then SSTab2.Tab = 2
                  MsgBox "中小企業可減免者必須設定減免資格！", vbExclamation, stCustNo3 & "未設定減免資格"
                  Exit Function
               End If
            End If
            '申請人4
            If Option34(1).Value = True Then
               SetQualVisible 3
               If cmdQual(4).Visible = True And arrAD1516(4, 1) = "" And blnNeedChk = True Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 3 Then SSTab2.Tab = 3
                  MsgBox "中小企業可減免者必須設定減免資格！", vbExclamation, stCustNo4 & "未設定減免資格"
                  Exit Function
               End If
            End If
            '申請人5
            If Option34(1).Value = True Then
               SetQualVisible 4
               If cmdQual(5).Visible = True And arrAD1516(5, 1) = "" And blnNeedChk = True Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 4 Then SSTab2.Tab = 4
                  MsgBox "中小企業可減免者必須設定減免資格！", vbExclamation, stCustNo5 & "未設定減免資格"
                  Exit Function
               End If
            End If
            
         'Added by Morgan 2021/4/29
         End If
         If m_lngRefund > 0 Then
            If DiscStatusIsChanged = True Then
               If (arrAD1516(1, 1) = "5" And Val(arrAD1516(1, 2)) > 80000000) Or _
                  (arrAD1516(2, 1) = "5" And Val(arrAD1516(2, 2)) > 80000000) Or _
                  (arrAD1516(3, 1) = "5" And Val(arrAD1516(3, 2)) > 80000000) Or _
                  (arrAD1516(4, 1) = "5" And Val(arrAD1516(4, 2)) > 80000000) Or _
                  (arrAD1516(5, 1) = "5" And Val(arrAD1516(5, 2)) > 80000000) Then
                  For ii = 1 To GridCase.Rows - 1 '4
                     'If Left(Combo1(ii), 3) = "605" Then
                     If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "605" Then
                        m_lngRefunded = m_lngRefund
                        'If Val(Text1(102 + 3 * (ii - 1)).Text) = m_lng605Fee Then
                        If Val(Format(Trim(GridCase.TextMatrix(ii, 3)), "###0")) = m_lng605Fee Then
                           MsgBox "本案有預繳的減免年費共計 " & Format(m_lngRefund, DDollar) & " 元，可於本次繳年費時一併扣抵" & IIf(m_bol919Received, "(本案已收文減免退費)", "，系統將自動收文(919)減免退費") & "，請列印接洽記錄單，交櫃檯收文！", vbInformation
                           'Text1(101 + 3 * (ii - 1)).Text = Text1(101 + 3 * (ii - 1)) - m_lngRefund
                           'Text1(102 + 3 * (ii - 1)).Text = Text1(102 + 3 * (ii - 1)) - m_lngRefund
                           GridCase.TextMatrix(ii, 2) = Val(Format(Trim(GridCase.TextMatrix(ii, 2)), "###0")) - m_lngRefund
                           GridCase.TextMatrix(ii, 3) = Val(Format(Trim(GridCase.TextMatrix(ii, 3)), "###0")) - m_lngRefund
                           If m_bol919Received = False Then Call AutoAdd919(True)
                           SSTab1.Tab = 0
                           Exit Function
                        End If
                     End If
                  Next ii
               End If
            End If
         End If
         'end 2021/4/29
      End If
    End If
   'end 2013/4/9
   
   'Added by Morgan 2019/4/12
   '日本發明實審、領證及4-10年年費
   If Text1(6) = "CFP" And stCountry = "011" Then
      SetOpt81 stCountry '重新設定一次(因需考慮專利種類或收文性質)
      If IsoptCP81 Then
         For ii = 1 To GridCase.Rows - 1 '4
            'If Trim(Left(Me.Combo1(ii).Text, 4)) = "416" Or Trim(Left(Me.Combo1(ii).Text, 4)) = "601" Or Trim(Left(Me.Combo1(ii).Text, 4)) = "605" Then
            If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "416" Or _
               Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "601" Or _
               Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "605" Then
               MsgStr = Trim(Mid(Trim(GridCase.TextMatrix(ii, 1)), 5))
               blnNeedChk = True
               Exit For
            End If
         Next ii
         If blnNeedChk Then
            '申請人1
            If optCP811(0).Value = True Then
               If cmdQual(1).Visible = True And arrAD1516(1, 1) = "" Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 0 Then SSTab2.Tab = 0
                  MsgBox "可減免者必須設定減免資格！", vbExclamation, stCustNo1 & "未設定減免資格"
                  cmdQual(1).Value = True
                  Exit Function
               End If
            ElseIf optCP811(1).Value = False Then
               If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
               If SSTab2.Tab <> 0 Then SSTab2.Tab = 0
               MsgBox "日本發明案收文" & MsgStr & "必須選擇是否符合減免資格！", vbExclamation, stCustNo1 & "未選擇是否符合減免資格"
               Exit Function
            End If
            
            '申請人2
            If Trim(Text1(37) & Text1(38)) <> "" Then
               If optCP812(0).Value = True Then
                  If cmdQual(2).Visible = True And arrAD1516(2, 1) = "" Then
                     If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                     If SSTab2.Tab <> 1 Then SSTab2.Tab = 1
                     MsgBox "可減免者必須設定減免資格！", vbExclamation, stCustNo1 & "未設定減免資格"
                     cmdQual(2).Value = True
                     Exit Function
                  End If
               ElseIf optCP812(1).Value = False Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 1 Then SSTab2.Tab = 1
                  MsgBox "日本發明案收文" & MsgStr & "必須選擇是否符合減免資格！", vbExclamation, stCustNo1 & "未選擇是否符合減免資格"
                  Exit Function
               End If
            End If
            
            '申請人3
            If Trim(Text1(53) & Text1(54)) <> "" Then
               If optCP813(0).Value = True Then
                  If cmdQual(3).Visible = True And arrAD1516(3, 1) = "" Then
                     If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                     If SSTab2.Tab <> 2 Then SSTab2.Tab = 2
                     MsgBox "可減免者必須設定減免資格！", vbExclamation, stCustNo1 & "未設定減免資格"
                     cmdQual(3).Value = True
                     Exit Function
                  End If
               ElseIf optCP813(1).Value = False Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 2 Then SSTab2.Tab = 2
                  MsgBox "日本發明案收文" & MsgStr & "必須選擇是否符合減免資格！", vbExclamation, stCustNo1 & "未選擇是否符合減免資格"
                  Exit Function
               End If
            End If
            
            '申請人4
            If Trim(Text1(69) & Text1(70)) <> "" Then
               If optCP814(0).Value = True Then
                  If cmdQual(4).Visible = True And arrAD1516(4, 1) = "" Then
                     If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                     If SSTab2.Tab <> 3 Then SSTab2.Tab = 3
                     MsgBox "可減免者必須設定減免資格！", vbExclamation, stCustNo1 & "未設定減免資格"
                     cmdQual(4).Value = True
                     Exit Function
                  End If
               ElseIf optCP814(1).Value = False Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 3 Then SSTab2.Tab = 3
                  MsgBox "日本發明案收文" & MsgStr & "必須選擇是否符合減免資格！", vbExclamation, stCustNo1 & "未選擇是否符合減免資格"
                  Exit Function
               End If
            End If
            
            '申請人5
            If Trim(Text1(85) & Text1(86)) <> "" Then
               If optCP815(0).Value = True Then
                  If cmdQual(5).Visible = True And arrAD1516(5, 1) = "" Then
                     If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                     If SSTab2.Tab <> 4 Then SSTab2.Tab = 4
                     MsgBox "可減免者必須設定減免資格！", vbExclamation, stCustNo1 & "未設定減免資格"
                     cmdQual(5).Value = True
                     Exit Function
                  End If
               ElseIf optCP815(1).Value = False Then
                  If SSTab1.Tab <> 1 Then SSTab1.Tab = 1
                  If SSTab2.Tab <> 4 Then SSTab2.Tab = 4
                  MsgBox "日本發明案收文" & MsgStr & "必須選擇是否符合減免資格！", vbExclamation, stCustNo1 & "未選擇是否符合減免資格"
                  Exit Function
               End If
            End If
         End If
      End If
   End If
   'end 2019/4/12
  
    'Add by Amy 2014/07/22 台日優先權證明文件電子化內部控管
    If InStr(m_strCaseCPM, "436") > 0 Then
        If Option1(0).Value = True And (InStr(m_strCaseCPM, "103") > 0 Or InStr(m_strCaseCPM, "125") > 0) Then
            '選新案且案件性質為103或125,不可收436
            strExc(0) = ""
            If InStr(m_strCaseCPM, "103") > 0 Then strExc(0) = "案件性質有" & GetCasePropertyName(Text1(6), "103", IIf(Left(Trim(Combo1(0).Text), 3) = "000", "CPM03", "CPM04"))
            If InStr(m_strCaseCPM, "125") > 0 Then
                If strExc(0) = MsgBox(601) Then
                    strExc(0) = "案件性質有" & GetCasePropertyName(Text1(6), "125", IIf(Left(Trim(Combo1(0).Text), 3) = "000", "CPM03", "CPM04"))
                Else
                    strExc(0) = strExc(0) & GetCasePropertyName(Text1(6), "125", IIf(Left(Trim(Combo1(0).Text), 3) = "000", "CPM03", "CPM04"))
                End If
            End If
            MsgBox strExc(0) & "不可同時收" & GetCasePropertyName(Text1(6), "436", IIf(Left(Trim(Combo1(0).Text), 3) = "000", "CPM03", "CPM04")), , MsgText(5)
            Screen.MousePointer = vbDefault
            Exit Function
         'Modify By Sindy 2023/8/29 mark,此限制取消
'        ElseIf Option1(1).Value = True And Left(Label1(124).Caption, 4) = "專利種類" And Left(Combo6, 1) = "3" Then
'            '選舊案且專利種類為3 , 不可收436申請優先權存取碼
'            MsgBox "專利種類為「" & Combo6 & _
'                "」不可收" & GetCasePropertyName(Text1(6), "436", IIf(Left(Trim(Combo1(0).Text), 3) = "000", "CPM03", "CPM04")), , MsgText(5)
'            Screen.MousePointer = vbDefault
'            Exit Function
        End If
    End If
    'Add by Amy 2014/07/18 案件性質405與436 不可同時收文
    'modify by sonia 2017/7/10 雅娟說僅限制台灣案
    'If bolIs405 = True And bolIs436 = True Then
    If Left(Trim(Combo1(0).Text), 3) = "000" And (InStr(m_strCaseCPM, "405") > 0 And InStr(m_strCaseCPM, "436") > 0) Then
        MsgBox "不可同時收 " & GetCasePropertyName(Text1(6), "405", IIf(Left(Trim(Combo1(0).Text), 3) = "000", "CPM03", "CPM04")) & _
                        "及" & GetCasePropertyName(Text1(6), "436", IIf(Left(Trim(Combo1(0).Text), 3) = "000", "CPM03", "CPM04")), , MsgText(5)
        SSTab1.Tab = 0
        'Me.Combo1(1).SetFocus
        Screen.MousePointer = vbDefault
        Exit Function
    End If
    'end 214/07/18
    
    'Add By Sindy 2010/4/22
    If Trim(Text1(6)) = "P" Or Trim(Text1(6)) = "CFP" Then
        If InStr(m_strCaseCPM, "405") > 0 Then
            If Trim(Text1(4)) = "" Then
                MsgBox "請輸入申請優先權證明書份數!!!", vbExclamation + vbOKOnly
                SSTab1.Tab = 2
                SSTab3.Tab = 0 'Added by Morgan 2013/1/15
                Text1(4).SetFocus
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        End If
        '2013/12/2 ADD BY SONIA
        If InStr(m_strCaseCPM, "119") > 0 Then
            MsgBox "請改收 101 或 102, 並提供相同的案號及PCT的申請號、申請日、優先權日資料!!!", vbExclamation + vbOKOnly
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        '2013/12/2 END
    End If
    'end 2010/04/22
   
    'Added by Morgan 2012/12/18
    If strSrvDate(1) >= "20130101" Then
        If Trim(Text1(6)) = "P" And Left(Trim(Combo1(0).Text), 3) = "000" Then
            '102新法：台灣申請技術報告要輸入項數來檢查規費
            ii = 0: strExc(1) = ""
'            If Trim(Left(Me.Combo1(1).Text, 4)) = "421" Or Trim(Left(Me.Combo1(1).Text, 4)) = "807" Then
'                ii = 102
'                strExc(1) = Me.Combo1(1).Text
'            ElseIf Trim(Left(Me.Combo1(2).Text, 4)) = "421" Or Trim(Left(Me.Combo1(2).Text, 4)) = "807" Then
'                ii = 105
'                strExc(1) = Me.Combo1(2).Text
'            ElseIf Trim(Left(Me.Combo1(3).Text, 4)) = "421" Or Trim(Left(Me.Combo1(3).Text, 4)) = "807" Then
'                ii = 108
'                strExc(1) = Me.Combo1(3).Text
'            ElseIf Trim(Left(Me.Combo1(4).Text, 4)) = "421" Or Trim(Left(Me.Combo1(4).Text, 4)) = "807" Then
'                ii = 111
'                strExc(1) = Me.Combo1(4).Text
'            End If
            For ii = 1 To GridCase.Rows - 1
               If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "421" Or _
                  Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "807" Then
                  'ii = Val(Format(Trim(GridCase.TextMatrix(ii, 3)), "###0"))
                  'strExc(1) = Trim(GridCase.TextMatrix(ii, 1))
                  strExc(1) = Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4))
                  Exit For
               End If
            Next ii
            If ii > 0 And strExc(1) <> "" Then
                If Trim(Text1(114)) = "" Then
                    MsgBox "請輸入申請技術報告項數!!!", vbExclamation + vbOKOnly
                    SSTab1.Tab = 2
                    SSTab3.Tab = 0 'Added by Morgan 2013/1/15
                    Text1(114).SetFocus
                    Screen.MousePointer = vbDefault
                    Exit Function
                Else
                    'Modify By Sindy 2025/4/14 改成共用函數
'                    strExc(0) = "SELECT cf08 FROM CASEFEE WHERE CF01 = 'P' AND CF02 = '000' AND CF03 = '" & Trim(Left(strExc(1), 4)) & "' and cf08>0"
'                    intI = 1
'                    Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                    Call PUB_GetCaseFee_000("", "", "", strExc(1), "P", Trim(Left(strExc(1), 4)))
                    'If intI = 1 Then
                    If Val(strExc(1)) > 0 Then
                        'strExc(2) = "" & RsTemp(0)
                        strExc(2) = strExc(1)
                        '2025/4/14 END
                        If Val(Text1(114)) > 10 Then
                            strExc(3) = Val(strExc(2)) + 600 * (Val(Text1(114)) - 10)
                        Else
                            strExc(3) = strExc(2)
                        End If
                        'If Val(strExc(3)) <> Val(Text1(ii)) Then
                        'If Val(strExc(3)) <> Val(ii) Then
                        If Val(strExc(3)) <> Val(Format(Trim(GridCase.TextMatrix(ii, 3)), "###0")) Then
                            MsgBox strExc(1) & "規費應為 $" & strExc(3) & vbCrLf & vbCrLf & "( 10項以內規費 $" & strExc(2) & ", 每超出1項加收 $600 )", vbExclamation, "項數或規費輸入錯誤!!!"
                            SSTab1.Tab = 0
                            Text1(intI).SetFocus
                            Screen.MousePointer = vbDefault
                            Exit Function
                        End If
                    End If
                End If
            End If
                   
            'Added by Morgan 2013/1/15
            '102新法：台灣舉發要勾選聲明並計算規費
'            ii = 0
'            If Trim(Left(Me.Combo1(1).Text, 4)) = "803" Then
'                ii = 102
'            ElseIf Trim(Left(Me.Combo1(2).Text, 4)) = "803" Then
'                ii = 105
'            ElseIf Trim(Left(Me.Combo1(3).Text, 4)) = "803" Then
'                ii = 108
'            ElseIf Trim(Left(Me.Combo1(4).Text, 4)) = "803" Then
'                ii = 111
'            End If
'            If ii > 0 Then
'                If CheckP803(Val(Text1(ii))) = False Then
'                    Screen.MousePointer = vbDefault
'                    Exit Function
'                Else
'                    m_bolAdd803Memo = True
'                End If
'            End If
            For ii = 1 To GridCase.Rows - 1
               If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "803" Then
                  If CheckP803(Val(Format(Trim(GridCase.TextMatrix(ii, 3)), "###0"))) = False Then
                      Screen.MousePointer = vbDefault
                      Exit Function
                  Else
                      m_bolAdd803Memo = True
                  End If
                  Exit For
               End If
            Next ii
        End If
    End If
    'end 2012/12/18
   
    'Add By Sindy 2014/2/19
    '舊案時檢查台灣商標延展跨類的規費
    strTawT102MClassFee = ""
    If Option1(1).Value = True And Trim(Left(Combo1(0), 4)) = "000" And Text1(6) = "T" And _
        InStr(m_strCaseCPM, "102") > 0 Then
                
'        If Trim(Left(Me.Combo1(1).Text, 4)) = "102" Then dblFee = Val(Text1(102))
'        If Trim(Left(Me.Combo1(2).Text, 4)) = "102" Then dblFee = Val(Text1(105))
'        If Trim(Left(Me.Combo1(3).Text, 4)) = "102" Then dblFee = Val(Text1(108))
'        If Trim(Left(Me.Combo1(4).Text, 4)) = "102" Then dblFee = Val(Text1(111))
        For ii = 1 To GridCase.Rows - 1
            If Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4)) = "102" Then
               dblFee = Val(Format(Trim(GridCase.TextMatrix(ii, 3)), "###0"))
               Exit For
            End If
        Next ii
        
        strTawT102MClassFee = PUB_ChkTawT102MClassFee(Text1(6), Text1(7), Text1(8), Text1(9), dblFee, Text1(1))
        If strTawT102MClassFee = "N" Then
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    '2014/2/19 END
   
    'Add By Sindy 2012/8/17
    If Trim(Text1(6)) = "P" Or Trim(Text1(6)) = "CFP" Then
        If InStr(m_strCaseCPM, "123") > 0 Then
            If Trim(Text1(128)) = "" Then
                'Modified by Morgan 2013/6/10 改欄位名
                'MsgBox "請輸入優惠期日!!!", vbExclamation + vbOKOnly
                MsgBox "請輸入優惠期事實發生日期!!!", vbExclamation + vbOKOnly
                SSTab1.Tab = 2
                SSTab3.Tab = 0 'Added by Morgan 2013/1/15
                Text1(128).SetFocus
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        End If
    End If
    '2012/8/17 End
    
    'Add By Sindy 2010/10/28 新案且可輸入案件屬性時, 檢查案件屬性不可空白
    'Modify By Sindy 2012/6/6 新案且專利種類為發明或新型時, 檢查案件屬性不可空白
'    If (Trim(Left(Me.Combo1(1).Text, 4)) = "101" Or Trim(Left(Me.Combo1(2).Text, 4)) = "101" Or _
'        Trim(Left(Me.Combo1(3).Text, 4)) = "101" Or Trim(Left(Me.Combo1(4).Text, 4)) = "101" Or _
'        Trim(Left(Me.Combo1(1).Text, 4)) = "102" Or Trim(Left(Me.Combo1(2).Text, 4)) = "102" Or _
'        Trim(Left(Me.Combo1(3).Text, 4)) = "102" Or Trim(Left(Me.Combo1(4).Text, 4)) = "102") And _
'        Combo5.Visible = True Then
    If Option1(0).Value = True And Combo5.Visible = True And Combo6.Visible = True Then
        If Left(Combo6.Text, 1) = "1" Or Left(Combo6.Text, 1) = "2" Then
            If Combo5.Text = "" Then
                MsgBox "案件屬性不可空白!!!", vbExclamation + vbOKOnly
                SSTab1.Tab = 0
                Combo5.SetFocus
                Screen.MousePointer = vbDefault
                Exit Function
            End If
            Cancel = False
            Combo5_Validate Cancel
            If Cancel = True Then
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        End If
    End If
    '2010/10/28
    
    'Added by Lydia 2019/11/05  特定申請人會稿案件: 業務收文新申請案(發明、實用新型、外觀設計)，且申請國為中國大陸時，希望能於收文時跳出【請確認此申請人之中國大陸案是否要會稿】
    If Frame45.Visible = True And Option1(0).Value = True And Text1(6).Text = "P" And Trim(Left(Combo1(0), 4)) = "020" _
                 And Opt45(0).Value = 0 And Opt45(1).Value = 0 Then
                'Modified by Lydia 2020/02/26 改備註, 強調
                'MsgBox "請確認此申請人之中國大陸案是否要會稿!!!", vbExclamation + vbOKOnly
                MsgBox "請確認此申請人之中國大陸案是否要會簡體版說明書!!!", vbExclamation + vbOKOnly
                SSTab1.Tab = 2
                SSTab3.Tab = 0
                Screen.MousePointer = vbDefault
                Exit Function
    End If
    
    'Added by Morgan 2021/7/20 大陸發明生醫案是否新藥專利設定
    If Frame48.Visible = True And OptNewDrug(0).Value = False And OptNewDrug(1).Value = False Then
      MsgBox "請確認大陸發明生醫案是否新藥專利!!!", vbExclamation + vbOKOnly
      SSTab1.Tab = 2
      SSTab3.Tab = 0
      Screen.MousePointer = vbDefault
      Exit Function
    End If
    
    CheckDataValidate2 = True
    
End Function

'Added by Lydia 2022/06/13 因為CheckDataValidate4過長,再抽出CheckDataValidate4
Private Function CheckDataValidate4(Index As Integer) As Boolean
   Dim i As Integer, j As Integer, ii As Integer
   Dim Cancel As Boolean
   Dim strErrTxt As String, bolChkErr As Boolean, strText As String
   Dim mBillNo As String, mMemo As String 'Added by Lydia 2019/05/13
   Dim objChk As Object
   Dim arrCP10 As Variant, strTemp As String
   Dim strAppl As String
   Dim bolChkOk As Boolean 'Add By Sindy 2023/2/14
   Dim bolCRA26isY As Boolean 'Add By Sindy 2023/4/6
   
   'Modify By Sindy 2022/9/15 統一檢查
   If IsoptCP81 = True Then
      If DiscStatusIsChanged() = True Then
         m_Msgbox = "申請人減免身分已變更"
         MsgBox m_Msgbox & "！", vbExclamation + vbOKOnly
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
   End If
   '2022/9/15 END
   
   'Added by Lydia 2019/05/13  改模組(一併取得)
   dblAmt = 0
   'If (Val(Text1(101)) > 0 Or Val(Text1(104)) > 0 Or Val(Text1(107)) > 0 Or Val(Text1(110)) > 0) And Trim(Text1(12)) <> "" Then
   'Modified by Lydia 2022/11/02 排除國外部案源FCL
   If Val(m_dblTotRvFee) > 0 And Trim(Text1(12)) <> "" And Trim(Text1(6)) <> "FCL" And Option31(1).Value = True Then
        'Modified by Lydia 2022/06/13 傳入收文之本所案號,案件性質(可用,串接)
        'Call PUB_GetBillDataAll("3", Text1(12), dblAmt, dblPFee, dblTFee, , , strSrvDate(1), mBillNo, mMemo)
        'Modified by Lydia 2022/06/15 傳入收文之智權人員
        Call PUB_GetBillDataAll("3", Text1(12), Text1(6) & IIf(Text1(7) <> "", Text1(7) & Left(Text1(8) & "0", 1) & Left(Text1(9) & "00", 2), ""), _
                 m_strCaseCPM, _
                 Trim(Text1(10)), dblAmt, dblPFee, dblTFee, , , strSrvDate(1), mBillNo, mMemo)
   End If
   'Add By Sindy 2012/11/08 非T*案件(TF要含)若已送件之應收款超過15萬以上且有費用者須做下列控管
   'Modify By Sindy 2014/8/12 新客戶不用檢查應收帳款 +And Trim(Text1(12)) <> ""
   '(Val(Text1(101)) > 0 Or Val(Text1(104)) > 0 Or Val(Text1(107)) > 0 Or Val(Text1(110)) > 0)
   'Modified by Lydia 2022/11/02 排除國外部案源FCL
   If (Left(Trim(Text1(6)), 1) <> "T" Or Trim(Text1(6)) = "TF") And _
      Val(m_dblTotRvFee) > 0 And _
      Trim(Text1(12)) <> "" And Trim(Text1(6)) <> "FCL" And Option31(1).Value = True Then
      'dblAmt = 0: dblPFee = 0: dblTFee = 0 'Remove by Lydia 2019/09/19 上面PUB_GetBillDataAll已取得 (P-122120應收帳款超過40萬, 未能彈訊息)
      'Mark by Lydia 2019/05/13  改模組(一併取得)
      'GetBillData Text1(12), dblAmt, dblPFee, dblTFee
      
      'Add By Sindy 2012/12/10 取得客戶應收帳款收文檢查上限
      'Modified by Lydia 2020/02/03 應收帳款上限分開管制為個人"應收帳款上限"和"集團應收帳款上限"
      'dblChkAmt = PUB_GetCustRecAmtLmt(Text1(12))
      dblCu183 = PUB_GetCustRecAmtLmt(Text1(12), dblChkAmt)
      'Added by Lydia 2020/02/03 判斷是否有集團上限
      If dblChkAmt = 0 Then
          dblAmtR = 0: dblPFeeR = 0: dblTFeeR = 0
      Else   '有集團上限才抓關係企業的應收帳款金額
          GetBillData Text1(12), dblAmtR, dblPFeeR, dblTFeeR
      End If
      'end 2020/02/03
      
      'Add By Sindy 2014/3/10 王錦寬(副總)通知專利處之智權同仁身份者,取消預定收款日期之控制
      'Remove by Lydia 2018/08/22 (應收帳款管控)取消預定收款日,改成付款週期
'        If PUB_GetStaffST15(Text1(10), "1") < "P10" Or PUB_GetStaffST15(Text1(10), "1") > "P19" Then
'        '2014/3/10 END
'            'Modify By Sindy 2012/12/5 改30萬
'            'If dblAmt >= 150000 Then
'             'Modify By Sindy 2012/12/10 檢查的30萬改不要固定金額,抓CustRecAmtLmt
'             'If dblAmt >= 300000 Then
'             'Modify By Sindy 2015/3/25 有期限或金額超過者
'             If dblAmt >= dblChkAmt Or Val(Text1(3)) > 0 Then
'             '2012/12/10 End
'                 '一定要輸入預定收款日
'                 If Val(Text1(118)) <= 0 Then
'                     'MsgBox "應收帳款超過15萬以上之收文案, 預定收款日期不可空白!!!"
'                     'Modify By Sindy 2012/12/10
'                     'MsgBox "應收帳款超過30萬以上之收文案, 預定收款日期不可空白!!!"
'                     MsgBox IIf(dblAmt >= dblChkAmt, "應收帳款超過 NT " & Format(dblChkAmt, "#,##0") & "元 以上之收文案, ", "") & _
'                            "預定收款日期不可空白!!!"
'                     '2012/12/10 End
'                     SSTab1.Tab = 0
'                     Text1(118).SetFocus
'                     Screen.MousePointer = vbDefault
'                     Exit Function
'                  '若有期限案件, 預定收款日不可大於本所期限+2個月
'                 ElseIf Val(Text1(3)) > 0 Then
'                     If m_CU143 = "" Then m_CU143 = "2" 'Add By Sindy 2013/11/20 預定收款日放寬月數
'                     'Modify By Sindy 2013/11/20
'                     'If DBDATE(Val(Text1(118))) > Val(ChangeWDateStringToWString(DateAdd("M", 2, ChangeWStringToWDateString(DBDATE(Text1(3)))))) Then
'                     'Modify By Sindy 2015/4/16
'                     If strSrvDate(1) > DBDATE(Text1(3)) Then
'                        strChkDate = strSrvDate(1)
'                        strText = "系統日+" & m_CU143 & "個月"
'                     Else
'                        strChkDate = DBDATE(Text1(3))
'                        strText = "本所期限+" & m_CU143 & "個月"
'                     End If
'                     '2015/4/16 END
'                     If DBDATE(Val(Text1(118))) > Val(ChangeWDateStringToWString(DateAdd("M", m_CU143, ChangeWStringToWDateString(strChkDate)))) Then
'                     '2013/11/20 END
''                        MsgBox "含關係企業客戶已發文應收帳款超過15萬以上, 此案為有期限案件," & vbCrLf & _
''                               "預定收款日不可大於本所期限+2個月!!!"
'                        'Modify By Sindy 2012/12/10
''                        MsgBox "含關係企業客戶已發文應收帳款超過30萬以上, 此案為有期限案件," & vbCrLf & _
''                               "預定收款日不可大於本所期限+2個月!!!"
'                        MsgBox IIf(dblAmt >= dblChkAmt, "含關係企業客戶已發文應收帳款超過 NT " & Format(dblChkAmt, "#,##0") & "元 以上, ", "") & _
'                               "此案為有期限案件," & vbCrLf & _
'                               "預定收款日不可大於" & strText & "!!!"
'                        '2012/12/10 End
'                        SSTab1.Tab = 0
'                        Text1(118).SetFocus
'                        Screen.MousePointer = vbDefault
'                        Exit Function
'                     End If
'                 End If
'             End If
'        End If 'Add By Sindy 2014/3/10 END
      'end 2018/08/22
      
      'Modify By Sindy 2012/12/10
      'If dblAmt >= 300000 Then
      'Modified by Lydia 2020/02/03 應收帳款上限分開管制為個人"應收帳款上限"和"集團應收帳款上限"
'        If dblAmt >= dblChkAmt Then
'        '2012/12/10 End
'             'MsgBox "★★含關係企業客戶已發文應收帳款 NT " & Format(dblAmt, "#,##0") & "元, 請交主管及副總簽核!", vbInformation, "提示！"
'             MsgBox "★★含關係企業客戶已發文應收帳款 NT " & Format(dblAmt, "#,##0") & "元, 請交主管簽核!", vbInformation, "提示！"
''             ElseIf dblAmt >= 150000 Then
''                 MsgBox "★★含關係企業客戶已發文應收帳款 NT " & Format(dblAmt, "#,##0") & "元, 請交主管簽核!", vbInformation, "提示！"
'        End If
'        '2012/12/5 End
      'Modified by Lydia 2022/06/15 排除特定人員
      If InStr(m_ChkAmtExcept, Trim(Text1(10))) = 0 And dblAmt >= dblCu183 Then
          m_Msgbox = "★★客戶已發文應收帳款 NT " & Format(dblAmt, "#,##0") & "元(個人上限" & Format(dblCu183, "#,##0") & "元)"
'          MsgBox m_Msgbox & ", 呈主管簽核!", vbInformation, "提示！"
          'Add By Sindy 2022/9/14
          If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
             txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
          End If
          '2022/9/14 END
      'Add By Sindy 2022/9/16 原在GetCRL57,改在這裡統一檢查
      ElseIf dblAmt >= 150000 Then
         'Modify by Amy 2023/02/06 拿掉 & " (未達上限15萬)"-薛經理
         m_Msgbox = "客戶已發文應收帳款 NT " & Format(dblAmt, "#,##0")
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
         '2022/9/16 END
      End If
      'Modified by Lydia 2022/06/15 排除特定人員
      If InStr(m_ChkAmtExcept, Trim(Text1(10))) = 0 And (dblAmtR >= dblChkAmt And dblChkAmt > 0) Then
          m_Msgbox = "★★集團已發文應收帳款 NT " & Format(dblAmtR, "#,##0") & "元(集團上限" & Format(dblChkAmt, "#,##0") & "元)"
'          MsgBox m_Msgbox & ", 呈主管簽核!", vbInformation, "提示！"
          'Add By Sindy 2022/9/14
          If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
             txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
          End If
          '2022/9/14 END
      End If
      'end 2020/02/03
   Else
      'Add By Sindy 2022/9/16 原在GetCRL57,改在這裡統一檢查
      If dblAmt >= 150000 Then
         'Modified by Lydia 2020/02/03
         'DetailCase = DetailCase & "含關係企業客戶已發文應收帳款 NT " & Format(dblAmt, "#,##0") & vbcrlf
         'Modify by Amy 2023/02/06 拿掉 & " (未達上限15萬)"-薛經理
         m_Msgbox = "客戶已發文應收帳款 NT " & Format(dblAmt, "#,##0")
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
         '2022/9/16 END
      End If
    'Add By Sindy 2017/10/2
    '非專利處,有收費且為舊客戶,也要檢查預定收款日
    'Remove by Lydia 2018/08/22 (應收帳款管控)取消預定收款日,改成付款週期
'    ElseIf (PUB_GetStaffST15(Text1(10), "1") < "P10" Or PUB_GetStaffST15(Text1(10), "1") > "P19") And _
'      (Val(Text1(101)) > 0 Or Val(Text1(104)) > 0 Or Val(Text1(107)) > 0 Or Val(Text1(110)) > 0) And _
'      Trim(Text1(12)) <> "" Then
'      'Modify By Sindy 2017/10/13 有期限者
'      If Val(Text1(3)) > 0 Then
'      '2017/10/13 End
'         If Val(Text1(118)) <= 0 Then
'            MsgBox "預定收款日期不可空白!!!"
'            SSTab1.Tab = 0
'            Text1(118).SetFocus
'            Screen.MousePointer = vbDefault
'            Exit Function
'         '若有期限案件, 預定收款日不可大於本所期限+2個月
'         Else 'If Val(Text1(3)) > 0 Then
'            If m_CU143 = "" Then m_CU143 = "2" '預定收款日放寬月數
'            If strSrvDate(1) > DBDATE(Text1(3)) Then
'               strChkDate = strSrvDate(1)
'               strText = "系統日+" & m_CU143 & "個月"
'            Else
'               strChkDate = DBDATE(Text1(3))
'               strText = "本所期限+" & m_CU143 & "個月"
'            End If
'            If DBDATE(Val(Text1(118))) > Val(ChangeWDateStringToWString(DateAdd("M", m_CU143, ChangeWStringToWDateString(strChkDate)))) Then
'               MsgBox "此案為有期限案件," & vbCrLf & _
'                      "預定收款日不可大於" & strText & "!!!"
'               SSTab1.Tab = 0
'               Text1(118).SetFocus
'               Screen.MousePointer = vbDefault
'               Exit Function
'            End If
'         End If
'      End If
   '2017/10/2 END
   'end 2018/08/22
   End If
   '2012/11/08 End
   'Added by Lydia 2018/09/10 (應收帳款管控)取消預定收款日,改成付款週期,若超出期限彈訊息
   'Modified by Lydia 2018/10/01 新客戶不用判斷
   'If Val(Text1(101)) > 0 Or Val(Text1(104)) > 0 Or Val(Text1(107)) > 0 Or Val(Text1(110)) > 0 Then
   'If Text1(12) <> "" And (Val(Text1(101)) > 0 Or Val(Text1(104)) > 0 Or Val(Text1(107)) > 0 Or Val(Text1(110)) > 0) Then
   'Modified by Lydia 2022/11/02 排除國外部案源FCL
   If Text1(12) <> "" And Trim(Text1(6)) <> "FCL" Then
       'Modified by by Lydia 2019/05/13 改模組(一併取得)
       'If GetBillDate(Text1(12), strSrvDate(1), strExc(1), strExc(2)) = True Then
       '   MsgBox strExc(2) & "，印出接洽單後請交主管簽核", vbExclamation
       If mMemo <> "" Then
'           MsgBox mMemo & "，呈主管簽核", vbExclamation
           'Add By Sindy 2022/9/14
           m_Msgbox = mMemo
           If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
              txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
           End If
           '2022/9/14 END
       'end 2019/05/13
       End If
   End If
   'end 2018/09/10
   
   'Modify By Sindy 2022/9/16 原在GetCRL57,改在這裡統一檢查
   'Add By Sindy 2015/8/27
   '有應收帳款,則不可自動收文,需主管核示
   'Modified by Lydia 2017/06/29 新案不檢查
   'If (Text1(6) = "P" Or Text1(6) = "CFP") Then
   If (Text1(6) = "P" Or Text1(6) = "CFP") And Trim(Text1(7) <> "") And Option31(1).Value = True Then
      'For ii = 1 To 4
         'If (Trim(Left(Me.Combo1(ii).Text, 4)) = "605" Or Trim(Left(Me.Combo1(ii).Text, 4)) = "606" Or Trim(Left(Me.Combo1(ii).Text, 4)) = "607") Then
         If InStr(m_strCaseCPM, "605") > 0 Or _
            InStr(m_strCaseCPM, "606") > 0 Or _
            InStr(m_strCaseCPM, "607") > 0 Then
            'Memo by 2019/05/13 原模組找個案應收帳款較快
            'Modified by Lydia 2019/05/14 改模組
            'If GetBillData(Text1(12), dblAmt, dblPFee, dblTFee, , Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9)) = True Then
            'Modified by Lydia 2022/06/13 傳入收文之本所案號,案件性質(可用,串接)
            'If PUB_GetBillDataAll("1", Text1(12), dblAmt, dblPFee, dblTFee, , Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9)) = True Then
            'Modified by Lydia 2022/06/15 傳入收文之智權人員
            If PUB_GetBillDataAll("1", Text1(12), Text1(6) & IIf(Text1(7) <> "", Text1(7) & Left(Text1(8) & "0", 1) & Left(Text1(9) & "00", 2), ""), _
               m_strCaseCPM, _
               Trim(Text1(10)), dblAmt, dblPFee, dblTFee, , Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9)) = True Then
               '以個案算應收帳款
'               MsgBox "前款未收$" & Format(dblAmt, "#,##0") & "，需主管核示才可收文！", vbExclamation + vbOKOnly
               m_Msgbox = "★★前款未收$" & Format(dblAmt, "#,##0")
               If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
                  txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
               End If
            End If
         End If
      'Next ii
   End If
   '2022/9/16 END
   
   'Added by Lydia 2017/10/17 先檢查同卷號是否完整
   If Frame5.Visible = True And opt1(3).Value = True Then
      strErrTxt = ""
      For i = 0 To 3
         If strErrTxt = "" And Trim(TxtC1(i).Text) = "" Then
            strErrTxt = i
         End If
         If strErrTxt <> "" Then Exit For
      Next i
      If strErrTxt <> "" Then
        MsgBox "圖同本所案號請輸入完整案號!!", vbCritical
        Me.SSTab1.Tab = 4
        TxtC1(Val(strErrTxt)).SetFocus
        Screen.MousePointer = vbDefault
        Exit Function
      End If
   End If
   
   'Modified by Lydia 2016/04/26 因為程序大大,抽成模組判斷查名單對應
   'Modify By Sindy 2022/12/23
   'Modified by Lydia 2023/10/25 判斷從查名單明細收文過來 +Or cmdTMQ.Visible = True
   If cmdTMQApp.Visible = True Or cmdTMQ.Visible = True Then
   '2022/12/23 END
      'Modified by Lydia 2023/08/02
      'If GetTMQList = False Then
      If GetTMQList(TMQList) = False Then
          Me.SSTab1.Tab = 4
          Screen.MousePointer = vbDefault
          Exit Function
      End If
      'Added by Lydia 2024/03/14 增加存檔前對查名單的檢查
      If Replace(TMQList, ",", "") <> "" And mTQC01 = "" And InStr(cmdOK(0).Caption, "存檔") = 0 Then
         If PUB_TQCtoTMQ(True, GetST15(Text1(10)), Text1(10), "B" & TMQList, strExc(1)) = False Then
            Me.SSTab1.Tab = 4
            Screen.MousePointer = vbDefault
            Exit Function
         End If
      End If
      'end 2024/03/14
   End If
   'end 2016/04/26
   
   'Added by Lydia 2018/11/13 檢查相同文字／圖形，申請人已註冊
   If Option6(5).Value = True And Trim(Text1(133).Text) = "" Then
       If MsgBox("尚未輸入申請人已註冊之審定號，是否輸入？", vbCritical + vbYesNo + vbDefaultButton1) = vbYes Then
           SSTab1.Tab = 2
           Text1(133).SetFocus
           Call Text1_GotFocus(133)
           Screen.MousePointer = vbDefault
           Exit Function
       End If
   End If
   'end 2018/11/13
   
   'Added by Lydia 2018/12/10 檢查匯入的查名單是否齊備
   If ChkTMQList(TMQList) = False Then
       Me.SSTab1.Tab = 4
       Screen.MousePointer = vbDefault
       Exit Function
   End If
   'end 2018/12/10
   
   'Add by Amy 2017/01/20
   If Frame5.Visible = True Then
       strErrTxt = ""
       Call TxtC1_Validate(0, Cancel)
       If ExistCheck("TradeMark", "Tm01||Tm02||Tm03||Tm04", TxtC1(0) & TxtC1(1) & TxtC1(2) & TxtC1(3), strErrTxt) = False Then
           SSTab1.Tab = 4
           TxtC1(0).SetFocus
           Exit Function
       End If
   End If
   
   'Added by Morgan 2020/4/29
   If strLOS15 = "" Then
     If SrcSetLCase(True) = False Then
       Screen.MousePointer = vbDefault
       Exit Function
     End If
   End If
   'end 2020/4/29
   
   'Added by Morgan 2020/6/30
   '負點數者，都要提醒操作人員交主管簽核--瑞婷
   '收文不管控也不必印在說明欄,因為可能另外送簽--秀玲
'    If Val(Text1(103)) < 0 Or Val(Text1(106)) < 0 Or Val(Text1(109)) < 0 Or Val(Text1(112)) < 0 Then
'      MsgBox "本次接洽單有【負點數】，印出後請交主管簽核", vbExclamation
'    End If
   For ii = 1 To GridCase.Rows - 1
     If Val(Format(Trim(GridCase.TextMatrix(ii, 4)), "###0.000")) < 0 Then
'        MsgBox "本次接洽單有【負點數】，呈主管簽核", vbExclamation
        'Add By Sindy 2022/9/14
        m_Msgbox = "本次接洽單有【負點數】"
        If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
           txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
        End If
        '2022/9/14 END
     End If
   Next ii
   'end 2020/6/30
    
   'Added by Lydia 2021/02/24 大陸商標申請案及CFT申請案，均強迫填入相關資訊。T-商標說明、
'    strExc(1) = IIf(Trim(Left(Trim(Combo1(1)), 4)) <> "", Trim(Left(Trim(Combo1(1)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(2)), 4)) <> "", Trim(Left(Trim(Combo1(2)), 4)), "") & _
'                    "," & IIf(Trim(Left(Trim(Combo1(3)), 4)) <> "", Trim(Left(Trim(Combo1(3)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(4)), 4)) <> "", Trim(Left(Trim(Combo1(4)), 4)), "")
'    If (Left(Trim(Combo1(0)), 3) = "020" And Text1(6).Text = "T" And InStr(strExc(1), "101") > 0) Or Text1(6).Text = "CFT" And InStr(strExc(1), "101") > 0 Then
   If (Left(Trim(Combo1(0)), 3) = "020" And Text1(6).Text = "T" And InStr(m_strCaseCPM, "101") > 0) Or Text1(6).Text = "CFT" And InStr(m_strCaseCPM, "101") > 0 Then
       If Frame47.Visible = False Then
           Frame47.Visible = True
           Text7.Text = ""
       End If
       If Text7.Text = "" Then
           MsgBox Replace("請輸入" & fra47Title.Caption, "：", "") & "!!!", vbExclamation, "檢核資料"
           Me.SSTab1.Tab = 4
           Text7.SetFocus
           Text7_GotFocus
           Screen.MousePointer = vbDefault
           Exit Function
       End If
   End If
   'end 2021/02/24
   
   'Added by Morgan 2022/11/11
   '行政訴訟,參加訴訟須同時收文準備程序,言詞辯論
   If strLSourceType = "B2" And (Text1(6) = "P" Or Text1(6) = "T") Then
      strExc(1) = "": strExc(2) = "": strExc(3) = "": strExc(4) = ""
      If Text1(6) = "P" Then
         strExc(1) = "503,506"
         strExc(2) = "211"
         strExc(3) = "212"
      Else
         strExc(1) = "403,407"
         strExc(2) = "204"
         strExc(3) = "205"
      End If
      '檢查是否收文行政訴訟,參加訴訟
'      For ii = 1 To 4
'         If InStr(strExc(1), Trim(Left(Me.Combo1(ii).Text, 4))) > 0 Then
'            strExc(4) = Me.Combo1(ii).Text
'            Exit For
'         End If
'      Next
'      If ii < 5 Then
'         For ii = 1 To 4
'            If Trim(Left(Me.Combo1(ii).Text, 4)) = strExc(2) Then
'               Exit For
'            End If
'         Next
'         If ii = 5 Then
'            MsgBox "【" & strExc(4) & "】必須同時收文【" & strExc(2) & "準備程序】!!!", vbExclamation, "檢核資料"
'            SSTab1.Tab = 0
'            Screen.MousePointer = vbDefault
'            Exit Function
'         Else
'            For ii = 1 To 4
'               If Trim(Left(Me.Combo1(ii).Text, 4)) = strExc(3) Then
'                  Exit For
'               End If
'            Next
'            If ii = 5 Then
'               MsgBox "【" & strExc(4) & "】必須同時收文【" & strExc(3) & "言詞辯論】!!!", vbExclamation, "檢核資料"
'               SSTab1.Tab = 0
'               Screen.MousePointer = vbDefault
'               Exit Function
'            End If
'         End If
'      End If
      'Modify By Sindy 2022/11/11
      arrCP10 = Split(strExc(1), ",")
      strExc(4) = "" 'Added by Morgan 2023/3/16
      For ii = 0 To UBound(arrCP10)
         strTemp = arrCP10(ii)
         If strTemp <> "" Then
            If InStr(m_strCaseCPM, strTemp) > 0 Then
               strExc(4) = strTemp & GetPrjState6(Text1(6), strTemp)
               Exit For
            End If
         End If
      Next ii
      If strExc(4) <> "" Then 'Added by Morgan 2023/3/16
         If InStr(m_strCaseCPM, strExc(2)) = 0 Then
            MsgBox "【" & strExc(4) & "】必須同時收文【" & strExc(2) & "準備程序】!!!", vbExclamation, "檢核資料"
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
         End If
         If InStr(m_strCaseCPM, strExc(3)) = 0 Then
            MsgBox "【" & strExc(4) & "】必須同時收文【" & strExc(3) & "言詞辯論】!!!", vbExclamation, "檢核資料"
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
         End If
      End If
      '2022/11/11 END
   End If
   'end 2022/11/11
       
   'Add By Sindy 2022/9/15
   'Modify By Sindy 2023/4/6 對造為本所客戶時也需簽准文件(特例主管也要簽核)
   bolCRA26isY = False 'Add By Sindy 2023/4/6
   For Each objChk In Me.ChkCRA26
      If objChk.Value = vbChecked Then '有對造
         bolCRA26isY = True 'Add By Sindy 2023/4/6
'         If ChkCRL66.Value = vbUnchecked Then '無簽准
'            MsgBox "申請人有對造狀況，請附上主管簽准文件的電子檔（並自行勾選對造已簽准），才可收文！", vbExclamation, "檢核資料"
'            Me.SSTab1.Tab = 0
'            Screen.MousePointer = vbDefault
'            Exit Function
'         End If
      End If
   Next
   '新客戶對造 或 案件對造為本所客戶
   If bolCRA26isY = True Or Check7(0).Value = 1 Then
      If ChkCRL66.Value = vbUnchecked Then '無簽准
         MsgBox "申請人有對造狀況，請附上主管簽准文件的電子檔（並自行勾選對造已簽准），才可收文！", vbExclamation, "檢核資料"
         Me.SSTab1.Tab = 0
         Screen.MousePointer = vbDefault
         Exit Function
      End If
   ElseIf ChkCRL66.Value = vbChecked Then '無對造,無須勾選（對造已簽准）
      MsgBox "尚未勾選對造，無須勾選（對造已簽准）！", vbExclamation, "檢核資料"
      Me.SSTab1.Tab = 0
      Screen.MousePointer = vbDefault
      Exit Function
   End If
   '2023/4/6 END
   '2022/9/15 END
   'Add By Sindy 2022/9/28
   'L-888888(案件名稱：特殊狀況發函)須將簽核的信函當作附件進行收文
   If Text1(6) = "L" And Text1(7) = "888888" Then
      If ChkCRL66.Value = vbUnchecked Then '無簽准
         MsgBox "L-888888案件，請附上主管簽准文件的電子檔（並自行勾選對造已簽准），才可收文！", vbExclamation, "檢核資料"
         Me.SSTab1.Tab = 0
         Screen.MousePointer = vbDefault
         Exit Function
      End If
   End If
   If ChkCRL66.Value = vbChecked Then '有簽准,要有附件
      If m_strSaveFiles = "" And m_strSaveFiles2 = "" And Me.cmdAddAtt.BackColor = &H808080 Then
         MsgBox "請附上簽准文件的電子檔，才可收文！", vbExclamation, "檢核資料"
         Me.SSTab1.Tab = 0
         Screen.MousePointer = vbDefault
         Exit Function
      End If
   End If
   '有點數低於底價,檢查是否有勾選
   If InStr(txtCRL69.Text, "點數低於底價") > 0 Then
      If Check12.Value = vbUnchecked Then '未勾選費用已核准
         If MsgBox("有點數低於底價，請附上智權主管核准文件的電子檔（並自行勾選費用已核准）？" & vbCrLf & _
            "是: 費用已核准請勾選起來, 並附上同意文件" & vbCrLf & _
            "否: 經主管簽核", vbCritical + vbYesNo + vbDefaultButton1) = vbYes Then
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
         End If
      End If
   End If
   If Check12.Value = vbChecked Then '費用已核准,要有附件
      If m_strSaveFiles = "" And m_strSaveFiles2 = "" And Me.cmdAddAtt.BackColor = &H808080 Then
         MsgBox "請附上智權主管[費用已核准]文件的電子檔，才可勾選費用已核准！", vbExclamation, "檢核資料"
         Me.SSTab1.Tab = 0
         Screen.MousePointer = vbDefault
         Exit Function
      End If
   End If
   '2022/9/28 END
   
   'Add By Sindy 2022/10/3
   If Option1(0).Value = True Then '新案
      If m_strSaveFiles = "" And m_strSaveFiles2 = "" And Me.cmdAddAtt.BackColor = &H808080 Then
         If MsgBox("尚未匯入電子檔，是否繼續？", vbCritical + vbYesNo + vbDefaultButton1) = vbNo Then
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
         End If
      End If
   End If
   '2022/10/3 END
      
   '*************************************************************
   '電子收文新增檢查條件(來自frm010001)
   '*************************************************************
   Dim rsTmp As New ADODB.Recordset
   Dim strSK02 As String, strSK03 As String
   
   strSql = "SELECT * FROM SYSTEMKIND " & _
            "WHERE SK01 = '" & Text1(6) & "' "
   rsTmp.CursorLocation = adUseClient
   rsTmp.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
   If rsTmp.RecordCount > 0 Then
      rsTmp.MoveFirst
      If IsNull(rsTmp.Fields("SK02")) = False Then
         strSK02 = rsTmp.Fields("SK02")
      End If
      If IsNull(rsTmp.Fields("SK03")) = False Then
         strSK03 = rsTmp.Fields("SK03")
      End If
   End If
   rsTmp.Close
   
   '舊案
   If Option1(1).Value = True Then
      If ((strSK02 = "2" And strSK03 = "0") Or (strSK02 = "6" And strSK03 = "0")) And _
         InStr(m_strCaseCPM, "728") > 0 Then
         strSql = "SELECT count(*) FROM caseprogress " & _
                  "WHERE cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Text1(8) & "' and cp04='" & Text1(9) & "' and cp10='728' "
         rsTmp.CursorLocation = adUseClient
         rsTmp.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
         If rsTmp.RecordCount > 0 Then
            If rsTmp.Fields(0) > 0 Then
               If MsgBox("此案件已轉案至他所，是否繼續？", vbCritical + vbYesNo + vbDefaultButton1) = vbNo Then
                  SSTab1.Tab = 0
                  Screen.MousePointer = vbDefault
                  Exit Function
               End If
            End If
         End If
         rsTmp.Close
      End If
      
      If Text1(6) = "S" Or Text1(6) = "TS" Then
         strSql = "select * from servicepractice " & _
                  "where sp01='" & Text1(6) & "' and sp02='" & Text1(7) & "' and sp03='" & Text1(8) & "' and sp04='" & Text1(9) & "' " & _
                  "and instr(sp18,'轉入商標')>0 "
         rsTmp.CursorLocation = adUseClient
         rsTmp.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
         If rsTmp.RecordCount > 0 Then
            MsgBox "此案號已轉入商標案，不可再收文！", vbExclamation
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
         End If
         rsTmp.Close
      End If
      
      'P,FCP已收過928重新委任(未取消收文)都不可再收文,不管接洽單或內部收文
      If (Text1(6) = "P" Or Text1(6) = "FCP") And InStr(m_strCaseCPM, "928") > 0 Then
         strSql = "select * from caseprogress where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Text1(8) & "' and cp04='" & Text1(9) & "' and cp10='928' and cp57 is null "
         rsTmp.CursorLocation = adUseClient
         rsTmp.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
         If rsTmp.RecordCount > 0 Then
            MsgBox "此案已收過928重新委任, 不可再收此案件性質！", vbExclamation
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
         End If
         rsTmp.Close
         '檢查是否同意重新委任
         If PUB_ChkAgree928(Text1(6), Text1(7), Text1(8), Text1(9), False) = False Then
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
         End If
      End If
      
      If (Text1(6) = "T" Or Text1(6) = "CFT" Or Text1(6) = "FCT" Or Text1(6) = "TF") And InStr(m_strCaseCPM, "308") > 0 Then
         strSql = "select * from trademark where tm10 not in ('000','020') " & _
                  "and tm01='" & Text1(6) & "' and tm02='" & Text1(7) & "' and tm03='" & Text1(8) & "' and tm04='" & Text1(9) & "' "
         rsTmp.CursorLocation = adUseClient
         rsTmp.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
         If rsTmp.RecordCount > 0 Then
            MsgBox "商標分割非台灣案及非大陸案只能收新案！", vbExclamation
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
         End If
         rsTmp.Close
      End If
      
      '大陸107.復審案下一程序只有一筆復審期限時,不可收文延期404
      If Text1(6) = "P" And InStr(m_strCaseCPM, "404") > 0 Then
         strSql = "Select NP07 FROM nextprogress,Patent WHERE NP02=PA01 and NP03=PA02 and NP04=PA03 and NP05=PA04" & _
                  " and NP02='" & Text1(6) & "' and NP03='" & Text1(7) & "' and NP04='" & Text1(8) & "' and NP05='" & Text1(9) & "'" & _
                  " and NP06 is null and PA09='020'" & strNpSqlOfNoSalesDuty
         rsTmp.CursorLocation = adUseClient
         rsTmp.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
         If rsTmp.RecordCount = 1 Then
            If rsTmp.Fields("NP07").Value = "107" Then
               MsgBox "請通知智權同仁依大陸專利法規定復審案不得延期。", vbExclamation
               SSTab1.Tab = 0
               Screen.MousePointer = vbDefault
               Exit Function
            End If
         End If
         rsTmp.Close
      End If
      
      '專利修法問題,接洽單也要檢查
      If (Text1(6) = "P" Or Text1(6) = "FCP") Then
         '加判斷申請國家=台灣
         If Trim(Left(Combo1(0), 4)) = "000" Then
            '國內延緩公告案需控制領證未發文
            If InStr(m_strCaseCPM, "412") > 0 Then
               If PUB_RecvCheck412(Text1(6), Text1(7), Text1(8), Text1(9)) = False Then
                  Exit Function
               End If
            '技術報告發文時無公告日不可發文，無公告日不可發文或公告日<93.7.1者不可收文也不可發文
            '加807第三人申請技術報告
            ElseIf InStr(m_strCaseCPM, "421") > 0 Or InStr(m_strCaseCPM, "807") > 0 Then
               If PUB_Check421(Text1(6), Text1(7), Text1(8), Text1(9), 1, IIf(InStr(m_strCaseCPM, "421") > 0, "421", "807")) = False Then
                  Exit Function
               End If
            '新型主動修正期限為申請日起兩個月
            ElseIf InStr(m_strCaseCPM, "203") > 0 Then
               If PUB_Check203(Text1(6), Text1(7), Text1(8), Text1(9)) = False Then
                  Exit Function
               End If
            End If
         End If
      End If
   End If
   Set rsTmp = Nothing
   '**************************** END *********************************
   
   'Add By Sindy 2022/12/5 證書形式
   If Text1(145).Visible = True Then
      If Len(Text1(145)) = 0 Then
         MsgBox "證書形式不可空白！", vbExclamation, "檢核資料"
         Me.SSTab1.Tab = 0
         Text1(145).SetFocus
         Screen.MousePointer = vbDefault
         Exit Function
      'Add By Sindy 2023/7/20
      ElseIf Text1(145) <> "1" And Text1(145) <> "2" Then
         MsgBox "證書形式僅可輸入 1 或 2！", vbExclamation, "檢核資料"
         Me.SSTab1.Tab = 0
         Text1(145).SetFocus
         Screen.MousePointer = vbDefault
         Exit Function
         '2023/7/20 END
      End If
   End If
   
   'Add By Sindy 2022/12/23 (從收文作業的檢查)接洽單會清除申請人的性質收文時要檢查不可為原申請人(Ex: P-129722)
   'Modify By Sindy 2023/2/15 +合併(702)
   'Modify By Sindy 2023/10/30 增加檢查是否新案,若為新案則不需要檢查申請人 ex:CFP-034069(101+701)
   Dim bolNewCase As Boolean
   m_strCaseCPM = GetAllCaseCPM(bolNewCase)
   If bolNewCase = False Then
   '2023/10/30 END
      If Option1(1).Value = True Then
         '畫面上的申請人
         strAppl = ""
         For i = 0 To 4
            '畫面上的客戶編號
            If Trim(Me.Text1(12 + (16 * i)).Text) <> "" Then
               strAppl = strAppl & "," & Trim(Me.Text1(12 + (16 * i)).Text)
            'Modify By Sindy 2023/6/16 為新客戶也不用檢查此規則,填*號
            ElseIf Trim(Me.Text1(21 + (16 * i)).Text) <> "" Or Trim(Me.Text1(22 + (16 * i)).Text) <> "" Then
               If (i = 0 And Me.Option31(0).Value = True) Or _
                  (i = 1 And Me.Option32(0).Value = True) Or _
                  (i = 2 And Me.Option33(0).Value = True) Or _
                  (i = 3 And Me.Option34(0).Value = True) Or _
                  (i = 4 And Me.Option35(0).Value = True) Then
                  strAppl = strAppl & "," & "＊"
               End If
               '2023/6/16 END
            End If
         Next i
         If strAppl <> "" Then strAppl = Mid(strAppl, 2)
         '基本檔裡的申請人
         strExc(10) = strAppl1 & IIf(strAppl2 <> "", "," & strAppl2, "") & _
                                 IIf(strAppl3 <> "", "," & strAppl3, "") & _
                                 IIf(strAppl4 <> "", "," & strAppl4, "") & _
                                 IIf(strAppl5 <> "", "," & strAppl5, "")
         
         If ((Trim(Text1(6).Text) = "P" Or Trim(Text1(6).Text) = "FCP" Or Trim(Text1(6).Text) = "CFP") And _
             (InStr(m_strCaseCPM, "701") > 0 Or InStr(m_strCaseCPM, "702") > 0 Or InStr(m_strCaseCPM, "703") > 0 Or InStr(m_strCaseCPM, "708") > 0)) _
            Or _
            ((Trim(Text1(6).Text) = "CFT" Or Trim(Text1(6).Text) = "CFC" Or Trim(Text1(6).Text) = "FCT" Or _
              Trim(Text1(6).Text) = "T" Or Trim(Text1(6).Text) = "TB" Or Trim(Text1(6).Text) = "TC" Or _
              Trim(Text1(6).Text) = "TF") And InStr(m_strCaseCPM, "501") > 0) Then
            'Modify By Sindy 2023/5/8 ex:P-125519 原申請人有二個X55798000+X55798030
            '現在專利權讓與之受讓人僅一個X55798，此為正常情形，應可收文。
            '錯誤的檢查應該是5個申請人不可完全相同。
            If strAppl = strExc(10) Then
               'Modify By Sindy 2023/2/14 秀玲：收文讓渡時，現在程式有控制舊案輸入之申請人不可與基本檔相同；
               '                                請控制CFP美國(101)案若新案CP31='Y'那一道未發文則開放這個限制。
               bolChkOk = False
               strSql = "SELECT * FROM caseprogress,patent" & _
                        " WHERE cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Text1(8) & "' and cp04='" & Text1(9) & "'" & _
                        " AND cp01=pa01 AND cp02=pa02 AND cp03=pa03 AND cp04=pa04 AND cp01='CFP' AND pa09='101' AND cp31='Y' AND cp27||cp57 is null"
               rsTmp.CursorLocation = adUseClient
               rsTmp.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
               If rsTmp.RecordCount > 0 Then
                  bolChkOk = True
               End If
               rsTmp.Close
               If bolChkOk = False Then
               '2023/2/14 END
                  MsgBox "畫面上輸入的客戶編號(" & strAppl & ")不可同於原申請人編號(" & strExc(10) & ")！", vbExclamation, "檢核資料"
                  Me.SSTab1.Tab = 1
                  Screen.MousePointer = vbDefault
                  Exit Function
               End If
            End If
            '2023/5/8 END
         'Add By Sindy 2023/11/13
         Else
            If strAppl <> strExc(10) Then
               MsgBox "非權利轉讓案件性質不可任意修改原申請人編號(" & strExc(10) & ")！", vbExclamation, "檢核資料"
               Me.SSTab1.Tab = 1
               Screen.MousePointer = vbDefault
               Exit Function
            End If
            '2023/11/13 END
         End If
      End If
      '2022/12/23 END
   End If
   
   'Add By Sindy 2022/12/23 CFP的美國發明專利申請案，若是智權同仁收文時收了121主張國內優先權，但未收201新案翻譯，
   '請新增跳出提醒「若暫時申請案以中文送件，正式申請案須收新案翻譯。 ex:CFP-033431(美國暫時申請)
   Cancel = False
   If Text1(6) = "CFP" And Left(Trim(Combo1(0).Text), 3) = "101" And Left(Trim(Combo6.Text), 1) = "1" Then
      If InStr(m_strCaseCPM, "121") > 0 And InStr(m_strCaseCPM, "201") = 0 Then
         Cancel = True
         If Option1(1).Value = True Then
            If PUB_ChkCPExist(pa, "201") = True Then
               Cancel = False
            End If
         End If
         If Cancel = True Then
            If MsgBox("若暫時申請案以中文送件，正式申請案須收新案翻譯，是否繼續？", vbCritical + vbYesNo + vbDefaultButton1) = vbNo Then
               SSTab1.Tab = 0
               Screen.MousePointer = vbDefault
               Exit Function
            End If
         End If
      End If
   End If
   '2022/12/23 END
   
   CheckDataValidate4 = True
End Function

'Modified by Lydia 2017/06/19 將CheckDataValidate2改為CheckDataValidate3
Private Function CheckDataValidate3(Index As Integer) As Boolean
Dim rsA As New ADODB.Recordset
Dim StrSQLa As String
Dim i As Integer, j As Integer, ii As Integer, kk As Integer
Dim Cancel As Boolean
Dim strErrTxt As String, bolChkErr As Boolean, strText As String 'Add By Sindy 2012/6/6
Dim strChkDate As String 'Add By Sindy 2015/4/16
'Add by Amy 2016/01/07
Dim stZipCode As String
Dim intArea As Integer
Dim bolNewCus As Boolean '申請人是否為新客戶
'Add by Amy 2017/03/22
Dim bolData As Boolean
Dim strMCTFNew(0) As String, strTmp(0) As String
Dim intTW As Integer 'Add by Amy 2017/06/06 for 判斷台灣地址回傳用
Dim ArrStr As Variant
Dim bolT000EP06 As Boolean 'Add By Sindy 2022/9/8
Dim StrCuSales1 As String   '申請人1業務區 Modify By Sindy 2022/9/14
Dim bolCancel As Boolean
Dim strChkSql(1) As String 'Modify by Amy 2024/04/24原:strChkSql 'Add By Sindy 2023/3/23
Dim varTemp As Variant, bolIsACSTIPS As Boolean 'Add By Sindy 2023/9/5
Dim IsTWAddr As Boolean 'Add by Amy 2024/06/20
Dim varTmp As Variant 'Add By Sindy 2025/3/26
    
    'Add By Sindy 2015/4/15
    If Option1(1).Value = True And Text1(6) = "P" And _
        (InStr(m_strCaseCPM, "601") > 0) Then
        strExc(0) = "SELECT pa15,pa22 FROM patent WHERE pa01='" & pa(1) & "' and pa02='" & pa(2) & "' and pa03='" & pa(3) & "' and pa04='" & pa(4) & "'"
        intI = 1
        Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
        If intI = 1 Then
            If ("" & RsTemp.Fields("pa15")) <> "" Or ("" & RsTemp.Fields("pa22")) <> "" Then
                MsgBox "此本所案號已有公告號或專利號數, 不可收文領證！", vbExclamation + vbOKOnly
                SSTab1.Tab = 0
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        End If
    End If
    '2015/4/15 END
    
    'Add By Amy 2018/03/15 +舊案收701(讓與) 時, 若該案號已有專利號數,則顯示訊息且不可收讓與
    If Option1(1).Value = True And Text1(6) = "P" And _
        (InStr(m_strCaseCPM, "701") > 0) Then
        strTmp(0) = "Select pa22 From Patent Where pa01='" & pa(1) & "' and pa02='" & pa(2) & "' and pa03='" & pa(3) & "' and pa04='" & pa(4) & "'"
        intI = 1
        Set RsTemp = ClsLawReadRstMsg(intI, strTmp(0))
        If intI = 1 Then
            If "" & RsTemp.Fields("pa22") <> MsgText(601) Then
                MsgBox "本案已有專利號數,請改收708(專利權讓與)！！", vbExclamation + vbOKOnly
                SSTab1.Tab = 0
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        End If
    End If
    '2018/03/15
    
    'Add by Amy 2016/05/20 +CFT新案申請案(101)申請國家為緬甸/阿根廷/委內瑞拉/埃及/玻利維亞時必需同時填寫「文件簽證(711)」
    'Modify By Sindy 2023/7/20 配合緬甸新商標法實施，申請案收文時不再強制一併收文「文件公/簽證」 取消:Left(Trim(Combo1(0).Text), 3) = "048" Or 此段程式
    If Text1(6) = "CFT" And Option1(0).Value = True And (Left(Trim(Combo1(0).Text), 3) = "118" _
        Or Left(Trim(Combo1(0).Text), 3) = "113" Or Left(Trim(Combo1(0).Text), 3) = "303" Or Left(Trim(Combo1(0).Text), 3) = "120") Then
        If (InStr(m_strCaseCPM, "101") > 0) _
            And InStr(m_strCaseCPM, "711") = 0 Then
            MsgBox "此國家申請案請同時收文「文件公／簽證 711」，並將費用分開！", vbExclamation + vbOKOnly
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    'end 2016/05/20
    
    'Add By Sindy 2011/7/26 L或LA新案時, 接洽記錄單程式檢查
    If (Text1(6) = "L" Or Text1(6) = "LA") And Option1(0).Value = True Then
        '申請人1為X65299謝律師, 未輸入申請人2時
        'Modify By Sindy 2011/9/29 未輸入申請人2:舊客戶時,客戶編號為空白或新客戶時,客戶名稱為空白
        If Left(Trim(Text1(12)), 6) = "X65299" And _
            ((Option32(1).Value = True And Trim(Text1(28)) = "") Or _
            (Option32(0).Value = True And Trim(Text1(37)) = "" And Trim(Text1(38)) = "")) Then
            MsgBox "與謝律師合作案件請於申請人1輸入X65299謝智硯律師事務所, 申請人2欄填實際客戶資料, 以便將來可查詢 !!!", vbExclamation + vbOKOnly
            SSTab1.Tab = 1
            SSTab2.Tab = 1
            Text1(28).SetFocus
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        '申請人2~5為X65299謝律師時
        If Left(Trim(Text1(28)), 6) = "X65299" Or Left(Trim(Text1(44)), 6) = "X65299" Or _
            Left(Trim(Text1(60)), 6) = "X65299" Or Left(Trim(Text1(76)), 6) = "X65299" Then
            MsgBox "與謝律師合作案件請於申請人1輸入X65299謝智硯律師事務所, 申請人2欄填實際客戶資料, 以便將來可查詢 !!!", vbExclamation + vbOKOnly
            SSTab1.Tab = 1
            If Left(Trim(Text1(28)), 6) = "X65299" Then SSTab2.Tab = 1: Text1(28).SetFocus
            If Left(Trim(Text1(44)), 6) = "X65299" Then SSTab2.Tab = 2: Text1(44).SetFocus
            If Left(Trim(Text1(60)), 6) = "X65299" Then SSTab2.Tab = 3: Text1(60).SetFocus
            If Left(Trim(Text1(76)), 6) = "X65299" Then SSTab2.Tab = 4: Text1(76).SetFocus
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    '2011/7/26 End
    
    'Add by Amy 2016/08/16 +已收放棄專利權且已發文及已通知專利權公告作廢,不能再收文年費控制制 ex:P-104016
    If InStr(Text1(6), "P") > 0 And (InStr(m_strCaseCPM, "605") > 0 Or InStr(m_strCaseCPM, "606") > 0 Or InStr(m_strCaseCPM, "607") > 0) Then
        strErrTxt = ChkP429Or1606(Text1(6), Text1(7), Text1(8), Text1(9), Left(Me.Combo1(0).Text, 3))
        If strErrTxt <> MsgText(601) Then
            MsgBox "本案已「" & strErrTxt & "」無需再繳納年費！", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    'end 2016/08/16
   
   'Add By Sindy 2023/9/5 檢查是否為ACS案件的TIPS
   varTemp = Split(Trim(m_strCaseCPM), ",")
   bolIsACSTIPS = False
   For ii = LBound(varTemp) To UBound(varTemp)
      'And Trim(Combo4) = m_CompNameJ
      If PUB_ChkACSforTIPS(Me.Text1(6).Text & IIf(Option1(1).Value = True, Me.Text1(7).Text & Me.Text1(8).Text & Me.Text1(9).Text, ""), _
                           varTemp(ii)) = True Then
         'Add By Sindy 2023/9/6 第一個案件性質為代收代付時,不能鎖定收據暫不列印
         If Not (ii = 0 And varTemp(ii) = "706") Then
            bolIsACSTIPS = True
            Check8(0).Value = 0
            Check8(1).Value = 0
            Check8(2).Value = 0
            If Check2.Value = 0 Then
               Check2.Value = 1 '收據暫不列印
               MsgBox "ACS案的TIPS輔導案件系統控制鎖定：收據暫不列印！", vbInformation, "提醒"
            End If
            If Option1(1).Value = True Then Exit For '舊案只須依案號檢查一次即可
         End If
      End If
      'Modify By Sindy 2023/11/8 管制LA的案件性質0顧問聘任及ACS的112智財顧問，不可勾選「收據暫不列印」
      If (Text1(6) = "LA" And varTemp(ii) = "0") Or (Text1(6) = "ACS" And varTemp(ii) = "112") Then
         If Check2.Value = 1 Then
            MsgBox "LA的顧問聘任及ACS的智財顧問，不可勾選「收據暫不列印」！", vbExclamation
            Exit Function
         End If
      End If
      'W3001開發組，只可收文ACS之501市場開發的案件性質，並且不可收費，也不可收點選新客戶。
      If Text1(10) = "W3001" Then
         If Text1(6) & m_strCaseCPM <> "ACS501" Or _
            (Val(Format(Trim(GridCase.TextMatrix(1, 2)), "###0")) <> 0 Or _
             Val(Format(Trim(GridCase.TextMatrix(1, 3)), "###0")) <> 0 Or _
             Val(Format(Trim(GridCase.TextMatrix(1, 4)), "###0.000")) <> 0) Then
            MsgBox "W3001開發組，只可收文ACS之501市場開發的案件性質，並且不可收費。", vbExclamation
            Exit Function
         End If
      End If
      '2023/11/8 END
   Next ii
   If bolIsACSTIPS = False Then
   '2023/9/5 END
      '2013/10/14 add by sonia 收據自動列印時間點
      If Check2.Value = 1 And Check8(0).Value = 0 And Check8(1).Value = 0 And Check8(2).Value = 0 Then
         If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
         MsgBox "暫不列印收據, 請選擇收據自動列印時間點！", vbCritical
         Exit Function
      End If
      '2013/10/14 end
      'add by sonia 2013/11/18 收據自動列印時間點
      If Check2.Value = 0 And (Check8(0).Value = 1 Or Check8(1).Value = 1 Or Check8(2).Value = 1) Then
         If SSTab1.Tab <> 0 Then SSTab1.Tab = 0
         MsgBox "已選擇收據自動列印時間點, 請勾選暫不列印收據！", vbCritical
         Exit Function
      End If
      '2013/11/18 end
      'Add By Sindy 2012/11/12
      '收據暫不列印時,非台灣案才可選擇第2,3項
      arrNation = Split(Me.Combo1(0).Text, " ") '申請國家
      'If Val(Text1(101)) > 0 Or Val(Text1(104)) > 0 Or Val(Text1(107)) > 0 Or Val(Text1(110)) > 0 Then
      If Val(m_dblTotRvFee) > 0 Then
          If Check2.Value = 1 And arrNation(0) = "000" And (Check8(1).Value = 1 Or Check8(2).Value = 1) Then
              MsgBox "非台灣案時, 收據自動列印時間點才可選擇2 或 3 !!!"
              SSTab1.Tab = 0
              Screen.MousePointer = vbDefault
              Exit Function
          End If
      End If
      'end 2012/11/12
   End If
   'Add By Sindy 2023/12/19 PS及CPS之智財協作967，TT及S之智財協作737，L之智財協作7601，(也可用案件性質中文判斷)
   '在收文時一定要輸「本案與總號之有關」欄，且必須要有ACS且為TIPS的案件，
   '提醒文字：「案件性質為智財協作，請輸入ACS之TIPS案件案號於「本案與總號之有關」欄」。
   '註: 舊的接洽單不會有國外部人員填智財協作; 所以沒有改舊程式
   If ((Me.Text1(6).Text = "PS" Or Me.Text1(6).Text = "CPS") And InStr(m_strCaseCPM, "967") > 0) _
      Or ((Me.Text1(6).Text = "TT" Or Me.Text1(6).Text = "S") And InStr(m_strCaseCPM, "737") > 0) _
      Or (Me.Text1(6).Text = "L" And InStr(m_strCaseCPM, "7601") > 0) Then
      If Trim(Text1(100)) = "" Then
         'Modify By Sindy 2024/5/10 + 智財布局分析
         MsgBox "案件性質為智財協作，請輸入ACS之TIPS或智財布局分析案件案號於「本案與總號之有關」欄，不可空白！", vbExclamation
         Me.SSTab1.Tab = 1
         Me.SSTab2.Tab = 0
         Screen.MousePointer = vbDefault
         Exit Function
      Else
         '多個案號
         varTemp = Split(Trim(Text1(100)), ",")
         For kk = LBound(varTemp) To UBound(varTemp)
            'strCaseNo = varTemp(kk)
            ChgCaseNo Replace(Trim(varTemp(kk)), "-", ""), strCase
            'Modify By Sindy 2024/5/10 + 113=智財布局分析
            If PUB_ChkACSforTIPS(strCase(1) & strCase(2) & strCase(3) & strCase(4), , , "113") = False Then
               'Modify By Sindy 2024/5/10 + 智財布局分析
               MsgBox "案件性質為智財協作，請輸入ACS之TIPS或智財布局分析案件案號於「本案與總號之有關」欄！" & vbCrLf & _
                      "(" & strCase(1) & strCase(2) & strCase(3) & strCase(4) & " 非ACS之TIPS或智財布局分析案件)", vbExclamation
               Me.SSTab1.Tab = 1
               Me.SSTab2.Tab = 0
               Screen.MousePointer = vbDefault
               Exit Function
            End If
         Next kk
      End If
   End If
   '2023/12/19 END
   
    'add by sonia 2015/9/15 舊案且出名公司已為智權公司者,不再檢查客戶為不開發票者(因為可能後來才設定不可開發票P-109811)
    If Combo4.Enabled = False Then
    Else
    'end 2015/9/15
        'Add By Sindy 2013/12/16 客戶為不開發票者，不可選擇智權公司
        'Modified by Lydia 2020/03/30
        'If (m_CU144(1) = "N" Or m_CU144(2) = "N" Or m_CU144(3) = "N" Or _
            m_CU144(4) = "N" Or m_CU144(5) = "N") And _
            Trim(Combo4) = "智權公司" Then
        '    MsgBox "因客戶設定為不開發票，所以收據公司別不可選擇為智權公司!!!"
        If (m_CU144(1) = "N" Or m_CU144(2) = "N" Or m_CU144(3) = "N" Or _
            m_CU144(4) = "N" Or m_CU144(5) = "N") And _
            Trim(Combo4) = m_CompNameJ Then
            MsgBox "因客戶設定為不開發票，所以收據公司別不可選擇為" & m_CompNameJ & "!!!"
        'end 2020/03/30
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        '2013/12/16 END
    End If
        
    'Add By Sindy 2013/12/14 申請國家為台灣者,收據公司別不可選擇智權公司
    'Modified by Lydia 2020/03/30
    'If arrNation(0) = "000" And Trim(Combo4) = "智權公司" Then
    '    MsgBox "申請國家為台灣者，收據公司別不可選擇智權公司!!!"
    'Modified by Lydia 2020/10/14 排除ACS案
    'If arrNation(0) = "000" And Trim(Combo4) = m_CompNameJ Then
    If Text1(6) <> "ACS" And arrNation(0) = "000" And Trim(Combo4) = m_CompNameJ Then
        MsgBox "申請國家為台灣者，收據公司別不可選擇" & m_CompNameJ & "!!!"
    'end 2020/03/30
        SSTab1.Tab = 0
        Screen.MousePointer = vbDefault
        Exit Function
    End If
    '2013/12/14 END
    
    'Added by Lydia 2020/10/14 ACS案之接洽單及財務收據開立增加控管方式：判斷該案收文進度若有101專利布局分析，則不可開智權公司。
    If Text1(6) = "ACS" And Trim(Combo4) = m_CompNameJ Then
        strExc(0) = ""
        If Option1(1).Value = True And Text1(7).Text <> "" Then '舊案
           strExc(1) = Text1(6).Text
           strExc(2) = Text1(7).Text
           strExc(3) = Left(Text1(8) & "0", 1)
           strExc(4) = Left(Text1(9) & "00", 2)
           'Modified by Lydia 2020/11/24 101專利布局分析已改為113
           If PUB_ChkCPExist(strExc, "113", , strExc(0)) = True Then
           End If
        End If
        'Modified by Lydia 2020/11/24 101專利布局分析已改為113
        If strExc(0) <> "" Or (InStr(m_strCaseCPM, "113") > 0) Then
            MsgBox "ACS案有收文113專利布局分析，收據公司別不可選擇" & m_CompNameJ & "!!!"
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    'end 2020/10/14
    
    'Added by Lydia 2021/05/07 ACS智財顧問專業分配比例管制
    If m_ACS112chk <> "" Then '重新檢查
        Call SetACS112data
        If m_ACS112chk <> "" Then
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    'end 2021/05/07
    
    'Add By Sindy 2014/2/7 點選特殊收據時,請輸入資料
    If Check9.Value = 1 Then
        If m_stCRL97 = "" Then
            MsgBox "請輸入特殊收據資料!!!"
            Me.SSTab1.Tab = 0
            cmdCRL119.SetFocus
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        'Add by Amy 2015/10/23 +特殊收據判斷
        If m_stCRL97 = "1" And m_stCRL98 <> MsgText(601) And m_stCRL120 <> MsgText(601) And (Trim(m_stCRL118) = MsgText(601) Or Trim(m_stCRL118) = "無") Then
            MsgBox "特殊收據頁面未輸入特殊項目不可勾選特殊收據!!!"
            Me.SSTab1.Tab = 0
            Check9.SetFocus
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        'Add By Sindy 2014/3/10 若勾選其他收據而該收據名稱不存在於客戶檔及收據抬頭基本檔, 則檢查一定要勾選 特殊收據
        '2014/3/12 modify by sonia 加入舊客戶條件
        '2014/3/20 modify by sonia 再加入其他收據抬頭字數>4者
    'Modify By Sindy 2017/4/6 + 不控管字數(And Len(Trim(cboTitle.Text)) >= 4),增加比對英文,日文名稱
    ElseIf Option2(1).Value = True And cboTitle.Text <> "" And Option31(1).Value = True Then
        strExc(0) = "SELECT cu04 FROM customer WHERE upper(cu04)=upper('" & ChgSQL(cboTitle.Text) & "') or upper(rtrim(cu05||' '||cu88||' '||cu89||' '||cu90))=upper('" & ChgSQL(cboTitle.Text) & "') or upper(cu06)=upper('" & ChgSQL(cboTitle.Text) & "')" & _
                    " Union All" & _
                    " SELECT a4201 FROM acc420 WHERE upper(a4201)=upper('" & ChgSQL(cboTitle.Text) & "')"
        intI = 1
        Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
        If intI = 0 Then
            Me.SSTab1.Tab = 0
            Check9.SetFocus
            MsgBox "此收據抬頭資料不足，請勾選特殊收據補基本資料!!"
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        '2014/3/10 END
    'Modified by Lydia 2014/12/24 增加新客戶判斷該收據名稱不存在於客戶檔及收據抬頭基本檔, 則檢查一定要勾選 特殊收據
    'Modify By Sindy 2017/4/6 + 不控管字數(And Len(Trim(cboTitle.Text)) >= 4),增加比對英文,日文名稱
    ElseIf Option2(1).Value = True And cboTitle.Text <> "" And Option31(0).Value = True And Text1(21).Text <> "" Then
        strExc(0) = "SELECT cu04 FROM customer WHERE upper(cu04)=upper('" & ChgSQL(cboTitle.Text) & "') or upper(rtrim(cu05||' '||cu88||' '||cu89||' '||cu90))=upper('" & ChgSQL(cboTitle.Text) & "') or upper(cu06)=upper('" & ChgSQL(cboTitle.Text) & "')" & _
                    " Union All" & _
                    " SELECT a4201 FROM acc420 WHERE upper(a4201)=upper('" & ChgSQL(cboTitle.Text) & "')"
        intI = 1
        Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
        If intI = 0 Then
            Me.SSTab1.Tab = 0
            Check9.SetFocus
            MsgBox "此收據抬頭資料不足，請勾選特殊收據補基本資料!!"
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    'end 2014/12/24
    End If
    
    'Add By Sindy 2009/08/31
    If Check7(0).Value = 1 Or Check7(1).Value = 1 Then '有點選「對造是否為本所客戶」
        If Check7(0).Value = 1 And Check7(1).Value = 1 Then
            MsgBox "對造為本所客戶「是」與「否」只能二選一!!!", vbExclamation + vbOKOnly
            SSTab1.Tab = 0
            Check7(0).SetFocus
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    Else '沒點選時,檢查之
        '專利
        If InStr(1, Text1(6), "P") <> 0 Then
'            For i = 1 To 4
'                If Me.Combo1(i).Text <> "" Then
'                    arrCaseProperty = Split(Me.Combo1(i).Text, " ")
                    '803舉發 804舉發答辯 807第三人申請技術報告 906鑑定報告 505參加訴願 506參加訴訟
                    If InStr(m_strCaseCPM, "803") > 0 Or _
                        (InStr(m_strCaseCPM, "804") > 0 And Option1(0).Value = True) Or _
                        InStr(m_strCaseCPM, "807") > 0 Or _
                        InStr(m_strCaseCPM, "906") > 0 Or _
                        InStr(m_strCaseCPM, "505") > 0 Or _
                        InStr(m_strCaseCPM, "506") > 0 Then
                        MsgBox "請點選「對造是否為本所客戶」!!!", vbExclamation + vbOKOnly
                        SSTab1.Tab = 0
                        Check7(0).SetFocus
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
'                End If
'            Next i
        '商標
        ElseIf InStr(1, Text1(6), "T") <> 0 Then
'            For i = 1 To 4
'                If Me.Combo1(i).Text <> "" Then
'                    arrCaseProperty = Split(Me.Combo1(i).Text, " ")
                    '601異議 603評定 605廢止 602異答 604評答 606廢止答 406參加訴願 407參加訴訟
                    'Modified by Lydia 2021/11/23 +210陳述意見書
                    If InStr(m_strCaseCPM, "601") > 0 Or InStr(m_strCaseCPM, "603") > 0 Or InStr(m_strCaseCPM, "605") > 0 Or _
                        (InStr(m_strCaseCPM, "602") > 0 And Option1(0).Value = True) Or _
                        (InStr(m_strCaseCPM, "604") > 0 And Option1(0).Value = True) Or _
                        (InStr(m_strCaseCPM, "606") > 0 And Option1(0).Value = True) Or _
                        InStr(m_strCaseCPM, "406") > 0 Or InStr(m_strCaseCPM, "407") > 0 Or _
                        InStr(m_strCaseCPM, "210") > 0 Then
                        MsgBox "請點選「對造是否為本所客戶」!!!", vbExclamation + vbOKOnly
                        SSTab1.Tab = 0
                        Check7(0).SetFocus
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
'                End If
'            Next i
        '法務
        'Modified by Lydia 2022/08/10 排除顧問LA
        ElseIf InStr(1, Text1(6), "L") <> 0 And Text1(6) <> "LA" Then
            ArrStr = Split(m_strCaseCPM, ",")
            For i = 0 To UBound(ArrStr)
               '民事案件(1開頭全部) 刑事案件(2開頭全部) 函件(41,42,43) 檢舉(5開頭全部)
               '701和解 71法律意見書 74法律諮詢 75法務案件分析
               If Left(ArrStr(i), 1) = "1" Or Left(ArrStr(i), 1) = "2" Or _
                   ArrStr(i) = "41" Or ArrStr(i) = "42" Or ArrStr(i) = "43" Or _
                   Left(ArrStr(i), 1) = "5" Or ArrStr(i) = "701" Or _
                   ArrStr(i) = "71" Or ArrStr(i) = "74" Or ArrStr(i) = "75" Then
                   MsgBox "請點選「對造是否為本所客戶」!!!", vbExclamation + vbOKOnly
                   SSTab1.Tab = 0
                   Check7(0).SetFocus
                   Screen.MousePointer = vbDefault
                   Exit Function
               End If
            Next i
        'Added by Lydia 2022/08/10 (111/8/5會議提出)顧問服務案(LA)契約審閱包括函件在接洽單增加提醒勾選「對造是否為本所客戶」，避免發生兩方同為本所客戶。
        ElseIf Text1(6) = "LA" Then
            ArrStr = Split(m_strCaseCPM, ",")
            For i = 0 To UBound(ArrStr)
               '4函件,41律師函,42存證信函,43代擬函（客戶出名）
               '6契約,61代擬契約,62提供契約修正意見,64代擬其他文件
               '71法律意見書,74法律諮詢,75法務案件分析
               If InStr("4,41,42,43,6,61,62,63,64,71,74,75,", ArrStr(i) & ",") > 0 Then
                   MsgBox "請點選「對造是否為本所客戶」!!!", vbExclamation + vbOKOnly
                   SSTab1.Tab = 0
                   Check7(0).SetFocus
                   Screen.MousePointer = vbDefault
                   Exit Function
               End If
            Next i
        'end 2022/08/10
        End If
    End If
    '商標
    If Text1(6) = "T" Or Text1(6) = "TF" Or Text1(6) = "CFT" Then
        If tmpImg.Picture = 0 And SSTab1.TabEnabled(4) = True Then
            If opt1(3).Value = False And opt1(4).Value = False Then  '2009/11/17 add by sonia 否則選opt1(3) or opt1(4)會出現此訊息
'                For i = 1 To 4
'                    If Me.Combo1(i).Text <> "" Then
'                        arrCaseProperty = Split(Me.Combo1(i).Text, " ")
                        If InStr(m_strCaseCPM, "101") > 0 Then
                            MsgBox "請點選商標圖!!!", vbExclamation + vbOKOnly
                            SSTab1.Tab = 4
                            'opt1(0).SetFocus
                            Screen.MousePointer = vbDefault
                            Exit Function
                        End If
'                    End If
'                Next i
            End If
            '2009/11/17 add by sonia
            If opt1(3).Value = True And PicText.Text = "圖同" Then
                MsgBox "請輸入同卷號之本所案號!!!", vbExclamation + vbOKOnly
                SSTab1.Tab = 4
                PicText.SetFocus
                Screen.MousePointer = vbDefault
                Exit Function
            End If
            '2009/11/17 emd
        End If
    End If
    '2009/08/31 End
    
    'add by nickc 2007/03/27 加入優先權日、號的控制
    If (InStr(m_strCaseCPM, "106") > 0 Or InStr(m_strCaseCPM, "121") > 0) And _
       (Text1(6) = "CFP" Or Text1(6) = "P") Then
        If Text1(119) <> "" Then
            arrCaseProperty = Split(Text1(119).Text, vbCrLf)
            For iiiii = 0 To UBound(arrCaseProperty)
                If InStr(1, arrCaseProperty(iiiii), "優先權日：") <> 0 Then
                    If Len(Replace(arrCaseProperty(iiiii), "優先權日：", "")) = 0 Then
                        MsgBox "優先權日不能空白 !!!", vbExclamation + vbOKOnly
                        SSTab1.Tab = 2
                        SSTab3.Tab = 0 'Added by Morgan 2013/1/15
                        Text1(119).SetFocus
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
                End If
                If InStr(1, arrCaseProperty(iiiii), "優先權號：") <> 0 Then
                    If Len(Replace(arrCaseProperty(iiiii), "優先權號：", "")) = 0 Then
                        MsgBox "優先權號不能空白 !!!", vbExclamation + vbOKOnly
                        SSTab1.Tab = 2
                        SSTab3.Tab = 0 'Added by Morgan 2013/1/15
                        Text1(119).SetFocus
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
                End If
            Next iiiii
        End If
    End If
    'end 2007/03/27
    
    'Add By Sindy 2012/6/6 檢查案件性質與專利種類二者是否相符
    If InStr(Text1(6), "P") > 0 And Combo6.Visible = True Then
'        For i = 1 To 4
'            If Me.Combo1(i).Text <> "" Then
'                arrCaseProperty = Split(Me.Combo1(i).Text, " ")
                If InStr(m_strCaseCPM, "101") > 0 Or _
                    InStr(m_strCaseCPM, "109") > 0 Or _
                    InStr(m_strCaseCPM, "110") > 0 Or _
                    InStr(m_strCaseCPM, "118") > 0 Or _
                    InStr(m_strCaseCPM, "120") > 0 Then
                    If Left(Trim(Combo6.Text), 1) <> "1" Then
                        MsgBox "專利種類應為發明 !!!", vbExclamation + vbOKOnly
                        Me.SSTab1.Tab = 0
                        Combo6.SetFocus
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
                ElseIf InStr(m_strCaseCPM, "102") > 0 Or InStr(m_strCaseCPM, "112") > 0 Then
                    If Left(Trim(Combo6.Text), 1) <> "2" Then
                        MsgBox "專利種類應為新型 !!!", vbExclamation + vbOKOnly
                        Me.SSTab1.Tab = 0
                        Combo6.SetFocus
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
                'Modified by Morgan 2012/27 +衍生設計125
                ElseIf InStr(m_strCaseCPM, "103") > 0 Or InStr(m_strCaseCPM, "105") > 0 Or InStr(m_strCaseCPM, "125") > 0 Then
                    If Left(Trim(Combo6.Text), 1) <> "3" Then
                        MsgBox "專利種類應為設計 !!!", vbExclamation + vbOKOnly
                        Me.SSTab1.Tab = 0
                        Combo6.SetFocus
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
                ElseIf InStr(m_strCaseCPM, "117") > 0 Then
                    If Left(Trim(Combo6.Text), 1) <> "4" Then
                        MsgBox "專利種類應為積體電路 !!!", vbExclamation + vbOKOnly
                        Me.SSTab1.Tab = 0
                        Combo6.SetFocus
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
                End If
'            End If
'        Next i
    End If
    '2012/6/6 End
    
    'Add by Amy 2017/03/22 T字頭大至台新案收文業務區為P2者
    If Left(Text1(6), 1) = "T" And OptChoose(1).Value = True And Option1(0).Value = True And Left(PUB_GetST03(Text1(10)), 2) = "P2" Then
         strErrTxt = ""
        If Len(Trim(Text1(5))) > 0 Then bolData = GetCusORFagentData(Text1(5), "FA120", strMCTFNew())
        'Modify by Amy 2021/12/22 同一客戶但經過不同FC代理人來的案件，而FC代理人又不是同一組之MCTF人員,改檢查收文智權人員與FC代理人的管控智權人員是否同一組
'        '檢查每個舊客戶
'        For i = 1 To 5
'            If Me.Text1(12 + ((i - 1) * 16)).Text <> MsgText(601) Then '有申請人編號
'                Select Case i
'                    Case 1
'                        bolNewCus = Option31(0).Value
'                    Case 2
'                        bolNewCus = Option32(0).Value
'                    Case 3
'                        bolNewCus = Option33(0).Value
'                    Case 4
'                        bolNewCus = Option34(0).Value
'                    Case 5
'                        bolNewCus = Option35(0).Value
'                End Select
'                '**舊客戶
'                If bolNewCus = False Then
'                    'FC代理人為必填
'                    If Len(Trim(Text1(5))) = 0 Then
'                        MsgBox "代理人不可為空!!!", vbExclamation + vbOKOnly
'                        Me.SSTab1.Tab = 2
'                        Me.SSTab3.Tab =0
'                        Text1(5).SetFocus
'                        Screen.MousePointer = vbDefault
'                        Exit Function
'                    End If
'                    '若客戶已為MCTF客戶時，但與FC代理人之「管控智權人員」不同時，彈訊息
'                    If Left(strMCTFNew(0), 4) = "MCTF" Then
'                        bolData = GetCusORFagentData(Me.Text1(12 + ((i - 1) * 16)).Text, "CU13", strTmp())
'                        If strMCTFNew(0) <> strTmp(0) And Left(strTmp(0), 4) = "MCTF" Then
'                            strErrTxt = strErrTxt & "申請人" & i & "：" & Me.Text1(12 + ((i - 1) * 16)).Text & " (" & strTmp(0) & ")" & "及"
'                        End If
'                    End If
'                End If
'            Else
'                Exit For
'            End If
'        Next i
'        If strErrTxt <> MsgText(601) Then
'            MsgBox Left(strErrTxt, Len(strErrTxt) - 1) & vbCrLf & "與代理人" & Text1(5) & _
'                    "商標管控智權人員(" & strMCTFNew(0) & ")不同！"
'            Exit Function
'        End If
        'FC代理人必填
        If Len(Trim(Text1(5))) = 0 Then
            MsgBox "代理人不可為空!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 2
            Me.SSTab3.Tab = 0
            Text1(5).SetFocus
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        'Add By Sindy 2025/10/28 + if
        'Add By Sindy 2025/11/6 + And Me.Text1(12) <> "" 因TS查名不需要輸入申請人
        If Me.Option31(1).Value = True And Me.Text1(12) <> "" Then '舊客戶才檢查
        '2025/10/28 END
         If ChkSameCuArea(Text1(12), Text1(10), , , , , Text1(5)) = False Then
             MsgBox "收文智權人員與代理人" & Text1(5) & "商標管控智權人員(" & strMCTFNew(0) & ")不同！"
             Screen.MousePointer = vbDefault
             Exit Function
         End If
        End If
    'Modify By Sindy 2022/9/14
    Else
      '業務區不同不可直接收文
      '(Text1(0) <> GetCuSales(ChangeCustomerL(Text1(12).Text), StrCuSales1)) And
      If Left(Trim(Text1(12)), 6) <> "X65299" And Left(Trim(Text1(12)), 6) <> "X03072" And _
         Left(Trim(Text1(28)), 6) <> "X65299" And Left(Trim(Text1(28)), 6) <> "X03072" And _
         Left(Trim(Text1(44)), 6) <> "X65299" And Left(Trim(Text1(44)), 6) <> "X03072" And _
         Left(Trim(Text1(60)), 6) <> "X65299" And Left(Trim(Text1(60)), 6) <> "X03072" And _
         Left(Trim(Text1(76)), 6) <> "X65299" And Left(Trim(Text1(76)), 6) <> "X03072" Then
         If Me.Option31(1).Value = True Then '舊客戶才檢查
            'Modify By Sindy 2023/6/14 參考收文程式做檢查
            Dim m_SalesST06 As String, m_SalesST15 As String, oStrCuSales1 As String
            Dim oMailCount As String, oContext As String
            Dim IsMail As Boolean
            m_SalesST15 = GetST15(Text1(10), , , m_SalesST06)
            IsMail = True
            If ChkSameCuArea(ChangeCustomerL(Text1(12).Text), Text1(10), , , , , ChangeCustomerL(Text1(5).Text), , oStrCuSales1) = False And Text1(10) <> "" And Trim(Text1(12).Text) <> "" Then
               If Left(m_SalesST15, 1) = "F" And Left(GetSalesArea(oStrCuSales1), 1) = "F" Then
                  '若收文智權人員之ST15為F字頭並且客戶智權人員之ST15也為F字頭則不發Mail
               Else
                  oMailCount = oMailCount & oStrCuSales1 & ";"
                  oContext = oContext & vbCrLf + "申請人1： " + GetCustomerName(Text1(12).Text) + vbCrLf + "原智權人員： " + GetPrjSalesNM(oStrCuSales1)
               End If
            End If
            '檢查是否為待活化客戶,並且更新DB
            If m_SalesST06 <> "" And Text1(12) <> "" And Text1(10) <> "" Then
                'Mark by Lydia 2023/11/30 待正式收文才更新DB
                'If PUB_ChkOldCustomer(True, Text1(12), Text1(10), m_SalesST15, m_SalesST06, False) = True Then
                '    IsMail = False
                'End If
                'end 2023/11/30
            End If
            If IsMail = True And UCase(Mid(Text1(6), 1, 1)) <> "F" And oMailCount <> "" Then
            '2023/6/14 END
               MsgBox "收文智權人員與客戶智權人員不同業務區！", , "注意！"
            End If
         End If
      End If
      '2022/9/14 END
    End If
    'end 2017/03/22
    
    'Add by Amy 2022/03/10 檢查申請人客戶狀態,彈訊息
    For i = 1 To 5
        strText = ""
        strTmp(0) = Me.Text1(12 + ((i - 1) * 16))
        If strTmp(0) <> MsgText(601) Then
            'Modify By Sindy 2025/3/26 舊案要再傳入案件性質逐一做檢查
            If Option1(1).Value = True Then
               varTmp = Split(m_strCaseCPM, ",")
               For ii = LBound(varTmp) To UBound(varTmp)
                  If varTmp(ii) <> "" Then
                     bolData = GetCustomerAndState(strTmp(0), strText, , , , Text1(6), , IIf(Option1(0).Value = True, False, True), Me.Name, Text1(7), IIf(Text1(8) = "", "0", Text1(8)), IIf(Text1(9) = "", "00", Text1(9)), varTmp(ii))
                     If bolData = False Then
                         Exit For
                     End If
                  End If
               Next ii
               If bolData = False Then
                   SSTab1.Tab = 1
                   SSTab2.Tab = i - 1
                   '客戶編號
                   If Text1(12 + ((i - 1) * 16)).Enabled = True Then Text1(12 + ((i - 1) * 16)).SetFocus
                   Exit Function
               End If
            Else
            '2025/3/26 END
               'Modified by Lydia 2023/03/06 傳入本所案號, Text1(7), IIf(Text1(8) = "", "0", Text1(8)), IIf(Text1(9) = "", "00", Text1(9))
               bolData = GetCustomerAndState(strTmp(0), strText, , , , Text1(6), , IIf(Option1(0).Value = True, False, True), Me.Name, Text1(7), IIf(Text1(8) = "", "0", Text1(8)), IIf(Text1(9) = "", "00", Text1(9)))
               If bolData = False Then
                   Exit For
               End If
            End If
        Else
            bolData = True
        End If
    Next i
    If bolData = False Then
        SSTab1.Tab = 1
        SSTab2.Tab = i - 1
        'Modify by Amy 2024/01/03 電子收文上線後,此欄可能不可輸 SetFocus 會檔掉
        If Text1(12 + ((i - 1) * 16)).Enabled = True Then Text1(12 + ((i - 1) * 16)).SetFocus
        Exit Function
    End If
    'end 2022/03/10
    
    '2011/10/19 ADD BY SONIA 新案檢查四縣市地址
    'Modify by Amy 2015/11/11 原申請人聯絡地址有值檢查,改申請人中or英文名稱有值且是新案臺灣的舊客戶或新客戶檢查台灣地址
    lblZip.Visible = False '/Add By Sindy 2023/2/20
    For i = 1 To 5
        If Me.Text1(21 + ((i - 1) * 16)).Text <> "" Or Me.Text1(22 + ((i - 1) * 16)).Text <> "" Then '申請人中or英文名稱有值
            Select Case i
                Case 1
                    bolNewCus = Option31(0).Value
                Case 2
                    bolNewCus = Option32(0).Value
                Case 3
                    bolNewCus = Option33(0).Value
                Case 4
                    bolNewCus = Option34(0).Value
                Case 5
                    bolNewCus = Option35(0).Value
            End Select
            '**新客戶
            If bolNewCus = True Then
               'Modify By Sindy 2024/1/16 Mark: 請開放市場開發組收文新客戶，但僅限於案件性質501(ACS)
               '                          前面有鎖僅能收 Text1(6) & m_strCaseCPM <> "ACS501"
'               'Add By Sindy 2023/11/8 W3001開發組，只可收文ACS之501市場開發的案件性質，並且不可收費，也不可收點選新客戶。
'               If Text1(10) = "W3001" Then
'                  MsgBox "W3001開發組，不可收文新客戶。", vbExclamation
'                  SSTab1.Tab = 1
'                  SSTab2.Tab = i - 1
'                  Screen.MousePointer = vbDefault
'                  Exit Function
'               End If
'               '2023/11/8 END
      
                '*新客戶名稱有值,聯絡地址必填,國內-申請地址必填,大至台申請地址/英文地址擇一填
                strErrTxt = ""
                bolChkErr = False
                If Text1(21 + (i - 1) * 16) <> MsgText(601) Or Text1(22 + (i - 1) * 16) <> MsgText(601) Then
                     'Add By Sindy 2023/9/27
                     If Text1(21 + (i - 1) * 16) <> MsgText(601) Then
                        Text1(21 + (i - 1) * 16) = Trim(Text1(21 + (i - 1) * 16)) '客戶名稱最左邊和最右邊的空白去掉
                        Text1(21 + (i - 1) * 16) = PUB_StringFilter(Text1(21 + (i - 1) * 16)) '換行符號截掉
                     End If
                     If Text1(22 + (i - 1) * 16) <> MsgText(601) Then
                        Text1(22 + (i - 1) * 16) = Trim(Text1(22 + (i - 1) * 16)) '客戶名稱最左邊和最右邊的空白去掉
                        Text1(22 + (i - 1) * 16) = PUB_StringFilter(Text1(22 + (i - 1) * 16)) '換行符號截掉
                     End If
                     '2023/9/27 END
                     
                     'Add By Sindy 2023/5/11
                     'Modify By Sindy 2023/5/16
                     'If GetTextLength(Text1(21 + (i - 1) * 16)) >= 4 And
                     If Len(Text1(21 + (i - 1) * 16)) >= 4 And _
                        Text1(21 + (i - 1) * 16) <> MsgText(601) And _
                        (Text1(23 + (i - 1) * 16) = MsgText(601) And Text1(24 + (i - 1) * 16) = MsgText(601)) Then
                        If MsgBox("申請人" & Chr(Asc(i) - 23937) & "名稱長度大於等於4碼，是否為公司，" & vbCrLf & "若是公司需要輸入代表人，是否要輸入「代表人」？", vbExclamation + vbYesNo) = vbYes Then
                           SSTab1.Tab = 1
                           SSTab2.Tab = i - 1
                           Text1(23 + (i - 1) * 16).SetFocus
                           Screen.MousePointer = vbDefault
                           Exit Function
                        End If
                     End If
                     '2023/5/11 END
                     
                     'Modify By Sindy 2023/2/17 有英文地址,可不填申請地址、聯絡地址
                     'If Text1(26 + (i - 1) * 16) = MsgText(601) Then strErrTxt = strErrTxt & "聯絡地址不可為空！": bolChkErr = True
'                    If OptChoose(1).Value = True Then
                        If Text1(27 + (i - 1) * 16) = MsgText(601) And Text1(125 + (i - 1) * 16).Visible = True And Text1(125 + (i - 1) * 16) = MsgText(601) Then
                            strErrTxt = strErrTxt & IIf(Len(strErrTxt) > 0, vbCrLf, "") & "申請地址、英文地址請擇一填寫！": bolChkErr = True
'                        ElseIf Text1(27 + (i - 1) * 16) = MsgText(601) Then
'                            strErrTxt = strErrTxt & IIf(Len(strErrTxt) > 0, vbCrLf, "") & "申請地址不可為空！": bolChkErr = True
                        End If
'                    ElseIf Text1(27 + (i - 1) * 16) = MsgText(601) Then
'                        strErrTxt = strErrTxt & IIf(Len(strErrTxt) > 0, vbCrLf, "") & "申請地址不可為空！": bolChkErr = True
'                    End If
                    If Text1(27 + (i - 1) * 16) <> MsgText(601) Or Text1(125 + (i - 1) * 16).Visible = False Or (Text1(125 + (i - 1) * 16).Visible = True And Text1(125 + (i - 1) * 16) = MsgText(601)) Then
                       If Text1(26 + (i - 1) * 16) = MsgText(601) Then strErrTxt = strErrTxt & IIf(Len(strErrTxt) > 0, vbCrLf, "") & "有申請地址時，聯絡地址不可為空！": bolChkErr = True
                       'If Text1(27 + (i - 1) * 16) = MsgText(601) Then strErrTxt = strErrTxt & IIf(Len(strErrTxt) > 0, vbCrLf, "") & "申請地址不可為空！": bolChkErr = True
                    End If
                    '2023/2/17 END
                    If bolChkErr = True Then
                        MsgBox "申請人" & Chr(Asc(i) - 23937) & vbCrLf & strErrTxt, , MsgText(5)
                        SSTab1.Tab = 1
                        SSTab2.Tab = i - 1
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
                End If
                '*聯絡地址為台灣
                If intTWAddr(i * 2 - 1) < 11 And Text1(26 + (i - 1) * 16) <> MsgText(601) Then
                    'Modify by Amy 2024/06/24 +intTW:3-是台灣/99-印過非台灣且地址前五個字相同不檢查 for 身份證統編檢查可用(秀玲說不要花太多時間,故只改新客戶)
                    IsTWAddr = False
                    intTW = 0
                    'Modify by Amy 2024/08/29 連續收不設地址變數=10,若為台灣改設3 原:intTWAddr(((Index - 26) / 16) * 2 + 1) = 10
                    If (intTWAddr(i * 2 - 1) = 3 Or intTWAddr(i * 2 - 1) = 99) And Left(strOldAddr((i * 2 - 1)), 5) = Left(Text1(26 + (i - 1) * 16), 5) Then
                        '印過且地址前五個字相同不檢查
                    Else
                        'Modify by Amy 2024/08/29 +Me.Name
                        IsTWAddr = CheckTaiwanAddr_Tai(Text1(26 + (i - 1) * 16), Text1(25 + (i - 1) * 16), "000", "申請人" & Chr(Asc(i) - 23937) & "的聯絡地址", stZipCode, , , Me.Name, , intTW, SSTab1, SSTab2, Me.Name)
                        If IsTWAddr = False And intTW = 1 Then
                           'Modify by Amy 2017/06/06
                           '台灣地址格式有誤,不可存檔
'                           SSTab1.Tab = 1
'                           SSTab2.Tab = i - 1
                           Screen.MousePointer = vbDefault
                           Exit Function
                        ElseIf IsTWAddr = True Then
                           intTW = 3
                        End If
                        'end 2017/06/06
                        If intTWAddr(i * 2 - 1) <= 1 Then intTWAddr(i * 2 - 1) = intTW 'Memo by Amy 此處只會回傳 0/1/3/99
                    End If
                    If intTW = 0 And intTWAddr(i * 2 - 1) = 0 Then
                        '地址格式有誤
                        MsgBox "申請人" & Chr(Asc(i) - 23937) & "的聯絡地址有誤,請洽電腦中心"
                        Call ChkZipData(9, Text1(26 + (i - 1) * 16))
                        Screen.MousePointer = vbDefault
                        Exit Function
                    ElseIf InStr(stZipCode, Left(Text1(25 + (i - 1) * 16), 3)) = 0 Then
                        '判斷ZipCode 與輸入的是否符合,不符合取代彈Msg
                        Call ChkZipData(2, Text1(26 + (i - 1) * 16), stZipCode)
                        If intTWAddr(i * 2 - 1) = 0 Then intTWAddr(i * 2 - 1) = 3
                    End If
                     'end 2024/06/24
                End If
                'Add by Amy 2024/06/24 從CheckTaiwanAddr_Tai搬下來
                If Trim(Text1(27 + (i - 1) * 16)) = "同上" Or Trim(Text1(27 + (i - 1) * 16)) = "同聯絡地址" _
                  Or (Trim(Text1(27 + (i - 1) * 16)) <> MsgText(601) And Trim(Text1(26 + (i - 1) * 16)) = Trim(Text1(27 + (i - 1) * 16))) Then
                     intTWAddr(i * 2) = intTWAddr(i * 2 - 1)
                End If
                     
                '*申請地址為台灣(聯絡地址<>申請地址才再確認地址格式)
                If intTWAddr(i * 2) < 11 And Text1(27 + (i - 1) * 16) <> MsgText(601) And Text1(26 + (i - 1) * 16) <> Text1(27 + (i - 1) * 16) Then
                    'Modify by Amy 2024/06/24 +intTW:3-是台灣/99-印過且地址前五個字相同不檢查 for 身份證統編檢查可用(秀玲說不要花太多時間,故只改新客戶)
                    IsTWAddr = False
                    intTW = 0
                    'Modify by Amy 2024/08/29 連續收不設地址變數=10,若為台灣改設3 原: intTWAddr(i * 2) = 10
                    If (intTWAddr(i * 2) = 3 Or intTWAddr(i * 2) = 99) And Left(strOldAddr(i * 2), 5) = Left(Text1(27 + (i - 1) * 16), 5) Then
                        '印過且地址前五個字相同不檢查
                    Else
                        'Modify by Amy 2024/08/29 +Me.Name
                        IsTWAddr = CheckTaiwanAddr_Tai(Text1(27 + (i - 1) * 16), Text1(119 + i), "000", "申請人" & Chr(Asc(i) - 23937) & "的申請地址", stZipCode, , , Me.Name, , intTW, SSTab1, SSTab2, Me.Name)
                        '台灣地址格式有誤
                        If IsTWAddr = False And intTW = 1 Then
                           'Modify by Amy 2017/06/06
'                           SSTab1.Tab = 1
'                           SSTab2.Tab = i - 1
                           Screen.MousePointer = vbDefault
                           Exit Function
                        ElseIf IsTWAddr = True Then
                           intTW = 3
                        End If
                        'end 2017/06/06
                        If intTWAddr(i * 2) <= 1 Then intTWAddr(i * 2) = intTW   '此處只會回傳 0/1/99/20
                    End If
                    If intTW = 0 And intTWAddr(i * 2) = 0 Then
                        '地址格式有誤
                        MsgBox "申請人" & Chr(Asc(i) - 23937) & "的申請地址有誤,請洽電腦中心"
                        Call ChkZipData(9, Text1(27 + (i - 1) * 16))
                        Screen.MousePointer = vbDefault
                        Exit Function
                    ElseIf InStr(stZipCode, Left(Text1(120 + (i - 1) * 1), 3)) = 0 Then
                        '判斷ZipCode 與輸入的是否符合,不符合取代彈Msg
                        Call ChkZipData(2, Text1(27 + (i - 1) * 16), stZipCode)
                        intTW = 3
                        If intTWAddr(i * 2) = 0 Then intTWAddr(i * 2) = intTW
                    End If
                    'end 2024/06/24
                End If
               
               'Add By Sindy 2022/10/4 檢查新客戶(可收文所別)是否有跨所
               'Modify By Sindy 2023/1/16
               'Modify by Amy 2024/08/29 連續收不設地址變數=10,若為台灣改設3 原: intTWAddr(i * 2 - 1) = 10
               If (intTWAddr(i * 2 - 1) = 3 Or intTWAddr(i * 2 - 1) = 99) And Left(strOldAddr((i * 2 - 1)), 5) = Left(Text1(26 + (i - 1) * 16), 5) Then
                  '印過且地址前五個字相同不檢查
               Else
               '2023/1/16 END
                  ChkCRA27(i - 1).Value = vbUnchecked
                  ChkCRA27(i - 1).Enabled = True
                  'Modify By Sindy 2023/3/23
'                  If intTWAddr(i * 2 - 1) < 11 Or intTWAddr(i * 2) < 11 Then
                     'Modify by Amy 2023/04/24 地址跨所改共用function
                     strChkSql(0) = "": strChkSql(1) = ""
                     '聯絡地址為台灣 或 有郵遞區號
                     'If intTWAddr(i * 2 - 1) < 11 Then
                     If (intTWAddr(i * 2 - 1) < 11 Or Left(Text1(25 + (i - 1) * 16), 3) <> "") And _
                        Text1(26 + (i - 1) * 16) <> MsgText(601) Then
                        'strChkSql = "substr(PZD01,1,3)='" & PUB_ChgNumeralStyle(Left(Text1(25 + (i - 1) * 16), 3)) & "'"
                        strChkSql(1) = PUB_ChgNumeralStyle(Left(Text1(25 + (i - 1) * 16), 3))
                     End If
                     '申請地址為台灣 或 有郵遞區號
                     'If intTWAddr(i * 2) < 11 Then
                     If (intTWAddr(i * 2) < 11 Or Left(Text1(120 + (i - 1) * 1), 3) <> "") And _
                        Text1(27 + (i - 1) * 16) <> MsgText(601) Then
                        'If strChkSql <> "" Then strChkSql = strChkSql & " or "
                        'strChkSql = strChkSql & "substr(PZD01,1,3)='" & PUB_ChgNumeralStyle(Left(Text1(120 + (i - 1) * 1), 3)) & "'"
                        strChkSql(0) = PUB_ChgNumeralStyle(Left(Text1(120 + (i - 1) * 1), 3))
                     End If
                     'If strChkSql <> "" Then
                     If ChkAcrossArea(0, Me.Name, Text1(10), strChkSql(0), strChkSql(1)) = True Then
'                        'Modify By Sindy 2023/2/20 + or PZD07 is null:不分區
'                        strSql = "SELECT PZD07 FROM postzipdata" & _
'                                 " WHERE (" & strChkSql & ")" & _
'                                 " and (instr(PZD07,'" & PUB_GetST06(Text1(10)) & "')>0 or PZD07 is null)" & _
'                                 " group by PZD07"
'                        intI = 1
'                        Set RsTemp = ClsLawReadRstMsg(intI, strSql)
'                        If intI = 0 Then
                           ChkCRA27(i - 1).Value = vbChecked '有跨所
                           ChkCRA27(i - 1).Enabled = False
                           lblZip.Visible = True
                           MsgBox "此新客戶之申請及聯絡地址均非在您的所別地，須進行跨所呈報，若已呈報，請匯入核可資訊。", vbExclamation
      '                  Else
      '                     ChkCRA27(i - 1).Value = vbUnchecked
      '                     ChkCRA27(i - 1).Enabled = True
'                        End If
                     End If
                     'end 2023/04/24
   '               Else
   '                  ChkCRA27(i - 1).Value = vbUnchecked
   '                  ChkCRA27(i - 1).Enabled = True
'                  End If
               End If
               '2022/10/4 END
               
            End If
            '**新案舊客戶
            If bolNewCus = False And Me.Option1(0).Value = True Then
                If GetPrjNationNumber1(Me.Text1(12 + ((i - 1) * 16)).Text, "CU87") < "010" Then '為國內客戶
                    '*** 申請人聯絡地址 ***
                    '聯絡地址有值且郵遞區號未鎖住(為多筆或抓不到故需檢查)
                    If Text1(26 + (i - 1) * 16) <> "" Then
                        If intTWAddr(i * 2 - 1) < 11 And Text1(25 + (i - 1) * 16).Enabled = True Then
                            If intTWAddr(i * 2 - 1) = 1 Then
                                intTW = 0 'Add by Amy 2017/06/07
                                'Modify by Amy 2024/08/29 +Me.Name
                                If CheckTaiwanAddr_Tai(Text1(26 + (i - 1) * 16), Text1(25 + (i - 1) * 16), "000", "申請人" & Chr(Asc(i) - 23937) & "的聯絡地址", stZipCode, , , Me.Name, Text1(26 + (i - 1) * 16).Tag, intTW, , , Me.Name) = False Then
                                    '地址格式有誤
                                    'Add by Amy 2017/06/06
                                    intTWAddr(i * 2 - 1) = intTW
                                    If Trim(Text1(26 + (i - 1) * 16)) = "同上" Or Trim(Text1(26 + (i - 1) * 16)) = "同聯絡地址" _
                                        Or (Trim(Text1(26 + (i - 1) * 16)) <> MsgText(601) And Trim(Text1(26 + (i - 1) * 16)) = Trim(Text1(27 + (i - 1) * 16))) Then
                                        intTWAddr(i * 2) = intTWAddr(i * 2 - 1)
                                    End If
                                    intTW = 0
                                    If intTWAddr(i * 2 - 1) = 1 Then
                                        Call ChkZipData(9, Text1(26 + (i - 1) * 16))
                                        Screen.MousePointer = vbDefault
                                        Exit Function
                                    End If
                                    'end 2017/06/06
                                ElseIf InStr(stZipCode, Left(Text1(25 + (i - 1) * 16), 3)) = 0 Then
                                    '判斷ZipCode 與輸入的是否符合,不符合取代彈Msg
                                    Call ChkZipData(2, Text1(26 + (i - 1) * 16), stZipCode)
                                End If
                                'Modify by Amy 2017/06/06 +intTWAddr(i * 2 - 1) < 11 因上方可能改intTWAddr(i * 2 - 1)值
                                If intTWAddr(i * 2 - 1) = 1 And CheckTaiwanAddr(IIf(Text1(26 + (i - 1) * 16).Tag <> "", Text1(26 + (i - 1) * 16).Tag, Text1(26 + (i - 1) * 16)), "000", "申請人" & Chr(Asc(i) - 23937) & "的聯絡地址") = False Then
                                    'SSTab1.Tab = 1: SSTab2.Tab = i - 1
                                    'Text1(26 + (i - 1) * 16).SetFocus
                                    'Text1_GotFocus (26 + (i - 1) * 16)
                                    Call ChkZipData(9, Text1(26 + (i - 1) * 16))
                                    Screen.MousePointer = vbDefault
                                    Exit Function
                                End If
                            '郵遞區號多筆 or 有輸郵遞區號但錯誤
                            ElseIf Me.Text1(25 + (i - 1) * 16) = MsgText(601) Or InStr(Me.Text1(26 + (i - 1) * 16).Tag, Left(Me.Text1(25 + (i - 1) * 16), 3)) = 0 Then
                                Call ChkZipData(6, Me.Text1(26 + (i - 1) * 16))
                                Screen.MousePointer = vbDefault
                                Exit Function
                            End If
                        '原客戶檔有zip只檢查CheckTaiwanAddr
                        ElseIf intTWAddr(i * 2 - 1) = 12 Then
                            If CheckTaiwanAddr(IIf(Text1(26 + (i - 1) * 16).Tag <> "", Text1(26 + (i - 1) * 16).Tag, Text1(26 + (i - 1) * 16)), "000", "申請人" & Chr(Asc(i) - 23937) & "的聯絡地址") = False Then
                                Call ChkZipData(9, Text1(26 + (i - 1) * 16))
                                Screen.MousePointer = vbDefault
                                Exit Function
                            End If
                        End If
                        
                    End If
                End If
                '*** 申請人申請地址 ***
                '2011/11/1 ADD BY SONIA 加申請國家條件,因大陸商標案可以用舊地址申請arrNation(0) = "000"
                arrNation = Split(Me.Combo1(Index).Text, " ")
                'Modify by Amy 2015/12/03 改與CheckAPpAddr一致,否則會檢查TF 申請國238(馬德里)的申請人申請地址
                'If arrNation(0) = "020" And Text1(6) = "T" Then
                If arrNation(0) <> "000" And (Text1(6) = "T" Or Text1(6) = "TF") Then
                Else
                '2011/11/1 END
                    If GetPrjNationNumber1(Me.Text1(12 + ((i - 1) * 16)).Text) < "010" Then '為國內客戶
                        '申請地址有值且未鎖住(為多筆或抓不到故需檢查)
                        If Text1(27 + (i - 1) * 16) <> "" Then
                            If intTWAddr(i * 2) < 11 And Text1(119 + i).Enabled = True Then
                                If intTWAddr(i * 2) = 1 Then
                                    intTW = 0 'Add by Amy 2017/06/07
                                    'Modify by Amy 2024/08/29 +Me.Name
                                    If CheckTaiwanAddr_Tai(Text1(27 + (i - 1) * 16), Text1(119 + i), "000", "申請人" & Chr(Asc(i) - 23937) & "的申請地址", stZipCode, , , Me.Name, Text1(27 + (i - 1) * 16).Tag, intTW, , , Me.Name) = False Then
                                        '地址格式有誤
                                        'Add by Amy 2017/06/06
                                        intTWAddr(i * 2) = intTW
                                        If Trim(Text1(26 + (i - 1) * 16)) = "同上" Or Trim(Text1(26 + (i - 1) * 16)) = "同聯絡地址" _
                                            Or (Trim(Text1(26 + (i - 1) * 16)) <> MsgText(601) And Trim(Text1(26 + (i - 1) * 16)) = Trim(Text1(27 + (i - 1) * 16))) Then
                                            intTWAddr(i * 2 - 1) = intTWAddr(i * 2)
                                        End If
                                        intTW = 0
                                        If intTWAddr(i * 2) = 1 Then
                                            Call ChkZipData(9, Text1(27 + (i - 1) * 16))
                                            Screen.MousePointer = vbDefault
                                            Exit Function
                                        End If
                                        'end 2017/06/06
                                    ElseIf InStr(stZipCode, Left(Text1(119 + i), 3)) = 0 Then
                                        '判斷ZipCode 與輸入的是否符合,不符合取代彈Msg
                                        Call ChkZipData(2, Text1(119 + i), stZipCode)
                                    End If
                                    'Modify by Amy 2017/06/06 +intTWAddr(i * 2)=1  因上方可能改intTWAddr(i * 2)值
                                    If intTWAddr(i * 2) = 1 And CheckTaiwanAddr(IIf(Text1(27 + (i - 1) * 16).Tag <> "", Text1(27 + (i - 1) * 16).Tag, Text1(27 + (i - 1) * 16)), "000", "申請人" & Chr(Asc(i) - 23937) & "的申請地址") = False Then
                                        'SSTab1.Tab = 1: SSTab2.Tab = i - 1
                                        'Text1(27 + (i - 1) * 16).SetFocus
                                        'Text1_GotFocus (27 + (i - 1) * 16)
                                        Call ChkZipData(9, Text1(27 + (i - 1) * 16))
                                        Screen.MousePointer = vbDefault
                                        Exit Function
                                    End If
                                '郵遞區號多筆 or 有輸郵遞區號但錯誤
                                ElseIf Left(Text1(119 + i), 3) = MsgText(601) Or InStr(Me.Text1(27 + (i - 1) * 16).Tag, Left(Text1(119 + i), 3)) = 0 Then
                                    Call ChkZipData(6, Me.Text1(27 + (i - 1) * 16))
                                    Screen.MousePointer = vbDefault
                                    Exit Function
                                End If
                            '原客戶檔有zip只檢查CheckTaiwanAddr
                            ElseIf intTWAddr(i * 2) = 12 Then
                                If CheckTaiwanAddr(IIf(Text1(27 + (i - 1) * 16).Tag <> "", Text1(27 + (i - 1) * 16).Tag, Text1(27 + (i - 1) * 16)), "000", "申請人" & Chr(Asc(i) - 23937) & "的申請地址") = False Then
                                    Call ChkZipData(9, Text1(27 + (i - 1) * 16))
                                    Screen.MousePointer = vbDefault
                                    Exit Function
                                End If
                            End If
                        End If
                    End If
                End If
            End If
            'Add by Amy 2024/12/18 申請地址 及 國籍 可輸且為空,新客戶 擇一必填 (以利後續檢查 身份證/統編)
            'Memo 舊客戶 目前都會帶[客戶檔 國籍]不會有此問題;接洽單若只填[英文地址]而櫃台建新客戶不知國籍為何時,也需電話詢問填單者,故讓填單者擇一必填-秀玲
            If Text1(27 + (i - 1) * 16).Enabled = True And Text1(34 + (i - 1) * 16).Enabled = True And Text1(27 + (i - 1) * 16) = MsgText(601) And Text1(34 + (i - 1) * 16) = MsgText(601) Then
               '新客戶
               If bolNewCus = True Then
                  MsgBox "申請人" & Chr(Asc(i) - 23937) & vbCrLf & "申請地址 及 國籍 擇一必填！", , MsgText(5)
                  SSTab1.Tab = 1
                  SSTab2.Tab = i - 1
                  Screen.MousePointer = vbDefault
                  Exit Function
               End If
            End If
            'end 2024/12/18
        End If
    Next i
    
    '新案
    If Me.Option1(0).Value = True Then
        '發明人地址
        For i = 0 To 9
            'Modify by Amy 2015/10/22 +薛經理:沒勾同申請地址才檢查
            If Text2(i).Text <> "" And Combo3(i).Text = "000 台灣" And Text4(i).Text <> "" And ChkAddress(i).Value = False Then
                If CheckTaiwanAddr(Text4(i), "000", "發明人" & Chr(Asc(i + 1) - 23937) & "的地址") = False Then
                    SSTab1.Tab = 3
                    Text4(i).SetFocus
                    Text4_GotFocus (i)
                    Screen.MousePointer = vbDefault
                    Exit Function
                End If
            End If
        Next i
    End If
    'end 2015/11/11
    '2011/10/19 END
    
    'Add By Sindy 2012/6/6 國內客戶請輸入郵遞區號，只提醒但仍可操作
    'Modify by Amy 2016/01/04 改不是舊案舊客戶(新案國內客戶或新客戶郵遞區號)設必填
    'Modify by Amy 2016/07/27 +大至台不檢查(龔輸第一筆大陸印完資料未改印第二筆出現郵遞區號不可為空)
    'Modify by Amy 2016/08/09 修正2016/07/27 bug拿掉大至台不檢查
    'If optChoose(1).Value = False Then
        strErrTxt = "": j = 0
        bolChkErr = False
        For i = 1 To 5
            '有聯絡地址但無郵遞區號
            'Modify by Amy 2024/08/29 連續收不設地址變數=10,若為台灣改設3 原: intTWAddr(i * 2 - 1) = 10
            If (intTWAddr(i * 2 - 1) < 10 And Text1(26 + (i - 1) * 16) <> "" And Text1(25 + (i - 1) * 16) = "") _
              Or (intTWAddr(i * 2 - 1) = 3 And Text1(26 + (i - 1) * 16) <> "" And Left(strOldAddr(i * 2 - 1), 5) <> Left(Text1(26 + (i - 1) * 16), 5) And Text1(25 + (i - 1) * 16) = "") Then
                If bolChkErr = False Then
                    If strErrTxt <> "" Then strErrTxt = strErrTxt & "；"
                    strErrTxt = strErrTxt & "申請人"
                    strErrTxt = strErrTxt & IIf(j = 0, "", "、") & i
                    bolChkErr = True
                    j = j + 1
                End If
            End If
        Next i
        If bolChkErr = True Then
            MsgBox strErrTxt & "聯絡地址的郵遞區號不可空白！"
            SSTab1.Tab = 1
            SSTab2.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        
        strErrTxt = "": j = 0
        bolChkErr = False
        For i = 1 To 5
            '有申請地址但無郵遞區號
            'Modify by Amy 2021/02/23 bug 原:intTWAddr(i * 2 ) ->Search 02/23 以為是有申請地址但無郵遞區號的bug
            'Modify by Amy 2021/03/11 02/23 bug原因非此,故改回,因79072 舊案收 701/申請人為新客戶 聯絡地址為台灣但申請地址為大陸時,列印彈訊息需改708,導致申請人重輸後會彈申請人申請地址zip不可為空
            'Modify by Amy 2024/08/29 連續收不設地址變數=10,若為台灣改設3 原: intTWAddr(i * 2) = 10
            If (intTWAddr(i * 2) < 10 And Text1(27 + (i - 1) * 16) <> "" And Text1(119 + i) = "") _
              Or (intTWAddr(i * 2) = 3 And Text1(27 + (i - 1) * 16) <> "" And Left(strOldAddr(i * 2), 5) <> Left(Text1(27 + (i - 1) * 16), 5) And Text1(119 + i) = "") Then
                If bolChkErr = False Then
                    If strErrTxt <> "" Then strErrTxt = strErrTxt & "；"
                    strErrTxt = strErrTxt & "申請人"
                    strErrTxt = strErrTxt & IIf(j = 0, "", "、") & i
                    bolChkErr = True
                    j = j + 1
                End If
            End If
        Next i
        If bolChkErr = True Then
            MsgBox strErrTxt & "申請地址的郵遞區號不可空白！"
            SSTab1.Tab = 1
            SSTab2.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    'End If
    'end 2016/08/09
'    If strErrTxt <> "" Then
'        If MsgBox(strErrTxt & "，是否要輸入？", vbExclamation + vbYesNo) = vbYes Then
'            SSTab1.Tab = 1
'            SSTab2.Tab = 0
'            Screen.MousePointer = vbDefault
'            Exit Function
'        End If
'    End If
    'end 2016/01/04
    '2012/6/6 End
    
    'Add By Sindy 2010/11/22
    If Option1(1).Value = True And (Text1(6) = "P" Or Text1(6) = "CFP" Or Text1(6) = "FCP") Then
        If InStr(m_strCaseCPM, "601") > 0 Then
            '是否有A類未取消收文的領證(601)
            StrSQLa = "Select Count(*) From CaseProgress Where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " And CP09<'B' And CP10='601' And CP57 Is Null "
            rsA.CursorLocation = adUseClient
            rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
            If rsA.RecordCount > 0 Then
                If rsA.Fields(0).Value > 0 Then
                    If rsA.State <> adStateClosed Then rsA.Close
                    Set rsA = Nothing
                    '是否有C類被異議(理由)(1801)
                    StrSQLa = "Select Count(*) From CaseProgress Where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " And CP09>'C' And CP10='1801' "
                    rsA.CursorLocation = adUseClient
                    rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
                    If rsA.RecordCount > 0 Then
                        If rsA.Fields(0).Value <= 0 Then
                            MsgBox "本案不可再收<領證>!!!", vbExclamation + vbOKOnly
                            Me.SSTab1.Tab = 0
                            'Modify by Morgan 2010/12/13
                            'Cancel = True
                            Screen.MousePointer = vbDefault
                            Exit Function
                            'end 2010/12/13
                        End If
                    End If
                End If
            End If
            If rsA.State <> adStateClosed Then rsA.Close
            Set rsA = Nothing
        End If
    End If
    'end 2010/11/22
    
    'Modify by Amy 2016/09/19 +判斷系統別為P
    If InStr(m_strCaseCPM, "605") > 0 And Text1(6) = "P" Then
        'Add by Morgan 2010/12/13 年費不可重複收文(有已收未發的年費)
        ReDim Preserve pa(1 To TF_PA) As String
        pa(1) = Text1(6)
        pa(2) = Text1(7)
        pa(3) = Text1(8)
        pa(4) = Text1(9)
        If PUB_ChkCPExist(pa, "605", 1) Then
            MsgBox "本案目前有<年費>尚未發文，不可再收文<年費>!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    'Add By Sindy 2023/3/8 當FCT、T收文之案件性質為「延展」及CFT收文之案件性質為「延展」、「使用宣誓」，
    '                      請在收文時控管，若有未發文之「延展」、「使用宣誓」，不可重複收文。
    If InStr(m_strCaseCPM, "102") > 0 And (Text1(6) = "CFT" Or Text1(6) = "FCT" Or Text1(6) = "T") Then
        '不可重複收文(有已收未發的延展)
        ReDim Preserve pa(1 To TF_PA) As String
        pa(1) = Text1(6)
        pa(2) = Text1(7)
        pa(3) = Text1(8)
        pa(4) = Text1(9)
        If PUB_ChkCPExist(pa, "102", 1) Then
            If Left(Trim(Combo1(0).Text), 3) = "000" Then
               Call ClsPDGetCasePropertyL(1, Text1(6), "102", strExc(10))
            Else
               Call ClsPDGetCasePropertyL(2, Text1(6), "102", strExc(10))
            End If
            MsgBox "本案目前有<" & strExc(10) & ">尚未發文，不可再收文<" & strExc(10) & ">!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    If InStr(m_strCaseCPM, "105") > 0 And Text1(6) = "CFT" Then
        '不可重複收文(有已收未發的使用宣誓)
        ReDim Preserve pa(1 To TF_PA) As String
        pa(1) = Text1(6)
        pa(2) = Text1(7)
        pa(3) = Text1(8)
        pa(4) = Text1(9)
        If PUB_ChkCPExist(pa, "105", 1) Then
            MsgBox "本案目前有<使用宣誓>尚未發文，不可再收文<使用宣誓>!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    '2023/3/8 END
    
    'Add By Sindy 2015/5/13
    If Option1(1).Value = True And Trim(Left(Combo1(0), 4)) = "000" And Text1(6) = "P" And _
        (InStr(m_strCaseCPM, "601") > 0 Or InStr(m_strCaseCPM, "605") > 0) Then
        If Frame605.Visible = False Then
            '檢查是否有逾期
            arrCaseProperty = Split(m_strCaseCPM, ",")
            strSql = "SELECT max(np09) FROM nextprogress" & _
                     " WHERE np02='" & Text1(6) & "' and np03='" & Text1(7) & "'" & _
                       " and np04='" & Text1(8) & "' and np05='" & Text1(9) & "'" & _
                       " and np07='" & arrCaseProperty(0) & "'"
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strSql)
            If intI = 1 Then
               strExc(10) = "" & RsTemp.Fields(0) '法定期限
               'ex:P-107126 舊案年費逾期,不控管一定要輸入繳費年度起迄 10-10
               If Val(strExc(10)) > 0 And strSrvDate(1) > Val(strExc(10)) Then
                  If MsgBox("舊案逾期，若已至案件【說明處理事項】輸入繳費年度時，" & vbCrLf & "請按〔是〕繼續？", vbCritical + vbYesNo + vbDefaultButton2) = vbNo Then
                     Me.SSTab1.Tab = 0
                     Screen.MousePointer = vbDefault
                     Exit Function
                  End If
               Else
                  MsgBox "尚未勾選繳費年度，請確認!!!", vbExclamation + vbOKOnly '不可列印
                  Me.SSTab1.Tab = 0
                  Screen.MousePointer = vbDefault
                  Exit Function
               End If
            Else
            '2023/3/21 END
               MsgBox "尚未勾選繳費年度，請確認!!!", vbExclamation + vbOKOnly '不可列印
               Me.SSTab1.Tab = 0
               Screen.MousePointer = vbDefault
               Exit Function
            End If
        End If
    End If
    '2015/5/13 END
    
    'Added by Lydia 2020/11/19 CFP和CFT英國脫歐案管制：脫歐案不可同時收原案的延展
    'Modified by Lydia 2020/12/01 若點選「延展費(英國)」/「延展(英國)」但未點選「委任代理人(CFP.444, CFT.710)」時提醒並自動勾選。
    'If Option1(1).Value = True And ((Text1(6) = "CFP" And InStr(Trim(Left(Combo1(1).Text, 4)) & "," & Trim(Left(Combo1(2).Text, 4)) & "," & Trim(Left(Combo1(3).Text, 4)) & "," & Trim(Left(Combo1(4).Text, 4)) & ",", "613,") > 0) _
            Or (Text1(6) = "CFT" And InStr(Trim(Left(Combo1(1).Text, 4)) & "," & Trim(Left(Combo1(2).Text, 4)) & "," & Trim(Left(Combo1(3).Text, 4)) & "," & Trim(Left(Combo1(4).Text, 4)) & ",", "110,") > 0)) Then
    If Option1(1).Value = True And ( _
            (Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "613,") > 0) _
         Or (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "110,") > 0) _
         Or (Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "444,") > 0) _
         Or (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "710,") > 0)) Then
            
            strExc(1) = ""
            If Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "607,") > 0 Then
                 'Added by Lydia 2020/12/01
                 If InStr(m_strCaseCPM & ",", "444,") > 0 Then
                        Call ClsPDGetCaseProperty(Text1(6), "444", strExc(0))
                        strExc(1) = "444 " & strExc(0)
                 Else
                 'end 2020/12/01
                        Call ClsPDGetCaseProperty(Text1(6), "613", strExc(0))
                        strExc(1) = "613 " & strExc(0)
                 End If 'Added by Lydia 2020/12/01
                 'Modified by Lydia 2020/12/01 改提示
                 'strExc(1) = "不可同時收文歐盟案之〔" & "607 " & strExc(0) & "〕"
                 strExc(1) = "脫歐案性質〔" & strExc(1) & "〕需單獨收文！"
            ElseIf Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "102,") > 0 Then
                 'Added by Lydia 2020/12/01
                 If InStr(m_strCaseCPM & ",", "710,") > 0 Then
                        Call ClsPDGetCaseProperty(Text1(6), "710", strExc(0))
                        strExc(1) = "710 " & strExc(0)
                 Else
                 'end 2020/12/01
                        Call ClsPDGetCaseProperty(Text1(6), "110", strExc(0))
                        strExc(1) = "110 " & strExc(0)
                 End If 'Added by Lydia 2020/12/01
                 'Modified by Lydia 2020/12/01 改提示
                 'strExc(1) = "不可同時收文歐盟案之〔" & "102 " & strExc(0) & "〕"
                 strExc(1) = "脫歐案性質〔" & strExc(1) & "〕需單獨收文"
            End If
            If strExc(1) <> "" Then
                MsgBox strExc(1), vbExclamation, "英國脫歐案管制"
                SSTab1.Tab = 0
                Screen.MousePointer = vbDefault
                Exit Function
            End If
            
            'Added by Lydia 2020/12/01 若點選「延展費(英國)」/「延展(英國)」但未點選「委任代理人(CFP.444, CFT.710)」時提醒並自動勾選
            If Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "613,") > 0 _
                        And InStr(m_strCaseCPM & ",", "444,") = 0 Then
                 Call ClsPDGetCaseProperty(Text1(6), "613", strExc(0))
                 strExc(1) = "613 " & strExc(0)
                 Call ClsPDGetCaseProperty(Text1(6), "444", strExc(0))
                 strExc(1) = "〔" & strExc(1) & "〕需與〔" & "444 " & strExc(0) & "〕一併收文！"
            ElseIf Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "110,") > 0 _
                  And InStr(m_strCaseCPM & ",", "710,") = 0 Then
                 Call ClsPDGetCaseProperty(Text1(6), "110", strExc(0))
                 strExc(1) = "110 " & strExc(0)
                 Call ClsPDGetCaseProperty(Text1(6), "710", strExc(0))
                 strExc(1) = "〔" & strExc(1) & "〕需與〔" & "710 " & strExc(0) & "〕一併收文！"
            End If
            If strExc(1) <> "" Then
                MsgBox strExc(1), vbExclamation, "英國脫歐案管制"
                SSTab1.Tab = 0
                Screen.MousePointer = vbDefault
                Exit Function
            End If
            'end 2020/12/01
            
            'Modified by Lydia 2020/12/02
            'If Text1(6) = "CFP" And labelYF.Visible = False Then
            If Text1(6) = "CFP" And Frame605.Visible = False And InStr(m_strCaseCPM & ",", "613,") > 0 Then
                MsgBox "尚未勾選繳費年度，請確認!!!", vbExclamation + vbOKOnly '不可列印
                SSTab1.Tab = 0
                Screen.MousePointer = vbDefault
                Exit Function
            End If
    End If
    'end 2020/11/19
    
    'Added by Lydia 2020/12/04
    'CFP、CFT新案：統一檢查不可收脫歐案性質
    If Option1(0).Value = True And (Text1(6) = "CFP" Or Text1(6) = "CFT") And Trim(Text1(7) & Text1(8) & Text1(9)) = "" Then
        If (Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "613,") > 0) Or _
            (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "110,") > 0) Then
            strExc(1) = ""
            If Text1(6) = "CFP" Then
                Call ClsPDGetCaseProperty(Text1(6), "613", strExc(0))
                strExc(1) = "613 " & strExc(0)
            Else
                Call ClsPDGetCaseProperty(Text1(6), "110", strExc(0))
                strExc(1) = "110 " & strExc(0)
            End If
            MsgBox "不可收文脫歐案〔" & strExc(1) & "〕", vbCritical + vbOKOnly
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    '------歐盟(239)CFP延展費/CFT延展之新案接洽單時，提醒"請確認脫歐之英國案件是否已處理或同時處理"。
    If Option1(0).Value = True And (Text1(6) = "CFP" Or Text1(6) = "CFT") And Trim(Left(Combo1(0).Text, 4)) = "239" And Trim(Text1(7) & Text1(8) & Text1(9)) = "" Then
        If (Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "607,") > 0) Or _
            (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "102,") > 0) Then
            '因為尚未有實例，暫時用取消列印提供人員做加註等作業；
            If MsgBox("請確認脫歐之英國案件是否已處理或同時處理！" & vbCrLf & "選""確定""就繼續作業，選""取消""就中斷作業。", vbInformation + vbOKCancel + vbDefaultButton2, "提醒") = vbCancel Then
                SSTab1.Tab = 0
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        End If
    End If
    
    '------英國(201)CFP延展費/CFT延展之新案接洽單時，若未同時收文「委任代理人」時，詢問"確認是否脫歐的英國案"， 選"是"要一併收文「委任代理人」。
    If Option1(0).Value = True And (Text1(6) = "CFP" Or Text1(6) = "CFT") And Trim(Left(Combo1(0).Text, 4)) = "201" And Trim(Text1(7) & Text1(8) & Text1(9)) = "" Then
        If (Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "613,") > 0) Or _
            (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "110,") > 0) Then
            strExc(1) = ""
            If Text1(6) = "CFP" Then
                Call ClsPDGetCaseProperty(Text1(6), "613", strExc(0))
                strExc(1) = "613 " & strExc(0)
            Else
                Call ClsPDGetCaseProperty(Text1(6), "110", strExc(0))
                strExc(1) = "110 " & strExc(0)
            End If
            MsgBox "不可收文〔" & strExc(1) & "〕", vbCritical + vbOKOnly
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        If (Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "607,") > 0) Or _
            (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "102,") > 0) Then
            If (Text1(6) = "CFP" And InStr(m_strCaseCPM & ",", "444,") = 0) Or _
                (Text1(6) = "CFT" And InStr(m_strCaseCPM & ",", "710,") = 0) Then
                strExc(1) = ""
                If Text1(6) = "CFP" Then
                    Call ClsPDGetCaseProperty(Text1(6), "444", strExc(0))
                    strExc(1) = "444 " & strExc(0)
                Else
                    Call ClsPDGetCaseProperty(Text1(6), "710", strExc(0))
                    strExc(1) = "710 " & strExc(0)
                End If
                If MsgBox("請確認是否脫歐的英國案？" & vbCrLf & "選""是""為脫歐案需與〔" & strExc(1) & "〕一併收文！", vbExclamation + vbYesNo + vbDefaultButton1) = vbYes Then
                    SSTab1.Tab = 0
                    Screen.MousePointer = vbDefault
                    Exit Function
                End If
            End If
        End If
    End If
    'end 2020/12/04
    
    'Add By Sindy 2011/6/17
    'Modified by Morgan 2020/6/22 +FCL
    If Text1(127) = "" And (Text1(6) = "L" Or Text1(6) = "CFL" Or Text1(6) = "FCL") And Option1(0).Value = True Then
        MsgBox "新案且系統別為L、CFL或FCL時,案件屬性不可空白!!!", vbExclamation + vbOKOnly
        Me.SSTab1.Tab = 2
        SSTab3.Tab = 0 'Added by Morgan 2013/1/15
        Screen.MousePointer = vbDefault
        Exit Function
    End If
    
    'Add byA my 2015/11/13+Frame41 for 法務案件性質 7501(判決分析)
    If Frame41.Visible = True And _
        Option9(0).Value = False And Option9(1).Value = False Then
        MsgBox "「" & Option9(0).Caption & "」或「" & Option9(1).Caption & "」至少要勾選一項!!!", vbExclamation + vbOKOnly
        Me.SSTab1.Tab = 2
        SSTab3.Tab = 0
        Screen.MousePointer = vbDefault
        Exit Function
    End If
    'end 2015/11/13
    
    'Add By Sindy 2011/11/11
    If Frame16.Visible = True And _
        Option3(0).Value = False And Option3(1).Value = False Then
        MsgBox "「" & Option3(0).Caption & "」或「" & Option3(1).Caption & "」至少要勾選一項!!!", vbExclamation + vbOKOnly
        Me.SSTab1.Tab = 2
        SSTab3.Tab = 0 'Added by Morgan 2013/1/15
        Screen.MousePointer = vbDefault
        Exit Function
    End If
    '2011/11/11 End
            
    'Add By Sindy 2013/2/25
    If Frame27.Visible = True And _
        Option8(0).Value = False And Option8(1).Value = False Then
        MsgBox "「" & Option8(0).Caption & "」或「" & Option8(1).Caption & "」至少要勾選一項!!!", vbExclamation + vbOKOnly
        Me.SSTab1.Tab = 2
        SSTab3.Tab = 0
        Screen.MousePointer = vbDefault
        Exit Function
    End If
    '2013/2/25 End
   '2007/6/1 加618註冊不當撤銷 BY SONIA
   'Modify by Amy 2016/09/01 +TF且601/603/605加判斷卷宗性質(tm28)為申請(取消 618-秀玲)
'   If (Text1(6).Text = "CFT" Or Text1(6).Text = "T" Or Text1(6).Text = "FCT") _
'       And ((Trim(Left(Combo1(1).Text, 4)) = "101" Or Trim(Left(Combo1(2).Text, 4)) = "101" Or Trim(Left(Combo1(3).Text, 4)) = "101" Or Trim(Left(Combo1(4).Text, 4)) = "101") Or _
'       (Trim(Left(Combo1(1).Text, 4)) = "601" Or Trim(Left(Combo1(2).Text, 4)) = "601" Or Trim(Left(Combo1(3).Text, 4)) = "601" Or Trim(Left(Combo1(4).Text, 4)) = "601") Or _
'       (Trim(Left(Combo1(1).Text, 4)) = "603" Or Trim(Left(Combo1(2).Text, 4)) = "603" Or Trim(Left(Combo1(3).Text, 4)) = "603" Or Trim(Left(Combo1(4).Text, 4)) = "603") Or _
'       (Trim(Left(Combo1(1).Text, 4)) = "605" Or Trim(Left(Combo1(2).Text, 4)) = "605" Or Trim(Left(Combo1(3).Text, 4)) = "605" Or Trim(Left(Combo1(4).Text, 4)) = "605") Or _
'       (Trim(Left(Combo1(1).Text, 4)) = "618" Or Trim(Left(Combo1(2).Text, 4)) = "618" Or Trim(Left(Combo1(3).Text, 4)) = "618" Or Trim(Left(Combo1(4).Text, 4)) = "618")) And Option1(0).Value = False Then
    If (Text1(6).Text = "CFT" Or Text1(6).Text = "T" Or Text1(6).Text = "FCT" Or Text1(6).Text = "TF") And Option1(0).Value = False Then
        strErrTxt = ""
       If (InStr(m_strCaseCPM, "101") > 0) Then
            strErrTxt = "申請"
       ElseIf GetTM28 = "1" And _
           (InStr(m_strCaseCPM, "601") > 0 Or InStr(m_strCaseCPM, "603") > 0 Or InStr(m_strCaseCPM, "605") > 0) Then
            strErrTxt = "異議、評定、廢止"
       End If
       If strErrTxt <> MsgText(601) Then
            MsgBox "商標(T)" & strErrTxt & "，請收新案 !!!", vbExclamation + vbOKOnly
            SSTab1.Tab = 0
            Option1(0).SetFocus
            Exit Function
       End If
    End If
    'Add By Sindy 2014/2/19 當102延展新案商標不論申請國家，均要輸入審定號
    'Modify by Amy 2016/09/01 +新案判斷 且T/CFT/FCT/TF 601異議/603評定/605廢止,開放審定號及申請案號則需擇一輸(原新案,可能改舊案)
    If Frame29.Visible = True And Option1(0).Value = True Then
        If Text1(132).Visible = True And Trim(Text1(132).Text = "") And Trim(Text1(129).Text = "") Then
            MsgBox "審定號及申請案號請擇一輸入!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 4
            Me.Text1(129).SetFocus
            Screen.MousePointer = vbDefault
            Exit Function
        ElseIf Text1(132).Visible = False And Trim(Text1(129).Text = "") Then
            'Added by Lydia 2020/12/11 CFT英國脫歐案管制：英國(201) CFT委任代理人710之新案接洽單
            If Text1(6) = "CFT" And Trim(Left(Combo1(0), 4)) = "201" And ( _
                    (InStr(m_strCaseCPM & ",", "710,") > 0) And _
                    (InStr(m_strCaseCPM & ",", "102,") = 0)) Then
                If MsgBox("是否脫歐的英國案？" & vbCrLf & "選擇""是""則須輸入審定號，選擇""否""則繼續。", vbInformation + vbYesNo + vbDefaultButton1, "提醒") = vbYes Then
                    Me.SSTab1.Tab = 4
                    Me.Text1(129).SetFocus
                    Screen.MousePointer = vbDefault
                    Exit Function
                End If
            Else
            'end 2020/12/11
               If InStr(m_strCaseCPM, "102") > 0 Then
                    MsgBox "商標延展新案必須輸入審定號!!!", vbExclamation + vbOKOnly
                    Me.SSTab1.Tab = 4
                    Me.Text1(129).SetFocus
                    Screen.MousePointer = vbDefault
                    Exit Function
               End If
            End If 'Added by Lydia 2020/12/11
        End If
        'Add By Sindy 2023/3/21
        If Text1(129) <> "" Then
            bolCancel = False
            Text1_Validate 129, bolCancel
            If bolCancel = True Then
               Me.SSTab1.Tab = 4
               Text1(129).SetFocus
               Screen.MousePointer = vbDefault
               Exit Function
            End If
        End If
        '2023/3/21 END
    End If
    '2014/2/19 End
    'end 2016/09/01
    
    'Add By Sindy 2012/3/6
     'Modified by Lydia 2016/09/22 +Option6(4)
    'Modified by Lydia 2018/11/13 +Option6(5)
    'Modified by Lydia 2020/08/11 比照SetFrame20的判斷; T-229283,T-229284 沒有查名結果,卻能印接洽單
    'If Left(Trim(Combo1(0).Text), 3) = "000" And _
        Frame20.Visible = True And _
        (Option6(0).Value = False And Option6(1).Value = False And Option6(2).Value = False And Option6(3).Value = False And Option6(4).Value = False And Option6(5).Value = False) Then
    If Left(Trim(Combo1(0).Text), 3) = "000" And (Text1(6) = "T" Or Text1(6) = "CFT" Or Text1(6) = "TF") And ( _
            (InStr(m_strCaseCPM, "101") > 0 And m_strCaseCPM <> "") _
            ) And (Option6(0).Value = False And Option6(1).Value = False And Option6(2).Value = False And Option6(3).Value = False And Option6(4).Value = False And Option6(5).Value = False) Then
        MsgBox "台灣商標申請案，查名結果至少要勾選一項!!!", vbExclamation + vbOKOnly
        Me.SSTab1.Tab = 2
        SSTab3.Tab = 0 'Added by Morgan 2013/1/15
        Screen.MousePointer = vbDefault
        Exit Function
    End If
    '2012/3/6 End
    
    'Add By Sindy 2012/5/8
    '台灣商標Ｔ案若收文爭議案件性質時, 於案件說明處理事項增加3欄位供使用者填寫, 若未填寫則不可列印
    'Memo by Lydia 2018/12/10 開放T台灣案管控文件齊備
    If Frame21.Visible = True Then
        'Modified by Lydia 2018/12/10 延期303、放棄專用權206、暫緩審理310不必填「文件是否齊備」
        'If OptEP06(0).Value = False And OptEP06(1).Value = False Then
        'Modified by Lydia 2019/04/10 有一性質為不排除,當做全部不排除
        'If Frame22.Visible = True And OptEP06(0).Value = False And OptEP06(1).Value = False And _
                InStr(T案收文齊備排除, Trim(Left(Combo1(1).Text, 4))) = 0 And _
                InStr(T案收文齊備排除, Trim(Left(Combo1(2).Text, 4))) = 0 And _
                InStr(T案收文齊備排除, Trim(Left(Combo1(3).Text, 4))) = 0 And _
                InStr(T案收文齊備排除, Trim(Left(Combo1(4).Text, 4))) = 0 Then
        'Modified by Lydia 2022/07/15 TC案之文件齊備日管控; T大陸案之齊備日管控=>T大陸案不要「T案收文齊備排除」
        'If Frame22.Visible = True And OptEP06(0).Value = False And OptEP06(1).Value = False And _
                ((Trim(Combo1(1).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(1).Text, 4))) = 0) Or _
                (Trim(Combo1(2).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(2).Text, 4))) = 0) Or _
                (Trim(Combo1(3).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(3).Text, 4))) = 0) Or _
                (Trim(Combo1(4).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(4).Text, 4))) = 0)) Then
        If Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" Then
            For ii = 1 To GridCase.Rows - 1
               If InStr(T案收文齊備排除, Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4))) = 0 Then
                  bolT000EP06 = True
                  Exit For
               End If
            Next ii
        End If
'        (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(Combo1(1).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(1).Text, 4))) = 0) Or _
'        (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(Combo1(2).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(2).Text, 4))) = 0) Or _
'        (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(Combo1(3).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(3).Text, 4))) = 0) Or _
'        (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(Combo1(4).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(4).Text, 4))) = 0)
        If Frame22.Visible = True And OptEP06(0).Value = False And OptEP06(1).Value = False And ( _
                bolT000EP06 = True Or _
                Trim(Text1(6)) = "TC" Or _
                (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "020") _
                ) Then
            'Modified by Lydia 2018/12/10
            'MsgBox "資料是否齊備不可空白!!!", vbExclamation + vbOKOnly
            MsgBox Mid(Label23.Caption, 1, Len(Label23.Caption) - 1) & "不可空白!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 2
            SSTab3.Tab = 0 'Added by Morgan 2013/1/15
            Screen.MousePointer = vbDefault
            Exit Function
        
        'Added by Lydia 2020/02/05 收文排除性質, 取消勾選
        Else
            'Modified by Lydia 2020/02/06 debug
            'If Frame22.Visible = True And (OptEP06(0).Value = True Or OptEP06(1).Value = True) And _
                    ((Trim(Combo1(1).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(1).Text, 4))) > 0) Or _
                    (Trim(Combo1(2).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(2).Text, 4))) > 0) Or _
                    (Trim(Combo1(3).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(3).Text, 4))) > 0) Or _
                    (Trim(Combo1(4).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(4).Text, 4))) > 0)) Then
             'Modified by Lydia 2022/07/15 TC案之文件齊備日管控; T大陸案之齊備日管控=>T大陸案不要「T案收文齊備排除」
            'If Frame22.Visible = True And (OptEP06(0).Value = True Or OptEP06(1).Value = True) And _
                    Not ((Trim(Combo1(1).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(1).Text, 4))) = 0) Or _
                        (Trim(Combo1(2).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(2).Text, 4))) = 0) Or _
                        (Trim(Combo1(3).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(3).Text, 4))) = 0) Or _
                        (Trim(Combo1(4).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(4).Text, 4))) = 0)) Then
'            (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(Combo1(1).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(1).Text, 4))) = 0) Or _
'            (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(Combo1(2).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(2).Text, 4))) = 0) Or _
'            (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(Combo1(3).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(3).Text, 4))) = 0) Or _
'            (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "000" And Trim(Combo1(4).Text) <> "" And InStr(T案收文齊備排除, Trim(Left(Combo1(4).Text, 4))) = 0)
            If Frame22.Visible = True And (OptEP06(0).Value = True Or OptEP06(1).Value = True) And Not ( _
                  bolT000EP06 = True Or _
                  Trim(Text1(6)) = "TC" Or _
                  (Trim(Text1(6)) = "T" And Left(Trim(Combo1(0)), 3) = "020") _
                  ) Then
                  'Modified by Lydia 2020/09/25 變更訊息
                  'MsgBox Mid(Label23.Caption, 1, Len(Label23.Caption) - 1) & "不用設定!!!", vbInformation + vbOKOnly
                  MsgBox "此案件性質不用設定文件是否齊備，將自動清空。", vbInformation + vbOKOnly
                  OptEP06(0).Value = False
                  OptEP06(1).Value = False
            End If
        'end 2020/02/05
        End If

        'Modified by Lydia 2018/12/10
        'If OptEP34(0).Value = False And OptEP34(1).Value = False Then
        If Frame23.Visible = True And OptEP34(0).Value = False And OptEP34(1).Value = False Then
            MsgBox "是否會稿不可空白!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 2
            SSTab3.Tab = 0 'Added by Morgan 2013/1/15
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        'Modified by Lydia 2018/12/10
        'If OptCP122(0).Value = False And OptCP122(1).Value = False Then
        'Modified by Lydia 2019/07/02 debug
        'If Frame43.Visible = True And OptCP122(0).Value = False And OptCP122(1).Value = False Then
        'Modify By Sindy 2022/11/8 Mark
'        If Frame24.Visible = True And OptCP122(0).Value = False And OptCP122(1).Value = False Then
'            MsgBox "是否急件不可空白!!!", vbExclamation + vbOKOnly
'            Me.SSTab1.Tab = 2
'            SSTab3.Tab = 0 'Added by Morgan 2013/1/15
'            Screen.MousePointer = vbDefault
'            Exit Function
'        End If
        'Added by Lydia 2018/12/10 查名是否齊備
        If Frame42.Visible = True And OptCP143(0).Value = False And OptCP143(1).Value = False Then
            MsgBox "查名是否齊備不可空白!!!", vbExclamation + vbOKOnly
            Me.SSTab1.Tab = 2
            SSTab3.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        
        'Modify By Sindy 2012/8/31 Mark
'        '案件性質為613補充答辯或612補充理由時，則只可不會稿
'        If (Trim(Left(Trim(Combo1(1)), 4)) = "613" Or _
'            Trim(Left(Trim(Combo1(2)), 4)) = "613" Or _
'            Trim(Left(Trim(Combo1(3)), 4)) = "613" Or _
'            Trim(Left(Trim(Combo1(4)), 4)) = "613" Or _
'            Trim(Left(Trim(Combo1(1)), 4)) = "612" Or _
'            Trim(Left(Trim(Combo1(2)), 4)) = "612" Or _
'            Trim(Left(Trim(Combo1(3)), 4)) = "612" Or _
'            Trim(Left(Trim(Combo1(4)), 4)) = "612") Then
'            If OptEP34(1).Value = False Then
'                MsgBox "案件性質為補充答辯或補充理由時，不需會稿!!!", vbExclamation + vbOKOnly
'                Me.SSTab1.Tab = 2
'                Screen.MousePointer = vbDefault
'                Exit Function
'            End If
'        End If
    End If
    '2012/5/8 End
    
    'Add By Sindy 2015/1/7 檢查是否已有此案號回覆單
    'Modify By Sindy 2015/2/4 + And m_strSaveFiles <> "" 欲新增附件者
    'Modify By Sindy 2015/5/19
    'If m_blnCallPrint = False And Text1(6) = "P" And Left(Trim(Combo1(0).Text), 3) = "000" And m_strSaveFiles <> "" Then
    'Modify By Sindy 2022/10/12 + 舊案才檢查
    If m_strSaveFiles <> "" And Option1(1).Value = True And m_strSaveFiles <> "Y" Then
    '2015/5/19 END
        'Modify By Sindy 2015/5/18
        'If PUB_ChkIsReplyFile(Text1(6), Text1(7), Text1(8), Text1(9)) = True Then
        If Me.Text5 <> "" Then
         If PUB_ChkIsReplyFile(Text1(6) & Text1(7) & Text1(8) & Text1(9), , , Text5.Text) = True Then
         '2015/5/18 END
             MsgBox "此案號回覆單已上傳，不可作業，若有疑問請通知電腦心中協助處理！", vbCritical
             Screen.MousePointer = vbDefault
             Exit Function
         End If
        End If
        'Add By Sindy 2015/2/12
        If cmdAddAtt.Visible = True And _
            InStr(m_strSaveFiles, Val(Text1(7))) = 0 Then
            MsgBox "欲上傳的回覆單檔名與此案號不符，請重新確認！" & vbCrLf & m_strSaveFiles, vbCritical
            Screen.MousePointer = vbDefault
            Exit Function
        End If
        '2015/2/12 END
    End If
    '2015/1/7 END

    'Modified by Lydia 2017/06/19 將CheckDataValidate2改為CheckDataValidate3
    CheckDataValidate3 = True
End Function

'訊息為是否選項
Private Function CheckDataYN1(Index As Integer) As Boolean
Dim MsgStr As String
Dim i As Integer, j As Integer, ii As Integer
Dim strMsg As String
Dim Cancel As Boolean
Dim strApplID As String
'add by nickc 2007/05/23 加入檢查，收據抬頭
Dim RS090801 As New ADODB.Recordset
Dim strErrTxt As String, bolChkErr As Boolean, strText As String 'Add By Sindy 2012/6/6
Dim strPa158_S As String 'Add By Sindy 2014/7/28
Dim bolIsCN As Boolean 'Add by Amy 2020/09/01
Dim bolIsNewCus As Boolean, iRtn As Integer 'Add by Amy 2021/11/29
Dim strErrTxt2 As String  'Add By Sindy 2022/10/6
Dim varTemp As Variant, kk As Integer, strCaseNo As String
Dim strIN04 As String, strIN05 As String
Dim bolNewCus As Boolean, bol99 As Boolean 'Add By Sindy 2024/6/5
Dim intCuType As Integer, strNation As String 'Add by Amy 2024/06/24 intCuType:檢查ID,判斷個人/公司 strNation:國籍
    
    'Add By Sindy 2010/4/15
    'Modify By Sindy 2010/7/7 增加 And m_blnCallPrint = False 判斷
    If Option2(0).Value = True And Trim(cboTitle) <> "" And m_blnCallPrint = False Then
        If Trim(Text1(21)) <> Trim(cboTitle) Then
            If MsgBox("此客戶曾開立不同抬頭的收據，確定抬頭要開申請人嗎？", vbYesNo + vbDefaultButton2) = vbNo Then
                Exit Function
            End If
        End If
    End If
    '2010/4/15 End
       
    If strSrvDate(1) < strACSdate1 Then 'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅：取消提醒
        'Added by Lydia 2020/12/23 列印接洽單前檢查ACS案件選擇智權公司時，提醒訊息：請確認費用是否含稅！是否要修改金額？;  因為程式無法確定金額是否含稅，所以預設彈訊息。
        If Text1(6).Text = "ACS" And Trim(Combo4) = m_CompNameJ And m_blnCallPrint = False Then
           If MsgBox("請確認費用是否含稅！是否要修改金額？" & vbCrLf & "選""是""要修改金額，選""否""則繼續作業。", vbInformation + vbYesNo + vbDefaultButton1, "檢核資料") = vbYes Then
               Exit Function
           End If
        End If
        'end 2020/12/23
    End If 'Added by Lydia 2021/03/29
    
    'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅：案件性質為101~103Z時鎖住規費及點數欄(改案件性質>103Z時要放開)，當輸入費用後，自動依下列規則計算：
    If strSrvDate(1) >= strACSdate1 Then
        If Text1(6).Text = "ACS" Then
            For ii = 1 To GridCase.Rows - 1 '4
                Call GetGridCaseData(ii)
                MsgStr = "Y"
                Call SetACSautoFee(1, MsgStr) 'ii
                If MsgStr = "Y" Then  '彈訊息選不繼續作業
                   Exit Function
                End If
            Next
        End If
    End If
    'end 2021/03/29
    
    'add by nickc 2007/05/23 加入檢查，收據抬頭
    Set RS090801 = New ADODB.Recordset
    '1
    If Option31(0).Value = True And Trim(Text1(198)) = "" And ((Option2(1).Value = True And cboTitle.Text <> "") Or (Option2(0).Value = True And Text1(21) <> "")) Then
        If RS090801.State = 1 Then RS090801.Close
        strSql = "select distinct a0k03,a0k04 from acc0k0 where a0k04='" & IIf(Option2(1).Value = True, cboTitle.Text, Text1(21)) & "' order by a0k03 "
        RS090801.CursorLocation = adUseClient
        RS090801.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
        If RS090801.RecordCount <> 0 Then
            RS090801.MoveFirst
            MsgStr = ""
            Do While Not RS090801.EOF
                MsgStr = MsgStr & CheckStr(RS090801.Fields("a0k03")) & "==>" & CheckStr(RS090801.Fields("a0k04")) & vbCrLf
                RS090801.MoveNext
            Loop
            If RS090801.RecordCount = 1 Then
                If MsgBox("申請人1是否與" & vbCrLf & MsgStr & vbCrLf & "為關係企業？", vbYesNo, "沒有關係企業！") = vbYes Then
                    RS090801.MoveFirst
                    Text1(198) = CheckStr(RS090801.Fields(0))
                End If
            ElseIf RS090801.RecordCount > 1 Then
                If MsgBox("申請人1是否與下列任一為關係企業？" & vbCrLf & MsgStr & vbCrLf & "如果為關係企業，請輸入案件來源說明之關係企業！", vbYesNo, "沒有關係企業！") = vbYes Then
                    SSTab2.Tab = 0
                    Text1(198).SetFocus
                    Exit Function
                End If
            End If
        End If
    End If
    '2
    'Modified by Morgan 2020/5/20 +判斷有客戶名稱 Ex:T-081020 移轉
    'If Option32(0).Value = True And Trim(Text1(298)) = "" And ((Option2(1).Value = True And cboTitle.Text <> "") Or (Option2(0).Value = True And Text1(37) <> "")) Then
    If Option32(0).Value = True And Trim(Text1(37) & Text1(38)) <> "" And Trim(Text1(298)) = "" And ((Option2(1).Value = True And cboTitle.Text <> "") Or (Option2(0).Value = True And Text1(37) <> "")) Then
        If RS090801.State = 1 Then RS090801.Close
        strSql = "select distinct a0k03,a0k04 from acc0k0 where a0k04='" & IIf(Option2(1).Value = True, cboTitle.Text, Text1(37)) & "' order by a0k03 "
        RS090801.CursorLocation = adUseClient
        RS090801.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
        If RS090801.RecordCount <> 0 Then
            RS090801.MoveFirst
            MsgStr = ""
            Do While Not RS090801.EOF
                MsgStr = MsgStr & CheckStr(RS090801.Fields("a0k03")) & "==>" & CheckStr(RS090801.Fields("a0k04")) & vbCrLf
                RS090801.MoveNext
            Loop
            If RS090801.RecordCount = 1 Then
                If MsgBox("申請人2是否與" & vbCrLf & MsgStr & vbCrLf & "為關係企業？", vbYesNo, "沒有關係企業！") = vbYes Then
                    RS090801.MoveFirst
                    Text1(298) = CheckStr(RS090801.Fields(0))
                End If
            ElseIf RS090801.RecordCount > 1 Then
                If MsgBox("申請人2是否與下列任一為關係企業？" & vbCrLf & MsgStr & vbCrLf & "請輸入案件來源說明之關係企業！", vbYesNo, "沒有關係企業！") = vbYes Then
                    SSTab2.Tab = 1
                    Text1(298).SetFocus
                    Exit Function
                End If
            End If
        End If
    End If
    '3
    'Modified by Morgan 2020/5/20 +判斷有客戶名稱
    'If Option33(0).Value = True And Trim(Text1(398)) = "" And ((Option2(1).Value = True And cboTitle.Text <> "") Or (Option2(0).Value = True And Text1(53) <> "")) Then
    If Option33(0).Value = True And Trim(Text1(53) & Text1(54)) <> "" And Trim(Text1(398)) = "" And ((Option2(1).Value = True And cboTitle.Text <> "") Or (Option2(0).Value = True And Text1(53) <> "")) Then
        If RS090801.State = 1 Then RS090801.Close
        strSql = "select distinct a0k03,a0k04 from acc0k0 where a0k04='" & IIf(Option2(1).Value = True, cboTitle.Text, Text1(53)) & "' order by a0k03 "
        RS090801.CursorLocation = adUseClient
        RS090801.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
        If RS090801.RecordCount <> 0 Then
            RS090801.MoveFirst
            MsgStr = ""
            Do While Not RS090801.EOF
                MsgStr = MsgStr & CheckStr(RS090801.Fields("a0k03")) & "==>" & CheckStr(RS090801.Fields("a0k04")) & vbCrLf
                RS090801.MoveNext
            Loop
            If RS090801.RecordCount = 1 Then
                If MsgBox("申請人3是否與" & vbCrLf & MsgStr & vbCrLf & "為關係企業？", vbYesNo, "沒有關係企業！") = vbYes Then
                    RS090801.MoveFirst
                    Text1(398) = CheckStr(RS090801.Fields(0))
                End If
            ElseIf RS090801.RecordCount > 1 Then
                If MsgBox("申請人3是否與下列任一為關係企業？" & vbCrLf & MsgStr & vbCrLf & "請輸入案件來源說明之關係企業！", vbYesNo, "沒有關係企業！") = vbYes Then
                    SSTab2.Tab = 2
                    Text1(398).SetFocus
                    Exit Function
                End If
            End If
        End If
    End If
    '4
    'Modified by Morgan 2020/5/20 +判斷有客戶名稱
    'If Option34(0).Value = True And Trim(Text1(498)) = "" And ((Option2(1).Value = True And cboTitle.Text <> "") Or (Option2(0).Value = True And Text1(69) <> "")) Then
    If Option34(0).Value = True And Trim(Text1(69) & Text1(70)) <> "" And Trim(Text1(498)) = "" And ((Option2(1).Value = True And cboTitle.Text <> "") Or (Option2(0).Value = True And Text1(69) <> "")) Then
        If RS090801.State = 1 Then RS090801.Close
        strSql = "select distinct a0k03,a0k04 from acc0k0 where a0k04='" & IIf(Option2(1).Value = True, cboTitle.Text, Text1(69)) & "' order by a0k03 "
        RS090801.CursorLocation = adUseClient
        RS090801.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
        If RS090801.RecordCount <> 0 Then
            RS090801.MoveFirst
            MsgStr = ""
            Do While Not RS090801.EOF
                MsgStr = MsgStr & CheckStr(RS090801.Fields("a0k03")) & "==>" & CheckStr(RS090801.Fields("a0k04")) & vbCrLf
                RS090801.MoveNext
            Loop
            If RS090801.RecordCount = 1 Then
                If MsgBox("申請人4是否與" & vbCrLf & MsgStr & vbCrLf & "為關係企業？", vbYesNo, "沒有關係企業！") = vbYes Then
                    RS090801.MoveFirst
                    Text1(498) = CheckStr(RS090801.Fields(0))
                End If
            ElseIf RS090801.RecordCount > 1 Then
                If MsgBox("申請人4是否與下列任一為關係企業？" & vbCrLf & MsgStr & vbCrLf & "請輸入案件來源說明之關係企業！", vbYesNo, "沒有關係企業！") = vbYes Then
                    SSTab2.Tab = 3
                    Text1(498).SetFocus
                    Exit Function
                End If
            End If
        End If
    End If
    '5
    'Modified by Morgan 2020/5/20 +判斷有客戶名稱
    'If Option35(0).Value = True And Trim(Text1(598)) = "" And ((Option2(1).Value = True And cboTitle.Text <> "") Or (Option2(0).Value = True And Text1(85) <> "")) Then
    If Option35(0).Value = True And Trim(Text1(85) & Text1(86)) <> "" And Trim(Text1(598)) = "" And ((Option2(1).Value = True And cboTitle.Text <> "") Or (Option2(0).Value = True And Text1(85) <> "")) Then
        If RS090801.State = 1 Then RS090801.Close
        strSql = "select distinct a0k03,a0k04 from acc0k0 where a0k04='" & IIf(Option2(1).Value = True, cboTitle.Text, Text1(85)) & "' order by a0k03 "
        RS090801.CursorLocation = adUseClient
        RS090801.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
        If RS090801.RecordCount <> 0 Then
            RS090801.MoveFirst
            MsgStr = ""
            Do While Not RS090801.EOF
                MsgStr = MsgStr & CheckStr(RS090801.Fields("a0k03")) & "==>" & CheckStr(RS090801.Fields("a0k04")) & vbCrLf
                RS090801.MoveNext
            Loop
            If RS090801.RecordCount = 1 Then
                If MsgBox("申請人5是否與" & vbCrLf & MsgStr & vbCrLf & "為關係企業？", vbYesNo, "沒有關係企業！") = vbYes Then
                    RS090801.MoveFirst
                    Text1(598) = CheckStr(RS090801.Fields(0))
                End If
            ElseIf RS090801.RecordCount > 1 Then
                If MsgBox("申請人5是否與下列任一為關係企業？" & vbCrLf & MsgStr & vbCrLf & "請輸入案件來源說明之關係企業！", vbYesNo, "沒有關係企業！") = vbYes Then
                    SSTab2.Tab = 4
                    Text1(598).SetFocus
                    Exit Function
                End If
            End If
        End If
    End If
    
    'Add by Amy 2021/11/29 +國內同業控制,判斷申請人為新客戶且中文名稱有「事務所」彈詢問
    strSameTrade = ""
    For i = 0 To 4
        If i = 0 Then bolIsNewCus = Option31(0)
        If i = 1 Then bolIsNewCus = Option32(0)
        If i = 2 Then bolIsNewCus = Option33(0)
        If i = 3 Then bolIsNewCus = Option34(0)
        If i = 4 Then bolIsNewCus = Option35(0)
        If bolIsNewCus = True And InStr(Trim(Me.Text1(21 + i * 16).Text), "事務所") > 0 Then
            iRtn = MsgBox("新客戶" & Me.Text1(21 + i * 16).Text & "是否為國內同業？" & vbCrLf & _
                                        "是:為國內同業　否:非國內同業", vbYesNoCancel + vbDefaultButton3)
            '取消
            If iRtn = 2 Then
                SSTab2.Tab = i
                Exit Function
            Else
                strSameTrade = strSameTrade & ";申請人" & Chr(-23888 + i) & "：" & Me.Text1(21 + i * 16).Text
                '是
                If iRtn = 6 Then
                    strSameTrade = strSameTrade & "為"
                '否
                Else
                    strSameTrade = strSameTrade & "不是"
                End If
                strSameTrade = strSameTrade & "國內同業"
            End If
        End If
    Next i
    If strSameTrade <> MsgText(601) Then strSameTrade = Mid(strSameTrade, 2)
    'end 2021/11/29
    
    'Add by Morgan 2007/9/11 台灣專利商標出庭費控制
   '若有收【準備程序】或【言詞辯論】時服務費必須含【出庭費】NT10,000元
   If Left(Combo1(0), 3) = "000" Then
      '是否有收"準備程序"or"言詞辯論"
      intI = 0
      If (Text1(6) = "P" Or Text1(6) = "FCP") Then
'         For ii = 1 To 4
            'If Left(Combo1(ii), 3) = "211" Or Left(Combo1(ii), 3) = "212" Or Left(Combo1(ii), 3) = "247" Then
            If InStr(m_strCaseCPM, "211") > 0 Or InStr(m_strCaseCPM, "212") > 0 Or InStr(m_strCaseCPM, "247") > 0 Then
               intI = 1
'               Exit For
            End If
'         Next
      ElseIf (Text1(6) = "T" Or Text1(6) = "FCT") Then
'         For ii = 1 To 4
            'If Left(Combo1(ii), 3) = "204" Or Left(Combo1(ii), 3) = "205" Or Left(Combo1(ii), 3) = "214" Then
            If InStr(m_strCaseCPM, "204") > 0 Or InStr(m_strCaseCPM, "205") > 0 Or InStr(m_strCaseCPM, "214") > 0 Then
               intI = 1
'               Exit For
            End If
'         Next
      End If
      '有收
      If intI = 1 Then
         '是否有收出庭費NT10,000
'         intI = 0
'         For ii = 1 To 4
'            If Val(Text1(103 + 3 * (ii - 1))) >= 10 Then
'               intI = 1
'               Exit For
'            End If
'         Next
         '沒收
'         If intI = 0 Then
         If m_bolHad10Point = False Then
            'Added by Morgan 2020/5/27
            '若為B2案源時改收文法務案時提醒要含【出庭費】NT10,000元
            If strLSourceType = "B2" Then
               If strLOS18 = "" Then bolCourtFeeAlert = True
               
            ElseIf strLCaseNo(1) = "" Then
            'end 2020/5/27
            
               'Modify by Morgan 2011/1/14 改只提醒,程式段移到最後
               'MsgBox "若有收【準備程序】或【言詞辯論】時服務費必須含【出庭費】NT10,000元！", vbExclamation
               If MsgBox("若有收【準備程序】或【言詞辯論】時服務費必須含【出庭費】NT10,000元！" & vbCrLf & "本單是否確定不收【出庭費】？", vbYesNo + vbDefaultButton2 + vbExclamation) = vbNo Then
                  SSTab1.Tab = 0
                  Text1(101).SetFocus
                  Exit Function
               End If
               
            End If 'Added by Morgan 2020/5/27
         End If
      End If
      
      'Added by Morgan 2020/5/27
      'B2案源法務案【出庭費】NT10,000元提醒
      If strLSourceType = "B2" And Text1(6) = "L" Then
         If bolCourtFeeAlert = True Then
            '是否有收出庭費NT10,000
'            intI = 0
'            For ii = 1 To 4
'               If Val(Text1(103 + 3 * (ii - 1))) >= 10 Then
'                  intI = 1
'                  Exit For
'               End If
'            Next
            '沒收
'            If intI = 0 Then
            If m_bolHad10Point = False Then
               If bolIsB2CourtFee = True Then
                  MsgBox "本單服務費必須含【出庭費】NT10,000元！", vbExclamation
                  SSTab1.Tab = 0
                  Text1(101).SetFocus
                  Exit Function
                  
               ElseIf MsgBox("P/T案有收【準備程序】或【言詞辯論】，本單服務費必須含【出庭費】NT10,000元！" & vbCrLf & "是否確定不收【出庭費】？", vbYesNo + vbDefaultButton2 + vbExclamation) = vbNo Then
                  SSTab1.Tab = 0
                  Text1(101).SetFocus
                  Exit Function
               End If
            End If
         End If
      End If
      'end 2020/5/27
      
   End If
   'end 2007/9/11
   
   'Added by Morgan 2013/1/10
   '台灣再審檢查若有超項時提醒是否應收文
   If Text1(6) = "P" And arrNation(0) = "000" Then
'      For ii = 1 To 4
         'If Trim(Left(Me.Combo1(ii).Text, 4)) = "107" Then
         If InStr(m_strCaseCPM, "107") > 0 Then
'            Exit For
            'Modified by Morgan 2014/10/17 已審項數頁也要減
            strExc(0) = "select nvl(sum(cp136),0)-nvl(sum(cp137),0)-nvl(sum(cp138),0) from caseprogress where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " and cp27>0 and cp57 is null"
            'end 2014/10/17
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
            If intI = 1 Then
               If RsTemp(0) > 10 Then
'                  For intI = 1 To 4
'                     If Trim(Left(Me.Combo1(intI).Text, 4)) = "939" Then
'                        Exit For
'                     End If
'                  Next
'                  If intI > 4 Then
                  If InStr(m_strCaseCPM, "939") = 0 Then '超項費
                     If MsgBox("本案目前系統紀錄之請求項為 " & RsTemp(0) & "項(超過 10 項)，是否應收文超項費??", vbYesNo + vbDefaultButton1 + vbQuestion) = vbYes Then
                        Exit Function
                     End If
                  End If
               End If
            End If
         End If
'      Next
'      If ii < 5 Then
'      End If
   End If
   'end 2013/1/10
      
   'Add by Amy 2014/03/11 因應台日優先權證明文件電子交換作業控管彈訊息 (P台灣案)
    '2014/3/14 modify by sonia 加僅發明,新型,且只限制台灣或大陸案
    'If Trim(Text1(6)) = "P" And Left(Trim(Combo1(0).Text), 3) = "000" And bolIs405 = True Then
    'Modify by Amy 2017/07/20 改只限制台灣案-玲玲
    'If Trim(Text1(6)) = "P" And (Left(Trim(Combo1(0).Text), 3) = "000" Or Left(Trim(Combo1(0).Text), 3) = "020") And (Left(Combo6.Text, 1) = "1" Or Left(Combo6.Text, 1) = "2") And bolIs405 = True Then
    If Trim(Text1(6)) = "P" And Left(Trim(Combo1(0).Text), 3) = "000" And _
       (Left(Combo6.Text, 1) = "1" Or Left(Combo6.Text, 1) = "2") And InStr(m_strCaseCPM, "405") > 0 Then
        'Modify by Amy 2014/07/18 增加訊息
        'If MsgBox("若為用於日本專利申請案，則請改收文 436 申請優先權存取碼" & IIf(Left(Trim(Combo1(0).Text), 3) = "000", "，不需要規費", Null) & "！" & vbCrLf & "是否繼續列印?", vbYesNo + vbCritical + vbDefaultButton2, "詢問") = vbNo Then
        'Modify by Amy 2016/03/14 +台韓專利申請案,若有申請優先權證明書405,改收申請優先權電子交換437
        strExc(0) = ""
        'Modify by Amy 2017/07/20 改顯示文字內容-玲玲
        'If Left(Trim(Combo1(0).Text), 3) = "000" Then
            strMsg = GetCasePropertyName(Text1(6), "437", "CPM03")
            'Modify by Amy 2016/12/20 改顯示文字 原若「為」用於韓國 -雅娟
'            strExc(0) = "若僅使用於韓國專利申請案，則請改收文 437" & strMsg & "，不需要規費！" & vbCrLf & _
'                                "若同時使用於其他國家則不必收文 437 " & strMsg & "！"
            strExc(0) = "若使用於韓國專利申請案,則改收文437 " & strMsg & "，不需要規費！"
        'End If
        strMsg = GetCasePropertyName(Text1(6), "436", IIf(Left(Trim(Combo1(0).Text), 3) = "000", "CPM03", "CPM04"))
        'Modify by Amy 2016/12/20 改顯示文字 原若「為」用於韓國 -雅娟
'        strMsg = IIf(strExc(0) <> MsgText(601), strExc(0) & vbCrLf, "") & "若僅使用於日本專利申請案，則請改收文 436 " & strMsg & IIf(Left(Trim(Combo1(0).Text), 3) = "000", "，不需要規費", Null) & "！" & _
'                        vbCrLf & "若同時使用於其他國家則不必收文 436 " & strMsg & "！" & vbCrLf & "是否繼續列印？"
        strExc(1) = GetCasePropertyName(Text1(6), "405", "CPM03")  'Add by Amy 2017/07/20
        strMsg = IIf(strExc(0) <> MsgText(601), strExc(0) & vbCrLf, "") & "若僅使用於日本專利申請案，則改收文 436 " & strMsg & "，不需要規費！" & _
                        vbCrLf & "若同時辦理日本及其他國家，則收文 405 " & strExc(1) & _
                        vbCrLf & "(因申請優先權證明書官方就會給存取碼,不必另外申請)" & vbCrLf & "是否繼續作業？"
        'end 2017/07/20
        'end 2016/03/14
        If MsgBox(strMsg, vbYesNo + vbCritical + vbDefaultButton2, "詢問") = vbNo Then
            SSTab1.Tab = 0
            Me.Combo1(1).SetFocus
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    'end 2014/03/11
    
    'Added by Morgan 2016/1/4
    '國籍非臺灣的舊客戶收文大陸案主張優先權提醒優先權國家不可為台灣
    'Modified by Morgan 2018/1/23 +大陸、香港、澳門國籍也可以可主張臺灣優先權--郭
    'Modified by Morgan 2025/9/11 舊提醒取消改用新的
    '收文及分案時，若有主張優先權，則跳提醒「若要主張台灣優先權，則台灣案及大陸案的申請人中，均須包含有國籍為台灣的申請人，若有多位申請人，則第一申請人必須是台灣籍」
    If Trim(Text1(6)) = "P" And Left(Trim(Combo1(0).Text), 3) = "020" Then
        If InStr(m_strCaseCPM, "106") > 0 Then
            'strExc(1) = ""
            'For ii = 0 To 4
            '    If Text1(12 + ii * 16) <> "" Then
            '        strExc(2) = Left(Text1(12 + ii * 16) & "000", 9)
            '        strExc(0) = "select cu01||cu02 from customer where cu01='" & Left(strExc(2), 8) & "' and cu02='" & Mid(strExc(2), 9) & "' and cu10>'010' and cu10<>'020' and cu10<>'044' and cu10<>'013'"
            '        intI = 1
            '        Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
            '        If intI = 1 Then
            '            strExc(1) = "Y"
            '            Exit For
            '        End If
            '    End If
            'Next
            'If strExc(1) = "Y" Then
            '    If MsgBox("申請人國籍必須為臺灣或大陸地區才可主張臺灣優先權！是否確定要繼續？", vbYesNo + vbDefaultButton2 + vbExclamation) = vbNo Then
            '        Screen.MousePointer = vbDefault
            '        Exit Function
            '    End If
            'End If
            If PUB_CNPriorityMsg() = vbNo Then '選否
               Screen.MousePointer = vbDefault
               Exit Function
            End If
        End If
    End If
    'end 2025/9/11
    'end 2016/1/4
    
   'Added by Morgan 2025/9/11
   '台灣案(405)申請優先權證明書收文時，若該台灣案之申請人國籍為均非台灣，則跳提醒「因全部申請人均為外國籍無法用於主張中國大陸申請案，請確認此優先權證明書是否用於中國大陸。」
   If Trim(Text1(6)) = "P" And Left(Trim(Combo1(0).Text), 3) = "000" Then
      If InStr(m_strCaseCPM, "405") > 0 And InStr(Text1(34) & Text1(50) & Text1(66) & Text1(82) & Text1(98), "台灣") = 0 Then
         If PUB_TWPriCertMsg() = vbYes Then '選是
            Screen.MousePointer = vbDefault
            Exit Function
         End If
      End If
   End If
   'end 2025/9/11
   
    'Add By Sindy 2010/10/28 新案且可輸入案件屬性時, 檢查案件屬性不可空白
    'Modify By Sindy 2012/6/6 新案且專利種類為發明或新型時, 檢查案件屬性不可空白
'   If (Trim(Left(Me.Combo1(1).Text, 4)) = "101" Or Trim(Left(Me.Combo1(2).Text, 4)) = "101" Or _
'       Trim(Left(Me.Combo1(3).Text, 4)) = "101" Or Trim(Left(Me.Combo1(4).Text, 4)) = "101" Or _
'       Trim(Left(Me.Combo1(1).Text, 4)) = "102" Or Trim(Left(Me.Combo1(2).Text, 4)) = "102" Or _
'       Trim(Left(Me.Combo1(3).Text, 4)) = "102" Or Trim(Left(Me.Combo1(4).Text, 4)) = "102") And _
'        Combo5.Visible = True Then
    If Option1(0).Value = True And Combo5.Visible = True And Combo6.Visible = True Then
        'Added by Morgan 2012/11/23
        '102新法,若案件屬性ˇ選化學生醫且未收文「申請寄存」者，系統會詢問是否要提交寄存證明
        ', 若是, 則會再出現選項為是否由本所申請寄存，若是，則就一定要收文「申請寄存」
        '，若不是由本所代為 , 而是由客戶提供, 則要在接洽單備註欄說明，以利本所管制期限。
        If strSrvDate(1) >= "20130101" Then
            'Modified by Morgan 2022/6/14 +要排除設計案
            If Trim(Text1(6)) = "P" And Left(Trim(Combo1(0).Text), 3) = "000" And Left(Combo5.Text, 1) = "3" And Trim(Left(Combo6.Text, 1)) <> "3" Then
                If InStr(m_strCaseCPM, "108") = 0 Then
                    If MsgBox("是否要提交寄存證明？", vbYesNo + vbQuestion) = vbYes Then
                        If MsgBox("是否由本所申請寄存？", vbYesNo + vbQuestion) = vbYes Then
                            MsgBox "請一併收文申請寄存！", vbExclamation
                            SSTab1.Tab = 0
                            Screen.MousePointer = vbDefault
                            Exit Function
                        Else
                            m_strLiveProofMemo = "本案由客戶提供存活證明"
                            MsgBox "備註將自動加註 """ & m_strLiveProofMemo & """！", vbInformation
                        End If
                    End If
                End If
            End If
        End If
        'end 2012/11/23
    End If
    '2010/10/28 End
   
    'Add By Sindy 2014/7/28 新案,CFP或P時,本案與總號有輸入且為相同者,檢查案件屬性是否不同
    '                       並且專利種類為1.發明2新型時才檢查
    'Modify By Sindy 2022/11/9 + 設計 Or Trim(Left(Combo6.Text, 1)) = "3"
    'Modify By Sindy 2022/12/27 + cmdCRL55.Visible = True
    'Modify By Sindy 2025/8/15 增加排除P台灣的設計案,不檢查此規則
    If Not (Trim(Text1(6)) = "P" And Left(Trim(Combo1(0).Text), 3) = "000" And Trim(Left(Combo6.Text, 1)) = "3") Then
    '2025/8/15 END
      If Option1(0).Value = True And (Text1(6) = "P" Or Text1(6) = "CFP") And _
          cmdCRL55.Visible = True And Trim(Text1(100)) <> "" And Option5(0).Value = True And _
          (Trim(Left(Combo6.Text, 1)) = "1" Or Trim(Left(Combo6.Text, 1)) = "2" Or Trim(Left(Combo6.Text, 1)) = "3") Then
          'Modify By Sindy 2022/12/27 多個案號
          varTemp = Split(Trim(Text1(100)), ",")
          For kk = LBound(varTemp) To UBound(varTemp)
              strCaseNo = varTemp(kk)
              'Me.Text1(100).Text => strCaseNo
          '2022/12/27 END
              'Modify By Sindy 2014/8/26
              'ChgCaseNo Trim(Me.Text1(100).Text), strCase
              ChgCaseNo Replace(Trim(strCaseNo), "-", ""), strCase
              '2014/8/26 END
              'Modify By Sindy 2025/8/15 +,pa08,pa09
              strExc(0) = "SELECT nvl(pa08,' '),nvl(pa158,' '),pa08,pa09 FROM patent WHERE pa01='" & strCase(1) & "' and pa02='" & strCase(2) & "' and pa03='" & strCase(3) & "' and pa04='" & strCase(4) & "'"
              intI = 1
              Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
              If intI = 1 Then
                  'Modify By Sindy 2025/8/15 增加排除P台灣的設計案,不檢查此規則
                  If Not (strCase(1) = "P" And RsTemp.Fields("pa09") = "000" And RsTemp.Fields("pa08") = "3") Then
                  '2025/8/15 END
                     '案件屬性
                     If Combo5.Visible = False Then
                         strPa158_S = ""
                     Else
                         strPa158_S = Trim(Left(Combo5.Text, 1))
                     End If
                     If Trim(RsTemp.Fields(1)) <> strPa158_S Then
                         If MsgBox("與" & Trim(strCaseNo) & "(案件屬性：" & RsTemp.Fields(1) & ")" & vbCrLf & _
                             "的案件屬性不同，是否修改接洽單？", vbYesNo + vbCritical + vbDefaultButton2, "詢問") = vbYes Then
                             SSTab1.Tab = 0
                             Screen.MousePointer = vbDefault
                             Exit Function
                         End If
                     End If
                  End If
              End If
          Next kk
      End If
    End If
    '2014/7/28 END
    
    'Add By Sindy 2014/1/10 列印時若申請國家非台灣且非中國大陸, 而收據公司選擇智權公司時,
    '                       顯示訊息"非大陸案, 確定收據公司要選 智權公司 嗎 ?", 預設否
    'Modify By Sindy 2014/9/12 新案才需要詢問
    'Modified by Lydia 2020/03/30
    'If Option1(0).Value = True And arrNation(0) <> "000" And arrNation(0) <> "020" And Trim(Combo4) = "智權公司" Then
    '    If MsgBox("非大陸案, 確定收據公司要選 智權公司 嗎？", vbYesNo + vbQuestion + vbDefaultButton2) = vbNo Then
    If Option1(0).Value = True And arrNation(0) <> "000" And arrNation(0) <> "020" And Trim(Combo4) = m_CompNameJ Then
        If MsgBox("非大陸案, 確定收據公司要選 " & m_CompNameJ & " 嗎？", vbYesNo + vbQuestion + vbDefaultButton2) = vbNo Then
    'end 2020/03/30
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
        End If
    End If
    '2014/1/10 END
    
    'Add By Sindy 2010/11/22 送件方式
    If Frame18.Visible = True Then
        'Modify By Sindy 2024/1/22 P案領證601及年費605依原程式控制預設，並檢查一定要選擇一項。
        If Text1(6) = "P" And _
           (InStr(m_strCaseCPM, "601") > 0 Or InStr(m_strCaseCPM, "605") > 0) Then
            'Add by Morgan 2011/1/13
            If (OptSendType(0).Value Or OptSendType(1).Value Or OptSendType(2).Value) = False Then
                MsgBox "請點選送件方式!!!"
                SSTab1.Tab = 2
                SSTab3.Tab = 0 'Added by Morgan 2013/1/15
                Screen.MousePointer = vbDefault
                Exit Function
            End If
            'end 2011/1/13
        End If
        '2024/1/22 END
        If OptSendType(2).Value = True Then
            If Text1(126) = "" Then
                MsgBox "為指定日期送件時，指定送件日期不可空白!!!", vbExclamation + vbOKOnly
                SSTab1.Tab = 2
                SSTab3.Tab = 0 'Added by Morgan 2013/1/15
                Text1(126).SetFocus
                Screen.MousePointer = vbDefault
                Exit Function
            Else
               If strSrvDate(1) < 指定日期啟用日 Then
                  'Add by Morgan 2010/12/15
                  If Val(Text1(3)) > 0 And Val(Text1(126)) > Val(Text1(3)) Then
                      SSTab1.Tab = 2
                      SSTab3.Tab = 0 'Added by Morgan 2013/1/15
                      MsgBox "指定送件日期不可晚於本所期限!!!", vbExclamation + vbOKOnly
                      Text1(126).SetFocus
                      Screen.MousePointer = vbDefault
                      Exit Function
                  End If
               'Modify By Sindy 2023/12/12
               ElseIf Val(Text1(126)) < Val(strSrvDate(2)) Then
                  MsgBox "指定日期不可小於系統日！", vbExclamation, "輸入指定日期錯誤"
                  SSTab1.Tab = 2
                  SSTab3.Tab = 0
                  Text1(126).SetFocus
                  Screen.MousePointer = vbDefault
                  Exit Function
               ElseIf Text1(126) <> "" And Text1(1) <> "" And Val(Text1(126)) > Val(Text1(1)) Then
                  MsgBox "指定日期不可大於法定期限！", vbExclamation, "輸入指定日期錯誤"
                  SSTab1.Tab = 2
                  SSTab3.Tab = 0
                  Text1(126).SetFocus
                  Screen.MousePointer = vbDefault
                  Exit Function
               End If
               '2023/12/12 END
               'Add By Sindy 2024/3/15
               If OptCP164(0).Value = False And OptCP164(1).Value = False And OptCP164(2).Value = False Then
                  MsgBox "有輸入指定送件日，當天或之前或之後請擇一。", vbExclamation
                  SSTab1.Tab = 2
                  SSTab3.Tab = 0
                  Screen.MousePointer = vbDefault
                  Exit Function
               'Add By Sindy 2025/4/25
               ElseIf OptEP06(1).Value = True And (OptCP164(0).Value = True Or OptCP164(1).Value = True) Then
                  MsgBox "若「文件未齊備」時,不得指定日期「當日」及「之前」送件。", vbExclamation
                  SSTab1.Tab = 2
                  SSTab3.Tab = 0
                  Screen.MousePointer = vbDefault
                  Exit Function
               '2025/4/25 END
               End If
               '2024/3/15 END
            End If
        Else
            If Text1(126) <> "" Then
                MsgBox "不是指定日期送件時，指定日期不須輸入!!!", vbExclamation + vbOKOnly
                SSTab1.Tab = 2
                SSTab3.Tab = 0 'Added by Morgan 2013/1/15
                Text1(126).SetFocus
                Screen.MousePointer = vbDefault
                Exit Function
            End If
            'Add By Sindy 2023/12/12
            OptCP164(0).Value = False
            OptCP164(1).Value = False
            OptCP164(2).Value = False
            '2023/12/12 END
        End If
    End If
    
    'Add by Amy 2020/09/01 檢查申請人大陸身份證號
    For ii = 0 To 4
         bolIsCN = False: i = 0: strMsg = ""
         'Add By Sindy 2024/6/5
         bolNewCus = False
         'Modify by Amy 2024/06/24 先抓畫面申請人國籍,沒有抓申請地址檢查ID (原Sindy有判斷intTWAddr(1) = 99,秀玲說不需要)
         strNation = ""
         intCuType = 0 'Add by Amy 2024/06/24 0-未確認 個人或公司  / 1-個人 / 2-公司
         bolIsCN = ChkCN(Me.Text1(27 + ii * 16)) '申請地址:True=大陸
         '有輸申請人 中 or 英 文名稱
         If Trim(Me.Text1(21 + ii * 16).Text) <> "" Or Trim(Me.Text1(22 + ii * 16).Text) <> "" Then
            bol99 = False
            Select Case ii
               Case 0
                  bolNewCus = Option31(0).Value
                  If intTWAddr(2) = 99 Then bol99 = True  '非台灣
               Case 1
                  bolNewCus = Option32(0).Value
                  If intTWAddr(4) = 99 Then bol99 = True
               Case 2
                  bolNewCus = Option33(0).Value
                  If intTWAddr(6) = 99 Then bol99 = True
               Case 3
                  bolNewCus = Option34(0).Value
                  If intTWAddr(8) = 99 Then bol99 = True
               Case 4
                  bolNewCus = Option35(0).Value
                  If intTWAddr(10) = 99 Then bol99 = True
            End Select
            'Add by Amy 2024/06/24 先抓畫面申請人國籍,沒有抓申請地址zip變數(intTWAddr)-秀玲
            'Modify by Amy 2024/12/16 +[非]台灣大陸-bol99
            '國籍有值且不是大陸不是台灣,不用檢查
            If (Me.Text1(34 + ii * 16) <> MsgText(601) And InStr(Me.Text1(34 + ii * 16), "大陸") = 0 _
             And InStr(Me.Text1(34 + ii * 16), "臺灣") = 0 And InStr(Me.Text1(34 + ii * 16), "中華民國") = 0) Or bol99 = True Then
               strNation = "999"
            ElseIf InStr(Me.Text1(34 + ii * 16), "大陸") > 0 Then
               '檢查大陸身份證
               strNation = "020"
            ElseIf bolIsCN = True Then
               strNation = "020"
            ElseIf InStr(Me.Text1(34 + ii * 16), "臺灣") > 0 Or InStr(Me.Text1(34 + ii * 16), "中華民國") > 0 Then
               strNation = "000"
            'Modify by Amy 2024/08/29  連續收不設地址變數=10,原:intTWAddr((ii + 1) * 2) <= 10
            'Modify by Amy 2024/12/16 申請地址未輸 intTWAddr((ii + 1) * 2) =0,會誤判
            ElseIf intTWAddr((ii + 1) * 2) > 0 And intTWAddr((ii + 1) * 2) < 10 Then
               strNation = "000"
            End If
         End If
         '2024/6/5 END
         
         'Modify by Amy 2024/06/24 +新客戶僅台灣國籍,ID 一定要輸
         If bolNewCus = True And strNation = "000" And Trim(Me.Text1(92 + ii)) = MsgText(601) _
          And bol99 = False And bolIsCN = False Then
            MsgBox "收文新客戶時，未鍵入客戶之ID，請自行輸入 66666666 (8碼) !!!", vbExclamation + vbOKOnly
            SSTab1.Tab = 1
            SSTab2.Tab = ii
            Me.Text1(92 + ii).SetFocus
            Screen.MousePointer = vbDefault
            Exit Function
         'Modify by Amy 2024/12/16 改[非]台灣大陸 需檢查8個[0]
'         ElseIf strNation = "999" Then
'            i = 99 '非大陸/非臺灣 不需檢查
         'ID No.不為空值,且可輸入
         ElseIf Me.Text1(92 + ii) <> MsgText(601) And Me.Text1(92 + ii).Enabled = True Then
            'ex:接洽單號 1130027279 X38120060  國籍[非]台灣大陸,ID不可輸6個[0];若沒輸申請地址,會抓不到strNation
            If strNation = "999" Or strNation = MsgText(601) Then
               i = 9
            End If
         'end 2024/12/16
            '舊客戶-有客戶編號
            If Me.Text1(12 + ii * 16) <> MsgText(601) Then
                'Modify by Amy 2024/06/24 身份證檢查改抓Pub_CheckIDAll函數,調整傳入變數
                '個人
                If Text1(92 + ii).Tag = "0" Then
                  intCuType = 1
                '公司
                Else
                  intCuType = 2
                End If
                'Mark by Amy 2024/08/14 +大陸 社會信用代碼=統編
'                '大陸不檢查統編 且 公司 不檢查統編
'                If strNation = "020" And intCuType = 2 Then
'                  i = 99
'                End If
                'end 2024/06/24
            '新客戶
            Else
               'Modify by Amy 2024/06/24 身份證檢查改抓Pub_CheckIDAll函數,調整傳入變數
               If strNation = "020" Then
                  'Modify by Amy 2024/08/14 +大陸 社會信用代碼=統編(原:i = 99 '大陸統編不檢查)
                  If Len(Text1(92 + ii).Text) = 18 Then
                     'Memo by Amy 2024/08/14 原:以 申請人(中) 判斷長度為4個字以下(含)為個人
                     '大陸 身份證 及 社會信用代碼 都為18碼,故判先判斷 社會信用代碼=false 再判斷身份證
                     i = 5
                  '有輸彈長度不正確
                  Else
                     i = 0
                  End If
               '台灣統編10碼
               ElseIf strNation = "000" Then
                  If Len(Text1(92 + ii).Text) = 8 Then
                     i = 2 '只檢查統編
                  ElseIf Len(Text1(92 + ii).Text) = 10 Then
                     i = 1 '只檢查身份證
                  Else
                     i = 0
                  End If
               End If
               'end 2024/06/24
            End If
            
            'Modify by Amy 2024/12/16 原判斷  i <> 99,因接洽單號 1130027279 X38120060 國籍[非]台灣大陸,ID輸6個[0],應不可存檔
            '新客戶 Or  舊客戶 ID No.不為空值,且可輸入
            If bolNewCus = True Or (bolNewCus = False And Text1(92 + ii) <> MsgText(601) And Text1(92 + ii).Enabled = True) Then
                'Modify by Amy 2024/06/24 改抓Pub_CheckIDAll
'                If CheckID(i, Text1(92 + ii).Text) = False Then
'                    'Modify by Amy 2023/11/15 若輸入台灣身分證字號第一字為[全型],且回傳i=3 仍會顯示身份證字號訊息拆開顯示比較明顯
'                    If i = 0 Then
'                    'If i = 0 Or i = 3 Then
'                       strMsg = "申請人 身分證字號錯誤，是否確定 ?"
'                    Else
'                       If i = 3 Then
'                           strMsg = "[大陸]申請人 身分證字號錯誤，是否確定 ?"
'                       Else
'                           strMsg = "統一編號錯誤，是否確定 ?"
'                       End If
'                    End If
'                    If MsgBox(strMsg, vbYesNo + vbCritical) = vbNo Then
'                        SSTab1.Tab = 1
'                        SSTab2.Tab = ii
'                        Call Text1_GotFocus(92 + ii)
'                        Screen.MousePointer = vbDefault
'                        Exit Function
'                    End If
'                End If
                If Pub_CheckIDAll(i, Me.Name, Text1(92 + ii).Text, strNation, "申請人" & ii + 1, Text1(92 + ii), intCuType, SSTab1, SSTab2) = False Then
                  SSTab1.Tab = 1
                  SSTab2.Tab = ii
                  Call Text1_GotFocus(92 + ii)
                  Screen.MousePointer = vbDefault
                  Exit Function
                End If
            End If
         End If
    Next ii
    'end 2020/09/01
    
    '若為新案
    'If Me.Option1(0).Value = True  Then
    If Me.Option1(0).Value = True Or _
      Option32(0).Value = True Or Option33(0).Value = True Or Option34(0).Value = True Or Option35(0).Value = True Then
        'edit by Toni 2008/8/20
        '若為新案 檢查P or CFP 輸入發明人
        If (Trim(Text1(6).Text) = "P" Or Trim(Text1(6).Text) = "CFP") And Me.Option1(0).Value = True Then
            If Text2(0) = "" Then
                If MsgBox("是否輸入發明人資料?", vbExclamation + vbYesNo) = vbYes Then
                    SSTab1.Tab = 3
                    If Text2(0).Enabled = True Then Text2(0).SetFocus
                    Screen.MousePointer = vbDefault
                    Exit Function
                End If
            End If
        End If
    End If
    
    '發明人資料
    'Add By Sindy 2010/02/01 增加IF條件
    If (Trim(Text1(6).Text) = "P" Or Trim(Text1(6).Text) = "CFP") And Me.Option1(0).Value = True Then
    '2010/02/01 End
        'Add By Sindy 2023/2/1
        If Option31(1).Value = True Then '申請人1舊客戶時
            For i = 0 To 9
               If Text2(i).Text <> "" And Trim(Text3(i).Text) <> "" Then
                  '新發明人時,檢查ID是否有重覆
                  'Modify By Sindy 2023/5/11 +And in04<>'" & Text2(i).Text & "' 增加判斷更名狀況
                  strSql = "Select * From Inventor Where in01=" & CNULL(Left(Text1(12).Text, 8)) & _
                           " And LTrim(RTrim(in03))='" & Trim(Text3(i).Text) & "' And in04<>'" & Text2(i).Text & "'"
                  intI = 1
                  Set RsTemp = ClsLawReadRstMsg(intI, strSql)
                  If intI = 1 Then
                     MsgBox "此發明人[ " & Text2(i).Text & " ] ID重覆了 [ " & RsTemp.Fields("in04") & "( NO:" & RsTemp.Fields("in01") & RsTemp.Fields("in02") & " ) ]！" & vbCrLf & vbCrLf & "注意：若為更名狀況，請先通知專業部程序人員修改後再填寫接洽單！", vbExclamation + vbOKOnly
                     SSTab1.Tab = 3
                     If Text2(i).Enabled = True Then Text2(i).SetFocus
                     Screen.MousePointer = vbDefault
                     Exit Function
                  End If
                  
                  'Add By Sindy 2024/8/8 檢查待收文區裡是否有同身分證字號的發明人
                  strSql = "select CRL01,cri05,cri06 From ConsultRecordList,flow003,consultrecinv" & _
                           " where crl02>=" & 接洽單電子收文啟用日 & _
                           " and CRL01=f0301(+) and f0301 is not null and f0309 is null" & _
                           " and crl78='" & strUserNum & "'" & _
                           " and cri01(+)=CRL01 and cri03 is null and LTrim(RTrim(cri05))='" & Trim(Text3(i).Text) & "' and cri06<>'" & Text2(i).Text & "'"
                  If Trim(Text5) <> "" Then
                     strSql = strSql & " and CRL01<>'" & Trim(Text5) & "'"
                  End If
                  intI = 1
                  Set RsTemp = ClsLawReadRstMsg(intI, strSql)
                  If intI = 1 Then
                     MsgBox "此發明人[ " & Text2(i).Text & " ] ID重覆了" & vbCrLf & vbCrLf & "[同於待收文區裡的發明人 " & RsTemp.Fields("cri06") & " ( " & RsTemp.Fields("cri05") & " )]！", vbExclamation + vbOKOnly
                     SSTab1.Tab = 3
                     If Text2(i).Enabled = True Then Text2(i).SetFocus
                     Screen.MousePointer = vbDefault
                     Exit Function
                  End If
                  '2024/8/8 END
               End If
               '無客戶發明人代號,示為新增
               If Label5(i).Tag = "" Then
                  If Text2(i).Text <> "" Then
                     strIN04 = "": strIN05 = ""
                     Call PUB_analyzeINVname(Text2(i).Text, strIN04, strIN05) '解析發明人名稱
                     If strIN04 = "" And strIN05 = "" Then strIN04 = Text2(i).Text 'Add By Sindy 2023/5/11
                     '新發明人時,檢查名稱是否有重覆
                     '中文名稱
                     If strIN04 <> "" Then
                        strSql = "Select * From Inventor Where in01=" & CNULL(Left(Text1(12).Text, 8)) & _
                                 " And LTrim(RTrim(in04))='" & strIN04 & "'"
                        'Modify By Sindy 2024/5/8 增加ID做檢查
                        If Trim(Text3(i).Text) <> "" Then
                           strSql = strSql & " And LTrim(RTrim(in03))='" & Text3(i).Text & "'"
                        End If
                        '2024/5/8 END
                        intI = 1
                        Set RsTemp = ClsLawReadRstMsg(intI, strSql)
                        If intI = 1 Then
                           MsgBox "此發明人[ " & Text2(i).Text & " ] 中文名稱重覆了 [ " & RsTemp.Fields("in04") & "( NO:" & RsTemp.Fields("in01") & RsTemp.Fields("in02") & " ) ]！", vbExclamation + vbOKOnly
                           SSTab1.Tab = 3
                           If Text2(i).Enabled = True Then Text2(i).SetFocus
                           Screen.MousePointer = vbDefault
                           Exit Function
                        End If
                     End If
                     '英文名稱
                     If strIN05 <> "" Then
                        strSql = "Select * From Inventor Where in01=" & CNULL(Left(Text1(12).Text, 8)) & _
                                 " And LTrim(RTrim(in05))='" & strIN05 & "'"
                        intI = 1
                        Set RsTemp = ClsLawReadRstMsg(intI, strSql)
                        If intI = 1 Then
                           MsgBox "此發明人[ " & Text2(i).Text & " ] 英文名稱重覆了 [ " & RsTemp.Fields("in04") & "( NO:" & RsTemp.Fields("in01") & RsTemp.Fields("in02") & " ) ]！", vbExclamation + vbOKOnly
                           SSTab1.Tab = 3
                           If Text2(i).Enabled = True Then Text2(i).SetFocus
                           Screen.MousePointer = vbDefault
                           Exit Function
                        End If
                     End If
                  End If
               End If
            Next i
        End If
        '2023/2/1 END
        For i = 0 To 9
            If Text2(i).Text <> "" And Combo3(i).Text = "000 台灣" And Text3(i).Text = "" Then
                If MsgBox("請輸入發明人ID", vbYesNo + vbCritical) = vbYes Then
                    'MsgBox "請輸入發明人ID", vbOKOnly
                    Me.SSTab1.Tab = 3
                    If Text3(i).Enabled = True Then Text3(i).SetFocus
                    Screen.MousePointer = vbDefault
                    Exit Function
                Else
                    Screen.MousePointer = vbDefault
                    Exit For
                End If
            End If
        Next i
    End If
    'end 2010/02/01
    
    'Add by Amy 2020/09/01 發明人 為大陸之身份證檢查(與申請人一致於最後檢查-秀玲)
    For ii = 0 To 9
        If Me.Text2(ii).Text <> MsgText(601) And Left(Me.Combo3(ii), 3) = "020" And Me.Text3(ii).Text <> MsgText(601) Then
            If GetTextLength(Text3(ii).Text) <> 18 Then
                If MsgBox("發明人 大陸身份證必須是18碼 ! 請確定 ?", vbYesNo + vbCritical) = vbNo Then
                    Me.SSTab1.Tab = 3
                    Call Text3_GotFocus(ii)
                    If Text3(ii).Enabled = True Then Text3(ii).SetFocus
                    Screen.MousePointer = vbDefault
                    Exit Function
                End If
            End If
            If CheckID(3, Text3(ii).Text) = False Then
                If MsgBox("發明人 大陸身分證字號錯誤，是否確定 ?", vbYesNo + vbCritical) = vbNo Then
                    Me.SSTab1.Tab = 3
                    Call Text3_GotFocus(ii)
                    If Text3(ii).Enabled = True Then Text3(ii).SetFocus
                    Screen.MousePointer = vbDefault
                    Exit Function
                End If
            End If
        End If
    Next ii
    'end 2020/09/01
    
    'Add By Sindy 2014/4/15 P大陸新案,增加檢查發明人國籍為中國大陸者,顯示提醒訊息
    If Me.Option1(0).Value = True And Text1(6) = "P" And Left(Trim(Combo1(0).Text), 3) = "020" Then
        If Left(Trim(Combo3(0).Text), 3) = "020" Or Left(Trim(Combo3(1).Text), 3) = "020" Or _
            Left(Trim(Combo3(2).Text), 3) = "020" Or Left(Trim(Combo3(3).Text), 3) = "020" Or _
            Left(Trim(Combo3(4).Text), 3) = "020" Or Left(Trim(Combo3(5).Text), 3) = "020" Or _
            Left(Trim(Combo3(6).Text), 3) = "020" Or Left(Trim(Combo3(7).Text), 3) = "020" Or _
            Left(Trim(Combo3(8).Text), 3) = "020" Or Left(Trim(Combo3(9).Text), 3) = "020" Then
            If InStr(m_strCaseCPM, "430") = 0 Then
                If MsgBox("是否要收文保密審查？", vbExclamation + vbYesNo) = vbYes Then
                    SSTab1.Tab = 0
                    Screen.MousePointer = vbDefault
                    Exit Function
                End If
            End If
        End If
    End If
    '2014/4/15 END
    
    'Add by Morgan 2010/12/15
    If InStr(m_strCaseCPM, "307") > 0 And _
        Combo5.Visible = True Then
        If Combo5.Text = "" Then
            If MsgBox("分割案若為發明或新型則案件屬性不可空白，是否要輸入?", vbYesNo + vbQuestion + vbDefaultButton1) = vbYes Then
                SSTab1.Tab = 0
                Combo5.SetFocus
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        Else
            Cancel = False
            Combo5_Validate Cancel
            If Cancel = True Then
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        End If
    End If
    'end 2010/12/15
    
    'Add By Sindy 2011/6/7 L且為舊案時,詢問之
    bolPrintNewCase = False
    If Option1(1).Value = True And Text1(6) = "L" Then
    
        'Modified by Morgan 2020/5/18 BC類案源的法務舊案一律收新審級
        'If MsgBox("是否為不同審級的訴訟程序收文？", vbExclamation + vbYesNo) = vbYes Then
        'Modified by Morgan 2021/7/19 取消 C類案源
        'If Left(strLSourceType, 1) = "B" Or Left(strLSourceType, 1) = "C" Then
        If Left(strLSourceType, 1) = "B" Then
            '補收款除外
            If bolIsB2CourtFee = True Or strLCaseCP10 = "78" Then
               intI = vbNo
            Else
               'MsgBox "BC類案源的法務舊案自動設定為不同審級！", vbInformation
               MsgBox "B類案源的法務舊案自動設定為不同審級！", vbInformation
               intI = vbYes
            End If
        Else
            'Modify By Sindy 2022/9/28 L-888888請取消詢問是否為不同審級的訴訟程序收文。
            If Not (Text1(6) = "L" And Text1(7) = "888888") Then
            '2022/9/28 END
               intI = MsgBox("是否為不同審級的訴訟程序收文？", vbExclamation + vbYesNo)
            End If
        End If
        If intI = vbYes Then
        'end 2020/5/18
        
            strSql = "SELECT a.maxLC03,LC47 FROM LawCase, " & _
                    "(SELECT max(LC03) as maxLC03 FROM LawCase WHERE LC01='" & Text1(6) & "' AND LC02='" & Text1(7) & "') a " & _
                    "WHERE LC01='" & Text1(6) & "' AND LC02='" & Text1(7) & "' AND LC03='" & Text1(8) & "' AND LC04='" & Text1(9) & "' "
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strSql)
            If intI = 1 Then
               Text1(8).Tag = Text1(8) 'Added by Morgan 2020/4/21
                '審級為0-9,A-Z
                If Val(RsTemp.Fields(0)) >= 0 And Val(RsTemp.Fields(0)) <= 8 Then
                    Text1(8) = Val(RsTemp.Fields(0)) + 1
                ElseIf Val(RsTemp.Fields(0)) = 9 Then
                    Text1(8) = "A"
                Else
                    Text1(8) = Chr(Asc(RsTemp.Fields(0)) + 1)
                End If
                '同時要印出母號的案件屬性欄資料
                Frame19.Visible = True
                Text1(127).Text = "" & RsTemp.Fields(1)
                '為新案
                bolPrintNewCase = True
            End If
        End If
    End If
    'end 2011/6/7
    
    'Add By Sindy 2012/6/6 非自動收文也做重複收文提醒,檢查該案號若有相同案件性質且本所期限未到未取消的收文
    '不管是否已發文,都要顯示訊息讓使用者可選擇是否收文
    If Option1(1).Value = True Then
        strText = "": strErrTxt = "": strErrTxt2 = ""
        strText = m_strCaseCPM
'        For i = 1 To 4
'            If Trim(Combo1(i).Text) <> "" Then
'                arrCaseProperty = Split(Me.Combo1(i).Text, " ") 'Add By Sindy 2012/6/28
'                'Modify By Sindy 2015/8/27 CFP,040.印度的930.商業使用聲明，排除收文重覆的檢查
'                If Not (Text1(6) = "CFP" And Left(Me.Combo1(0).Text, 3) = "040" And Trim(arrCaseProperty(0)) = "930") Then
'                '2015/8/27 END
'                    If strText <> "" Then strText = strText & ","
'                    'Modify By Sindy 2012/6/28
'                    'strText = strText & Trim(Left(Trim(Combo1(i)), 4))
'                    strText = strText & Trim(arrCaseProperty(0))
'                    '2012/6/28 End
'                End If
'            End If
'        Next i
        'Modify By Sindy 2015/8/27 CFP,040.印度的930.商業使用聲明，排除收文重覆的檢查
        If Text1(6) = "CFP" And Left(Me.Combo1(0).Text, 3) = "040" And InStr(strText, "930") > 0 Then
            strText = Replace(strText, "930", "")
            strText = Replace(strText, ",,", ",")
            If strText <> "" Then
               If Left(strText, 1) = "," Then strText = Mid(strText, 2)
               If Right(strText, 1) = "," Then strText = Mid(strText, 1, Len(strText) - 1)
            End If
        End If
        'Modify By Sindy 2015/8/27
        If Trim(strText) <> "" Then
        '2015/8/27 END
            'Modify by Amy 2014/10/23 原CPM03
            strSql = "SELECT  Decode('" & arrNation(0) & "', '000', CPM03, CPM04),cp27,cp10,'C' as RecvType FROM caseprogress,casepropertymap" & _
                     " WHERE CP01='" & Text1(6) & "' AND CP02='" & Text1(7) & "' AND CP03='" & Text1(8) & "' AND CP04='" & Text1(9) & "'" & _
                     " AND CP10 in('" & Replace(strText, ",", "','") & "') AND CP06>" & strSrvDate(1) & " AND CP57 is null" & _
                     " AND CP01=CPM01(+) AND CP10=CPM02(+)"
            'Add By Sindy 2022/10/6 加接洽單檢查
            strSql = strSql & " union " & _
                     "SELECT  Decode('" & arrNation(0) & "', '000', CPM03, CPM04),0,crc03,'A' as RecvType FROM ConsultRecordList,ConsultRecCMP,casepropertymap" & _
                     " WHERE CRL07='" & Text1(6) & "' AND CRL08='" & Text1(7) & "' AND CRL09='" & Text1(8) & "' AND CRL10='" & Text1(9) & "'" & _
                     " AND CRC03 in('" & Replace(strText, ",", "','") & "') AND CRL79>=" & strSrvDate(1) & _
                     " AND CRL01=CRC01(+) AND CRC08 is null" & _
                     " AND CRL07=CPM01(+) AND CRC03=CPM02(+) " & IIf(Text5.Text <> "", "AND CRL01<>'" & Text5.Text & "' ", "")
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strSql)
            If intI = 1 Then
                RsTemp.MoveFirst
                Do While Not RsTemp.EOF
                    'Modify By Sindy 2015/8/31
                    If Not (Text1(6) = "CFP" And _
                        (arrNation(0) = "040" Or arrNation(0) = "015" Or arrNation(0) = "016") And _
                        RsTemp.Fields("cp10") = "107" And _
                        "" & RsTemp.Fields("cp27") <> "") Then
                    '2015/8/31 END
                        If InStr(strErrTxt, RsTemp.Fields(0)) = 0 Then
                           If strErrTxt <> "" Then strErrTxt = strErrTxt & "、"
                           strErrTxt = strErrTxt & RsTemp.Fields(0)
                        End If
                        'Add by Sindy 2022/10/6
                        If InStr(strErrTxt2, IIf(RsTemp.Fields("RecvType") = "C", "進度檔已收文", "接洽單已新增")) = 0 Then
                           If strErrTxt2 <> "" Then strErrTxt2 = strErrTxt2 & "、"
                           strErrTxt2 = strErrTxt2 & IIf(RsTemp.Fields("RecvType") = "C", "進度檔已收文", "接洽單已新增")
                        End If
                        '2022/10/6 END
                    End If
                    RsTemp.MoveNext
                Loop
                'Modify By Sindy 2015/8/31
                If strErrTxt <> "" Then
                '2015/8/31 END
                    If MsgBox("此案" & Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9) & "案件性質(" & strErrTxt & ")(" & strErrTxt2 & ")，請確認是否要再收文？", vbExclamation + vbYesNo) = vbNo Then
                        Screen.MousePointer = vbDefault
                        Exit Function
                    End If
                End If
            End If
        End If
    End If
    '2012/6/6 End
    
    'Add By Sindy 2011/1/24 檢查相同國家若有舊案申請地址與客戶目前申請地址不同時，提醒操作人員
    m_ChkOCaseAndCAddrNotAlike = False
    arrNation = Split(Me.Combo1(0).Text, " ") '申請國家
    strApplID = ""
    If Trim(Text1(12)) <> "" Then '申請人1
        If strApplID <> "" Then strApplID = strApplID & ","
        strApplID = strApplID & "'" & Trim(Text1(12)) & "'"
    End If
    If Trim(Text1(28)) <> "" Then '申請人2
        If strApplID <> "" Then strApplID = strApplID & ","
        strApplID = strApplID & "'" & Trim(Text1(28)) & "'"
    End If
    If Trim(Text1(44)) <> "" Then '申請人3
        If strApplID <> "" Then strApplID = strApplID & ","
        strApplID = strApplID & "'" & Trim(Text1(44)) & "'"
    End If
    If Trim(Text1(60)) <> "" Then '申請人4
        If strApplID <> "" Then strApplID = strApplID & ","
        strApplID = strApplID & "'" & Trim(Text1(60)) & "'"
    End If
    If Trim(Text1(76)) <> "" Then '申請人5
        If strApplID <> "" Then strApplID = strApplID & ","
        strApplID = strApplID & "'" & Trim(Text1(76)) & "'"
    End If
    m_CaseAndCAddrNotAlikePrint = False 'Add By Sindy 2011/7/11
    If strApplID <> "" And m_strNewCP10 <> "" Then '新申請案
'        For i = 1 To 4
'            If Me.Combo1(i).Text <> "" Then
'                arrCaseProperty = Split(Me.Combo1(i).Text, " ") '案件性質
                If ChkOCaseAndCAddrNotAlike(strApplID, arrNation(0), Text1(6), m_strNewCP10, rsAddrNotAlike, IIf(m_AppAddrChange = True, False, True)) = True Then
                    m_ChkOCaseAndCAddrNotAlike = True
                    'Add By Sindy 2011/7/11
                    If m_AppAddrChange = True Then
                        'Modify By Sindy 2022/9/6 不用詢問，直接EMAIL
                        'If MsgBox("有舊案件與客戶目前申請地址不同，是否要列印為附件？", vbExclamation + vbYesNo) = vbYes Then
                            m_CaseAndCAddrNotAlikePrint = True
'                            Exit For
                        'End If
                    End If
                    '2011/7/11 End
'                    Exit For
                End If
'            End If
'        Next i
    End If
    '2011/1/24 End
    'Add by Amy 2020/02/14 收據抬頭 勾選 其他且有輸全銜 且勾選 特殊收據 需彈訊息讓使用者選擇
    If Option2(1).Value = True And cboTitle <> MsgText(601) And Check9.Value = 1 Then
        Do While (stChReceipt = "" Or Val(stChReceipt) > 2)
            stChReceipt = InputBox("收據抬頭「其他」不可與「特殊收據」同時存在" & vbCrLf & _
                                "要印　1.收據抬頭「其他」" & vbCrLf & _
                                "　　　2.特殊收據", "收據確認！")
            If stChReceipt = "" And Not IsNumeric(stChReceipt) = True Then
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        Loop
        If stChReceipt = "1" Then
            Check9.Value = 0
        Else
            bolNotClsVal = True
            cboTitle = ""
            bolNotClsVal = False
        End If
    End If
    'end 2020/02/14
    'add by nickc 2005/05/27
    Is307or308 = False
    If m_strCaseCPM <> "" And Is307or308 = False Then
        '2006/4/14 MODIFY BY SONIA 取消專利案的分割案份數的限制
        'If (arrCaseProperty(0) = "308" And (Text1(6) = "CFT" Or Text1(6) = "FCT" Or Text1(6) = "T" Or Text1(6) = "TF")) Or (arrCaseProperty(0) = "307" And (Text1(6) = "CFP" Or Text1(6) = "FCP" Or Text1(6) = "P")) Then
        '2009/3/24 MODIFY BY SONIA 取消CFT案的分割案份數的限制
        'If (arrCaseProperty(0) = "308" And (Text1(6) = "CFT" Or Text1(6) = "FCT" Or Text1(6) = "T" Or Text1(6) = "TF")) Then
        If (InStr(m_strCaseCPM, "308") > 0 And (Text1(6) = "FCT" Or Text1(6) = "T" Or Text1(6) = "TF")) Then
            Is307or308 = True
        End If
    End If
    'CountBy307308 = "1"
    'Modify by Amy 2014/10/08 +T案大陸分割控制(僅分割1個子案)
    'If Is307or308 = True Then
    If Is307or308 = True And Not (Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T") Then
        Do While Val(CountBy307308) < 2
            CountBy307308 = InputBox("請輸入分割成幾案？" & vbCrLf & "數字應大於等於 2 。" & vbCrLf & vbCrLf & "取消為不繼續！", "分割！", 2) '取消為不列印
            If CountBy307308 = "" Then
                Screen.MousePointer = vbDefault
                Exit Function
            End If
        Loop
    End If
    'end 2005/05/27
    
'Add By Sindy 2025/8/20 此處檢查的共用訊息
Dim strMsgText As String
    strMsgText = "此號數為本所客戶之申請案(非爭議案)，本所案號為：XXX-XXXXXX，" & vbCrLf & vbCrLf & _
                 "＊若為此案之後續爭議收文，請選擇「否」，請先通知程序人員改卷宗性質後再收　文舊案；" & vbCrLf & vbCrLf & _
                 "＊若非此案爭議收文請選擇「是」。" & vbCrLf & vbCrLf & _
                 "　要繼續收文嗎？"
    'Add by Amy 2016/09/01 601異議/603評定/605廢止新案商標案控制
    'Memo by Lydia 2025/08/21 T台灣新案收文707 調查時，Service1存檔時設定卷宗性質為:4(廢止)
    If Option1(0).Value = True _
      And (Text1(6).Text = "CFT" Or Text1(6).Text = "T" Or Text1(6).Text = "FCT" Or Text1(6).Text = "TF") _
      And (m_bolNewCase = False And _
           (InStr(m_strCaseCPM, "601") > 0 Or InStr(m_strCaseCPM, "603") > 0 Or InStr(m_strCaseCPM, "605") > 0) _
          ) Then
        Call frm090801_10.SetParent(Me, "1") 'Added by Lydia 2020/12/15 預設模式
        frm090801_10.strTM12 = Text1(132)
        frm090801_10.strTM15 = Text1(129)
        i = frm090801_10.GetTM1215Rec(strCaseNo1, strCaseNo2, StrCaseNo3, strCaseNo4, strTM28)
        If i = 1 Then
            Screen.MousePointer = vbDefault
            If strTM28 = "1" Then
                'Modify By Sindy 2025/8/20
                'strMsg = "此號數為本所客戶案件,要繼續收文？"
                strMsg = Replace(strMsgText, "XXX-XXXXXX", IIf(StrCaseNo3 & strCaseNo4 = "000", strCaseNo1 & "-" & strCaseNo2, strCaseNo1 & "-" & strCaseNo2 & "-" & StrCaseNo3 & "-" & strCaseNo4))
                '2025/8/20 END
                If MsgBox(strMsg, vbYesNo) = vbNo Then
                    Exit Function
                End If
            Else
                If Text1(129) <> MsgText(601) And Text1(132) <> MsgText(601) Then
                    strMsg = "此「審定號 " & Text1(129) & "」及「申請案號 " & Text1(132) & "」" & vbCrLf
                ElseIf Text1(129) <> MsgText(601) Then
                    strMsg = "此「審定號 " & Text1(129) & "」"
                Else
                    strMsg = "此「申請案號 " & Text1(132) & "」"
                End If
                strMsg = strMsg & "之本所案號為 " & strCaseNo1 & "-" & strCaseNo2 & "-" & StrCaseNo3 & "-" & strCaseNo4 & _
                        "要改收此舊案？"
                If MsgBox(strMsg, vbYesNo) = vbYes Then
                    Call GetDocOptSet("1", strText) 'Added by Lydia 2021/09/07 記錄文件齊備選項
                    Option1(1).Value = True
                    Text1(6) = strCaseNo1
                    Text1(7) = strCaseNo2
                    Text1(8) = StrCaseNo3
                    Text1(9) = strCaseNo4
                    bolNotShow = True
                    Text1_LostFocus (9)
                    'Added by Lydia 2021/09/06 因為直接帶入舊案資料，例如文件齊備選項會被清空
                    Call GetDocOptSet("2", strText) '還原文件齊備選項
                    MsgBox "已依舊案號帶基本資料，請重新檢查填寫的資料！", vbExclamation
                    Screen.MousePointer = vbDefault
                    Exit Function
                    'end 2021/09/06
                End If
            End If
        ElseIf i > 1 Then
            Screen.MousePointer = vbDefault
            strCaseNo1 = "": strCaseNo4 = "": StrCaseNo3 = "": strCaseNo4 = "": strTM28 = ""
            Me.Visible = False
            frm090801_10.Show vbModal
            If strCaseNo1 <> MsgText(601) Then
                If strTM28 = "1" Then
                    'Modify By Sindy 2025/8/20
                    'strMsg = "此號數為本所客戶案件,要繼續收文？"
                    strMsg = Replace(strMsgText, "XXX-XXXXXX", IIf(StrCaseNo3 & strCaseNo4 = "000", strCaseNo1 & "-" & strCaseNo2, strCaseNo1 & "-" & strCaseNo2 & "-" & StrCaseNo3 & "-" & strCaseNo4))
                    '2025/8/20 END
                    If MsgBox(strMsg, vbYesNo) = vbNo Then
                        Exit Function
                    End If
                Else
                    If Text1(129) <> MsgText(601) And Text1(132) <> MsgText(601) Then
                        strMsg = "此「審定號 " & Text1(129) & "」及「申請案號 " & Text1(132) & "」" & vbCrLf
                    ElseIf Text1(129) <> MsgText(601) Then
                        strMsg = "此「審定號 " & Text1(129) & "」"
                    Else
                        strMsg = "此「申請案號 " & Text1(132) & "」"
                    End If
                    strMsg = strMsg & "之本所案號為 " & strCaseNo1 & "-" & strCaseNo2 & "-" & StrCaseNo3 & "-" & strCaseNo4 & _
                            "要改收此舊案？"
                    If MsgBox(strMsg, vbYesNo) = vbYes Then
                        Call GetDocOptSet("1", strText) 'Added by Lydia 2021/09/07 記錄文件齊備選項
                        Me.Visible = True
                        Option1(1).Value = True
                        Text1(6) = strCaseNo1
                        Text1(7) = strCaseNo2
                        Text1(8) = StrCaseNo3
                        Text1(9) = strCaseNo4
                        bolNotShow = True
                        Text1_LostFocus (9)
                        'Added by Lydia 2021/09/06 因為直接帶入舊案資料，例如文件齊備選項會被清空
                        Call GetDocOptSet("2", strText) '還原文件齊備選項
                        MsgBox "已依舊案號帶基本資料，請重新檢查填寫的資料！", vbExclamation
                        Screen.MousePointer = vbDefault
                        Exit Function
                        'end 2021/09/06
                    End If
                End If
            End If
            Me.Visible = True
        End If
        bolNotShow = False
        strCaseNo1 = "": strCaseNo4 = "": StrCaseNo3 = "": strCaseNo4 = "": strTM28 = ""
        Screen.MousePointer = vbHourglass
    'Added by Lydia 2021/09/06 商標新案號加強檢查:參考frm020501商標基本資料維護之CheckDataValid，在2015/6/22 SINDY有增加
    ElseIf Option1(0).Value = True And InStr(Text1(6), "T") > 0 Then
       '以申請案號+申請國家檢查是否有重覆
       If Trim(Text1(132)) <> "" Then
           strSql = "select tm01,tm02,tm03,tm04,tm28 from trademark where tm12='" & ChgSQL(Text1(132)) & "' and tm10='" & Trim(Left(Combo1(0).Text, 4)) & "' order by tm01,tm02,tm03,tm04 "
           intI = 1
           Set RsTemp = ClsLawReadRstMsg(intI, strSql)
           If intI = 1 Then
              If "" & RsTemp.Fields("tm28") <> "1" Then '卷宗性質=非申請
                  'Modify By Sindy 2025/8/20
                  'strMsg = "此號數為本所客戶案件,要繼續收文？"
                  strMsg = Replace(strMsgText, "XXX-XXXXXX", IIf(RsTemp.Fields("tm03") & RsTemp.Fields("tm04") = "000", RsTemp.Fields("tm01") & "-" & RsTemp.Fields("tm02"), RsTemp.Fields("tm01") & "-" & RsTemp.Fields("tm02") & "-" & RsTemp.Fields("tm03") & "-" & RsTemp.Fields("tm04")))
                  '2025/8/20 END
              Else
                  strMsg = " 此「申請案號」之本所案號為" & RsTemp.Fields("tm01") & "-" & RsTemp.Fields("tm02") & "-" & RsTemp.Fields("tm03") & "-" & RsTemp.Fields("tm04") & "要改收此舊案嗎？"
              End If
              If MsgBox(strMsg, vbYesNo + vbInformation + vbDefaultButton1, "商標新案號加強檢查") = vbYes Then
                    Call GetDocOptSet("1", strText) '記錄文件齊備選項
                    Option1(1).Value = True
                    Text1(6) = "" & RsTemp.Fields("tm01")
                    Text1(7) = "" & RsTemp.Fields("tm02")
                    Text1(8) = "" & RsTemp.Fields("tm03")
                    Text1(9) = "" & RsTemp.Fields("tm04")
                    bolNotShow = True
                    Text1_LostFocus (9)
                    '因為直接帶入舊案資料，例如文件齊備選項會被清空
                    Call GetDocOptSet("2", strText) '還原文件齊備選項
                    MsgBox "已依舊案號帶基本資料，請重新檢查填寫的資料！", vbExclamation
                    Screen.MousePointer = vbDefault
                    Exit Function
              End If
           End If
       End If
       '以審定號+申請國家檢查資料庫中相同者且目前准駁(TM16)欄為'1'者是否有重覆
       If Trim(Text1(129)) <> "" Then
           strSql = "select tm01,tm02,tm03,tm04,tm28 from trademark where tm15='" & ChgSQL(Text1(129)) & "'  and tm10='" & Trim(Left(Combo1(0).Text, 4)) & "' and tm16='1' order by tm01,tm02,tm03,tm04 "
           intI = 1
           Set RsTemp = ClsLawReadRstMsg(intI, strSql)
           If intI = 1 Then
              If "" & RsTemp.Fields("tm28") <> "1" Then '卷宗性質=非申請
                  'Modify By Sindy 2025/8/20
                  'strMsg = "此號數為本所客戶案件,要繼續收文？"
                  strMsg = Replace(strMsgText, "XXX-XXXXXX", IIf(RsTemp.Fields("tm03") & RsTemp.Fields("tm04") = "000", RsTemp.Fields("tm01") & "-" & RsTemp.Fields("tm02"), RsTemp.Fields("tm01") & "-" & RsTemp.Fields("tm02") & "-" & RsTemp.Fields("tm03") & "-" & RsTemp.Fields("tm04")))
                  '2025/8/20 END
              Else
                  strMsg = " 此「審定號」之本所案號為" & RsTemp.Fields("tm01") & "-" & RsTemp.Fields("tm02") & "-" & RsTemp.Fields("tm03") & "-" & RsTemp.Fields("tm04") & "要改收此舊案嗎？"
              End If
              If MsgBox(strMsg, vbYesNo + vbInformation + vbDefaultButton1, "商標新案號加強檢查") = vbYes Then
                    Call GetDocOptSet("1", strText) '記錄文件齊備選項
                    Option1(1).Value = True
                    Text1(6) = "" & RsTemp.Fields("tm01")
                    Text1(7) = "" & RsTemp.Fields("tm02")
                    Text1(8) = "" & RsTemp.Fields("tm03")
                    Text1(9) = "" & RsTemp.Fields("tm04")
                    bolNotShow = True
                    Text1_LostFocus (9)
                    '因為直接帶入舊案資料，例如文件齊備選項會被清空
                    Call GetDocOptSet("2", strText) '還原文件齊備選項
                    MsgBox "已依舊案號帶基本資料，請重新檢查填寫的資料！", vbExclamation
                    Screen.MousePointer = vbDefault
                    Exit Function
              End If
           End If
       End If
    'end 2021/09/07
    End If
    'end 2016/09/01
    strMsgText = ""
'2025/8/20 END

    'Added by Lydia 2020/12/15 CFT緬甸重新申請案
    'Memo by Lydia 2022/03/29 不知道何時這段程式遺失, 從備份Code還原
    If Option1(0).Value = True And Text1(6).Text = "CFT" And Trim(Text1(7) & Text1(8) & Text1(9)) = "" And Trim(Left(Combo1(0).Text, 4)) = "048" _
       And InStr(m_strCaseCPM, "101") > 0 Then
      'CFT緬甸新「申請」案，若該客戶有CFT緬甸案且申請日<20210101且有審定號者，在列印接洽單前詢問「是否有相關緬甸商標註冊案」
      '智權可選擇「是」或「否」，如選擇「是」，若該客戶只有一筆符合條件的舊案則直接帶出該案號；若有多筆則開畫面讓智權人員選擇。
      Call frm090801_10.SetParent(Me, "2")
      strCaseNo1 = "": strCaseNo4 = "": StrCaseNo3 = "": strCaseNo4 = ""
      i = frm090801_10.GetDataMode2(Text1(12).Text, strCaseNo1, strCaseNo2, StrCaseNo3, strCaseNo4)
      If i > 0 Then
         If MsgBox("是否有相關緬甸商標註冊案？", vbYesNo + vbInformation + vbDefaultButton1, "CFT緬甸重新申請案") = vbYes Then
              If i > 1 Then
                   Me.Visible = False
                   frm090801_10.Show vbModal
                   Me.Visible = True
              End If
              If strCaseNo1 = "" Or strCaseNo2 = "" Or StrCaseNo3 = "" Or strCaseNo4 = "" Then
                 MsgBox "未選取資料！", vbCritical, "CFT緬甸重新申請案"
                 Screen.MousePointer = vbDefault
                 Exit Function
              End If
         Else
             strCaseNo1 = "": strCaseNo4 = "": StrCaseNo3 = "": strCaseNo4 = ""
         End If
      End If
    End If
    'end 2020/12/15
    
    'Added by Lydia 2021/03/05 CFT歐盟尚未註冊案轉換英國申請案收文控管：針對2021.9.30前收文之英國新「申請101」案建立關聯案
    If strCaseNA239new = "" And strSrvDate(1) <= "20210930" And Option1(0).Value = True And Text1(6).Text = "CFT" And Trim(Text1(7) & Text1(8) & Text1(9)) = "" And Trim(Left(Combo1(0).Text, 4)) = "201" _
            And InStr(m_strCaseCPM, "101") > 0 Then
JumpToReInput:
            strExc(0) = ""
            strExc(0) = InputBox("若有相關本所歐盟商標申請/註冊案，" & vbCrLf & "請在下方輸入本所案號，並且按下〔確定〕：" & vbCrLf & "ex.CFT012345" & vbCrLf & vbCrLf & "若無相關案號請點選〔取消〕", "CFT歐盟尚未註冊案轉換英國申請案")
            If Trim(strExc(0)) <> "" Then
                If Len(strExc(0)) < 9 Then
                    If MsgBox("本所案號〔" & strExc(0) & "〕輸入錯誤，是否重新輸入本所歐盟案案號？", vbCritical + vbYesNo + vbDefaultButton1) = vbYes Then
                        GoTo JumpToReInput
                    Else
                        GoTo JumpToEndInput
                    End If
                Else
                    strExc(0) = UCase(Replace(strExc(0), "-", ""))
                    Call ChgCaseNo(strExc(0), strExc)
                    If Len(strExc(2)) <> 6 Then
                        If MsgBox("本所案〔" & strExc(0) & "〕號輸入錯誤，是否重新輸入本所歐盟案案號？", vbCritical + vbYesNo + vbDefaultButton1, "CFT歐盟尚未註冊案轉換英國申請案") = vbYes Then
                            GoTo JumpToReInput
                        Else
                            GoTo JumpToEndInput
                        End If
                    Else
                        'Modifed by Lydia 2021/03/11 改條件：符合「歐盟商標申請日為2021.1.1前」及「2021.1.1前歐盟商標無發證日」
                        'strSql = "Select Tm01,Tm02,Tm03,Tm04 From Trademark Where Tm01='CFT' And Tm10='239' And Tm11 < 20210101 and (tm13 is null or tm13 >=20210101) " & _
                                    "and tm01='" & strExc(1) & "' and tm02='" & strExc(2) & "' and tm03='" & strExc(3) & "' and tm04='" & strExc(4) & "' and  tm30||tm57 is null "
                        strSql = "Select Tm01,Tm02,Tm03,Tm04 From Trademark Where Tm01='CFT' And Tm10='239' And Tm11 < 20210101 and (tm20 is null or tm20 >=20210101) " & _
                                    "and tm01='" & strExc(1) & "' and tm02='" & strExc(2) & "' and tm03='" & strExc(3) & "' and tm04='" & strExc(4) & "' and  tm30||tm57 is null "
                        intI = 1
                        Set RsTemp = ClsLawReadRstMsg(intI, strSql)
                        If intI = 0 Then
                            If MsgBox("本所案號〔" & strExc(1) & strExc(2) & strExc(3) & strExc(4) & "〕非2021.1.1前歐盟商標尚未獲准註冊案，是否重新輸入本所歐盟案案號？", vbCritical + vbYesNo + vbDefaultButton1, "CFT歐盟尚未註冊案轉換英國申請案") = vbYes Then
                                GoTo JumpToReInput
                            Else
                                GoTo JumpToEndInput
                            End If
                        End If
                    End If
                    strCaseNA239new = strExc(1) & strExc(2) & strExc(3) & strExc(4)
                End If
            ElseIf StrPtr(strExc(0)) <> 0 Then 'StrPtr判斷是否user按下取消，數值為0。
                    GoTo JumpToReInput
            End If
JumpToEndInput:
    End If
    'end 2021/03/05
    
    CheckDataYN1 = True
End Function

'彈訊息提醒可繼續執行
Private Sub CheckShowMsg1()
    Dim strAnoPA() As String 'Add By Sindy 2014/7/8
    Dim strMemo As String 'Added by Morgan 2015/12/18
    Dim strMsg As String 'Add by Amy 2016/07/07
    Dim ii As Integer, bolTMdebate8000 As Boolean
    
    Call MsgDiscSet 'Add by Lydia 2014/12/25 台灣P案未設定減免身份提示訊息
    
    'Add By Sindy 2010/4/22
    If Trim(Text1(6)) = "P" Or Trim(Text1(6)) = "CFP" Then
        'Added by Morgan 2015/12/4
        If Trim(Text1(6)) = "P" And Left(Trim(Combo1(0).Text), 3) = "000" Then
            '台灣舉發目前尚不能電子送件,故填寫接洽單時,不要自動設定電子送件--郭雅娟
            If Check4.Value = vbChecked Then
                'Modify by Amy 2016/06/24 +804/501/503 (不要自動設定電子送件也要確認 Trigger-CASEPROGRESS_AFTER1是否改)
                If InStr(m_strCaseCPM, "803") > 0 Or _
                    InStr(m_strCaseCPM, "804") > 0 Or _
                    InStr(m_strCaseCPM, "501") > 0 Or _
                    InStr(m_strCaseCPM, "503") > 0 Then
                    'Modify by Amy 2016/07/07
                    strMsg = ""
                    Check4.Value = vbUnchecked
                    If InStr(m_strCaseCPM, "803") > 0 Then
                      strMsg = strMsg & "/" & GetCasePropertyName(Text1(6), "803", "CPM03")
                    End If
                    If InStr(m_strCaseCPM, "804") > 0 Then
                      strMsg = strMsg & "/" & GetCasePropertyName(Text1(6), "804", "CPM03")
                    End If
                    If InStr(m_strCaseCPM, "501") > 0 Then
                      strMsg = strMsg & "/" & GetCasePropertyName(Text1(6), "501", "CPM03")
                    End If
                    If InStr(m_strCaseCPM, "503") > 0 Then
                      strMsg = strMsg & "/" & GetCasePropertyName(Text1(6), "503", "CPM03")
                    End If
                    MsgBox "台灣 " & Mid(strMsg, 2) & " 目前尚不能電子送件，該勾選已清除！", vbInformation
                    'end 2016/07/07
                End If
            End If

            'Modified by Morgan 2015/12/18
            '台灣收文領證時,若有多國案且新申請程序尚未發文時,請顯示訊息"本案有多國案(本所案號(可能多筆))尚未發文, 請注意！"--杜燕文
            If Option1(1).Value = True Then
                If InStr(m_strCaseCPM, "601") > 0 Then
                
                    strExc(2) = PUB_GetRefCaseMapSQL(pa)
                    strExc(0) = "SELECT CP01||'-'||CP02||decode(CP03||CP04,'000','','-'||CP03||'-'||CP04)||' ('||na03||'-'||decode(pa09,'000',ptm03,decode(pa01,'CFP',ptm03,ptm04))||')'" & _
                        " FROM CASEPROGRESS C1,patent,nation,PATENTTRADEMARKMAP WHERE (CP01,CP02,CP03,CP04) IN (" & strExc(2) & ") AND CP01<>'FCP'" & _
                        " AND CP10 IN (" & SameCaseProperty4Update & ") AND CP27||CP57 IS NULL" & _
                        " AND NOT EXISTS(SELECT * FROM patent WHERE PA01=C1.CP01 AND PA02=C1.CP02 AND PA03=C1.CP03 AND PA04=C1.CP04 AND PA46='Y')" & _
                        " AND NOT EXISTS(SELECT * FROM CASEPROGRESS C2 WHERE C2.CP01=C1.CP01 AND C2.CP02=C1.CP02 AND C2.CP03=C1.CP03 AND C2.CP04=C1.CP04 AND C2.CP10='106' AND C2.CP57 IS NULL)" & _
                        " and pa01(+)=cp01 and pa02(+)=cp02 and pa03(+)=cp03 and pa04(+)=cp04 and na01(+)=pa09 and ptm01(+)='1' and ptm02(+)=pa08 order by pa01,pa09,pa08"
                    intI = 1
                    Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
                    If intI = 1 Then
                        RsTemp.MoveFirst
                        strExc(1) = RsTemp.GetString
                        strMemo = "本案有下列多國案尚未發文，請注意！" & vbCrLf & strExc(1)
                        MsgBox strMemo, vbExclamation
                    End If
                End If
                'end 2015/12/18
            End If
        End If
        'end 2015/12/4
    End If
    'end 2010/4/22
    
    'Add By Sindy 2014/7/8 P案舊案且案件性質有701.讓與或708.專利權讓與時,檢查是否一案兩請
    If Text1(6) = "P" And Option1(1).Value = True Then
        'Modify By Sindy 2022/11/14 一案兩請需同一申請人控管-新增控管案件性質401變更
        If InStr(m_strCaseCPM, "701") > 0 Or _
           InStr(m_strCaseCPM, "708") > 0 Or _
           InStr(m_strCaseCPM, "401") > 0 Then
            ReDim Preserve pa(1 To TF_PA) As String
            ReDim Preserve strAnoPA(1 To TF_PA) As String
            pa(1) = Text1(6)
            pa(2) = Text1(7)
            pa(3) = Text1(8)
            pa(4) = Text1(9)
            If PUB_IsDualApplyCom(pa, strAnoPA) = True Then
               'Modify By Sindy 2022/11/14
               If InStr(m_strCaseCPM, "401") > 0 Then
                  MsgBox "本案為一案兩請案件，欲辦理變更申請人名稱須發明及新型兩案同時辦理！", vbExclamation + vbOKOnly
               Else
               '2022/11/14 END
                  MsgBox "本案為一案兩請案件，欲辦理讓與須發明及新型兩案同時辦理！", vbExclamation + vbOKOnly
               End If
            End If
        End If
    End If
    '2014/7/8 END
    
    If IsSpecCu Then
'         MsgBox "此客戶接洽單需經過主管核示！！", vbInformation, "特殊客戶！"
         'Add By Sindy 2022/9/14
         m_Msgbox = SpecCUName & "此為特殊客戶，特殊原因為：" & SpecMemo
         If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
            txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
         End If
         '2022/9/14 END
    End If
    
   'Added by Morgan 2020/2/13
   '收文442在途期間提醒
   If Option1(1).Value = True And Trim(Text1(6).Text) = "P" And InStr(m_strCaseCPM, "442") > 0 Then
      m_Msgbox = "收文【" & GetPrjState4(Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9), "442") & "】須報請簽核主管"
'      MsgBox m_Msgbox & "核可！", vbExclamation
      'Add By Sindy 2022/9/14
      If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
         txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
      End If
      '2022/9/14 END
   End If
   'end 2020/2/13
    
    'Modify by Amy 2018/03/19 +新案收701(讓與) 時,彈訊息
    If Option1(0).Value = True And Text1(6) = "P" _
        And (InStr(m_strCaseCPM, "701") > 0) Then
        MsgBox "若本案已有專利號數,請改收708(專利權讓與)！"
    End If
    'end 2018/03/19
    
    'Modify By Sindy 2015/7/27 改在按下列印鍵之前先提醒
'    'add by nickc 2008/01/18 加入客戶業務備註
'    If IsCuMemo Then
'        MsgBox CuMemoName & "此客戶有業務備註！！", vbInformation, "業務備註！"
'    End If

    'Add By Sindy 2012/5/8 台灣商標Ｔ案收文爭議案件性質
    'Modify By Sindy 2024/4/29 案源不須檢查 + And strLSourceType = ""
    If Frame21.Visible = True And strLSourceType = "" Then
        '列印時檢查若本所期限在7個日曆天內將到期或急件，要會稿且費用<8000元者，彈訊息但仍可繼續列印
        If Frame23.Visible = True Then 'Added by Lydia 2018/12/10 判斷會稿才繼續
            'Modify By Sindy 2025/4/14 mark:Or OptCP122(0).Value = True
            If ((Val(DBDATE(Text1(3))) > 0 And Val(DBDATE(Text1(3))) <= Val(CompDate(2, 7, strSrvDate(1))))) And _
                OptEP34(0).Value = True Then
'                And ( _
'                (InStr(TMdebate, Trim(Left(Trim(Combo1(1)), 4))) > 0 And Trim(Left(Trim(Combo1(1)), 4)) <> "" And Val(Text1(101)) < 8000) Or _
'                (InStr(TMdebate, Trim(Left(Trim(Combo1(2)), 4))) > 0 And Trim(Left(Trim(Combo1(2)), 4)) <> "" And Val(Text1(104)) < 8000) Or _
'                (InStr(TMdebate, Trim(Left(Trim(Combo1(3)), 4))) > 0 And Trim(Left(Trim(Combo1(3)), 4)) <> "" And Val(Text1(107)) < 8000) Or _
'                (InStr(TMdebate, Trim(Left(Trim(Combo1(4)), 4))) > 0 And Trim(Left(Trim(Combo1(4)), 4)) <> "" And Val(Text1(110)) < 8000) _
'                )
               For ii = 1 To GridCase.Rows - 1
                  'Modify By Sindy 2025/7/30 FCT案727分析不屬於爭議案 + FCT_NotTMdebate
                  If InStr(TMdebate, Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4))) > 0 And _
                     Not (Text1(6) = "FCT" And InStr(FCT_NotTMdebate, Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4))) > 0) And _
                     Val(Format(Trim(GridCase.TextMatrix(ii, 2)), "###0")) < 8000 Then
                     bolTMdebate8000 = True
                     Exit For
                  End If
               Next ii
               If bolTMdebate8000 = True Then
                  If OptCRL133(1).Value = True Then  'Added by Lydia 2019/07/02 判斷可以延期案件不用彈訊息
                     m_Msgbox = "本所期限在7天內或急件且收費低於8,000元且要會稿，此為特殊案件"
'                     MsgBox m_Msgbox & "須報請主管核可！"
                     'Add By Sindy 2022/9/14
                     If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
                        txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
                     End If
                     '2022/9/14 END
                  End If
               End If
            End If
        Else
        End If
        'end 2018/12/10
    End If
    '2012/5/8 End
'    If strMemo <> "" Then Text1(119) = Text1(119) & vbCrLf & strMemo 'Added by Morgan 2015/12/18
    'Modify By Sindy 2022/9/14
    If strMemo <> "" Then
      If InStr(txtCRL70.Text, strMemo) = 0 Then
         txtCRL70.Text = txtCRL70.Text & strMemo & vbCrLf
      End If
    End If
    '2022/9/14 END
      
    'Added by Lydia 2016/08/30 CFP控制年費.延展費及維持費智權同仁可加的點數
    If Option1(1).Value = True And Text1(6) = "CFP" And Text1(7) <> "" Then
       Call CheckCFP605to607
    End If
    'end 2016/08/30
   
   'Add By Sindy 2025/8/15 行政訴訟案件(案件性質:403行政訴訟、407參加訴訟)，
   '   智權人員填寫接洽單收文時，管控：後續補充理由為：A類收文或B類收文。
   m_strCRC14 = "" '指定下一收文總收文號的類別 Add By Sindy 2025/8/15
   If Text1(6) = "T" And Trim(Left(Combo1(0).Text, 4)) = "000" And _
      (InStr(m_strCaseCPM, "403") > 0 Or InStr(m_strCaseCPM, "407") > 0) Then
ReInput:
      m_strCRC14 = UCase(InputBox("行政訴訟案件(403行政訴訟、407參加訴訟)，請輸入後續補充理由收文方式：A類收文  B類收文。" & vbCrLf & vbCrLf & _
                          "(請 A 或 B 擇一輸入)"))
      If m_strCRC14 = "" Then
         GoTo ReInput
      ElseIf m_strCRC14 <> "A" And m_strCRC14 <> "B" Then
         GoTo ReInput
      Else
         txtCRL70.Text = txtCRL70.Text & "行政訴訟案件，若有後續補充理由為" & m_strCRC14 & "類收文。" & vbCrLf
      End If
   End If
   '2025/8/15 END
End Sub
'end 2016/06/24

'Modify by Morgan 2011/3/28 +pbolPreserve
Private Sub ClearAll(Optional pbolPreserve As Boolean = False)
Dim objText As Object
Dim objChk As Object
Dim objCbo As Object
Dim objOpt As Object
Dim objLbl As Object 'Add By Sindy 2023/1/18

'Add By Sindy 2024/9/24 預設值
Label1(123).Caption = "請先點選接洽單種類"
If Left(Pub_StrUserSt03, 1) = "F" Or _
   Left(Pub_StrUserSt03, 1) = "L" Or _
   Left(Pub_StrUserSt03, 2) = "P1" Or _
   Left(Pub_StrUserSt03, 2) = "P2" Or _
   Left(Pub_StrUserSt03, 3) = "M51" Then
   Label1(123).Visible = True 'Add by Morgan 2011/1/13
Else
   Label1(123).Visible = False 'Add by Morgan 2011/1/13
End If
'2024/9/24 END

For Each objText In Me.Text1
    If objText.Index <> 0 And objText.Index <> 10 Then
         If Not (pbolPreserve = True And (objText.Index = 6 Or objText.Index = 7 Or objText.Index = 8 Or objText.Index = 9)) Then 'Add by Morgan 2011/3/28 考慮輸多張接洽單只有改案號情形
            objText.Text = ""
            objText.Tag = "" 'Add By Sindy 2014/9/25
         End If
    End If
Next
Text1(1).Enabled = True 'Add By Sindy 2014/12/10
Text1(3).Enabled = True 'Add By Sindy 2014/12/10
m_strSaveFiles = "": m_strSaveFiles2 = "" 'Add By Sindy 2015/1/7
Me.cmdAddAtt.BackColor = &H808080 '灰色 Add By Sindy 2022/9/30
ClearAddrVar 0 'Add by Amy 2016/06/06
Frame57.Visible = False 'Add By Sindy 2022/10/4

If pbolPreserve = False Then 'Add by Morgan 2011/3/28 考慮輸多張接洽單只有改案號情形
   For Each objOpt In Me.Option1
       objOpt.Value = False
   Next
End If

For Each objOpt In Me.Option2
    objOpt.Value = False
Next

'是否新客戶
For Each objOpt In Me.Option31
    objOpt.Value = False
Next
For Each objOpt In Me.Option32
    objOpt.Value = False
Next
For Each objOpt In Me.Option33
    objOpt.Value = False
Next
For Each objOpt In Me.Option34
    objOpt.Value = False
Next
For Each objOpt In Me.Option35
    objOpt.Value = False
Next

'Add By Sindy 2025/1/13
ChkPCT.Value = 0
ChkPCT.Enabled = True
'2025/1/13 END

'Modify By Sindy 2024/1/22 秀玲(mail:2024/1/19)改為不預設任何選項
'Me.OptSendType(1).Value = True 'Add By Sindy 2010/11/22
For Each objOpt In Me.OptSendType
    objOpt.Value = False
Next
For Each objOpt In Me.OptCP164
    objOpt.Value = False
Next
'2024/1/22 END

'Add By Sindy 2010/11/2
Me.PicText.Text = ""
For Each objOpt In Me.optCP811
    objOpt.Value = False
Next
For Each objOpt In Me.optCP812
    objOpt.Value = False
Next
For Each objOpt In Me.optCP813
    objOpt.Value = False
Next
For Each objOpt In Me.optCP814
    objOpt.Value = False
Next
For Each objOpt In Me.optCP815
    objOpt.Value = False
Next
For Each objOpt In Me.optColor
    objOpt.Value = False
Next
'Added by Lydia 2019/11/05
For Each objOpt In Me.Opt45
    objOpt.Value = False
Next

Me.ChkPCT.Value = vbUnchecked
Me.Check1.Value = vbUnchecked
Me.Check2.Value = vbUnchecked
For Each objChk In Me.Check7
    objChk.Value = vbUnchecked
Next

'Add By Sindy 2022/9/15
For Each objChk In Me.ChkCRA26
    objChk.Value = vbUnchecked
    objChk.Enabled = True
Next
For Each objChk In Me.ChkCRA27
    objChk.Value = vbUnchecked
    objChk.Enabled = True
Next
ChkCRL66.Value = vbUnchecked
ChkCRL66.BackColor = &H8000000F '灰色
'Add By Sindy 2022/11/4 急件
Check11.Value = vbUnchecked
Check11.BackColor = &H8000000F '灰色
'Add By Sindy 2022/12/13 費用已核准
Check12.Value = vbUnchecked
Check12.BackColor = &H8000000F '灰色
ChkCRL152.Value = vbUnchecked 'Add By Sindy 2023/4/7
Me.Check10.Value = 0 'Add By Sindy 2025/4/14

Me.cboTitle.Text = ""
Me.Combo4.ListIndex = 0
Me.Combo4.Tag = "" 'Add by Amy 2015/10/22
Me.Combo5.Text = ""
For Each objCbo In Me.cboContact
    objCbo.Text = ""
Next
For Each objOpt In Me.opt1
    objOpt.Value = False
Next
'2010/11/2 End

Me.Combo6.Text = "" 'Add By Sindy 2012/4/26
Me.Combo5.Text = "" 'Add By Sindy 2014/7/15

'Add By Sindy 2011/6/7
Text1(127).Text = ""
For Each objChk In Me.Check3
    objChk.Value = vbUnchecked
Next
'2011/6/7 End

For Each objOpt In Me.Option4
    objOpt.Value = False
Next
For Each objOpt In Me.Option5
    objOpt.Value = False
Next
For Each objChk In Me.Check6
    objChk.Value = vbUnchecked
Next

'申請國/案件性質
'Add By Sindy 2022/8/29
LblCnt.Caption = ""
GridCase.Clear: LblCnt.Caption = "": Call SetGrd
FrameCRC.Caption = "案件性質編輯區（" & Val(GridCase.Rows - 1) - IIf(Trim(GridCase.TextMatrix(1, 1)) = "", 1, 0) & "）"
'2022/8/29 END
For Each objCbo In Me.Combo1
    objCbo.Tag = ""  '2011/9/20 add by sonia
    objCbo.Text = ""
    If objCbo.Index <> 0 Then
        objCbo.Clear
    End If
Next
'案件性質備註
For Each objCbo In Me.Combo2
    objCbo.Text = ""
Next

'2010/3/4 add by sonia
If pbolPreserve = False Then 'Add by Morgan 2011/3/28 考慮輸多張接洽單只有改案號情形
   Me.Option1(0).Value = True
End If
Me.Option31(1).Value = True
Me.Option32(1).Value = True
Me.Option33(1).Value = True
Me.Option34(1).Value = True
Me.Option35(1).Value = True
'2010/3/4 end

'2008/8/25 add for Toni use in 發明人
For Each objText In Text2
   objText.Text = ""
Next
For Each objText In Text3
   objText.Text = ""
Next
For Each objCbo In Me.Combo3
   objCbo.Text = ""
Next
For Each objText In Text4
   objText.Text = ""
   objText.Tag = ""
Next
For Each objChk In Me.ChkAddress
   objChk.Value = vbUnchecked
Next
'Add By Sindy 2023/1/18
For Each objLbl In Label5
   objLbl.Tag = ""
Next
'2023/1/18 END

m_Note1 = "": m_Note2 = "" 'Add By Sindy 2010/4/23
m_strGetNP01 = "" 'Add By Sindy 2015/9/17
Text1(142).Text = "": Text1(143).Text = "" 'strYF05From = "": strYF05To = "" 'Add By Sindy 2010/7/9

Me.SSTab1.Tab = 0
Me.SSTab2.Tab = 0
'Modified by Morgan 2020/5/7
'Me.Text1(119).Text = "如案件內容摘要、引用條文與客戶洽談要旨等等......" & vbCrLf & _
'                                    "商品類別：" & vbCrLf & _
'                                    "商品名稱：" & vbCrLf & _
'                                    "註冊號數：" & vbCrLf & _
'                                    "優先權日：" & vbCrLf & _
'                                    "優先權號：" & vbCrLf
''Add By Sindy 2010/5/27
'If OptChoose(1).Value = True Then
'   Me.Text1(119).Text = Me.Text1(119).Text & "聯絡人：" & vbCrLf & _
'                                                                           "彼所案號：" & vbCrLf
'End If
SrcSetMemo OptChoose(1).Value
'end 2020/5/7

'發明人暫存資料清除  20080902 add by Toni
strInventorNo = ""
strPetition = ""
strInventorName = "" 'Add By Sindy 2011/1/31 +strInventorName
m_CRL02 = "" 'Add By Sindy 2011/10/18
'Modify By Sindy 2012/6/11 Mark
''Add By Sindy 2012/5/30
'Text1(10) = strUserNum
'lblStaffName.Caption = strUserName
''2012/5/30 End

'Add By Sindy 2012/11/12
'Modified by Morgan 2013/11/26
'For Each objOpt In Me.Check8
'    objOpt.Value = 0
For Each objChk In Me.Check8
   objChk.Value = vbUnchecked
'end 2013/11/26
Next
'2012/11/12 End
'Add by Amy 2017/01/20
For Each objText In Me.TxtC1
   objText.Text = ""
Next
ClearAddrVar (3) 'Add by Amy 2017/07/12

m_LAmsg = "" 'Added by Lydia 2019/04/10

'Me.Combo7.Text = "" 'Added by Lydia 2019/08/06

'Added by Lydia 2020/11/19
strCaseNA239 = ""
bolCase201 = False
strCaseNA239 = "" 'Added by Lydia 2021/03/05
strGetNp15 = "" 'Added by Lydia 2021/04/15

strCaseNo1 = "": strCaseNo4 = "": StrCaseNo3 = "": strCaseNo4 = "": strTM28 = "" 'Added by Lydia 2020/12/15

'Added by Lydia 2021/02/24
Frame47.Visible = False
Text7.Text = ""

'Added by Lydia 2021/03/29 開放編輯
If strSrvDate(1) >= strACSdate1 Then
    Combo4.Enabled = True
'    For intI = 1 To 4
'        Text1(102 + (intI - 1) * 3).Enabled = True
'        Text1(103 + (intI - 1) * 3).Enabled = True
'    Next intI
    Text1(102).Enabled = True
    Text1(103).Enabled = True
End If

m_ACS112msg = "" 'Added by Lydia 2021/05/07

'Added by Lydia 2023/11/13 DEBIT NOTE請款選項
optDB(0).Value = 0: optDB(1).Value = 0
Check7(2).Value = 0: Check7(3).Value = 0
Frame33(1).BackColor = &H8000000F
Frame33(1).Visible = False
'end 2023/11/13

strOldCRL70 = "" 'Added by Lydia 2025/02/18
End Sub

Private Function GetCopies(strStaffNo As String) As Integer
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset

StrSQLa = "Select ST06 From Staff Where ST01='" & strStaffNo & "'"
rsA.CursorLocation = adUseClient
rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
If rsA.RecordCount > 0 Then
    If "" & rsA.Fields(0).Value = "1" Then
        GetCopies = 2
    Else
        GetCopies = 3
    End If
Else
    GetCopies = 0
End If
If rsA.State <> adStateClosed Then rsA.Close
Set rsA = Nothing
End Function

'Modify By Sindy 2023/7/31 + , Optional ByVal intAppl As Integer = 0
'Modify By Sindy 2023/8/17 + 僅控制申請人資料欄位: Optional ByVal bolOnlyConrolAppl As Boolean = False
Private Sub txtEnabled1(blnTF As Boolean, Optional ByVal intAppl As Integer = 0, _
   Optional ByVal bolOnlyConrolAppl As Boolean = False)
Dim ii As Integer
Dim intRow As Integer
   
   If m_blnCallPrint = True Then Exit Sub
   
   'Add By Sindy 2023/8/17
   If bolOnlyConrolAppl = False Then
   '2023/8/17 END
      Me.Combo1(0).Enabled = blnTF
      'Modify By Sindy 2011/6/7
      If Text1(6) = "LA" Then
         Me.Text1(11).Enabled = True
      Else
      '2011/6/7 End
         Me.Text1(11).Enabled = blnTF
      End If
      Me.Combo5.Enabled = blnTF 'Add By Sindy 2010/10/28
      Me.Combo6.Enabled = blnTF 'Add By Sindy 2012/4/26
      
      'Add By Sindy 2010/11/22
      Text1(1).Enabled = True
      Text1(3).Enabled = True
      '2010/11/22 End
      
   '    'Add By Sindy 2010/5/27
   '    If optChoose(1).Value = True Then
   '       Me.Text1(5).Enabled = blnTF
   '       Me.Text1(130).Enabled = blnTF
   '    End If
   '    '2010/5/27 End
   End If
   
   'Modify By Sindy 2023/7/31
   intRow = IIf(intAppl = 0, 1, intAppl)
   For ii = intRow To IIf(intAppl = 0, 5, intAppl)
   'For ii = 1 To 5
   '2023/7/31 END
      Me.Text1(12 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(13 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(14 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(15 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(16 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(17 + (ii - 1) * 16).Enabled = blnTF
   
      Me.Text1(19 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(20 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(21 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(22 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(23 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(24 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(25 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(26 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(27 + (ii - 1) * 16).Enabled = blnTF
      
      Me.Text1(92 + (ii - 1)).Enabled = blnTF
      'Add by Amy 2016/01/04
      Me.Text1(120 + ii).Enabled = blnTF
      
      'Add By Sindy 2010/5/27
      If OptChoose(1).Value = True Then
          Me.Text1(34 + (ii - 1) * 16).Enabled = blnTF
          'Modify By Sindy 2023/2/7 國內接洽單也請顯示英文地址欄
          'Me.Text1(125 + (ii - 1) * 16).Enabled = blnTF
      End If
      '2010/5/27 End
      Me.Text1(125 + (ii - 1) * 16).Enabled = blnTF 'Modify By Sindy 2023/2/7 國內接洽單也請顯示英文地址欄
      Me.cmdSerach(ii - 1).Enabled = blnTF
   Next ii
End Sub

Private Sub txtEnabled2(blnTF As Boolean, ii As Integer)
      If m_blnCallPrint = True Then Exit Sub
      Select Case ii
      Case 1
            Frame30(0).Enabled = blnTF 'Add By Sindy 2022/11/9
            If Me.Option31(0).Value = True Then
                Me.Text1(12 + (ii - 1) * 16).Enabled = True
                Me.Text1(21 + (ii - 1) * 16).Enabled = True
                Me.Text1(22 + (ii - 1) * 16).Enabled = True
                Me.cboContact(ii).Enabled = True              '2008/9/4  add by sonia
                Me.cmdSerach(ii - 1).Enabled = True
                'Add by Amy 2015/11/02 +顯示同上鈕
                CmdSame(ii).Visible = True
                Me.Text1(27 + (ii - 1) * 16).Width = 5730 '5700
                Me.Text1(27 + (ii - 1) * 16).Left = 1580
            Else
                CmdSame(ii).Visible = False
                Me.Text1(27 + (ii - 1) * 16).Width = 6300
                Me.Text1(27 + (ii - 1) * 16).Left = 1005
                'end 2015/11/02
                ChkCRA26(0).Value = 0 'Add By Sindy 2022/11/9
                ChkCRA27(0).Value = 0 'Add By Sindy 2022/11/9
            End If
      Case 2
            Frame30(1).Enabled = blnTF 'Add By Sindy 2022/11/9
            If Me.Option32(0).Value = True Then
                Me.Text1(12 + (ii - 1) * 16).Enabled = True
                Me.Text1(21 + (ii - 1) * 16).Enabled = True
                Me.Text1(22 + (ii - 1) * 16).Enabled = True
                Me.cboContact(ii).Enabled = True              '2008/9/4  add by sonia
                Me.cmdSerach(ii - 1).Enabled = True
                'Add by Amy 2015/11/02 +顯示同上鈕
                CmdSame(ii).Visible = True
                Me.Text1(27 + (ii - 1) * 16).Width = 5680 '5650
                Me.Text1(27 + (ii - 1) * 16).Left = 1610
            Else
                CmdSame(ii).Visible = False
                Me.Text1(27 + (ii - 1) * 16).Width = 6255
                Me.Text1(27 + (ii - 1) * 16).Left = 1030
                'end 2015/11/02
                ChkCRA26(1).Value = 0 'Add By Sindy 2022/11/9
                ChkCRA27(1).Value = 0 'Add By Sindy 2022/11/9
            End If
      Case 3
            Frame30(2).Enabled = blnTF 'Add By Sindy 2022/11/9
            If Me.Option33(0).Value = True Then
                Me.Text1(12 + (ii - 1) * 16).Enabled = True
                Me.Text1(21 + (ii - 1) * 16).Enabled = True
                Me.Text1(22 + (ii - 1) * 16).Enabled = True
                Me.cboContact(ii).Enabled = True              '2008/9/4  add by sonia
                Me.cmdSerach(ii - 1).Enabled = True
                'Add by Amy 2015/11/02 +顯示同上鈕
                CmdSame(ii).Visible = True
                Me.Text1(27 + (ii - 1) * 16).Width = 5735
                Me.Text1(27 + (ii - 1) * 16).Left = 1555
             Else
                CmdSame(ii).Visible = False
                Me.Text1(27 + (ii - 1) * 16).Width = 6285
                Me.Text1(27 + (ii - 1) * 16).Left = 1005
                'end 2015/11/02
                ChkCRA26(2).Value = 0 'Add By Sindy 2022/11/9
                ChkCRA27(2).Value = 0 'Add By Sindy 2022/11/9
            End If
      Case 4
            Frame30(3).Enabled = blnTF 'Add By Sindy 2022/11/9
            If Me.Option34(0).Value = True Then
                Me.Text1(12 + (ii - 1) * 16).Enabled = True
                Me.Text1(21 + (ii - 1) * 16).Enabled = True
                Me.Text1(22 + (ii - 1) * 16).Enabled = True
                Me.cboContact(ii).Enabled = True              '2008/9/4  add by sonia
                Me.cmdSerach(ii - 1).Enabled = True
                'Add by Amy 2015/11/02 +顯示同上鈕
                CmdSame(ii).Visible = True
                Me.Text1(27 + (ii - 1) * 16).Width = 5740
                Me.Text1(27 + (ii - 1) * 16).Left = 1510
             Else
                CmdSame(ii).Visible = False
                Me.Text1(27 + (ii - 1) * 16).Width = 6285
                Me.Text1(27 + (ii - 1) * 16).Left = 975
                'end 2015/11/02
                ChkCRA26(3).Value = 0 'Add By Sindy 2022/11/9
                ChkCRA27(3).Value = 0 'Add By Sindy 2022/11/9
            End If
      Case 5
            Frame30(4).Enabled = blnTF 'Add By Sindy 2022/11/9
            If Me.Option35(0).Value = True Then
                Me.Text1(12 + (ii - 1) * 16).Enabled = True
                Me.Text1(21 + (ii - 1) * 16).Enabled = True
                Me.Text1(22 + (ii - 1) * 16).Enabled = True
                Me.cboContact(ii).Enabled = True              '2008/9/4  add by sonia
                Me.cmdSerach(ii - 1).Enabled = True
                'Add by Amy 2015/11/02 +顯示同上鈕
                CmdSame(ii).Visible = True
                Me.Text1(27 + (ii - 1) * 16).Width = 5750
                Me.Text1(27 + (ii - 1) * 16).Left = 1550
             Else
                CmdSame(ii).Visible = False
                Me.Text1(27 + (ii - 1) * 16).Width = 6285
                Me.Text1(27 + (ii - 1) * 16).Left = 1005
                'end 2015/11/02
                ChkCRA26(4).Value = 0 'Add By Sindy 2022/11/9
                ChkCRA27(4).Value = 0 'Add By Sindy 2022/11/9
            End If
      Case Else
      End Select
      Me.Text1(13 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(14 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(15 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(16 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(17 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(19 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(20 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(22 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(23 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(24 + (ii - 1) * 16).Enabled = blnTF
      'Modify by Amy 2016/01/04 有值鎖住
      If blnTF = False Then
        If Me.Text1(25 + (ii - 1) * 16) <> MsgText(601) Then Me.Text1(25 + (ii - 1) * 16).Enabled = blnTF: Me.cmdSearchZip(ii * 2 - 2).Enabled = blnTF
      Else
        Me.Text1(25 + (ii - 1) * 16).Enabled = blnTF: Me.cmdSearchZip(ii * 2 - 2).Enabled = blnTF
      End If
      Me.Text1(26 + (ii - 1) * 16).Enabled = blnTF
      Me.Text1(27 + (ii - 1) * 16).Enabled = blnTF
      'Modify By Sindy 2022/12/22 有客戶編號時不重設
      If Me.Text1(12 + (ii - 1) * 16).Text = "" Then
      '2022/12/22 END
         Me.Text1(92 + (ii - 1)).Enabled = blnTF
      End If
      'Add by Amy 2016/01/04 有值鎖住
      If blnTF = False Then
        If Me.Text1(119 + ii) <> MsgText(601) Then Me.Text1(119 + ii).Enabled = blnTF: Me.cmdSearchZip(ii * 2 - 1).Enabled = blnTF
      Else
        Me.Text1(119 + ii).Enabled = blnTF: Me.cmdSearchZip(ii * 2 - 1).Enabled = blnTF
      End If
      'Add By Sindy 2010/5/27
      If OptChoose(1).Value = True Then
         Me.Text1(34 + (ii - 1) * 16).Enabled = blnTF
         'Modify By Sindy 2023/2/7 國內接洽單也請顯示英文地址欄
         'Me.Text1(125 + (ii - 1) * 16).Enabled = blnTF
      End If
      '2010/5/27 End
      Me.Text1(125 + (ii - 1) * 16).Enabled = blnTF 'Modify By Sindy 2023/2/7 國內接洽單也請顯示英文地址欄
End Sub

Private Sub Text2_GotFocus(Index As Integer)
   TextInverse Me.Text2(Index)
   OpenIme
End Sub

'發明人姓名
Private Sub Text2_LostFocus(Index As Integer)
   'Add By Sindy 2023/3/22
   '舊客戶新案之發明人操作時，輸完發明人姓名跳離時，若已存在該客戶之發明人時，就直接帶出其他欄位資料，以節省輸入時間。
   If Text2(Index) <> "" And Option31(1).Value = True And Option1(0).Value = True Then
      Call GetInventorData(Left(Text1(12), 8), Text2(Index), Index, Text3(Index))
   End If
   '2023/3/22 END
End Sub

Private Sub Text2_MouseUp(Index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
   If Button = 2 Then Forms(0).PopupMenu2 Text2(Index)
End Sub

Private Sub Text2_Validate(Index As Integer, Cancel As Boolean)
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
Dim arrNA01
Dim tmpNa As String

   If Me.Text2(Index).Text <> "" Then
      tmpNa = "000"

      StrSQLa = "Select NA01,NA03 from Nation where NA01='" & tmpNa & "'"
      rsA.CursorLocation = adUseClient
      rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
      If rsA.RecordCount > 0 Then
         Me.Combo3(Index).Text = rsA.Fields(0).Value & " " & rsA.Fields(1).Value
         'Add By Sindy 2012/10/4
         Me.Combo3(Index).Tag = rsA.Fields(0).Value & " " & "中華民國"
         '2012/10/4 End
      End If
      
      If rsA.State <> adStateClosed Then rsA.Close
      Set rsA = Nothing
   End If
End Sub

Private Sub Text3_GotFocus(Index As Integer)
   TextInverse Me.Text3(Index)
   CloseIme
End Sub

Private Sub Text3_KeyPress(Index As Integer, KeyAscii As Integer)
   KeyAscii = UpperCase(KeyAscii)
End Sub

Private Sub Text3_Validate(Index As Integer, Cancel As Boolean)
Dim strTmp As String, i As Integer, j As Integer

   If Text3(Index).Text <> "" Then
      'Modify  by Amy 2020/09/01 +if 國籍為大陸於列印前才檢查身份證號
      If Left(Combo3(Index), 3) <> "020" Then
            'Modify By Sindy 2023/5/16
            'If GetTextLength(Text3(Index).Text) <> 10 Then
            If Len(Text3(Index).Text) <> 10 Then
            '2023/5/16 END
                  Call Text3_GotFocus(Index)
                  strTmp = "發明人ID必須是10碼 !"
                  If MsgBox(strTmp, vbOKOnly) = vbOK Then
                     Cancel = True
                     Exit Sub
                  '2008/9/3 ADD BY SONIA 不修改也不檢查ID
                  Else
                     Exit Sub
                  End If
            End If
            
            If CheckID(i, Text3(Index).Text) = False Then
               strTmp = "發明人ID錯誤，是否修正 ?"
               If MsgBox(strTmp, vbYesNo + vbCritical) = vbYes Then
                  Cancel = True
                  Call Text3_GotFocus(Index)
                  Exit Sub 'Add By Sindy 2023/12/7
               End If
            End If
      End If
      'Add By Sindy 2023/12/7 重新檢查是否有此發明人資料
      If Text2(Index) <> "" And Text2(Index).Enabled = True Then 'And Option31(1).Value = True And Option1(0).Value = True
         Call GetInventorData(Left(Text1(12), 8), Text2(Index), Index, Text3(Index))
         Call SetInventorCol(CStr(Index)) 'Add By Sindy 2023/12/7 ex:P-132472(陳威廷 * 2位,A130974327的沒有新增到; 同時使用到 X530940125)
      End If
      '2023/12/7 END
   End If

End Sub

Private Sub Text4_GotFocus(Index As Integer)
   TextInverse Me.Text4(Index)
   OpenIme
End Sub

Private Sub Text4_KeyPress(Index As Integer, KeyAscii As MSForms.ReturnInteger)
'Add By Sindy 98/02/11
Dim intLen As Integer
   If KeyAscii <> 8 Then
      'Modify By Sindy 2023/5/16
      'intLen = GetTextLength(Text4(Index))
      'intLen = intLen + GetTextLength(Chr(KeyAscii))
      intLen = Len(Text4(Index))
      intLen = intLen + Len(Chr(KeyAscii))
      '2023/5/16 END
      If intLen > Text4(Index).MaxLength Then KeyAscii = 0
   End If
'98/02/11 End
End Sub

Private Sub Text4_MouseUp(Index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
   If Button = 2 Then Forms(0).PopupMenu2 Text4(Index)
End Sub

Private Sub Text4_Validate(Index As Integer, Cancel As Boolean)
   If CheckLengthIsOK(Text4(Index), 70, , , True) = False Then
       Text4(Index).SetFocus
       Cancel = True
   End If
End Sub

Private Sub Text7_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
   If Button = 2 Then Forms(0).PopupMenu2 Text7
End Sub

'Add by Amy 2017/01/20
Private Sub TxtC1_GotFocus(Index As Integer)
    TextInverse Me.TxtC1(Index)
End Sub

Private Sub TxtC1_KeyPress(Index As Integer, KeyAscii As Integer)
    If Index = 0 Then
        KeyAscii = UpperCase(KeyAscii)
    End If
End Sub

Private Sub TxtC1_LostFocus(Index As Integer)
    Dim strMsg As String
    Dim strIBF06 As String 'Add By Sindy 2023/6/14

    If Trim(TxtC1(0)) = MsgText(601) Or Trim(TxtC1(1)) = MsgText(601) Then Exit Sub
    If Index = 2 And TxtC1(2) = MsgText(601) Then TxtC1(2) = "0": Exit Sub
    If Index <> 3 Then Exit Sub
    If TxtC1(3) = MsgText(601) Then TxtC1(3) = "00"
    If m_blnCallPrint = True Then Exit Sub 'Add By Sindy 2023/6/14
    
    Set G_SeekPicColor.Picture = LoadPicture()
    Set tmpImg.Picture = LoadPicture()
    If ExistCheck("TradeMark", "Tm01||Tm02||Tm03||Tm04", TxtC1(0) & TxtC1(1) & TxtC1(2) & TxtC1(3), strMsg) = False Then
        TxtC1(0).SetFocus
        Exit Sub
    End If
    'Modify by Amy 2018/07/31 ChkIsExistImg不使用
    'If ChkIsExistImg(TxtC1(0), TxtC1(1), TxtC1(2), TxtC1(3)) = False Then
    'Modify By Sindy 2023/6/14 +, , , , strIBF06
    Frame17.Enabled = True
    If ChkImgByteFile(TxtC1(0), TxtC1(1), TxtC1(2), TxtC1(3), , , , strIBF06) = False Then
        MsgBox "此案號無代表圖！"
        Exit Sub
    'Add By Sindy 2023/6/14
    Else
      Frame17.Visible = True
      Frame17.Enabled = False
      If strIBF06 = "1" Then
         optColor(0).Value = True
      ElseIf strIBF06 = "2" Then
         optColor(1).Value = True
      End If
      '2023/6/14 END
    End If
    
    frmPic001.bolNoMsg = True
    frmPic001.oCP01 = Me.TxtC1(0)
    frmPic001.oCP02 = Me.TxtC1(1)
    frmPic001.oCP03 = Me.TxtC1(2)
    frmPic001.oCP04 = Me.TxtC1(3)
    frmPic001.StrMenu
    MoveFormToCenter frmPic001
    frmPic001.cmdok_Click (7) '複制
    Set G_SeekPicColor.Picture = LoadPicture()
    Set tmpImg.Picture = LoadPicture()
    Set frmPic001.oPic = G_SeekPicColor
    Set frmPic001.oImg = tmpImg
    Set frmPic001.UpForm = Me
    frmPic001.oRtPic = True
    frmPic001.cmdok_Click (0) '貼上
    Unload frmpic002
    frmPic001.cmdok_Click (2) '確定
    frmPic001.bolNoMsg = False
End Sub

Private Sub TxtC1_Validate(Index As Integer, Cancel As Boolean)
    If Index <> 0 Then Exit Sub
    If Trim(TxtC1(0)) = MsgText(601) Then Exit Sub
    
    If Not (Trim(TxtC1(0)) = "T" Or Trim(TxtC1(0)) = "TF" Or Trim(TxtC1(0)) = "CFT") Then
        MsgBox "系統別只可輸入T/TF/CFT！"
        Cancel = True
        TxtC1(0).SetFocus
        Exit Sub
    End If
End Sub
'end 2017/01/20

Private Sub txtItemCount_GotFocus()
   TextInverse txtItemCount
   CloseIme
End Sub

Private Sub txtItemCount_KeyPress(KeyAscii As Integer)
   If KeyAscii <> 8 And Not IsNumeric(Chr(KeyAscii)) Then
      KeyAscii = 0
      Beep
   End If
End Sub

Private Sub txtItemList_GotFocus()
   CloseIme
End Sub

'add by nick 2004/07/07
'使用 print 指令
'Modify By Sindy 2014/7/30 +intPrintCnt As Integer
Sub PrintByPrinter1(intPrintCnt As Integer)
Dim CustItem As Integer
'Add By Sindy 2014/2/6
Dim strText1 As String, strText2 As String, strText3 As String, StrText4 As String, strText5 As String
Dim PrintWidthWord As Integer, bolOK As Boolean
'2014/2/6 END
'Added by Morgan 2022/1/28
Dim strPrtText As String, strPrtText2 As String
'end 2022/1/28

'Added by Morgan 2022/1/25
If m_bWordFormat Then
   Erase m_WordVar
   m_iSizeD2 = 0
Else
'end 2022/1/25

   'Modify By Sindy 2010/7/7
   If txtPrintType = "2" Then '印表機
      m_Device.Orientation = 1
   End If
   'edit 2004/07/30 nick copies 有些機器會有問題
   'm_Device.Copies = Val(txtPCnt.Text)
   m_Device.DrawWidth = 1
   
End If 'Added by Morgan 2022/1/25

'第一頁
PrinterPages = 1
'2011/5/9 ADD BY SONIA 多申請人時舊案若只印第一頁則總頁數改回 1頁 CFP-023621
'Modify By Sindy 2012/1/17 bolPrintNewCase=True 不同審級為新案
'If (Me.Option1(0).Value = True Or CheckCaseProperty = True) And m_intCustCnt > 1 Then
If (Me.Option1(0).Value = True Or CheckCaseProperty = True Or bolPrintNewCase = True) And m_intCustCnt > 1 Then
Else
   m_intTotPage = 1
End If
'2011/5/9 END

'抬頭
If IsoptCP81 = True Then
    'Modified by Morgan 2013/4/26
    'PrintByPrinterTitle1 IIf((IIf(Trim(Text1(12).Text) = "", True, IIf(optCP811(0).Value = True, True, False))) And (IIf(Trim(Text1(28).Text) = "", True, IIf(optCP812(0).Value = True, True, False))) And (IIf(Trim(Text1(44).Text) = "", True, IIf(optCP813(0).Value = True, True, False))) And (IIf(Trim(Text1(60).Text) = "", True, IIf(optCP814(0).Value = True, True, False))) And (IIf(Trim(Text1(76).Text) = "", True, IIf(optCP815(0).Value = True, True, False))), True, False), optCP811(0).Value = False And optCP811(1).Value = False And optCP812(0).Value = False And optCP812(1).Value = False And optCP813(0).Value = False And optCP813(1).Value = False And optCP814(0).Value = False And optCP814(1).Value = False And optCP815(0).Value = False And optCP815(1).Value = False
    PrintByPrinterTitle1 IIf(GetCP81() = "Y", True, False), IIf(GetCP81() = Empty, True, False)
Else
    PrintByPrinterTitle1 False, False
End If
'客戶資料
PrinterCustomer 1, False, IIf(m_intCustCnt > 1, True, False)

'明細
'Modified by Morgan 2022/2/23 沒再分了
'If (m_strST06 = "2" And Text1(6) = "P" And Left(Combo1(0), 3) = "000") Then
'    PrintDetail intPrintCnt, False
'Else
'    PrintDetail intPrintCnt, True
'End If
PrintDetail intPrintCnt
'end 2022/2/23

'Modify By Sindy 2012/1/17 bolPrintNewCase=True 不同審級為新案
'If (Me.Option1(0).Value = True Or CheckCaseProperty = True) And m_intCustCnt > 1 Then
If (Me.Option1(0).Value = True Or CheckCaseProperty = True Or bolPrintNewCase = True) And m_intCustCnt > 1 Then
   'm_Device.NewPage
   '第二頁
   'PrinterPages = 2
   PrinterPages = PrinterPages + 1
   
   'Added by Morgan 2022/2/23
   If m_bWordFormat Then
      WordVarSet "表頭"
   Else
   'end 2022/2/23
   
      'Add By Sindy 2010/7/7
      If PrinterPages > 1 Then
         If txtPrintType = "1" Then '螢幕
            SetPic PrinterPages - 1
         ElseIf PrinterPages > 1 Then
            m_Device.NewPage
         End If
      End If
      '2010/7/7 End
      
   End If 'Added by Morgan 2022/2/23
   
   If IsoptCP81 = True Then
       'Modified by Morgan 2013/4/26
       'PrintByPrinterTitle1 IIf((IIf(Trim(Text1(12).Text) = "", True, IIf(optCP811(0).Value = True, True, False))) And (IIf(Trim(Text1(28).Text) = "", True, IIf(optCP812(0).Value = True, True, False))) And (IIf(Trim(Text1(44).Text) = "", True, IIf(optCP813(0).Value = True, True, False))) And (IIf(Trim(Text1(60).Text) = "", True, IIf(optCP814(0).Value = True, True, False))) And (IIf(Trim(Text1(76).Text) = "", True, IIf(optCP815(0).Value = True, True, False))), True, False), optCP811(0).Value = False And optCP811(1).Value = False And optCP812(0).Value = False And optCP812(1).Value = False And optCP813(0).Value = False And optCP813(1).Value = False And optCP814(0).Value = False And optCP814(1).Value = False And optCP815(0).Value = False And optCP815(1).Value = False
       PrintByPrinterTitle1 IIf(GetCP81() = "Y", True, False), IIf(GetCP81() = Empty, True, False)
   Else
       PrintByPrinterTitle1 False, False
   End If
   
   '印出第二頁其他申請人
   For CustItem = 2 To m_intCustCnt
      WordVarSet "申請人" & CustItem 'Added by Morgan 2022/2/23
      PrinterCustomer CustItem, True, True
   Next CustItem
   
End If

'Add By Sindy 2014/2/6 列印特殊收據
'Modify By Sindy 2014/7/30 +And intPrintCnt = 1 只列印一次
If m_blnCallPrint = True And m_blnCallPrint_CRL119 = False Then
   '外部呼叫且不列印特殊收據頁
Else
   If Check9.Value = 1 And cmdCRL119.Visible = True And intPrintCnt = 1 Then
      PLeft(1) = 500: PLeft(2) = 8500: iLine = 4
      'm_Device.NewPage
      PrinterPages = PrinterPages + 1
      
      'Modified by Morgan 2022/1/28 增加 Word 輸出
      If m_bWordFormat Then
         WordVarSet "特殊收據附件"
      Else
         If PrinterPages > 1 Then
            If txtPrintType = "1" Then '螢幕
               SetPic PrinterPages - 1
            ElseIf PrinterPages > 1 Then
               m_Device.NewPage
            End If
         End If
         
      End If
      
      strPrtText = Text1(6) & IIf(Text1(7) = "", "（新案）", "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9))
      If m_bWordFormat Then
         WordVarSet "本所案號-特", strPrtText
      Else
         m_Device.CurrentX = PLeft(1)
         m_Device.CurrentY = 300 * iLine
         m_Device.Print "本所案號：" & strPrtText
      End If
      
      strPrtText = Text1(10) & lblStaffName & "　　　　　　　　　　　　　　　　　　　　　　"
      strPrtText2 = lblDate
      If m_bWordFormat Then
         WordVarSet "本所人員-特", strPrtText
         WordVarSet "填表日期-特", strPrtText2
      Else
         iLine = iLine + 1
         m_Device.CurrentX = PLeft(1)
         m_Device.CurrentY = 300 * iLine
         m_Device.Print "本所人員：" & strPrtText & "填表日期：" & strPrtText2
      End If
      
      strPrtText = Text1(21) & Text1(22)
      If m_bWordFormat Then
         WordVarSet "申請人１-特", strPrtText
      Else
         iLine = iLine + 1
         m_Device.CurrentX = PLeft(1)
         m_Device.CurrentY = 300 * iLine
         m_Device.Print "申請人１：" & strPrtText
      End If
      
      strPrtText = m_stCRL97
      If m_bWordFormat Then
         WordVarSet "張數-特", strPrtText
      Else
         iLine = iLine + 2
         m_Device.CurrentX = PLeft(1)
         m_Device.CurrentY = 300 * iLine
         m_Device.Print "拆收據張數：" & strPrtText
      End If
      
      For iiiii = 1 To 4 '5
         If iiiii = 1 Then
            strText1 = m_stCRL98 & IIf(m_stCRL98 <> "" And m_stCRL120 = "A", "(非客戶)", IIf(m_stCRL98 <> "" And m_stCRL120 = "", "(非客戶新抬頭)", ""))
            strText2 = m_stCRL99: strText3 = m_stCRL101: StrText4 = m_stCRL100
            strText5 = "電話1：" & convForm(CheckStr(m_stCRL114), 15) & " 傳真1：" & convForm(CheckStr(m_stCRL115), 15) & " E-Mail：" & m_stCRL116
         ElseIf iiiii = 2 Then
            strText1 = m_stCRL102 & IIf(m_stCRL102 <> "" And m_stCRL121 = "A", "(非客戶)", IIf(m_stCRL102 <> "" And m_stCRL121 = "", "(非客戶新抬頭)", ""))
            strText2 = m_stCRL103: strText3 = m_stCRL105: StrText4 = m_stCRL104
            strText5 = "電話2：" & convForm(CheckStr(m_stCRL117), 15) & " 傳真2：" & convForm(CheckStr(m_stCRL124), 15) & " E-Mail：" & m_stCRL126
         ElseIf iiiii = 3 Then
            strText1 = m_stCRL106 & IIf(m_stCRL106 <> "" And m_stCRL122 = "A", "(非客戶)", IIf(m_stCRL106 <> "" And m_stCRL122 = "", "(非客戶新抬頭)", ""))
            strText2 = m_stCRL107: strText3 = m_stCRL109: StrText4 = m_stCRL108
            strText5 = "電話3：" & convForm(CheckStr(m_stCRL127), 15) & " 傳真3：" & convForm(CheckStr(m_stCRL128), 15) & " E-Mail：" & m_stCRL129
         ElseIf iiiii = 4 Then
            strText1 = m_stCRL110 & IIf(m_stCRL110 <> "" And m_stCRL123 = "A", "(非客戶)", IIf(m_stCRL110 <> "" And m_stCRL123 = "", "(非客戶新抬頭)", ""))
            strText2 = m_stCRL111: strText3 = m_stCRL113: StrText4 = m_stCRL112
            strText5 = "電話4：" & convForm(CheckStr(m_stCRL130), 15) & " 傳真4：" & convForm(CheckStr(m_stCRL131), 15) & " E-Mail：" & m_stCRL132
         End If
         
         If m_bWordFormat Then
            WordVarSet "收據抬頭" & iiiii & "-特", strText1
            WordVarSet "統一編號" & iiiii & "-特", strText2
            WordVarSet "營業地址" & iiiii & "-特", strText3
            WordVarSet "郵寄地址" & iiiii & "-特", StrText4
            WordVarSet "通訊資料" & iiiii & "-特", strText5
         Else
            iLine = iLine + 2
            m_Device.CurrentX = PLeft(1)
            m_Device.CurrentY = 300 * iLine
            m_Device.Print "收據抬頭" & iiiii & "：" & strText1
            m_Device.CurrentX = PLeft(2)
            m_Device.CurrentY = 300 * iLine
            m_Device.Print "統一編號" & iiiii & "：" & strText2
            iLine = iLine + 1
            m_Device.CurrentX = PLeft(1)
            m_Device.CurrentY = 300 * iLine
            m_Device.Print "營業地址" & iiiii & "：" & strText3
            iLine = iLine + 1
            m_Device.CurrentX = PLeft(1)
            m_Device.CurrentY = 300 * iLine
            m_Device.Print "郵寄地址" & iiiii & "：" & StrText4
            'Add By Sindy 2015/8/28
            iLine = iLine + 1
            m_Device.CurrentX = PLeft(1)
            m_Device.CurrentY = 300 * iLine
            m_Device.Print strText5
            '2015/8/28 END
         End If
      Next iiiii
      
      If m_bWordFormat Then
         '文字在範本裡
      Else
         iLine = iLine + 2
         m_Device.CurrentX = PLeft(1)
         m_Device.CurrentY = 300 * iLine
         m_Device.Print "收據案件性質或金額劃分或其他說明:（收據抬頭超過5個時，請在此欄加註！）"
      End If
      
      strText1 = ""
      If m_stCRL118 <> "" Then
         PrintWidthWord = 92
         strText3 = m_stCRL118
         If PUB_StrToStr_byVal(strText3, PrintWidthWord) <> strText3 Then
            bolOK = True
            Do While bolOK = True
               strText2 = PUB_StrToStr_byVal(strText3, PrintWidthWord)
               If strText1 = "" Then
                  strText1 = strText2 & vbCrLf
               Else
                  strText1 = strText1 & "　　" & strText2 & vbCrLf
               End If
               strText3 = Mid(strText3, Len(strText2) + 1)
               If PUB_StrToStr_byVal(strText3, PrintWidthWord) = strText3 Then
                  bolOK = False
               End If
            Loop
            strText1 = strText1 & "　　" & strText3
         Else
            strText1 = strText3
         End If
         iLine = iLine + 1
      Else
         strText1 = "無"
         iLine = iLine + 2
      End If
      
      If m_bWordFormat Then
         WordVarSet "備註-特", strText1
      Else
         m_Device.CurrentX = PLeft(1)
         m_Device.CurrentY = 300 * iLine
         m_Device.Print strText1
      End If
   End If
End If
'2014/2/6 END

   'Modify By Sindy 2010/7/7
   If txtPrintType = "2" Then '印表機
      'Added by Morgan 2022/2/24
      'm_Device.EndDoc
      If Not m_bWordFormat Then
         m_Device.EndDoc
      End If
      'end 2022/2/24
   End If

End Sub

'add by nick 2004/07/07
'使用 print 指令
' Is605 符合年費減免嗎
Private Sub PrintByPrinterTitle1(Optional Is605 As Boolean = False, Optional IsNotSet605 As Boolean)  '列印抬頭及格線

'Added by Morgan 2022/1/26
If m_bWordFormat Then
   WordTitle1 Is605, IsNotSet605
   Exit Sub
End If
'end 2022/1/26

Dim strRptName As String

'Added by Lydia 2020/03/30 拿掉公司別
If strSrvDate(1) >= 智慧所更名日 Then
    If OptChoose(0).Value = True Then '國內
       strRptName = "國內案件接洽單"
    Else '大至台
       strRptName = "國外案件接洽單"
    End If
Else
'end 2020/03/03
    'Add By Sindy 2010/5/27
    If OptChoose(0).Value = True Then '國內
       'Modified by Lydia 2019/07/12 更名
       'strRptName = "台一國際專利商標事務所國內案件接洽記錄單"
       strRptName = "台一國際專利商標事務所國內案件接洽單"
    Else '大至台
       'Modified by Lydia 2019/07/12 更名
       'strRptName = "台一國際專利商標事務所國外案件接洽記錄單"
       strRptName = "台一國際專利商標事務所國外案件接洽單"
    End If
End If 'Added by Lydia 2020/03/30

m_Device.FontBold = False 'Added by Morgan 2020/2/5
m_Device.Font.Name = "標楷體"
m_Device.Font.Size = 22
m_Device.CurrentX = 5600 - (m_Device.TextWidth(strRptName) / 2)
m_Device.CurrentY = 0
m_Device.Print strRptName
m_Device.Font.Size = 12

'印框
m_Device.Line (5100, 1325 - 100)-(5100, 1900 - 100)
m_Device.Line (5700, 1325 - 100)-(5700, 1900 - 100)
m_Device.Line (4625, 1600 - 100)-(5700, 1600 - 100)
m_Device.Line (3550, 600 - 100)-(7550, 1900 - 100), , B
m_Device.Line (3550, 600 - 100)-(4600, 1900 - 100), , B
m_Device.Line (3550, 600 - 100)-(7550, 975 - 100), , B
m_Device.Line (3550, 600 - 100)-(7550, 1300 - 100), , B
m_Device.Line (3550, 975 - 100)-(7550, 975 - 100)
m_Device.Line (4600, 600 - 100)-(4600, 1900 - 100)
m_Device.Line (5100, 1325 - 100)-(5100, 1900 - 100)
m_Device.Line (5700, 1325 - 100)-(5700, 1900 - 100)
m_Device.Line (4625, 1600 - 100)-(5700, 1600 - 100)

'Added by Morgan 2020/4/23
'案源單號
If strLOS15 <> "" Then
   m_Device.CurrentX = 0
   m_Device.CurrentY = 150
   m_Device.Print "案源單號： " & strLOS15
End If

'Added by Lydia 2020/11/19 CFP和CFT英國脫歐案：歐盟案案號
If strCaseNA239 <> "" Then
   m_Device.CurrentX = 0
   m_Device.CurrentY = 150
   m_Device.Print "歐盟案案號：" & strCaseNA239
End If

'Added by Lydia 2021/03/05 CFT歐盟尚未註冊案轉換英國申請案收文控管
If strCaseNA239new <> "" Then
   m_Device.CurrentX = 0
   m_Device.CurrentY = 150
   m_Device.Print "歐盟案案號：" & strCaseNA239new
End If

'Added by Lydia 2020/12/15 CFT緬甸重新申請案
If Option1(0).Value = True And Text1(6).Text = "CFT" And Trim(Text1(7) & Text1(8) & Text1(9)) = "" And Trim(Left(Combo1(0).Text, 4)) = "048" _
    And InStr(Trim(Left(Combo1(1).Text, 4)) & "," & Trim(Left(Combo1(2).Text, 4)) & "," & Trim(Left(Combo1(3).Text, 4)) & "," & Trim(Left(Combo1(4).Text, 4)) & ",", "101,") > 0 _
    And strCaseNo1 <> "" And strCaseNo2 <> "" Then
      m_Device.CurrentX = 0
      m_Device.CurrentY = 150
      m_Device.Print "緬甸舊案號：" & strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4
End If
'end 2020/12/15

'區別
m_Device.CurrentX = 0
m_Device.CurrentY = 700 - 100
m_Device.Print "區別： " & lblZone.Caption
m_Device.Line (800, 975 - 100)-(2900, 975 - 100)
'總收文號 區塊
m_Device.CurrentX = 3600
m_Device.CurrentY = 650 - 100
m_Device.Print "總收文號"

'Add by Morgan 2010/12/20
If m_CP09 <> "" Then
   m_Device.CurrentX = 3600 + 1200
   m_Device.CurrentY = 650 - 100
   m_Device.Print m_CP09

   'Add by Morgan 2011/1/14 列印 非整批發文 字樣
   If m_bolPrintMark Then
      m_Device.CurrentX = 3600 + 1200 + m_Device.TextWidth(m_CP09) + 50
      m_Device.CurrentY = 650 - 100
      m_Device.FontBold = True
      m_Device.Print "(非整批發文)"
      m_Device.FontBold = False
   End If
End If

'填表日期
m_Device.CurrentX = 7600
m_Device.CurrentY = 700 - 250
m_Device.Print "填表日期："
m_Device.Line (8800, 950 - 250)-(9300, 950 - 250)
If m_CRL02 <> "" And m_blnCallPrint = True Then '填表日期 Add By Sindy 2011/10/18
   '年
   m_Device.CurrentX = 8800
   m_Device.CurrentY = 700 - 250
   m_Device.Print Right("  " & Mid(m_CRL02, 1, 4) - 1911, 3) & " 年"
   m_Device.Line (9600, 950 - 250)-(10100, 950 - 250)
   '月
   m_Device.CurrentX = 9750
   m_Device.CurrentY = 700 - 250
   m_Device.Print Right("  " & Mid(m_CRL02, 5, 2), 2) & " 月"
   m_Device.Line (10400, 950 - 250)-(10900, 950 - 250)
   '日
   m_Device.CurrentX = 10550
   m_Device.CurrentY = 700 - 250
   m_Device.Print Right("  " & Mid(m_CRL02, 7, 2), 2) & " 日"
Else
   '年
   m_Device.CurrentX = 8800
   m_Device.CurrentY = 700 - 250
   m_Device.Print Right("  " & Mid(strSrvDate(1), 1, 4) - 1911, 3) & " 年"
   m_Device.Line (9600, 950 - 250)-(10100, 950 - 250)
   '月
   m_Device.CurrentX = 9750
   m_Device.CurrentY = 700 - 250
   m_Device.Print Right("  " & Mid(strSrvDate(1), 5, 2), 2) & " 月"
   m_Device.Line (10400, 950 - 250)-(10900, 950 - 250)
   '日
   m_Device.CurrentX = 10550
   m_Device.CurrentY = 700 - 250
   m_Device.Print Right("  " & Mid(strSrvDate(1), 7, 2), 2) & " 日"
End If
'期限區塊
m_Device.Line (50, 1000 - 100)-(850, 1900 - 100), , B
m_Device.Line (50, 1000 - 100)-(300, 1900 - 100), , B
m_Device.Line (325, 1325 - 100)-(875, 1325 - 100)
m_Device.Line (325, 1600 - 100)-(875, 1600 - 100)
'期限
m_Device.CurrentX = 50
m_Device.CurrentY = 1050 - 75
m_Device.Print "期"
m_Device.CurrentX = 50
m_Device.CurrentY = 1500 - 100
m_Device.Print "限"
'法定
m_Device.CurrentX = 350
m_Device.CurrentY = 1050 - 100
m_Device.Print "法定"
'年
m_Device.CurrentX = 1100
m_Device.CurrentY = 1050 - 100
If Trim(Text1(1).Text) = "" Then
    m_Device.Print "    年"
Else
    m_Device.Print Right("  " & Val(Mid(ChangeTStringToWString(Text1(1).Text), 1, 4)) - 1911, 3) & " 年"
End If
m_Device.Line (950, 1300 - 100)-(1450, 1300 - 100)
'月
m_Device.CurrentX = 1900
m_Device.CurrentY = 1050 - 100
m_Device.Print Right("  " & Mid(ChangeTStringToWString(Text1(1).Text), 5, 2), 2) & "  月"
m_Device.Line (1750, 1300 - 100)-(2250, 1300 - 100)
'日
m_Device.CurrentX = 2700
m_Device.CurrentY = 1050 - 100
m_Device.Print Right("  " & Mid(ChangeTStringToWString(Text1(1).Text), 7, 2), 2) & " 日"
m_Device.Line (2550, 1300 - 100)-(3050, 1300 - 100)
''約定
'm_Device.CurrentX = 350
'm_Device.CurrentY = 1350 - 100
'm_Device.Print "約定"
''年
'm_Device.CurrentX = 1100
'm_Device.CurrentY = 1350 - 100
'If Trim(Text1(2).Text) = "" Then
'    m_Device.Print "    年"
'Else
'    m_Device.Print Right("  " & Val(Mid(ChangeTStringToWString(Text1(2).Text), 1, 4)) - 1911, 3) & " 年"
'End If
'm_Device.Line (950, 1600 - 100)-(1450, 1600 - 100)
''月
'm_Device.CurrentX = 1900
'm_Device.CurrentY = 1350 - 100
'm_Device.Print Right("  " & Mid(ChangeTStringToWString(Text1(2).Text), 5, 2), 2) & "  月"
'm_Device.Line (1750, 1600 - 100)-(2250, 1600 - 100)
''日
'm_Device.CurrentX = 2700
'm_Device.CurrentY = 1350 - 100
'm_Device.Print Right("  " & Mid(ChangeTStringToWString(Text1(2).Text), 7, 2), 2) & " 日"
'm_Device.Line (2550, 1600 - 100)-(3050, 1600 - 100)
'本所
m_Device.CurrentX = 350
m_Device.CurrentY = 1650 - 100
m_Device.Print "本所"
'年
m_Device.CurrentX = 1100
m_Device.CurrentY = 1650 - 100
If Trim(Text1(3).Text) = "" Then
    m_Device.Print "    年"
Else
    m_Device.Print Right("  " & Val(Mid(ChangeTStringToWString(Text1(3).Text), 1, 4)) - 1911, 3) & " 年"
End If
m_Device.Line (950, 1900 - 100)-(1450, 1900 - 100)
'月
m_Device.CurrentX = 1900
m_Device.CurrentY = 1650 - 100
m_Device.Print Right("  " & Mid(ChangeTStringToWString(Text1(3).Text), 5, 2), 2) & "  月"
m_Device.Line (1750, 1900 - 100)-(2250, 1900 - 100)
'日
m_Device.CurrentX = 2700
m_Device.CurrentY = 1650 - 100
m_Device.Print Right("  " & Mid(ChangeTStringToWString(Text1(3).Text), 7, 2), 2) & " 日"
m_Device.Line (2550, 1900 - 100)-(3050, 1900 - 100)
'收文日期
m_Device.CurrentX = 3600
m_Device.CurrentY = 1000 - 100
m_Device.Print "收文日期"

'Add by Morgan 2010/12/20
If m_CP05 <> "" Then
   m_Device.CurrentX = 3600 + 1200
   m_Device.CurrentY = 1000 - 100
   m_Device.Print (Left(m_CP05, 4) - 1911) & " 年 " & Mid(m_CP05, 5, 2) & " 月 " & Mid(m_CP05, 7) & " 日"
End If

'本所案號
m_Device.CurrentX = 3600
m_Device.CurrentY = 1500 - 100
m_Device.Print "本所案號"
m_Device.CurrentX = 3600 + 1200 + 960
m_Device.CurrentY = 1500 - 100
'Modify By Sindy 2011/6/7
'm_Device.Print IIf(Option1(1).Value = True And Is308Child = False, Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text, Text1(6).Text & "-")
If Option1(1).Value = True And Is308Child = False Then
   m_Device.Print Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text
Else
   'Modify Sindy 2011/11/10 分割子案為新案,不列印案號
   'If Text1(7).Text <> "" Then
   If Text1(7).Text <> "" And Is308Child = False Then
      m_Device.Print Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text
   Else
      m_Device.Print Text1(6).Text & "-"
   End If
End If
'新案
m_Device.CurrentX = 4750
m_Device.CurrentY = 1350 - 100
'edit by nickc 2006/07/19   IIf(Option1(0).Value = True, "V", "")
'Modify By Sindy 2011/6/7
'm_Device.Print IIf(Option1(0).Value = True Or Is308Child = True, "V", "")
m_Device.Print IIf(Option1(0).Value = True Or Is308Child = True Or bolPrintNewCase = True, "V", "")
m_Device.CurrentX = 4750 + 360
m_Device.CurrentY = 1350 - 100
m_Device.Print "新案"
'舊案
m_Device.CurrentX = 4750
m_Device.CurrentY = 1650 - 100
'edit by nickc 2006/07/19 IIf(Option1(1).Value = True, "V", "")
'Modify By Sindy 2011/6/7
'm_Device.Print IIf(Option1(1).Value = True And Is308Child = False, "V", "")
m_Device.Print IIf(Option1(1).Value = True And Is308Child = False And bolPrintNewCase = False, "V", "")
m_Device.CurrentX = 4750 + 360
m_Device.CurrentY = 1650 - 100
m_Device.Print "舊案"

'頁　　數
m_Device.CurrentX = 7600
m_Device.CurrentY = 1050 - 300
m_Device.Print "頁　　數：第  " & str(PrinterPages) & "  頁共  " & m_intTotPage & "  頁"
'本所人員
m_Device.Font.Size = 15
m_Device.CurrentX = 7600
m_Device.CurrentY = 1350 - 300
m_Device.Print "本所人員：" & lblStaffName.Caption
m_Device.Line (9100, 1700 - 300)-(11300, 1700 - 300)
'員工代號
m_Device.CurrentX = 7600
m_Device.CurrentY = 1750 - 300
m_Device.Print "員工代號：" & Text1(10).Text
m_Device.Line (9100, 2100 - 300)-(11300, 2100 - 300)
'申請國
m_Device.Font.Size = 16
m_Device.CurrentX = 0
m_Device.CurrentY = 2150 - 100
m_Device.FontBold = True
m_Device.Print "申請國：" & PUB_StrToStr(Combo1(0).Text, 18)
m_Device.Line (1250, 2550 - 100)-(3950, 2550 - 100)
'案件性質
m_Device.CurrentX = 4000
m_Device.CurrentY = 2000 - 100
m_Device.Print "案件性質："
m_Device.CurrentX = 5600
m_Device.CurrentY = 1900
'add by nickc 2006/07/19
If Is308New And Is308Child Then
    'Modify by Amy 2014/10/08 +T大陸分割控管
    If Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
        '新案子案
        m_Device.Print IIf(Combo1(intCN308Field).Text <> "", "(1)" & Trim(Combo1(intCN308Field).Text) & "(子案)", "")
    Else
        'Modify By Sindy 2009/08/05
        m_Device.Print IIf(Combo1(2).Text <> "", "(1)" & Trim(Combo1(2).Text), "") & IIf(Is307or308 And Is308Child, "[第" & Trim(NowCount) & "案]", "")
        'm_Device.Print IIf(Combo1(2).Text <> "", "(1)" & Left(Trim(Combo1(2).Text), 9), "") & IIf(Is307or308 And Is308Child, "[第" & Trim(NowCount) & "案]", "")
    End If
    m_Device.CurrentX = 5600
    m_Device.CurrentY = 2250
    m_Device.Print ""
    m_Device.CurrentX = 8500 '8100 Modify By Sindy 2009/08/05
    m_Device.CurrentY = 1900
    m_Device.Print ""
    m_Device.CurrentX = 8500 '8100 Modify By Sindy 2009/08/05
    m_Device.CurrentY = 2250
    m_Device.Print ""
Else
    'edit by nickc 2005/05/27
    'm_Device.Print IIf(Combo1(1).Text <> "", "(1)" & Combo1(1).Text, "")
    'Modify By Sindy 2009/10/21 子案案件性質只顯示308分割
    If Is307or308 And Is308Child Then
         'Modify by Amy 2014/10/08 +T大陸分割只會分1子案
         If Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
            '舊案子案
            m_Device.Print "(1)308 分割"
         Else
            m_Device.Print "(1)308 分割" & "[第" & Trim(NowCount) & "案]"
         End If
         'end 2014/10/08
         m_Device.CurrentX = 5600
         m_Device.CurrentY = 2250
         m_Device.Print ""
         m_Device.CurrentX = 8500
         m_Device.CurrentY = 1900
         m_Device.Print ""
         m_Device.CurrentX = 8500
         m_Device.CurrentY = 2250
         m_Device.Print ""
    '2009/10/21 End
    Else
         'Modify By Sindy 2009/08/05
         If Combo1(3).Text <> "" Then
           m_Device.Print IIf(Combo1(1).Text <> "", "(1)" & Left(Trim(Combo1(1).Text), 9), "") & IIf(Is307or308 And Is308Child, "[第" & Trim(NowCount) & "案]", "")
         Else
           m_Device.Print IIf(Combo1(1).Text <> "", "(1)" & Trim(Combo1(1).Text), "") & IIf(Is307or308 And Is308Child, "[第" & Trim(NowCount) & "案]", "")
         End If
         m_Device.CurrentX = 5600
         m_Device.CurrentY = 2250
         'Modify By Sindy 2009/08/05
         If Combo1(4).Text <> "" Then
           m_Device.Print IIf(Combo1(2).Text <> "", "(2)" & Left(Trim(Combo1(2).Text), 9), "")
         Else
           m_Device.Print IIf(Combo1(2).Text <> "", "(2)" & Combo1(2).Text, "")
         End If
         m_Device.CurrentX = 8500 '8100 Modify By Sindy 2009/08/05
         m_Device.CurrentY = 1900
         'Modify By Sindy 2009/08/05
         'm_Device.Print IIf(Combo1(3).Text <> "", "(3)" & Combo1(3).Text, "")
         'Modify by Amy 2014/10/23 T大陸分割控制
         If Is308New = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
            '新案母案
            m_Device.Print IIf(Combo1(3).Text <> "", "(3)" & Left(Trim(Combo1(3).Text), 9) & "(母案)", "")
         Else
            m_Device.Print IIf(Combo1(3).Text <> "", "(3)" & Left(Trim(Combo1(3).Text), 9), "")
         End If
         m_Device.CurrentX = 8500 '8100 Modify By Sindy 2009/08/05
         m_Device.CurrentY = 2250
         'Modify By Sindy 2009/08/05
         'm_Device.Print IIf(Combo1(4).Text <> "", "(4)" & Combo1(4).Text, "")
         m_Device.Print IIf(Combo1(4).Text <> "", "(4)" & Left(Trim(Combo1(4).Text), 9), "")
    End If
End If
m_Device.Line (5550, 2650)-(11300, 2650)
'主題
m_Device.CurrentX = 0
m_Device.CurrentY = 2750
'2008/3/21 modify by sonia 商標舊案於主題後加印審定號或申請案號
'm_Device.Print "主題：" & StrToStr(Text1(11).Text, 34)
'Add By Sindy 2015/4/27
If m_strSaveFiles <> "" Then
   If Option1(1) = True And (Text1(6) = "T" Or Text1(6) = "FCT" Or Text1(6) = "CFT" Or Text1(6) = "TF") Then
      If m_strTM15 <> "" Then
         m_Device.Print "主題：" & StrToStr(Text1(11).Text, 18) & "(審定號：" & m_strTM15 & ")"
      ElseIf m_strTM12 <> "" Then
         m_Device.Print "主題：" & StrToStr(Text1(11).Text, 16) & "(申請案號：" & m_strTM12 & ")"
      Else
         m_Device.Print "主題：" & StrToStr(Text1(11).Text, 26)
      End If
   Else
      m_Device.Print "主題：" & StrToStr(Text1(11).Text, 26)
   End If
   m_Device.CurrentX = 9500
   m_Device.CurrentY = 2750
   m_Device.Font.Size = 12
   m_Device.FontBold = False
   m_Device.Print " (有電子回覆單)"
Else
'2015/4/27 END
   If Option1(1) = True And (Text1(6) = "T" Or Text1(6) = "FCT" Or Text1(6) = "CFT" Or Text1(6) = "TF") Then
      If m_strTM15 <> "" Then
         m_Device.Print "主題：" & StrToStr(Text1(11).Text, 25) & "(審定號：" & m_strTM15 & ")"
      ElseIf m_strTM12 <> "" Then
         m_Device.Print "主題：" & StrToStr(Text1(11).Text, 23) & "(申請案號：" & m_strTM12 & ")"
      Else
         m_Device.Print "主題：" & StrToStr(Text1(11).Text, 32)
      End If
   Else
      m_Device.Print "主題：" & StrToStr(Text1(11).Text, 32)
   End If
End If
'2008/3/21 end
m_Device.Line (900, 3150)-(11300, 3150)
'符合年費減免
m_Device.Font.Size = 9
m_Device.FontBold = False
m_Device.CurrentX = 4000
m_Device.CurrentY = 2350
'edit by nick 2004/09/10
'edit by nick 2004/10/05
If IsoptCP81 = True Then
    If IsNotSet605 = True Then
        m_Device.Print "(尚未設定減免身份)"
    Else
        If Is605 = True Then
            'Added by Morgan 2019/4/12
            If stCountry = "011" Then
               m_Device.Print "(符合減免資格)"
            Else
            'end 2019/4/12
               m_Device.Print "(符合年費減免)"
            End If
        Else
            'Added by Morgan 2019/4/12
            If stCountry = "011" Then
               m_Device.Print "(不符合減免資格)"
            Else
            'end 2019/4/12
               m_Device.Print "(不符合年費減免)"
            End If
        End If
    End If
End If
m_Device.Font.Size = 12
End Sub

'Added by Morgan 2022/1/26
Private Sub WordTitle1(Optional Is605 As Boolean = False, Optional IsNotSet605 As Boolean)  '列印抬頭及格線
   Dim strPrtText As String
   
   '案源單號
   If strLOS15 <> "" Then
      strPrtText = "案源單號： " & strLOS15
      
   ElseIf strCaseNA239 <> "" Then
      strPrtText = "歐盟案案號：" & strCaseNA239
      
   ElseIf strCaseNA239new <> "" Then
      strPrtText = "歐盟案案號：" & strCaseNA239new
      
   ElseIf Option1(0).Value = True And Text1(6).Text = "CFT" And Trim(Text1(7) & Text1(8) & Text1(9)) = "" And Trim(Left(Combo1(0).Text, 4)) = "048" _
       And InStr(Trim(Left(Combo1(1).Text, 4)) & "," & Trim(Left(Combo1(2).Text, 4)) & "," & Trim(Left(Combo1(3).Text, 4)) & "," & Trim(Left(Combo1(4).Text, 4)) & ",", "101,") > 0 _
       And strCaseNo1 <> "" And strCaseNo2 <> "" Then
         strPrtText = "緬甸舊案號：" & strCaseNo1 & strCaseNo2 & StrCaseNo3 & strCaseNo4
   Else
      strPrtText = ""
   End If
   
   '變數要依照Word內的順序存放，這樣尋找時才能往後找就好
   WordVarSet "案源單號", strPrtText

    If OptChoose(0).Value = True Then '國內
       strPrtText = "國內案件接洽單"
    Else '大至台
       strPrtText = "國外案件接洽單"
    End If
   WordVarSet "標題", strPrtText



'區別
WordVarSet "區別", lblZone.Caption

'總收文號
If m_CP09 <> "" Then
   strPrtText = m_CP09
Else
   strPrtText = ""
End If
WordVarSet "總收文號", strPrtText


'填表日期
If m_CRL02 <> "" And m_blnCallPrint = True Then
   strPrtText = m_CRL02
Else
   strPrtText = strSrvDate(1)
End If
WordVarSet "填表日期", strPrtText

strPrtText = DBDATE(Text1(1))
WordVarSet "法定期限", strPrtText

'strPrtText = DBDATE(Text1(2))
'WordVarSet "約定期限", strPrtText

strPrtText = DBDATE(Text1(3))
WordVarSet "本所期限", strPrtText

'收文日期
If m_CP05 <> "" Then
   strPrtText = m_CP05
Else
   strPrtText = ""
End If
WordVarSet "收文日期", strPrtText

'本所案號
strPrtText = ""
If Option1(1).Value = True And Is308Child = False Then
   strPrtText = Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text
Else
   If Text1(7).Text <> "" And Is308Child = False Then
      strPrtText = Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text
   Else
      strPrtText = Text1(6).Text & "-"
   End If
End If
WordVarSet "本所案號", strPrtText

'新案
strPrtText = IIf(Option1(0).Value = True Or Is308Child = True Or bolPrintNewCase = True, "V", "")
If strPrtText <> "" Then
   WordVarSet "新案", "V", True
Else
   WordVarSet "舊案", "V", True
End If

'頁　　數
strPrtText = "第  " & str(PrinterPages) & "  頁共  " & m_intTotPage & "  頁"
WordVarSet "頁數", strPrtText

'本所人員
strPrtText = lblStaffName.Caption
WordVarSet "本所人員", strPrtText

'員工代號
strPrtText = Text1(10).Text
WordVarSet "員工代號", strPrtText

'申請國
strPrtText = PUB_StrToStr(Combo1(0).Text, 18)
WordVarSet "申請國", strPrtText, , True

'減免資格
strPrtText = ""
If IsoptCP81 = True Then
    If IsNotSet605 = True Then
        strPrtText = "(尚未設定減免身份)"
    Else
        If Is605 = True Then
            If stCountry = "011" Then
               strPrtText = "(符合減免資格)"
            Else
               strPrtText = "(符合年費減免)"
            End If
        Else
            If stCountry = "011" Then
               strPrtText = "(不符合減免資格)"
            Else
               strPrtText = "(不符合年費減免)"
            End If
        End If
    End If
End If
WordVarSet "減免資格", strPrtText

'案件性質
strPrtText = ""
If Is308New And Is308Child Then
    'Modify by Amy 2014/10/08 +T大陸分割控管
    If Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
        '新案子案
        strPrtText = IIf(Combo1(intCN308Field).Text <> "", "(1)" & Trim(Combo1(intCN308Field).Text) & "(子案)", "")
    Else
        strPrtText = IIf(Combo1(2).Text <> "", "(1)" & Trim(Combo1(2).Text), "") & IIf(Is307or308 And Is308Child, "[第" & Trim(NowCount) & "案]", "")
    End If
    WordVarSet "案件性質1", strPrtText, , True
    WordVarSet "案件性質2", ""
    WordVarSet "案件性質3", ""
    WordVarSet "案件性質4", ""
Else
    '子案案件性質只顯示308分割
    If Is307or308 And Is308Child Then
         'T大陸分割只會分1子案
         If Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
            '舊案子案
            strPrtText = "(1)308 分割"
         Else
            strPrtText = "(1)308 分割" & "[第" & Trim(NowCount) & "案]"
         End If
         WordVarSet "案件性質1", strPrtText, , True
         WordVarSet "案件性質2", ""
         WordVarSet "案件性質3", ""
         WordVarSet "案件性質4", ""
    Else
         'Modify By Sindy 2009/08/05
         If Combo1(3).Text <> "" Then
           strPrtText = IIf(Combo1(1).Text <> "", "(1)" & Left(Trim(Combo1(1).Text), 9), "") & IIf(Is307or308 And Is308Child, "[第" & Trim(NowCount) & "案]", "")
         Else
           strPrtText = IIf(Combo1(1).Text <> "", "(1)" & Trim(Combo1(1).Text), "") & IIf(Is307or308 And Is308Child, "[第" & Trim(NowCount) & "案]", "")
         End If
         WordVarSet "案件性質1", strPrtText, , True
         
         If Combo1(4).Text <> "" Then
           strPrtText = IIf(Combo1(2).Text <> "", "(2)" & Left(Trim(Combo1(2).Text), 9), "")
         Else
           strPrtText = IIf(Combo1(2).Text <> "", "(2)" & Combo1(2).Text, "")
         End If
         WordVarSet "案件性質2", strPrtText, , True
         
         'T大陸分割控制
         If Is308New = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
            '新案母案
            strPrtText = IIf(Combo1(3).Text <> "", "(3)" & Left(Trim(Combo1(3).Text), 9) & "(母案)", "")
         Else
            strPrtText = IIf(Combo1(3).Text <> "", "(3)" & Left(Trim(Combo1(3).Text), 9), "")
         End If
         WordVarSet "案件性質3", strPrtText, , True
         
         strPrtText = IIf(Combo1(4).Text <> "", "(4)" & Left(Trim(Combo1(4).Text), 9), "")
         WordVarSet "案件性質4", strPrtText, , True
    End If
End If

'主題
If Option1(1) = True And (Text1(6) = "T" Or Text1(6) = "FCT" Or Text1(6) = "CFT" Or Text1(6) = "TF") Then
   If m_strTM15 <> "" Then
      strPrtText = StrToStr(Text1(11).Text, 18) & "(審定號：" & m_strTM15 & ")"
   ElseIf m_strTM12 <> "" Then
      strPrtText = StrToStr(Text1(11).Text, 16) & "(申請案號：" & m_strTM12 & ")"
   Else
      strPrtText = StrToStr(Text1(11).Text, 26)
   End If
Else
   strPrtText = StrToStr(Text1(11).Text, 26)
End If
WordVarSet "主題", strPrtText, , True

'有電子回覆單
If m_strSaveFiles <> "" Then
   strPrtText = " (有電子回覆單)"
Else
   strPrtText = ""
End If
WordVarSet "電子回覆單", strPrtText

End Sub

'add by nick 2004/07/12
'客戶區塊
' strIndex  第幾個客戶區塊
' IsLine     是否要畫線，若不用畫線，則為主頁，會秀客戶案號而不會秀 ID.NO.，主頁也會有 多申請人駐標
' IsMutl     是否有多申請人
Private Sub PrinterCustomer(Optional Strindex As Integer = 1, Optional IsLine As Boolean = False, Optional IsMutl As Boolean = False)

'Added by Morgan 2022/1/26
If m_bWordFormat Then
   WordCustomer Strindex, IsLine, IsMutl
   Exit Sub
End If
'end 2022/1/26

'行數
Dim CustCol As Integer

'設定位移區塊位置
Dim intMoveCurrent As Integer
intMoveCurrent = ((Strindex - 1 + IIf(Strindex = 1, 1, 0)) * 3200) - 3200
m_Device.Font.Name = "標楷體"
m_Device.Font.Size = 12
If IsLine = True Or Strindex = 1 Then
Dim ijk As Integer
        Select Case Strindex
        Case 1
                 ijk = 1

        Case 2
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 0), , B
                ijk = 1

        Case 3
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 3200), , B
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 0), , B
                ijk = 2

        Case 4
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 6400), , B
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 3200), , B
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 0), , B
                ijk = 3

        Case 5
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 9600), , B
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 6400), , B
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 3200), , B
                m_Device.Line (0, 3200)-(11175, 5750 + (CustMove * 8) + 0), , B
                ijk = 4

        Case Else
        End Select
        For ijk = 1 To Strindex
            If (Strindex > 1 And ijk <> Strindex) Or Strindex = 1 Then
                '客戶編號
                m_Device.Line (1250, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(2450, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
                '接洽人
                m_Device.Line (3500, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(4600, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
                'Modify By Sindy 2010/5/27
                If OptChoose(0).Value = True Then
                  '電話
                  m_Device.Line (5400, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(8100, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
                  m_Device.Line (8900, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(11100, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
                ElseIf OptChoose(1).Value = True Then
                  If Strindex = 1 Then
                     '代理人編號
                     m_Device.Line (1400, 3450 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(2600, 3450 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
                     '代理人
                     'Modify By Sindy 2011/7/11
                     'm_Device.Line (5000, 3450 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(11100, 3450 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
                     m_Device.Line (3800, 3450 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(11100, 3450 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
'                  Else
'                     '代理人編號
'                     m_Device.Line (1400, 3150 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(2600, 3150 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
'                     '代理人
'                     m_Device.Line (5000, 3150 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(11100, 3150 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
                  End If
                  '國籍
                  m_Device.Line (5400, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))-(8100, 3800 + IIf(Strindex <> 1, 150, 0) + (CustMove * 2) + ((ijk - 1) * 3200))
                End If
                'ID.NO.
                m_Device.Line (1250, 4100 + IIf(Strindex <> 1, 100, 0) + (CustMove * 3) + ((ijk - 1) * 3200))-(3150, 4100 + IIf(Strindex <> 1, 100, 0) + (CustMove * 3) + ((ijk - 1) * 3200))
                'E-Mail
                m_Device.Line (4250, 4100 + IIf(Strindex <> 1, 100, 0) + (CustMove * 3) + ((ijk - 1) * 3200))-(11100, 4100 + IIf(Strindex <> 1, 100, 0) + (CustMove * 3) + ((ijk - 1) * 3200))
                '申請人(中文)
                m_Device.Line (1700, 4600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 4.5) + ((ijk - 1) * 3200))-(6600, 4600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 4.5) + ((ijk - 1) * 3200))
                '代表人(中文)
                m_Device.Line (8600, 4600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 4.5) + ((ijk - 1) * 3200))-(11100, 4600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 4.5) + ((ijk - 1) * 3200))
                '申請人(英文)
                m_Device.Line (1700, 5000 + IIf(Strindex <> 1, 50, 0) + (CustMove * 6) + ((ijk - 1) * 3200))-(7600, 5000 + IIf(Strindex <> 1, 50, 0) + (CustMove * 6) + ((ijk - 1) * 3200))
                '代表人(英文)
                m_Device.Line (8600, 5000 + IIf(Strindex <> 1, 50, 0) + (CustMove * 6) + ((ijk - 1) * 3200))-(11100, 5000 + IIf(Strindex <> 1, 50, 0) + (CustMove * 6) + ((ijk - 1) * 3200))
                'Modify By Sindy 2010/5/27
                If OptChoose(0).Value = True Then
                  '聯絡地址
                  m_Device.Line (1250, 5300 + IIf(Strindex <> 1, 50, 0) + (CustMove * 7) + ((ijk - 1) * 3200))-(2450, 5300 + IIf(Strindex <> 1, 50, 0) + (CustMove * 7) + ((ijk - 1) * 3200))
                  m_Device.Line (2550, 5300 + IIf(Strindex <> 1, 50, 0) + (CustMove * 7) + ((ijk - 1) * 3200))-(11100, 5300 + IIf(Strindex <> 1, 50, 0) + (CustMove * 7) + ((ijk - 1) * 3200))
                  '申請地址
                  m_Device.Line (1250, 5600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 8) + ((ijk - 1) * 3200))-(2450, 5600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 8) + ((ijk - 1) * 3200))
                  m_Device.Line (2550, 5600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 8) + ((ijk - 1) * 3200))-(11100, 5600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 8) + ((ijk - 1) * 3200))
                ElseIf OptChoose(1).Value = True Then
                  '申請地址(中文)
                  m_Device.Line (1900, 5300 + IIf(Strindex <> 1, 50, 0) + (CustMove * 7) + ((ijk - 1) * 3200))-(3350, 5300 + IIf(Strindex <> 1, 50, 0) + (CustMove * 7) + ((ijk - 1) * 3200))
                  m_Device.Line (3450, 5300 + IIf(Strindex <> 1, 50, 0) + (CustMove * 7) + ((ijk - 1) * 3200))-(11100, 5300 + IIf(Strindex <> 1, 50, 0) + (CustMove * 7) + ((ijk - 1) * 3200))
                  '申請地址(英文)
                  'm_Device.Line (1900, 5600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 8) + ((ijk - 1) * 3200))-(11100, 5600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 8) + ((ijk - 1) * 3200))
                  m_Device.Line (1200, 5600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 8) + ((ijk - 1) * 3200))-(11100, 5600 + IIf(Strindex <> 1, 50, 0) + (CustMove * 8) + ((ijk - 1) * 3200))
                End If
            End If
        Next ijk
End If
CustCol = 1
If Strindex = 1 And IsMutl = True Then
   If OptChoose(0).Value = True Then 'Modify By Sindy 2010/5/27因此位置要印FC代理人
      '多申請人
      m_Device.Font.Size = 9
      m_Device.CurrentX = 1400
      m_Device.CurrentY = 3250 + (CustMove * CustCol)
      m_Device.Print "(多申請人)"
      m_Device.Font.Size = 12
   End If
Else
   'CustCol = 1
   'add by nickc 2005/04/07 多申請人時，要加印
   'Modify By Sindy 2010/5/27
   m_Device.CurrentX = 400
'   If optChoose(0).Value = True Then
      m_Device.CurrentY = 3000 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 150, 0)
'   ElseIf optChoose(1).Value = True Then
'      CustCol = 1 + IIf(Strindex <> 1, 1, 0)
'      m_Device.CurrentY = 3200 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 150, 0)
'   End If
   Select Case Strindex
   Case 2
      Text1(298).Text = Text1(298).Text & "　　　　　　　　　　　　　　　"
      m_Device.Print "　　　　" & IIf(Option32(1).Value = True, "■", "□") & "舊　客　戶　　　　" & IIf(Option32(0).Value = True, "■", "□") & "新　客　戶（與  " & PUB_StrToStr(Text1(298).Text, 30) & "  為關係企業）"
   Case 3
      Text1(398).Text = Text1(398).Text & "　　　　　　　　　　　　　　　"
      m_Device.Print "　　　　" & IIf(Option33(1).Value = True, "■", "□") & "舊　客　戶　　　　" & IIf(Option33(0).Value = True, "■", "□") & "新　客　戶（與  " & PUB_StrToStr(Text1(398).Text, 30) & "  為關係企業）"
   Case 4
      Text1(498).Text = Text1(498).Text & "　　　　　　　　　　　　　　　"
      m_Device.Print "　　　　" & IIf(Option34(1).Value = True, "■", "□") & "舊　客　戶　　　　" & IIf(Option34(0).Value = True, "■", "□") & "新　客　戶（與  " & PUB_StrToStr(Text1(498).Text, 30) & "  為關係企業）"
   Case 5
      Text1(598).Text = Text1(598).Text & "　　　　　　　　　　　　　　　"
      m_Device.Print "　　　　" & IIf(Option35(1).Value = True, "■", "□") & "舊　客　戶　　　　" & IIf(Option35(0).Value = True, "■", "□") & "新　客　戶（與  " & PUB_StrToStr(Text1(598).Text, 30) & "  為關係企業）"
   Case Else
   End Select
End If
'CustCol = 2
CustCol = 2 + IIf(Strindex <> 1, 1, 0)
'客戶編號
m_Device.CurrentX = 0
m_Device.CurrentY = 3500 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 100, 0)
m_Device.Print "客戶編號： " & IIf(Strindex = 1, Text1(12).Text, IIf(Strindex = 2, Text1(28).Text, IIf(Strindex = 3, Text1(44).Text, IIf(Strindex = 4, Text1(60).Text, IIf(Strindex = 5, Text1(76).Text, "")))))
'接洽人
m_Device.CurrentX = 2550
m_Device.CurrentY = 3500 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 100, 0)
'Modify by Morgan 2008/8/1 接洽人改下拉選單
'Modify By Sindy 2009/10/29 若不是預設接洽人時,在前頭加上★符號
'm_Device.Print "接洽人：" & cboContact(Strindex)
Dim strCustID As String, strContNm As String
strCustID = IIf(Strindex = 1, Text1(12).Text, IIf(Strindex = 2, Text1(28).Text, IIf(Strindex = 3, Text1(44).Text, IIf(Strindex = 4, Text1(60).Text, IIf(Strindex = 5, Text1(76).Text, "")))))
strContNm = PUB_GetContact(strCustID, "", True)
If Trim(strContNm) <> "" Then
   m_Device.Print "接洽人：" & IIf(Trim(strContNm) <> Trim(cboContact(Strindex)), "★", "") & Trim(cboContact(Strindex))
Else
   m_Device.Print "接洽人：" & Trim(cboContact(Strindex))
End If
'2009/10/29 End

'Modify By Sindy 2010/5/27
If OptChoose(0).Value = True Then
   '電話
   m_Device.CurrentX = 4700
   m_Device.CurrentY = 3200 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 100, 0)
   'Modified by Lydia 2021/08/26 電話1=>電話
   'm_Device.Print "　　　" & IIf(Strindex = 1, "(1)" & Text1(14).Text, IIf(Strindex = 2, "(1)" & Text1(30).Text, IIf(Strindex = 3, "(1)" & Text1(46).Text, IIf(Strindex = 4, "(1)" & Text1(62).Text, IIf(Strindex = 5, "(1)" & Text1(78).Text, "")))))
   m_Device.Print "電話：" & IIf(Strindex = 1, Text1(14).Text, IIf(Strindex = 2, Text1(30).Text, IIf(Strindex = 3, Text1(46).Text, IIf(Strindex = 4, Text1(62).Text, IIf(Strindex = 5, Text1(78).Text, "")))))
   m_Device.CurrentX = 4700
   m_Device.CurrentY = 3500 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 100, 0)
   'Modified by Lydia 2021/08/26 電話2=>LINE ID ; 因為LINE ID可儲存50字, 但是列印最多20字,多出來的用...省略(讀取資料已處理)
   'm_Device.Print "LINE ID：" & IIf(Strindex = 1, "(2)" & Text1(15).Text, IIf(Strindex = 2, "(2)" & Text1(31).Text, IIf(Strindex = 3, "(2)" & Text1(47).Text, IIf(Strindex = 4, "(2)" & Text1(63).Text, IIf(Strindex = 5, "(2)" & Text1(79).Text, "")))))
   m_Device.Print "LINE ID：" & IIf(Strindex = 1, Text1(15).Text, IIf(Strindex = 2, Text1(31).Text, IIf(Strindex = 3, Text1(47).Text, IIf(Strindex = 4, Text1(63).Text, IIf(Strindex = 5, Text1(79).Text, "")))))

   '傳真
   m_Device.CurrentX = 8200 '7900
   m_Device.CurrentY = 3200 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 100, 0)
   m_Device.Print "傳真：" & IIf(Strindex = 1, Text1(16).Text, IIf(Strindex = 2, Text1(32).Text, IIf(Strindex = 3, Text1(48).Text, IIf(Strindex = 4, Text1(64).Text, IIf(Strindex = 5, Text1(80).Text, "")))))
   '手機
   m_Device.CurrentX = 8200 '7900
   m_Device.CurrentY = 3500 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 100, 0)
   m_Device.Print "手機：" & PUB_StrToStr(IIf(Strindex = 1, Text1(20).Text, IIf(Strindex = 2, Text1(36).Text, IIf(Strindex = 3, Text1(52).Text, IIf(Strindex = 4, Text1(68).Text, IIf(Strindex = 5, Text1(84).Text, ""))))), 20)
ElseIf OptChoose(1).Value = True Then
   '代理人編號
   m_Device.CurrentX = 0
   If Strindex = 1 Then
      m_Device.CurrentY = 3150 + (CustMove * CustCol) + intMoveCurrent '+ IIf(Strindex <> 1, 100, 0)
      m_Device.Print "代理人編號：" & Text1(5).Text
'   Else
'      m_Device.CurrentY = 2950 + (CustMove * CustCol) + intMoveCurrent '+ IIf(Strindex <> 1, 100, 0)
   End If
   '代理人
   m_Device.CurrentX = 2850
   If Strindex = 1 Then
      m_Device.CurrentY = 3150 + (CustMove * CustCol) + intMoveCurrent '+ IIf(Strindex <> 1, 100, 0)
      m_Device.Print "代理人：" & Text1(130).Text
'   Else
'      m_Device.CurrentY = 2950 + (CustMove * CustCol) + intMoveCurrent '+ IIf(Strindex <> 1, 100, 0)
   End If
   '國籍
   m_Device.CurrentX = 4700
   m_Device.CurrentY = 3500 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 100, 0)
   m_Device.Print "國籍：" & IIf(Strindex = 1, Text1(34).Text, IIf(Strindex = 2, Text1(50).Text, IIf(Strindex = 3, Text1(66).Text, IIf(Strindex = 4, Text1(82).Text, IIf(Strindex = 5, Text1(98).Text, "")))))
End If

CustCol = 3 + IIf(Strindex <> 1, 1, 0)
'客戶案號
m_Device.CurrentX = 0
m_Device.CurrentY = 3800 + (CustMove * CustCol) + intMoveCurrent '+ IIf(Strindex <> 1, 50, 0)
If IsLine = False Then
    'add by nick 2004/12/08
    If Trim(Text1(18).Text) <> "" Then m_Device.Font.Bold = True
    m_Device.Print "客戶案號： " & IIf(Strindex = 1, Text1(18).Text, "")
    'add by nick 2004/12/08
    m_Device.Font.Bold = False
Else
    m_Device.Print "ID.NO." & IIf(Strindex = 1, Text1(92).Text, IIf(Strindex = 2, Text1(93).Text, IIf(Strindex = 3, Text1(94).Text, IIf(Strindex = 4, Text1(95).Text, IIf(Strindex = 5, Text1(96).Text, "")))))
End If
'E-Mail
m_Device.CurrentX = 3300
m_Device.CurrentY = 3800 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 100, 0)
m_Device.Print "E-Mail：" & PUB_StrToStr(IIf(Strindex = 1, Text1(19).Text, IIf(Strindex = 2, Text1(35).Text, IIf(Strindex = 3, Text1(51).Text, IIf(Strindex = 4, Text1(67).Text, IIf(Strindex = 5, Text1(83).Text, ""))))), 50)

CustCol = 4.5 + IIf(Strindex <> 1, 1, 0)
'申請人(中文)
m_Device.CurrentX = 0
m_Device.CurrentY = 4250 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
m_Device.Print "申請人(中文)：" & PUB_StrToStr(IIf(Strindex = 1, Text1(21).Text, IIf(Strindex = 2, Text1(37).Text, IIf(Strindex = 3, Text1(53).Text, IIf(Strindex = 4, Text1(69).Text, IIf(Strindex = 5, Text1(85).Text, ""))))), 40)
'代表人或所屬機構
m_Device.CurrentX = 6700
m_Device.CurrentY = 4100 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
m_Device.Print "代表人或"
m_Device.CurrentX = 6700
m_Device.CurrentY = 4400 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
m_Device.Print "所屬機構"
m_Device.CurrentX = 7700
m_Device.CurrentY = 4250 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
m_Device.Print "(中文)：" & StrToStr(IIf(Strindex = 1, Text1(23).Text, IIf(Strindex = 2, Text1(39).Text, IIf(Strindex = 3, Text1(55).Text, IIf(Strindex = 4, Text1(71).Text, IIf(Strindex = 5, Text1(87).Text, ""))))), 20)
CustCol = 6 + IIf(Strindex <> 1, 1, 0)
'申請人(英文)
m_Device.CurrentX = 0
m_Device.CurrentY = 4700 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
m_Device.Print "　　　(英文)：" & PUB_StrToStr(IIf(Strindex = 1, Text1(22).Text, IIf(Strindex = 2, Text1(38).Text, IIf(Strindex = 3, Text1(54).Text, IIf(Strindex = 4, Text1(70).Text, IIf(Strindex = 5, Text1(86).Text, ""))))), 48)
m_Device.CurrentX = 7700
m_Device.CurrentY = 4700 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
m_Device.Print "(英文)：" & StrToStr(IIf(Strindex = 1, Text1(24).Text, IIf(Strindex = 2, Text1(40).Text, IIf(Strindex = 3, Text1(56).Text, IIf(Strindex = 4, Text1(72).Text, IIf(Strindex = 5, Text1(88).Text, ""))))), 22)
CustCol = 7 + IIf(Strindex <> 1, 1, 0)
'Modify By Sindy 2010/5/27
'國內
If OptChoose(0).Value = True Then
   '聯絡地址
   m_Device.CurrentX = 0
   m_Device.CurrentY = 5000 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
   m_Device.Print "聯絡地址：" & Right("　　　　　" & IIf(Strindex = 1, Text1(25).Text, IIf(Strindex = 2, Text1(41).Text, IIf(Strindex = 3, Text1(57).Text, IIf(Strindex = 4, Text1(73).Text, IIf(Strindex = 5, Text1(89).Text, ""))))), 5) & "　" & StrToStr(IIf(Strindex = 1, Text1(26).Text, IIf(Strindex = 2, Text1(42).Text, IIf(Strindex = 3, Text1(58).Text, IIf(Strindex = 4, Text1(74).Text, IIf(Strindex = 5, Text1(90).Text, ""))))), 35)
   CustCol = 8 + IIf(Strindex <> 1, 1, 0)
   '申請地址
   m_Device.CurrentX = 0
   m_Device.CurrentY = 5300 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
   'Add by Amy 2016/12/23 +if 判斷舊案是否有客戶地址但無案件地址
   If bolCusCAddr(Strindex) = True Then
      m_Device.Print "申請地址：" & "　　　　　　案件無中文地址但客戶檔有，請通知專業部補輸「案件中文地址」"
   Else
      'Modify By Sindy 2018/1/16 無中文地址帶英文地址
      If (Strindex = 1 And Text1(27).Text = "") Or _
         (Strindex = 2 And Text1(43).Text = "") Or _
         (Strindex = 3 And Text1(59).Text = "") Or _
         (Strindex = 4 And Text1(75).Text = "") Or _
         (Strindex = 5 And Text1(91).Text = "") Then
         If Len(IIf(Strindex = 1, Text1(125).Text, IIf(Strindex = 2, Text1(141).Text, IIf(Strindex = 3, Text1(157).Text, IIf(Strindex = 4, Text1(173).Text, IIf(Strindex = 5, Text1(189).Text, "")))))) > 70 Then
            m_Device.Font.Size = 10
         End If
         m_Device.Print "申請地址：" & IIf(Strindex = 1, Text1(125).Text, IIf(Strindex = 2, Text1(141).Text, IIf(Strindex = 3, Text1(157).Text, IIf(Strindex = 4, Text1(173).Text, IIf(Strindex = 5, Text1(189).Text, "")))))
         m_Device.Font.Size = 12
      Else
      '2018/1/16 END
         m_Device.Print "申請地址：" & Right("　　　　　" & IIf(Strindex = 1, Text1(120).Text, IIf(Strindex = 2, Text1(121).Text, IIf(Strindex = 3, Text1(122).Text, IIf(Strindex = 4, Text1(123).Text, IIf(Strindex = 5, Text1(124).Text, ""))))), 5) & "　" & IIf(m_AppAddrChange = True, "★", "") & StrToStr(IIf(Strindex = 1, Text1(27).Text, IIf(Strindex = 2, Text1(43).Text, IIf(Strindex = 3, Text1(59).Text, IIf(Strindex = 4, Text1(75).Text, IIf(Strindex = 5, Text1(91).Text, ""))))), 35)
      End If
   End If
'大至台
ElseIf OptChoose(1).Value = True Then
   '申請地址(中文)
   m_Device.CurrentX = 0
   m_Device.CurrentY = 5000 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
   'Add by Amy 2016/12/23 +if 判斷舊案是否有客戶地址但無案件地址
   If bolCusCAddr(Strindex) = True Then
      m_Device.Print "申請地址(中文)：" & "　　　　　　案件無中文地址但客戶檔有，請通知專業部補輸「案件中文地址」"
   Else
   m_Device.Print "申請地址(中文)：" & Right("　　　　　" & IIf(Strindex = 1, Text1(120).Text, IIf(Strindex = 2, Text1(121).Text, IIf(Strindex = 3, Text1(122).Text, IIf(Strindex = 4, Text1(123).Text, IIf(Strindex = 5, Text1(124).Text, ""))))), 5) & "　" & IIf(m_AppAddrChange = True, "★", "") & StrToStr(IIf(Strindex = 1, Text1(27).Text, IIf(Strindex = 2, Text1(43).Text, IIf(Strindex = 3, Text1(59).Text, IIf(Strindex = 4, Text1(75).Text, IIf(Strindex = 5, Text1(91).Text, ""))))), 35)
   End If
   CustCol = 8 + IIf(Strindex <> 1, 1, 0)
   '申請地址(英文)
   'Modify By Sindy 2010/7/6
   m_Device.CurrentX = 0
   m_Device.CurrentY = 5300 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
   m_Device.Print "英文地址：" '& IIf(Strindex = 1, Text1(125).Text, IIf(Strindex = 2, Text1(141).Text, IIf(Strindex = 3, Text1(157).Text, IIf(Strindex = 4, Text1(173).Text, IIf(Strindex = 5, Text1(189).Text, "")))))
   If Len(IIf(Strindex = 1, Text1(125).Text, IIf(Strindex = 2, Text1(141).Text, IIf(Strindex = 3, Text1(157).Text, IIf(Strindex = 4, Text1(173).Text, IIf(Strindex = 5, Text1(189).Text, "")))))) > 70 Then
      m_Device.Font.Size = 10
   End If
   m_Device.CurrentX = 1200
   m_Device.CurrentY = 5300 + (CustMove * CustCol) + intMoveCurrent + IIf(Strindex <> 1, 0, 0)
   m_Device.Print IIf(Strindex = 1, Text1(125).Text, IIf(Strindex = 2, Text1(141).Text, IIf(Strindex = 3, Text1(157).Text, IIf(Strindex = 4, Text1(173).Text, IIf(Strindex = 5, Text1(189).Text, "")))))
   m_Device.Font.Size = 12
End If
End Sub

'Added by Morgan 2022/1/26
Private Sub WordCustomer(Optional Strindex As Integer = 1, Optional IsLine As Boolean = False, Optional IsMutl As Boolean = False)
   Dim strPrtText As String, strPrtText2 As String
   
   If Strindex = 1 Then
      If OptChoose(0).Value = True Then
         If IsMutl = True Then
            '多申請人
            strPrtText = "(多申請人)"
         Else
            strPrtText = ""
         End If
         WordVarSet "多申請人", strPrtText
      End If
      '客戶編號
      WordVarSet "客戶編號", Text1(12).Text
      
   ElseIf Strindex = 2 Then
      If Option32(1).Value = True Then
         WordVarSet "□舊", "■舊", True
      Else
         WordVarSet "□新", "■新", True
      End If
      WordVarSet "關係企業2", Text1(298).Text
      WordVarSet "客戶編號2", Text1(28).Text
      
   ElseIf Strindex = 3 Then
      If Option33(1).Value = True Then
         WordVarSet "□舊", "■舊", True
      Else
         WordVarSet "□新", "■新", True
      End If
      WordVarSet "關係企業3", Text1(398).Text
      WordVarSet "客戶編號3", Text1(44).Text
   
   ElseIf Strindex = 4 Then
      If Option34(1).Value = True Then
         WordVarSet "□舊", "■舊", True
      Else
         WordVarSet "□新", "■新", True
      End If
      WordVarSet "關係企業4", Text1(498).Text
      WordVarSet "客戶編號4", Text1(60).Text
      
   ElseIf Strindex = 5 Then
      If Option35(1).Value = True Then
         WordVarSet "□舊", "■舊", True
      Else
         WordVarSet "□新", "■新", True
      End If
      WordVarSet "關係企業5", Text1(598).Text
      WordVarSet "客戶編號5", Text1(76).Text
   End If

   '接洽人
   Dim strCustID As String, strContNm As String
   strCustID = IIf(Strindex = 1, Text1(12).Text, IIf(Strindex = 2, Text1(28).Text, IIf(Strindex = 3, Text1(44).Text, IIf(Strindex = 4, Text1(60).Text, IIf(Strindex = 5, Text1(76).Text, "")))))
   strContNm = PUB_GetContact(strCustID, "", True)
   If Trim(strContNm) <> "" Then
      strPrtText = IIf(Trim(strContNm) <> Trim(cboContact(Strindex)), "★", "") & Trim(cboContact(Strindex))
   Else
      strPrtText = Trim(cboContact(Strindex))
   End If
   
   If Strindex = 1 Then
      WordVarSet "接洽人", strPrtText
   Else
      WordVarSet "接洽人" & Strindex, strPrtText
   End If

   '國內
   If OptChoose(0).Value = True Then
      '電話
      strPrtText = IIf(Strindex = 1, Text1(14).Text, IIf(Strindex = 2, Text1(30).Text, IIf(Strindex = 3, Text1(46).Text, IIf(Strindex = 4, Text1(62).Text, IIf(Strindex = 5, Text1(78).Text, "")))))
      If Strindex = 1 Then
         WordVarSet "電話", strPrtText
      Else
         WordVarSet "電話" & Strindex, strPrtText
      End If
      
      'LINE
      strPrtText = IIf(Strindex = 1, Text1(15).Text, IIf(Strindex = 2, Text1(31).Text, IIf(Strindex = 3, Text1(47).Text, IIf(Strindex = 4, Text1(63).Text, IIf(Strindex = 5, Text1(79).Text, "")))))
      If Strindex = 1 Then
         WordVarSet "LINE", strPrtText
      Else
         WordVarSet "LINE" & Strindex, strPrtText
      End If
      
      '傳真
      strPrtText = IIf(Strindex = 1, Text1(16).Text, IIf(Strindex = 2, Text1(32).Text, IIf(Strindex = 3, Text1(48).Text, IIf(Strindex = 4, Text1(64).Text, IIf(Strindex = 5, Text1(80).Text, "")))))
      If Strindex = 1 Then
         WordVarSet "傳真", strPrtText
      Else
         WordVarSet "傳真" & Strindex, strPrtText
      End If
      
      '手機
      strPrtText = PUB_StrToStr(IIf(Strindex = 1, Text1(20).Text, IIf(Strindex = 2, Text1(36).Text, IIf(Strindex = 3, Text1(52).Text, IIf(Strindex = 4, Text1(68).Text, IIf(Strindex = 5, Text1(84).Text, ""))))), 20)
      If Strindex = 1 Then
         WordVarSet "手機", strPrtText
      Else
         WordVarSet "手機" & Strindex, strPrtText
      End If
      
   ElseIf OptChoose(1).Value = True Then
      If Strindex = 1 Then
         '代理人編號
         WordVarSet "代理人編號", Text1(5).Text
         '代理人
         WordVarSet "代理人", Text1(130).Text
      End If
      '國籍
      strPrtText = IIf(Strindex = 1, Text1(34).Text, IIf(Strindex = 2, Text1(50).Text, IIf(Strindex = 3, Text1(66).Text, IIf(Strindex = 4, Text1(82).Text, IIf(Strindex = 5, Text1(98).Text, "")))))
      If Strindex = 1 Then
         WordVarSet "國籍", strPrtText
      Else
         WordVarSet "國籍" & Strindex, strPrtText
      End If
   End If

   '客戶案號
   If IsLine = False Then
      strPrtText = IIf(Strindex = 1, Text1(18).Text, "")
      WordVarSet "客戶案號", strPrtText
   Else
      'ID.NO. 統編
      strPrtText = IIf(Strindex = 1, Text1(92).Text, IIf(Strindex = 2, Text1(93).Text, IIf(Strindex = 3, Text1(94).Text, IIf(Strindex = 4, Text1(95).Text, IIf(Strindex = 5, Text1(96).Text, "")))))
      If Strindex = 1 Then
         WordVarSet "統編", strPrtText
      Else
         WordVarSet "統編" & Strindex, strPrtText
      End If
   End If
   
   'E-Mail
   strPrtText = PUB_StrToStr(IIf(Strindex = 1, Text1(19).Text, IIf(Strindex = 2, Text1(35).Text, IIf(Strindex = 3, Text1(51).Text, IIf(Strindex = 4, Text1(67).Text, IIf(Strindex = 5, Text1(83).Text, ""))))), 50)
   If Strindex = 1 Then
      WordVarSet "E-Mail", strPrtText
   Else
      WordVarSet "E-Mail" & Strindex, strPrtText
   End If
   
   '申請人(中文)
   strPrtText = PUB_StrToStr(IIf(Strindex = 1, Text1(21).Text, IIf(Strindex = 2, Text1(37).Text, IIf(Strindex = 3, Text1(53).Text, IIf(Strindex = 4, Text1(69).Text, IIf(Strindex = 5, Text1(85).Text, ""))))), 40)
   If Strindex = 1 Then
      WordVarSet "申請人-中", strPrtText
   Else
      WordVarSet "申請人-中" & Strindex, strPrtText
   End If
   
   '代表人或所屬機構
   strPrtText = StrToStr(IIf(Strindex = 1, Text1(23).Text, IIf(Strindex = 2, Text1(39).Text, IIf(Strindex = 3, Text1(55).Text, IIf(Strindex = 4, Text1(71).Text, IIf(Strindex = 5, Text1(87).Text, ""))))), 20)
   If Strindex = 1 Then
      WordVarSet "代表人-中", strPrtText
   Else
      WordVarSet "代表人-中" & Strindex, strPrtText
   End If

   '申請人(英文)
   strPrtText = PUB_StrToStr(IIf(Strindex = 1, Text1(22).Text, IIf(Strindex = 2, Text1(38).Text, IIf(Strindex = 3, Text1(54).Text, IIf(Strindex = 4, Text1(70).Text, IIf(Strindex = 5, Text1(86).Text, ""))))), 48)
   If Strindex = 1 Then
      WordVarSet "申請人-英", strPrtText
   Else
      WordVarSet "申請人-英" & Strindex, strPrtText
   End If

   '代表人(英文)
   strPrtText = StrToStr(IIf(Strindex = 1, Text1(24).Text, IIf(Strindex = 2, Text1(40).Text, IIf(Strindex = 3, Text1(56).Text, IIf(Strindex = 4, Text1(72).Text, IIf(Strindex = 5, Text1(88).Text, ""))))), 22)
   If Strindex = 1 Then
      WordVarSet "代表人-英", strPrtText
   Else
      WordVarSet "代表人-英" & Strindex, strPrtText
   End If
   
   '國內
   If OptChoose(0).Value = True Then
      '聯絡地址
      '郵遞區號
      strPrtText = IIf(Strindex = 1, Text1(25).Text, IIf(Strindex = 2, Text1(41).Text, IIf(Strindex = 3, Text1(57).Text, IIf(Strindex = 4, Text1(73).Text, IIf(Strindex = 5, Text1(89).Text, "")))))
      If Strindex = 1 Then
         WordVarSet "聯遞", strPrtText
      Else
         WordVarSet "聯遞" & Strindex, strPrtText
      End If
      '地址
      strPrtText = IIf(Strindex = 1, Text1(26).Text, IIf(Strindex = 2, Text1(42).Text, IIf(Strindex = 3, Text1(58).Text, IIf(Strindex = 4, Text1(74).Text, IIf(Strindex = 5, Text1(90).Text, "")))))
      If Strindex = 1 Then
         WordVarSet "聯絡地址", strPrtText
      Else
         WordVarSet "聯絡地址" & Strindex, strPrtText
      End If
   
      '申請地址
      '判斷舊案是否有客戶地址但無案件地址
      If bolCusCAddr(Strindex) = True Then
         strPrtText = ""
         strPrtText2 = "案件無中文地址但客戶檔有，請通知專業部補輸「案件中文地址」"
      Else
         '無中文地址帶英文地址
         If (Strindex = 1 And Text1(27).Text = "") Or _
            (Strindex = 2 And Text1(43).Text = "") Or _
            (Strindex = 3 And Text1(59).Text = "") Or _
            (Strindex = 4 And Text1(75).Text = "") Or _
            (Strindex = 5 And Text1(91).Text = "") Then
            strPrtText = ""
            strPrtText2 = IIf(Strindex = 1, Text1(125).Text, IIf(Strindex = 2, Text1(141).Text, IIf(Strindex = 3, Text1(157).Text, IIf(Strindex = 4, Text1(173).Text, IIf(Strindex = 5, Text1(189).Text, "")))))
         Else
            strPrtText = IIf(Strindex = 1, Text1(120).Text, IIf(Strindex = 2, Text1(121).Text, IIf(Strindex = 3, Text1(122).Text, IIf(Strindex = 4, Text1(123).Text, IIf(Strindex = 5, Text1(124).Text, "")))))
            strPrtText2 = IIf(m_AppAddrChange = True, "★", "") & StrToStr(IIf(Strindex = 1, Text1(27).Text, IIf(Strindex = 2, Text1(43).Text, IIf(Strindex = 3, Text1(59).Text, IIf(Strindex = 4, Text1(75).Text, IIf(Strindex = 5, Text1(91).Text, ""))))), 35)
         End If
      End If
      
      '郵遞區號
      If Strindex = 1 Then
         WordVarSet "申遞", strPrtText
      Else
         WordVarSet "申遞" & Strindex, strPrtText
      End If
      '地址
      If Strindex = 1 Then
         WordVarSet "申請地址", strPrtText2
      Else
         WordVarSet "申請地址" & Strindex, strPrtText2
      End If

   '大至台
   ElseIf OptChoose(1).Value = True Then
   
      '申請地址(中文)
      '判斷舊案是否有客戶地址但無案件地址
      If bolCusCAddr(Strindex) = True Then
         strPrtText = ""
         strPrtText2 = "案件無中文地址但客戶檔有，請通知專業部補輸「案件中文地址」"
      Else
         strPrtText = IIf(Strindex = 1, Text1(120).Text, IIf(Strindex = 2, Text1(121).Text, IIf(Strindex = 3, Text1(122).Text, IIf(Strindex = 4, Text1(123).Text, IIf(Strindex = 5, Text1(124).Text, "")))))
         strPrtText2 = IIf(m_AppAddrChange = True, "★", "") & StrToStr(IIf(Strindex = 1, Text1(27).Text, IIf(Strindex = 2, Text1(43).Text, IIf(Strindex = 3, Text1(59).Text, IIf(Strindex = 4, Text1(75).Text, IIf(Strindex = 5, Text1(91).Text, ""))))), 35)
      End If
      
      '郵遞區號
      If Strindex = 1 Then
         WordVarSet "申遞", strPrtText
      Else
         WordVarSet "申遞" & Strindex, strPrtText
      End If
      '申請地址(中文)
      If Strindex = 1 Then
         WordVarSet "申請地址", strPrtText2
      Else
         WordVarSet "申請地址" & Strindex, strPrtText2
      End If
      
      '申請地址(英文)
      'Modified by Morgan 2022/6/16 修正設錯變數問題
      'strPrtText = IIf(Strindex = 1, Text1(125).Text, IIf(Strindex = 2, Text1(141).Text, IIf(Strindex = 3, Text1(157).Text, IIf(Strindex = 4, Text1(173).Text, IIf(Strindex = 5, Text1(189).Text, "")))))
      strPrtText2 = IIf(Strindex = 1, Text1(125).Text, IIf(Strindex = 2, Text1(141).Text, IIf(Strindex = 3, Text1(157).Text, IIf(Strindex = 4, Text1(173).Text, IIf(Strindex = 5, Text1(189).Text, "")))))
      'end 2022/6/16
      If Strindex = 1 Then
         WordVarSet "申請地址-英", strPrtText2
      Else
         WordVarSet "申請地址-英" & Strindex, strPrtText2
      End If
   End If
End Sub

'接洽單下方:案件說明事項處理情形
'add by nick 2004/07/12
'其他下方資料
' IsMain 是總公司嗎  false = 分所 'Removed by Morgan 2022/2/23 沒用了
'Modify By Sindy 2015/8/28 + intPrintCnt As Integer
Private Sub PrintDetail(intPrintCnt As Integer)

'Added by Morgan 2022/1/26
Dim strPrtText As String, strVarName As String
If m_bWordFormat Then
   WordDetail intPrintCnt
End If
'end 2022/1/26

Dim DetailCol As Integer '行
'全部往下移多少
Dim AllCustMove As Integer
Dim intWidth As Integer, intHeight As Integer, dblXX As Double '等比例縮放
Dim intMidWidth As Integer, intMidHeight As Integer, strPicText(1 To 7) As String
Dim intLen As Integer, intLine As Integer, strWord As String, strMainText As String
Dim intFontSize As Integer
Dim arrNA01 'Add By Sindy 2012/10/4
Dim intRow As Integer 'Add by Amy 2014/10/08
Dim rowMax As Integer 'Added by Lydia 2016/08/24 明細列最大列數
Dim inPrt As Integer 'Added by Lydia 2016/08/24 目前已列印的列數
Dim nMemo As Integer 'Added by Lydia 2017/06/19 頁尾備註的行數(業務備註,特殊客戶)
Dim nInventorR As Integer 'Added by Lydia 2017/06/19 發明人在明細的位置

'Added by Morgan 2022/2/23
If m_bWordFormat Then
   strVarName = "說明事項"
Else
'end 2022/2/23

   AllCustMove = (CustMove * 8) + 50
   DetailCol = 1
   m_Device.Font.Name = "標楷體"
   m_Device.Font.Size = 12
   '列框
   m_Device.Line (50, 5600 + (CustMove * DetailCol) + AllCustMove)-(11175, 15750), , B
   m_Device.Line (50, 5600 + (CustMove * DetailCol) + AllCustMove)-(375, 15750), , B
   m_Device.Line (50, 5600 + (CustMove * DetailCol) + AllCustMove)-(11175, 6850 + (CustMove * 4) + AllCustMove), , B
   m_Device.Line (50, 5600 + (CustMove * DetailCol) + AllCustMove)-(11175, 8950 + (CustMove * 11) + AllCustMove), , B
   m_Device.Line (375, 5600 + (CustMove * DetailCol) + AllCustMove)-(375, 15750)
   m_Device.Line (5760, 5900 + (CustMove * DetailCol) + AllCustMove)-(5760, 6875 + (CustMove * 4) + AllCustMove)
   m_Device.Line (50, 6850 + (CustMove * 4) + AllCustMove)-(11175, 6850 + (CustMove * 4) + AllCustMove)
   m_Device.Line (375, 5900 + (CustMove * 1) + AllCustMove)-(11175, 5900 + (CustMove * 1) + AllCustMove)
   m_Device.Line (5885, 5800 + (CustMove * 2) + AllCustMove)-(9400, 5800 + (CustMove * 2) + AllCustMove)
   m_Device.Line (375, 6300 + (CustMove * 2) + AllCustMove)-(11175, 6300 + (CustMove * 2) + AllCustMove)
   m_Device.Line (1300, 6800 + (CustMove * 4) + AllCustMove)-(5200, 6800 + (CustMove * 4) + AllCustMove)
   m_Device.Line (7300, 6650 + (CustMove * 4) + AllCustMove)-(9500, 6650 + (CustMove * 4) + AllCustMove)
   m_Device.Line (700, 6875 + (CustMove * 4) + AllCustMove)-(700, 8050 + (CustMove * 8) + AllCustMove)
   m_Device.Line (3050, 6875 + (CustMove * 4) + AllCustMove)-(3050, 8050 + (CustMove * 8) + AllCustMove)
   m_Device.Line (3400, 6875 + (CustMove * 4) + AllCustMove)-(3400, 8050 + (CustMove * 8) + AllCustMove)
   m_Device.Line (5760, 6875 + (CustMove * 4) + AllCustMove)-(5760, 8050 + (CustMove * 8) + AllCustMove)
   m_Device.Line (6100, 6875 + (CustMove * 4) + AllCustMove)-(6100, 8050 + (CustMove * 8) + AllCustMove)
   m_Device.Line (8600, 6875 + (CustMove * 4) + AllCustMove)-(8600, 8050 + (CustMove * 8) + AllCustMove)
   m_Device.Line (8600, 7200 + (CustMove * 5) + AllCustMove)-(11175, 7200 + (CustMove * 5) + AllCustMove)
   m_Device.Line (375, 8050 + (CustMove * 8) + AllCustMove)-(11175, 8050 + (CustMove * 8) + AllCustMove)
   m_Device.Line (7300, 8400 + (CustMove * 9) + AllCustMove)-(11150, 8400 + (CustMove * 9) + AllCustMove)
   m_Device.Line (1200, 8650 + (CustMove * 10) + AllCustMove)-(2900, 8650 + (CustMove * 10) + AllCustMove)

   DetailCol = 1

   '□Uot
   '案件來源說明
   m_Device.Font.Size = 10
   m_Device.CurrentX = 75
   m_Device.CurrentY = 5650 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "案"
   m_Device.CurrentX = 75
   m_Device.CurrentY = 5850 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "件"
   m_Device.CurrentX = 75
   m_Device.CurrentY = 6050 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "來"
   m_Device.CurrentX = 75
   m_Device.CurrentY = 6250 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "源"
   m_Device.CurrentX = 75
   m_Device.CurrentY = 6450 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "說"
   m_Device.CurrentX = 75
   m_Device.CurrentY = 6650 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "明"
   '收費
   m_Device.Font.Size = 12
   m_Device.CurrentX = 50
   m_Device.CurrentY = 7425 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "收"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 9125 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "費"
   '案件說明事項處理情形
   m_Device.CurrentX = 50
   m_Device.CurrentY = 10150 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "案"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 10450 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "件"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 10750 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "說"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 11050 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "明"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 11350 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "事"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 11650 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "項"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 11950 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "處"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 12250 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "理"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 12550 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "情"
   m_Device.CurrentX = 50
   m_Device.CurrentY = 12850 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "形"
   '□U
   '新客戶
   m_Device.CurrentX = 400
   m_Device.CurrentY = 5625 + (CustMove * DetailCol) + AllCustMove

   Text1(198).Text = Text1(198).Text & "　　　　　　　　　　　　　　　"
   m_Device.Print "　　　　" & IIf(Option31(1).Value = True, "■", "□") & "舊　客　戶　　　　" & IIf(Option31(0).Value = True, "■", "□") & "新　客　戶（與  " & PUB_StrToStr(Text1(198).Text, 30) & "  為關係企業）"

   DetailCol = 2
   '主動開拓
   m_Device.CurrentX = 400
   m_Device.CurrentY = 5950 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print IIf(Option4(0).Value = True, "■", "□") & "主動開拓"
   '自動來所
   m_Device.CurrentX = 3600
   m_Device.CurrentY = 5950 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print IIf(Option4(3).Value = True, "■", "□") & "自動來所"
   '其他
   m_Device.CurrentX = 5800
   m_Device.CurrentY = 5950 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "其他："
   m_Device.FontBold = True
   m_Device.CurrentX = 5800 + m_Device.TextWidth("其他：")
   m_Device.CurrentY = 5950 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print PUB_StrToStr(Text1(99).Text, 34)
   m_Device.FontBold = False
   DetailCol = 3
   '客戶
   m_Device.CurrentX = 400
   m_Device.CurrentY = 6300 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print IIf(Option4(1).Value = True, "■", "□") & "客戶"
   
   '☆本案與總號
   m_Device.CurrentX = 5800
   m_Device.CurrentY = 6400 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "☆本案與總號    " & Text1(100).Text
   m_Device.CurrentX = 9550
   m_Device.CurrentY = 6400 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print IIf(Option5(0).Value = True, "■", "□") & "相同 " & IIf(Option5(1).Value = True, "■", "□") & "有關"
   
   DetailCol = 4
   '同仁
   m_Device.CurrentX = 400
   m_Device.CurrentY = 6550 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print IIf(Option4(2).Value = True, "■", "□") & "同仁    "
   m_Device.FontBold = True
   m_Device.CurrentX = 400 + m_Device.TextWidth(IIf(Option4(2).Value = True, "■", "□") & "同仁    ")
   m_Device.CurrentY = 6550 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print Text1(97).Text
   m_Device.FontBold = False
   m_Device.CurrentX = 5250
   m_Device.CurrentY = 6550 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "介紹"
   
   DetailCol = 8
   '費用
   DetailCol = 5.5
   m_Device.CurrentX = 400
   m_Device.CurrentY = 7125 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "費"
   DetailCol = 7.5
   m_Device.CurrentX = 400
   m_Device.CurrentY = 7525 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "用"
   '填入費用金額
   'Modify by Amy 2014/10/23 +T大陸分割
   If Is307or308 = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
       '分割費用印於子案
       If (Is308New = True Or Is308Old = True) And Is308Child = True Then
           m_Device.CurrentX = 725
           m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
           m_Device.Print IIf(Text1(101 + (intCN308Field - 1) * 3).Text = "", "", "(1) " & Text1(101 + (intCN308Field - 1) * 3).Text)
       '母案分割費用0
       Else
           intRow = 1
           For iiiii = 1 To 4
               m_Device.CurrentX = 725
               Select Case intRow
                   Case 1
                       m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
                   Case 2
                       m_Device.CurrentY = 6950 + (CustMove * DetailCol) + AllCustMove
                   Case 3
                       m_Device.CurrentY = 7300 + (CustMove * DetailCol) + AllCustMove
                   Case 4
                       m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
               End Select
               If iiiii = intCN308Field Then
                   m_Device.Print "(" & iiiii & ") 0"
               Else
                   m_Device.Print IIf(Text1(101 + (iiiii - 1) * 3).Text = "", "", "(" & iiiii & ") " & Text1(101 + (iiiii - 1) * 3).Text)
               End If
               intRow = intRow + 1
           Next iiiii
       End If
   
   'edit by nickc 2008/02/13  改成子案不印
   ElseIf (Is307or308 = True And NowCount = 0 And Is308Old = True) Or Is307or308 = False Then
       m_Device.CurrentX = 725
       m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(101).Text = "", "", "(1) " & Text1(101).Text)
       m_Device.CurrentX = 725
       m_Device.CurrentY = 6950 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(104).Text = "", "", "(2) " & Text1(104).Text)
       m_Device.CurrentX = 725
       m_Device.CurrentY = 7300 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(107).Text = "", "", "(3) " & Text1(107).Text)
       m_Device.CurrentX = 725
       m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(110).Text = "", "", "(4) " & Text1(110).Text)
   'add by nickc 2005/05/27
   ElseIf Is308New = True And Is308Child = False Then
       m_Device.CurrentX = 725
       m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(101).Text = "", "", "(1) " & Text1(101).Text)
   'edit by nickc 2008/02/13  改成子案不印
       m_Device.CurrentX = 725
       m_Device.CurrentY = 6950 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(104).Text = "", "", "(2) " & Text1(104).Text)
       m_Device.CurrentX = 725
       m_Device.CurrentY = 7300 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(107).Text = "", "", "(3) " & Text1(107).Text)
       m_Device.CurrentX = 725
       m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(110).Text = "", "", "(4) " & Text1(110).Text)
   End If
   
   '規費
   DetailCol = 5.5
   m_Device.CurrentX = 3100
   m_Device.CurrentY = 7125 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "規"
   DetailCol = 7.5
   m_Device.CurrentX = 3100
   m_Device.CurrentY = 7525 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "費"
   'Modify by Amy 2014/10/23 +T大陸分割
   If Is307or308 = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
       '分割費用印於子案
       If (Is308New = True Or Is308Old = True) And Is308Child = True Then
           m_Device.CurrentX = 3425
           m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
           m_Device.Print IIf(Text1(102 + (intCN308Field - 1) * 3).Text = "", "", "(1) " & Text1(102 + (intCN308Field - 1) * 3).Text)
       '母案分割規費0
       Else
           intRow = 1
           For iiiii = 1 To 4
               m_Device.CurrentX = 3425
               Select Case intRow
                   Case 1
                       m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
                   Case 2
                       m_Device.CurrentY = 6950 + (CustMove * DetailCol) + AllCustMove
                   Case 3
                       m_Device.CurrentY = 7300 + (CustMove * DetailCol) + AllCustMove
                   Case 4
                       m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
               End Select
               If iiiii = intCN308Field Then
                   m_Device.Print "(" & iiiii & ") 0"
               Else
                   m_Device.Print IIf(Text1(102 + (iiiii - 1) * 3).Text = "", "", "(" & iiiii & ") " & Text1(102 + (iiiii - 1) * 3).Text)
               End If
               intRow = intRow + 1
           Next iiiii
       End If
   'edit by nickc 2008/02/13  改成子案不印
   ElseIf (Is307or308 = True And NowCount = 0 And Is308Old = True) Or Is307or308 = False Then
       '填入規費金額
       m_Device.CurrentX = 3425
       m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(102).Text = "", "", "(1) " & Text1(102).Text & IIf(bolRuleFeeErr = True, "★", ""))
       m_Device.CurrentX = 3425
       m_Device.CurrentY = 6950 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(105).Text = "", "", "(2) " & Text1(105).Text)
       m_Device.CurrentX = 3425
       m_Device.CurrentY = 7300 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(108).Text = "", "", "(3) " & Text1(108).Text)
       m_Device.CurrentX = 3425
       m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(111).Text = "", "", "(4) " & Text1(111).Text)
   'add by nickc 2005/05/27
   ElseIf Is308New = True And Is308Child = False Then
       '填入規費金額
       m_Device.CurrentX = 3425
       m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(102).Text = "", "", "(1) " & Text1(102).Text & IIf(bolRuleFeeErr = True, "★", ""))
   'edit by nickc 2008/02/13  改成子案不印
       m_Device.CurrentX = 3425
       m_Device.CurrentY = 6950 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(105).Text = "", "", "(2) " & Text1(105).Text)
       m_Device.CurrentX = 3425
       m_Device.CurrentY = 7300 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(108).Text = "", "", "(3) " & Text1(108).Text)
       m_Device.CurrentX = 3425
       m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(111).Text = "", "", "(4) " & Text1(111).Text)
   End If
   
   '點數
   DetailCol = 5.5
   m_Device.CurrentX = 5800
   m_Device.CurrentY = 7125 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "點"
   DetailCol = 7.5
   m_Device.CurrentX = 5800
   m_Device.CurrentY = 7525 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "數"
   'Modify by Amy 2014/10/23 +填入點數-T大陸分割
   If Is307or308 = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
       '分割費用印於子案
       If (Is308New = True Or Is308Old = True) And Is308Child = True Then
           m_Device.CurrentX = 6125
           m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
           m_Device.Print IIf(Text1(103 + (intCN308Field - 1) * 3).Text = "", "", "(1) " & Text1(103 + (intCN308Field - 1) * 3).Text)
       '母案分割點數0
       Else
           intRow = 1
           For iiiii = 1 To 4
               m_Device.CurrentX = 6125
               Select Case intRow
                   Case 1
                       m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
                   Case 2
                       m_Device.CurrentY = 6950 + (CustMove * DetailCol) + AllCustMove
                   Case 3
                       m_Device.CurrentY = 7300 + (CustMove * DetailCol) + AllCustMove
                   Case 4
                       m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
               End Select
               If iiiii = intCN308Field Then
                   m_Device.Print "(" & iiiii & ") 0"
               Else
                   m_Device.Print IIf(Text1(103 + (iiiii - 1) * 3).Text = "", "", "(" & iiiii & ") " & Text1(103 + (iiiii - 1) * 3).Text)
               End If
               intRow = intRow + 1
           Next iiiii
       End If
   'edit by nickc 2008/02/13  改成子案不印
   ElseIf (Is307or308 = True And NowCount = 0 And Is308Old = True) Or Is307or308 = False Then
       '填入點數
       m_Device.CurrentX = 6125
       m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(103).Text = "", "", "(1) " & Text1(103).Text) & IIf(Combo2(0).Text = "", "", "(" & Combo2(0).Text & ")")
       m_Device.CurrentX = 6125
       m_Device.CurrentY = 6950 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(106).Text = "", "", "(2) " & Text1(106).Text) & IIf(Combo2(1).Text = "", "", "(" & Combo2(1).Text & ")")
       m_Device.CurrentX = 6125
       m_Device.CurrentY = 7300 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(109).Text = "", "", "(3) " & Text1(109).Text) & IIf(Combo2(2).Text = "", "", "(" & Combo2(2).Text & ")")
       m_Device.CurrentX = 6125
       m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(112).Text = "", "", "(4) " & Text1(112).Text) & IIf(Combo2(3).Text = "", "", "(" & Combo2(3).Text & ")")
   'add by nickc 2005/05/27
   ElseIf Is308New = True And Is308Child = False Then
       '填入點數
       m_Device.CurrentX = 6125
       m_Device.CurrentY = 6600 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(103).Text = "", "", "(1) " & Text1(103).Text) & IIf(Combo2(0).Text = "", "", "(" & Combo2(0).Text & ")")
   'edit by nickc 2008/02/13  改成子案不印
       m_Device.CurrentX = 6125
       m_Device.CurrentY = 6950 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(106).Text = "", "", "(2) " & Text1(106).Text) & IIf(Combo2(1).Text = "", "", "(" & Combo2(1).Text & ")")
       m_Device.CurrentX = 6125
       m_Device.CurrentY = 7300 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(109).Text = "", "", "(3) " & Text1(109).Text) & IIf(Combo2(2).Text = "", "", "(" & Combo2(2).Text & ")")
       m_Device.CurrentX = 6125
       m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
       m_Device.Print IIf(Text1(112).Text = "", "", "(4) " & Text1(112).Text) & IIf(Combo2(3).Text = "", "", "(" & Combo2(3).Text & ")")
   End If
   DetailCol = 5
   '後金
   m_Device.CurrentX = 8650
   m_Device.CurrentY = 6900 + (CustMove * DetailCol) + AllCustMove
   'edit by nickc 2008/02/13 子案不印
   If (Is307or308 = True And NowCount = 0) Or Is307or308 = False Then
      m_Device.Print "後金：" & Text1(113).Text
   Else
      m_Device.Print "後金："
   End If
   DetailCol = 6
   '手開收據編號
   m_Device.CurrentX = 8650
   m_Device.CurrentY = 7250 + (CustMove * DetailCol) + AllCustMove
   'Modify By Sindy 2012/11/12
   m_Device.Print "收據自動列印時間點：" '手開收據編號
   m_Device.CurrentX = 8650
   m_Device.CurrentY = 7650 + (CustMove * DetailCol) + AllCustMove
   'm_Device.Print Text1(114).Text
   m_Device.Print IIf(Check8(0).Value = 1, Check8(0).Caption, IIf(Check8(1).Value = 1, Check8(1).Caption, IIf(Check8(2).Value = 1, Check8(2).Caption, "")))
   '2012/11/12 End
   DetailCol = 9
   '收據抬頭
   m_Device.CurrentX = 400
   m_Device.CurrentY = 8100 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "收據抬頭：" & IIf(Option2(0).Value = True, "■", "□") & "同申請人"
   
   'add by nickc 2005/03/11 郭 加 debit note 請款
   m_Device.CurrentX = 3050
   m_Device.CurrentY = 8100 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print IIf(Option2(2).Value = True, "■", "□") & "以 DEBIT NOTE 請款"
   m_Device.CurrentX = 5650
   m_Device.CurrentY = 8100 + (CustMove * DetailCol) + AllCustMove
   'edit by nickc 2005/03/30 薛說要改
   'Modified by Lydia 2021/03/12 選"其他"或"以Debit Note請款"都增加列印收據抬頭內容。ex.CFP-32296之異同分析
   'm_Device.Print IIf(Option2(1).Value = True, "■", "□") & "其他 　　　" & IIf(Option2(1).Value = True, cboTitle.Text, "")
   m_Device.Print IIf(Option2(1).Value = True, "■", "□") & "其他 　　　" & IIf(Option2(1).Value = True Or Option2(2).Value = True, cboTitle.Text, "")
   
   m_Device.Font.Size = 7
   m_Device.CurrentX = 6400
   m_Device.CurrentY = 8200 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "(請寫全銜)"
   m_Device.Font.Size = 12
   DetailCol = 10
   m_Device.CurrentX = 400
   m_Device.CurrentY = 8400 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "□現金  " & Text1(116).Text
   m_Device.CurrentX = 400
   m_Device.CurrentY = 8400 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print IIf(Check6(0).Value = 1, "■", "□") & "現金  " & Text1(116).Text
   
   m_Device.CurrentX = 3050
   m_Device.CurrentY = 8400 + (CustMove * DetailCol) + AllCustMove
   If Trim(Text1(117).Text) = "" Then
       'edit by nick 2004/12/01 加入印花
       m_Device.Print IIf(Check6(1).Value = 1, "■", "□") & "支票  (到期日：　   　年　  　月　  　日)" & IIf(Check1.Value = 1, "　　請貼印花", "")
   Else
       'edit by nick 2004/12/01 加入印花
       m_Device.Print IIf(Check6(1).Value = 1, "■", "□") & "支票  (到期日：　" & Mid(Text1(117).Text, 1, Len(Text1(117).Text) - 4) & "　年　" & IIf(Text1(117).Text = "", "  ", Trim(Val(Left(Right(Text1(117).Text, 4), 2)))) & "　月　" & IIf(Text1(117).Text = "", "  ", Trim(Val(Right(Text1(117).Text, 2)))) & "　日)" & IIf(Check1.Value = 1, "　　請貼印花", "")
   End If
   'Add By Sindy 2014/2/20 特殊收據要改粗體
   If Check9.Value = 1 Then
      m_Device.CurrentX = 9700
      m_Device.CurrentY = 8400 + (CustMove * DetailCol) + AllCustMove
      m_Device.FontBold = True
      m_Device.Print "　　特殊收據"
      m_Device.FontBold = False
   End If
   '2014/2/20 END
   DetailCol = 11
   '預定收款日
   'Remove by Lydia 2018/08/22 (應收帳款管控)取消預定收款日,改成付款週期
   'm_Device.CurrentX = 400
   'm_Device.CurrentY = 8700 + (CustMove * DetailCol) + AllCustMove
   'm_Device.Print "預定收款日期：" & Text1(118).Text
   'end 2018/08/22
   'id. no.
   m_Device.FontBold = True
   m_Device.CurrentX = 3500
   m_Device.CurrentY = 8700 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "ID.NO.  " & Text1(92).Text
   m_Device.FontBold = False
   
   'Add By Sindy 2010/4/15
   m_Device.CurrentX = 6500
   m_Device.CurrentY = 8700 + (CustMove * DetailCol) + AllCustMove
   m_Device.FontBold = True   '2014/3/27 甄妮說加黑
   'Modify By Sindy 2014/11/7
   'm_Device.Print IIf(Combo4.ListIndex = 0, "", "收據公司：" & Combo4.List(Combo4.ListIndex))
   m_Device.Print "收據公司：" & Combo4.List(Combo4.ListIndex)
   '2014/11/7 END
   m_Device.FontBold = False
   m_Device.CurrentX = 9000
   m_Device.CurrentY = 8700 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print IIf(Check2.Value = 1, "■", "□") & "收據暫不列印"
   
End If 'Added by Morgan 2022/2/23

DetailCol = 11
'事項說明文字
'字串
Dim DetailCase As String
'行數
Dim PrintDetailTxt As Variant
Dim PrintDetailTxt2 As String
'定義寬度字數
Dim PrintWidthWord As Integer

'Modify By Sindy 2009/08/31
'If IsMain = False Then'分所
If tmpImg.Picture <> 0 And SSTab1.TabEnabled(4) = True Then
    '有圖檔時
    PrintWidthWord = 48
Else
    PrintWidthWord = 74
End If

'Add by Morgan 2011/1/14 原程式抽出寫成 GetCRL57 以便共用
If m_strCRL57 = "" Then
   m_strCRL57 = GetCRL57
End If
DetailCase = m_strCRL57
'end 2011/1/14
''Add by Amy 2016/09/01 本所客戶為對造時,印「對造為本所客戶陳報資料 」,但不寫入CRL57
'If m_stCRL134 <> MsgText(601) Then
'    DetailCase = Replace(DetailCase, "<m_stCRL134>", "已向 " & Mid(m_stCRL134, InStr(m_stCRL134, " ") + 1) & " 陳報可辦理" & vbCrLf)
'    'Modified by Lydia 2020/05/05 配合「法律所案源收文」寫入CRL57; 當時為何不寫入CRL57,已無法確認
'    'm_strCRL57 = Replace(m_strCRL57, "<m_stCRL134>", "")
'    m_strCRL57 = Replace(m_strCRL57, "<m_stCRL134>", "已向 " & Mid(m_stCRL134, InStr(m_stCRL134, " ") + 1) & " 陳報可辦理" & vbCrLf)
'End If
'If m_stCRL135 <> MsgText(601) Then
'    DetailCase = Replace(DetailCase, "<m_stCRL135>", "原　　因：" & m_stCRL135 & vbCrLf)
'    'Modified by Lydia 2020/05/05 配合「法律所案源收文」寫入CRL57; 當時為何不寫入CRL57,已無法確認
'    'm_strCRL57 = Replace(m_strCRL57, "<m_stCRL135>", "")
'    m_strCRL57 = Replace(m_strCRL57, "<m_stCRL135>", "原　　因：" & m_stCRL135 & vbCrLf)
'End If
''end 2016/09/01

''Added by Morgan 2020/5/20
''法律所補充說明
'If Text6 <> "" Then
'   DetailCase = DetailCase & vbCrLf & "法律所補充說明：" & Text6 & vbCrLf
'End If
''end 2020/5/20

'Added by Lydia 2021/02/24 大陸商標申請案及CFT申請案，均強迫填入相關資訊。
If Text7.Text <> "" And Frame47.Visible = True Then
   DetailCase = DetailCase & vbCrLf & fra47Title.Caption & Text7 & vbCrLf
End If
'end 2021/02/21

'Modify by 2014/10/23 由GetCRL57搬出來,並修改
'Modify By Sindy 2014/8/6 從下層Move進來
If Is308Child = True And Not (Is308New = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T") Then
    DetailCase = DetailCase & "母案案號：" & IIf(Option1(1).Value = True, Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text, Text1(6).Text & "-") & vbCrLf
End If
'2014/8/6 END

'Added by Lydia 2019/11/05 特定申請人會稿案件: 於紀錄單顯示業務備註:此申請人要會稿，故須交工程師處理的文字。
If Frame45.Visible = True And Text1(6).Text = "P" And Trim(Left(Combo1(0), 4)) = "020" And Opt45(0).Value = True Then
    'Modified by Lydia 2020/02/26 改備註, 強調
    'DetailCase = DetailCase & "★" & "此申請人要會稿，故須交工程師處理" & vbCrLf
    DetailCase = DetailCase & "★" & "此申請人要會簡體版說明書，故須交工程師處理" & vbCrLf
End If

'Added by Morgan 2021/7/20
If Frame48.Visible = True Then
   DetailCase = DetailCase & "★" & "是否為新藥專利：" & IIf(OptNewDrug(1).Value = True, "是", IIf(OptNewDrug(0).Value = True, "否", "")) & vbCrLf
End If
'end 2021/7/20

Dim bolOK  As Boolean
bolOK = False

''計算行數w1,w2   20080909 add by Toni
Dim w1 As Integer, w2 As Integer
Dim tmpPrintDetailTxt As Variant
Dim tmpPrintDetailTxt2 As String

'Added by Lydia 2017/06/19 計算頁尾備註
'Mark by Lydia 2020/08/21 直接放入案件說明事項的計算
'nMemo = 0
'If IsCuMemo Then
'   tmpPrintDetailTxt = Split(CuMemo, "<End>")
'   nMemo = nMemo + UBound(tmpPrintDetailTxt) + 1 '+1(業務備註：)
'End If
'If IsSpecCu Then
'   nMemo = nMemo + 1
'End If
tmpPrintDetailTxt = Empty
'end 2017/06/19

tmpPrintDetailTxt = Split(DetailCase, Chr(13))
'20080909 add by Toni
w1 = 0      '未算發明人行數計算行數超過16 即可跳行]
w2 = 0      '加算發明人行數計算行數超過16 即可跳行
w1 = UBound(tmpPrintDetailTxt)
rowMax = 16 'Added by Lydia 2016/08/24

'add by Toni 2008/8/20
'秀發明人資料
Dim i  As Integer

'2008/9/3 add by sonia 區別自行輸入之發明人
Dim j  As Integer
Dim varInventorNo As Variant

If strInventorNo <> "" Then
   varInventorNo = Split(strInventorNo, ",")
   j = UBound(varInventorNo)
End If
'2008/9/3 end
For i = 0 To 9
   If Text2(i).Text = "" And Text3(i).Text = "" Then
      DetailCase = DetailCase
   Else
      '2008/9/3 add by sonia 區別自行輸入之發明人
      'DetailCase = DetailCase & "發明人：" & Text2(i).Text & "  " & Text3(i).Text & "  " & Combo3(i).Text & "  " & Text4(i).Text & vbcrlf
      '判斷第一個發明人欄位空白就不印  20080912 add by Toni
      If Text2(i) = "" Then
         Text3(i) = "": Combo3(i) = "": Text4(i) = ""
      Else
         'Modify By Sindy 2011/1/31 改以發明人姓名檢查是否為新發明人, 因新發明人有可能在第一順位
         'If i <= j And strInventorNo <> "" Then
         If InStr(strInventorName, Text2(i)) > 0 And strInventorNo <> "" Then
         '2011/1/31 End
            '加有ID即印國籍 2008/12/03 add by Toni
            '加判斷第一個有發明人其它不用  20080908 add by toni
            If Text3(i) <> "" And Combo3(i) = "" Then
               If i = 0 Then
                  DetailCase = DetailCase & "發明人：" & Text2(i).Text & "  " & Text3(i).Text & " " & "(" & "中華民國" & ")" & Left(Text4(i).Text, 70) & vbCrLf
               Else
                  DetailCase = DetailCase & "　　　　" & Text2(i).Text & "  " & Text3(i).Text & " " & "(" & "中華民國" & ")" & Left(Text4(i).Text, 70) & vbCrLf
               End If
            Else
               If i = 0 Then
                  DetailCase = DetailCase & "發明人：" & Text2(i).Text & "  " & Text3(i).Text & " " & "(" & Mid(Combo3(i).Tag, 5) & ")" & Left(Text4(i).Text, 70) & vbCrLf
               Else
                  DetailCase = DetailCase & "　　　　" & Text2(i).Text & "  " & Text3(i).Text & " " & "(" & Mid(Combo3(i).Tag, 5) & ")" & Left(Text4(i).Text, 70) & vbCrLf
               End If
            End If
         Else
            '加有ID即印國籍 2008/12/03 add by Toni
            '加判斷第一個有發明人其它不用  20080908 add by toni
            If Text3(i) <> "" And Combo3(i) = "" Then
               If i = 0 Then
                  DetailCase = DetailCase & "發明人：■" & Text2(i).Text & "  " & Text3(i).Text & "(" & " 中華民國" & ")" & Left(Text4(i).Text, 70) & vbCrLf
               Else
                  DetailCase = DetailCase & "　　　　■" & Text2(i).Text & " " & Text3(i).Text & "(" & "中華民國" & ")" & Left(Text4(i).Text, 70) & vbCrLf
               End If
            Else
               If i = 0 Then
                  DetailCase = DetailCase & "發明人：■" & Text2(i).Text & "  " & Text3(i).Text & "(" & Mid(Combo3(i).Tag, 5) & ")" & Left(Text4(i).Text, 70) & vbCrLf
               Else
                  DetailCase = DetailCase & "　　　　■" & Text2(i).Text & " " & Text3(i).Text & "(" & Mid(Combo3(i).Tag, 5) & ")" & Left(Text4(i).Text, 70) & vbCrLf
               End If
            End If
         End If
      End If
      '2008/9/3 end
   End If
Next

'Add by Amy 2021/11/29 新客戶為國內同業顯示事項
If strSameTrade <> MsgText(601) Then
    DetailCase = DetailCase & vbCrLf & "新客戶事項：" & vbCrLf & strSameTrade & vbCrLf
End If

'Added by Lydia 2020/08/21 直接放入案件說明事項的計算-業務備註放在最後面
If IsCuMemo And CuMemo <> "" Then
    DetailCase = DetailCase & vbCrLf & "業務備註：" & vbCrLf & CuMemo & vbCrLf
End If
'end 2020/08/21
'Added by Lydia 2020/08/21 直接放入案件說明事項的計算-業務備註放在最後面
If IsSpecCu And SpecMemo <> "" Then
    DetailCase = DetailCase & vbCrLf & "此為特殊客戶，特殊原因為：" & SpecMemo & vbCrLf
End If
'end 2020/08/21

PrintDetailTxt = Split(DetailCase, Chr(13))

'20080902列印發明人判斷是否超過十個
'Modify By Sindy 2009/08/31
'For iiiii = 0 To UBound(PrintDetailTxt)
'Memo by Lydia 2016/08/24 處理案件說明事項的列印版面,字數過長就跳行重啟
For iiiii = 0 To UBound(PrintDetailTxt) - 1
   'Modified by Lydia 2020/08/21 所有明細集中在此處理換行;第二頁開始改最大字數
   'w2 = w2 + 1
   w2 = GetPrintDetailWidth(rowMax, w2, PrintWidthWord)
         
   PrintDetailTxt2 = PrintDetailTxt(iiiii) & Chr(13)
   'Added by Lydia 2017/06/19 發明人在明細的位置
   If nInventorR = 0 And InStr(PrintDetailTxt2, "發明人：") > 0 And Text2(0) <> "" Then nInventorR = w2
   
   If PUB_StrToStr_byVal(PrintDetailTxt2, PrintWidthWord + 2) <> PrintDetailTxt2 Then
      PrintDetailTxt(iiiii) = ""
      bolOK = True
      Do While bolOK = True
         'Modified by Lydia 2020/08/21 第二頁開始改最大字數
         'w2 = w2 + 1
         w2 = GetPrintDetailWidth(rowMax, w2, PrintWidthWord)
         
         PrintDetailTxt(iiiii) = PrintDetailTxt(iiiii) & RTrim(PUB_StrToStr_byVal(PrintDetailTxt2, PrintWidthWord) & Chr(13)) & Chr(10)
         'Modify By Sindy 2012/11/08
         'Modified by Lydia 2021/05/07 排除ACS智財顧問的描述
         'If InStr(PrintDetailTxt2, "應收帳款") > 0 Then
         If InStr(PrintDetailTxt2, "應收帳款") > 0 Or InStr(PrintDetailTxt2, "尚未發文次數") > 0 Then
            PrintDetailTxt2 = " " & Replace(PrintDetailTxt2, PUB_StrToStr_byVal(PrintDetailTxt2, PrintWidthWord), "")
         Else
         '2012/11/08 End
            PrintDetailTxt2 = "　　　　　 " & Replace(PrintDetailTxt2, PUB_StrToStr_byVal(PrintDetailTxt2, PrintWidthWord), "")
         End If
         If PUB_StrToStr_byVal(PrintDetailTxt2, PrintWidthWord) = PrintDetailTxt2 Then
            PrintDetailTxt(iiiii) = PrintDetailTxt(iiiii) & PrintDetailTxt2
            bolOK = False
         End If
     Loop
   Else
      PrintDetailTxt(iiiii) = RTrim(PrintDetailTxt2)
   End If
Next iiiii

'w2 = w2 - 1 'Add By Sindy 2009/08/31 'Remove by Lydia 2020/08/21

'w2 = w2 + nMemo 'Added by Lydia 2017/06/19 +頁尾備註 'Remove by Lydia 2020/08/21

DetailCase = Join(PrintDetailTxt)

PrintDetailTxt = Split(Replace(Replace(DetailCase, Chr(32) + Chr(32), " "), Chr(10), ""), Chr(13))

'Modified by Lydia 2016/08/24 改成實際列印列數
'For iiiii = 0 To w1 - 1
For iiiii = 0 To UBound(PrintDetailTxt) - 1
   'Add By Sindy 2013/12/12
   'Modified by Lydia 2016/08/24
   'If iiiii > 15 Then Exit For
    If iiiii >= rowMax Then
       Exit For '目前列數
    End If
    'end 2016/08/24
    
'For iiiii = 0 To UBound(PrintDetailTxt)
   If Trim(PrintDetailTxt(iiiii)) <> "" Then
      'Added by Morgan 2022/2/23
      If m_bWordFormat Then
         strPrtText = strPrtText & PrintDetailTxt(iiiii) & vbCrLf
      Else
      'end 2022/2/23
      
         m_Device.CurrentX = 380
         m_Device.CurrentY = 8700 + (CustMove * DetailCol) + AllCustMove + (300 * (iiiii + 1))
         'Added by Lydia 2016/08/24
         '當發明人是新的字體會加黑
         If Mid(PrintDetailTxt(iiiii), 6, 1) = "■" Then
            m_Device.FontBold = True
            m_Device.Print PrintDetailTxt(iiiii)
            m_Device.FontBold = False
         'end 2016/08/24
         'Add by Morgan 2011/5/10 加粗加大
         'Modified by Morgan 2013/9/23 +電子送件
         'Modified by Morgan 2013/9/26 +附英文摘要
         'Modified by Morgan 2013/9/27 +紙本送件
         'Modified by Lydia 2016/08/24 改成ElseIf
         ElseIf InStr(PrintDetailTxt(iiiii), "★送件方式") > 0 Or InStr(PrintDetailTxt(iiiii), "★" & Label19.Caption) > 0 Or InStr(PrintDetailTxt(iiiii), "★電子送件") > 0 Or InStr(PrintDetailTxt(iiiii), "★紙本送件") > 0 Or InStr(PrintDetailTxt(iiiii), "★附英文摘要") > 0 Then
            m_Device.FontBold = True
            m_Device.FontSize = m_Device.FontSize + 1
            m_Device.Print PrintDetailTxt(iiiii)
            m_Device.FontSize = m_Device.FontSize - 1
            m_Device.FontBold = False
         'Add By Sindy 2011/11/11
         'Modify by Amy 2015/11/13 +Frame41
         ElseIf (Frame16.Visible = True And (InStr(PrintDetailTxt(iiiii), Option3(0).Caption) > 0 Or InStr(PrintDetailTxt(iiiii), Option3(1).Caption) > 0)) _
              Or (Frame41.Visible = True And (InStr(PrintDetailTxt(iiiii), Option9(0).Caption) > 0 Or InStr(PrintDetailTxt(iiiii), Option9(1).Caption) > 0)) Then
            intFontSize = m_Device.FontSize
            m_Device.FontBold = True
            m_Device.FontSize = 16
            m_Device.Print PrintDetailTxt(iiiii)
            m_Device.FontSize = intFontSize
            m_Device.FontBold = False
         'Added by Lydia 2016/04/19 查名代號字體加粗
         ElseIf InStr(PrintDetailTxt(iiiii), "查名代號") > 0 Then
            m_Device.FontBold = True
            m_Device.Print PrintDetailTxt(iiiii)
            m_Device.FontBold = False
         'end 2016/04/19
         Else
         'end 2011/5/10
            m_Device.Print PrintDetailTxt(iiiii)
         End If 'Add by Morgan 2011/5/10
         
      End If 'Added by Morgan 2022/2/23
   End If
Next iiiii

inPrt = iiiii 'Added by Lydia 2016/08/24 記錄現在列

'Modify By Sindy 2009/08/31
'If w2 <= 17 Then
'Modified by Lydia 2016/08/24
'If w2 <= 15 Or strInventorNo = "" Then
If w2 <= rowMax - 1 Or strInventorNo = "" Then
   'For iiiii = w1 To UBound(PrintDetailTxt)
   'Modified by Lydia 2016/08/24 改成尚未列印
   'For iiiii = w1 To UBound(PrintDetailTxt) - 1
   For iiiii = inPrt To UBound(PrintDetailTxt) - 1
      'Add By Sindy 2009/08/31
      'Modified by Lydia 2016/08/24
      'If iiiii > 15 Then Exit For
      If iiiii > rowMax Or (w2 > rowMax And iiiii >= rowMax) Then Exit For
      If Trim(PrintDetailTxt(iiiii)) <> "" Then
      '2009/08/31 End
         
         'Added by Morgan 2022/2/24
         If m_bWordFormat Then
            strPrtText = strPrtText & PrintDetailTxt(iiiii) & vbCrLf
         Else
         'end 2022/2/24
         
            m_Device.CurrentX = 380
            m_Device.CurrentY = 8700 + (CustMove * DetailCol) + AllCustMove + (300 * (iiiii + 1)) + 50
            '當發明人是新的字體會加黑 20080924
            If Mid(PrintDetailTxt(iiiii), 6, 1) = "■" Then
               m_Device.FontBold = True
               m_Device.Print PrintDetailTxt(iiiii)
               m_Device.FontBold = False
            'Added by Lydia 2016/01/27 商品名稱可能需要換行,造成w1的上限不見得是說明事項的上限(T-202281)
            ElseIf InStr(PrintDetailTxt(iiiii), "★送件方式") > 0 Or InStr(PrintDetailTxt(iiiii), "★" & Label19.Caption) > 0 Or InStr(PrintDetailTxt(iiiii), "★電子送件") > 0 Or InStr(PrintDetailTxt(iiiii), "★紙本送件") > 0 Or InStr(PrintDetailTxt(iiiii), "★附英文摘要") > 0 Then
               m_Device.CurrentX = 380
               m_Device.CurrentY = 8700 + (CustMove * DetailCol) + AllCustMove + (300 * (iiiii + 1))
               m_Device.FontBold = True
               m_Device.FontSize = m_Device.FontSize + 1
               m_Device.Print PrintDetailTxt(iiiii)
               m_Device.FontSize = m_Device.FontSize - 1
               m_Device.FontBold = False
            'end 2016/01/27
            'Added by Lydia 2016/04/19 查名代號字體加粗
            ElseIf InStr(PrintDetailTxt(iiiii), "查名代號") > 0 Then
               m_Device.FontBold = True
               m_Device.Print PrintDetailTxt(iiiii)
               m_Device.FontBold = False
            'end 2016/04/19
            Else
               m_Device.Print PrintDetailTxt(iiiii)
            End If
         End If
      End If
      inPrt = iiiii 'Added by Lydia 2016/08/24 記錄現在列
   Next iiiii
   
'   'Add By Sindy 2009/08/31
'   If w2 > 15 Then
'      m_Device.FontBold = True
'      m_Device.FontSize = 12
'      m_Device.CurrentX = 380
'      m_Device.CurrentY = m_Device.CurrentY + 80
'      m_Device.Print " 後續資料如附件"
'      m_Device.FontBold = False
'   End If
'Else
End If

   'If strInventorNo <> "" Then   '2009/1/14 add by sonia 否則非專利案若案件內容多也會印
   'Modified by Lydia 2016/08/24
   'If w2 > 15 Then
   If w2 >= rowMax Then
      If Not m_bWordFormat Then 'Added by Morgan 2022/2/23
         m_Device.FontBold = True
         m_Device.FontSize = 12
         m_Device.CurrentX = 380
         m_Device.CurrentY = m_Device.CurrentY + 80
      End If 'Added by Morgan 2022/2/23
      
      'Modify By Sindy 2013/12/12
      'm_Device.Print " 發明人資料如附件"
      'Modified by Lydia 2016/08/24
      'm_Device.Print IIf(strInventorNo <> "", " 發明人資料如附件", " (次頁尚有其他資料)")
      If strInventorNo <> "" Then
        'Modified by Lydia 2017/06/19 資料到第2頁才顯示
        'If intPrintCnt = 1 Then
         If intPrintCnt = 1 And nInventorR > rowMax Then
            'Added by Morgan 2022/2/23
            If m_bWordFormat Then
               strPrtText = strPrtText & " 發明人資料如附件" & vbCrLf
            Else
            'end 20222/2/23
               m_Device.Print " 發明人資料如附件"
            End If 'Added by Morgan 2022/2/23
            
         'Added by Lydia 2017/06/19
         ElseIf w2 > rowMax Then
            'Added by Morgan 2022/2/23
            If m_bWordFormat Then
               strPrtText = strPrtText & " (次頁尚有其他資料)" & vbCrLf
            Else
            'end 20222/2/23
               m_Device.Print " (次頁尚有其他資料)"
            End If 'Added by Morgan 2022/2/23
            
         'Added by Lydia 2019/12/05 剛好一頁
         ElseIf w2 = rowMax Then
            'Added by Morgan 2022/2/23
            If m_bWordFormat Then
               strPrtText = strPrtText & PrintDetailTxt(w2) & vbCrLf
            Else
            'end 20222/2/23
               m_Device.FontBold = False
               m_Device.Print PrintDetailTxt(w2)
            End If 'Added by Morgan 2022/2/23
         End If
         
      ElseIf w2 > rowMax Then
         'Added by Morgan 2022/2/23
         If m_bWordFormat Then
            strPrtText = strPrtText & " (次頁尚有其他資料)" & vbCrLf
         Else
         'end 20222/2/23
            m_Device.Print " (次頁尚有其他資料)"
         End If 'Added by Morgan 2022/2/23
      End If
      '2013/12/12 END
      
      If Not m_bWordFormat Then 'Added by Morgan 2022/2/23
         m_Device.FontBold = False
      End If 'Added by Morgan 2022/2/23
   End If
'End If

'Add By Sindy 2009/08/31
'Modify By Sindy 2009/11/02
'If tmpImg.Picture <> 0 And SSTab1.TabEnabled(4) = True Then
'Modify by Morgan 2010/9/27
'If (tmpImg.Picture <> 0 And SSTab1.TabEnabled(4) = True) Or _
   ((opt1(3).Value = True Or opt1(4).Value = True) And (PicText.Visible = True And Trim(PicText.Text) <> "")) Then
'Modify by Amy 2017/01/20 +(opt1(3).Value = True And Frame5.Visible = True)
If SSTab1.TabEnabled(4) = True And (tmpImg.Picture <> 0 Or _
   ((opt1(3).Value = True Or opt1(4).Value = True) And (PicText.Visible = True And Trim(PicText.Text) <> "")) Or _
   (opt1(3).Value = True And Frame5.Visible = True)) Then
'   m_Device.Line (6300, 12550)-(9400, 12550) '上橫線
'   m_Device.Line (6300, 15450)-(9400, 15450) '下橫線
'   m_Device.Line (6300, 12550)-(6300, 15450) '左直線
'   m_Device.Line (9400, 12550)-(9400, 15450) '右直線
'   m_Device.PaintPicture tmpImg, 6350, 12600, 3000, 2800
   'Modify By Sindy 2009/09/21
   'Modify By Sindy 2009/11/02
   'Modfiy by Amy 2017/01/20 +(Frame5.Visible = True And tmpImg.Picture = 0)
   If PicText.Visible = True Or (Frame5.Visible = True And tmpImg.Picture = 0) Then
      intWidth = 3100
      intHeight = 2904
   '2009/11/02 End
   Else
      '等比例縮放
      If tmpImg.Width > tmpImg.Height Then
         dblXX = Round(tmpImg.Width / tmpImg.Height, 2)
         intWidth = 3000 + 100
         intHeight = (3000 / dblXX) + 100
      Else
         dblXX = Round(tmpImg.Height / tmpImg.Width, 2)
         intWidth = (3000 / dblXX) + 100
         intHeight = 3000 + 100
      End If
   End If
   
   If Not m_bWordFormat Then 'Added by Morgan 2022/2/24
      m_Device.Line (6300, 12550)-(6300 + intWidth, 12550) '上橫線
      m_Device.Line (6300, 12550 + intHeight)-(6300 + intWidth, 12550 + intHeight) '下橫線
      m_Device.Line (6300, 12550)-(6300, 12550 + intHeight) '左直線
      m_Device.Line (6300 + intWidth, 12550)-(6300 + intWidth, 12550 + intHeight) '右直線
   End If 'Added by Morgan 2022/2/24
   
   'Modify By Sindy 2009/11/02
   'CurrentX : 6400-9300 (2900)
   'CurrentY : 12700-15000 (2300) : 7行
   'Modify by Amy 2017/01/20 +(Frame5.Visible = True And tmpImg.Picture = 0)
   If (PicText.Visible = True And Trim(PicText.Text) <> "") Or (Frame5.Visible = True And tmpImg.Picture = 0) Then
      'Add by Amy 2017/01/20 +if
      If PicText.Visible = True And Trim(PicText.Text) <> "" Then
        strMainText = Trim(PicText.Text)
      Else
        strMainText = "圖同 " & _
                        Trim(TxtC1(0)) & "-" & Trim(TxtC1(1)) & IIf(Trim(TxtC1(2) <> 0), "-" & Trim(TxtC1(2)) & "-" & Trim(TxtC1(3)), "　") & _
                        "無代表圖"
      End If
      
      '計算X軸位置
      If opt1(0).Value = True Then
         strMainText = "「" & strMainText & "」"
'      ElseIf opt1(3).Value = True Then
'         strMainText = "圖同" & strMainText
      End If
      
      'Added by Morgan 2022/3/1
      If m_bWordFormat Then
         If opt1(0).Value = True Then
            strMainText = strMainText & vbCrLf & "文字商標"
         End If
         WordVarSet "商標文", strMainText
      Else
      'end 2022/3/1
         m_Device.Font.Size = 18
         If m_Device.TextWidth(strMainText) > 2920 Then
            intMidWidth = 6400
         Else
            intMidWidth = ((9300 - Val(m_Device.TextWidth(strMainText)) - 6400) / 2) + 6400
         End If
         
         '檢查需要折為幾行字
         strPicText(1) = "": strPicText(2) = "": strPicText(3) = "": strPicText(4) = ""
         strPicText(5) = "": strPicText(6) = "": strPicText(7) = ""
         intLen = 0: intLine = 0: strWord = ""
         For i = 1 To Len(strMainText)
            intLen = intLen + m_Device.TextWidth(Mid(strMainText, i, 1))
            If intLen > 2920 Then
               intLine = intLine + 1
               strPicText(intLine) = strWord
               intLen = m_Device.TextWidth(Mid(strMainText, i, 1))
               strWord = Mid(strMainText, i, 1)
            Else
               strWord = strWord & Mid(strMainText, i, 1)
            End If
         Next i
         If strWord <> "" Then intLine = intLine + 1: strPicText(intLine) = strWord
         '計算Y軸位置
         If opt1(0).Value = True Then '文字商標
            intMidHeight = ((15000 - ((intLine + 1) * 328) - 12700) / 2) + 12700
         Else
            If intLine = 1 Then
               intMidHeight = 13800
            Else
               intMidHeight = ((15000 - (intLine * 328) - 12700) / 2) + 12700
            End If
         End If
         
         '填入文字
         For i = 0 To intLine - 1
            m_Device.CurrentX = intMidWidth
            m_Device.CurrentY = intMidHeight + (i * 360)
            m_Device.Print strPicText(i + 1)
         Next i
         If opt1(0).Value = True Then '文字商標
            m_Device.CurrentX = 7125
            m_Device.CurrentY = intMidHeight + (intLine * 360) '14200
            m_Device.Print "文字商標"
         End If
         
         m_Device.Font.Size = 12 '恢復字體大小
         
      End If 'Added by Morgan 2022/3/1
   '2009/11/02 End
   Else
      'Added by Morgan 2022/2/24
      If m_bWordFormat Then
         If optColor(0).Enabled = True And optColor(0).Value = True Then
            WordVarSet "商標圖標題", "墨色商標圖"
         ElseIf optColor(1).Enabled = True And optColor(1).Value = True Then
            WordVarSet "商標圖標題", "彩色商標圖"
         End If
         WordVarSet "商標圖", "Y"
      Else
      'end 2022/2/24
      
         'Add By Sindy 2019/12/19 商標顏色
         m_Device.CurrentX = 6400
         m_Device.CurrentY = 12200
         If optColor(0).Enabled = True And optColor(0).Value = True Then
            m_Device.Print "墨色商標圖"
         ElseIf optColor(1).Enabled = True And optColor(1).Value = True Then
            m_Device.Print "彩色商標圖"
         End If
         '2019/12/19 END
         m_Device.PaintPicture tmpImg, 6350, 12600, intWidth - 100, intHeight - 100
         
      End If 'Added by Morgan 2022/2/24
   End If
End If
'2009/08/31 End

DetailCol = 11

If Not m_bWordFormat Then 'Added by Morgan 2022/2/24
   '主管批示意見
   m_Device.Line (9500, 8975 + (CustMove * DetailCol) + AllCustMove)-(9500, 15750)
   m_Device.CurrentX = 9650
   m_Device.CurrentY = 9025 + (CustMove * DetailCol) + AllCustMove
   m_Device.Print "主管批示意見"
   m_Device.Line (9500, 9300 + (CustMove * DetailCol) + AllCustMove)-(11175, 9300 + (CustMove * DetailCol) + AllCustMove)
   
   'add by nickc 2008/01/18 加入智權人員的客戶備註
   'Modify by Amy 2016/08/15
   'Modified by Lydia 2017/06/19 若加起來超過第一頁,改到第2頁接在明細的後面
   'If IsCuMemo Then
   'Mark by Lydia 2020/08/21 直接放入案件說明事項的計算
   'If IsCuMemo And w2 < rowMax Then
   '    strExc(0) = "": strExc(1) = CuMemo
   '    strPicText(1) = "": strPicText(2) = "": strPicText(3) = "": strPicText(4) = ""
   '    strPicText(5) = ""
   '    For i = 1 To 5
   '        If strExc(1) = "<End>" Then
   '            Exit For
   '        Else
   '            strExc(0) = Val(strExc(0)) + 1
   '            If InStr(strExc(1), vbCrLf) > 0 Then
   '                strPicText(i) = Mid(strExc(1), 1, InStr(strExc(1), vbCrLf) - 1)
   '                strExc(1) = Replace(strExc(1), strPicText(i) & vbCrLf, "")
   '            Else
   '                strPicText(i) = Replace(strExc(1), "<End>", "")
   '                strExc(1) = "<End>"
   '            End If
   '        End If
   '    Next i
   '    'Modified by Lydia 2017/06/19 下移
   '    'strExc(1) = Val(IIf(IsSpecCu, 14600, 14900)) - Val(strExc(0)) * 300
   '    strExc(1) = Val(IIf(IsSpecCu, 14760, 15060)) - Val(strExc(0)) * 300
   '
   '    m_Device.CurrentX = 380
   '    m_Device.CurrentY = strExc(1)
   '    m_Device.Print "業務備註 ："
   '
   '    For i = 1 To Val(strExc(0))
   '        strExc(1) = Val(strExc(1)) + 300
   '        m_Device.CurrentX = 380
   '        m_Device.CurrentY = strExc(1)
   '        m_Device.Print strPicText(i)
   '    Next i
   'End If
   ''end 2016/08/15
   ''add by nickc 2007/11/12 加入特殊客戶控制
   ''Modified by Lydia 2017/06/19 若加起來超過第一頁,改到第2頁接在明細的後面
   'If IsSpecCu And w2 < rowMax Then
   '    m_Device.CurrentX = 380
   '    m_Device.CurrentY = 15500
   '    'edit by nickc
   '    'm_Device.Print SpecMemo
   '    m_Device.Print "此為特殊客戶，特殊原因為：" & SpecMemo
   'End If
   'end 2020/08/21 --- 'Mark by Lydia 2020/08/21 直接放入案件說明事項的計算
   
   '結尾
   m_Device.CurrentX = 0
   m_Device.CurrentY = 15800
   m_Device.Print "　　經理：　　　　　　　　　　　　主任：　　　　　　　　　　　　會計："

End If 'Added by Morgan 2022/2/24

'add by Toni 20080909
'判斷發明人行數
'2009/1/14 modify by sonia 否則非專利案若案件內容多也會印
'Modify By Sindy 2009/08/31
Dim Jjj As Integer
'Modified by Lydia 2016/08/24 若只有16行明細,並在同一頁
'If w2 > 15 Then
If w2 >= rowMax And inPrt <> w2 Then
'If w2 > 17 And strInventorNo <> "" Then
   Jjj = 16
   
   '   'Modify By Sindy 2014/2/7
'   'm_Device.NewPage
'   PrinterPages = PrinterPages + 1
'   If PrinterPages > 1 Then
'      If txtPrintType = "1" Then '螢幕
'         SetPic PrinterPages - 1
'      ElseIf PrinterPages > 1 Then
'         m_Device.NewPage
'      End If
'   End If
'   '2014/2/7 End
   'Modified by Lydia 2016/08/24 若只有16行明細,並在同一頁
   'If w1 > 16 Then
   If w1 > rowMax And strInventorNo = "" Then
      'Modify By Sindy 2014/2/7
      'm_Device.NewPage
      PrinterPages = PrinterPages + 1
      'Added by Morgan 2022/2/23
      If m_bWordFormat Then
         WordVarSet strVarName, strPrtText
         strVarName = "說明事項2"
         strPrtText = " 後續資料：" & vbCrLf
      Else
      'end 2022/2/23
      
         If PrinterPages > 1 Then
            If txtPrintType = "1" Then '螢幕
               SetPic PrinterPages - 1
            ElseIf PrinterPages > 1 Then
               m_Device.NewPage
            End If
         End If
         '2014/2/7 End
      
         m_Device.FontBold = True
         m_Device.CurrentX = 380
         m_Device.CurrentY = 600
         m_Device.Print " 後續資料："
         m_Device.FontBold = False
         
      End If 'Added by Morgan 2022/2/23
   Else
      'Add By Sindy 2015/8/28 發明人資料若單獨一頁時,只要一份
      'Modified by Lydia 2016/08/24 by Lydia 2016/08/24
      'If intPrintCnt > 1 And strInventorNo <> "" Then Exit Sub
      If intPrintCnt > 1 And strInventorNo <> "" And (PrintDetailTxt(inPrt) <> "" And InStr(PrintDetailTxt(inPrt), "發明人：") > 0) Then
         If m_bWordFormat Then WordVarSet strVarName, strPrtText 'Added by Morgan 2022/2/24
         Exit Sub
      End If
      
      'Added by Lydia 2016/08/28 若只有16行明細,並在同一頁
      'Moddified by Lydia 2017/06/19 發明人資料已併入w2
      'If w2 = rowMax And strInventorNo = "" Then GoTo JumpToMerge
      If w2 = rowMax Then
         strExc(10) = 8700 + (CustMove * DetailCol) + AllCustMove + (300 * (inPrt + 1)) + 50 '暫存列印座標
         GoTo JumpToMerge
      End If
      'end 2017/06/19
      
      'Modify By Sindy 2014/2/7
      'm_Device.NewPage
      PrinterPages = PrinterPages + 1
      
      'Added by Morgan 2022/2/23
      If m_bWordFormat Then
         WordVarSet strVarName, strPrtText
         strVarName = "說明事項2"
         strPrtText = ""
      Else
      'end 2022/2/23
         If PrinterPages > 1 Then
            If txtPrintType = "1" Then '螢幕
               SetPic PrinterPages - 1
            ElseIf PrinterPages > 1 Then
               m_Device.NewPage
            End If
         End If
         
      End If 'Added by Morgan 2022/2/23
      '2014/2/7 End
      
      'Modified by Lydia 2017/06/19 發明人資料到第2頁
      'If strInventorNo <> "" Then
      If strInventorNo <> "" And nInventorR > rowMax Then
        'Added by Lydia 2016/08/24 判斷第一份列印
         If intPrintCnt = 1 Then
            'Added by Morgan 2022/2/23
            If m_bWordFormat Then
               strPrtText = strPrtText & " 發明人資料：" & vbCrLf
            Else
            'end 2022/2/23
            
               m_Device.FontBold = True
               m_Device.CurrentX = 380
               m_Device.CurrentY = 600
               m_Device.Print " 發明人資料："
               m_Device.FontBold = False
               
            End If 'Added by Morgan 2022/2/23
         'Modified by Lydia 2016/08/24
            'Jjj = w1
         'End If
            Jjj = inPrt
         End If
         'end 2016/08/24
      End If

      'Added by Lydia 2016/08/24 列印後續資料或明細超出一頁
      'Modified by Lydia 2017/06/19 +發明人資料到第2頁
      'If strInventorNo = "" Or (intPrintCnt > 1 And strInventorNo <> "") Then
      If strInventorNo = "" Or (strInventorNo <> "" And (intPrintCnt > 1 Or nInventorR < rowMax)) Then
         'Added by Morgan 2022/2/23
         If m_bWordFormat Then
            strPrtText = strPrtText & " 後續資料：" & vbCrLf
         Else
         'end 2022/2/23
            m_Device.FontBold = True
            m_Device.CurrentX = 380
            m_Device.CurrentY = 600
            m_Device.Print " 後續資料："
            m_Device.FontBold = False
            
         End If 'Added by Morgan 2022/2/23
        
        Jjj = inPrt
      End If
   End If
'   If strInventorNo <> "" Then
'      Jjj = w1
'   Else
'      Jjj = 16
'   End If
   'For iiiii = w1 To UBound(PrintDetailTxt)
JumpToMerge: 'Added by Lydia 2016/08/24
   For iiiii = Jjj To UBound(PrintDetailTxt) - 1
   
      'Added by Morgan 2022/2/23
      If m_bWordFormat Then
         strPrtText = strPrtText & PrintDetailTxt(iiiii) & vbCrLf
      Else
      'end 2022/2/23
      
         m_Device.CurrentX = 380
         'Modify By Sindy 2009/08/31
         'Modified by Lydia 2016/08/24
         'If strInventorNo <> "" And w1 <= 16 Then
         '   m_Device.CurrentY = 600 + (300 * (iiiii - w1 + 1)) + 50
         'Else
            m_Device.CurrentY = 600 + (300 * (iiiii - 15)) + 50
         'End If
         '2009/08/31 End
         If Mid(PrintDetailTxt(iiiii), 6, 1) = "■" Then
            '當發明人是新的字體會加黑 20080924
            m_Device.FontBold = True
            m_Device.Print PrintDetailTxt(iiiii)
            m_Device.FontBold = False
            
         Else
            m_Device.Print PrintDetailTxt(iiiii)
         End If
         
      End If 'Added by Morgan 2022/2/23
      
      strExc(10) = 600 + (300 * (iiiii - 15)) + 50 'Added by Lydia 2017/06/19 暫存列印座標
   Next iiiii
   
   'Added by Morgan 2022/2/23
   If m_bWordFormat Then
      WordVarSet strVarName, strPrtText
   End If
   'end 2022/2/23
   
   'Added by Lydia 2017/06/19 第2頁 - 業務備註和特殊客戶備註
   'Mark by Lydia 2020/08/21 直接放入案件說明事項的計算
'    If w2 <> rowMax Then '抓接續位置
'       If Jjj > UBound(PrintDetailTxt) - 1 Then
'           strExc(10) = 600 + 300 + 50
'       Else
'           strExc(10) = Val(strExc(10)) + 300
'       End If
'    End If
'
'    '智權人員的客戶備註
'    If IsCuMemo Then
'        strExc(0) = "": strExc(1) = CuMemo
'        strPicText(1) = "": strPicText(2) = "": strPicText(3) = "": strPicText(4) = ""
'        strPicText(5) = ""
'        For i = 1 To 5
'            If strExc(1) = "<End>" Then
'                Exit For
'            Else
'                strExc(0) = Val(strExc(0)) + 1
'                If InStr(strExc(1), vbCrLf) > 0 Then
'                    strPicText(i) = Mid(strExc(1), 1, InStr(strExc(1), vbCrLf) - 1)
'                    strExc(1) = Replace(strExc(1), strPicText(i) & vbCrLf, "")
'                Else
'                    strPicText(i) = Replace(strExc(1), "<End>", "")
'                    strExc(1) = "<End>"
'                End If
'            End If
'        Next i
'        strExc(1) = strExc(10)
'        m_Device.CurrentX = 380
'        m_Device.CurrentY = strExc(1)
'        m_Device.Print "業務備註 ："
'
'        For i = 1 To Val(strExc(0))
'            strExc(1) = Val(strExc(1)) + 300
'            m_Device.CurrentX = 380
'            m_Device.CurrentY = strExc(1)
'            m_Device.Print strPicText(i)
'        Next i
'    End If
'    '特殊客戶控制
'    If IsSpecCu Then
'        strExc(1) = Val(strExc(1)) + 300
'        m_Device.CurrentX = 380
'        m_Device.CurrentY = strExc(1)
'        m_Device.Print "此為特殊客戶，特殊原因為：" & SpecMemo
'    End If
'    'end 2017/06/19
    'end 2020/08/21 --- 'Mark by Lydia 2020/08/21 直接放入案件說明事項的計算
'Added by Morgan 2022/2/24
ElseIf m_bWordFormat Then
   WordVarSet strVarName, strPrtText
'end 2022/2/24
End If

End Sub

'Added by Morgan 2022/1/27
'接洽單下方:案件說明事項處理情形
Private Sub WordDetail(intPrintCnt As Integer, Optional IsMain As Boolean = True)
   Dim strPrtText As String
   
   '新客戶
   If Option31(1).Value = True Then
      WordVarSet "□舊", "■舊", True
   Else
      WordVarSet "□新", "■新", True
   End If
   '關係企業
   WordVarSet "關係企業", PUB_StrToStr(Text1(198).Text, 30)
   
   '主動開拓
   If Option4(0).Value = True Then
      WordVarSet "□主動開拓", "■主動開拓", True
   ElseIf Option4(3).Value = True Then
      WordVarSet "□自動來所", "■自動來所", True
   End If

   '其他
   WordVarSet "其他", PUB_StrToStr(Text1(99).Text, 34)

   '客戶
   If Option4(1).Value = True Then
      WordVarSet "□客戶", "■客戶", True
   End If

   '☆本案與總號
   WordVarSet "相關案號", Text1(100).Text
   If Option5(0).Value = True Then
      WordVarSet "□相同", "■相同", True
   ElseIf Option5(1).Value = True Then
      WordVarSet "□有關", "■有關", True
   End If
   
   '同仁
   If Option4(2).Value = True Then
      WordVarSet "□同仁", "■同仁", True
   End If
   WordVarSet "介紹人", Text1(97).Text
   
   '費用
   strPrtText = ""
   'T大陸分割
   If Is307or308 = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
       '分割費用印於子案
       If (Is308New = True Or Is308Old = True) And Is308Child = True Then
           strPrtText = IIf(Text1(101 + (intCN308Field - 1) * 3).Text = "", "", "(1) " & Text1(101 + (intCN308Field - 1) * 3).Text)
       '母案分割費用0
       Else
           For iiiii = 1 To 4
               If iiiii = intCN308Field Then
                   strPrtText = strPrtText & "(" & iiiii & ") 0"
               Else
                   strPrtText = strPrtText & IIf(Text1(101 + (iiiii - 1) * 3).Text = "", "", "(" & iiiii & ") " & Text1(101 + (iiiii - 1) * 3).Text)
               End If
               If iiiii < 4 Then strPrtText = strPrtText & vbCrLf
           Next iiiii
       End If
   '子案不印
   ElseIf (Is307or308 = True And NowCount = 0 And Is308Old = True) Or Is307or308 = False _
      Or (Is308New = True And Is308Child = False) Then
       strPrtText = IIf(Text1(101).Text = "", "", "(1) " & Text1(101).Text)
       strPrtText = strPrtText & vbCrLf & IIf(Text1(104).Text = "", "", "(2) " & Text1(104).Text)
       strPrtText = strPrtText & vbCrLf & IIf(Text1(107).Text = "", "", "(3) " & Text1(107).Text)
       strPrtText = strPrtText & vbCrLf & IIf(Text1(110).Text = "", "", "(4) " & Text1(110).Text)
   End If
   WordVarSet "費用", strPrtText
   
   '規費
   'T大陸分割
   If Is307or308 = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
      '分割費用印於子案
      If (Is308New = True Or Is308Old = True) And Is308Child = True Then
          strPrtText = IIf(Text1(102 + (intCN308Field - 1) * 3).Text = "", "", "(1) " & Text1(102 + (intCN308Field - 1) * 3).Text)
      '母案分割規費0
      Else
          For iiiii = 1 To 4
              If iiiii = intCN308Field Then
                  strPrtText = strPrtText & "(" & iiiii & ") 0"
              Else
                  strPrtText = strPrtText & IIf(Text1(102 + (iiiii - 1) * 3).Text = "", "", "(" & iiiii & ") " & Text1(102 + (iiiii - 1) * 3).Text)
              End If
              If iiiii < 4 Then strPrtText = strPrtText & vbCrLf
          Next iiiii
      End If
   '改成子案不印
   ElseIf (Is307or308 = True And NowCount = 0 And Is308Old = True) Or Is307or308 = False _
      Or (Is308New = True And Is308Child = False) Then
       strPrtText = IIf(Text1(102).Text = "", "", "(1) " & Text1(102).Text & IIf(bolRuleFeeErr = True, "★", ""))
       strPrtText = strPrtText & vbCrLf & IIf(Text1(105).Text = "", "", "(2) " & Text1(105).Text)
       strPrtText = strPrtText & vbCrLf & IIf(Text1(108).Text = "", "", "(3) " & Text1(108).Text)
       strPrtText = strPrtText & vbCrLf & IIf(Text1(111).Text = "", "", "(4) " & Text1(111).Text)
   End If
   WordVarSet "規費", strPrtText
   
   '點數
   '填入點數-T大陸分割
   If Is307or308 = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
      '分割費用印於子案
      If (Is308New = True Or Is308Old = True) And Is308Child = True Then
         strPrtText = IIf(Text1(103 + (intCN308Field - 1) * 3).Text = "", "", "(1) " & Text1(103 + (intCN308Field - 1) * 3).Text)
      '母案分割點數0
      Else
         For iiiii = 1 To 4
            If iiiii = intCN308Field Then
                strPrtText = strPrtText & "(" & iiiii & ") 0"
            Else
                strPrtText = strPrtText & IIf(Text1(103 + (iiiii - 1) * 3).Text = "", "", "(" & iiiii & ") " & Text1(103 + (iiiii - 1) * 3).Text)
            End If
            If iiiii < 4 Then strPrtText = strPrtText & vbCrLf
         Next iiiii
      End If
      
   '改成子案不印
   ElseIf (Is307or308 = True And NowCount = 0 And Is308Old = True) Or Is307or308 = False _
      Or (Is308New = True And Is308Child = False) Then
      strPrtText = IIf(Text1(103).Text = "", "", "(1) " & Text1(103).Text) & IIf(Combo2(0).Text = "", "", "(" & Combo2(0).Text & ")")
      strPrtText = strPrtText & vbCrLf & IIf(Text1(106).Text = "", "", "(2) " & Text1(106).Text) & IIf(Combo2(1).Text = "", "", "(" & Combo2(1).Text & ")")
      strPrtText = strPrtText & vbCrLf & IIf(Text1(109).Text = "", "", "(3) " & Text1(109).Text) & IIf(Combo2(2).Text = "", "", "(" & Combo2(2).Text & ")")
      strPrtText = strPrtText & vbCrLf & IIf(Text1(112).Text = "", "", "(4) " & Text1(112).Text) & IIf(Combo2(3).Text = "", "", "(" & Combo2(3).Text & ")")
   End If
   WordVarSet "點數", strPrtText
   
   '後金
   '子案不印
   If (Is307or308 = True And NowCount = 0) Or Is307or308 = False Then
      strPrtText = Text1(113).Text
   Else
      strPrtText = ""
   End If
   WordVarSet "後金", strPrtText

   '收據自動列印時間點
   strPrtText = IIf(Check8(0).Value = 1, Check8(0).Caption, IIf(Check8(1).Value = 1, Check8(1).Caption, IIf(Check8(2).Value = 1, Check8(2).Caption, "")))
   WordVarSet "收據列印時間", strPrtText
   
   '收據抬頭
   '同申請人
   If Option2(0).Value = True Then
      WordVarSet "□同申請人", "■同申請人", True
   End If
   '以 DEBIT NOTE 請款
   If Option2(2).Value = True Then
      WordVarSet "□以 DEBIT NOTE 請款", "■以 DEBIT NOTE 請款", True
   End If
   '其他
   If Option2(1).Value = True Then
      WordVarSet "□其他", "■其他", True
   End If
   '收據抬頭
   If Option2(1).Value = True Or Option2(2).Value = True Then
      WordVarSet "收據抬頭", cboTitle.Text
   Else
      WordVarSet "收據抬頭", ""
   End If
   '現金
   If Check6(0).Value = 1 Then
      WordVarSet "□現金", "■現金", True
   End If
   WordVarSet "現金", Text1(116).Text
   '支票
   If Check6(1).Value = 1 Then
      WordVarSet "□支票", "■支票", True
   End If
   '到期日
   If Trim(Text1(117).Text) = "" Then
      strPrtText = "(到期日：　   　年　  　月　  　日)" & IIf(Check1.Value = 1, "　　請貼印花", "")
   Else
      strPrtText = "(到期日：　" & Mid(Text1(117).Text, 1, Len(Text1(117).Text) - 4) & "　年　" & IIf(Text1(117).Text = "", "  ", Trim(Val(Left(Right(Text1(117).Text, 4), 2)))) & "　月　" & IIf(Text1(117).Text = "", "  ", Trim(Val(Right(Text1(117).Text, 2)))) & "　日)" & IIf(Check1.Value = 1, "　　請貼印花", "")
   End If
   WordVarSet "支票到期日", strPrtText
   '特殊收據"
   strPrtText = ""
   If Check9.Value = 1 Then
      strPrtText = "特殊收據"
   End If
   WordVarSet "特殊收據", strPrtText, , True

   'ID.NO.
   WordVarSet "統編", Text1(92).Text, , True
   
   '收據公司
   WordVarSet "收據公司", Combo4.List(Combo4.ListIndex), , True
   
   '收據暫不列印
   If Check2.Value = 1 Then
      WordVarSet "□收據暫不列印", "■收據暫不列印", True
   End If

'   '事項說明文字
'   strPrtText = ""
'   GetMemoText1 strPrtText
'   GetMemoText2 strPrtText
'   WordVarSet "說明事項", strPrtText

End Sub
'Add by Sindy 2009/08/31
Private Sub LoadPic(strIBF01 As String, strIBF02 As String, strIBF03 As String, strIBF04 As String)
   Set PicRs = New ADODB.Recordset
   If PicRs.State = 1 Then PicRs.Close
   PicRs.CursorLocation = adUseClient
   'Modify By Sindy 2018/10/31 TF馬德里商標圖檔-子案的圖同母案
   '固定都以IBF01=tm01 AND IBF02=substr(tm02,1,5)||'0' AND IBF03='0' AND IBF04='00' 去抓代表圖
   If strIBF01 = "TF" Then
      PicRs.Open "select * from ImgByteFile where ibf05='1' and ibf01='" & strIBF01 & "' and ibf02='" & Mid(strIBF02, 1, 5) & "0" & "' and ibf03='0' And ibf04='00' ", cnnConnection, adOpenStatic, adLockOptimistic
   Else
   '2018/10/31 END
      PicRs.Open "select * from ImgByteFile where ibf05='1' and ibf01='" & strIBF01 & "' and ibf02='" & strIBF02 & "' and ibf03='" & strIBF03 & "' and ibf04='" & strIBF04 & "' ", cnnConnection, adOpenStatic, adLockOptimistic
   End If
   If PicRs.RecordCount <> 0 Then
      PicRs.MoveFirst
      '加入無圖式的格式
      If CheckStr(PicRs.Fields("ibf06")) = "3" Or CheckStr(PicRs.Fields("ibf06")) = "4" Or CheckStr(PicRs.Fields("ibf06")) = "6" Then
         IsWmf = True
      Else
         IsWmf = False
      End If
      'Add By Sindy 2017/8/10
'      If "" & PicRs.Fields("IBF15") <> "" Then
         If IsWmf = False Then
            Call PUB_GetFtpFile(PicRs.Fields("IBF15"), App.path & "\NowPic.jpg", UCase("ImgByteFile"))
         Else
            Call PUB_GetFtpFile(PicRs.Fields("IBF15"), App.path & "\NowPic.wmf", UCase("ImgByteFile"))
         End If
'      Else
'      '2017/8/10 END
'         ReDim bytes(Val(PicRs.Fields("ibf13").Value))
'         bytes() = PicRs.Fields("ibf14").GetChunk(Val(PicRs.Fields("ibf13").Value))
'         file_num = FreeFile
'         If IsWmf = False Then
'             Open App.path & "\NowPic.jpg" For Binary Access Write As #file_num
'         Else
'             Open App.path & "\NowPic.wmf" For Binary Access Write As #file_num
'         End If
'         Put #file_num, , bytes()
'         Close #file_num
'      End If
      
      If IsWmf = False Then
          tmpPic.Picture = LoadPicture(Trim(App.path & "\NowPic.jpg"))
          tmpImg.Picture = LoadPicture(Trim(App.path & "\NowPic.jpg"))
      Else
          tmpPic.Picture = LoadPicture(Trim(App.path & "\NowPic.wmf"))
          tmpImg.Picture = LoadPicture(Trim(App.path & "\NowPic.wmf"))
      End If
      If Dir(App.path & "\NowPic.jpg") <> "" Then
          Kill App.path & "\NowPic.jpg"
      End If
      If Dir(App.path & "\NowPic.wmf") <> "" Then
          Kill App.path & "\NowPic.wmf"
      End If
   End If
End Sub

'Add by Morgan 2008/9/16
'接洽人控制
Private Sub LockContact(Optional Index As Integer = -1)
   Dim ii As Integer
   Dim bNewCase As Boolean, bNewCust As Boolean
   Dim bChange As Boolean 'Added by Lydia 2018/12/03 國內接洽單收讓與案時，開放可選擇接洽單
   
   m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/9/8 取得案件性質代碼
   bNewCase = Option1(0).Value
   'Added by Lydia 2018/12/03 Added by Lydia 2018/12/03 國內接洽單收讓與案時，開放可選擇接洽單
   'Modify By Sindy 2023/2/15 +合併(702)
   If Option1(1).Value = True And ((Trim(Text1(6).Text) = "P" Or _
      Trim(Text1(6).Text) = "FCP" Or _
      Trim(Text1(6).Text) = "CFP") And _
      (InStr(m_strCaseCPM, "701") > 0 Or InStr(m_strCaseCPM, "702") > 0 Or InStr(m_strCaseCPM, "703") > 0 Or InStr(m_strCaseCPM, "708") > 0)) Or _
      ((Trim(Text1(6).Text) = "CFT" Or _
      Trim(Text1(6).Text) = "CFC" Or _
      Trim(Text1(6).Text) = "FCT" Or _
      Trim(Text1(6).Text) = "T" Or _
      Trim(Text1(6).Text) = "TB" Or _
      Trim(Text1(6).Text) = "TC" Or _
      Trim(Text1(6).Text) = "TF") And _
      (InStr(m_strCaseCPM, "501") > 0)) Then
          bChange = True
   End If
   'end 2018/12/03
   
   For ii = 1 To 5
      If Index = -1 Or Index = ii Then
         Select Case ii
            Case 1
               bNewCust = Option31(0).Value
            Case 2
               bNewCust = Option32(0).Value
            Case 3
               bNewCust = Option33(0).Value
            Case 4
               bNewCust = Option34(0).Value
            Case 5
               bNewCust = Option35(0).Value
         End Select
         If bNewCust = True Then
            cboContact(ii).Clear
            cboContact(ii).Enabled = True
            cboContact(ii).Tag = "1"
            m_strContactList(ii) = ""
         'Modified by Lydia 2018/12/03
         'ElseIf bNewCase = True Then
         ElseIf bNewCase = True Or bChange = True Then
            cboContact(ii).Enabled = True
            cboContact(ii).Tag = "0"
         Else
            cboContact(ii).Enabled = False
            cboContact(ii).Tag = "0"
         End If
         If cboContact(ii).ListIndex = -1 Then
            cboContact(ii) = ""
         End If
      End If
      If Index = ii Then Exit For
   Next
End Sub

'Modify by Morgan 2011/3/28 +pbolNoAsk
'Private Sub ChkLimitData(Optional pbolNoAsk As Boolean = False)
'Modify By Sindy 2023/3/1 Sub改為Function
Private Function ChkLimitData(Optional pbolNoAsk As Boolean = False) As Boolean
   ChkLimitData = False 'Add By Sindy 2023/3/1 不清除
   m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/9/1 取得案件性質代碼
   If pbolNoAsk = True Then Exit Function 'Add by Morgan 2011/3/28
   
'   If Combo1(1) <> "" Or Combo1(2) <> "" Or Combo1(3) <> "" Or Combo1(4) <> "" Or _
'      Text1(1) <> "" Or Text1(3) <> "" Then
   If (m_strCaseCPM <> "" Or Text1(1) <> "" Or Text1(3) <> "") And _
      cmdOK(0).Visible = True Then
      
      If MsgBox("是否清除已輸入的案件性質及期限？", vbYesNo + vbDefaultButton2) = vbYes Then
         ChkLimitData = True 'Add By Sindy 2023/3/1 選要清除
 'Add by Lydia 2015/01/06  改成模組FreeClear
         Call FreeClear
         
         Check2.Value = 0 'Add by Morgan 2010/12/29 --秀玲
         'Modified by Morgan 2020/5/7
         'Me.Text1(119).Text = "如案件內容摘要、引用條文與客戶洽談要旨等等......" & vbCrLf & _
         '                                    "商品類別：" & vbCrLf & _
         '                                    "商品名稱：" & vbCrLf & _
         '                                    "註冊號數：" & vbCrLf & _
         '                                    "優先權日：" & vbCrLf & _
         '                                    "優先權號：" & vbCrLf
         ''Add By Sindy 2010/5/27
         'If OptChoose(1).Value = True Then
         '   Me.Text1(119).Text = Me.Text1(119).Text & "聯絡人：" & vbCrLf & _
         '                                                                           "彼所案號：" & vbCrLf
         'End If
         SrcSetMemo OptChoose(1).Value
         'end 2020/5/7
         
         Call Text1_LostFocus(6)
      End If
   End If
End Function

'Add By Sindy 2010/4/22
'Modify by Morgan 2011/3/28 +pbolNoAsk
Private Sub CallFrm090801_2(Optional pbolNoAsk As Boolean = False)
Dim i As Integer, j As Integer
'Dim strCP10(1 To 4) As String
Dim strMsg As String 'Add by Amy 2016/09/19
Dim tmpArr As Variant 'Added by Lydia 2020/12/29
Dim intCP10Cnt As Integer
Dim bolIsClear As Boolean 'Add By Sindy 2023/3/1
   
   m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/9/1 取得案件性質代碼
   Erase m_strCP10Data
   'Added by Lydia 2025/02/20
   m_P601or605cp06 = ""
   m_P601or605cp07 = ""
   'end 2025/02/20
   
   Text1(7).Enabled = False '案號欄位鎖住
   'Add By Sindy 2010/11/22 解開本所期限及法定期限欄位
   Text1(1).Enabled = True
   Text1(3).Enabled = True
   '2010/11/22 End
   If Me.Text1(8).Text = "" Then Me.Text1(8).Text = "0"
   If Me.Text1(9).Text = "" Then Me.Text1(9).Text = "00"
   'end 'Modify by Lydia 2015/01/06 清除前案記錄
   Text1(6).Tag = Text1(6)
   Text1(7).Tag = Text1(7)
   Text1(8).Tag = Text1(8)
   Text1(9).Tag = Text1(9)
   
   'Add By Sindy 2015/4/1 查詢資料:0.一般1.延期下一程式
   Call frm090801_2.SetParent(Me)
   frm090801_2.strQType = "0"
   cmdOK(3).Caption = "期限資料(&L)"
   If ((Trim(Text1(6)) = "P" Or Trim(Text1(6)) = "CFP") And (InStr(m_strCaseCPM, "404") > 0 Or Trim(Left(Combo1(1).Text, 4)) = "404")) Or _
      ((Trim(Text1(6)) = "T" Or Trim(Text1(6)) = "CFT") And (InStr(m_strCaseCPM, "303") > 0 Or Trim(Left(Combo1(1).Text, 4)) = "303")) Then
      If Me.Option1(1).Value = True And Me.Text1(6).Text <> "" And Me.Text1(7).Text <> "" Then
         frm090801_2.strQType = "1"
         cmdOK(3).Caption = "欲延期期限"
      End If
   End If
   'Call ChkLimitData(pbolNoAsk)
   'Modify By Sindy 2023/3/1
   'If frm090801_2.strQType <> "1" Then Call ChkLimitData(pbolNoAsk)
   If frm090801_2.strQType = "1" Then
      bolIsClear = False
   Else
      bolIsClear = ChkLimitData(pbolNoAsk)
   End If
   '2023/3/1 END
   '2015/4/1 END
   cmdOK(3).Enabled = True
   'Add By Sindy 2023/3/1
   If bolIsClear = True Then
   '2023/3/1 END
      'Modify by Lydia 2015/01/06 清除前案記錄
      'If Text1(6).Text <> Text1(6).Tag Or _
         Text1(7).Text <> Text1(7).Tag Or _
         Text1(8).Text <> Text1(8).Tag Or _
         Text1(9).Text <> Text1(9).Tag Then
         m_Note1 = "": m_Note2 = ""
         m_strGetNP01 = "" 'Add By Sindy 2015/9/17
         Text1(142).Text = "": Text1(143).Text = "" 'Add By Sindy 2010/7/9
      'End If
      'Added by Lydia 2020/11/19
      strCaseNA239 = ""
      bolCase201 = False
      strCaseNA239new = "" 'Added by Lydia 2021/03/05
      strGetNp15 = "" 'Added by Lydia 2021/04/15
      'Modify By Sindy 2024/5/7 調整位置
      Frame605.Visible = False 'Add by Lydia 2014/12/15
      '2024/5/7 END
   End If
   
   frm090801_2.strNP02 = Me.Text1(6).Text
   frm090801_2.strNP03 = Me.Text1(7).Text
   frm090801_2.strNP04 = Me.Text1(8).Text
   frm090801_2.strNP05 = Me.Text1(9).Text
   
   'Modify By Sindy mark,調整位置忘上移
   'Frame605.Visible = False 'Add by Lydia 2014/12/15
   '2024/5/7 END
   
   'Modify By Sindy 2025/8/4 + And Not (Label1(84) = "C類來函：" And cmdOK(0).Caption = "送出")
   If Label1(84) = "C類來函：" And cmdOK(0).Caption = "送出" Then
      cmdOK(3).Enabled = False
   Else
   '2025/8/4 END
      If frm090801_2.doQuery Then
         'Modify by Amy 2016/12/20 +if 判斷系統別為P
         If Trim(Text1(6)) = "P" Then
           'Add by Amy 2016/09/10 +if 臺灣一案兩請新型案是否不可收文年費控制 ex:P-108013
           'Modify by Amy 2016/09/19 已收放棄專利權且已發文及已通知專利權公告作廢,不顯示年費期限 ex:P-104016
           If PUB_TwDualCaseUtyNoAdd605(Text1(6), Text1(7), Text1(8), Text1(9), Left(Me.Combo1(0).Text, 3)) = False And _
            ChkP429Or1606(Text1(6), Text1(7), Text1(8), Text1(9), Left(Me.Combo1(0).Text, 3)) = MsgText(601) Then
             If Text1(142).Text <> "" Then frm090801_2.Text21 = Text1(142).Text
             If Text1(143).Text <> "" Then frm090801_2.Text22 = Text1(143).Text
             DoEvents 'Add By Sindy 2025/9/23 必要,因才能解決frm090801_2開啟lock住
             frm090801_2.Show vbModal
           End If
         Else
             If Text1(142).Text <> "" Then frm090801_2.Text21 = Text1(142).Text
             If Text1(143).Text <> "" Then frm090801_2.Text22 = Text1(143).Text
             DoEvents 'Add By Sindy 2025/9/23 必要,因才能解決frm090801_2開啟lock住
             frm090801_2.Show vbModal
         End If
      Else
         cmdOK(3).Enabled = False
      End If
   End If
   Text1(7).Enabled = True '案號欄位解開
   
   If frm090801_2.bolOK = True Then
      strGetNp15 = Mid(frm090801_2.m_strNP15, 2) 'Added by Lydia 2021/04/15
      'Modify By Sindy 2015/4/2
      If cmdOK(3).Caption = "欲延期期限" Then
         m_Note1 = frm090801_2.m_Note1 'Add By Sindy 2015/9/4
         m_Note2 = frm090801_2.m_Note2
         m_strGetNP01 = frm090801_2.m_strGetNP01 'Add By Sindy 2015/9/17
         Frame605.Visible = True
         'Add By Sindy 2023/9/27
         Text1(142).Visible = False
         Text1(143).Visible = False
         '2023/9/27 END
         labelYF.Caption = m_Note2
         Text1(1).Text = frm090801_2.m_strCP07 '法定期限
         'Text1(2).Text = frm090801_2.m_strNP23 '約定期限
         Text1(3).Text = frm090801_2.m_strCP06 '本所期限
      Else
      '2015/4/2 END
'         strCP10(1) = frm090801_2.m_strCP10_1
'         strCP10(2) = frm090801_2.m_strCP10_2
'         strCP10(3) = frm090801_2.m_strCP10_3
'         strCP10(4) = frm090801_2.m_strCP10_4
         m_Note1 = m_Note1 & frm090801_2.m_Note1
         m_Note2 = m_Note2 & frm090801_2.m_Note2
         'm_strGetNP01 = frm090801_2.m_strGetNP01 'Add By Sindy 2015/9/17
         'Add By Sindy 2010/7/9
         Text1(142).Text = Replace(frm090801_2.Text21, "第", "")
         Text1(143).Text = frm090801_2.Text22
         '2010/7/9 End
         If Text1(143).Text = "" Then Text1(143).Text = Text1(142).Text 'Add by Morgan 2010/12/16 迄年沒有則與起年同(最後一年)
         'Add by Lydia 2014/12/15 提示年度訊息
         'Modified by Lydia 2014/12/25 統一繳費畫面和列印訊息,簡化區間為"~"
         If InStr(frm090801_2.Label1(10).Caption, "繳費") > 0 And m_Note2 <> "" Then
            Frame605.Visible = True
            m_Note2 = Replace(m_Note2, "年至第", " ~ ") '改frm090801_2訊息
            'labelYF.Caption = m_Note2
            If InStr(m_Note2, "繳費次數") > 0 Then
               'm_Note2=繳費次數：第3次(第16-20年)
               labelYF.Caption = "繳費次數：          ~"
               'Modify By Sindy 2023/1/10 延展費 ex:CFP-033629,CFP-033630
               If InStr(m_Note2, "次數：第") > 0 And Text1(142).Text = "" Then
                  strExc(9) = InStr(m_Note2, "次數：第") + Len("次數：第")
                  strExc(10) = InStr(m_Note2, "次(")
                  If Val(strExc(9)) > 0 And Val(strExc(10)) > 0 Then
                     Text1(142).Text = Mid(m_Note2, strExc(9), strExc(10) - strExc(9))
                     Text1(143).Text = Mid(m_Note2, strExc(9), strExc(10) - strExc(9))
                  End If
               End If
               '2023/1/10 END
            Else
               labelYF.Caption = "繳費年度：          ~"
            End If
         End If
         
         'ChkPatentYearFee(pa(9), pa(8), "Y00000001", "" & arrCaseProperty(0), strYF05From, strYF05To, IIf(strDouble = "Y", True, False), Val(Text1(Index)), strCP81) = False
         intCP10Cnt = frm090801_2.m_intCaseCnt '點選幾個案件性質
         For j = 1 To intCP10Cnt '4
            If Trim(m_strCP10Data(j)) <> "" Then
'               For i = 1 To 4
                  i = 1 'Modify By Sindy 2022/9/1
                  If Trim(Combo1(1).Text) = "" Then
                     Text1(1).Text = frm090801_2.m_strCP07 '法定期限
                     Text1(3).Text = frm090801_2.m_strCP06 '本所期限
                     'Added by Lydia 2025/02/20 P領證/年費的法限,所限; ex.P-124982同時收年費和代辦退費,期限抓到代辦退費,造成年費預設為逾期
                     m_P601or605cp07 = frm090801_2.m_PstrCP07
                     m_P601or605cp06 = frm090801_2.m_PstrCP06
                     'end 2025/02/20
                     
                     If Trim(Text1(1)) <> "" Then Text1(1).Enabled = False 'Add By Sindy 2014/12/10
                     If Trim(Text1(3)) <> "" Then Text1(3).Enabled = False 'Add By Sindy 2014/12/10
                     'Added by Lydia 2020/12/29 CFP案件收文時自動帶入已報價之費用：601,605,606,607及歐盟案613延展費(英國)
                     If InStr(m_strCP10Data(j), ",") > 0 Then
                          tmpArr = Empty
                          tmpArr = Split(m_strCP10Data(j), ",")
                          Combo1(1).Text = Trim(tmpArr(0)) '案件性質
                          Text1(101) = tmpArr(1) '費用
                          Text1(102) = tmpArr(2)  '規費
                          Text1(103) = Format(tmpArr(3), "###0.000")  '點數
                          
                          Call cmdUpd_Click '新增 Add By Sindy 2022/9/1
                     Else
                    'end 2020/12/29
                          Combo1(1).Text = Trim(m_strCP10Data(j)) 'Move by Lydia 2014/12/30 從”2010/11/22 End”下方移上來
                          
                          'Add By Sindy 2010/11/22 P案帶期限且為601或605者, 鎖住本所期限及法定期限欄位
                          If Trim(Text1(6)) = "P" And _
                              (Trim(Left(Trim(m_strCP10Data(j)), 4)) = "601" Or Trim(Left(Trim(m_strCP10Data(j)), 4)) = "605") Then
                             If Trim(Text1(1)) <> "" Then Text1(1).Enabled = False
                             If Trim(Text1(3)) <> "" Then Text1(3).Enabled = False
                             
                             'Add by Lydia 2014/12/15 台灣領證繳年費(自動收文)帶入年度相應的費用,並提示年度訊息
                             Call ChangePatentYearFee(1, Trim(Left(Trim(m_strCP10Data(j)), 4)), False)
                          End If
                          '2010/11/22 End
                          Call cmdUpd_Click '新增 Add By Sindy 2022/9/1
                     End If 'Added by Lydia 2020/12/29
                     Combo1(1).SetFocus
'                     Exit For
                  End If
'               Next i
            End If
         Next j
         If intCP10Cnt = 1 Then
            If GridCase.TextMatrix(1, 2) = "" Then
               Call GetGridCaseData(intCP10Cnt): Text1(101).SetFocus
            End If
         ElseIf GridCase.Rows - 1 > 1 Then
            'If Val(Text1(101)) > 0 Then
               For i = 1 To GridCase.Rows - 1
                  If GridCase.TextMatrix(i, 2) = "" Then
                     Call GetGridCaseData(i): Text1(101).SetFocus
                     Exit For
                  End If
               Next i
            'End If
         End If
      End If
   End If
   Unload frm090801_2
   Set frm090801_2 = Nothing
   
  '  Call settxtPCnt 'Add by Lydia 2015/01/14 案件性質不屬保留範圍者,分所保留一份
    
   '2011/5/5 add by sonia 先做第一案件性質欄的validate控制再指定回到第一案件性質欄
   Call Combo1_Validate(1, False)
'   Me.Text1(101).SetFocus
   '2011/5/5 END
End Sub

'Add By Sindy 2010/6/21
Private Function OnSaveData() As Boolean
Dim strSeqNo As String
Dim i As Integer, j As Integer, k As Integer
Dim varInventorNo As Variant, strInvNo As String, varInventorName As Variant
Dim lngSize As Long '檔案大小 'Add By Sindy 2017/6/2
Dim strReName As String, strFtpPath As String 'Add By Sindy 2017/6/2
Dim bolModify As Boolean 'False:新增 True:修改
Dim OldCRL() As String, OldCRA(1 To 27) As String
Dim bolMInser As Boolean
Dim intRow As Integer
Dim strSql As String
Dim intMaxEEP02 As Integer
Dim bolAddLos15 As Boolean 'Added by Morgan 2025/9/19
   
On Error GoTo CheckingErr
   
   Erase OldCRL
   ReDim Preserve OldCRL(TF_CRL) As String
   '存檔的狀況
   If cmdOK(0).Caption = "新增" Or cmdOK(0).Caption = "送出" Then
      bolModify = False
   Else
      bolModify = True
   End If
   
   'Modify By Sindy 2022/9/16 搬到此處儲存
   'Move by Lydia 2023/03/15 搬出BeginTrans; 從If bolModify = False Then 上面移過來
   'Added by Lydia 2016/04/25
   'Modified by Lydia 2023/08/02 判斷有修改待收文區的查名單勾選=>調整程式
'   If TMQList <> "" Then
'      pTMQList = TMQList  'Added by Lydia 2016/05/05
'      TMQList = Mid(TMQList, 1, Len(TMQList) - 1)
'      strExc(1) = TMQList
'      strExc(2) = Replace(strExc(1), ",", "")
'      'Remove by Lydia 2016/04/28
'      'If TypeName(m_PrevForm) = "frm090128" Then
'      '   '傳查名代號
'      '   m_PrevForm.mTMQ20 = mTQC01
'      'End If
'      'Modified by Lydia 2016/05/05
'      'mTQC01 = PUB_GetTMQCaseMapNo
'      If mTQC01 = "" Then
'JumpToReNo: 'Added by Lydia 2023/03/15
'         mTQC01 = PUB_GetTMQCaseMapNo
'         'Move by Lydia 2016/05/05 新增查名代號(收文組群)記錄->重印保留流水號
'         'cnnConnection.BeginTrans
'         strExc(3) = GetAddStr(TMQList)
'         'Added by Lydia 2023/03/15 新增前先檢查是否重覆流水號; ex.112000370
'         strSql = "select tqc01 from tmqcasemap where tqc01='" & mTQC01 & "' "
'         intI = 1
'         Set RsTemp = ClsLawReadRstMsg(intI, strSql)
'         If intI = 1 Then
'            GoTo JumpToReNo
'         Else
'         'end 2023/03/15
'            strSql = "insert into tmqcasemap(tqc01,tqc02,tqc03,tqc04,tqc05,tqc06)" & _
'                     " select '" & mTQC01 & "' ,null,tmq01,'" & strUserNum & "'," & strSrvDate(1) & "," & Left(Format(ServerTime, "000000"), 4) & " from trademarkquery where tmq01 in (" & strExc(3) & ") "
'            cnnConnection.Execute strSql
'         End If  'Added by Lydia 2023/03/15
'      End If
'      'end 2016/05/05
'
'      'Modify By Sindy 2022/9/14
'      m_Msgbox = "查名代號：" & Right(mTQC01, 6) & " (共" & IIf(Len(strExc(2)) = 9, "1", Len(strExc(1)) - Len(strExc(2)) + 1) & "張單)"
'      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
'         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
'      End If
'      '2022/9/14 END
'   End If
'   'end 2016/04/25
   If pTMQList <> TMQList Then
      If pTMQList <> "" Then
         '刪除對照檔,但不清除流水號CRL55
         strSql = "delete from tmqcasemap where tqc01='" & mTQC01 & "' "
         cnnConnection.Execute strSql
         If TMQList = "" Then
            m_Msgbox = "查名代號：" & Right(mTQC01, 6) & " (清除查名單)"
            If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
               txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
            End If
         End If
      End If
      If Replace(TMQList, ",", "") <> "" Then
         TMQList = Mid(TMQList, 1, Len(TMQList) - 1)
         strExc(1) = TMQList
         strExc(2) = Replace(strExc(1), ",", "")
         strExc(3) = GetAddStr(TMQList)
         If mTQC01 = "" Then
            mTQC01 = PUB_GetTMQCaseMapNo
         End If
         '新增前先檢查是否重覆流水號; ex.112000370
JumpToReNo:
         'Modified by Lyda 2023/08/21 debug: 排除記錄
         strSql = "select tqc01 from tmqcasemap where tqc01='" & mTQC01 & "' and tqc03<>'" & cntTQC自動記錄 & "' "
         intI = 1
         Set RsTemp = ClsLawReadRstMsg(intI, strSql)
         If intI = 1 Then
            mTQC01 = PUB_GetTMQCaseMapNo
            GoTo JumpToReNo
         End If
         'Added by Lydia 2024/11/11 查名單(網中)
         If m_UseTmqTma = "2" Then
            strSql = "insert into tmqcasemap(tqc01,tqc02,tqc03,tqc04,tqc05,tqc06)" & _
                     " select '" & mTQC01 & "' ,null,tma01,'" & strUserNum & "'," & strSrvDate(1) & "," & Left(Format(ServerTime, "000000"), 4) & " from TMQAppForm where tma01 in (" & strExc(3) & ") "
            cnnConnection.Execute strSql
         Else
         'end 2024/11/11
            strSql = "insert into tmqcasemap(tqc01,tqc02,tqc03,tqc04,tqc05,tqc06)" & _
                     " select '" & mTQC01 & "' ,null,tmq01,'" & strUserNum & "'," & strSrvDate(1) & "," & Left(Format(ServerTime, "000000"), 4) & " from trademarkquery where tmq01 in (" & strExc(3) & ") "
            cnnConnection.Execute strSql
         End If 'Added by Lydia 2024/11/11


         m_Msgbox = "查名代號：" & Right(mTQC01, 6) & " (共" & IIf(Len(strExc(2)) = 9, "1", Len(strExc(1)) - Len(strExc(2)) + 1) & "張單)"
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
   End If
   'end 2023/08/02

   OnSaveData = True
   cnnConnection.BeginTrans
   
   '值清空
   'Modified by Morgan 2013/3/19
   'For i = 1 To 73 '71
   For i = 1 To UBound(strCRL)
      strCRL(i) = ""
   Next i
   
   If bolModify = False Then '新增狀態
      '電腦自動給號
      strSeqNo = Empty
      strSeqNo = AutoNo_AA("AA", 7, 1) 'Modify By Sindy 2023/5/24 + , 1:Trans
      cmdOK(0).Enabled = False 'Add By Sindy 2025/8/21
   ElseIf Text5 = "" Then
      OnSaveData = False
      MsgBox "修改有問題，接洽單編號是空的!!"
      Exit Function
   Else
      strSeqNo = Text5.Text
      OldCRL(1) = strSeqNo
      If ClsPDReadCRLDatabase(OldCRL) = False Then
         GoTo CheckingErr
      End If
   End If
   
   '*****************
   '接洽記錄單主檔
   '*****************
   strCRL(1) = strSeqNo
   strCRL(2) = strSrvDate(1)
   '員工編號
   strCRL(3) = Trim(Text1(10))
   '業務區別
   strCRL(4) = Trim(Text1(0))
   '記錄單種類
   If OptChoose(0).Value = True Then
      strCRL(5) = "1" '國內
   Else
      strCRL(5) = "2" '大至台
   End If
   '是否新案
   If Option1(0).Value = True Or Is308Child = True Or bolPrintNewCase = True Then strCRL(6) = "Y"
   '系統別 (本所案號)
    strCRL(7) = Trim(Text1(6))
   '流水號 (本所案號)
   strCRL(8) = Trim(Text1(7))
   '追加案號 (本所案號)
   strCRL(9) = Trim(Text1(8))
   '多國多類碼 (本所案號)
   strCRL(10) = Trim(Text1(9))
   '是否PCT案
   If ChkPCT.Value = 1 Then strCRL(11) = "Y"
   '本所期限
   strCRL(12) = ChangeTStringToWString(Trim(Text1(3)))
   '法定期限
   strCRL(13) = ChangeTStringToWString(Trim(Text1(1)))
'   '約定期限
'   strCRL(14) = ChangeTStringToWString(Trim(Text1(2)))
   '申請國家
   strCRL(15) = Trim(Left(Trim(Combo1(0)), 4))
   '客戶案件案號
   strCRL(16) = Trim(Text1(18))
   '主題
   strCRL(17) = Trim(Text1(11))
   '對造是否為本所案戶
   If Check7(0).Value = 1 Then
      strCRL(18) = "Y"
   ElseIf Check7(1).Value = 1 Then
      strCRL(18) = "N"
   End If
   'strCRL(19)~strCRL(38) 不可用,保留舊資料:案件性質

   'L案件要維持列印，所以案件性質要回寫到下列欄位中
   If InStr(Text1(6), "L") > 0 Then
      intRow = 0
      For i = 1 To GridCase.Rows - 1
         For j = 1 To UBound(strCRC)
            strCRC(j) = ""
         Next j
         intRow = intRow + 1
         strCRC(3) = Mid(Trim(GridCase.TextMatrix(i, 1)), 1, InStr(Trim(GridCase.TextMatrix(i, 1)), " ") - 1)
         strCRC(4) = Trim(GridCase.TextMatrix(i, 2))
         If strCRC(4) <> "" Then strCRC(4) = Format(strCRC(4), "###0")
         strCRC(5) = Trim(GridCase.TextMatrix(i, 3))
         If strCRC(5) <> "" Then strCRC(5) = Format(strCRC(5), "###0")
         strCRC(6) = Trim(GridCase.TextMatrix(i, 4))
         If strCRC(6) <> "" Then strCRC(6) = Format(strCRC(6), "###0.000")
         strCRC(7) = Trim(GridCase.TextMatrix(i, 5))
         
         If intRow = 1 Then
            '案件性質1
            strCRL(19) = strCRC(3)
            '費用1
            strCRL(20) = strCRC(4)
            '規費1
            strCRL(21) = strCRC(5)
            '點數1
            strCRL(22) = strCRC(6)
            '備註1
            strCRL(23) = strCRC(7)
         ElseIf intRow = 2 Then
            '案件性質2
            strCRL(24) = strCRC(3)
            '費用2
            strCRL(25) = strCRC(4)
            '規費2
            strCRL(26) = strCRC(5)
            '點數2
            strCRL(27) = strCRC(6)
            '備註2
            strCRL(28) = strCRC(7)
         ElseIf intRow = 3 Then
            '案件性質3
            strCRL(29) = strCRC(3)
            '費用3
            strCRL(30) = strCRC(4)
            '規費3
            strCRL(31) = strCRC(5)
            '點數3
            strCRL(32) = strCRC(6)
            '備註3
            strCRL(33) = strCRC(7)
         ElseIf intRow = 4 Then
            '案件性質4
            strCRL(34) = strCRC(3)
            '費用4
            strCRL(35) = strCRC(4)
            '規費4
            strCRL(36) = strCRC(5)
            '點數4
            strCRL(37) = strCRC(6)
            '備註4
            strCRL(38) = strCRC(7)
         End If
      Next i
   End If
         
   '後金
   strCRL(39) = Text1(113)

   'Added by Morgan 2012/12/18
   '申請技術報告項數
   strCRL(40) = Text1(114)
   
   '收據抬頭種類
   If Option2(0).Value = True Then
      strCRL(41) = "1"
   ElseIf Option2(2).Value = True Then
      strCRL(41) = "2"
   ElseIf Option2(1).Value = True Then
      strCRL(41) = "3"
   End If
   '全銜 (收據抬頭 - 其他)
   strCRL(42) = Trim(cboTitle)
   '是否為現金
   If Check6(0).Value = 1 Then strCRL(43) = "Y"
   '現金
   strCRL(44) = Text1(116)
   '是否為支票
   If Check6(1).Value = 1 Then strCRL(45) = "Y"
   '到期日
   strCRL(46) = ChangeTStringToWString(Text1(117))
   'Added by Lydia 2023/11/13 DEBIT NOTE請款選項
   'Modified by Lydia 2023/11/14 排除外至台案件(MCTF) => strCRL(5) = "1" And Frame33(1).Visible = True
   If strCRL(41) = "2" And strCRL(5) = "1" And Frame33(1).Visible = True Then
      If optDB(0).Value = True Then
         strCRL(153) = "1"
      ElseIf optDB(1).Value = True Then
         If Check7(2).Value = 1 Then
           strCRL(153) = "2"
         Else
           strCRL(153) = "3"
         End If
      End If
   Else
      strCRL(153) = ""
   End If
   'end 2023/11/13
   
   '請貼印花
   If Check1.Value = 1 Then strCRL(47) = "Y"
   '預定收款日期
   strCRL(48) = ChangeTStringToWString(Text1(118))
   '收據公司
   'Added by Lydia 2020/03/30 改用公司別a0801
   If strSrvDate(1) >= 智慧所更名日 Then
       strCRL(49) = GetReceiptVal(Trim(Combo4), False)
   Else
   'end 2020/03/30
        If Trim(Combo4) = "專利法律" Then
           strCRL(49) = "1"
        ElseIf Trim(Combo4) = "專利商標" Then
           strCRL(49) = "2"
        'Add By Sindy 2013/12/13
        ElseIf Trim(Combo4) = "智權公司" Then
           strCRL(49) = "3"
        '2013/12/13 END
        End If
   End If 'Added by Lydia 2020/03/30
   '收據暫不列印
   If Check2.Value = 1 Then strCRL(50) = "Y"
   '客戶來源
   If Option4(0).Value = True Then
      strCRL(51) = "01"
   ElseIf Option4(3).Value = True Then
      strCRL(51) = "02"
   End If
   '案件來源
   If Option4(1).Value = True Then
      strCRL(52) = "1"
   ElseIf Option4(2).Value = True Then
      strCRL(52) = "2"
   End If
   '介紹人
   strCRL(53) = Trim(Text1(97))
   '其他
   strCRL(54) = Trim(Text1(99))
   '與總號
   strCRL(55) = Trim(Text1(100))
   '是否與總號相同
   If strCRL(55) <> "" Then 'Modify By Sindy 2023/2/2 +if
      If Option5(0).Value = True Then
         strCRL(56) = "Y"
      ElseIf Option5(1).Value = True Then
         strCRL(56) = "N"
      End If
   End If
   
   '案件說明處理事項
   'Modify by Morgan 2011/1/13 內容要存完整以便日後查詢或列印時不必重抓且資料才會一致
   'strCRL(57) = Trim(Text1(119))
   ''Add By Sindy 2010/11/22 有些變數資料要記錄起來
   ''延緩公告
   'If m_Note1 <> "" Then strCRL(57) = strCRL(57) & m_Note1
   ''繳費年度
   'If m_Note2 <> "" Then strCRL(57) = strCRL(57) & m_Note2
   'Modify by Amy 2016/09/01
   'Modified by Lydia 2020/05/05 配合「法律所案源收文」寫入CRL57
   'strCRL(57) = Replace(Replace(GetCRL57, "<m_stCRL134>", ""), "<m_stCRL135>", "")
   strCRL(57) = Trim(Text1(119)) '說明處理事項 Modify By Sindy 2022/9/15 人員輸入的和系統加註的資料區分開
   strCRL(70) = Trim(txtCRL70) '系統加註
   
   'Add By Sindy 2022/9/15
   '證書形式
   strCRL(59) = Trim(Text1(145))
   '關連表單編號
   strCRL(65) = Trim(Text1(144))
   '對造已簽准
   If ChkCRL66.Value = 1 Then strCRL(66) = "Y"
   If ChkCRL152.Value = 1 Then strCRL(152) = "Y" 'Add By Sindy 2023/4/7 自行送簽核
   '呈主管簽核
   strCRL(69) = Trim(txtCRL69)
   '2022/9/15 END
   
   '2010/11/22 End
   '申請優先權證明書
   strCRL(58) = Text1(4)
   
   '代理人
   strCRL(60) = Left(Trim(Text1(5).Text), 8)
   strCRL(61) = Right(Trim(Text1(5).Text), 1)
   '代理人中文名稱
   strCRL(62) = Trim(Text1(130))
   strCRL(77) = Trim(Text1(137)) '彼所案號 Add By Sindy 2022/10/14
      
   '商標圖種類
   If opt1(0).Value = True Then
      strCRL(63) = "1"
   ElseIf opt1(1).Value = True Then
      strCRL(63) = "2"
   ElseIf opt1(2).Value = True Then
      strCRL(63) = "3"
   ElseIf opt1(3).Value = True Then
      strCRL(63) = "4"
   ElseIf opt1(4).Value = True Then
      strCRL(63) = "5"
   End If
   '圖其他說明文字
   If PicText.Visible = True Then strCRL(64) = Trim(PicText)
   'Add By Sindy 2022/9/20 商標圖同卷號
   If Frame5.Visible = True And tmpImg.Picture <> 0 Then
      strCRL(75) = Trim(TxtC1(0)) & Trim(TxtC1(1)) & Trim(TxtC1(2)) & Trim(TxtC1(3))
   End If
   
   'Add By Sindy 2022/9/20 7501判決分析 提供書面分析 / 請律師向當事人說明
   If Frame41.Visible = True Then
      If Option9(0).Value = True Then
         strCRL(72) = "1" '提供書面分析
      ElseIf Option9(1).Value = True Then
         strCRL(72) = "2" '請律師向當事人說明
      End If
   End If
   
   'Add By Sindy 2022/9/20 1.查名代號
   If (TMQList <> "" And mTQC01 <> "") Or mTQC01 <> "" Then
      strCRL(55) = Trim(mTQC01)
      strCRL(74) = "1"
   ElseIf strCaseNA239 <> "" Then '2.英國脫歐案
      strCRL(55) = Trim(strCaseNA239)
      strCRL(74) = "2"
   'Modify By Sindy 2022/9/26 3.CFT緬甸重新申請案
   ElseIf Option1(0).Value = True And Text1(6).Text = "CFT" And Trim(Text1(7) & Text1(8) & Text1(9)) = "" _
      And Trim(Left(Combo1(0).Text, 4)) = "048" _
      And InStr(m_strCaseCPM & ",", "101,") > 0 _
      And strCaseNo1 <> "" And strCaseNo2 <> "" Then
      strCRL(55) = Trim(strCaseNo1) & Trim(strCaseNo2) & Trim(StrCaseNo3) & Trim(strCaseNo4)
      strCRL(74) = "3"
   'Add By Sindy 2025/8/4
   ElseIf Label1(84) = "C類來函：" And cmdOK(0).Caption = "送出" Then
      strCRL(74) = "4"
      '2025/8/4 END
   End If
   'Add By Sindy 2022/9/20 案源類別
   If strLSourceType <> "" Then
      strCRL(74) = strLSourceType
   End If
   
   'Add By Sindy 2022/9/23 分割成幾案
   If Is307or308 = True Then
      If Val(CountBy307308) > 0 And ((Trim(Left(Combo1(0).Text, 4)) = "000" And Text1(6) = "T") Or Text1(6) = "FCT") Then
         strCRL(76) = CountBy307308
      ElseIf Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T" Then
         strCRL(76) = "1"
      End If
   End If
   
'Modified by Lydia 2021/06/17 調整Index
   'Add By Sindy 2010/10/28 案件屬性
   If Combo5.Visible = True And Combo5.Text <> "" Then strCRL(81) = Left(Combo5, 1) '案件屬性
   
   'Add By Sindy 2010/11/22 送件方式
   If Frame18.Visible = True Then
      'Modify By Sindy 2023/4/24 + And OptSendType(0).Caption <> "不限制"
      'Modify By Sindy 2023/5/18 取消 And OptSendType(0).Caption <> "不限制"
      If OptSendType(0).Value = True Then
         strCRL(82) = "1"
      ElseIf OptSendType(1).Value = True Then
         strCRL(82) = "2"
      ElseIf OptSendType(2).Value = True Then
         strCRL(82) = "3"
      End If
      '指定送件日期
      strCRL(83) = ChangeTStringToWString(Text1(126))
      'Add By Sindy 2023/12/12 指定日期方式
      If OptCP164(0).Value = True Then
         strCRL(155) = "1"
      ElseIf OptCP164(1).Value = True Then
         strCRL(155) = "2"
      ElseIf OptCP164(2).Value = True Then
         strCRL(155) = "3"
      End If
      '2023/12/12 END
   End If
   
   'Add By Sindy 2011/6/7 法務案件屬性
   If Frame19.Visible = True Then
      If Text1(127).Text <> "" Then strCRL(84) = Text1(127).Text
   End If
   
   'Add By Sindy 2012/3/6
   '超頁超項備註
   If Frame16.Visible = True Then
      If Option3(0).Value = True Then
         strCRL(85) = "1"
      ElseIf Option3(1).Value = True Then
         strCRL(85) = "2"
      End If
   End If
   '加註查名結果
   If Frame20.Visible = True Then
      If Option6(0).Value = True Then
         strCRL(86) = "1"
      ElseIf Option6(1).Value = True Then
         strCRL(86) = "2"
      ElseIf Option6(2).Value = True Then
         strCRL(86) = "3"
      ElseIf Option6(3).Value = True Then
         strCRL(86) = "4"
      'Added b y Lydia 2016/09/22
      ElseIf Option6(4).Value = True Then
         strCRL(86) = "5"
      'Added b y Lydia 2018/11/13
      ElseIf Option6(5).Value = True Then
         strCRL(86) = "6"
      End If
      'Added by Lydia 2018/12/10 + 相同文字／圖形，申請人已註冊之審定號
      If Trim(Text1(133)) <> "" Then
         strCRL(136) = Trim(convForm(Text1(133), 60))
      End If
      'end 2018/12/10
   End If
   '2012/3/6 End
   
   'Add By Sindy 2012/4/26 商標種類代號
   If Combo6.Visible = True And Combo6.Text <> "" Then strCRL(87) = Left(Combo6, 1)
   'Add By Sindy 2012/5/8
   If Frame21.Visible = True Then
      '資料是否齊備
      If Frame22.Visible = True Then 'Added by Lydia 2018/12/10
        If OptEP06(0).Value = True Then
           strCRL(88) = "Y"
        ElseIf OptEP06(1).Value = True Then
           strCRL(88) = "N"
        End If
      End If
      '是否會稿
      If Frame23.Visible = True Then 'Added by Lydia 2018/12/10
        If OptEP34(0).Value = True Then
           strCRL(89) = "Y"
        ElseIf OptEP34(1).Value = True Then
           strCRL(89) = "N"
        End If
      End If
      '是否急件
      'Modify By Sindy 2022/11/8
'      If Frame24.Visible = True Then 'Added by Lydia 2018/12/10
'        If OptCP122(0).Value = True Then
'           strCRL(90) = "Y"
'        ElseIf OptCP122(1).Value = True Then
'           strCRL(90) = "N"
'        End If
'      End If
      '是否延期 Add by Amy 2016/06/06
      If Frame43.Visible = True Then
        If OptCRL133(0).Value = True Then
           strCRL(133) = "Y"
        ElseIf OptCRL133(1).Value = True Then
           strCRL(133) = "N"
        End If
      End If
      'Added by Lydia 2018/12/10 查名是否齊備
      If Frame42.Visible = True Then
        If OptCP143(0).Value = True Then
           strCRL(137) = "Y"
        ElseIf OptCP143(1).Value = True Then
           strCRL(137) = "N"
        End If
      End If
      'end 2018/12/10
   End If
   'Modify By Sindy 2022/11/8
   '急件
   If Check11.Value = 1 Then
      strCRL(90) = "Y"
   Else
      strCRL(90) = "N"
   End If
   '2022/11/8 END
   
   'Add By Sindy 2012/8/17 優惠期日
   If Frame25.Visible = True Then
      strCRL(91) = ChangeTStringToWString(Text1(128))
   End If
   
   'Add By Sindy 2012/11/12 收據自動列印時間點
   If Check8(0).Value = 1 Then
      strCRL(92) = "1"
   ElseIf Check8(1).Value = 1 Then
      strCRL(92) = "2"
   ElseIf Check8(2).Value = 1 Then
      strCRL(92) = "3"
   End If
   
   'Add By Sindy 2013/2/25
   '是否在該國有無近似案件
   If Frame27.Visible = True Then
      If Option8(0).Value = True Then
         strCRL(93) = "Y"
      ElseIf Option8(1).Value = True Then
         strCRL(93) = "N"
      End If
   End If
   '2013/2/25 End
'end 2021/06/17

If Frame28.Visible = True Then 'Added by Morgan 2023/7/6 有顯示才會寫，否則殘值會誤設定 Ex:CFP-033907
   'Modify By Sindy 2024/7/8 mark,改控制在 PUB_AutoRecvCRL_P,因不儲存接洽單無法查詢當時選項狀況
   'If Not (Text1(6).Text = "P" And Left(Trim(Combo1(0)), 3) = "020") Then 'Added by Morgan 2023/12/27
   '2024/7/8 END
      'Added by Morgan 2013/3/19 個體別
      If OptEntity(0).Value = True Then
         strCRL(94) = "1"
      ElseIf OptEntity(1).Value = True Then
         strCRL(94) = "2"
      ElseIf OptEntity(2).Value = True Then
         strCRL(94) = "3"
      End If
      'end 2013/3/19
   'End If
End If
   
   'Added by Morgan 2013/9/23 是否電子送件
   If Check4.Value = 1 Then
      strCRL(95) = "Y"
   End If
   'end 2013/9/23
   
   'Added by Morgan 2013/9/26 是否附英文摘要
   If Check5.Value = 1 Then
      strCRL(96) = "Y"
   End If
   'end 2013/9/26
   
   'Add By Sindy 2014/2/6 特殊收據
   strCRL(97) = "": strCRL(98) = "": strCRL(99) = "": strCRL(100) = ""
   strCRL(101) = "": strCRL(102) = "": strCRL(103) = "": strCRL(104) = "": strCRL(105) = ""
   strCRL(106) = "": strCRL(107) = "": strCRL(108) = "": strCRL(109) = "": strCRL(110) = ""
   strCRL(111) = "": strCRL(112) = "": strCRL(113) = "": strCRL(118) = "": strCRL(119) = ""
   strCRL(120) = "": strCRL(121) = "": strCRL(122) = "": strCRL(123) = ""
   'Add By Sindy 2015/8/28
   strCRL(114) = "": strCRL(115) = "": strCRL(116) = ""
   strCRL(117) = "": strCRL(124) = "": strCRL(126) = ""
   strCRL(127) = "": strCRL(128) = "": strCRL(129) = ""
   strCRL(130) = "": strCRL(131) = "": strCRL(132) = ""
   '2015/8/28 END
   If Check9.Value = 1 And cmdCRL119.Visible = True Then
      strCRL(97) = m_stCRL97
      strCRL(98) = m_stCRL98
      strCRL(99) = m_stCRL99
      strCRL(100) = m_stCRL100
      strCRL(101) = m_stCRL101
      strCRL(102) = m_stCRL102
      strCRL(103) = m_stCRL103
      strCRL(104) = m_stCRL104
      strCRL(105) = m_stCRL105
      strCRL(106) = m_stCRL106
      strCRL(107) = m_stCRL107
      strCRL(108) = m_stCRL108
      strCRL(109) = m_stCRL109
      strCRL(110) = m_stCRL110
      strCRL(111) = m_stCRL111
      strCRL(112) = m_stCRL112
      strCRL(113) = m_stCRL113
      strCRL(114) = m_stCRL114
      strCRL(115) = m_stCRL115
      strCRL(116) = m_stCRL116
      strCRL(117) = m_stCRL117
      strCRL(118) = m_stCRL118
      strCRL(119) = "Y"
      strCRL(120) = m_stCRL120
      strCRL(121) = m_stCRL121
      strCRL(122) = m_stCRL122
      strCRL(123) = m_stCRL123
      strCRL(124) = m_stCRL124
      'Add By Sindy 2015/8/28
      strCRL(126) = m_stCRL126
      strCRL(127) = m_stCRL127
      strCRL(128) = m_stCRL128
      strCRL(129) = m_stCRL129
      strCRL(130) = m_stCRL130
      strCRL(131) = m_stCRL131
      strCRL(132) = m_stCRL132
      '2015/8/28 END
   End If
   '2014/2/6 END
   
   'Add by Amy 2024/01/17 對造資料
   If strSrvDate(1) >= 風險警示啟用日 Then
      strCRL(156) = "": strCRL(157) = "": strCRL(158) = "": strCRL(159) = ""
      strCRL(156) = m_stCRL156
      strCRL(157) = m_stCRL157
      strCRL(158) = m_stCRL158
      strCRL(159) = m_stCRL159
   End If
   
   'Add By Sindy 2014/2/19 審定號
   'Modify By Sindy 2022/9/20 + 申請案號
   If Frame29.Visible = True Then
      strCRL(125) = Trim(Text1(129))
      strCRL(71) = Trim(Text1(132))
   Else
      strCRL(125) = ""
      strCRL(71) = ""
   End If
   'Add By Sindy 2022/9/28 記錄延期案的下一程序文號 ex:T.303
   'Modify By Sindy 2025/8/4 +
   If ((Left(Text1(6), 1) = "T" And InStr(m_strCaseCPM & ",", "303,") > 0) Or _
       (Label1(84) = "C類來函：" And cmdOK(0).Caption = "送出")) _
       And m_strGetNP01 <> "" Then
      strCRL(71) = m_strGetNP01
   End If
   '2022/9/28 END
   '2014/2/19 END
   
'   'Add  by Amy 2016/09/01 +CRL134(對造陳報主管)/135(原因)
'   strCRL(134) = IIf(m_stCRL134 = MsgText(601), m_stCRL134, Left(m_stCRL134, 5))
'   strCRL(135) = m_stCRL135
'   'end 2016/09/01
   
   'Added by Lydia 2019/11/05 特定申請人會稿案件
   If Frame45.Visible = True Then
      If Opt45(0).Value = True Then
          strCRL(138) = "Y"
      ElseIf Opt45(1).Value = True Then
          strCRL(138) = "N"
      End If
   End If
   
   'Added by Lydia 2021/02/24 大陸商標申請案及CFT申請案，均強迫填入相關資訊。
   If Frame47.Visible = True Then
       strCRL(139) = Text7
   Else
       strCRL(139) = ""
   End If
   'end 2021/02/24
   
   'Added by Morgan 2021/7/20 大陸發明生醫案是否新藥專利設定
   If Frame48.Visible = True Then
      If OptNewDrug(1).Value = True Then
          strCRL(140) = "Y"
      ElseIf OptNewDrug(0).Value = True Then
          strCRL(140) = "N"
      End If
   End If
   'end 2021/7/20
   
   'Modify By Sindy 2022/9/20
   '舉發聲明
   'Added by Morgan 2013/1/15
   If m_bolAdd803Memo = True Then
      For Each oChk In chkItem
         If oChk.Value = vbChecked Then
            If oChk.Index = 0 Then
               strCRL(141) = "1"
               strCRL(142) = txtItemCount
            ElseIf oChk.Index = 1 Then
               strCRL(141) = "2"
               strCRL(142) = txtItemList
            ElseIf oChk.Index = 6 Then
               strCRL(144) = DBDATE(txtYear(0) & Format(Val(txtMonth(0)), "00") & Format(Val(txtDay(0)), "00"))
               strCRL(145) = DBDATE(txtYear(1) & Format(Val(txtMonth(1)), "00") & Format(Val(txtDay(1)), "00"))
            Else
               If oChk.Index = 2 Then strCRL(143) = strCRL(143) & "1,"
               If oChk.Index = 3 Then strCRL(143) = strCRL(143) & "2,"
               If oChk.Index = 4 Then strCRL(143) = strCRL(143) & "3,"
               If oChk.Index = 5 Then strCRL(143) = strCRL(143) & "4,"
            End If
         End If
      Next
   End If
   'end 2013/1/15
   '2022/9/20 END
   
   'Add By Sindy 2022/10/14
   '聘任期間
   If Text1(139).Visible = True Then
      strCRL(144) = DBDATE(Text1(139))
      strCRL(145) = DBDATE(Text1(140))
   End If
   '年費起迄年度: ex:繳費年度：第 2  ~  3 年
   'If Frame605.Visible = True Then
   If m_Note2 <> "" Then
      If Text1(142).Visible = True Then strCRL(144) = Val(Text1(142).Text)
      If Text1(143).Visible = True Then strCRL(145) = Val(Text1(143).Text)
   End If
   
'Add By Sindy 2024/5/9 此2個常變數存入資料庫內, 因操作子畫面組出來的
'                      記錄下來, 以利人員新增後再回頭修改時才能保留住程式原狀況, 部分程式判斷上才不會出錯
   If m_Note1 <> "" Then
      strCRL(161) = m_Note1
   End If
   If m_Note2 <> "" Then
      strCRL(162) = m_Note2
   End If
'2024/5/9 End
   
   '商品類別
   If Frame58.Visible = True Then
      strCRL(73) = Trim(Text1(138))
   End If
   '2022/10/14 END
   strCRL(146) = m_strCRL146 '點數低於底價
   'Modify By Sindy 2022/12/13
   '費用已核准
   If Check12.Value = 1 Then
      strCRL(147) = "Y"
   Else
      strCRL(147) = "N"
   End If
   '2022/12/13 END
   'Add By Sindy 2022/12/26
   If chkEnglish.Visible = True Then
      If chkEnglish.Value = 1 Then
         strCRL(148) = "Y"
      Else
         strCRL(148) = "N"
      End If
   End If
   '2022/12/26 END
   
   strExc(1) = "": strExc(2) = ""
   '修改狀態
   If bolModify = True Then
      For i = 2 To UBound(strCRL)
         '不需修改的欄位:78, 79, 80
         If Trim(strCRL(i)) <> Trim(OldCRL(i)) And Not (i >= 78 And i <= 80) Then
            strExc(1) = strExc(1) & ", CRL" & Format(i, "00")
            Select Case i
               '名稱、地址或備註類+chgsql
               Case 16, 17, 23, 28, 33, 38, 54, 57, 62, 64, 67, 71 _
                    , 75, 98, 100, 101, 102, 104, 105, 106, 108, 109 _
                    , 110, 112, 113, 118, 135, 139
                  strExc(1) = strExc(1) & "=" & CNULL(ChgSQL(strCRL(i)))
               Case Else
                  strExc(1) = strExc(1) & "=" & CNULL(strCRL(i))
            End Select
         End If
      Next i
      If strExc(1) <> "" Then
         strExc(1) = Mid(strExc(1), 2)
         strSql = "UPDATE CONSULTRECORDLIST SET " & Mid(strExc(1), 2) & " WHERE CRL01='" & strSeqNo & "'"
         Pub_SeekTbLog strSql 'Add By Sindy 2023/3/1
         cnnConnection.Execute strSql
      End If
   '新增狀態
   Else
      For i = 1 To UBound(strCRL)
         If Trim("" & strCRL(i)) <> "" Then
            strExc(1) = strExc(1) & ", CRL" & Format(i, "00")
            Select Case i
               '名稱、地址或備註類+chgsql
               'Modify By Sindy 2023/7/13 +42.全銜收據抬頭
               Case 16, 17, 23, 28, 33, 38, 54, 57, 62, 64, 67, 71 _
                    , 75, 98, 100, 101, 102, 104, 105, 106, 108, 109 _
                    , 110, 112, 113, 118, 135, 139, 42
                  strExc(2) = strExc(2) & ", " & CNULL(ChgSQL(strCRL(i)))
               Case Else
                  strExc(2) = strExc(2) & ", " & CNULL(strCRL(i))
            End Select
         End If
      Next i
      strSql = "INSERT INTO CONSULTRECORDLIST (" & Mid(strExc(1), 2) & ") VALUES (" & Mid(strExc(2), 2) & ")"
      cnnConnection.Execute strSql
   End If
   
   'Add By Sindy 2022/8/29
   '*****************
   '案件性質
   '*****************
   If bolModify = True Then
      If GridCase.Tag = "有異動" Then
         strSql = "delete from ConsultRecCMP where CRC01='" & strSeqNo & "'"
         cnnConnection.Execute strSql
      Else
         GoTo SaveCRA '不用修改,跳過
      End If
   End If
   For i = 1 To GridCase.Rows - 1
      strCRC(1) = strSeqNo
      strCRC(2) = i
      strCRC(3) = Mid(Trim(GridCase.TextMatrix(i, 1)), 1, InStr(Trim(GridCase.TextMatrix(i, 1)), " ") - 1)
      strCRC(4) = Trim(GridCase.TextMatrix(i, 2))
      If strCRC(4) <> "" Then strCRC(4) = Format(strCRC(4), "###0")
      strCRC(5) = Trim(GridCase.TextMatrix(i, 3))
      If strCRC(5) <> "" Then strCRC(5) = Format(strCRC(5), "###0")
      strCRC(6) = Trim(GridCase.TextMatrix(i, 4))
      If strCRC(6) <> "" Then strCRC(6) = Format(strCRC(6), "###0.000")
      strCRC(7) = Trim(GridCase.TextMatrix(i, 5))
      strCRC(8) = Trim(GridCase.TextMatrix(i, 16)) 'Add By Sindy 2025/4/14
      'Modify By Sindy 2025/4/14 +,CRC13
      'Modify By Sindy 2025/8/15 +,CRC14
      strSql = "insert into ConsultRecCMP(CRC01,CRC02,CRC03,CRC04,CRC05,CRC06,CRC07,CRC13,CRC14) " & _
                  "values(" & CNULL(strCRC(1)) & "," & strCRC(2) & "," & CNULL(strCRC(3)) & _
                  "," & CNULL(strCRC(4)) & "," & CNULL(strCRC(5)) & "," & CNULL(strCRC(6)) & _
                  "," & CNULL(ChgSQL(strCRC(7))) & "," & CNULL(strCRC(8)) & "," & CNULL(IIf(strCRC(3) = "403" Or strCRC(3) = "407", m_strCRC14, "")) & ") "
      cnnConnection.Execute strSql
   Next i
   '2022/8/29 END
   
SaveCRA:
   '*****************
   '申請人
   '*****************
   For i = 0 To 4
      bolMInser = False
      If bolModify = True Then
         OldCRA(1) = strSeqNo
         If ClsPDReadCRADatabase(OldCRA, i + 1) = False Then
            bolMInser = True
         End If
      End If
      
      '值清空
      For k = 1 To UBound(strCRA)
         strCRA(k) = ""
      Next k
      
      '代表有輸入資料:
      If Trim(Me.Text1(21 + i * 16).Text) <> "" Or Trim(Me.Text1(22 + i * 16).Text) <> "" Then
         strCRA(1) = strSeqNo
         strCRA(2) = i + 1
         '是否為新客戶
         strCRA(3) = ""
         If i = 0 And Option31(0).Value = True Then strCRA(3) = "Y"
         If i = 1 And Option32(0).Value = True Then strCRA(3) = "Y"
         If i = 2 And Option33(0).Value = True Then strCRA(3) = "Y"
         If i = 3 And Option34(0).Value = True Then strCRA(3) = "Y"
         If i = 4 And Option35(0).Value = True Then strCRA(3) = "Y"
         '關係企業
         strCRA(4) = Trim(Me.Text1(198 + i * 100).Text)
         '客戶編號
         strCRA(5) = Left(Trim(Me.Text1(12 + i * 16).Text), 8)
         strCRA(6) = Right(Trim(Me.Text1(12 + i * 16).Text), 1)
         '中文客戶名稱
         strCRA(7) = Trim(Me.Text1(21 + i * 16).Text) 'Modify By Sindy 2025/6/23 +Trim 'Modify by Amy 2016/10/06 造字會錯,拿掉Trim ex:P-107354 大至台
         '英文客戶名稱
         strCRA(8) = Trim(Me.Text1(22 + i * 16).Text)
         '公司負責人
         strCRA(9) = Trim(Me.Text1(23 + i * 16).Text) 'Modify By Sindy 2025/6/23 +Trim 'Modify by Amy 2016/10/06 造字會錯,拿掉Trim
         '接洽人
         strCRA(10) = Trim(cboContact(i + 1).Text)
         '客戶國籍中文
         strCRA(11) = Trim(Me.Text1(34 + i * 16).Text)
         'ID
         strCRA(12) = Trim(Me.Text1(92 + i).Text)
         'TEL1
         strCRA(13) = Trim(Me.Text1(14 + i * 16).Text)
         'TEL2
         strCRA(14) = Trim(Me.Text1(15 + i * 16).Text)
         'FAX1
         strCRA(15) = Trim(Me.Text1(16 + i * 16).Text)
         'FAX2
         strCRA(16) = Trim(Me.Text1(17 + i * 16).Text)
         'E-Mail
         strCRA(17) = Trim(Me.Text1(19 + i * 16).Text)
         '手機
         strCRA(18) = Trim(Me.Text1(20 + i * 16).Text)
         '中文地址郵遞區號
         strCRA(19) = Trim(Me.Text1(120 + i).Text)
         '客戶中文地址
         strCRA(20) = Trim(Me.Text1(27 + i * 16).Text) 'Modify By Sindy 2025/6/23 +Trim 'Modify by Amy 2016/10/06 造字會錯,拿掉Trim
         '客戶英文地址
         strCRA(21) = Trim(Me.Text1(125 + i * 16).Text)
         '聯絡地址郵遞區號
         strCRA(22) = Trim(Me.Text1(25 + i * 16).Text)
         '聯絡地址
         strCRA(23) = Trim(Me.Text1(26 + i * 16).Text)
         '公司負責人英文名稱
         strCRA(24) = Trim(Me.Text1(24 + i * 16).Text)
         '是否符合年費減免
         strCRA(25) = ""
         If i = 0 Then
            If optCP811(0).Value = True Then strCRA(25) = "Y"
            If optCP811(1).Value = True Then strCRA(25) = "N"
         End If
         If i = 1 Then
            If optCP812(0).Value = True Then strCRA(25) = "Y"
            If optCP812(1).Value = True Then strCRA(25) = "N"
         End If
         If i = 2 Then
            If optCP813(0).Value = True Then strCRA(25) = "Y"
            If optCP813(1).Value = True Then strCRA(25) = "N"
         End If
         If i = 3 Then
            If optCP814(0).Value = True Then strCRA(25) = "Y"
            If optCP814(1).Value = True Then strCRA(25) = "N"
         End If
         If i = 4 Then
            If optCP815(0).Value = True Then strCRA(25) = "Y"
            If optCP815(1).Value = True Then strCRA(25) = "N"
         End If
         'Add By Sindy 2022/9/15
         strCRA(26) = ""
         If ChkCRA26(i).Value = 1 Then
            strCRA(26) = "Y"
         End If
         strCRA(27) = ""
         If ChkCRA27(i).Value = 1 Then
            strCRA(27) = "Y"
         End If
         '2022/9/15 END
      End If
      
      '有申請人中、英文名稱時執行新增
      '或 修改新增
      If strCRA(1) <> "" And (bolModify = False Or bolMInser = True) Then
         'Modified by Morgan 2013/4/9 要指定欄位否則新增欄位時會出錯
         'Modify By Sindy 2022/9/15 + ,cra26,cra27
         strSql = "insert into consultrecapp(cra01,cra02,cra03,cra04,cra05,cra06,cra07,cra08,cra09,cra10" & _
                  ",cra11,cra12,cra13,cra14,cra15,cra16,cra17,cra18,cra19,cra20,cra21,cra22,cra23,cra24,cra25,cra26,cra27) " & _
                  "values(" & CNULL(strCRA(1)) & "," & CNULL(strCRA(2)) & "," & CNULL(strCRA(3)) & "," & CNULL(strCRA(4)) & "," & CNULL(strCRA(5)) & "," & CNULL(strCRA(6)) & "," & CNULL(strCRA(7)) & "," & CNULL(ChgSQL(strCRA(8))) & "," & CNULL(strCRA(9)) & "," & CNULL(ChgSQL(strCRA(10))) & _
                  "," & CNULL(strCRA(11)) & "," & CNULL(strCRA(12)) & "," & CNULL(strCRA(13)) & "," & CNULL(strCRA(14)) & "," & CNULL(strCRA(15)) & "," & CNULL(strCRA(16)) & "," & CNULL(ChgSQL(strCRA(17))) & "," & CNULL(strCRA(18)) & "," & CNULL(strCRA(19)) & "," & CNULL(ChgSQL(strCRA(20))) & _
                  "," & CNULL(ChgSQL(strCRA(21))) & "," & CNULL(strCRA(22)) & "," & CNULL(ChgSQL(strCRA(23))) & "," & CNULL(ChgSQL(strCRA(24))) & "," & CNULL(strCRA(25)) & "," & CNULL(strCRA(26)) & "," & CNULL(strCRA(27)) & ") "
         cnnConnection.Execute strSql
         
      ElseIf bolModify = True Then
         If bolMInser = False And strCRA(1) = "" Then
            strSql = "delete from consultrecapp WHERE cra01='" & strSeqNo & "' and cra02=" & (i + 1)
            cnnConnection.Execute strSql
         ElseIf strCRA(1) <> "" Then
            strExc(1) = ""
            For j = 3 To UBound(strCRA)
               If Trim(strCRA(j)) <> Trim(OldCRA(j)) Then
                  strExc(1) = strExc(1) & ", CRA" & Format(j, "00")
                  Select Case j
                     '名稱、地址或備註類+chgsql
                     Case 8, 10, 20, 21, 23, 24
                        strExc(1) = strExc(1) & "=" & CNULL(ChgSQL(strCRA(j)))
                     Case Else
                        strExc(1) = strExc(1) & "=" & CNULL(strCRA(j))
                  End Select
               End If
            Next j
            If strExc(1) <> "" Then
               strExc(1) = Mid(strExc(1), 2)
               strSql = "UPDATE consultrecapp SET " & Mid(strExc(1), 2) & " WHERE cra01='" & strCRA(1) & "' and cra02=" & strCRA(2)
               cnnConnection.Execute strSql
            End If
         End If
      End If
   Next i
   
SaveCRi:
   '*****************
   '發明人
   '*****************
   If bolModify = True Then
'      If cmdInventor.Tag <> strInventorNo Then
         strSql = "delete from consultrecinv where CRi01='" & strSeqNo & "'"
         cnnConnection.Execute strSql
'      Else
'         GoTo SavePic '不用修改,跳過
'      End If
   End If
   j = 0: k = 0
   If strInventorNo <> "" Then
      varInventorNo = Split(strInventorNo, ",")
      'Modify By Sindy 2023/6/2 不使用","因名稱有 X8479101-02 張簡,旭珂
      varInventorName = Split(strInventorName, "|") 'Add By Sindy 2011/1/31
      j = UBound(varInventorNo)
   End If
   For i = 0 To 9
      strInvNo = ""
      If Text2(i) <> "" Then
         'Modify By Sindy 2011/1/31 改以發明人姓名取得發明人ID, 因新發明人有可能在第一順位
         'If i <= j And strInventorNo <> "" Then strInvNo = varInventorNo(i)
         If InStr(strInventorName, Trim(Text2(i))) > 0 And strInventorNo <> "" Then
            For k = 0 To UBound(varInventorName)
               'Modify By Sindy 2024/5/8 +ID P-133476 X530940125,27 發明人的中文同名同姓
               If Trim(varInventorName(k)) = Trim(Text2(i)) & Trim(Text3(i)) Then
                  strInvNo = varInventorNo(k)
                  Exit For
               End If
            Next k
         End If
         '2011/1/31 End
         strSql = "insert into consultrecinv " & _
                      "values(" & CNULL(strSeqNo) & "," & CNULL(Right("00" & (i + 1), 2)) & "," & CNULL(Left(strInvNo, 8)) & "," & CNULL(Mid(strInvNo, 9, 2)) & "," & CNULL(Text3(i)) & "," & CNULL(Text2(i)) & "," & CNULL(Text4(i)) & "," & CNULL(Combo3(i)) & "," & CNULL(IIf(ChkAddress(i).Value = 1, "Y", "")) & ") "
         cnnConnection.Execute strSql
      End If
   Next i
   
SavePic:
   '*****************
   '商標圖檔
   '*****************
   '############ Memo by Morgan 2010/12/9 將來要存圖檔時檢查要改到 Transaction 前 ############
   'Modify By Sindy 2023/6/14 mark
'   If bolModify = True Then
'      If cmdPic.Tag = "有異動" Then
'         strSql = "delete from consultrecimagef where crif01='" & strSeqNo & "'"
'         cnnConnection.Execute strSql
'      Else
'         GoTo SaveOther '不用修改,跳過
'      End If
'   End If
   If (opt1(1).Value = True Or opt1(3).Value = True) And tmpImg.Picture <> 0 Then '圖形附檔,同卷號
      strSql = "delete from consultrecimagef where crif01='" & strSeqNo & "'"
      cnnConnection.Execute strSql
      '2023/6/14 END
      
      '存圖檔
      'add by nickc 2007/11/19 加入回傳圖片
      DoEvents
      Set PicRs = New ADODB.Recordset
      PicRs.CursorLocation = adUseClient
      PicRs.Open "select * from consultrecimagef where crif01='" & strSeqNo & "' ", cnnConnection, adOpenStatic, adLockOptimistic
      IsWmf = False
      If Dir(App.path & "\NowPic.jpg") <> "" Then Kill App.path & "\NowPic.jpg"
      If Dir(App.path & "\NowPic.bmp") <> "" Then Kill App.path & "\NowPic.bmp"
      SavePicture G_SeekPicColor.Picture, App.path & "\NowPic.bmp"
      PicToObj App.path & "\NowPic.bmp"
      If file_num > 0 Then Close #file_num
      file_num = FreeFile
      Open App.path & "\NowPic.jpg" For Binary Access Read As #file_num
      lngSize = LOF(file_num)
      'add by nickc 2007/09/27 超過 300K 秀錯誤
      If LOF(file_num) > 307200 Then
         If Pub_StrUserSt03 = "M51" Then
            If MsgBox("檔案太大！" & vbCrLf & "請去除不必要的陰影及複雜線條，或縮小檔案！" & vbCrLf & "是否還是要存入??", vbCritical + vbYesNo, "發生錯誤！") = vbNo Then
               Screen.MousePointer = vbDefault
               Close #file_num
               Exit Function
            End If
         Else
            MsgBox "檔案太大！" & vbCrLf & "請去除不必要的陰影及複雜線條，或縮小檔案！", vbCritical, "發生錯誤！"
            Screen.MousePointer = vbDefault
            Close #file_num
            Exit Function
         End If
      End If
      Close #file_num
      strReName = lngSize & ".jpg"
      ' 檔案改放FTP
      PUB_PutFtpFile App.path & "\NowPic.jpg", strSeqNo, strReName, strFtpPath, UCase("consultrecimagef")
      If strFtpPath <> "" Then
         '更新資料庫資料
         strSql = "insert into consultrecimagef(crif01,crif02,crif03,crif05)" & _
                  " values('" & strSeqNo & "','" & IIf(optColor(1).Value = True, IIf(IsWmf = True, "4", "2"), IIf(IsWmf = True, "3", "1")) & "'" & _
                  ",'" & lngSize & "','" & strFtpPath & "')"
         cnnConnection.Execute strSql
      Else
         GoTo CheckingErr
      End If
      
'         ReDim bytes(LOF(file_num))
'         Get #file_num, , bytes()
'         PicRs.AddNew
'         PicRs.Fields("crif01").Value = strSeqNo
'         PicRs.Fields("crif02").Value = IIf(optColor(1).Value = True, IIf(IsWmf = True, "4", "2"), IIf(IsWmf = True, "3", "1"))
'         PicRs.Fields("crif03").Value = Trim(LOF(file_num))
'         PicRs.Fields("crif04").Value = Null
'         PicRs.Fields("crif04").AppendChunk bytes()
'         PicRs.UPDATE
'         Close #file_num
      
      If Dir(App.path & "\tmp.jpg") <> "" Then
         Kill App.path & "\tmp.jpg"
      End If
      If Dir(App.path & "\tmp.tif") <> "" Then
         Kill App.path & "\tmp.tif"
      End If
      If Dir(App.path & "\tmp1.tif") <> "" Then
         Kill App.path & "\tmp1.tif"
      End If
      If Dir(App.path & "\tmp.bmp") <> "" Then
         Kill App.path & "\tmp.bmp"
      End If
      If Dir(App.path & "\NowPic.wmf") <> "" Then
         Kill App.path & "\NowPic.wmf"
      End If
      If Dir(App.path & "\NowPic.jpg") <> "" Then
         Kill App.path & "\NowPic.jpg"
      End If
      If Dir(App.path & "\NowPic.bmp") <> "" Then
         Kill App.path & "\NowPic.bmp"
      End If
   End If
   
SaveOther:
   'Added by Morgan 2020/4/17
   '案源，若有點選檔案則先上傳到卷宗區(同列印模式)
   If strLSourceType <> "" Then
      'Add By Sindy 2022/10/3 + if
      If m_blnCallPrint = False Then
      '2022/10/3 END
      
         '法律所案件
         If cmdOK(5).Visible = True Then
            If strLSourceType = "B1" And strLCaseCP10 = "78" Then
               strSql = "update LawOfficeSource set LOS20='" & strCRL(1) & "',LOS19='',LOS22='" & strLawMan & "',LOS23=" & CNULL(strCtrlDate) & " where LOS15='" & strLOS15 & "' and LOS20 is null"
               cnnConnection.Execute strSql, intI
               
            Else
               strLOS17 = strCRL(1)
               'AB類收文 TT-999999
               'Removed by Morgan 2021/7/19 取消 C類案源
               'If strLSourceType = "C" Then
               '   strTTCP09 = ""
               '   strTTCP10 = ""
               'Else
               'end 2021/7/19
               
                  strTTCP09 = AutoNo("A", 6, 1) '收文號 'Modify By Sindy 2023/5/24 + , 1:Trans
                  
                  'Add By Sindy 2024/4/8 第一個客戶若其CU13為MCTF開頭，且介紹人存在於系統特殊設定「MCTMember」時，
                  '存入TT-999999之進度檔時CP161存CU13。
                  strExc(9) = ""
                  If InStr(Pub_GetSpecMan("MCTMember"), strIntroducer) > 0 And strIntroducer <> "" Then
                     '先抓代理人的FA120
                     If Frame13.Visible = True And Text1(5).Text <> "" Then
                        strSql = "Select fa120 From fagent Where fa01='" & Left(Trim(Text1(5).Text), 8) & "' AND fa02='0'"
                        intI = 1
                        Set RsTemp = ClsLawReadRstMsg(intI, strSql)
                        If intI = 1 Then
                           strExc(9) = "" & RsTemp.Fields("fa120")
                        End If
                     End If
                     If Left(Trim(strExc(9)), 4) <> "MCTF" Then
                        strExc(9) = ""
                        '再抓申請人1的CU13
                        If Option31(1).Value = True Then '舊客戶
                           strExc(10) = GetCuSales(Text1(12), strExc(9))
                        End If
                        If Left(Trim(strExc(9)), 4) <> "MCTF" Then
                           strExc(9) = ""
                        End If
                     End If
                  End If
                  '2024/4/8 END
                  '進度
                  'Modified by Morgan 2020/7/30 +上發文日
                  'Modified by Morgan 2020/8/11 CP20,CP32都上N--秀玲
                  'Modify By Sindy 2024/4/8 +CP161=收文MCTF組別
                  strSql = "insert into caseprogress(cp01,cp02,cp03,cp04,cp05,cp09,cp10,cp11,cp12,cp13,cp20,cp27,cp32,cp140,cp161)" & _
                     " values('TT','999999','0','00'," & strSrvDate(1) & ",'" & strTTCP09 & "'" & _
                     ",'" & strTTCP10 & "','07','" & strCRL(4) & "','" & strCRL(3) & "','N'," & strSrvDate(1) & ",'N','" & strCRL(1) & "'," & CNULL(strExc(9)) & ")"
                  cnnConnection.Execute strSql, intI
                  'Modify By Sindy 2025/7/8 此欄位不可含在 insert 語法裡寫,因有Trigger(CASEPROGRESS_BEFORE2)會受影響
                  'Modify By Sindy 2025/6/11 秀玲:寫入TT-999999時若CRL60(接洽單之代理人編號)有值請同時寫入CP139
                  If Trim(Text1(5)) <> "" Then
                     strSql = "update caseprogress set cp139=" & CNULL(Trim(Text1(5))) & _
                              " where cp09='" & strTTCP09 & "'"
                     cnnConnection.Execute strSql, intI
                  End If
                  '2025/7/8 END
                  
                  'A1、A2類預設不請款，不開收據，等費用更新才清除
                  'Modified by Morgan 2020/7/23 A類都要預設(都不開收據)--秀玲
                  'If strLSourceType = "A" Then
                  'Removed by Morgan 2020/8/11 B類不開收據也要上N(改在insert預設)--秀玲
                  'If Left(strLSourceType, 1) = "A" Then
                  'strSql = "update caseprogress set cp20='N',cp32='N' where cp09='" & strTTCP09 & "'"
                  'cnnConnection.Execute strSql, intI
                  'End If
                  'end 2020/8/11
                                 
                  '卷宗區
                  strSql = "insert into casepaperpdf(cpp01,cpp02,cpp03,CPP05,CPP06,CPP07,cpp08,cpp09,cpp10)" & _
                           " values('" & strTTCP09 & "','" & PUB_CaseNo2FileName("TT", "999999", "0", "00") & _
                                   "." & strTTCP10 & "." & EMP_接洽單 & ".menu',0,'" & strUserNum & "'," & _
                                   strSrvDate(1) & ",to_char(sysdate,'hh24miss')," & _
                                   strSrvDate(1) & ",to_char(sysdate,'hh24miss'),'Y')"
                  cnnConnection.Execute strSql, intI
                  
               'End If 'Removed by Morgan 2021/7/19 取消 C類案源
               
               '新增案源
               If strLOS15 = "" Then
                  strLOS15 = AutoNo("LOS", 5, 1, True) 'Modify By Sindy 2023/5/24 + , 1:Trans
                  bolAddLos15 = True 'Added by Morgan 2025/9/19
               Else
                  strSql = "delete LawOfficeSource where LOS15='" & strLOS15 & "'"
                  cnnConnection.Execute strSql, intI
               End If
               strSql = "insert into LawOfficeSource(LOS01,LOS02,LOS03,LOS04,LOS05,LOS10,LOS11,LOS12,LOS13,LOS15,LOS16,LOS17,LOS18,LOS19)" & _
                  " values ('" & IIf(Left(strLSourceType, 1) = "A", strTTCP09, "") & "','" & strLSourceType & "','" & strLawMan & "'" & _
                  ",'" & strIntroducer & "','" & Text1(12) & "','" & strTTCP09 & "'" & _
                  ",'" & strUserNum & "'," & strSrvDate(1) & ",to_char(sysdate,'hh24miss'),'" & strLOS15 & "'," & CNULL(strCtrlDate) & ",'" & strCRL(1) & "','" & strLOS18 & "','" & strPTCP10 & "')"
               cnnConnection.Execute strSql, intI
               
               'A類要EMail 通知法務人員/窗口(BC類在分案)
               If Left(strLSourceType, 1) = "A" Then
                  'Modified by Morgan 2020/5/26
                  'If strLawMan <> "" Then
                  '   strExc(1) = strLawMan
                  'Else
                  '   strExc(1) = PUB_GetLawCaseWindow(strCRL(3))
                  'End If
                  'strExc(2) = PUB_ReadUserData(strIntroducer)
                  'strExc(3) = "已新增案源(介紹人:" & strExc(2) & ", 案源單號:" & strLOS15 & ")，請執行案源管理作業！"
                  'strExc(4) = "法律所案號：" & strCRL(7) & IIf(strCRL(8) = "", "", "-" & strCRL(8) & "-" & strCRL(9) & "-" & strCRL(10)) & vbCrLf & _
                     "主題：　　" & strCRL(17) & vbCrLf & vbCrLf & _
                     "介紹日期：" & ChangeTStringToTDateString(strSrvDate(2)) & vbCrLf & _
                     "介紹人：　" & strExc(2) & vbCrLf & _
                     IIf(strCtrlDate = "", "", "管制日期：" & ChangeWStringToTDateString(strCtrlDate) & vbCrLf) & _
                     "介紹客戶：" & strCRA(7) & vbCrLf & _
                     "介紹內容：" & strCRL(57)
                  
                  'strSql = "insert into mailcache(mc01,mc02,mc03,mc04,mc07,mc08)" & _
                           " values ('" & strUserNum & "','" & strExc(1) & "'," & strSrvDate(1) & ",to_char(sysdate,'hh24miss')" & _
                           ",'" & ChgSQL(strExc(3)) & "','" & ChgSQL(strExc(4)) & "')"
                  'cnnConnection.Execute strSql, intI
   'Modify By Sindy 發mail改到Flow裡(GetNextProPerson_Flow)
   '               PUB_AddMailCache_LOS "1", strLOS15
                  'end 2020/5/26
               End If
            End If
            
            'Add By Sindy 2022/10/6 更新相關案號=案源單號
            strSql = "Select CRL55 From ConsultRecordList where CRL01='" & strCRL(1) & "' and CRL55 is not null"
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strSql)
            If intI = 1 Then
               'Modify By Sindy 2024/9/25 + and instr(CRL55,'" & strLOS15 & "')=0: 排除重覆的
               strSql = "update ConsultRecordList set CRL55='" & RsTemp.Fields("CRL55") & "," & strLOS15 & "' where CRL01='" & strCRL(1) & "' and instr(CRL55,'" & strLOS15 & "')=0"
               cnnConnection.Execute strSql, intI
            Else
               strSql = "update ConsultRecordList set CRL55='" & strLOS15 & "' where CRL01='" & strCRL(1) & "'"
               cnnConnection.Execute strSql, intI
            End If
            '2022/10/6 END
            
         'P/T案
         Else
            strLOS18 = strCRL(1)
            If strLOS15 <> "" Then
               strSql = "update LawOfficeSource set LOS18='" & strLOS18 & "',LOS19='" & strLCaseCP10 & "' where LOS15='" & strLOS15 & "' and LOS18 is null"
               cnnConnection.Execute strSql, intI
               
            Else
               strLOS15 = AutoNo("LOS", 5, 1, True) 'Modify By Sindy 2023/5/24 + , 1:Trans
               strSql = "insert into LawOfficeSource(LOS02,LOS04,LOS05,LOS11,LOS12,LOS13,LOS15,LOS18,LOS19)" & _
                  " values('" & strLSourceType & "','" & Text1(10) & "','" & Text1(12) & "'" & _
                  ",'" & strUserNum & "'," & strSrvDate(1) & ",to_char(sysdate,'hh24miss'),'" & strLOS15 & "','" & strLOS18 & "','" & strLCaseCP10 & "')"
               cnnConnection.Execute strSql, intI
            End If
            
            'Add By Sindy 2022/10/6 更新相關案號=案源單號
'            strSql = "update ConsultRecordList set CRL55='" & strLOS15 & "' where CRL01='" & strCRL(1) & "'"
'            cnnConnection.Execute strSql, intI
            strSql = "Select CRL55 From ConsultRecordList where CRL01='" & strCRL(1) & "' and CRL55 is not null"
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strSql)
            If intI = 1 Then
               'Modify By Sindy 2024/9/25 + and instr(CRL55,'" & strLOS15 & "')=0: 排除重覆的
               strSql = "update ConsultRecordList set CRL55='" & RsTemp.Fields("CRL55") & "," & strLOS15 & "' where CRL01='" & strCRL(1) & "' and instr(CRL55,'" & strLOS15 & "')=0"
               cnnConnection.Execute strSql, intI
            Else
               strSql = "update ConsultRecordList set CRL55='" & strLOS15 & "' where CRL01='" & strCRL(1) & "'"
               cnnConnection.Execute strSql, intI
            End If
            '2022/10/6 END
         End If
      End If
      
   '非案源
   Else
      If Text1(6) = "P" Or Text1(6) = "PS" Or Text1(6) = "CFP" Or Text1(6) = "CPS" Then
         If UpdateDiscountQual = False Then 'Added by Morgan 2013/4/10
            GoTo CheckingErr
         End If
      End If
      If SaveCustData = False Then 'Add By Sindy 2014/2/6
         GoTo CheckingErr
      End If
      
      If Val(strCRL(13)) > 0 And Val(strCRL(13)) <= Val(strSrvDate(1)) Then m_bolDueDayAlert = True '當日法限提醒:請立刻電話通知專業部門作業
   
   End If 'Added by Morgan 2020/4/17
   
   'Modify By Sindy 2022/10/12 儲存附件
   If (m_strSaveFiles <> "" And m_strSaveFiles <> "Y") Or m_strSaveFiles2 <> "" Then
      If PUB_SaveCRLFile(m_strSaveFiles, m_strSaveFiles2, Trim(Text1(6)), Trim(Text1(7)), Trim(Text1(8)), Trim(Text1(9)), _
         strCRL(1), IIf(Option1(0).Value = True, True, False), strCaseNA239, True) = False Then
         GoTo CheckingErr
      Else
         m_strSaveFiles = ""
         m_strSaveFiles2 = ""
      End If
   End If
   '2022/10/12 END
   
   'Add By Sindy 2023/8/16 加註備註內容
   If txtF0306.Tag <> "" And InStr(txtF0306, txtF0306.Tag) = 0 Then
      txtF0306 = txtF0306 & txtF0306.Tag
   End If
   '2023/8/16 END
   
   'Add By Sindy 2022/9/22
   If bolModify = True Then
      strSql = "update FLOW003 set F0306='" & txtF0306 & "',F0316='" & Text1(10) & "' where F0301='" & strSeqNo & "'"
      cnnConnection.Execute strSql, intI
   Else
      'Modify By Sindy 2024/7/13 +,F0310,F0311,F0312
      strSql = "insert into FLOW003(F0301,F0302,F0306,F0316,F0310,F0311,F0312)" & _
                  " values('" & strCRL(1) & "','" & Flow_接洽單 & "','" & txtF0306 & "','" & Text1(10) & "','" & strUserNum & "'," & strSrvDate(1) & "," & Right("000000" & ServerTime, 6) & ")"
      cnnConnection.Execute strSql, intI
      
      'Modify By Sindy 2025/8/21 mark,要觀察一下狀況
'      'Modify By Sindy 2024/7/15 因為僅殘留Flow003資料, 發生 ORA - 1: 違反必須為唯一的限制條件 (PGMID.SYS_C0025262)
'      strExc(0) = "Select CRL01 From ConsultRecordList where CRL01='" & strCRL(1) & "'"
'      intI = 1
'      Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
'      If intI = 0 Then
'         strExc(8) = "-2147217873"
'         strExc(9) = "ORA - 1: 違反必須為唯一的限制條件 (PGMID.SYS_C0025262)"
'         '接洽單編號先自動給號+1,使後面可以正常操作
'         strExc(10) = AutoNo_AA("AA", 7, 1)
'         '發Mail通知程式人員
'         PUB_SendMail strUserNum, "97038", "", Me.Caption & " [OnSaveData] " & strExc(8) & " " & strExc(9), _
'            strExc(9) & vbCrLf & vbCrLf & "strSql=" & strSql & vbCrLf & vbCrLf & _
'            "strCRL(1)= " & strCRL(1) & vbCrLf & vbCrLf & _
'            "strLSourceType= " & strLSourceType & vbCrLf & vbCrLf & _
'            "接洽單編號先自動給號+1,使後面可以正常操作= " & strExc(10) & vbCrLf & vbCrLf & _
'            "strRecErr= " & strSql & vbCrLf & vbCrLf, , , , , , , , , , True, False, , , False, , , False
'      End If
'      '2024/7/15 END
   End If
   
   '直接檢查簽核狀況,送出表單
   If cmdOK(0).Caption = "送出" Or cmdOK(0).Caption = "重送" Then
      If PUB_AddConsultRecvFlow(strSeqNo, IIf(cmdOK(0).Caption = "重送", True, False)) = False Then
         GoTo CheckingErr
      Else
         'Add By Sindy 2025/8/4
         If Label1(84) = "C類來函：" Then
            '送會中的待回覆取消
            strSql = "update empelectronprocess set eep09=null" & _
                     " where EEP01='" & Trim(Me.Text1(100)) & "' and eep04='" & EMP_送會 & "' and eep09='Y'"
            cnnConnection.Execute strSql
            '取得最大序號
            intMaxEEP02 = 0
            strSql = "select eep02 From empelectronprocess where eep01='" & Trim(Me.Text1(100)) & "' order by eep02 desc"
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strSql)
            If intI = 1 Then
               RsTemp.MoveFirst
               If RsTemp.RecordCount > 0 Then
                  intMaxEEP02 = RsTemp.Fields(0)
               End If
            End If
            strSql = "select cp14 From caseprogress where cp09='" & Trim(Me.Text1(100)) & "'"
            intI = 1
            Set RsTemp = ClsLawReadRstMsg(intI, strSql)
            If intI = 1 Then
               strExc(10) = RsTemp.Fields("cp14")
            End If
            strSql = "insert into empelectronprocess(eep01,eep02,eep03,eep04,eep05,eep06,eep07,eep08,eep12,eep16) values(" & _
                     CNULL(Trim(Me.Text1(100))) & "," & (intMaxEEP02 + 1) & "," & CNULL(strUserNum) & "," & _
                     CNULL(EMP_會完) & "," & CNULL(strExc(10)) & "," & strSrvDate(1) & "," & _
                     Right("000000" & ServerTime, 6) & "," & CNULL("系統自動新增歷程，已收文分析！") & ",'" & IIf(m_FlowUserNum <> strUserNum, "(代)", "") & "','" & IIf(m_FlowUserNum <> strUserNum, m_FlowUserNum, "") & "')"
            cnnConnection.Execute strSql
            '原分析函不寄送予客戶，是否通知客戶欄位值上N(不通知)
            strSql = "update ENGINEERPROGRESS set ep11='N',EP38=" & strSrvDate(1) & ",EP08=" & strSrvDate(1) & " where ep02=" & CNULL(Trim(Me.Text1(100)))
            cnnConnection.Execute strSql
         End If
         '2025/8/4 END
         cnnConnection.CommitTrans
         PUB_SendMailCache '發信(因電子收文)
         Call FlowBatchSendMail(strUserNum) '整批發通知信: 電子收文(或部分簽核)通知信
         
         'Add By Sindy 2025/8/4
         '且通知信的主旨加註【已收文分析】
         If Label1(84) = "C類來函：" Then
            m_PrevForm.cmdCancel_Click '”取消”新增下一流程
            m_PrevForm.QueryData 'dblPrevRow = (intMaxEEP02 + 1)
            '發通知信
            Call m_PrevForm.FlowSendMail(True, CStr(intMaxEEP02 + 1), False, Trim(Me.Text1(100)))
         End If
         '2025/8/4 END
      End If
   Else
      cnnConnection.CommitTrans
   End If
   '2022/9/22 END
   cmdOK(0).Enabled = True 'Add By Sindy 2025/8/21
   
   Exit Function
   
CheckingErr:
   OnSaveData = False
   'Add By Sindy 2024/7/15
   If Err.Number = -2147168242 Then '交易已經以暗示或者明確的方式認可或中止了
      strExc(8) = Err.Number
      strExc(9) = Err.Description
      '發Mail通知程式人員
      PUB_SendMail strUserNum, "97038", "", Me.Caption & " [OnSaveData] " & strExc(8) & " " & strExc(9), _
         strExc(9) & vbCrLf & vbCrLf & _
         "strCRL(1)= " & strCRL(1) & vbCrLf & vbCrLf & _
         "strRecErr= " & strSql & vbCrLf & vbCrLf & _
         "抓資料的參考語法:" & vbCrLf & _
         "select * FROM FLOW003 WHERE F0301='有問題的接洽單編號'; -- and F0309 IS NULL" & vbCrLf & _
         "select * from consultrecordlist where crl01 in('有問題的接洽單編號');" & vbCrLf & vbCrLf & _
         "若找不到原因," & vbCrLf & _
         "自動編號檔: 接洽單編號(AA,年度)先手動+1號, 使人員可以先正常操作!", , , , , , , , , , True, False, , , False, , , False
   End If
   '2024/7/15 END
   cnnConnection.RollbackTrans
   If bolAddLos15 Then strLOS15 = "" 'Added by Morgan 2025/9/19 存檔失敗時，變數殘留繼續操作會判斷錯誤
   cmdOK(0).Enabled = True 'Add By Sindy 2025/8/21
   'Modify By Sindy 2024/7/13 + & vbCrLf & "strSql=" & strSql
   If Err.Description <> "" Then
      MsgBox (Err.Description & vbCrLf & vbCrLf & "strSql=" & strSql), , "OnSaveData"
   End If
End Function

'Add By Sindy 2010/6/21
Sub InitAll()
'    DIB.Destroy
'    DIBPal.Clear
'    PicFrame.Clear
    Set tmpPic.Picture = LoadPicture()
    Set tmpImg.Picture = LoadPicture()
    Set G_SeekPicColor.Picture = LoadPicture()
'    Set G_SeekPicBW.Picture = LoadPicture()
'    Set Me.CropPic.Picture = LoadPicture()
'    Set PicMain.Picture = LoadPicture()
    Set pic1.Picture = LoadPicture()
End Sub

'Add By Sindy 2010/6/21
Sub PicToObj(oFileNameAndPath As String)
    Dim objImg As StdPicture
    Dim nSrcWidth, nSrcHeight, nWidth, nHeight
    Dim tBI      As BITMAP
    InitAll
    On Error GoTo BE
    If UCase(pvGetExt(oFileNameAndPath)) = "WMF" Or UCase(pvGetExt(oFileNameAndPath)) = "EMF" Then
        Set G_SeekPicColor.Picture = LoadPicture(App.path & "\NowPic.wmf")
        'tmpImg.BackColor = &H80000009
    Else
        'tmpPic.BackColor = &H8000000A
        Set objImg = pvGetStdPicture(oFileNameAndPath)
        Set m_Image = New cImage
        Set m_Jpeg = New cJpeg
        Set G_SeekPicColor.Picture = objImg
        If G_SeekPicColor.Picture <> 0 Then
            Call GetObject(objImg.handle, Len(tBI), tBI)
            If tBI.bmWidth = 0 Or tBI.bmHeight = 0 Then
                MsgBox "發生錯誤！", vbExclamation, "圖檔格式錯誤"
'                'edit by nickc 2007/11/19
'                If oRtPic = False Then
'                    StrMenu
'                End If
                Exit Sub
            End If
            If tBI.bmWidth > 2000 Or tBI.bmHeight > 2000 Then
                nSrcWidth = tBI.bmWidth
                nSrcHeight = tBI.bmHeight
                If nSrcWidth > nSrcHeight Then
                    nWidth = 1200
                    nHeight = nSrcHeight / (nSrcWidth / nWidth)
                ElseIf nSrcWidth < nSrcHeight Then
                    nHeight = 1200
                    nWidth = nSrcWidth / (nSrcHeight / nHeight)
                Else
                    nHeight = 1200
                    nWidth = 1200
                End If
                pic1.Width = nWidth
                pic1.Height = nHeight
                pic1.BackColor = &H8000000A
                '重新定義大小
                pic1.Scale (0, 0)-(nWidth, nHeight)
                '縮小
                pic1.PaintPicture objImg, 0, 0, nWidth, nHeight, , , , , vbSrcCopy
                '存檔
                SavePicture pic1.Image, App.path & "\NowPic.bmp"
                Set objImg = pvGetStdPicture(App.path & "\NowPic.bmp")
            End If
            m_Image.CopyStdPicture objImg
            'Removed by Morgan 2023/7/26 一律不轉灰階,若不一致時承辦人/分案人員需人工確認
            'm_Jpeg.SetSamplingFrequencies 1, 1, 0, 0, 0, 0
            
            m_Jpeg.Quality = 75
            m_Jpeg.SampleHDC m_Image.hDC, m_Image.Width, m_Image.Height
            RidFile App.path & "\NowPic.jpg"
            m_Jpeg.SaveFile App.path & "\NowPic.jpg"
            m_Image.CopyStdPicture pvGetStdPicture(App.path & "\NowPic.jpg")
            Set G_SeekPicColor.Picture = LoadPicture(App.path & "\NowPic.jpg")

        End If
    End If
    Dim t_hd As Double
    Dim t_wd As Double
    t_hd = G_SeekPicColor.ScaleHeight / tmpPic.ScaleHeight
    t_wd = G_SeekPicColor.ScaleWidth / tmpPic.ScaleWidth
    If t_hd > t_wd Then
        t_wd = G_SeekPicColor.ScaleWidth / t_hd
        t_hd = G_SeekPicColor.ScaleHeight / t_hd
    Else
        t_hd = G_SeekPicColor.ScaleHeight / t_wd
        t_wd = G_SeekPicColor.ScaleWidth / t_wd
    End If
        tmpImg.Width = t_wd
        tmpImg.Height = t_hd
        tmpImg.Move (tmpPic.ScaleWidth - tmpImg.Width) / 2, (tmpPic.ScaleHeight - tmpImg.Height) / 2, t_wd, t_hd
    
    Set tmpImg.Picture = G_SeekPicColor.Picture
    Set objImg = Nothing

    Exit Sub
BE:
    Resume Next
End Sub

'Add By Sindy 2010/6/21
Public Function QueryData() As Boolean
Dim intIndex As Integer
Dim Cancel  As Boolean
Dim strTemp As String
Dim rsA As New ADODB.Recordset
Dim rsD As New ADODB.Recordset
Dim stAttPath As String, stFullName As String
Dim arrNA01() As String 'Add by Amy 2025/11/17

   m_IsQueryNow = True 'Added by Morgan 2023/4/27
   QueryData = True
   If m_blnCallPrint = True Then cmdCRL55.Visible = False
   
   '*****************
   '接洽記錄單主檔
   '*****************
   'Modify by Morgan 2010/12/20 +抓進度檔
   'strExc(0) = "Select * From consultrecordlist Where crl01 ='" & Trim(Text5) & "' "
   strExc(0) = "Select * From consultrecordlist,caseprogress Where crl01 ='" & Trim(Text5) & "' and cp140(+)=crl01 order by cp01 asc,cp02 asc,cp03 asc,cp04 asc"
   intI = 1
   Set rsA = ClsLawReadRstMsg(intI, strExc(0))
   If intI = 1 Then
      rsA.MoveFirst
'      Do While Not rsA.EOF
         m_CP05 = "" & rsA.Fields("cp05") 'Add by Morgan 2010/12/20
         m_CP09 = "" & rsA.Fields("cp09") 'Add by Morgan 2010/12/20
         
         '案件資料/收費項目
         Me.SSTab1.Tab = 0
         m_CRL02 = "" & rsA.Fields("CRL02") '填表日期 Add By Sindy 2011/10/18
         lblDate.Caption = Val(Mid(rsA.Fields("CRL02"), 1, 4)) - 1911 & "年" & Mid(rsA.Fields("CRL02"), 5, 2) & "月" & Mid(rsA.Fields("CRL02"), 7, 2) & "日"
         Text1(10) = rsA.Fields("CRL03")
         lblStaffName = GetStaffName(Me.Text1(10).Text)
         Text1(0) = "" & rsA.Fields("CRL04")
         lblZone = GetDepartmentName(Me.Text1(0).Text)
         If rsA.Fields("CRL05") = "1" Then
            OptChoose(0).Value = True
         ElseIf rsA.Fields("CRL05") = "2" Then
            OptChoose(1).Value = True
         End If
         If "" & rsA.Fields("CRL06") = "Y" Then
            Option1(0).Value = True
         Else
            Option1(1).Value = True
         End If
         Text1(6) = "" & rsA.Fields("CRL07")
         Text1(6).Tag = Text1(6).Text 'Added by Morgan 2020/5/28
         Call Text1_LostFocus(6) 'Add By Sindy 2022/10/14
         Text1(7) = "" & rsA.Fields("CRL08")
         Text1(8) = "" & rsA.Fields("CRL09")
         Text1(9) = "" & rsA.Fields("CRL10")
         Call GetMainData '抓取主檔資料
         If "" & rsA.Fields("CRL11") = "Y" Then ChkPCT.Value = 1 Else ChkPCT.Value = 0
         If Not IsNull(rsA.Fields("CRL12")) Then Text1(3) = ChangeWStringToTString(rsA.Fields("CRL12"))
         If Not IsNull(rsA.Fields("CRL13")) Then Text1(1) = ChangeWStringToTString(rsA.Fields("CRL13"))
'         If Not IsNull(rsA.Fields("CRL14")) Then Text1(2) = ChangeWStringToTString(rsA.Fields("CRL14"))
         '申請國家
         If Not IsNull(rsA.Fields("CRL15")) Then Combo1(0) = rsA.Fields("CRL15"): Call Combo1_Validate(0, False): Call Combo1_LostFocus(0)
         
         'Add By Sindy 2022/8/29
'*****************
'案件性質
'*****************
         '先檢查是否已收文
         strExc(0) = "Select crc01,CRC08 " & _
                       "From ConsultRecCMP " & _
                     "Where crc01 ='" & Trim(Text5) & "' and CRC08 is not null "
         intI = 1
         Set rsD = ClsLawReadRstMsg(intI, strExc(0))
         LblRecved.Visible = False
         If intI = 1 Then
            LblRecved.Visible = True
         End If
         GridCase.Clear: LblCnt.Caption = ""
         Call SetGrd
         'Modify By Sindy 2023/7/18
'         strExc(0) = "Select CRC02 順序,CRC03||' '||decode(crl15,'000',CPM03,CPM04) 案件性質" & _
'                     ",decode(CRC04,'有修改',CRC04,'刪收文',CRC04,to_char(CRC04,'99,999,999')) 費用" & _
'                     ",decode(CRC05,'有修改',CRC05,'刪收文',CRC05,to_char(CRC05,'99,999,999')) 規費" & _
'                     ",decode(CRC06,'有修改',CRC06,'刪收文',CRC06,to_char(CRC06,'99,999.000')) 點數" & _
'                     ",CRC07 備註,cp01||cp02||cp03||cp04 案號,CRC08 總收文號" & _
'                     ",CRC10 算案件數,CRC11 計件值,CRC12 加乘註記,cp01,cp02,cp03,cp04,decode(crl15,'000',CPM03,CPM04) CPMn " & _
'                     "From ConsultRecCMP,consultrecordlist,CasePropertyMap,caseprogress " & _
'                     "Where crc01 ='" & Trim(Text5) & "' and crl01(+)=crc01 and CPM01(+)=crl07 And CPM02(+)=crc03 And CRC08=CP09(+) " & _
'                     "order by crc02 asc "
         'Modify By Sindy 2025/4/14 +,CRC13 規費調整
         strExc(0) = "Select CRC02 順序,CRC03||' '||decode(crl15,'000',CPM03,CPM04) 案件性質" & _
                     ",decode(translate(CRC04,'/0123456789','/'),null,to_char(CRC04,'99,999,999'),CRC04) 費用" & _
                     ",decode(translate(CRC05,'/0123456789','/'),null,to_char(CRC05,'99,999,999'),CRC05) 規費" & _
                     ",decode(translate(CRC06,'/0123456789','/'),null,to_char(CRC06,'99,999.000'),CRC06) 點數" & _
                     ",CRC07 備註,cp01||cp02||cp03||cp04 案號,CRC08 總收文號" & _
                     ",CRC10 算案件數,CRC11 計件值,CRC12 加乘註記,cp01,cp02,cp03,cp04,decode(crl15,'000',CPM03,CPM04) CPMn" & _
                     ",decode(translate(CRC05,'/0123456789','/'),null,CRC13,'') 規費調整" & _
                     " From ConsultRecCMP,consultrecordlist,CasePropertyMap,caseprogress " & _
                     "Where crc01 ='" & Trim(Text5) & "' and crl01(+)=crc01 and CPM01(+)=crl07 And CPM02(+)=crc03 And CRC08=CP09(+) " & _
                     "order by crc02 asc "
         '2023/7/18 END
         intI = 1
         Set rsD = ClsLawReadRstMsg(intI, strExc(0))
         If intI = 1 Then
            If rsD.RecordCount > 0 Then
               Set GridCase.Recordset = rsD
               FrameCRC.Caption = "案件性質編輯區（" & rsD.RecordCount & "）"
               rsD.MoveFirst
               Do While Not rsD.EOF
                  If "" & rsD.Fields("計件值") <> "" Or "" & rsD.Fields("加乘註記") <> "" Then
                     Text1(136) = Text1(136) & rsD.Fields("CPMn") & "："
                     If "" & rsD.Fields("計件值") <> "" Then
                        Text1(136) = Text1(136) & "計件值(" & rsD.Fields("計件值") & ");"
                     End If
                     If "" & rsD.Fields("加乘註記") <> "" Then
                        Text1(136) = Text1(136) & "加乘註記(" & rsD.Fields("加乘註記") & ");"
                     End If
                  End If
                  rsD.MoveNext
               Loop
               rsD.MoveFirst
'               '填入案號
'               If Option1(0).Value = True And "" & rsD.Fields("cp02") <> "" Then
'                  Text1(7).Text = "" & rsD.Fields("cp02")
'                  Text1(8).Text = "" & rsD.Fields("cp03")
'                  Text1(9).Text = "" & rsD.Fields("cp04")
'               End If
               'Modify By Sindy 2023/3/24
               '有轉案填入案號
               m_strTransCase = ""
               If "" & rsD.Fields("cp02") <> "" Then
                  If Text1(6).Text & Text1(7).Text <> rsD.Fields("cp01") & rsD.Fields("cp02") Then
                     m_strTransCase = "（原為" & Text1(6).Text & Text1(7).Text & Text1(8).Text & Text1(9).Text & "案）"
                     'FrameCRC.Caption = FrameCRC.Caption & "　" & m_strTransCase
                     Text1(6).Text = "" & rsD.Fields("cp01")
                     Text1(7).Text = "" & rsD.Fields("cp02")
                     Text1(8).Text = "" & rsD.Fields("cp03")
                     Text1(9).Text = "" & rsD.Fields("cp04")
                  End If
               End If
               '2023/3/24 END
            End If
         End If
         rsD.Close
         GridCase.col = 1
         GridCase.row = 1
         m_strCaseCPM = GetAllCaseCPM
         Call SetFrmCol 'Add By Sindy 2022/12/26
         '2022/8/29 END
         'Add By Sindy 2024/4/10 符合下一程序期限者,期限欄位鎖住不可異動
         If Option1(1).Value = True Then
            strExc(0) = "select * from nextprogress" & _
                        " where np02=" + CNULL(Text1(6)) + " and np03=" + _
                        CNULL(Text1(7)) + " and np04=" + CNULL(Text1(8)) + " and np05=" + CNULL(Text1(9)) + _
                        " and np07 in(" & m_strCaseCPM & ") and (np06 is null or np06='N')"
            intI = 1
            Set rsD = ClsLawReadRstMsg(intI, strExc(0))
            If intI = 1 Then
               If Text1(1).Text <> "" Then Text1(1).Enabled = False
               If Text1(3).Text <> "" Then Text1(3).Enabled = False
            End If
         End If
         '2024/4/10 END
         
         If Not IsNull(rsA.Fields("CRL16")) Then Text1(18) = rsA.Fields("CRL16")
         If Not IsNull(rsA.Fields("CRL17")) Then Text1(11) = rsA.Fields("CRL17")
         If "" & rsA.Fields("CRL18") = "Y" Then
            Check7(0).Value = 1
         ElseIf "" & rsA.Fields("CRL18") = "N" Then
            Check7(1).Value = 1
         Else
            Check7(0).Value = 0
            Check7(1).Value = 0
         End If
'         'Add By Sindy 2022/9/13 +CRL134(對造陳報主管)/135(原因)
'         m_stCRL134 = ""
'         If Not IsNull(rsA.Fields("CRL134")) Then m_stCRL134 = rsA.Fields("CRL134")
'         m_stCRL135 = ""
'         If Not IsNull(rsA.Fields("CRL135")) Then m_stCRL135 = rsA.Fields("CRL135")
'         '2022/9/13 END
         
         If Not IsNull(rsA.Fields("CRL39")) Then Text1(113) = rsA.Fields("CRL39") '後金
         
         Text1(114) = "" & rsA.Fields("CRL40") 'Added by Morgan 2012/12/18 改放申請技術報告項數

         If "" & rsA.Fields("CRL41") = "1" Then
            Option2(0).Value = True
         ElseIf "" & rsA.Fields("CRL41") = "2" Then
            Option2(2).Value = True
         ElseIf "" & rsA.Fields("CRL41") = "3" Then
            Option2(1).Value = True
         End If
         'Added by Lydia 2023/11/13 DEBIT NOTE請款選項
         'Modified by Lydia 2023/11/14 排除外至台案件(MCTF) => rsA.Fields("CRL05") = "1"
         If "" & rsA.Fields("CRL41") = "2" And "" & rsA.Fields("CRL05") = "1" Then
            Frame33(1).Visible = True
            If "" & rsA.Fields("CRL153") = "1" Then
               optDB(0).Value = 1
            Else
               optDB(1).Value = 1
               If "" & rsA.Fields("CRL153") = "2" Then
                  Check7(2).Value = 1
               Else
                  Check7(3).Value = 1
               End If
            End If
         Else
            Frame33(1).Visible = False
         End If
         'end 2023/11/13
   
         If Not IsNull(rsA.Fields("CRL42")) Then cboTitle = rsA.Fields("CRL42")
         If "" & rsA.Fields("CRL43") = "Y" Then
            Check6(0).Value = 1
         Else
            Check6(0).Value = 0
         End If
         If Not IsNull(rsA.Fields("CRL44")) Then Text1(116) = rsA.Fields("CRL44")
         If "" & rsA.Fields("CRL45") = "Y" Then
            Check6(1).Value = 1
         Else
            Check6(1).Value = 0
         End If
         If Not IsNull(rsA.Fields("CRL46")) Then Text1(117) = ChangeWStringToTString(rsA.Fields("CRL46"))
         If "" & rsA.Fields("CRL47") = "Y" Then
            Check1.Value = 1
         Else
            Check1.Value = 0
         End If
         If Not IsNull(rsA.Fields("CRL48")) Then Text1(118) = ChangeWStringToTString(rsA.Fields("CRL48"))
         'Modify By Sindy 2016/3/18
         'If Not IsNull(rsA.Fields("CRL49")) Then Combo4.ListIndex = rsA.Fields("CRL49")
         If Not IsNull(rsA.Fields("CRL49")) Then
            Call SetCombo4(m_CRL02) '用舊公司名稱預設 Modify By Sindy 2025/4/9 從下面程式往上移
            'Added by Lydia 2020/03/30
            If m_CRL02 >= 智慧所更名日 Then
                Select Case "" & rsA.Fields("CRL49")
                     Case "1": Combo4.ListIndex = m_Comp1forIdx
                     Case "2": Combo4.ListIndex = m_Comp2forIdx
                     Case "J": Combo4.ListIndex = m_CompJforIdx
                     Case "L": Combo4.ListIndex = m_CompLforIdx
                End Select
            Else
            'end 2020/03/30
                'Modified by Lydia 2020/03/30
                'If rsA.Fields("CRL49") = 3 Then
                '   Combo4.AddItem "智權公司"
                'End If
                m_CompName2 = "" '清空目前預設
                'Call SetCombo4(m_CRL02) '用舊公司名稱預設 Modify By Sindy 2025/4/9 mark
                'end 2020/03/30
                Combo4.ListIndex = rsA.Fields("CRL49")
            End If
         End If
         '2016/3/18 END

         If "" & rsA.Fields("CRL50") = "Y" Then
            Check2.Value = 1
         Else
            Check2.Value = 0
         End If
         '案件來源及申請人
         'Me.SSTab1.Tab = 1
         If "" & rsA.Fields("CRL51") = "01" Then
            Option4(0).Value = True
         ElseIf "" & rsA.Fields("CRL51") = "02" Then
            Option4(3).Value = True
         End If
         If "" & rsA.Fields("CRL52") = "1" Then
            Option4(1).Value = True
         ElseIf "" & rsA.Fields("CRL52") = "2" Then
            Option4(2).Value = True
         End If
         If Not IsNull(rsA.Fields("CRL53")) Then Text1(97) = rsA.Fields("CRL53")
         If Not IsNull(rsA.Fields("CRL54")) Then Text1(99) = rsA.Fields("CRL54")
         If "" & rsA.Fields("CRL56") = "Y" Then
            Option5(0).Value = True
         ElseIf "" & rsA.Fields("CRL56") = "N" Then
            Option5(1).Value = True
         End If
         
         If Not IsNull(rsA.Fields("CRL58")) Then Text1(4) = rsA.Fields("CRL58")
         
         If Not IsNull(rsA.Fields("CRL60")) Then Text1(5) = rsA.Fields("CRL60") & rsA.Fields("CRL61")
         If Not IsNull(rsA.Fields("CRL62")) Then Text1(130) = rsA.Fields("CRL62")
         If Not IsNull(rsA.Fields("CRL77")) Then Text1(137) = rsA.Fields("CRL77") 'Add By Sindy 2022/10/14 代理人彼所案號
         
         '商標圖
         'Me.SSTab1.Tab = 4
         If "" & rsA.Fields("CRL63") = "1" Then
            opt1(0).Value = True
         ElseIf "" & rsA.Fields("CRL63") = "2" Then
            opt1(1).Value = True
         ElseIf "" & rsA.Fields("CRL63") = "3" Then
            opt1(2).Value = True
         ElseIf "" & rsA.Fields("CRL63") = "4" Then
            opt1(3).Value = True
         ElseIf "" & rsA.Fields("CRL63") = "5" Then
            opt1(4).Value = True
         End If
         If Not IsNull(rsA.Fields("CRL64")) Then PicText = rsA.Fields("CRL64")
         'Add By Sindy 2022/9/20 商標圖同卷號
         If Not IsNull(rsA.Fields("CRL75")) Then
            Frame5.Visible = True
            TxtC1(0) = Mid(rsA.Fields("CRL75"), 1, Len(rsA.Fields("CRL75")) - 9)
            TxtC1(1) = Mid(rsA.Fields("CRL75"), Len(rsA.Fields("CRL75")) - 8, 6)
            TxtC1(2) = Mid(rsA.Fields("CRL75"), Len(rsA.Fields("CRL75")) - 2, 1)
            TxtC1(3) = Mid(rsA.Fields("CRL75"), Len(rsA.Fields("CRL75")) - 1, 2)
         End If
         
         'Add By Sindy 2022/9/20 7501判決分析 提供書面分析 / 請律師向當事人說明
         If "" & rsA.Fields("CRL72") <> "" Then
            Frame41.Visible = True
            If rsA.Fields("CRL72") = "1" Then
               Option9(0).Value = True '提供書面分析
            ElseIf rsA.Fields("CRL72") = "2" Then
               Option9(1).Value = True '請律師向當事人說明
            End If
         End If
         
         'Add By Sindy 2022/9/23 分割成幾案
         Label1(123).Visible = False
         If Not IsNull(rsA.Fields("CRL76")) Then
            Is307or308 = True
            CountBy307308 = rsA.Fields("CRL76")
            Label1(123).Visible = True
            Label1(123).Caption = "分割成 " & CountBy307308 & " 案"
         End If
         
         'Add By Sindy 2022/9/15
         '證書形式
         Call SetCRL59
         If Not IsNull(rsA.Fields("CRL59")) Then
            Text1(145) = rsA.Fields("CRL59")
         End If
         '關連表單編號
         If Not IsNull(rsA.Fields("CRL65")) Then
            Text1(144) = rsA.Fields("CRL65")
         End If
         '對造已簽准
         If "" & rsA.Fields("CRL66") = "Y" Then
            ChkCRL66.Value = 1
         Else
            ChkCRL66.Value = 0
         End If
         'Add By Sindy 2023/4/7 自行送簽核
         If "" & rsA.Fields("CRL152") = "Y" Then
            ChkCRL152.Value = 1
         Else
            ChkCRL152.Value = 0
         End If
         '2023/4/7 END
         
         '案件說明處理事項
         'Me.SSTab1.Tab = 2
         If Not IsNull(rsA.Fields("CRL57")) Then
            Text1(119) = rsA.Fields("CRL57")
         'Add By Sindy 2024/6/12
         Else
            Text1(119) = ""
            '2024/6/12 END
         End If
         '系統加註
         If Not IsNull(rsA.Fields("CRL70")) Then txtCRL70 = rsA.Fields("CRL70")
         strOldCRL70 = "" & rsA.Fields("CRL70")  'Added by Lydia 2025/02/18
         'Add By Sindy 2025/7/1 人員有勾規費調整
         If InStr(txtCRL70, "有勾規費調整") > 0 Then
            Me.Check10.Value = 1
         End If
         '2025/7/1 END
         '呈主管簽核
         If Not IsNull(rsA.Fields("CRL69")) Then txtCRL69 = rsA.Fields("CRL69")
'***************************
         If Text1(8) & Text1(9) = "000" Then
            strExc(1) = Text1(6) & "-" & Text1(7)
         Else
            strExc(1) = Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9)
         End If
         '一案兩請案號
         If Not IsNull(rsA.Fields("CRL67")) Then
            If InStr(rsA.Fields("CRL67"), strExc(1)) = 0 Then
               Text1(134) = rsA.Fields("CRL67")
            End If
         End If
         '擬制喪失新穎性案號
         If Not IsNull(rsA.Fields("CRL68")) Then
            If InStr(rsA.Fields("CRL68"), strExc(1)) = 0 Then
               Text1(135) = rsA.Fields("CRL68")
            End If
         End If
         '相關案號
         If Not IsNull(rsA.Fields("CRL55")) Then
            If InStr(rsA.Fields("CRL55"), strExc(1)) = 0 Then
               Text1(100) = rsA.Fields("CRL55") '本案與總號
            End If
         End If
'***************************
         '相關案號的類別
         If Not IsNull(rsA.Fields("CRL74")) Then
            cmdCRL55.Visible = False
            Me.Text1(100).Enabled = False
            If Len(rsA.Fields("CRL74")) = 2 Then
               Label1(84).Caption = "案源單號："
               strLSourceType = rsA.Fields("CRL74")
               strLOS15 = rsA.Fields("CRL55") 'SrcGetLOS15(Text5)
'               m_blnCallPrint = True '案源不能修改資料
'               MsgBox "案源資料已寫入，不可修改！", vbInformation
               'Add By Sindy 2024/9/24
               Call SrcLoadCheck(True)
               If strCheckStatus <> "" Then '案源尚未輸完
                  m_blnCallPrint = False
                  Text5.Text = ""
                  Text5.Visible = False
                  Exit Function
               Else
                  Label1(123).Caption = "案源"
                  Label1(123).Visible = True
               End If
               '2024/9/24 END
            ElseIf rsA.Fields("CRL74") = "1" And Not IsNull(rsA.Fields("CRL55")) Then '1.查名代號
               Label1(84).Caption = "查名代號："
               mTQC01 = rsA.Fields("CRL55")
               cmdTMQ.Tag = mTQC01
               Call QueryTMQ(mTQC01)
               'Added by Lydia 2023/08/02 記錄原本勾選的委查結果
               If mTQC01 <> "" Then
                  Call GetTMQList(pTMQList, True)
               End If
               'end 2023/08/02
               If InStr(cmdOK(0).Caption, "存檔") = 0 Then   'Added by Lydia 2023/08/02 判斷待收文區可以修改委查結果
                  cmdTMQApp.Visible = False
                  cmdTMQ.Visible = False
               End If
            ElseIf rsA.Fields("CRL74") = "2" And Not IsNull(rsA.Fields("CRL55")) Then '2.英國脫歐案
               Label1(84).Caption = "英國脫歐案："
               strCaseNA239 = rsA.Fields("CRL55")
            ElseIf rsA.Fields("CRL74") = "3" And Not IsNull(rsA.Fields("CRL55")) Then '3.CFT緬甸重新申請案
               Label1(84).Caption = "CFT緬甸重新申請案："
               strExc(10) = rsA.Fields("CRL55")
               strCaseNo1 = Left(strExc(10), 3)
               strCaseNo2 = Mid(strExc(10), 4, 6)
               StrCaseNo3 = Mid(strExc(10), 10, 1)
               strCaseNo4 = Mid(strExc(10), 11, 2)
            'Add By Sindy 2025/8/4
            ElseIf rsA.Fields("CRL74") = "4" And Not IsNull(rsA.Fields("CRL55")) Then '4.C類來函
               Label1(84).Caption = "C類來函："
               '2025/8/4 END
            End If
         End If
'***************************
         '2022/9/15 END
         
         'Add By Sindy 2022/10/14
         If Not IsNull(rsA.Fields("CRL73")) Then
            Text1(138) = rsA.Fields("CRL73") '商品類別
            Frame58.Visible = True
         'Add By Sindy 2024/7/8 ex:T-196567 延展2類
         ElseIf Option1(1).Value = True Then '舊案
            Text1(138) = m_strTM09
            '2024/7/8 END
         End If
         '2022/10/14 END
         
         'Added by Morgan 2020/5/28
         SetCombo6
         If IsNull(rsA.Fields("CRL87")) Then
            Combo6 = ""
         Else
            If InStr(Text1(6), "P") > 0 Then
               Combo6 = rsA.Fields("CRL87") + "." + GetPKindName(rsA.Fields("CRL87"))
            ElseIf InStr(Text1(6), "T") > 0 Then
               Combo6 = rsA.Fields("CRL87") + "." + GetTKindName(rsA.Fields("CRL87"))
            End If
         End If
         'end 2020/5/28
         
         'Modify By Sindy 2022/11/9 Mark
         SetCombo5 'Added by Morgan 2020/5/28
         '2022/11/9 END
         'Add By Sindy 2010/10/28 案件屬性
         If IsNull(rsA.Fields("CRL81")) Then
            Combo5 = ""
         Else
            'Modified by Lydaia 2024/04/24 +專利種類CRL87
            Combo5 = "" & rsA.Fields("CRL81") + "." + PUB_GetCaseAttributeName("" & rsA.Fields("CRL81"), "" & rsA.Fields("CRL87"))
         End If
         'Add By Sindy 2010/11/22 送件方式
         Call SetFrame18 'Add By Sindy 2023/4/24
         If Not IsNull(rsA.Fields("CRL82")) Then
            If "" & rsA.Fields("CRL82") = "1" Then
               OptSendType(0).Value = True
            ElseIf "" & rsA.Fields("CRL82") = "2" Then
               OptSendType(1).Value = True
            ElseIf "" & rsA.Fields("CRL82") = "3" Then
               OptSendType(2).Value = True
            End If
            '指定日期
            If Not IsNull(rsA.Fields("CRL83")) Then Text1(126) = ChangeWStringToTString(rsA.Fields("CRL83"))
            'Add By Sindy 2023/12/12 指定日期方式
            If Not IsNull(rsA.Fields("CRL155")) Then
               If rsA.Fields("CRL155") = "1" Then
                  OptCP164(0).Value = True
               ElseIf rsA.Fields("CRL155") = "2" Then
                  OptCP164(1).Value = True
               ElseIf rsA.Fields("CRL155") = "3" Then
                  OptCP164(2).Value = True
               End If
            End If
            '2023/12/12 END
         Else
            OptSendType(0).Value = False
            OptSendType(1).Value = False
            OptSendType(2).Value = False
         End If
         
         'Add By Sindy 2011/6/7 法務案件屬性
         'Modified by Lydia 2019/08/06 +ACS
         'If Not IsNull(rsA.Fields("CRL84")) Then Frame19.Visible = True: Text1(127) = rsA.Fields("CRL84")
         If Not IsNull(rsA.Fields("CRL84")) Then
            Frame19.Visible = True
            Text1(127) = "" & rsA.Fields("CRL84")
         End If
         
         'Add By Sindy 2012/3/6
         '超頁超項備註
         If Not IsNull(rsA.Fields("CRL85")) Then
            Frame16.Visible = True
            If "" & rsA.Fields("CRL85") = "1" Then
               Option3(0).Value = True
            ElseIf "" & rsA.Fields("CRL85") = "2" Then
               Option3(1).Value = True
            End If
         End If
         '加註查名結果
         If Not IsNull(rsA.Fields("CRL86")) Then
            Frame20.Visible = True
            If "" & rsA.Fields("CRL86") = "1" Then
               Option6(0).Value = True
            ElseIf "" & rsA.Fields("CRL86") = "2" Then
               Option6(1).Value = True
            ElseIf "" & rsA.Fields("CRL86") = "3" Then
               Option6(2).Value = True
            ElseIf "" & rsA.Fields("CRL86") = "4" Then
               Option6(3).Value = True
            'Added by Lydia 2016/09/22
            ElseIf "" & rsA.Fields("CRL86") = "5" Then
               Option6(4).Value = True
            'Added by Lydia 2018/11/13
            ElseIf "" & rsA.Fields("CRL86") = "6" Then
               Option6(5).Value = True
            End If
            'Modify by Sindy 2022/9/16 + 相同文字／圖形，申請人已註冊之審定號
            If Not IsNull(rsA.Fields("CRL136")) Then Text1(133) = rsA.Fields("CRL136")
            '2022/9/16 END
         End If
         '2012/3/6 End
         
         'Add By Sindy 2012/5/8
         '資料是否齊備
         If Not IsNull(rsA.Fields("CRL88")) Then
            Frame21.Visible = True
            Frame22.Visible = True
            If rsA.Fields("CRL88") = "Y" Then
               OptEP06(0).Value = True
            ElseIf rsA.Fields("CRL88") = "N" Then
               OptEP06(1).Value = True
            End If
         Else
            OptEP06(0).Value = False
            OptEP06(1).Value = False
         End If
         '是否會稿
         If Not IsNull(rsA.Fields("CRL89")) Then
            Frame21.Visible = True
            Frame23.Visible = True
            If rsA.Fields("CRL89") = "Y" Then
               OptEP34(0).Value = True
            ElseIf rsA.Fields("CRL89") = "N" Then
               OptEP34(1).Value = True
            End If
         Else
            OptEP34(0).Value = False
            OptEP34(1).Value = False
         End If
         '是否急件
         'Modify By Sindy 2022/11/8
'         If Not IsNull(rsA.Fields("CRL90")) Then
'            Frame21.Visible = True
'            Frame24.Visible = True
'            If rsA.Fields("CRL90") = "Y" Then
'               OptCP122(0).Value = True
'            ElseIf rsA.Fields("CRL90") = "N" Then
'               OptCP122(1).Value = True
'            End If
'         Else
'            OptCP122(0).Value = False
'            OptCP122(1).Value = False
'         End If
         '急件
         If "" & rsA.Fields("CRL90") = "Y" Then
            Check11.Value = 1
         Else
            Check11.Value = 0
         End If
         '費用已核准
         If "" & rsA.Fields("CRL147") = "Y" Then
            Check12.Value = 1
         Else
            Check12.Value = 0
         End If
         '同時申請三國(含)以上之美日德
         chkEnglish.Visible = False: chkEnglish.Value = 0
         If "" & rsA.Fields("CRL148") <> "" Then
            chkEnglish.Visible = True
            If "" & rsA.Fields("CRL148") = "Y" Then chkEnglish.Value = 1
         End If
         '2012/5/8 End
         'Add by Amy 2016/06/06 +可否延期
         If Not IsNull(rsA.Fields("CRL133")) Then
            Frame21.Visible = True
            Frame43.Visible = True
            If rsA.Fields("CRL133") = "Y" Then
               OptCRL133(0).Value = True
            ElseIf rsA.Fields("CRL133") = "N" Then
               OptCRL133(1).Value = True
            End If
         Else
            OptCRL133(0).Value = False
            OptCRL133(1).Value = False
         End If
         'end 2016/06/06
         'Added by Lydia 2018/12/10 查名是否齊備
         If Not IsNull(rsA.Fields("CRL137")) Then
            Frame21.Visible = True
            Frame42.Visible = True
            If rsA.Fields("CRL137") = "Y" Then
               OptCP143(0).Value = True
            ElseIf rsA.Fields("CRL137") = "N" Then
               OptCP143(1).Value = True
            End If
         End If
         'end 2018/12/10
         
         'Add By Sindy 2012/8/17 優惠期日
         If Not IsNull(rsA.Fields("CRL91")) Then
            Frame25.Visible = True
            Text1(128) = ChangeWStringToTString(rsA.Fields("CRL91"))
         Else
            Frame25.Visible = False
         End If
         
         'Add By Sindy 2012/11/12 收據自動列印時間點
         If "" & rsA.Fields("CRL92") = "1" Then
            Check8(0).Value = 1
         ElseIf "" & rsA.Fields("CRL92") = "2" Then
            Check8(1).Value = 1
         ElseIf "" & rsA.Fields("CRL92") = "3" Then
            Check8(2).Value = 1
         End If
         '2012/11/12 End
         
         'Add By Sindy 2013/2/25
         '是否在該國有無近似案件
         If Not IsNull(rsA.Fields("CRL93")) Then
            Frame27.Visible = True
            If "" & rsA.Fields("CRL93") = "Y" Then
               Option8(0).Value = True
            ElseIf "" & rsA.Fields("CRL93") = "N" Then
               Option8(1).Value = True
            End If
         End If
         '2013/2/25 End
         
         'Added by Morgan 2013/4/9
         If Not IsNull(rsA.Fields("CRL94")) Then
            Select Case rsA.Fields("CRL94")
            Case "1"
               OptEntity(0).Value = True
            Case "2"
               OptEntity(1).Value = True
            Case "3"
               OptEntity(2).Value = True
            End Select
         End If
         'end 2013/4/9
         
         'Added by Morgan 2013/9/23
         If rsA.Fields("CRL95") = "Y" Then
            Check4.Value = 1
         Else
            Check4.Value = 0
         End If
         'end 2013/9/23
         'Added by Morgan 2013/9/23
         If rsA.Fields("CRL96") = "Y" Then
            Check5.Value = 1
         Else
            Check5.Value = 0
         End If
         'end 2013/9/23
         
         'Add By Sindy 2014/2/6 特殊收據
         If "" & rsA.Fields("CRL119") = "Y" Then
'            '外部呼叫且不列印特殊收據頁
'            If m_blnCallPrint = True And m_blnCallPrint_CRL119 = False Then
'               Check9.Value = 0
'               cmdCRL119.Visible = False
'            Else
               Check9.Value = 1
               'cmdCRL119.Visible = True
'            End If
            m_stCRL01 = "" & rsA.Fields("CRL01")
            m_stCRL97 = "" & rsA.Fields("CRL97")
            m_stCRL98 = "" & rsA.Fields("CRL98")
            m_stCRL99 = "" & rsA.Fields("CRL99")
            m_stCRL100 = "" & rsA.Fields("CRL100")
            m_stCRL101 = "" & rsA.Fields("CRL101")
            m_stCRL102 = "" & rsA.Fields("CRL102")
            m_stCRL103 = "" & rsA.Fields("CRL103")
            m_stCRL104 = "" & rsA.Fields("CRL104")
            m_stCRL105 = "" & rsA.Fields("CRL105")
            m_stCRL106 = "" & rsA.Fields("CRL106")
            m_stCRL107 = "" & rsA.Fields("CRL107")
            m_stCRL108 = "" & rsA.Fields("CRL108")
            m_stCRL109 = "" & rsA.Fields("CRL109")
            m_stCRL110 = "" & rsA.Fields("CRL110")
            m_stCRL111 = "" & rsA.Fields("CRL111")
            m_stCRL112 = "" & rsA.Fields("CRL112")
            m_stCRL113 = "" & rsA.Fields("CRL113")
            m_stCRL114 = "" & rsA.Fields("CRL114")
            m_stCRL115 = "" & rsA.Fields("CRL115")
            m_stCRL116 = "" & rsA.Fields("CRL116")
            m_stCRL117 = "" & rsA.Fields("CRL117")
            m_stCRL118 = "" & rsA.Fields("CRL118")
            m_stCRL120 = "" & rsA.Fields("CRL120")
            m_stCRL121 = "" & rsA.Fields("CRL121")
            m_stCRL122 = "" & rsA.Fields("CRL122")
            m_stCRL123 = "" & rsA.Fields("CRL123")
            m_stCRL124 = "" & rsA.Fields("CRL124")
            'Add By Sindy 2015/8/28
            m_stCRL126 = "" & rsA.Fields("CRL126")
            m_stCRL127 = "" & rsA.Fields("CRL127")
            m_stCRL128 = "" & rsA.Fields("CRL128")
            m_stCRL129 = "" & rsA.Fields("CRL129")
            m_stCRL130 = "" & rsA.Fields("CRL130")
            m_stCRL131 = "" & rsA.Fields("CRL131")
            m_stCRL132 = "" & rsA.Fields("CRL132")
            '2015/8/28 END
         Else
            Check9.Value = 0
            'cmdCRL119.Visible = False
         End If
         '2014/2/6 END
         
         'Add by Amy 2024/01/17 對造資料
         If strSrvDate(1) >= 風險警示啟用日 Then
            m_stCRL156 = "" & rsA.Fields("CRL156")
            m_stCRL157 = "" & rsA.Fields("CRL157")
            m_stCRL158 = "" & rsA.Fields("CRL158")
            m_stCRL159 = "" & rsA.Fields("CRL159")
         End If
         'end 2024/01/17
         
'Add By Sindy 2024/5/9 此2個常變數存入資料庫內, 因操作子畫面組出來的
'                      記錄下來, 以利人員新增後再回頭修改時才能保留住程式原狀況, 部分程式判斷上才不會出錯
         If Trim("" & rsA.Fields("CRL161")) <> "" Then
            m_Note1 = Trim("" & rsA.Fields("CRL161"))
         End If
         If Trim("" & rsA.Fields("CRL162")) <> "" Then
            m_Note2 = Trim("" & rsA.Fields("CRL162"))
         End If
'2024/5/9 End

         'Add By Sindy 2023/9/27 記錄延期案的下一程序文號
         'Modify By Sindy 2025/8/5 + Or InStr(m_strCaseCPM & ",", "727,") > 0)
         If Left(Text1(6), 1) = "T" And _
            (InStr(m_strCaseCPM & ",", "303,") > 0 Or InStr(m_strCaseCPM & ",", "727,") > 0) Then
            m_strGetNP01 = "" & rsA.Fields("CRL71")
            If "" & rsA.Fields("CRL70") <> "" And InStr("" & rsA.Fields("CRL70"), "延期案件性質") > 0 Then
               strExc(9) = InStr(rsA.Fields("CRL70"), "延期案件性質")
               strExc(10) = InStr(Mid(rsA.Fields("CRL70"), strExc(9)), vbCrLf)
               'm_Note2 = Mid(rsA.Fields("CRL70"), strExc(9), strExc(10) - 1)
               Frame605.Visible = True
               labelYF.Caption = m_Note2
               Text1(142).Visible = False
               Text1(143).Visible = False
            End If
            '2023/9/27 END
         'Add By Sindy 2014/2/19 審定號
         'Modify By Sindy 2022/9/20 + 申請案號
         ElseIf Trim("" & rsA.Fields("CRL125")) <> "" Or Trim("" & rsA.Fields("CRL71")) <> "" Then
            Frame29.Visible = True
            Text1(129).Text = "" & rsA.Fields("CRL125")
            Text1(132).Text = "" & rsA.Fields("CRL71")
         Else
            Frame29.Visible = False
            Text1(129).Text = ""
            Text1(132).Text = ""
         End If
         '2014/2/19 END
         
         'Added by Lydia 2021/02/24
         '補上：特定申請人會稿案件CRL138
         If "" & rsA.Fields("CRL138") <> "" Then
             Frame45.Visible = True
             If "" & rsA.Fields("CRL138") = "Y" Then
                 Opt45(0).Value = True
             Else
                 Opt45(1).Value = True
             End If
         End If
         '大陸商標申請案及CFT申請案，均強迫填入相關資訊。
         If "" & rsA.Fields("CRL139") <> "" Then
             Frame47.Visible = True
             Text7.Text = "" & rsA.Fields("CRL139")
         End If
         'end 2021/02/24
         
         'Added by Morgan 2021/7/20 大陸發明生醫案是否新藥專利設定
         If "" & rsA.Fields("CRL140") <> "" Then
            Frame48.Visible = True
            If "" & rsA.Fields("CRL140") = "Y" Then
               OptNewDrug(1).Value = True
            ElseIf "" & rsA.Fields("CRL140") = "N" Then
               OptNewDrug(0).Value = True
            End If
         End If
         'end 2021/7/20
         
         'Add By Sindy 2022/9/20
         If Text1(6) = "P" And Left(Combo1(0).Text, 3) = "000" Then
            SSTab3.TabVisible(1) = True
         Else
            SSTab3.TabVisible(1) = False
         End If
         '聘任期間
         If (Text1(6) = "LA" Or Text1(6) = "ACS") And Not IsNull(rsA.Fields("CRL144")) Then
            Label1(140).Visible = True: Text1(139).Visible = True: Text1(140).Visible = True
            Text1(139) = rsA.Fields("CRL144") - 19110000
            Text1(140) = rsA.Fields("CRL145") - 19110000
         '年費期間
         ElseIf ((Text1(6) = "P" Or Text1(6) = "CFP") And _
                 (InStr(m_strCaseCPM, "605") > 0 Or InStr(m_strCaseCPM, "606") > 0 Or InStr(m_strCaseCPM, "607") > 0)) Or _
            (Text1(6) = "P" And InStr(m_strCaseCPM, "601") > 0) Or _
            (Text1(6) = "CFP" And InStr(m_strCaseCPM, "613") > 0) Then
            Frame605.Visible = True
            If InStr(m_strCaseCPM, "605") > 0 Or (Text1(6) = "P" And InStr(m_strCaseCPM, "601") > 0) Then
               labelYF.Caption = "繳費年度：          ~"
            Else
               labelYF.Caption = "繳費次數：          ~"
            End If
            If Not IsNull(rsA.Fields("CRL144")) Then
               Text1(142) = rsA.Fields("CRL144")
               Text1(143) = rsA.Fields("CRL145")
            End If
         '舉發聲明
         ElseIf Not IsNull(rsA.Fields("CRL141")) Or _
            Not IsNull(rsA.Fields("CRL143")) Or _
            Not IsNull(rsA.Fields("CRL144")) Then
            
            If "" & rsA.Fields("CRL141") = "1" Then
               chkItem(0).Value = vbChecked
               txtItemCount = "" & rsA.Fields("CRL142")
            ElseIf "" & rsA.Fields("CRL141") = "2" Then
               chkItem(1).Value = vbChecked
               txtItemList = "" & rsA.Fields("CRL142")
            End If
            If Val("" & rsA.Fields("CRL144")) > 0 Then
               txtYear(0) = Left(rsA.Fields("CRL144"), 4) - 1911
               txtMonth(0) = Mid(rsA.Fields("CRL144"), 5, 2)
               txtDay(0) = Mid(rsA.Fields("CRL144"), 7, 2)
               If Val("" & rsA.Fields("CRL145")) > 0 Then
                  txtYear(1) = Left(rsA.Fields("CRL145"), 4) - 1911
                  txtMonth(1) = Mid(rsA.Fields("CRL145"), 5, 2)
                  txtDay(1) = Mid(rsA.Fields("CRL145"), 7, 2)
               End If
            End If
            If "" & rsA.Fields("CRL143") <> "" Then
               If InStr(rsA.Fields("CRL143"), "1,") > 0 Then chkItem(2).Value = vbChecked
               If InStr(rsA.Fields("CRL143"), "2,") > 0 Then chkItem(3).Value = vbChecked
               If InStr(rsA.Fields("CRL143"), "3,") > 0 Then chkItem(4).Value = vbChecked
               If InStr(rsA.Fields("CRL143"), "4,") > 0 Then chkItem(5).Value = vbChecked
            End If
         End If
         '2022/9/20 END
'         rsA.MoveNext
'      Loop
   End If
   rsA.Close
   
   'Add By Sindy 2022/9/9
   '*****************
   '電子檔: 不抓已收文的卷宗區附件
   '*****************
   Me.m_strSaveFiles = "": Me.m_strSaveFiles2 = ""
   Me.cmdAddAtt.BackColor = &H808080 '灰色
   'and length(cpp01)<>9
   strExc(0) = "Select * " & _
                 "From CasePaperPDF " & _
               "Where cpp11 ='" & Trim(Text5) & "' and cpp10<>'D' " & _
               "and substr(upper(cpp02),-4)<>upper('.del') and substr(upper(cpp02),-6)<>upper('.order') " & _
               "order by cpp02 asc "
   intI = 1
   Set rsA = ClsLawReadRstMsg(intI, strExc(0))
   If intI = 1 Then
      Me.cmdAddAtt.BackColor = &HC0C0FF '粉紅色
   End If
   If LblRecved.Visible = True Then '已收文
      'Modify By Sindy 2023/2/18
      'Me.cmdAddAtt.Visible = False
      Me.cmdAddAtt.Visible = True
      cmdAddAtt.Caption = "卷宗區"
      '2023/2/18 END
   End If
   rsA.Close
'   '(有文件)
'   strExc(0) = "Select * " & _
'                 "From CasePaperPDF " & _
'               "Where cpp11 ='" & Trim(Text5) & "' and length(cpp01)=9 and cpp10<>'D' " & _
'               "and substr(upper(cpp02),-4)<>upper('.del') and substr(upper(cpp02),-6)<>upper('.order') " & _
'               "order by cpp02 asc "
'   intI = 1
'   Set rsA = ClsLawReadRstMsg(intI, strExc(0))
'   If intI = 1 Then
'      Label38.Visible = True
'   Else
'      Label38.Visible = False
'   End If
'   rsA.Close
   '2022/9/9 END
   '*****************
   '申請人
   '*****************
   strExc(0) = "Select * " & _
                 "From consultrecapp " & _
               "Where cra01 ='" & Trim(Text5) & "' " & _
               "order by cra02 asc "
   intI = 1
   Set rsA = ClsLawReadRstMsg(intI, strExc(0))
   If intI = 1 Then
      rsA.MoveFirst
      Do While Not rsA.EOF
         '申請人1
         If rsA.Fields("CRA02") = "1" Then
            Me.SSTab2.Tab = 0
            If "" & rsA.Fields("CRA03") = "Y" Then
               Option31(0).Value = True
            Else
               Option31(1).Value = True
            End If
         '申請人2
         ElseIf rsA.Fields("CRA02") = "2" Then
            Me.SSTab2.Tab = 1
            If "" & rsA.Fields("CRA03") = "Y" Then
               Option32(0).Value = True
            Else
               Option32(1).Value = True
            End If
         '申請人3
         ElseIf rsA.Fields("CRA02") = "3" Then
            Me.SSTab2.Tab = 2
            If "" & rsA.Fields("CRA03") = "Y" Then
               Option33(0).Value = True
            Else
               Option33(1).Value = True
            End If
         '申請人4
         ElseIf rsA.Fields("CRA02") = "4" Then
            Me.SSTab2.Tab = 3
            If "" & rsA.Fields("CRA03") = "Y" Then
               Option34(0).Value = True
            Else
               Option34(1).Value = True
            End If
         '申請人5
         ElseIf rsA.Fields("CRA02") = "5" Then
            Me.SSTab2.Tab = 4
            If "" & rsA.Fields("CRA03") = "Y" Then
               Option35(0).Value = True
            Else
               Option35(1).Value = True
            End If
         End If
         intIndex = rsA.Fields("CRA02")
         If Not IsNull(rsA.Fields("CRA04")) Then Text1(IIf(intIndex = 1, 198, IIf(intIndex = 2, 298, IIf(intIndex = 3, 398, IIf(intIndex = 4, 498, 598))))) = rsA.Fields("CRA04")
         If Not IsNull(rsA.Fields("CRA05")) Then
            Text1(IIf(intIndex = 1, 12, IIf(intIndex = 2, 28, IIf(intIndex = 3, 44, IIf(intIndex = 4, 60, 76))))) = rsA.Fields("CRA05") & rsA.Fields("CRA06")
            'Modify By Sindy 2022/10/12 新客戶欄位鎖住
            If "" & rsA.Fields("CRA03") = "Y" Then
               Text1(IIf(intIndex = 1, 12, IIf(intIndex = 2, 28, IIf(intIndex = 3, 44, IIf(intIndex = 4, 60, 76))))).Enabled = False
            End If
            '2022/10/12 END
            'Modify By Sindy 2022/12/25 客戶編號有值則呼叫Text1_Validate各欄位鎖住
            If Trim(Text1(IIf(intIndex = 1, 12, IIf(intIndex = 2, 28, IIf(intIndex = 3, 44, IIf(intIndex = 4, 60, 76))))).Text) <> "" Then
               'Modify By Sindy 2023/7/31 改使用 txtEnabled1 函數
               'Call Text1_Validate(IIf(intIndex = 1, 12, IIf(intIndex = 2, 28, IIf(intIndex = 3, 44, IIf(intIndex = 4, 60, 76)))), False)
               Call txtEnabled1(False, intIndex, True)
               '2023/7/31 END
            End If
            '2022/12/25 END
         End If
         If Not IsNull(rsA.Fields("CRA07")) Then '中文客戶名稱
            Text1(IIf(intIndex = 1, 21, IIf(intIndex = 2, 37, IIf(intIndex = 3, 53, IIf(intIndex = 4, 69, 85))))) = rsA.Fields("CRA07")
            'Add By Sindy 2022/10/12 + 記錄Tag,按下存檔檢查資料會用到
            Text1(IIf(intIndex = 1, 21, IIf(intIndex = 2, 37, IIf(intIndex = 3, 53, IIf(intIndex = 4, 69, 85))))).Tag = rsA.Fields("CRA07")
         End If
         If Not IsNull(rsA.Fields("CRA08")) Then '英文客戶名稱
            Text1(IIf(intIndex = 1, 22, IIf(intIndex = 2, 38, IIf(intIndex = 3, 54, IIf(intIndex = 4, 70, 86))))) = rsA.Fields("CRA08")
            'Add By Sindy 2022/10/12 + 記錄Tag,按下存檔檢查資料會用到
            Text1(IIf(intIndex = 1, 22, IIf(intIndex = 2, 38, IIf(intIndex = 3, 54, IIf(intIndex = 4, 70, 86))))).Tag = rsA.Fields("CRA08")
         End If
         If Not IsNull(rsA.Fields("CRA09")) Then Text1(IIf(intIndex = 1, 23, IIf(intIndex = 2, 39, IIf(intIndex = 3, 55, IIf(intIndex = 4, 71, 87))))) = rsA.Fields("CRA09")
         If Not IsNull(rsA.Fields("CRA10")) Then cboContact(intIndex) = rsA.Fields("CRA10")
         If Not IsNull(rsA.Fields("CRA11")) Then Text1(IIf(intIndex = 1, 34, IIf(intIndex = 2, 50, IIf(intIndex = 3, 66, IIf(intIndex = 4, 82, 98))))) = rsA.Fields("CRA11")
         If Not IsNull(rsA.Fields("CRA12")) Then Text1(IIf(intIndex = 1, 92, IIf(intIndex = 2, 93, IIf(intIndex = 3, 94, IIf(intIndex = 4, 95, 96))))) = rsA.Fields("CRA12")
         If Not IsNull(rsA.Fields("CRA13")) Then Text1(IIf(intIndex = 1, 14, IIf(intIndex = 2, 30, IIf(intIndex = 3, 46, IIf(intIndex = 4, 62, 78))))) = rsA.Fields("CRA13")
         If Not IsNull(rsA.Fields("CRA14")) Then Text1(IIf(intIndex = 1, 15, IIf(intIndex = 2, 31, IIf(intIndex = 3, 47, IIf(intIndex = 4, 63, 79))))) = rsA.Fields("CRA14")
         If Not IsNull(rsA.Fields("CRA15")) Then Text1(IIf(intIndex = 1, 16, IIf(intIndex = 2, 32, IIf(intIndex = 3, 48, IIf(intIndex = 4, 64, 80))))) = rsA.Fields("CRA15")
         If Not IsNull(rsA.Fields("CRA16")) Then Text1(IIf(intIndex = 1, 17, IIf(intIndex = 2, 33, IIf(intIndex = 3, 49, IIf(intIndex = 4, 65, 81))))) = rsA.Fields("CRA16")
         If Not IsNull(rsA.Fields("CRA17")) Then Text1(IIf(intIndex = 1, 19, IIf(intIndex = 2, 35, IIf(intIndex = 3, 51, IIf(intIndex = 4, 67, 83))))) = rsA.Fields("CRA17")
         If Not IsNull(rsA.Fields("CRA18")) Then Text1(IIf(intIndex = 1, 20, IIf(intIndex = 2, 36, IIf(intIndex = 3, 52, IIf(intIndex = 4, 68, 84))))) = rsA.Fields("CRA18")
         'Modify by Amy 2024/06/24 原照CRAXX顯示,避免已設好的郵遞區號被清掉,故先顯示地址再顯示郵遞區號
         If Not IsNull(rsA.Fields("CRA20")) Then
            Text1(IIf(intIndex = 1, 27, IIf(intIndex = 2, 43, IIf(intIndex = 3, 59, IIf(intIndex = 4, 75, 91))))) = rsA.Fields("CRA20")
            Text1(IIf(intIndex = 1, 27, IIf(intIndex = 2, 43, IIf(intIndex = 3, 59, IIf(intIndex = 4, 75, 91))))).Tag = rsA.Fields("CRA20") 'Add by Amy 2024/06/24
         End If
         If Not IsNull(rsA.Fields("CRA19")) Then '中文地址郵遞區號
            Text1(IIf(intIndex = 1, 120, IIf(intIndex = 2, 121, IIf(intIndex = 3, 122, IIf(intIndex = 4, 123, 124))))) = rsA.Fields("CRA19")
            'Modify By Sindy 2022/10/12 舊客戶欄位鎖住
            If "" & rsA.Fields("CRA03") = "" Then
               Text1(IIf(intIndex = 1, 120, IIf(intIndex = 2, 121, IIf(intIndex = 3, 122, IIf(intIndex = 4, 123, 124))))).Enabled = False
            End If
            '2022/10/12 END
         End If
         If Not IsNull(rsA.Fields("CRA23")) Then
            Text1(IIf(intIndex = 1, 26, IIf(intIndex = 2, 42, IIf(intIndex = 3, 58, IIf(intIndex = 4, 74, 90))))) = rsA.Fields("CRA23")
            Text1(IIf(intIndex = 1, 26, IIf(intIndex = 2, 42, IIf(intIndex = 3, 58, IIf(intIndex = 4, 74, 90))))).Tag = rsA.Fields("CRA23") 'Add by Amy 2024/06/24
         End If
         If Not IsNull(rsA.Fields("CRA22")) Then '聯絡地址郵遞區號
            Text1(IIf(intIndex = 1, 25, IIf(intIndex = 2, 41, IIf(intIndex = 3, 57, IIf(intIndex = 4, 73, 89))))) = rsA.Fields("CRA22")
            'Modify By Sindy 2022/10/12 舊客戶欄位鎖住
            If "" & rsA.Fields("CRA03") = "" Then
               Text1(IIf(intIndex = 1, 25, IIf(intIndex = 2, 41, IIf(intIndex = 3, 57, IIf(intIndex = 4, 73, 89))))).Enabled = False
            End If
            '2022/10/12 END
         End If
         'end 2024/06/24
         If Not IsNull(rsA.Fields("CRA21")) Then Text1(IIf(intIndex = 1, 125, IIf(intIndex = 2, 141, IIf(intIndex = 3, 157, IIf(intIndex = 4, 173, 189))))) = rsA.Fields("CRA21")
         If Not IsNull(rsA.Fields("CRA24")) Then Text1(IIf(intIndex = 1, 24, IIf(intIndex = 2, 40, IIf(intIndex = 3, 56, IIf(intIndex = 4, 72, 88))))) = rsA.Fields("CRA24")
         
         If m_blnCallPrint = False Then
            '舊客戶需 Run SetCustTxt 不然會易出現郵遞區號問題
            If Trim("" & rsA.Fields("CRA05") & rsA.Fields("CRA06")) <> "" And "" & rsA.Fields("CRA03") <> "Y" Then
               SetCustTxt Val(rsA.Fields("CRA02")), rsA.Fields("CRA05") & rsA.Fields("CRA06")
               PUB_AddContact rsA.Fields("CRA05") & rsA.Fields("CRA06"), cboContact(Val(rsA.Fields("CRA02"))), , True, True, m_strContactList(Val(rsA.Fields("CRA02")))
               If Not IsNull(rsA.Fields("CRA10")) Then cboContact(intIndex) = rsA.Fields("CRA10") 'Added by Lydia 2025/10/09 SetCustTxt會將接洽人改成客戶檔預設接洽人CU127，當智權人員修改後再次按修改會當成沒有存檔成功---唐韻如(10/7)
            End If
            
         End If
         
         'Add By Sindy 2022/9/15 有對造
         If "" & rsA.Fields("CRA26") = "Y" Then
            ChkCRA26(Val(rsA.Fields("CRA02")) - 1).Value = 1
            lblAPPLQ.Visible = True
            'ChkCRA26(Val(rsA.Fields("CRA02")) - 1).Enabled = False
         End If
         '2022/9/15 END
         'Add By Sindy 2022/11/8 有跨所
         If "" & rsA.Fields("CRA27") = "Y" Then
            ChkCRA27(Val(rsA.Fields("CRA02")) - 1).Value = 1
            lblZip.Visible = True
            'ChkCRA27(Val(rsA.Fields("CRA02")) - 1).Enabled = False
         End If
         '2022/11/8 END
         
         'Modify by Amy 22025/11/17 +客戶國籍及地址,並拆開各自判斷-與Sindy討論後
         ' ex:接洽單-1140025906 P-134950 舊客戶 X89923000 中文地址-廣州市南沙區...,無郵遞區號 會訊息並跳郵遞區號查詢
'         'Add By Sindy 2023/1/4
'         If "" & rsA.Fields("CRA22") = "" Then '聯絡地址郵遞區號
'            If "" & rsA.Fields("CRA23") <> "" Then
'               Call Text1_LostFocus(IIf(intIndex = 1, 26, IIf(intIndex = 2, 42, IIf(intIndex = 3, 58, IIf(intIndex = 4, 74, 90)))))
'            End If
'            If "" & rsA.Fields("CRA19") = "" Then '中文地址郵遞區號
'               If "" & rsA.Fields("CRA20") <> "" Then
'                  If "" & rsA.Fields("CRA23") = "" & rsA.Fields("CRA20") Then
'                     Call CmdSame_Click(rsA.Fields("CRA02"))
'                  Else
'                     Call Text1_LostFocus(IIf(intIndex = 1, 27, IIf(intIndex = 2, 43, IIf(intIndex = 3, 59, IIf(intIndex = 4, 75, 91)))))
'                  End If
'               End If
'            End If
'         End If
'         '2023/1/4 END
         'Modify by Amy 2025/11/18 新客戶簽核時,還不會有客戶編號
         strExc(9) = Pub_GetField("Customer", "cu01='" & rsA.Fields("CRA05") & "' And cu02='" & rsA.Fields("CRA06") & "' ", "CU87||';'||CU10")
         If strExc(9) = "" Then
            strExc(10) = IIf(intIndex = 1, 34, IIf(intIndex = 2, 50, IIf(intIndex = 3, 66, IIf(intIndex = 4, 82, 98))))
            If Trim(Text1(Val(strExc(10))).Text) <> "" And Trim(Text1(Val(strExc(10))).Text) <> "中華民國" _
              And Trim(Text1(Val(strExc(10))).Text) <> "台灣" And Trim(Text1(Val(strExc(10))).Text) <> "臺灣" _
              And Trim(Text1(Val(strExc(10))).Text) <> "台灣省" And Trim(Text1(Val(strExc(10))).Text) <> "臺灣省" Then
              strExc(9) = ";"
            Else
               strExc(9) = "001;001"
            End If
         End If
         arrNA01 = Split(strExc(9), ";")
         '聯絡地址郵遞區號 為空 且 聯絡地址 不為空 且 國籍 為台灣
         If "" & rsA.Fields("CRA22") = "" And "" & rsA.Fields("CRA23") <> "" And arrNA01(0) < "010" Then
            Call Text1_LostFocus(IIf(intIndex = 1, 26, IIf(intIndex = 2, 42, IIf(intIndex = 3, 58, IIf(intIndex = 4, 74, 90)))))
         End If
         '中文地址郵遞區號 且 中文地址 不為空 且 國籍 為台灣
         If "" & rsA.Fields("CRA19") = "" And "" & rsA.Fields("CRA20") <> "" And arrNA01(1) < "010" Then
            Call Text1_LostFocus(IIf(intIndex = 1, 27, IIf(intIndex = 2, 43, IIf(intIndex = 3, 59, IIf(intIndex = 4, 75, 91)))))
         End If
         '聯絡地址=中文地址
         If "" & rsA.Fields("CRA23") = "" & rsA.Fields("CRA20") Then
            Call CmdSame_Click(rsA.Fields("CRA02"))
         End If
         'end 2025/11/17
         '申請人1
         If rsA.Fields("CRA02") = "1" Then
            If "" & rsA.Fields("CRA25") = "Y" Then
               optCP811(0).Value = True
            ElseIf "" & rsA.Fields("CRA25") = "N" Then
               optCP811(1).Value = True
            End If
            If Option31(0).Value = True Then
               '有客戶編號或特例不可以再異動
               If Not IsNull(rsA.Fields("CRA05")) Or "" & rsA.Fields("CRA26") = "Y" Then
                  Option31(0).Enabled = False
                  Option31(1).Enabled = False
               End If
            End If
         '申請人2
         ElseIf rsA.Fields("CRA02") = "2" Then
            If "" & rsA.Fields("CRA25") = "Y" Then
               optCP812(0).Value = True
            ElseIf "" & rsA.Fields("CRA25") = "N" Then
               optCP812(1).Value = True
            End If
            If Option32(0).Value = True Then
               '有客戶編號或特例不可以再異動
               If Not IsNull(rsA.Fields("CRA05")) Or "" & rsA.Fields("CRA26") = "Y" Then
                  Option32(0).Enabled = False
                  Option32(1).Enabled = False
               End If
            End If
         '申請人3
         ElseIf rsA.Fields("CRA02") = "3" Then
            If "" & rsA.Fields("CRA25") = "Y" Then
               optCP813(0).Value = True
            ElseIf "" & rsA.Fields("CRA25") = "N" Then
               optCP813(1).Value = True
            End If
            If Option33(0).Value = True Then
               '有客戶編號或特例不可以再異動
               If Not IsNull(rsA.Fields("CRA05")) Or "" & rsA.Fields("CRA26") = "Y" Then
                  Option33(0).Enabled = False
                  Option33(1).Enabled = False
               End If
            End If
         '申請人4
         ElseIf rsA.Fields("CRA02") = "4" Then
            If "" & rsA.Fields("CRA25") = "Y" Then
               optCP814(0).Value = True
            ElseIf "" & rsA.Fields("CRA25") = "N" Then
               optCP814(1).Value = True
            End If
            If Option34(0).Value = True Then
               '有客戶編號或特例不可以再異動
               If Not IsNull(rsA.Fields("CRA05")) Or "" & rsA.Fields("CRA26") = "Y" Then
                  Option34(0).Enabled = False
                  Option34(1).Enabled = False
               End If
            End If
         '申請人5
         ElseIf rsA.Fields("CRA02") = "5" Then
            If "" & rsA.Fields("CRA25") = "Y" Then
               optCP815(0).Value = True
            ElseIf "" & rsA.Fields("CRA25") = "N" Then
               optCP815(1).Value = True
            End If
            If Option35(0).Value = True Then
               '有客戶編號或特例不可以再異動
               If Not IsNull(rsA.Fields("CRA05")) Or "" & rsA.Fields("CRA26") = "Y" Then
                  Option35(0).Enabled = False
                  Option35(1).Enabled = False
               End If
            End If
         End If
         rsA.MoveNext
      Loop
   End If
   rsA.Close
   '*****************
   '發明人
   '*****************
   strExc(0) = "Select * " & _
                 "From consultrecinv " & _
               "Where cri01 ='" & Trim(Text5) & "' " & _
               "order by cri02 asc "
   intI = 1
   Set rsA = ClsLawReadRstMsg(intI, strExc(0))
   strInventorNo = "": strInventorName = "" 'Add By Sindy 2011/1/31 +strInventorName
   If intI = 1 Then
      rsA.MoveFirst
      Do While Not rsA.EOF
         intIndex = rsA.Fields("CRI02") - 1
         If Not IsNull(rsA.Fields("CRI03")) Then
            If strInventorNo <> "" Then strInventorNo = strInventorNo & ","
            strInventorNo = strInventorNo & rsA.Fields("CRI03") & rsA.Fields("CRI04")
            'Add By Sindy 2011/1/31 +strInventorName
            If strInventorName <> "" Then strInventorName = strInventorName & "|" '"," Modify By Sindy 2023/6/2
            'Modify By Sindy 2024/5/8 +ID P-133476 X530940125,27 發明人的中文同名同姓
            strInventorName = strInventorName & rsA.Fields("CRI06") & rsA.Fields("CRI05")
            '2011/1/31 End
            Label5(intIndex).Tag = rsA.Fields("CRI03") & rsA.Fields("CRI04") 'Add By Sindy 2023/1/18
         End If
         If Not IsNull(rsA.Fields("CRI05")) Then Text3(intIndex) = rsA.Fields("CRI05")
         If Not IsNull(rsA.Fields("CRI06")) Then Text2(intIndex) = rsA.Fields("CRI06")
         If Not IsNull(rsA.Fields("CRI07")) Then Text4(intIndex) = rsA.Fields("CRI07")
         If Not IsNull(rsA.Fields("CRI08")) Then Combo3(intIndex) = rsA.Fields("CRI08")
         Call Combo3_Validate(intIndex, Cancel)
         If "" & rsA.Fields("CRI09") = "Y" Then ChkAddress(intIndex).Value = 1
         rsA.MoveNext
      Loop
   End If
   cmdInventor.Tag = strInventorNo
   Call SetColColor 'Add By Sindy 2023/1/18
   rsA.Close
   '*****************
   '商標圖檔
   '*****************
   strExc(0) = "Select * " & _
                 "From consultrecimagef " & _
               "Where crif01 ='" & Trim(Text5) & "' "
   intI = 1
   Set rsA = ClsLawReadRstMsg(intI, strExc(0))
   If intI = 1 Then
      '顯示圖檔
      rsA.MoveFirst
      If CheckStr(rsA.Fields("crif02")) = "1" Or CheckStr(rsA.Fields("crif02")) = "3" Then optColor(0).Value = True Else optColor(1).Value = True
      '加入無圖式的格式
      If CheckStr(rsA.Fields("crif02")) = "3" Or CheckStr(rsA.Fields("crif02")) = "4" Or CheckStr(rsA.Fields("crif02")) = "6" Then IsWmf = True Else IsWmf = False
      If IsWmf = False Then
         stAttPath = App.path & "\NowPic.jpg"
      Else
         stAttPath = App.path & "\NowPic.wmf"
      End If
      
      'Add By Sindy 2017/6/1
      If "" & rsA.Fields("crif05") <> "" Then
         PUB_GetFtpFile rsA.Fields("crif05"), stAttPath, UCase("consultrecimagef")
      Else
      '2017/6/1 END
         ReDim bytes(Val(rsA.Fields("crif03").Value))
         bytes() = rsA.Fields("crif04").GetChunk(Val(rsA.Fields("crif03").Value))
         file_num = FreeFile
'         If IsWmf = False Then
'             Open App.path & "\NowPic.jpg" For Binary Access Write As #file_num
'         Else
'             Open App.path & "\NowPic.wmf" For Binary Access Write As #file_num
'         End If
         Open stAttPath For Binary Access Write As #file_num
         Put #file_num, , bytes()
         Close #file_num
      End If
'      If IsWmf = False Then
'          PicToObj Trim(App.path & "\NowPic.jpg")
'      Else
'          PicToObj Trim(App.path & "\NowPic.wmf")
'      End If
      PicToObj Trim(stAttPath)
'      If Dir(App.path & "\NowPic.jpg") <> "" Then
'          Kill App.path & "\NowPic.jpg"
'      End If
'      If Dir(App.path & "\NowPic.wmf") <> "" Then
'          Kill App.path & "\NowPic.wmf"
'      End If
      If Dir(stAttPath) <> "" Then
          Kill stAttPath
      End If
      If Dir(App.path & "\tmp.tif") <> "" Then
          Kill App.path & "\tmp.tif"
      End If
      Me.SSTab1.Tab = 4
   Else
      Me.SSTab1.Tab = 0
   End If
   rsA.Close
   'Me.SSTab2.Tab = 0
   If SSTab2.TabVisible(0) = True Then Me.SSTab2.Tab = 0
   'Me.SSTab1.Tab = 0
   
   Call QueryData_Flow '查詢簽核狀況 Add By Sindy 2022/9/19
   
   Set rsA = Nothing
   Set rsD = Nothing
   
   m_IsQueryNow = False 'Added by Morgan 2023/4/27
End Function

'Add By Sindy 2023/1/18
Private Sub SetColColor()
Dim i As Integer
   
   For i = 0 To 9
      If Label5(i).Tag = "" And Trim(Text2(i).Text) <> "" Then
         Label5(i).BackColor = &H80FFFF   '黃色
      Else
         Label5(i).BackColor = &H8000000F '底色:按鈕表面
      End If
   Next i
End Sub
'Add By Sindy 2023/12/7 鎖住或開放發明人欄位
Private Sub SetInventorCol(Optional strRow As String = "")
Dim i As Integer, intRow As Integer
Dim intStarR As Integer
   
   If strRow = "" Then
      intStarR = 0
      intRow = 9
   Else
      intStarR = Val(strRow)
      intRow = Val(strRow)
   End If
   For i = intStarR To intRow
      If Trim(Label5(i).Tag) <> "" Then '有ID,欄位必需鎖住; 以免人為調整成不同人的資料
         Text2(i).Enabled = False
         Text3(i).Enabled = False
         Combo3(i).Enabled = False
         Text4(i).Enabled = False
         ChkAddress(i).Enabled = False
      Else '沒有ID,欄位開放輸入
         Text2(i).Enabled = True
         Text3(i).Enabled = True
         Combo3(i).Enabled = True
         Text4(i).Enabled = True
         ChkAddress(i).Enabled = True
      End If
   Next
End Sub

'Add By Sindy 2010/6/21 抓取主檔資料
Private Sub GetMainData()
Dim StrSQLa As String
Dim rsA As New ADODB.Recordset
   
   m_strPA08 = "" '專利種類
   m_strPA16 = ""
   m_strPA10 = ""
   m_strPA14 = "" '2010/8/17 ADD BY SONIA
   m_strTM15 = ""
   m_strTM12 = ""
   m_strTM09 = "" 'Add By Sindy 2022/12/29 商品類別
   m_strTM22 = "" 'Add By Sindy 2022/12/29 專用期間(止日)
   If Trim(Text1(6)) = "" Then Exit Sub
   Call GetSysApp
   
   '2008/3/21 modify by sonia 商標案加抓tm15,tm12
   'Modify by Morgan 2008/8/1 加抓個案申請人聯絡人編號
   'Modify by Sindy 2009/05/21 加抓商標檔申請人2,3,4,5及服務檔申請人4,5
   '2010/3/31 MODIFY BY SONIA 專利案加申請日
   '2010/8/17 MODIFY BY SONIA 專利案加公告日pa14
   'Modify By Sindy 2011/2/21 增加LC43,LC44,LC45,LC46,HC24,HC25,HC26,HC27
   StrSQLa = "Select PA26, PA27, PA28, PA29, PA30 From Patent, Nation,Customer Where PA09=NA01(+) And PA01='" & Me.Text1(6).Text & "' And PA02='" & Me.Text1(7).Text & "' And PA03='" & Me.Text1(8).Text & "' And PA04='" & Me.Text1(9).Text & "' and cu01(+)=substr(pa26,1,8) and cu02(+)=substr(pa26,9,1) "
   StrSQLa = StrSQLa & " Union Select TM23, TM78, TM79, TM80, TM81 From Trademark, Nation,Customer Where TM10=NA01(+) And TM01='" & Me.Text1(6).Text & "' And TM02='" & Me.Text1(7).Text & "' And TM03='" & Me.Text1(8).Text & "' And TM04='" & Me.Text1(9).Text & "' and cu01(+)=substr(TM23,1,8) and cu02(+)=substr(TM23,9,1)  "
   StrSQLa = StrSQLa & " Union Select LC11, LC43, LC44, LC45, LC46 From Lawcase, Nation,Customer Where LC15=NA01(+) And LC01='" & Me.Text1(6).Text & "' And LC02='" & Me.Text1(7).Text & "' And LC03='" & Me.Text1(8).Text & "' And LC04='" & Me.Text1(9).Text & "' and cu01(+)=substr(LC11,1,8) and cu02(+)=substr(LC11,9,1) "
   StrSQLa = StrSQLa & " Union Select HC05, HC24, HC25, HC26, HC27 From Hirecase, Nation,Customer Where '000'=NA01(+) And HC01='" & Me.Text1(6).Text & "' And HC02='" & Me.Text1(7).Text & "' And HC03='" & Me.Text1(8).Text & "' And HC04='" & Me.Text1(9).Text & "' and cu01(+)=substr(HC05,1,8) and cu02(+)=substr(HC05,9,1) "
   StrSQLa = StrSQLa & " Union Select SP08, SP58, SP59, SP65, SP66 From Servicepractice, Nation,Customer Where SP09=NA01(+) And SP01='" & Me.Text1(6).Text & "' And SP02='" & Me.Text1(7).Text & "' And SP03='" & Me.Text1(8).Text & "' And SP04='" & Me.Text1(9).Text & "' and cu01(+)=substr(SP08,1,8) and cu02(+)=substr(SP08,9,1) "
   rsA.CursorLocation = adUseClient
   rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
   If rsA.RecordCount > 0 Then
      'Add By Sindy 2022/12/23 記錄基本檔的申請人
      strAppl1 = "" & rsA.Fields("PA26")
      strAppl2 = "" & rsA.Fields("PA27")
      strAppl3 = "" & rsA.Fields("PA28")
      strAppl4 = "" & rsA.Fields("PA29")
      strAppl5 = "" & rsA.Fields("PA30")
   End If
   If rsA.State <> adStateClosed Then rsA.Close
   
   '抓專利資料
   If m_strSys = "1" Then
      StrSQLa = "Select PA08,PA16,PA10,PA14 From Patent, Nation,Customer Where PA09=NA01(+) And PA01='" & Me.Text1(6).Text & "' And PA02='" & Me.Text1(7).Text & "' And PA03='" & Me.Text1(8).Text & "' And PA04='" & Me.Text1(9).Text & "' and cu01(+)=substr(pa26,1,8) and cu02(+)=substr(pa26,9,1) "
      rsA.CursorLocation = adUseClient
      rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
      If rsA.RecordCount > 0 Then
         m_strPA08 = "" & rsA.Fields("PA08").Value
         m_strPA16 = "" & rsA.Fields("PA16").Value
         '2010/8/17 ADD BY SONIA
         m_strPA14 = "" & rsA.Fields("PA14").Value
         If m_strPA14 = "0" Then m_strPA14 = ""
         '2010/8/17 END
         m_strPA10 = "" & rsA.Fields("PA10").Value  '2010/3/31 ADD BY SONIA
         'Add By Sindy 2010/7/9
         If m_strPA08 <> "" Then '代表有pa資料
            ReDim pa(1 To TF_PA) As String
            Call PUB_ReadPatentData(pa(), Text1(6), Text1(7), Text1(8), Text1(9))
         End If
         'Add By Sindy 2025/1/13
         If pa(46) = "Y" Then
            ChkPCT.Value = 1
         Else
            ChkPCT.Value = 0
         End If
         ChkPCT.Enabled = False
         '2025/1/13 END
         'Add By Sindy 2025/1/24 帶出個體別資料 ex:CFP-034189
         If pa(179) <> "" Then '個體別
            Call SetFrame28
            OptEntity(Val(pa(179)) - 1).Value = True
         End If
         '2025/1/24 END
      End If
      If rsA.State <> adStateClosed Then rsA.Close
   
   '抓商標資料
   ElseIf m_strSys = "2" Then
      StrSQLa = "Select TM09,TM15,TM12,TM22 From Trademark, Nation,Customer Where TM10=NA01(+) And TM01='" & Me.Text1(6).Text & "' And TM02='" & Me.Text1(7).Text & "' And TM03='" & Me.Text1(8).Text & "' And TM04='" & Me.Text1(9).Text & "' and cu01(+)=substr(TM23,1,8) and cu02(+)=substr(TM23,9,1)  "
      rsA.CursorLocation = adUseClient
      rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
      If rsA.RecordCount > 0 Then
         '2008/3/21 ADD BY SONIA
         m_strTM15 = "" & rsA.Fields("TM15").Value
         m_strTM12 = "" & rsA.Fields("TM12").Value
         m_strTM09 = "" & rsA.Fields("TM09").Value 'Add By Sindy 2022/12/29 商品類別
         m_strTM22 = "" & rsA.Fields("TM22").Value 'Add By Sindy 2022/12/29 專用期間(止日)
      End If
      If rsA.State <> adStateClosed Then rsA.Close
   End If
   
   Set rsA = Nothing
End Sub

Private Sub DelPic()
   Dim strPicFileName As String
   strPicFileName = App.path & "\$tmp_*.tmp"
   If Dir(strPicFileName) <> "" Then
      Kill strPicFileName
   End If
   m_Device.Line (0, 0)-(m_Device.Width, m_Device.Height), QBColor(15), BF
End Sub

Private Sub SetPic(idx As Integer)

   Dim strPicFileName As String
   strPicFileName = App.path & "\$tmp_" & idx & ".tmp"
   
   SavePicture Picture1.Image, strPicFileName
   '要用覆蓋的否則會錯誤--VB Bug
   'Picture1.Cls
   m_Device.Line (0, 0)-(m_Device.Width, m_Device.Height), QBColor(15), BF
   
End Sub

'Modify By Sindy 2010/7/9 copy From 內專領證發文
'Modify by Morgan 2010/12/9 刪除部分用不到的程式碼
'計算相關費用
Private Function ChkPatentYearFee( _
    strYF01 As String, strYF02 As String, strYF03 As String, _
    strYF04 As String, strYF05From As String, strYF05To As String, blnDouble As Boolean, _
    longLawFee As Long, strCP81 As String, mKind As Integer, Optional ByRef strServiceFee As String, Optional ByRef strOfficalFee As String) As Boolean
'Add by Lydia 2014/12/15 台灣領證繳年費(自動收文)帶入年度相應的費用,並提示年度訊息
'Private Function ChkPatentYearFee( _
    strYF01 As String, strYF02 As String, strYF03 As String, _
    strYF04 As String, strYF05From As String, strYF05To As String, blnDouble As Boolean, _
    longLawFee As Long, strCP81 As String, Optional ByRef strOfficalFee As String) As Boolean
    
'strYF01  申請國家
'strYF02  專利種類
'strYF03  代理人
'strYF04  案件性質
'strYF05From  起始年度
'strYF05To  終止年度
'blnDouble   規費是否雙倍
'longLawFee 規費
'strCP81      是否減免客戶
'Add by Lydia 2014/12/15
'mKind : 1.判斷 2.求代入標準價
'strServiceFee 標準價的服務費
Dim chinaSFee As Double  'Add by Lydia 2014/12/25 大陸案服務費
Dim tmpC1 As String 'Modified by Lydia 2015/03/19
   Dim rsA As New ADODB.Recordset
   Dim StrSQLa As String
   Dim ii As Integer
   Dim strOfficalFee1 As String
   Dim strOfficalFee2 As String
   Dim iYear As Integer       '繳費年度
   Dim lngDDate As Long '是否減免控制日期
   Dim bol802 As Boolean   '是否有異議答辯
   Dim stUtiAppDate As String  '新型申請日
   
   bol802 = PUB_ChkCPExist(pa, "802")

   ChkPatentYearFee = False
   strOfficalFee = 0
   strOfficalFee1 = 0
   strOfficalFee2 = 0

'Added by Morgan 2013/3/13 台灣年費改呼叫共用函數
If strYF01 = "000" And strYF04 = "605" Then
   PUB_GetPatentYearFee strYF01, strYF02, strYF03, strYF04, Text1(142).Text, Text1(143).Text, blnDouble, strCP81, pa(14), strSrvDate(1), strOfficalFee
Else
'end 2013/3/13
   ii = 1
   '取得案件性質為領證及繳年費的相關費用
   If strYF04 = "601" Then       '2010/11/18 add by sonia 案件性質為領證才抓此
      '2010/11/19 add by sonia 加入大陸領證規費
      If strYF01 = "020" Then
         StrSQLa = "Select c2.cp44 From caseprogress c1,caseprogress c2,nextprogress Where " & ChgNextProgress(pa(1) & pa(2) & pa(3) & pa(4)) & " and '601'=np07 and np01=c1.cp09(+) and c1.cp43=c2.cp09(+)"
         rsA.CursorLocation = adUseClient
         rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
         If rsA.RecordCount > 0 Then
            'Modified by Lydia 2014/12/25 增加大陸案服務費
'            strOfficalFee1 = PUB_Get020601Fee(pa, "" & rsA.Fields(0), strYF05From, strYF05To)
            strOfficalFee1 = PUB_Get020601Fee(pa, "" & rsA.Fields(0), Text1(142).Text, Text1(143).Text, chinaSFee)
         End If
         If rsA.State <> adStateClosed Then rsA.Close
         Set rsA = Nothing
      Else
      '2010/11/19 end
         '2010/11/18 modify by sonia 領證固定抓第一年
         'StrSQLa = "Select * From PatentYearFee Where YF01='" & strYF01 & "' AND YF02='" & strYF02 & "' AND YF03='" & strYF03 & "' AND YF04='" & strYF04 & "' AND YF05>=" & Val(strYF05From) & " AND YF05<=" & Val(strYF05From) & " Order By YF05 "
'         StrSQLa = "Select * From PatentYearFee Where YF01='" & strYF01 & "' AND YF02='" & strYF02 & "' AND YF03='" & strYF03 & "' AND YF04='" & strYF04 & "' AND YF05=1 Order By YF05 "
'         rsA.CursorLocation = adUseClient
'         rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
'         While Not rsA.EOF
'            '領證的規費不用Double
'            strOfficalFee1 = Val(strOfficalFee1) + Val(rsA.Fields("YF07").Value)
'            rsA.MoveNext
'            ii = ii + 1
'         Wend
'         If rsA.State <> adStateClosed Then rsA.Close
'         Set rsA = Nothing
         'Modified by Lydia 2015/01/12 增加領證報價,採共用模組
         'Memo by Lydia 2025/02/07 後面程式會針對台灣案領證會重抓特殊設定的服務費和規費;ex.亞浩電子X41570080(P-132249)
         strExc(0) = PUB_GetYF07(strYF01, strYF02, ChangeCustomerL(pa(26)), strYF04, "1", "1", "1")
         strOfficalFee1 = Val(strOfficalFee1) + Val(strExc(0))
         ii = ii + 1
      End If  '2010/11/19 end
   End If
   ii = 1
   '取得案件性質為年費的相關費用
   If strYF01 = "020" And strYF04 = "601" Then '2010/11/19 ADD BY SONIA 大陸領證此段不做,已在PUB_Get020601Fee計算
   Else
     'Modified by Lydia 2015/01/12 增加年費報價,採共用模組
'      StrSQLa = "Select * From PatentYearFee Where YF01='" & strYF01 & "' AND YF02='" & strYF02 & "' AND YF03='" & strYF03 & "' AND YF04='" & 年費 & "' AND YF05>=" & Val(strYF05From) & " AND YF05<=" & Val(strYF05To) & " Order By YF05 "
'      rsA.CursorLocation = adUseClient
'      rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
'      While Not rsA.EOF
'        strOfficalFee2 = Val(strOfficalFee2) + Val(rsA.Fields("YF07").Value)
       For intI = Val(Text1(142).Text) To Val(Text1(143).Text)
         strExc(0) = PUB_GetYF07(strYF01, strYF02, ChangeCustomerL(pa(26)), 年費, str(intI), str(intI), "1")
         strOfficalFee2 = Val(strOfficalFee2) + Val(strExc(0))
         
         If strYF01 = "000" Then 'Add by Morgan 2010/12/13 台灣才有減免與加倍
            '年費減免
            If strCP81 = "Y" Then
              '2015/01/12 iYear = Val(rsA.Fields("YF05").Value)
               iYear = intI
               '沒有公告日或公告日+繳費年度>930701的才能減免
               '若有被異議時使用過的年費都不可減免,否則當年度(使用中)的可減免
               lngDDate = Val(pa(14))
               If lngDDate > 0 Then
                  '若被異議用該年費有效起日判斷
                  If bol802 = True Then
                     lngDDate = Val(pa(14)) + (iYear - 1) * 10000#
                  '未被異議用該年費有效迄日判斷
                  Else
                     lngDDate = Val(pa(14)) + (iYear) * 10000# - 1
                  End If
               End If
               '年費期限930701以後的都要減免
               If (lngDDate = 0 Or Val(lngDDate) > 930701) Then
                  If iYear >= 1 And iYear <= 3 Then
                     strOfficalFee2 = strOfficalFee2 - 800
                  ElseIf iYear >= 4 And iYear <= 6 Then
                     strOfficalFee2 = strOfficalFee2 - 1200
                  End If
               End If
               '加倍補繳
               If blnDouble = True And ii = 1 Then
                  strOfficalFee2 = strOfficalFee2 * 2#
               End If
            Else
               '起始那年年費是否雙倍
              '2015/01/12 If blnDouble = True And ii = 1 Then strOfficalFee2 = Val(rsA.Fields("YF07").Value) * 2
              If blnDouble = True And ii = 1 Then strOfficalFee2 = Val(strExc(0)) * 2
            End If
            
         End If
         
         ii = ii + 1
       Next intI
'         rsA.MoveNext
'         ii = ii + 1
'      Wend
'      If rsA.State <> adStateClosed Then rsA.Close
'      Set rsA = Nothing
   End If

   strOfficalFee = Val(strOfficalFee1) + Val(strOfficalFee2)
   'Modified by Lydia 2015/01/12 增加年費報價,採共用模組
   'Modified by Lydia 2015/03/19 領證601的服務費會歸零
'   If strYF01 = "020" And strYF04 = "605" Then strExc(0) = PUB_GetYF06(strYF01, strYF02, ChangeCustomerL(pa(26)), strYF04, strYF05From, strYF05From, "1")
'   chinaSFee = Val(strExc(0))
   'Modified by Morgan 2015/9/9 改非臺灣
   'If strYF01 = "020" And strYF04 = "605" Then
   If strYF01 <> "000" And strYF04 = "605" Then
   'end 2015/9/9
      'Modified by Lydia 2015/03/27 大陸年費服務費第1年=領證費,其他年皆各別要算服務費
      'tmpC1 = PUB_GetYF06(strYF01, strYF02, ChangeCustomerL(pa(26)), strYF04, strYF05From, strYF05From, "1")
      tmpC1 = PUB_GetYF06(strYF01, strYF02, ChangeCustomerL(pa(26)), strYF04, Text1(142).Text, Text1(143).Text, "1")
      chinaSFee = Val(tmpC1)
   End If
   
'end  2015/01/12
End If 'Added by Morgan 2013/3/13
   
   If strYF04 = "601" Then 'Add by Morgan 2010/12/13 只有台灣領證才有
   
      '台灣新型93.7.1以前申請,93.7.1(含)以後核准的規費可減免1500
      'Modify by Morgan 2011/5/18 日期全部都要轉西元年比較才不用考慮來源格式問題
      If (pa(8) = "2" And pa(9) = "000" And DBDATE(pa(20)) >= DBDATE(930701)) Then
         stUtiAppDate = PUB_UtiAppDate(pa, pa(10))
         If DBDATE(stUtiAppDate) < DBDATE(930701) Then
            strOfficalFee = Val(strOfficalFee) - 1500
         End If
      End If
      
   End If
    
   'Added by Lydia 2025/02/07 台灣案領證會重抓特殊設定的服務費和規費;ex.亞浩電子X41570080(1~3年都有內含服務費,所以是固定金額)
   If strYF01 = "000" And strYF04 = "601" Then
       StrSQLa = " SELECT 0 as OD1, nvl(YS07,0) as YF06, nvl(YS08,0) as YF07 FROM PATENTYEARSPEC WHERE YS01='" & strYF01 & "' AND YS02='" & strYF02 & "' AND YS03='" & ChangeCustomerL(pa(26)) & "' AND YS04='" & strYF04 & "' AND YS05 = " & Val(Text1(142).Text) & " AND YS06 = " & Val(Text1(143).Text)
       rsA.CursorLocation = adUseClient
       rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
       If rsA.RecordCount > 0 Then
           strOfficalFee = Val("" & rsA.Fields("YF07")) '直接回傳規費
           strServiceFee = Val("" & rsA.Fields("YF06")) + Val("" & rsA.Fields("YF07"))
           StrSQLa = "Y"
       End If
       If rsA.State <> adStateClosed Then rsA.Close
       Set rsA = Nothing
       If StrSQLa = "Y" Then
           ChkPatentYearFee = True
           Exit Function
       End If
   End If
   'end 2025/02/07
   
'Add by Lydia 2014/12/15 台灣領證繳年費(自動收文)帶入年度相應的費用,並提示年度訊息
    If mKind = "2" Then
        Dim mFeedot As Double, mFeedot2 As Double
        
        If strYF01 = "000" Then '台灣P案
           'Added by Lydia 2016/09/10 經確認台灣P案,不管一次繳幾年,都只算第一次的服務費,EX. P-105535 601(1.5P)
           strExc(0) = "0"
           'Modified by Lydia 2023/10/02 加入專利年費特殊設定檔PatentYearSpec
           'StrSQLa = "Select nvl(YF06,0) pt1 From PatentYearFee Where YF01='" & strYF01 & "' AND YF02='" & strYF02 & "' AND YF03='" & ChangeCustomerL(pa(26)) & "' AND YF04='" & strYF04 & "' AND YF05 = " & Val(Text1(142).Text)
           'Memo by Lydia 2025/10/02 不記得為何不用抓，先還原(P-117233第10年年費) ---- 'Modified by Lydia 2025/02/07 不用抓專利年費特殊設定檔PatentYearSpec
           StrSQLa = " SELECT 0 as OD1, nvl(YS07,0) AS pt1 FROM PATENTYEARSPEC WHERE YS01='" & strYF01 & "' AND YS02='" & strYF02 & "' AND YS03='" & ChangeCustomerL(pa(26)) & "' AND YS04='" & strYF04 & "' AND YS05 = " & Val(Text1(142).Text) & " AND YS06 = " & Val(Text1(143).Text) & _
                     " Union Select 1 as OD2, nvl(YF06,0) pt1 From PatentYearFee Where YF01='" & strYF01 & "' AND YF02='" & strYF02 & "' AND YF03='" & ChangeCustomerL(pa(26)) & "' AND YF04='" & strYF04 & "' AND YF05 = " & Val(Text1(142).Text)
           'Mark by Lydia 2025/10/02 還原抓專利年費特殊設定檔PatentYearSpec
           'StrSQLa = "Select 1 as OD1,nvl(YF06,0) pt1 From PatentYearFee Where YF01='" & strYF01 & "' AND YF02='" & strYF02 & "' AND YF03='" & ChangeCustomerL(pa(26)) & "' AND YF04='" & strYF04 & "' AND YF05 = " & Val(Text1(142).Text)
           StrSQLa = "select * from (" & StrSQLa & ") where nvl(pt1,0) > 0 order by OD1"
           'end 2023/10/02
           rsA.CursorLocation = adUseClient
           rsA.Open StrSQLa, cnnConnection, adOpenStatic, adLockReadOnly
           If rsA.RecordCount > 0 Then
               strExc(0) = "" & rsA.Fields("pt1")
           End If
           If rsA.State <> adStateClosed Then rsA.Close
           Set rsA = Nothing
           If Val(strExc(0)) > 0 Then
                strServiceFee = strOfficalFee + Val(strExc(0))
           Else '原程式:抓案件國家收費的標準價
                Call GetstrIDentity 'Add By Sindy 2023/2/7
                'Modify By Sindy 2025/4/8 傳入案件屬性
                'Modify By Sindy 2025/8/26 +, Text1(5): 代理人編號
                If ClsPDGetCaseLowPrice(pa(1), strYF01, strYF04, mFeedot, mFeedot2, _
                   IIf(Combo6.Visible = True, Left(Combo6, 1), ""), strIDentity, , _
                   IIf(OptChoose(1).Value = True, "2", "1"), Text1(6), Text1(7), Text1(8), Text1(9), _
                   IIf(Combo5.Visible = True, Left(Combo5, 1), ""), Text1(5)) = 1 Then '傳標準價
                Else
                   mFeedot = 3
                End If
                strServiceFee = strOfficalFee + mFeedot * 1000
           End If
           'end 2016/09/10
          ChkPatentYearFee = True
          Exit Function
          
        'Modified by Morgan 2015/9/9 改非臺灣
        'ElseIf strYF01 = "020" And chinaSFee > 0 Then
        ElseIf strYF01 <> "000" And chinaSFee > 0 Then
        'end 2015/9/9
        'Modified by Lydia 2014/12/25 設定大陸領證費,增加服務費
                strServiceFee = strOfficalFee + chinaSFee
                ChkPatentYearFee = True
                Exit Function
            Else
                ChkPatentYearFee = False
                Exit Function
        End If
    End If

   'Modify by Morgan 2010/12/13 大陸年費逾期改控制大於原來規費就好--郭
   'If longLawFee <> Val(strOfficalFee) Then
   '   ChkPatentYearFee = False
   'Modified by Morgan 2022/3/17 原控制有錯 Ex:P-104186
   'If strYF01 = "020" And blnDouble = True And longLawFee > Val(strOfficalFee) Then
   '   ChkPatentYearFee = False
   If strYF01 = "020" And blnDouble = True Then
      If longLawFee > Val(strOfficalFee) Then
         ChkPatentYearFee = True
      Else
         ChkPatentYearFee = False
      End If
   'end 2022/3/17
   ElseIf longLawFee <> Val(strOfficalFee) Then
      ChkPatentYearFee = False
   'end 2010/12/13
   Else
      ChkPatentYearFee = True
   End If
   
End Function

'Add by Morgan 2010/12/10
'檢查案件是否已閉卷
Private Function IfCaseClosed() As Boolean
   If Option1(1).Value = True Then
      strExc(0) = "select pa57 from patent where pa01='" & Text1(6) & "' and pa02='" & Text1(7) & "' and pa03='" & Text1(8) & "' and pa04='" & Text1(9) & "' and pa57 is not null" & _
         " union select tm29 from trademark where tm01='" & Text1(6) & "' and tm02='" & Text1(7) & "' and tm03='" & Text1(8) & "' and tm04='" & Text1(9) & "' and tm29 is not null" & _
         " union select sp15 from servicepractice where sp01='" & Text1(6) & "' and sp02='" & Text1(7) & "' and sp03='" & Text1(8) & "' and sp04='" & Text1(9) & "' and sp15 is not null" & _
         " union select lc08 from lawcase where lc01='" & Text1(6) & "' and lc02='" & Text1(7) & "' and lc03='" & Text1(8) & "' and lc04='" & Text1(9) & "' and lc08 is not null" & _
         " union select hc09 from hirecase where hc01='" & Text1(6) & "' and hc02='" & Text1(7) & "' and hc03='" & Text1(8) & "' and hc04='" & Text1(9) & "' and hc09 is not null"
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 1 Then
         IfCaseClosed = True
      End If
   End If
End Function
'Add by Morgan 2010/12/10
'是否有減免退費未辦理
Private Function IfDiscFeeNotPaid(pCaseNo() As String, pCurDiscStat As String) As Boolean
   If pCurDiscStat = "Y" And Left(Combo1(0), 3) = "000" Then
      IfDiscFeeNotPaid = PUB_CheckYearFeeReturn(pCaseNo, False)
   End If
End Function

'Add by Morgan 2011/1/10 從 cmdok_Click 搬來以便共用
'檢查是否特殊客戶
'Modify By Sindy 2015/7/27 +Optional ByVal pIndex As Integer = 0 pIndex:傳入要檢查第x個申請人資料,若0代表全部檢查一次
Private Sub SetCuData(ByRef pIsSpecCu As Boolean, Optional ByRef pSpecCUName As String, Optional ByRef pSpecMemo As String, _
                      Optional ByRef pIsCuMemo As Boolean, Optional ByRef pCuMemoName As String, Optional ByRef pCuMemo As String, _
                      Optional ByVal pIndex As Integer = 0)
   
   pIsSpecCu = False 'Add By Sindy 2012/12/12 預設變數值
   For iiiii = IIf(pIndex = 0, 1, pIndex) To IIf(pIndex = 0, 5, pIndex)
       'edit by nickc 2008/01/18 加入客戶業務備註
       'Modified by Lydia 2022/10/26 固定用CU02=0判斷業務備註; ex.P-124312 目前客戶編號為X70604001
       'strSql = "select cu01,cu02,cu121,nvl(cu04,nvl(cu05||cu88||cu89||cu90,cu06)) cu04,cl04,cu125 from customer, (select * from custspeciallog  where (cl01,cl02,cl03) in (select cl01,cl02,max(cl03) from custspeciallog where cl01='" & Me.Text1(12 + (iiiii - 1) * 16).Text & "' " & _
                      " and cl02 in (select max(cl02) from custspeciallog where cl01='" & Me.Text1(12 + (iiiii - 1) * 16).Text & "' ) group by cl01,cl02)) Ncl " & _
                      " Where CU01='" & Mid(Me.Text1(12 + (iiiii - 1) * 16).Text, 1, 8) & "' And CU02='" & Mid(Me.Text1(12 + (iiiii - 1) * 16).Text, 9, 1) & "' and cu01||cu02=Ncl.cl01(+) "
       strSql = "select cu01,cu02,cu121,nvl(cu04,nvl(cu05||cu88||cu89||cu90,cu06)) cu04,cl04,cu125 from customer, (select * from custspeciallog  where (cl01,cl02,cl03) in (select cl01,cl02,max(cl03) from custspeciallog where cl01='" & Left(Me.Text1(12 + (iiiii - 1) * 16).Text, 8) & "0" & "' " & _
                      " and cl02 in (select max(cl02) from custspeciallog where cl01='" & Left(Me.Text1(12 + (iiiii - 1) * 16).Text, 8) & "0" & "' ) group by cl01,cl02)) Ncl " & _
                      " Where CU01='" & Mid(Me.Text1(12 + (iiiii - 1) * 16).Text, 1, 8) & "' And CU02='0' and cu01||cu02=Ncl.cl01(+) "
       
       'Added by Morgan 2024/4/10 目前客戶編號為舊名稱時，業務備註也要帶出 Ex:P-116009 ( 特殊客戶備註只需抓更名後的--秀玲 )
       If Mid(Me.Text1(12 + (iiiii - 1) * 16).Text, 9, 1) <> "0" Then
         strSql = strSql & " union select cu01,cu02,cu121,nvl(cu04,nvl(cu05||cu88||cu89||cu90,cu06)) cu04,'' cl04,cu125 from customer" & _
            " Where CU01='" & Mid(Me.Text1(12 + (iiiii - 1) * 16).Text, 1, 8) & "' And CU02='" & Mid(Me.Text1(12 + (iiiii - 1) * 16).Text, 9, 1) & "'"
         strSql = "select * from (" & strSql & ") where (cu121='Y' or cu125 is not null) order by cu02 desc"
       End If
       'end 2024/4/10
       CheckOC3
       AdoRecordSet3.CursorLocation = adUseClient
       AdoRecordSet3.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
       If AdoRecordSet3.RecordCount <> 0 Then
         Do While Not AdoRecordSet3.EOF 'Added by Morgan 2024/4/10
         
           If CheckStr(AdoRecordSet3.Fields("cu121")) = "Y" Then
               pIsSpecCu = True
               pSpecCUName = pSpecCUName & CheckStr(AdoRecordSet3.Fields("cu04")) & "==>" & CheckStr(AdoRecordSet3.Fields("cl04")) & vbCrLf
               If pSpecMemo = "" Then    '秀玲說只要記錄第一筆
                   pSpecMemo = CheckStr(AdoRecordSet3.Fields("cl04"))
               End If
           End If
           'add by nickc 2008/01/18 加入客戶業務備註
           If CheckStr(AdoRecordSet3.Fields("cu125")) <> "" Then
               pIsCuMemo = True
               
               'Added by Morgan 2024/4/10 若非目前申請人的編號時加上客戶編號
               If AdoRecordSet3.Fields("cu02") = "0" And Mid(Me.Text1(12 + (iiiii - 1) * 16).Text, 9, 1) <> "0" Then
                  pCuMemoName = pCuMemoName & CheckStr(AdoRecordSet3.Fields("cu04")) & "==>" & CheckStr(AdoRecordSet3.Fields("cu125")) & "(此為" & AdoRecordSet3.Fields("cu01") & AdoRecordSet3.Fields("cu02") & "的業務備註)" & vbCrLf
                  pCuMemo = pCuMemo & "申請人" & iiiii & "：" & CheckStr(AdoRecordSet3.Fields("cu125")) & "(此為" & AdoRecordSet3.Fields("cu01") & AdoRecordSet3.Fields("cu02") & "的業務備註)" & "@;@"
               Else
               'end 2024/4/10
                  
                  pCuMemoName = pCuMemoName & CheckStr(AdoRecordSet3.Fields("cu04")) & "==>" & CheckStr(AdoRecordSet3.Fields("cu125")) & vbCrLf
                  'Modify by Amy 2016/03/14 申請人1~5有業務備註都要顯示
                  'If pCuMemo = "" Then   '記錄第一筆
                      'Modify by Amy 2016/08/15 顯示於Text1(119),但列印於最後
                      pCuMemo = pCuMemo & "申請人" & iiiii & "：" & CheckStr(AdoRecordSet3.Fields("cu125")) & "@;@"
                      'end 2024/4/10
                  'End If
               End If 'Added by Morgan 2024/4/10
           End If
           
         'Added by Morgan 2024/4/10
           AdoRecordSet3.MoveNext
         Loop
         'end 2024/4/10
       End If
   Next iiiii
   If pCuMemo <> MsgText(601) Then pCuMemo = Left(pCuMemo, Len(pCuMemo) - 3) 'Modify by Amy 2016/08/15
End Sub

'Modify By Sindy 2022/9/15 要改存CRL70系統加註
'Add by Morgan 2011/1/14
'從 PrintDetail 抽出,寫成模組以便存檔用(列印第二份時也可不必重抓資料)
Private Function GetCRL57() As String
   Dim DetailCase As String
   Dim strCaseNo As String, strCaseID As String 'Add By Sindy 2014/7/7
   Dim ii As Integer 'Add By Sindy 2015/8/27
   
   m_strCaseCPM = GetAllCaseCPM(, , , , , m_dblTotRvFee) 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   'Modify By Sindy 2023/5/9 法務還是列印紙本,因此在說明處理事項裡還是要表態此狀況
   'Modify By Sindy 2022/11/18
   If InStr(Text1(6), "L") > 0 Then
   '2022/11/18 END
      'Add By Sindy 2009/08/31
      If Check7(0).Value = 1 Or Check7(1).Value = 1 Then
         'Modify by Amy 2016/09/19 本所客戶不是對造才換行-秀玲
         m_Msgbox = "對造是否為本所客戶：" & IIf(Check7(0).Value = 1, "■", "□") & "是  " & IIf(Check7(1).Value = 1, "■", "□") & "否" '& vbCrLf
                    'IIf(Check7(1).Value = 1, vbCrLf, "　")
'         'Add by Amy 2016/09/01 本所客戶為對造時,印「對造為本所客戶陳報資料 」,但不寫入CRL57
'         If Check7(0).Value = 1 Then
'            If m_stCRL134 <> MsgText(601) Then m_Msgbox = m_Msgbox & "已向 " & m_stCRL134 & " 陳報可辦理" & vbCrLf
'            If m_stCRL135 <> MsgText(601) Then m_Msgbox = m_Msgbox & "原因：" & m_stCRL135 & vbCrLf
'            'end 2016/09/01
'         End If
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
      '2009/08/31 End
   End If
   
   'Added by Morgan 2020/6/1
   If strTTSaveFiles <> "" Then
      m_Msgbox = "★案源有客戶文件"
      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
      End If
   End If
   
   'Add By Sindy 2010/4/15
   If m_Note1 <> "" Then '延緩公告 'Added by Morgan 2020/12/22 + IDS相關案號
      If InStr(txtCRL70.Text, m_Note1) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Note1 & vbCrLf
      End If
   End If
   If m_Note2 <> "" Then '繳費年度,延期案件性質
      If InStr(txtCRL70.Text, m_Note2) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Note2 & vbCrLf
      End If
   End If
   '2010/4/15 End
   
   DetailCase = ""
   'Added by Morgan 2013/4/26
   If IsoptCP81 = True Then
      '新客戶有設定減免狀態或舊客戶有變更減免狀態
      'Modified by Morgan 2019/4/15 +判斷日本案
      If optCP811(0).Value Or optCP811(1).Value Then
         If Option31(0).Value = True Or ((optCP811(0).Value = True And arrAD1516(1, 0) <> "Y") Or (optCP811(1).Value = True And arrAD1516(1, 0) <> "N")) Then
            DetailCase = DetailCase & "申請人1(" & Text1(21) & ")符合" & IIf(stCountry = "011", "減免資格：", "年費減免：") & IIf(optCP811(0).Value, "是", "否") & vbCrLf
         End If
      End If
      If optCP812(0).Value Or optCP812(1).Value Then
         If Option32(0).Value = True Or ((optCP812(0).Value = True And arrAD1516(2, 0) <> "Y") Or (optCP812(1).Value = True And arrAD1516(2, 0) <> "N")) Then
            DetailCase = DetailCase & "申請人2(" & Text1(37) & ")符合" & IIf(stCountry = "011", "減免資格：", "年費減免：") & IIf(optCP812(0).Value, "是", "否") & vbCrLf
         End If
      End If
      If optCP813(0).Value Or optCP813(1).Value Then
         If Option33(0).Value = True Or ((optCP813(0).Value = True And arrAD1516(3, 0) <> "Y") Or (optCP813(1).Value = True And arrAD1516(3, 0) <> "N")) Then
            DetailCase = DetailCase & "申請人3(" & Text1(53) & ")符合" & IIf(stCountry = "011", "減免資格：", "年費減免：") & IIf(optCP813(0).Value, "是", "否") & vbCrLf
         End If
      End If
      If optCP814(0).Value Or optCP814(1).Value Then
         If Option34(0).Value = True Or ((optCP814(0).Value = True And arrAD1516(4, 0) <> "Y") Or (optCP814(1).Value = True And arrAD1516(4, 0) <> "N")) Then
            DetailCase = DetailCase & "申請人4(" & Text1(69) & ")符合" & IIf(stCountry = "011", "減免資格：", "年費減免：") & IIf(optCP814(0).Value, "是", "否") & vbCrLf
         End If
      End If
      If optCP815(0).Value Or optCP815(1).Value Then
         If Option35(0).Value = True Or ((optCP815(0).Value = True And arrAD1516(5, 0) <> "Y") Or (optCP815(1).Value = True And arrAD1516(5, 0) <> "N")) Then
            DetailCase = DetailCase & "申請人5(" & Text1(85) & ")符合" & IIf(stCountry = "011", "減免資格：", "年費減免：") & IIf(optCP815(0).Value, "是", "否") & vbCrLf
         End If
      End If
   End If
   'end 2013/4/26
   'Added by Morgan 2013/4/9
   For intI = 1 To 5
      If IsoptCP81 = True Then 'Added by Morgan 2019/4/19
         If (intI = 1 And optCP811(0).Value = True) Or (intI = 2 And optCP812(0).Value = True) Or (intI = 3 And optCP813(0).Value = True) Or (intI = 4 And optCP814(0).Value = True) Or (intI = 5 And optCP815(0).Value = True) Then
            If arrAD1516(intI, 1) <> "" Then
               DetailCase = DetailCase & "申請人" & intI & "(" & Text1(5 + intI * 16) & ")減免資格如下："
               'Added by Morgan 2019/4/12
               '日本案減免身分或資格變更加註
               If stCountry = "011" Then
                  If (arrAD1516(intI, 3) <> arrAD1516(intI, 5) Or arrAD1516(intI, 1) <> arrAD1516(intI, 6)) Then
                     DetailCase = DetailCase & "(減免身分或資格有變)"
                  End If
               End If
               'End 2019/4/15
               DetailCase = DetailCase & vbCrLf
               'Added by Morgan 2019/4/12
               If stCountry = "011" Then
                  DetailCase = DetailCase & "　■" & PUB_GetJpDiscountDesc(arrAD1516(intI, 3), arrAD1516(intI, 1)) & vbCrLf
               Else
               'end 2019/4/12
                  Select Case arrAD1516(intI, 1)
                     Case "1"
                        DetailCase = DetailCase & "　■製造業、營造業、礦業及土石採取業實收資本額八千萬以下：" & arrAD1516(intI, 2) & "元" & vbCrLf
                     Case "2"
                        DetailCase = DetailCase & "　□製造業、營造業、礦業及土石採取業實收資本額八千萬以下：         元" & vbCrLf
                        DetailCase = DetailCase & "　■前項除外之其他行業前一年營業額一億元以下：" & arrAD1516(intI, 2) & "元" & vbCrLf
                     Case "3"
                        DetailCase = DetailCase & "　■我國製造業、營造業、礦業及土石採取業實收資本額新台幣八千萬以上但經常僱用員工數未滿200人：員工數" & arrAD1516(intI, 2) & "人" & vbCrLf
                     Case "4"
                        DetailCase = DetailCase & "　□我國製造業、營造業、礦業及土石採取業實收資本額新台幣八千萬以上但經常僱用員工數未滿200人：員工數          人" & vbCrLf
                        DetailCase = DetailCase & "　■我國前項除外之其他行業前一年營業額一億元以上者但經常僱用員工數未滿100人：員工數" & arrAD1516(intI, 2) & "人" & vbCrLf
                        
                     'Added by Morgan 2020/7/24
                     Case "5"
                        DetailCase = DetailCase & "　■依法辦理公司登記或商業登記，實收資本額在新臺幣1億元以下：" & arrAD1516(intI, 2) & "元" & vbCrLf
                     Case "6"
                        DetailCase = DetailCase & "　■經常僱用員工數未滿200人之事業：員工數" & arrAD1516(intI, 2) & "人" & vbCrLf
                     'end 2020/7/24
                  End Select
               End If
            End If
         End If
      End If
      'Add by Amy 2016/12/23 若舊案案件中文地址為空,但客戶檔中文地址有值則印訊息 (ex:CFT-011315 96/5/22建客戶資料時未輸中文地址,98//7/6才補,補前已案件資料已寫入,導致補後一直抓不到)
      'Modify By Sindy 2022/12/23 修bug: And Trim(Me.Text1(12 + (16 * (i - 1))).Text) <> "" : 判斷有客戶編號才檢查(3人改2人申請時會錯)
      If bolCusCAddr(intI) = True And Trim(Me.Text1(12 + (16 * (intI - 1))).Text) <> "" Then
         DetailCase = DetailCase & "申請人" & intI & "案件無中文地址但客戶檔有，請通知專業部補輸「案件中文地址」" & vbCrLf
      End If
   Next
   'end 2013/4/9
   
   'Added by Lydia 2023/11/13 DEBIT NOTE請款選項
   If Frame33(1).Visible = True And Option2(2).Value = True Then
      If optDB(0).Value = True Then
         DetailCase = DetailCase & "★DEBIT NOTE請款選項：" & optDB(0).Caption & vbCrLf
      Else
         If Check7(2).Value = 1 Then
            DetailCase = DetailCase & "★DEBIT NOTE請款選項：待通知後開立，要加印國內收據" & vbCrLf
         ElseIf Check7(3).Value = 1 Then
            DetailCase = DetailCase & "★DEBIT NOTE請款選項：待通知後開立，不需要加印國內收據" & vbCrLf
         End If
      End If
   End If
   'end 2023/11/13
   
   If DetailCase <> "" Then
      If InStr(txtCRL70.Text, DetailCase) = 0 Then
         txtCRL70.Text = txtCRL70.Text & DetailCase & vbCrLf
      End If
   End If
   
   'Added by Morgan 2012/11/23
   If m_strLiveProofMemo <> "" Then '本案由客戶提供存活證明
      If InStr(txtCRL70.Text, m_strLiveProofMemo) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_strLiveProofMemo & vbCrLf
      End If
   End If
   'end 2012/11/23
   
   'Add By Sindy 2011/1/24 檢查相同國家若有舊案申請地址與客戶目前申請地址不同時，提醒操作人員
   If m_ChkOCaseAndCAddrNotAlike = True Then
      If m_AppAddrChange = True Then
         If m_CaseAndCAddrNotAlikePrint = True Then
            m_Msgbox = "有舊案件與客戶目前申請地址不同，舊案請參Mail附件"
         Else
            m_Msgbox = "有舊案件與客戶目前申請地址不同！"
         End If
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      Else
         m_Msgbox = "有舊案件與客戶目前申請地址不同，舊案請參Mail附件"
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
   End If
   '2011/1/24 End
     
   'Add By Sindy 2014/2/19
   If strTawT102MClassFee = "Y" Then
      m_Msgbox = "★★並非所有類別都要延展"
      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
      End If
   End If
   '2014/2/19 END
   
   'Add By Sindy 2014/7/7 若有總委任書顯示訊息
   If (Text1(6) = "P" Or Text1(6) = "FCP") And _
      Left(Trim(Combo1(0)), 3) = "000" And _
      Option1(0).Value = True Then
      
      If PUB_ChkPA165IsY(Text1(12), strCaseNo, strCaseID) = True Then
         m_Msgbox = "申請人1" & Text1(12) & "的總委任書正本已存於：" & IIf(Right(strCaseNo, 5) = "-0-00", Left(strCaseNo, Len(strCaseNo) - 5), strCaseNo) & "(申請案號：" & strCaseID & ")"
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
      If PUB_ChkPA165IsY(Text1(28), strCaseNo, strCaseID) = True Then
         m_Msgbox = "申請人2" & Text1(28) & "的總委任書正本已存於：" & IIf(Right(strCaseNo, 5) = "-0-00", Left(strCaseNo, Len(strCaseNo) - 5), strCaseNo) & "(申請案號：" & strCaseID & ")"
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
      If PUB_ChkPA165IsY(Text1(44), strCaseNo, strCaseID) = True Then
         m_Msgbox = "申請人3" & Text1(44) & "的總委任書正本已存於：" & IIf(Right(strCaseNo, 5) = "-0-00", Left(strCaseNo, Len(strCaseNo) - 5), strCaseNo) & "(申請案號：" & strCaseID & ")"
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
      If PUB_ChkPA165IsY(Text1(60), strCaseNo, strCaseID) = True Then
         m_Msgbox = "申請人4" & Text1(60) & "的總委任書正本已存於：" & IIf(Right(strCaseNo, 5) = "-0-00", Left(strCaseNo, Len(strCaseNo) - 5), strCaseNo) & "(申請案號：" & strCaseID & ")"
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
      If PUB_ChkPA165IsY(Text1(76), strCaseNo, strCaseID) = True Then
         m_Msgbox = "申請人5" & Text1(76) & "的總委任書正本已存於：" & IIf(Right(strCaseNo, 5) = "-0-00", Left(strCaseNo, Len(strCaseNo) - 5), strCaseNo) & "(申請案號：" & strCaseID & ")"
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
   End If
   '2014/7/7 END
   
   'Add By Sindy 2014/5/9 若申請人1的前6碼為X44551 或 X62079 或 X60149 或 X43988 或 X63219 或 X60498 或 X62319 或 X62702 或 X63838,
   '且申請國家為美國101,四個案件性質中只要有一個是606維持費的,請加接洽單上加印:---此客戶憑水單及代理人帳單請款,維持費請代理人勿上網繳！
   'modify by sonia 2017/4/27 X60149改不含關係企業,另婉莘於4/10要求加X69534彩豐精技,4/14雅娟要求X69011010
   'modify by sonia 2017/5/15陳德發及郭雅娟要求取消X69534彩豐精技
   'modify by sonia 2017/10/11 張詠翔要求取消X6014900
   'modify by sonia 2017/10/26 郭雅娟要求加X60738010國立清華大學
   'modify by sonia 2021/3/17 顧服組黃教威加5編號X69365010(長庚醫療財團法人嘉義長庚紀念醫院),X54243070(國立台灣大學),X80847020(財團法人國家實驗研究院),X83983000(盧彥蓓),X83984000(林致廷)
   'Modify By Sindy 2024/8/8 +協助接洽單中訊息區設定,載明憑水單及代理人帳單請款-客戶編號 X87287000、X87287010
   If Text1(6) = "CFP" And _
      (Left(Trim(Text1(12)), 6) = "X44551" Or Left(Trim(Text1(12)), 6) = "X62079" Or _
       Left(Trim(Text1(12)), 6) = "X43988" Or _
       Left(Trim(Text1(12)), 6) = "X63219" Or Left(Trim(Text1(12)), 6) = "X60498" Or _
       Left(Trim(Text1(12)), 6) = "X62319" Or Left(Trim(Text1(12)), 6) = "X62702" Or _
       Left(Trim(Text1(12)), 6) = "X63838" Or Left(Trim(Text1(12)), 8) = "X6901101" Or Left(Trim(Text1(12)), 8) = "X6073801" Or _
       Left(Trim(Text1(12)), 8) = "X6936501" Or Left(Trim(Text1(12)), 8) = "X5424307" Or Left(Trim(Text1(12)), 8) = "X8084702" Or Left(Trim(Text1(12)), 8) = "X8398300" Or Left(Trim(Text1(12)), 8) = "X8398400" Or _
       Left(Trim(Text1(12)), 8) = "X8728700" Or Left(Trim(Text1(12)), 8) = "X8728701") And _
      Left(Combo1(0), 3) = "101" And (InStr(m_strCaseCPM, "606") > 0) Then
      m_Msgbox = "---此客戶憑水單及代理人帳單請款,維持費請代理人勿上網繳！"
      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
      End If
   End If
   '2014/5/9 End
   'Add By Sindy 2024/5/29 下列客戶之 P 非台灣案及 CFP 案規費及代理人費用皆憑代理人帳單及匯款水單請款。
   '                       煩請協助於接洽單說明處理事項之訊息區自動帶入"此客戶憑水單及代理人帳單請款"
   'X69365110 長庚醫療財團法人台北長庚紀念醫院
   'X69365010 長庚醫療財團法人嘉義長庚紀念醫院
   'X69365080 長庚醫療財團法人基隆長庚紀念醫院
   'X69365090 長庚醫療財團法人林口長庚紀念醫院
   'X69365070 長庚醫療財團法人高雄長庚紀念醫院
   'X69365020 長庚大學
   'X38805030 財團法人資訊工業策進會
   'X82532010 力成科技股份有限公司
   'X82504030/ X82504040 欣銓科技股份有限公司
   'Modify By Sindy 2024/8/8 +協助接洽單中訊息區設定,載明憑水單及代理人帳單請款-客戶編號 X87287000、X87287010
   If ((Text1(6) = "P" And Left(Combo1(0), 3) <> "000") Or Text1(6) = "CFP") And _
      (Left(Trim(Text1(12)), 8) = "X6936511" Or Left(Trim(Text1(12)), 8) = "X6936501" Or _
       Left(Trim(Text1(12)), 8) = "X6936508" Or Left(Trim(Text1(12)), 8) = "X6936509" Or _
       Left(Trim(Text1(12)), 8) = "X6936507" Or Left(Trim(Text1(12)), 8) = "X6936502" Or _
       Left(Trim(Text1(12)), 8) = "X3880503" Or Left(Trim(Text1(12)), 8) = "X8253201" Or _
       Left(Trim(Text1(12)), 8) = "X8250403" Or Left(Trim(Text1(12)), 8) = "X8250404" Or _
       Left(Trim(Text1(12)), 8) = "X8728700" Or Left(Trim(Text1(12)), 8) = "X8728701") Then
      m_Msgbox = "---此客戶憑水單及代理人帳單請款！"
      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
      End If
   End If
   '2024/5/29 End
   
   'Add By Sindy 2014/8/26
   If Trim(Combo4) = "智權公司" And Text1(6) = "CFP" Then
      '401.變更 701.讓與 703.繼承 914.文件公簽證
      If InStr(m_strCaseCPM, "401") > 0 Or _
         InStr(m_strCaseCPM, "701") > 0 Or _
         InStr(m_strCaseCPM, "703") > 0 Or _
         InStr(m_strCaseCPM, "914") > 0 Then
         m_Msgbox = "文件須辦理公簽證時，請程序特別提醒總務人員為台一智權公司案件。"
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
   End If
   '2014/8/26 END
   
   'Added by Lydia 2019/01/30 大至台案件列印代理人D/N備註
   If OptChoose(1).Value = True And Text1(5).Text <> "" Then
      If Left(Text1(6), 1) = "T" And m_FA110 <> "" Then '商標D/N備註
         m_Msgbox = "代理人D/N備註：" & m_FA110
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      ElseIf m_FA45 <> "" Then ''專利D/N備註
         m_Msgbox = "代理人D/N備註：" & m_FA45
         If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
            txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
         End If
      End If
   End If
   'end 2019/01/30
   
   'Added by Lydia 2021/05/07 ACS智財顧問專業分配比例管制：各專業部門、服務次數、工作時數小計、未發文次數
   If m_ACS112msg <> "" Then
      If InStr(txtCRL70.Text, m_ACS112msg) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_ACS112msg & vbCrLf
      End If
   End If
   'end 2021/05/07
   
   'Added by Lydia 2021/04/15 增加下一程序之備註
   If strGetNp15 <> "" Then
      If InStr(txtCRL70.Text, strGetNp15) = 0 Then
         txtCRL70.Text = txtCRL70.Text & strGetNp15 & vbCrLf
      End If
   End If
   'end 2021/04/15
   
   'Added by Lydia 2021/04/16 接洽單CFP加拿大收答辯案(107)彈提醒並印在接洽單上！
   If Text1(6) = "CFP" And Trim(Left(Combo1(0), 4)) = "102" And (InStr(m_strCaseCPM, "107") > 0) Then
      m_Msgbox = "加拿大專利申請案之延期須備具正當理由，一旦專利局認為不符延期規定，本案將被視為放棄，請務必於期限前及時提出答辯。"
      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
      End If
   End If
   'end 2021/04/16
   
   'Added by Lydia 2021/04/16 3.  P124508、P124568兩件舉發答辯案,後續至行政訴訟程序503,收文請於接洽單上註明「本案之行政訴訟程序不能由台一法律所律師涉入。」
   If Text1(6) = "P" And (Text1(7) = "124508" Or Text1(7) = "124568") And (InStr(m_strCaseCPM, "503") > 0) Then
      m_Msgbox = "本案之行政訴訟程序不能由台一法律所律師涉入。"
      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
      End If
   End If
   'end 2021/04/16
   
   'Modify By Sindy 2014/8/6
   If Is308Child = True And Not (Is308New = True And Trim(Left(Combo1(0).Text, 4)) = "020" And Text1(6) = "T") Then
      m_Msgbox = "母案案號：" & IIf(Option1(1).Value = True, Text1(6).Text & "-" & Text1(7).Text & "-" & Text1(8).Text & "-" & Text1(9).Text, Text1(6).Text & "-")
      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
      End If
   End If
   '2014/8/6 END
   
   'Add by Amy 2021/11/29 新客戶為國內同業顯示事項
   If strSameTrade <> MsgText(601) Then
      m_Msgbox = "新客戶事項：" & strSameTrade
      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
      End If
   End If
   
   'Add by Amy 2024/01/17 風險檢查對象
   If strSrvDate(1) >= 風險警示啟用日 And bolSendRiskChkMail = True Then
      m_RiskMsg = "名稱存在於[風險檢查對象名單]：" & vbCrLf & m_RiskMsg & vbCrLf
      txtCRL70.Text = txtCRL70.Text & vbCrLf & m_RiskMsg
   End If

   'Added by Lydia 2020/08/21 直接放入案件說明事項的計算-業務備註放在最後面
   If IsCuMemo And CuMemo <> "" Then
      m_Msgbox = "業務備註：" & CuMemo
      If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
         txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
      End If
   End If
   'end 2020/08/21
End Function

'Add By Sindy 2011/1/24
Sub GetPleft()
PLeft(1) = 400 '500
'PLeft(2) = 1700
'PLeft(3) = 4500
PLeft(4) = 400 '500
PLeft(5) = 2400 '2300
End Sub

'Add By Sindy 2011/1/24 列印有舊案件與客戶目前申請地址不同的資料
Sub PrintAddrNotAlike()
Dim i As Integer
Dim strType As String, strType2 As String
Dim TempFileName As String

rsAddrNotAlike.MoveFirst
If Not rsAddrNotAlike.EOF And Not rsAddrNotAlike.BOF Then
   With rsAddrNotAlike
      TempFileName = App.path & "\$$有舊案件與客戶目前申請地址不同.txt"
      If Dir(TempFileName) <> "" Then Kill TempFileName
      
      'Modify By Sindy 2023/5/30
'      ff1 = FreeFile
'      Open TempFileName For Output As ff1
'      Print #ff1, "有舊案件與客戶目前申請地址不同："
'      Print #ff1, ""
      strAddrText = "有舊案件與客戶目前申請地址不同：" & vbCrLf & vbCrLf
      '2023/5/30 END
      
      .MoveFirst
      
      iLine = 1
      strType = "": strType2 = ""
      
'      'Added by Morgan 2022/3/4
'      pub_OsPrinter = PUB_GetOsDefaultPrinter
'      PUB_SetOsDefaultPrinter cboPrinter
'      PUB_SetWordActivePrinter
'      StartOfficeAp
'      'end 2022/3/4
      
      Do While Not .EOF
         strTemp(1) = Trim(.Fields("id"))
         strTemp(2) = "" & Trim(.Fields("cname"))
         strTemp(3) = "" & Trim(.Fields("caddr"))
         strTemp(4) = .Fields(0) & "-" & .Fields(1) & "-" & .Fields(2) & "-" & .Fields(3)
         If strType2 = strTemp(4) Then strTemp(4) = ""
         strTemp(5) = "" & Trim(.Fields("caseAddr"))
         strTemp(6) = "" & Trim(.Fields("ename"))
         strTemp(7) = "" & Trim(.Fields("jname"))
         strTemp(8) = "" & Trim(.Fields("eaddr"))
         strTemp(9) = "" & Trim(.Fields("jaddr"))
         
         If strType <> .Fields("id") Then
            If strType <> "" Then
               'Modify By Sindy 2023/5/30
'               Print #ff1, ""
'               Print #ff1, ""
               strAddrText = strAddrText & vbCrLf & vbCrLf
               '2023/5/30 END
            End If
            PrintTitle
         End If
         'Modify By Sindy 2023/5/30
'         Print #ff1, convForm(strTemp(4), 15) & " " & strTemp(5)
         strAddrText = strAddrText & convForm(strTemp(4), 15) & " " & strTemp(5) & vbCrLf
         '2023/5/30 END
         
'         If iLine > 52 Or iLine = 1 Or _
'            strType <> .Fields("id") Then
'            If strType <> "" Then
'               'Modified by Morgan 2022/3/1 改用Word列印
'               'Printer.NewPage
'               g_WordAp.Selection.InsertBreak Type:=wdPageBreak '跳頁
'            End If
'            iLine = 1
'            PrintTitle
'         End If
'
'         'Modified by Morgan 2022/3/1 改用Word列印
'         'For i = 4 To 5
'         '   Printer.CurrentX = PLeft(i)
'         '   Printer.CurrentY = iLine * 300
'         '   Printer.Print strTemp(i)
'         'Next i
'         With g_WordAp
'         .Selection.TypeParagraph
'         .Selection.TypeText strTemp(4) & vbTab & strTemp(5)
'         End With
'         'end 2022/3/1
'
'         iLine = iLine + 1
         strType = .Fields("id")
         strType2 = .Fields(0) & "-" & .Fields(1) & "-" & .Fields(2) & "-" & .Fields(3)
         .MoveNext
      Loop
   End With
'   'Modified by Morgan 2022/3/4
'   'Printer.EndDoc
'   g_WordAp.PrintOut Background:=False, Copies:=1, Collate:=True
'   g_WordAp.ActiveDocument.Close wdDoNotSaveChanges
'   If g_WordAp.Documents.Count = 0 Then
'      g_WordAp.Quit wdDoNotSaveChanges
'      Set g_WordAp = Nothing
'   End If
'   PUB_SetOsDefaultPrinter pub_OsPrinter
'   'end 2022/3/4
   'Modify By Sindy 2023/5/30
'   Close ff1
   If strAddrText <> "" Then
      Call PUB_SaveTextAsUTF8(TempFileName, strAddrText)
      PUB_SendMail strUserNum, Text1(10), "", "有舊案件與客戶目前申請地址不同，請確認！若不需變更舊案件地址則請忽略此信件", "同主旨", , TempFileName
   End If
   '2023/5/30 END
End If
End Sub

'Add By Sindy 2011/1/24
Sub PrintTitle()
   Dim strName As String, strAddr As String
   
   strName = ""
   If strTemp(2) <> "" Then strName = strTemp(2)
   If strTemp(6) <> "" Then
      If strName <> "" Then strName = strName & "／"
      strName = strName & strTemp(6)
   End If
   If strTemp(7) <> "" Then
      If strName <> "" Then strName = strName & "／"
      strName = strName & strTemp(7)
   End If
   
   strAddr = ""
   If strTemp(3) <> "" Then strAddr = strTemp(3)
   If strTemp(8) <> "" Then
      If strAddr <> "" Then
         'Modified by Morgan 2022/3/1
         'strAddr = strAddr & vbCrLf & "　　　　　　　　"
         strAddr = strAddr & vbCrLf & "　　　　　　"
         'end 2022/3/1
      End If
      strAddr = strAddr & strTemp(8)
   End If
   If strTemp(9) <> "" Then
      If strAddr <> "" Then
         'Modified by Morgan 2022/3/1
         'strAddr = strAddr & vbCrLf & "　　　　　　　　"
         strAddr = strAddr & vbCrLf & "　　　　　　"
         'end 2022/3/1
      End If
      strAddr = strAddr & strTemp(9)
   End If
   'Modify By Sindy 2023/5/30
'   Print #ff1, "申　請　人：" & strTemp(1) & "　" & strName
'   Print #ff1, "申請人地址：" & strAddr
'   Print #ff1, ""
'   Print #ff1, "本所案號        案件申請地址"
'   Print #ff1, "=============== ============================================================"
   strAddrText = strAddrText & "申　請　人：" & strTemp(1) & "　" & strName & vbCrLf
   strAddrText = strAddrText & "申請人地址：" & strAddr & vbCrLf & vbCrLf
   strAddrText = strAddrText & "本所案號        案件申請地址" & vbCrLf
   strAddrText = strAddrText & "=============== ============================================================" & vbCrLf
   '2023/5/30 END
   
   Exit Sub
   
'Modified by Morgan 2022/3/1
'   Call GetPleft
'
'   Printer.Font.Size = 12
'   Printer.Font.Underline = False
'   Printer.FontBold = False
'
'   Printer.CurrentX = PLeft(1)
'   Printer.CurrentY = iLine * 300
'   Printer.Print "有舊案件與客戶目前申請地址不同：" & "（第 " & Printer.Page & " 頁）"
'
'   iLine = iLine + 2
'
'   Printer.CurrentX = PLeft(1)
'   Printer.CurrentY = iLine * 300
'
'   Printer.Print "申　請　人：" & strTemp(1) & "　" & strName
'   iLine = iLine + 1
'
'   Printer.CurrentX = PLeft(1)
'   Printer.CurrentY = iLine * 300
'   Printer.Print "申請人地址：" & strAddr
'   iLine = iLine + 2
'
'   '標題
'   Printer.CurrentX = PLeft(4)
'   Printer.CurrentY = iLine * 300
'   Printer.Print "本所案號"
'   Printer.CurrentX = PLeft(5)
'   Printer.CurrentY = iLine * 300
'   Printer.Print "案件申請地址"
'
'   iLine = iLine + 1
'
'   Printer.CurrentX = PLeft(1)
'   Printer.CurrentY = iLine * 300
'   Printer.Print String(92, "-")
'
'   iLine = iLine + 1
   With g_WordAp
   '.Visible = True
   .Selection.PageSetup.LeftMargin = .CentimetersToPoints(1)
   .Selection.PageSetup.RightMargin = .CentimetersToPoints(1)
   .Selection.Font.Size = 12
   .Selection.Font.Underline = False
   .Selection.Font.Bold = False
   .Selection.Font.Name = "標楷體"
   .Selection.TypeText "有舊案件與客戶目前申請地址不同：" & "（第 "
   .Selection.Fields.add Range:=.Selection.Range, Type:=wdFieldPage
   .Selection.TypeText " 頁）"
   .Selection.TypeParagraph
   .Selection.TypeParagraph
   .Selection.TypeText "申　請　人：" & strTemp(1) & "　" & strName
   .Selection.TypeParagraph
   .Selection.TypeText "申請人地址：" & strAddr
   .Selection.TypeParagraph
   .Selection.TypeParagraph
   .Selection.TypeText "本所案號　　" & vbTab & "案件申請地址"
   .Selection.TypeParagraph
   .Selection.TypeText String(88, "-")
   End With
   iLine = iLine + 7
'end 2022/3/1
End Sub

'2011/10/19 add by sonia 舊案檢查申請地址與客戶中文地址是否相同,若不同則提醒
Private Sub CheckCustAddr(ByVal strCaseAddr As String, ByVal strCustNo As String, ByVal strI As String)
   If strCustNo <> "" Then
      strExc(0) = "select cu23 from customer where cu01='" & Mid(strCustNo, 1, 8) & "' and cu02='" & Mid(strCustNo, 9, 1) & "'"
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 1 Then
         If RTrim(strCaseAddr) <> "" & RTrim(RsTemp.Fields(0)) Then
            ShowMsg "此案件申請人" & Chr(Asc(strI) - 23937) & "的地址(" & RTrim(strCaseAddr) & ")" & vbCrLf & _
                    "　　　與客戶現行地址(" & "" & RTrim(RsTemp.Fields(0)) & ") 不同！" & vbCrLf & _
                    "若要變更地址請於接洽單加註！"
         End If
         'Added by Lydia 2016/12/02 若客戶更名,提醒收據抬頭是否要修改
         If Mid(strCustNo, 9, 1) <> "0" And Mid(strCustNo, 9, 1) <> "" Then
            ShowMsg "此案件申請人" & Chr(Asc(strI) - 23937) & "已更名，請注意收據抬頭是否要修改！"
         End If
         'end 2016/12/02
      End If
   End If
End Sub
'2011/10/19 end

'2011/10/21 add by sonia 專利商標舊案申請地址拆成郵遞區號及地址
Private Sub AddrToZipAddr()
   strZip = ""
   Do While Left(strCAddr, 1) >= "０" And Left(strCAddr, 1) <= "９"
      strZip = strZip & Left(strCAddr, 1)
      strCAddr = Mid(strCAddr, 2)
   Loop
End Sub
'2011/10/21 end

'Added by Morgan 2013/1/15
'檢查舉發聲明
Private Function CheckP803(pFee As Long) As Boolean
   Dim Cancel As Boolean
   Dim lngFee As Long
   Dim strPA08 As String
   Dim strMemo As String
   
   If Combo6 = "" Then
      SSTab1.Tab = 0
      MsgBox "請選擇專利種類", vbExclamation, "舉發聲明"
   End If
   
   strPA08 = Left(Combo6.Text, 1)
   Cancel = True
   For Each oChk In chkItem
      If oChk.Value = vbChecked Then
         If oChk.Index = 0 Then
            If strPA08 = "3" Then
               Exit For
            ElseIf txtItemCount = "" Then
               SSTab1.Tab = 2
               SSTab3.Tab = 1
               MsgBox "請輸入項數", vbExclamation, "舉發聲明"
               If txtItemCount.Enabled Then txtItemCount.SetFocus
               Exit Function
            End If
         ElseIf oChk.Index = 1 Then
            If strPA08 = "3" Then
               Exit For
            ElseIf txtItemList = "第項" Then
               SSTab1.Tab = 2
               SSTab3.Tab = 1
               MsgBox "請輸入項次", vbExclamation, "舉發聲明"
               If txtItemList.Enabled Then txtItemList.SetFocus
               Exit Function
            ElseIf PUB_ChkItemList(txtItemList) = False Then
               SSTab1.Tab = 2
               SSTab3.Tab = 1
               MsgBox "撤銷部分請求項格式錯誤！", vbExclamation, "舉發聲明"
               If txtItemList.Enabled Then txtItemList.SetFocus
               Exit Function
            End If
         ElseIf oChk.Index = 2 Then
            If strPA08 <> "3" Then
               Exit For
            End If
         ElseIf oChk.Index = 6 Then
            For intI = 0 To 1
               If txtYear(intI) = "" Then
                  SSTab1.Tab = 2
                  SSTab3.Tab = 1
                  MsgBox "請輸入年度!", vbExclamation, "舉發聲明"
                  txtYear(intI).SetFocus
                  Exit Function
               End If
               If txtMonth(intI) = "" Then
                  SSTab1.Tab = 2
                  SSTab3.Tab = 1
                  MsgBox "請輸入月份!", vbExclamation, "舉發聲明"
                  txtMonth(intI).SetFocus
                  Exit Function
               End If
               If txtDay(intI) = "" Then
                  SSTab1.Tab = 2
                  SSTab3.Tab = 1
                  MsgBox "請輸入日期!", vbExclamation, "舉發聲明"
                  txtDay(intI).SetFocus
                  Exit Function
               End If
               If Not IsDate((Val(txtYear(intI)) + 1911) & "/" & txtMonth(intI) & "/" & txtDay(intI)) Then
                  SSTab1.Tab = 2
                  SSTab3.Tab = 1
                  MsgBox "日期錯誤，請重新輸入！", vbExclamation, "舉發聲明"
                  txtYear(intI).SetFocus
                  Exit Function
               End If
            Next
            If CDate((Val(txtYear(0)) + 1911) & "/" & txtMonth(0) & "/" & txtDay(0)) > CDate((Val(txtYear(1)) + 1911) & "/" & txtMonth(1) & "/" & txtDay(1)) Then
               SSTab1.Tab = 2
               SSTab3.Tab = 1
               MsgBox "起日不可晚於迄日，請重新輸入！", vbExclamation, "舉發聲明"
               txtYear(0).SetFocus
               Exit Function
            End If
         End If
         
         '請求撤銷發明(新型)專利權 (每件新台幣5,000元，且每一請求項加收新台幣800元)
         If oChk.Index = 0 Then
            lngFee = 5000 + Val(txtItemCount) * 800
            
         ElseIf oChk.Index = 1 Then
            lngFee = 5000 + PUB_GetItemCount(txtItemList) * 800
            
         '請求撤銷自「 年  月  日」至「 年  月  日」之專利權期間延長(每件新台幣10,000元)
         ElseIf oChk.Index = 6 Then
            lngFee = 10000
            
         '請求撤銷全部專利權 (設計專利，每件新台幣8,000元；發明專利，每件新台幣10,000元；新型專利，每件新台幣9,000元)
         Else
            If strPA08 = "1" Then
               lngFee = 10000
            ElseIf strPA08 = "2" Then
               lngFee = 9000
            ElseIf strPA08 = "3" Then
               lngFee = 8000
            End If
         End If
         
         If pFee <> lngFee Then
            SSTab1.Tab = 0
            MsgBox "舉發案收文規費 $" & pFee & " 與系統系統計算金額 $" & lngFee & "不符，請重新檢查！", vbExclamation, "台灣舉發案規費檢查"
            Exit Function
         End If
         
         Cancel = False
         Exit For
      End If
   Next
         
   If Cancel = True Then
      SSTab1.Tab = 2
      SSTab3.Tab = 1
      MsgBox "請選擇發聲明項目！", vbExclamation, "舉發聲明"
      Exit Function
   Else
      CheckP803 = True
   End If
   
End Function


Private Sub txtDay_GotFocus(Index As Integer)
   TextInverse txtDay(Index)
   CloseIme
End Sub

Private Sub txtDay_KeyPress(Index As Integer, KeyAscii As Integer)
   If KeyAscii <> 8 And (KeyAscii > Asc("9") Or KeyAscii < Asc("0")) Then
      KeyAscii = 0
      Beep
   End If
End Sub
Private Sub txtMonth_GotFocus(Index As Integer)
   TextInverse txtMonth(Index)
   CloseIme
End Sub

Private Sub txtMonth_KeyPress(Index As Integer, KeyAscii As Integer)
   If KeyAscii <> 8 And (KeyAscii > Asc("9") Or KeyAscii < Asc("0")) Then
      KeyAscii = 0
      Beep
   End If
End Sub

Private Sub txtYear_GotFocus(Index As Integer)
   TextInverse txtYear(Index)
   CloseIme
End Sub

Private Sub txtYear_KeyPress(Index As Integer, KeyAscii As Integer)
   If KeyAscii <> 8 And Not IsNumeric(Chr(KeyAscii)) Then
      KeyAscii = 0
      Beep
   End If
End Sub

'Modify By Sindy 2022/12/24 Mark,改用SetFrame28
''Added by Morgan 2013/3/19
'Private Sub SetEntity()
'   If Option1(0).Value = True And Text1(6) = "CFP" And Left(Combo1(0), 3) = "101" Then
'      OptEntity(0).Enabled = True
'      OptEntity(1).Enabled = True
'      OptEntity(2).Enabled = True
'   Else
'      OptEntity(0).Value = False
'      OptEntity(0).Enabled = False
'      OptEntity(1).Value = False
'      OptEntity(1).Enabled = False
'      OptEntity(2).Value = False
'      OptEntity(2).Enabled = False
'   End If
'End Sub
'Added by Morgan 2013/4/9
'案件是否可減免改抓畫面上的設定
'Y:符合,N:不符合,empty:未設定
Private Function GetCP81() As String
   If optCP811(0).Value = True _
      And (Trim(Text1(37) & Text1(38)) = "" Or optCP812(0).Value = True) _
      And (Trim(Text1(53) & Text1(54)) = "" Or optCP813(0).Value = True) _
      And (Trim(Text1(69) & Text1(70)) = "" Or optCP814(0).Value = True) _
      And (Trim(Text1(85) & Text1(86)) = "" Or optCP815(0).Value = True) Then
      GetCP81 = "Y"
   ElseIf optCP811(1).Value = True _
      Or (Trim(Text1(37) & Text1(38)) <> "" And optCP812(1).Value = True) _
      Or (Trim(Text1(53) & Text1(54)) <> "" And optCP813(1).Value = True) _
      Or (Trim(Text1(69) & Text1(70)) <> "" And optCP814(1).Value = True) _
      Or (Trim(Text1(85) & Text1(86)) <> "" And optCP815(1).Value = True) Then
      GetCP81 = "N"
   Else
      GetCP81 = Empty
   End If
End Function
'Added by Morgan 2013/4/10
'檢查是否可減免有無變更
Private Function DiscStatusIsChanged() As Boolean
   '舊客戶且減免狀態有變
   
   If (Option31(1).Value = True And ((optCP811(0).Value = True And arrAD1516(1, 0) <> "Y") Or (optCP811(1).Value = True And arrAD1516(1, 0) <> "N"))) _
      Or (Option32(1).Value = True And Text1(28) <> "" And ((optCP812(0).Value = True And arrAD1516(2, 0) <> "Y") Or (optCP812(1).Value = True And arrAD1516(2, 0) <> "N"))) _
      Or (Option33(1).Value = True And Text1(44) <> "" And ((optCP813(0).Value = True And arrAD1516(3, 0) <> "Y") Or (optCP813(1).Value = True And arrAD1516(3, 0) <> "N"))) _
      Or (Option34(1).Value = True And Text1(60) <> "" And ((optCP814(0).Value = True And arrAD1516(4, 0) <> "Y") Or (optCP814(1).Value = True And arrAD1516(4, 0) <> "N"))) _
      Or (Option35(1).Value = True And Text1(76) <> "" And ((optCP815(0).Value = True And arrAD1516(5, 0) <> "Y") Or (optCP815(1).Value = True And arrAD1516(5, 0) <> "N"))) Then
      DiscStatusIsChanged = True
   'Added by Morgan 2019/4/15
   '日本案減免身分或資格變更也算(減免金額可能會不同)
   ElseIf stCountry = "011" And ((Option31(1).Value = True And optCP811(0).Value = True And (arrAD1516(1, 3) <> arrAD1516(1, 5) Or arrAD1516(1, 1) <> arrAD1516(1, 6))) _
      Or (Option32(1).Value = True And Text1(28) <> "" And optCP812(0).Value = True And (arrAD1516(2, 3) <> arrAD1516(2, 5) Or arrAD1516(2, 1) <> arrAD1516(2, 6))) _
      Or (Option33(1).Value = True And Text1(44) <> "" And optCP813(0).Value = True And (arrAD1516(3, 3) <> arrAD1516(3, 5) Or arrAD1516(3, 1) <> arrAD1516(3, 6))) _
      Or (Option34(1).Value = True And Text1(60) <> "" And optCP814(0).Value = True And (arrAD1516(4, 3) <> arrAD1516(4, 5) Or arrAD1516(4, 1) <> arrAD1516(4, 6))) _
      Or (Option35(1).Value = True And Text1(76) <> "" And optCP815(0).Value = True And (arrAD1516(5, 3) <> arrAD1516(5, 5) Or arrAD1516(5, 1) <> arrAD1516(5, 6)))) Then
      DiscStatusIsChanged = True
   Else
      DiscStatusIsChanged = False
   End If
End Function
'Added by Morgan 2013/4/10
Private Sub ChkOptCP81()
Dim intP As Integer 'Added by Lydia 2016/02/23 避免被變更
   'Add by Lydia 2014/12/22 更改減免身份時，重新計算繳費金額，並提示操作者〔金額已重算過〕
   If Trim(Text1(6)) = "P" And mPYFee = True Then
       'Modified by Lydia 2016/02/23
'      For intI = 1 To 4
'        If Trim(Left(Trim(Combo1(intI)), 4)) = "601" Or Trim(Left(Trim(Combo1(intI)), 4)) = "605" Then
'           Call ChangePatentYearFee(intI, Trim(Left(Trim(Combo1(intI)), 4)), True)
'        End If
'      Next intI
      
      'Modify By Sindy 2022/9/1
      'For intP = 1 To 4
      For intP = 1 To GridCase.Rows - 1
        If Trim(Left(Trim(GridCase.TextMatrix(intP, 1)), 4)) = "601" Or _
           Trim(Left(Trim(GridCase.TextMatrix(intP, 1)), 4)) = "605" Then
           Call GetGridCaseData(intP)
           Call ChangePatentYearFee(1, Trim(Left(Trim(Combo1(1)), 4)), True)
           Call cmdUpd_Click '新增
           '2022/9/1 END
        End If
      Next intP
    'end 2016/02/23
   End If
   SetQualVisible
End Sub
'Added by Morgan 2013/4/10
'控制台灣專利領證或繳年費才可設定中小企業減免資格
Private Sub SetQualVisible(Optional iTab As Integer = -1, Optional bolCheck As Boolean)
   Dim ii As Integer, bolEnabled As Boolean
   
   m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   'Added by Morgan 2019/4/12
   Label1(5) = "符合年費減免：": cmdQual(1).Caption = "中小企業減免資格"
   Label1(27) = Label1(5): cmdQual(2).Caption = cmdQual(1).Caption
   Label1(40) = Label1(5): cmdQual(3).Caption = cmdQual(1).Caption
   Label1(53) = Label1(5): cmdQual(4).Caption = cmdQual(1).Caption
   Label1(66) = Label1(5): cmdQual(5).Caption = cmdQual(1).Caption
  'end 2019/4/12
  
   bolCheck = False
   If iTab = -1 Then iTab = SSTab2.Tab
   
   cmdQual(iTab + 1).Visible = False
   
   If Text1(6) = "P" And Trim(Left(Combo1(0), 4)) = "000" Then
      ii = 5
      'For ii = 1 To 4
         'If Trim(Left(Me.Combo1(ii).Text, 4)) = "601" Then
         If InStr(m_strCaseCPM, "601") > 0 Then
            ii = 1
            If DBDATE(Text1(1)) >= "20130718" Then bolCheck = True
            'Exit For
         'ElseIf Trim(Left(Me.Combo1(ii).Text, 4)) = "605" Then
         ElseIf InStr(m_strCaseCPM, "605") > 0 Then
            ii = 1
            If DBDATE(Text1(1)) >= "20130801" Then bolCheck = True
            'Exit For
         End If
      'Next
      If ii < 5 Then
         Select Case iTab
         Case 0 '申請人1
            '可減免
            If optCP811(0).Value = True Then
               '舊客戶
               If Option31(1).Value = True Then
                  If Text1(12) <> "" Then
                     If GetCU15(Text1(12)) = "1" Then
                        cmdQual(1).Visible = True
                     End If
                  End If
               '新客戶
               Else
                  cmdQual(1).Visible = True
               End If
            End If
            
         Case 1 '申請人2
            '可減免
            If optCP812(0).Value = True Then
               '舊客戶
               If Option32(1).Value = True Then
                  If Text1(28) <> "" Then
                     If GetCU15(Text1(28)) = "1" Then
                        cmdQual(2).Visible = True
                     End If
                  End If
               '新客戶
               Else
                  cmdQual(2).Visible = True
               End If
            End If
         
         Case 2 '申請人3
            '可減免
            If optCP813(0).Value = True Then
               '舊客戶
               If Option33(1).Value = True Then
                  If Text1(44) <> "" Then
                     If GetCU15(Text1(44)) = "1" Then
                        cmdQual(3).Visible = True
                     End If
                  End If
               '新客戶
               Else
                  cmdQual(3).Visible = True
               End If
            End If
         Case 3 '申請人4
            '可減免
            If optCP814(0).Value = True Then
               '舊客戶
               If Option34(1).Value = True Then
                  If Text1(60) <> "" Then
                     If GetCU15(Text1(60)) = "1" Then
                        cmdQual(4).Visible = True
                     End If
                  End If
               '新客戶
               Else
                  cmdQual(4).Visible = True
               End If
            End If
         
         Case 4 '申請人5
            '可減免
            If optCP815(0).Value = True Then
               '舊客戶
               If Option35(1).Value = True Then
                  If Text1(76) <> "" Then
                     If GetCU15(Text1(76)) = "1" Then
                        cmdQual(5).Visible = True
                     End If
                  End If
               '新客戶
               Else
                  cmdQual(5).Visible = True
               End If
            End If
         End Select
      End If

   'Added by Morgan 2019/4/12 +CFP日本發明專利案
   ElseIf Text1(6) = "CFP" And Trim(Left(Combo1(0), 4)) = "011" Then
   
      Label1(5) = "符合減免資格：": cmdQual(1).Caption = "減免資格"
      Label1(27) = Label1(5): cmdQual(2).Caption = cmdQual(1).Caption
      Label1(40) = Label1(5): cmdQual(3).Caption = cmdQual(1).Caption
      Label1(53) = Label1(5): cmdQual(4).Caption = cmdQual(1).Caption
      Label1(66) = Label1(5): cmdQual(5).Caption = cmdQual(1).Caption
         
      SetOpt81 stCountry '重新設定一次(因需考慮專利種類或收文性質)
      
      'Modify By Sindy 2022/11/9 + And Not Me.ActiveControl Is Nothing
      If IsoptCP81 And Not Me.ActiveControl Is Nothing Then
         Select Case iTab
         Case 0 '申請人1
            cmdQual(1).Visible = optCP811(0).Value
            If cmdQual(1).Visible And Me.ActiveControl.Name = optCP811(0).Name Then cmdQual(1).Value = True
         Case 1 '申請人2
            cmdQual(2).Visible = optCP812(0).Value
            If cmdQual(2).Visible And Me.ActiveControl.Name = optCP812(0).Name Then cmdQual(2).Value = True
         Case 2 '申請人3
            cmdQual(3).Visible = optCP813(0).Value
            If cmdQual(3).Visible And Me.ActiveControl.Name = optCP813(0).Name Then cmdQual(3).Value = True
         Case 3 '申請人4
            cmdQual(4).Visible = optCP814(0).Value
            If cmdQual(4).Visible And Me.ActiveControl.Name = optCP814(0).Name Then cmdQual(4).Value = True
         Case 4 '申請人5
            cmdQual(5).Visible = optCP815(0).Value
            If cmdQual(5).Visible And Me.ActiveControl.Name = optCP815(0) Then cmdQual(5).Value = True
         End Select
      End If
   End If
End Sub

Private Function GetCU15(pCuNo As String) As String
   Dim stSQL As String, intR As Integer
   Dim rsQuery As ADODB.Recordset
   stSQL = "select cu15 from customer where cu01='" & Left(pCuNo & "000", 8) & "' and cu02='" & Mid(pCuNo & "000", 9, 1) & "'"
   intR = 1
   Set rsQuery = ClsLawReadRstMsg(intR, stSQL)
   If intR = 1 Then
      GetCU15 = "" & rsQuery(0)
   End If
   Set rsQuery = Nothing
End Function
'Added by Morgan 2013/9/23
'設定電子送件
Private Sub SetElecApp(Optional pbolSetDefault As Boolean)
   m_strCaseCPM = GetAllCaseCPM() 'Add By Sindy 2023/2/24 取得案件性質代碼
   
   If Check4.Visible = False Then
      pbolSetDefault = True
   End If
   '台灣專利新案
   If Option1(0).Value = True And Text1(6) = "P" And Left(Combo1(0), 3) = "000" Then
      Check4.Visible = True
      'Modified by Morgan 2017/11/3 改生醫案也預設為電子送件--郭雅娟 106.11.3
      ''生醫案不預設為電子送件
      'If Left(Combo5, 1) = "3" Then
      '   Check4.Value = 0
      ''非生醫案預設電子送件但可改紙本送件
      'ElseIf pbolSetDefault = True Then
      If pbolSetDefault = True Then
      'end 2017/11/3
         Check4.Value = 1
      End If
   '2014/11/28 ADD BY SONIA P-099681因改請案也可電子送件且規費可減免故郭說台灣舊案也可點選
   ElseIf Text1(6) = "P" And Left(Combo1(0), 3) = "000" Then
      Check4.Visible = True
      '2014/12/19 modify by sonia 台灣舊案要依原新申請案是否電子送件預設
      '生醫案不可電子送件
      'If Left(Combo5, 1) = "3" Then
      '   Check4.Value = 0
      ''非生醫案預設電子送件但可改紙本送件
      'ElseIf pbolSetDefault = True Then
      '   Check4.Value = 1
      'End If
      'Add By Sindy 2023/8/16 增加判斷避免輸入多個案件性質時,電子送件一直被異動
      If Check4.Tag <> Text1(6) & Text1(7) & Text1(8) & Text1(9) Then
      '2023/8/16 END
         strExc(0) = "select cp118 from caseprogress where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Text1(8) & "' and cp04='" & Text1(9) & "'" & _
            " and cp10 in (" & NewCasePtyList & ") and cp118 is not null"
         intI = 1
         Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
         Check4.Tag = Text1(6) & Text1(7) & Text1(8) & Text1(9) 'Add By Sindy 2023/8/16
         If intI = 1 Then
            Check4.Value = 1
         Else
            Check4.Value = 0
         End If
      End If
      '2014/12/19 end
   '2014/11/28 END
   'Add By Sindy 2023/2/14 T台灣的申請案也要顯示電子送件
   ElseIf Text1(6) = "T" And Left(Combo1(0), 3) = "000" And _
      (InStr(m_strCaseCPM, "101") > 0 Or Trim(Left(Trim(Combo1(1)), 4)) = "101") Then
      
      Check4.Visible = True
      If Option1(0).Value = True Then
         If pbolSetDefault = True Then
            Check4.Value = 1
         End If
      Else
         Check4.Value = 0
         Check4.Visible = False
'         strExc(0) = "select cp118 from caseprogress where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Text1(8) & "' and cp04='" & Text1(9) & "'" & _
'            " and cp31='Y' and cp118 is not null"
'         intI = 1
'         Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
'         If intI = 1 Then
'            Check4.Value = 1
'         Else
'            Check4.Value = 0
'         End If
      End If
      '2023/2/14 END
   Else
      Check4.Value = 0
      Check4.Visible = False
   End If
End Sub

'Added by Morgan 2021/7/20
'大陸發明生醫案是否新藥專利設定
Private Sub SetNewDrug()
   If Option1(0).Value = True And Text1(6) = "P" And Left(Combo1(0), 3) = "020" And Left(Combo6, 1) = "1" And Left(Combo5, 1) = "3" Then
      OptNewDrug(0).Value = False
      OptNewDrug(1).Value = False
      Frame48.Visible = True
   Else
      Frame48.Visible = False
   End If
End Sub

'Added by Morgan 2013/9/26
'台灣發明案發明申請或分割程序有附英文摘要可減800
Private Sub SetEngAbs()
   'Modify By Sindy 2023/8/16 + Or InStr(m_strCaseCPM, "101") > 0 Or InStr(m_strCaseCPM, "307") > 0)
   If (Option1(0).Value = True Or InStr(m_strCaseCPM, "101") > 0 Or InStr(m_strCaseCPM, "307") > 0) _
      And Text1(6) = "P" And Left(Combo1(0), 3) = "000" Then
      Check5.Visible = True
   Else
      Check5.Value = 0
      Check5.Visible = False
   End If
End Sub

'Added by Morgan 2013/4/10
'更新中小企業減免資格
'Modify By Sindy 2023/5/24 取消 Optional pbolInTrans As Boolean = True
Private Function UpdateDiscountQual() As Boolean
   Dim stSQL As String
   
   UpdateDiscountQual = False
   If DiscStatusIsChanged() = False Then
'      If pbolInTrans = False Then
'         cnnConnection.BeginTrans
         On Error GoTo ErrHnd
'      End If
      'Modified by Morgan 2019/4/15 +改判斷有修改才執行並加記錄修改人員(減免身分只有日本案可設定且目前不會直接更新)
      If stCustNo1 <> "" And optCP811(0).Value = True And cmdQual(1).Visible And (arrAD1516(1, 1) <> arrAD1516(1, 6) Or arrAD1516(1, 2) <> arrAD1516(1, 7) Or arrAD1516(1, 3) <> arrAD1516(1, 5)) Then
         stSQL = "update applicantdiscount set ad10='" & arrAD1516(1, 3) & "',ad15='" & arrAD1516(1, 1) & "',ad16=" & Val(arrAD1516(1, 2)) & ",ad07='" & strUserNum & "',ad08=to_char(sysdate,'yyyymmdd'),ad09=to_char(sysdate,'hh24mi') where ad01='" & Left(stCustNo1 & "00", 8) & "' and ad02='" & stCountry & "'"
         Pub_SeekTbLog stSQL
         cnnConnection.Execute stSQL, intI
      End If
      If stCustNo2 <> "" And optCP812(0).Value = True And cmdQual(2).Visible And (arrAD1516(2, 1) <> arrAD1516(2, 6) Or arrAD1516(2, 2) <> arrAD1516(2, 7) Or arrAD1516(2, 3) <> arrAD1516(2, 5)) Then
         stSQL = "update applicantdiscount set ad10='" & arrAD1516(2, 3) & "',ad15='" & arrAD1516(2, 1) & "',ad16=" & Val(arrAD1516(2, 2)) & ",ad07='" & strUserNum & "',ad08=to_char(sysdate,'yyyymmdd'),ad09=to_char(sysdate,'hh24mi') where ad01='" & Left(stCustNo2 & "00", 8) & "' and ad02='" & stCountry & "'"
         Pub_SeekTbLog stSQL
         cnnConnection.Execute stSQL, intI
      End If
      If stCustNo3 <> "" And optCP813(0).Value = True And cmdQual(3).Visible And (arrAD1516(3, 1) <> arrAD1516(3, 6) Or arrAD1516(3, 2) <> arrAD1516(3, 7) Or arrAD1516(3, 3) <> arrAD1516(3, 5)) Then
         stSQL = "update applicantdiscount set ad10='" & arrAD1516(3, 3) & "',ad15='" & arrAD1516(3, 1) & "',ad16=" & Val(arrAD1516(3, 2)) & ",ad07='" & strUserNum & "',ad08=to_char(sysdate,'yyyymmdd'),ad09=to_char(sysdate,'hh24mi') where ad01='" & Left(stCustNo3 & "00", 8) & "' and ad02='" & stCountry & "'"
         Pub_SeekTbLog stSQL
         cnnConnection.Execute stSQL, intI
      End If
      If stCustNo4 <> "" And optCP814(0).Value = True And cmdQual(4).Visible And (arrAD1516(4, 1) <> arrAD1516(4, 6) Or arrAD1516(4, 2) <> arrAD1516(4, 7) Or arrAD1516(4, 3) <> arrAD1516(4, 5)) Then
         stSQL = "update applicantdiscount set ad10='" & arrAD1516(4, 3) & "',ad15='" & arrAD1516(4, 1) & "',ad16=" & Val(arrAD1516(4, 2)) & ",ad07='" & strUserNum & "',ad08=to_char(sysdate,'yyyymmdd'),ad09=to_char(sysdate,'hh24mi') where ad01='" & Left(stCustNo4 & "00", 8) & "' and ad02='" & stCountry & "'"
         Pub_SeekTbLog stSQL
         cnnConnection.Execute stSQL, intI
      End If
      If stCustNo5 <> "" And optCP815(0).Value = True And cmdQual(5).Visible And (arrAD1516(5, 1) <> arrAD1516(5, 6) Or arrAD1516(5, 2) <> arrAD1516(5, 7) Or arrAD1516(5, 3) <> arrAD1516(5, 5)) Then
         stSQL = "update applicantdiscount set ad10='" & arrAD1516(5, 3) & "',ad15='" & arrAD1516(5, 1) & "',ad16=" & Val(arrAD1516(5, 2)) & ",ad07='" & strUserNum & "',ad08=to_char(sysdate,'yyyymmdd'),ad09=to_char(sysdate,'hh24mi') where ad01='" & Left(stCustNo5 & "00", 8) & "' and ad02='" & stCountry & "'"
         Pub_SeekTbLog stSQL
         cnnConnection.Execute stSQL, intI
      End If
'      If pbolInTrans = False Then cnnConnection.CommitTrans
      UpdateDiscountQual = True
   Else
      UpdateDiscountQual = True
   End If
   
   Exit Function
   
ErrHnd:
'   If pbolInTrans = False Then
'      cnnConnection.RollbackTrans
      MsgBox Err.Description & "中小企業減免資格更新失敗！", vbCritical, "UpdateDiscountQual"
'   End If
End Function

'Add By Sindy 2014/2/6
'Modify By Sindy 2023/5/24 取消 Optional pbolInTrans As Boolean = True
Private Function SaveCustData() As Boolean
Dim i As Integer
Dim bolOldCust As Boolean
Dim intRec As Integer 'Add by Amy 2016/01/04
'Add by Amy 2016/05/20
Dim stField As String
'Add by Amy 2016/12/23
Dim strUpd As String '原用strsql 因為共用變數其他function也有用到會有問題
Dim stCU13 As String
'Added by Lydia 2020/03/30
Dim rsA1 As New ADODB.Recordset
Dim strA1 As String

On Error GoTo ErrHnd

   SaveCustData = False
'   If pbolInTrans = False Then
'      cnnConnection.BeginTrans
'   End If
   
   For i = 0 To 4
      If i = 0 Then bolOldCust = Option31(1).Value
      If i = 1 Then bolOldCust = Option32(1).Value
      If i = 2 Then bolOldCust = Option33(1).Value
      If i = 3 Then bolOldCust = Option34(1).Value
      If i = 4 Then bolOldCust = Option35(1).Value
      '舊客戶有客戶編號且統一編號欄位開放可以輸入時,更新ID No
      If bolOldCust = True And Trim(Me.Text1(12 + (16 * i)).Text) <> "" And Me.Text1(92 + i).Enabled = True Then
         If Me.Text1(92 + i).Text <> "" Then
            'Add by Amy 2025/07/21 +判斷 ID重覆組發信內文 ex:X86989010
            strExc(8) = "": strExc(9) = ""
            If ChkCU11Same("", "", Me.Text1(92 + i).Text, strExc(8), 0, Me.Name, , strExc(9)) = True Then
               strIDRepeat = strIDRepeat & "," & Me.Text1(12 + (16 * i)).Text & " 身份證字號/統一編號 [" & Me.Text1(92 + i).Text & "]" & _
                                                   " 與 " & Replace(strExc(9), ",", "、") & "相同"
            End If
            'end 2025/07/21
            strUpd = "update customer" & _
                     " set cu11='" & Me.Text1(92 + i).Text & "'" & _
                     " where cu01='" & Left(Trim(Me.Text1(12 + (16 * i)).Text), 8) & "'" & _
                       " and cu02='" & Right(Trim(Me.Text1(12 + (16 * i)).Text), 1) & "'"
            Pub_SeekTbLog strUpd 'Add by Amy 2025/07/21 新建 X86989010 客戶時,未輸ID,於此支更新未寫log
            cnnConnection.Execute strUpd
            strReSetCust = strReSetCust & "," & i 'Add by Amy 2025/07/21
         End If
      End If
      
      'Add by Amy 2016/01/04 新案舊客戶有客戶編號且申請地址/聯絡地址郵遞區號有改過時(原本為null也回寫)
      If Option1(0).Value = True Then
        If bolOldCust = True Then
            strUpd = ""
            'Add by Amy 2016/05/20 畫面收據公司別與申請人1預設公司別不同時更新相對應欄位
            'Modify by Amy 2016/12/23 +同業務區或為MCTF同組人員才可回寫收據公司別
            If i = 0 Then
                If ChkSameCuArea(Trim(Me.Text1(12 + (16 * i))), Trim(Me.Text1(10))) = True Then
                    'Modify by Amy 2019/12/04 +GetReceiptVal
                    If Me.Combo4.Tag <> GetReceiptVal(Me.Combo4, False) Then
                        Select Case Text1(6)
                            Case "P", "CFP", "FCP"
                                If Left(Combo1(0), 3) = 台灣國家代號 Then
                                    stField = ",cu160="
                                Else
                                    stField = ",cu161="
                                End If
                            Case "T", "TF", "CFT", "FCT"
                                If Left(Combo1(0), 3) = 台灣國家代號 Then
                                    stField = ",cu162="
                                Else
                                    stField = ",cu163="
                                End If
                            Case Else
                                If Left(Combo1(0), 3) = 台灣國家代號 Then
                                    stField = ",cu164="
                                Else
                                    stField = ",cu165="
                                End If
                        End Select
                        'Memo by Amy 2023/03/09 特殊不會更新客戶檔對應收據公司別
                        '選「舊案」(歐盟案號) ex:CFP-030339 ->帶入延展費(英國) ,因為「新案」才會比對是否與客戶檔對應公司別一樣
                        '所有資料輸完後,程式最後會變成「新案」案號 ex:CFP-033680->查此案發現與客戶檔對應收據公司別不一致-秀玲:程式不需改
                        
                        'Modify by Amy 2019/12/04 改寫至GetReceiptVal
                        stField = stField & CNULL(GetReceiptVal(Me.Combo4, True))
                        If stField <> MsgText(601) Then strUpd = strUpd & stField
                    End If
                End If
                'end 2016/12/23
            End If
            'Added by Lydia 2020/03/30 新案以系統類別抓系統種類對照表，若SK02為3、4(法務案)及7、8(顧問案)的收據公司別鎖住，且不更新回客戶檔
            If i = 0 And Combo4.Enabled = False Then
                'Modified by Lydia 2020/04/10 請改為instr(系統類別,'L')>0的收據公司別鎖住，且不更新回客戶檔
                'strA1 = "select sk02 from systemkind where sk01='" & Text1(6) & "' "
                'i = 1
                'Set rsA1 = ClsLawReadRstMsg(i, strA1)
                'If i = 1 Then
                '    If InStr("3,4,7,8", "" & rsA1.Fields("sk02")) > 0 Then
                '        strUpd = ""
                '    End If
                'End If
                'Set rsA1 = Nothing
                If InStr(UCase(Text1(6)), "L") > 0 Then
                    strUpd = ""
                End If
                'end 2020/04/10
            End If
            'end 2020/03/30
            
            If Trim(Me.Text1(12 + (16 * i)).Text) <> "" Then
                'Modify by Amy 2016/07/27
                stField = ""
                If Me.Text1(120 + i).Tag <> Me.Text1(120 + i) And intTWAddr(i * 2 + 2) < 11 Then
                    If ChkIsNumeric(Me.Text1(120 + i)) = True Then stField = ",cu112='" & Me.Text1(120 + i).Text & "'"
                End If
                If Me.Text1(25 + i).Tag <> Me.Text1(25 + i) And intTWAddr(i * 2 + 1) < 11 Then
                    If ChkIsNumeric(Me.Text1(25 + i)) = True Then stField = stField & ",cu30='" & Me.Text1(25 + i).Text & "'"
                End If
                'end 2016/07/27
                If stField <> MsgText(601) Then strUpd = strUpd & stField
            End If
            If strUpd <> MsgText(601) Then
                '客戶基本檔
                strUpd = "Update Customer" & _
                            " Set " & Mid(strUpd, 2) & _
                            " Where cu01='" & Left(Trim(Me.Text1(12 + (16 * i)).Text), 8) & "'" & _
                            " and cu02='" & Right(Trim(Me.Text1(12 + (16 * i)).Text), 1) & "'"
                Pub_SeekTbLog strUpd
                cnnConnection.Execute strUpd, intRec
                If intRec > 0 Then
                    'Modify by Amy 2019/12/04 +GetReceiptVal
                    If i = 0 And Me.Combo4.Tag <> GetReceiptVal(Me.Combo4, False) Then Me.Combo4.Tag = GetReceiptVal(Me.Combo4, False)
                    Me.Text1(120 + i).Tag = Me.Text1(120 + i)
                    Me.Text1(25 + i).Tag = Me.Text1(25 + i)
                End If
            End If
            'end 2015/05/20
        End If
      End If
      'end 2016/01/04
   Next i
   'Add by Amy 2025/07/21 +ID重覆組發信內文 ex:X86989010
   If strIDRepeat <> "" Then
      strReSetCust = Mid(strReSetCust, 2)
      strIDRepeat = Replace(Mid(strIDRepeat, 2), ",", vbCrLf)
      strIDRepeat = "接洽單 更新客戶檔身份證字號/統一編號重覆資料如下：" & vbCrLf & strIDRepeat
   End If
   'end 2025/07/21
   
'   If pbolInTrans = False Then cnnConnection.CommitTrans
   SaveCustData = True
   Exit Function
   
ErrHnd:
'   If pbolInTrans = False Then
'      cnnConnection.RollbackTrans
      'Modify by Amy 2016/07/27
      'MsgBox "客戶統一編號更新失敗！", vbCritical
      'Modified by Lydia 2019/08/12 +Titile
      'MsgBox Err.Description, vbCritical
      MsgBox Err.Description, vbCritical, "SaveCustData"
'   End If
End Function

'Add by Amy 2014/07/18 依系統別抓取案件性質名稱
Private Function GetCasePropertyName(ByVal strSystemKind As String, ByVal strCPM02 As String, ByVal strField As String) As String
    Dim strSqlq As String, intQ As Integer
    Dim RsQ As New ADODB.Recordset
    
    GetCasePropertyName = ""
    strSqlq = "Select " & strField & " From CasePropertyMap Where CPM01='" & strSystemKind & "' And CPM02='" & strCPM02 & "' "
    intQ = 1
    Set RsQ = ClsLawReadRstMsg(intQ, strSqlq)
    If intQ = 1 Then
        GetCasePropertyName = "" & RsQ.Fields(0)
    End If
End Function
'end 2014/07/18

'Add by Lydia 2014/12/15 台灣領證繳年費(自動收文)帶入年度相應的費用,並提示年度訊息
'Modified by Lydia 2014/12/25 改為所有P案(不限定自動收文),含大陸P案
Private Sub ChangePatentYearFee(iX As Integer, mCP10 As String, Updchk As Boolean)
Dim t1 As Integer
Dim blnT1 As Boolean

'If m_strST58 = "" And Option1(1).Value = True Then 'm_strST58 = "" 智權人員為自動收文
'台灣案及大陸領證年費 => 等待請作單-大陸領證報價維護請增加可設定年費並開放所有P案不分申請國家
'Modified by Morgan 2015/9/9 +非臺灣案
'If Option1(1).Value = True And pa(1) = "P" And (pa(9) = "000" Or pa(9) = "020") Then
If Option1(1).Value = True And pa(1) = "P" Then
'end 2015/9/9
     '若法定期限為假日時, 抓大於法定期限最近的工作天
     strExc(5) = "": strExc(4) = Text1(1).Text 'frm090801_2.m_strCP07
     'Added by Lydia 2025/02/20 P領證/年費的法限,所限; ex.P-124982同時收年費和代辦退費,期限抓到代辦退費,造成年費預設為逾期
     If m_P601or605cp07 <> "" Then
        strExc(4) = m_P601or605cp07
     End If
     'end 2025/02/20
     If strExc(4) <> "" Then
         strExc(5) = DBDATE(PUB_GetLawDay(DBDATE(strExc(4))))
     End If
     
     '檢查費用是否要雙倍
     strExc(6) = ""
     If strSrvDate(1) > IIf(DBDATE(strExc(4)) >= DBDATE(strExc(5)), DBDATE(strExc(4)), DBDATE(strExc(5))) Then
        strExc(6) = "Y"
     End If
     
     '是否符合年費減免, 改抓畫面上的設定
     Call MsgDiscSet 'Add by Lydia 2014/12/25 台灣P案未設定減免身份提示訊息
     strExc(8) = GetCP81()
     strExc(9) = "": strExc(10) = ""
     
   If ChkPatentYearFee(pa(9), pa(8), "Y00000001", "" & Trim(mCP10), Text1(142).Text, Text1(143).Text, IIf(strExc(6) = "Y", True, False), 0, strExc(8), 2, strExc(9), strExc(10)) = True Then
      If iX = 1 Then t1 = 101
      If iX > 1 Then t1 = 101 + (iX - 1) * 3
      
      'Added by Morgan 2024/7/12
      '專利處大對台年費服務費+500--韻丞 (與催年費報價規則同步 frm040303)
      'Modified by Morgan 2024/7/31 補年費條件
      If pa(9) = "000" And mCP10 = "605" Then
         If PUB_CheckCuNation(pa(26), pa(1), pa(2), pa(3), pa(4)) = "1" Then
            strExc(1) = PUB_GetStaffST15(PUB_GetAKindSalesNo(pa(1), pa(2), pa(3), pa(4)), "1")
            If Left(strExc(1), 2) = "P1" Then
               strExc(9) = Val(strExc(9)) + 500
            End If
         End If
      End If
      'end 2024/7/12
      
      Text1(t1) = strExc(9)
      Text1(t1 + 1) = strExc(10)
      Text1(t1 + 2) = Format((Val(strExc(9)) - Val(strExc(10))) / 1000, "##0.000")
      m_lng605Fee = Val(strExc(10)) 'Added by Morgan 2021/4/23
   End If
   
   If Updchk = True Then
      MsgBox "金額已重算過"
   Else
      mPYFee = True '判斷是否有過自動帶入費用
      'Modified by Lydia 2014/12/30 代入費用一併檢查是否可收文
      Text1_Validate t1 + 1, False '規費
   End If
Else
   mPYFee = False
End If
'end Add by Lydia 2014/12/15
End Sub

'Add by Lydia 2014/12/25 台灣P案未設定減免身份提示訊息
Private Function MsgDiscSet() As Boolean
   If Trim(Left(Me.Combo1(0).Text, 4)) = "000" And Trim(Text1(6)) = "P" Then
      MsgDiscSet = False
      
      If optCP811(0).Value = 0 And optCP811(1).Value = 0 Then
         MsgBox "申請人1尚未設定減免身份!!": MsgDiscSet = True
      ElseIf (Trim(Text1(37) & Text1(38))) <> "" And optCP812(0).Value = 0 And optCP812(1).Value = 0 Then
         MsgBox "申請人2尚未設定減免身份!!": MsgDiscSet = True
      ElseIf (Trim(Text1(53) & Text1(54))) <> "" And optCP813(0).Value = 0 And optCP813(1).Value = 0 Then
         MsgBox "申請人3尚未設定減免身份!!": MsgDiscSet = True
      ElseIf (Trim(Text1(69) & Text1(70))) <> "" And optCP814(0).Value = 0 And optCP814(1).Value = 0 Then
         MsgBox "申請人4尚未設定減免身份!!": MsgDiscSet = True
      ElseIf (Trim(Text1(85) & Text1(86))) <> "" And optCP815(0).Value = 0 And optCP815(1).Value = 0 Then
         MsgBox "申請人5尚未設定減免身份!!": MsgDiscSet = True
      End If
   End If
End Function

'Add by Lydia 2015/01/06 使用者會有保留前案畫面,進行下一案例操作的習慣,所以案號一改需清空費用相關計算變數和欄位
Private Sub FreeClear()
   txtCRL69.Text = "": txtCRL70.Text = "" 'Add By Sindy 2022/9/15
   cmdOK(3).Caption = "期限資料(&L)" 'Add By Sindy 2015/4/2
   m_Note1 = "": m_Note2 = ""
   m_strGetNP01 = "" 'Add By Sindy 2015/9/17
   Text1(142).Text = "": Text1(143).Text = ""
   Text1(1) = "": Text1(3) = ""
   Check11.Value = 0 'Add By Sindy 2022/11/4
   Check12.Value = 0 'Add By Sindy 2022/12/13
   LblCnt.Caption = "": Combo1(1) = "": Text1(101) = "": Text1(102) = "": Text1(103) = "": Combo2(0) = ""
   GridCase.Clear: LblCnt.Caption = ""
   Call SetGrd
   mPYFee = False
   Frame605.Visible = False
End Sub

'Add By Sindy 2022/8/29 案件性質
Private Sub SetGrd()
   Dim arrGridHeadText, arrGridHeadWidth
   Dim iRow As Integer
   'Modify By Sindy 2025/4/14 +,CRC13 規費調整
   '                        0       1           2       3       4       5       6       7           8           9         10          11      12      13      14      15      16
   arrGridHeadText = Array("順序", "案件性質", "費用", "規費", "點數", "備註", "案號", "總收文號", "算案件數", "計件值", "加乘註記", "cp01", "cp02", "cp03", "cp04", "CPMn", "規費調整")
   If LblRecved.Visible = True Then
      If Text1(6) = "P" Or Text1(6) = "PS" Or Text1(6) = "CFP" Or Text1(6) = "CPS" Then
         arrGridHeadWidth = Array(400, 1700, 1000, 1000, 1000, 1500, 1200, 1000, 800, 800, 800, 0, 0, 0, 0, 0, 0)
      Else
         arrGridHeadWidth = Array(400, 1700, 1000, 1000, 1000, 1500, 1200, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0)
      End If
   Else
      arrGridHeadWidth = Array(400, 1700, 1000, 1000, 1000, 1500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
   End If
   GridCase.Visible = False
   GridCase.Cols = UBound(arrGridHeadText) + 1
   GridCase.Rows = 2
   For iRow = 0 To GridCase.Cols - 1
      GridCase.row = 0
      GridCase.col = iRow
      GridCase.Text = arrGridHeadText(iRow)
      GridCase.ColWidth(iRow) = arrGridHeadWidth(iRow)
      If iRow = 1 Then
         GridCase.CellAlignment = flexAlignLeftCenter '儲存格內容中間靠左對齊。這是對字串的預設值。
      Else
         GridCase.CellAlignment = flexAlignLeftCenter 'flexAlignCenterCenter 'flexAlignRightCenter
      End If
   Next
   GridCase.Visible = True
End Sub

'Add By Sindy 2022/8/29
'案件性質編輯區
'清除:欄位清空
Private Sub cmdClear2_Click()
   LblCnt.Caption = "" '順序
   Combo1(1).Text = "": Combo1(1).Tag = "" '案件性質
   Text1(101).Text = "": Text1(101).Tag = "" '費用
   Text1(102).Text = "": Text1(102).Tag = "" '規費
   Text1(103).Text = "": Text1(103).Tag = "" '點數
   Combo2(0).Text = "": Combo2(0).Tag = "" '備註
End Sub
'刪除:移除勾選的資料列
Private Sub cmdDel_Click()
Dim j As Integer
   
   If Val(LblCnt.Caption) > 0 Then
      GridCase.Tag = "有異動"
      If GridCase.Rows - 1 = 1 Then
         GridCase.Clear: LblCnt.Caption = "": Call SetGrd
      Else
         GridCase.RemoveItem Val(LblCnt.Caption)
      End If
      '重新整理順序
      For j = 1 To GridCase.Rows - 1
         If Trim(GridCase.TextMatrix(j, 1)) <> "" Then
            GridCase.TextMatrix(j, 0) = j
         End If
      Next j
      FrameCRC.Caption = "案件性質編輯區（" & Val(GridCase.Rows - 1) - IIf(Trim(GridCase.TextMatrix(1, 1)) = "", 1, 0) & "）"
      Call cmdClear2_Click '清除
      Call SetFrmCol 'Add By Sindy 2022/12/26
   End If
End Sub
'加入:新增或修改
'Modify By Sindy 2024/11/18 intCurrRow: 回傳目前列數
Private Sub cmdUpd_Click()
Dim intRow As Integer, j As Integer, Cancel As Boolean
Dim bolChk As Boolean, stTP(2) As String 'Add by Amy 2024/01/17
   
   If Me.Combo1(1).Text = "" Then Exit Sub
   If Me.Combo1(1).Text = "" Then
      MsgBox "案件性質不可空白！", vbExclamation + vbOKOnly
      SSTab1.Tab = 0
      Combo1(1).SetFocus
      Exit Sub
   ElseIf Val(LblCnt.Caption) = 0 Then 'Add By Sindy 2023/1/10 + if ex:P-117286 7-8年費
      '案件性質 無 到 有 時才檢查
      Cancel = False
      Combo1_Validate 1, Cancel
      If Cancel = True Then
         SSTab1.Tab = 0
         Combo1(1).SetFocus
         Exit Sub
      End If
   End If
   
   'Add By Sindy 2023/8/11
   If Val(Text1(102)) < 0 Then
      MsgBox "規費不可小於 0！", vbExclamation + vbOKOnly
      SSTab1.Tab = 0
      Text1(102).SetFocus
      Exit Sub
   End If
   '2023/8/11 END
'   'Add By Sindy 2023/1/7 規費檢查 ~ 會出現堆疊狀況
'   Cancel = False
'   Text1_Validate 102, Cancel
'   If Cancel = True Then
'      SSTab1.Tab = 0
'      Text1(102).SetFocus
'      Exit Sub
'   End If
'   '2023/1/7 END
   
   arrCaseProperty = Split(Trim(Combo1(1).Text), " ") 'Modify By Sindy 2025/3/14
   '修改
   If Val(LblCnt.Caption) > 0 Then
      intRow = Val(LblCnt.Caption)
   '新增
   Else
      intRow = GridCase.Rows - 1
      
      If InStr(Text1(6), "L") > 0 And intRow >= 4 Then
         MsgBox "L的案件性質輸入不可超過 4 筆！", vbExclamation + vbOKOnly
         SSTab1.Tab = 0
         Exit Sub
      End If
      
      If Trim(GridCase.TextMatrix(intRow, 1)) <> "" Then
         intRow = intRow + 1
         
         'Add By Sindy 2023/2/14
         '請檢查案件性質序號2以上的資料,若有新申請案的案件性質存在則彈訊息不可收文:
         '新申請案的案件性質請填在順序1，請調整。 ex:CFP-033672
         If intRow > 1 Then
            'arrCaseProperty = Split(Trim(Combo1(1).Text), " ") 'Modify By Sindy 2025/3/14 mark,此句已往上移
            If ((Text1(6) = "P" Or Text1(6) = "CFP") And _
                 InStr(NewCasePtyList, arrCaseProperty(0)) > 0 And InStr("105,125,113,114,122", arrCaseProperty(0)) = 0) Or _
               ((Text1(6) = "T" Or Text1(6) = "CFT") And arrCaseProperty(0) = "101") Then
               MsgBox "新申請案的案件性質請填在順序1，請調整！", vbExclamation + vbOKOnly
               SSTab1.Tab = 0
               Combo1(1).SetFocus
               Exit Sub
            End If
            'Add By Sindy 2023/6/19 檢查案件性質有104領土延伸，一定要是第1個收文
            If Text1(6) = "TF" And arrCaseProperty(0) = "104" Then
               MsgBox "領土延伸的案件性質請填在順序1，請調整！", vbExclamation + vbOKOnly
               SSTab1.Tab = 0
               Combo1(1).SetFocus
               Exit Sub
            End If
            '2023/6/19 END
         End If
         '2023/2/14 END
         
         GridCase.AddItem ""
      End If
   End If
   
   'Add by Amy 2024/01/17 +對造資料
   If strSrvDate(1) >= 風險警示啟用日 Then
      stTP(0) = ""
      '有更動案件性質
      If GridCase.TextMatrix(intRow, 1) <> Trim(Combo1(1).Text) Then
         stTP(0) = Trim(Combo1(1).Text)
         stTP(0) = Mid(stTP(0), 1, Val(InStr(stTP(0), " ")) - 1)
         bolChk = ChkRiskData(1, Me.Name, Text1(6), stTP(0))
         If bolChk = True Then
            Call RunFrm090801_14
         End If
      End If
   End If
   
   GridCase.Tag = "有異動"
   GridCase.TextMatrix(intRow, 0) = intRow '順序
   GridCase.TextMatrix(intRow, 1) = " " & Trim(Combo1(1).Text) '案件性質
   GridCase.TextMatrix(intRow, 2) = Format(Text1(101).Text, "#,##0")  '費用
   GridCase.TextMatrix(intRow, 3) = Format(Text1(102).Text, "#,##0") '規費
   GridCase.TextMatrix(intRow, 4) = Format(Text1(103).Text, "#,##0.000") '點數
   If InStr(Combo2(0).Text, "低底") > 0 Then
      Combo2(0).Text = Replace(Combo2(0).Text, "低底", "")
      If Trim(Combo2(0).Text) = ",," Then Combo2(0).Text = ""
      If Trim(Combo2(0).Text) = "," Then Combo2(0).Text = ""
   End If
   GridCase.TextMatrix(intRow, 5) = Combo2(0).Text '備註
   'Add By Sindy 2025/4/14
   If Val(GridCase.TextMatrix(intRow, 3)) > 0 And Trim(GridCase.TextMatrix(intRow, 3)) <> "" Then
      If Me.Check10.Tag = "Y" Then '記錄規費異常
         GridCase.TextMatrix(Val(LblCnt.Caption), 16) = "Y"
         Me.Check10.Tag = "" '恢復預設值
      Else
         GridCase.TextMatrix(intRow, 16) = ""
      End If
   Else
      GridCase.TextMatrix(intRow, 16) = ""
   End If
   '2025/4/14 END
   GridCase.col = 1
   GridCase.row = intRow
   FrameCRC.Caption = "案件性質編輯區（" & Val(GridCase.Rows - 1) - IIf(Trim(GridCase.TextMatrix(1, 1)) = "", 1, 0) & "）"
   Call cmdClear2_Click '清除
   'm_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/9/12 取得案件性質代碼
   Call SetFrmCol 'Add By Sindy 2022/12/26
   
   'Add By Sindy 2024/11/15 檢查連動的案件性質
   If ChkCaseNationRcv = False Then
      Exit Sub
   End If
   '2024/11/15 END
   
   'Add By Sindy 2025/3/14 雅娟提:依杜協理的指示，智權人員收文泰國416實體審查 時，系統跳出以下內容提醒
   If Text1(6) = "CFP" And Left(Combo1(0), 3) = "019" And arrCaseProperty(0) = "416" Then
      MsgBox "(A)實審費：有美國、澳洲、EPC、日本、韓國、英國、中國大陸" & vbCrLf & _
             "　 任一相對應國家之審查結果。收文(A)須控制要同時收文提供" & vbCrLf & _
             "　 前案資料、必要修正費用及相對應國家審查結果之英譯本" & vbCrLf & _
             "　 翻譯費，請洽專利國內部程序提供報價。" & vbCrLf & vbCrLf & _
             "(B)實審費：無前述相對應國家審查結果(須另送至澳洲專利局作" & vbCrLf & _
             "　 新穎性檢索)。", vbInformation
   End If
   '2025/3/14 END
End Sub

'Add By Sindy 2024/11/15 增加檢查連動的案件性質
'案件性質為雙向連動，即兩種案件性質並同時存在。
'案件性質為單向連動，若擬收文後端案件性質時，須檢核是否已有或同時有前端的案件性質。
Private Function ChkCaseNationRcv() As Boolean
Dim rsA As New ADODB.Recordset
Dim strCNR06 As String, strCNR07 As String, strCP10 As String
Dim arrCPM As Variant, arrGrid As Variant
Dim intQ As Integer, intG As Integer
Dim bolFind As Boolean
Dim strCNR04 As String, strCNR05 As String
Dim intRow As Integer, strMsg As String
   
   ChkCaseNationRcv = True
   strCNR04 = "0": strCNR05 = "0"
   '專利種類
   If Combo6.Text <> "" Then
      strCNR04 = Left(Combo6.Text, 1)
   End If
   '身份種類
   If Frame28.Visible = True Then
      If OptEntity(0).Value = True And OptEntity(0).Visible = True Then
         strCNR05 = "1"
      ElseIf OptEntity(1).Value = True And OptEntity(1).Visible = True Then
         strCNR05 = "2"
      ElseIf OptEntity(2).Value = True And OptEntity(2).Visible = True Then
         strCNR05 = "3"
      End If
   Else
      '案件屬性
      If Combo5.Text <> "" Then
         strCNR05 = Left(Combo5.Text, 1)
      End If
   End If
   arrGrid = Split(m_strCaseCPM, ",")
   For intG = LBound(arrGrid) To UBound(arrGrid)
      strExc(0) = "SELECT CaseNationRcv.*,1 sort FROM CaseNationRcv WHERE CNR01='" & Trim(Text1(6).Text) & "' AND CNR02='" & Left(Combo1(0), 3) & "'" & _
                  " AND CNR03='" & arrGrid(intG) & "' AND CNR04='" & strCNR04 & "' AND CNR05='" & strCNR05 & "'" & _
                  " and (CNR06 is not null or CNR07 is not null)"
      strExc(0) = strExc(0) & " union " & _
                  "SELECT CaseNationRcv.*,2 sort FROM CaseNationRcv WHERE CNR01='" & Trim(Text1(6).Text) & "' AND CNR02='" & Left(Combo1(0), 3) & "'" & _
                  " AND CNR03='" & arrGrid(intG) & "' AND CNR04='" & strCNR04 & "' AND CNR05='0'" & _
                  " and (CNR06 is not null or CNR07 is not null)"
      strExc(0) = strExc(0) & " union " & _
                  "SELECT CaseNationRcv.*,3 sort FROM CaseNationRcv WHERE CNR01='" & Trim(Text1(6).Text) & "' AND CNR02='" & Left(Combo1(0), 3) & "'" & _
                  " AND CNR03='" & arrGrid(intG) & "' AND CNR04='0' AND CNR05='" & strCNR05 & "'" & _
                  " and (CNR06 is not null or CNR07 is not null)"
      strExc(0) = strExc(0) & " union " & _
                  "SELECT CaseNationRcv.*,4 sort FROM CaseNationRcv WHERE CNR01='" & Trim(Text1(6).Text) & "' AND CNR02='" & Left(Combo1(0), 3) & "'" & _
                  " AND CNR03='" & arrGrid(intG) & "' AND CNR04='0' AND CNR05='0'" & _
                  " and (CNR06 is not null or CNR07 is not null)"
      strExc(0) = strExc(0) & " order by sort asc"
      intI = 1
      Set rsA = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 1 Then
         strCNR06 = Trim("" & rsA.Fields("CNR06"))
         strCNR07 = Trim("" & rsA.Fields("CNR07"))
      Else
         strCNR06 = ""
         strCNR07 = ""
      End If
      strCP10 = ""
      'CNR06=必要存在的案件性質
      'Modify By Sindy 2025/3/13 已建立Table做設定,所以mark起來
'      'Add By Sindy 2021/12/16 特殊狀況:
'      If strCNR06 = "" Then
'         If Frame28.Visible = True And Frame28.Enabled = True Then
'            '030菲律賓以小個體提出申請，須另外簽署宣誓書，且須公證
'            '040印度以法人小個體或新創公司提出申請，須另外簽署宣誓書，且須公證
'            If (Left(Combo1(0), 3) = "030" And OptEntity(1).Value = True) _
'               Or (Left(Combo1(0), 3) = "040" And (OptEntity(1).Value = True Or OptEntity(2).Value = True)) Then
'               strCNR06 = "914"
'            End If
'         End If
'      End If
'      '2021/12/16 END
      If strCNR06 <> "" Then
         arrCPM = Split(strCNR06, ",")
         For intQ = LBound(arrCPM) To UBound(arrCPM)
            If InStr(m_strCaseCPM, arrCPM(intQ)) = 0 Then '不在此接洽單中
               If ChkIsRecvCP10(CStr(arrCPM(intQ))) = False Then
                  strMsg = IIf(strMsg <> "", strMsg & vbCrLf, "") & "收文【" & GetPrjState6(Trim(Text1(6).Text), CStr(arrGrid(intG)), IIf(Left(Combo1(0), 3) = "000", "0", "1")) & _
                           "】時，必須同時收文【" & GetPrjState6(Trim(Text1(6).Text), CStr(arrCPM(intQ)), IIf(Left(Combo1(0), 3) = "000", "0", "1")) & "】。"
                  Call SrcAutoAdd(CStr(arrCPM(intQ)))
                  Text1(101).Text = ""
                  Text1(102).Text = ""
                  Text1(103).Text = ""
                  ChkCaseNationRcv = False
                  Call cmdUpd_Click   '新增
               End If
            End If
         Next intQ
      End If
      'CNR07=擇一同時收文之案件性質
      If strCNR07 <> "" Then
         arrCPM = Split(strCNR07, ",")
         bolFind = False
         strMsg = ""
         For intQ = LBound(arrCPM) To UBound(arrCPM)
            If InStr(m_strCaseCPM, arrCPM(intQ)) > 0 Then
               bolFind = True
               Exit For
            End If
         Next intQ
         If bolFind = False Then
'            If Trim(Text1(6).Text) = "CFP" Then
'               If Left(Combo6, 1) = "1" Then
'                  strCP10 = "101"
'               ElseIf Left(Combo6, 1) = "2" Then
'                  strCP10 = "102"
'               Else
'                  strCP10 = "103"
'               End If
'            End If
            'Modify By Sindy 2025/5/22
            For intQ = LBound(arrCPM) To UBound(arrCPM)
               strCP10 = arrCPM(intQ)
               If ChkIsRecvCP10(strCP10) = True Then
                  bolFind = True
                  Exit For
               Else
                  strMsg = strMsg & "、" & GetPrjState6(Trim(Text1(6).Text), strCP10, IIf(Left(Combo1(0), 3) = "000", "0", "1"))
               End If
            Next intQ
            If bolFind = False Then
               ChkCaseNationRcv = False
               strMsg = Mid(strMsg, 2)
               MsgBox "必須擇一案件性質（" & strMsg & "）同時收文", vbExclamation
               'Exit Function
            End If
            '2025/5/22 END
         End If
      End If
   Next intG
   
   Set rsA = Nothing
   
   'Modify By Sindy 2025/3/25
RunEndExit:
   If ChkCaseNationRcv = False Then
      For intRow = 1 To GridCase.Rows - 1
         If Trim(GridCase.TextMatrix(intRow, 1)) <> "" And Trim(GridCase.TextMatrix(intRow, 2)) = "" Then
            Call GetGridCaseData(intRow)
            Text1(101).SetFocus
            Exit For
         End If
      Next intRow
      If strMsg <> "" Then
         If Left(strMsg, 1) = "、" Then
            strMsg = Mid(strMsg, 2)
         End If
         MsgBox Trim(Mid(Combo1(0), 4)) & strMsg, vbExclamation
      End If
   End If
   '2025/3/25 END
End Function

Private Function ChkIsRecvCP10(strCP10 As String) As Boolean
Dim rsA As New ADODB.Recordset
   
   ChkIsRecvCP10 = True
   If Option1(1).Value = True Then '舊案
      '檢查進度檔是否已收文
      strExc(0) = "SELECT cp09 FROM caseprogress" & _
                  " WHERE cp01='" & Text1(6) & "' AND cp02='" & Text1(7) & "' AND cp03='" & Text1(8) & "' AND cp04='" & Text1(9) & "'" & _
                  " AND cp10='" & strCP10 & "'" & _
                  " AND cp159=0 AND cp158=0"
      intI = 1
      Set rsA = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 0 Then
         '檢查是否已收於接洽單中
         strExc(0) = "SELECT CRL01,CRC03,CRC08 FROM consultrecordlist,consultreccmp" & _
                     " WHERE CRL07='" & Text1(6) & "' AND CRL08='" & Text1(7) & "' AND CRL09='" & Text1(8) & "' AND CRL10='" & Text1(9) & "'" & _
                     " AND CRL01=CRC01 and CRC03='" & strCP10 & "' and CRC08 is null "
         intI = 1
         Set rsA = ClsLawReadRstMsg(intI, strExc(0))
         If intI = 0 Then
            ChkIsRecvCP10 = False
         End If
      End If
   Else '新案
      ChkIsRecvCP10 = False
   End If
   Set rsA = Nothing
End Function

'Add By Sindy 2022/8/29 取得目前輸入的案件性質代碼
'Optional ByRef bolNewCase As Boolean = False : 回傳是否為新申請案案件性質
'Optional ByRef bolTMdebate As Boolean = False : 回傳是否為商爭案件性質
'Optional ByRef strNewCP10 As String = "" : 回傳新申請案的案件性質
'Optional ByRef bolHad10Point As Boolean = False : 檢查是否有點數超過或等於10點的
'Optional ByRef dblTotOFee As Double = 0 : 回傳總規費
'Optional ByRef dblTotRvFee As Double = 0 : 回傳總費用
'Optional ByRef dblTotPoint As Double = 0 : 回傳總點數
Private Function GetAllCaseCPM(Optional ByRef bolNewCase As Boolean = False, _
   Optional ByRef bolTMdebate As Boolean = False, Optional ByRef strNewCP10 As String = "", _
   Optional ByRef bolHad10Point As Boolean = False, Optional ByRef dblTotOFee As Double = 0, _
   Optional ByRef dblTotRvFee As Double = 0, Optional ByRef dblTotPoint As Double = 0) As String
Dim j As Integer
Dim arrData As Variant
      
   GetAllCaseCPM = ""
   bolNewCase = False: bolTMdebate = False: strNewCP10 = "": bolHad10Point = False: dblTotOFee = 0: dblTotRvFee = 0: dblTotPoint = 0
   For j = 1 To GridCase.Rows - 1
      If Trim(GridCase.TextMatrix(j, 1)) <> "" Then
         arrData = Split(Trim(GridCase.TextMatrix(j, 1)), " ")
         GetAllCaseCPM = GetAllCaseCPM & "," & arrData(0)
         '專利
         If InStr("1", m_strSys) > 0 And InStr(NewCasePtyList, arrData(0)) > 0 Then
            strNewCP10 = arrData(0)
            bolNewCase = True
         '商標
         ElseIf InStr("2", m_strSys) > 0 Then
            If arrData(0) = "101" Then
               strNewCP10 = arrData(0)
               bolNewCase = True
            End If
            'Modify By Sindy 2025/7/30 FCT案727分析不屬於爭議案 + FCT_NotTMdebate
            If InStr(TMdebate, arrData(0)) > 0 And Not (Text1(6) = "FCT" And InStr(FCT_NotTMdebate, arrData(0)) > 0) Then
               bolTMdebate = True
            End If
         End If
         '檢查點數是否超過或等於10點
         If Format(Val(GridCase.TextMatrix(j, 4)), "###0.000") >= 10 Then
            bolHad10Point = True
         End If
         '總規費:dblTotOFee
         If Val(Format(GridCase.TextMatrix(j, 3), "###0")) > 0 Then
            dblTotOFee = dblTotOFee + Val(Format(GridCase.TextMatrix(j, 3), "###0"))
         End If
         '總費用:dblTotRvFee
         If Val(Format(GridCase.TextMatrix(j, 2), "###0")) > 0 Then
            dblTotRvFee = dblTotRvFee + Val(Format(GridCase.TextMatrix(j, 2), "###0"))
         End If
         '總點數:dblTotPoint
         If Val(Format(GridCase.TextMatrix(j, 4), "###0")) > 0 Then
            dblTotPoint = dblTotPoint + Val(Format(GridCase.TextMatrix(j, 4), "###0"))
         End If
         'Add By Sindy 2025/4/14 規費有異常時,欄位變色
         If GridCase.TextMatrix(j, 16) <> "" Then
            GridCase.col = 3
            GridCase.row = j
            GridCase.CellBackColor = QBColor(14) '淡黃色
            Me.Check10.Value = 1
         Else
            GridCase.col = 2
            GridCase.row = j
            strExc(10) = GridCase.CellBackColor
            GridCase.col = 3
            GridCase.CellBackColor = strExc(10)
         End If
         '2025/4/14 END
      End If
   Next j
   If GetAllCaseCPM <> "" Then GetAllCaseCPM = Mid(GetAllCaseCPM, 2)
End Function

'Add By Sindy 2022/8/29
Private Sub GridCase_Click()
Dim m_intRow As Integer
Dim m_intCol As Integer

   m_intRow = GridCase.MouseRow
   m_intCol = GridCase.MouseCol
   If m_intRow <> 0 Then
      If GridCase.TextMatrix(m_intRow, 1) <> "" Then
         If ((Val(LblCnt) = 0 And Trim(Combo1(1).Text) <> "") Or ChkIsModify = True) Then
            If MsgBox("案件性質有異動，要放棄嗎？", vbYesNo + vbCritical) = vbNo Then
               Exit Sub
            Else
               Call cmdClear2_Click '清除
            End If
         End If
         Call GetGridCaseData(m_intRow)
      End If
   End If
End Sub
'取得資料視窗中的資料列欄位值
Private Sub GetGridCaseData(intRow As Integer)
Dim j As Integer, i As Integer

   '檢查目前那一列為反白列
   dblPrevRow = 0
   For j = 1 To GridCase.Rows - 1
      GridCase.col = 1
      GridCase.row = j
      If GridCase.CellBackColor <> QBColor(15) Then
         dblPrevRow = j
         Exit For
      End If
   Next j
   If dblPrevRow <> intRow Then
      '上一筆資料列清除反白
      If dblPrevRow > 0 And dblPrevRow <= (GridCase.Rows - 1) Then
         For i = 0 To GridCase.Cols - 1
            GridCase.col = i
            If GridCase.CellBackColor <> &H8080FF And GridCase.CellBackColor <> QBColor(14) Then
               GridCase.CellBackColor = QBColor(15)
            End If
         Next i
      End If
   End If
   If intRow <> 0 Then
      '目前資料列反白
      GridCase.col = 1
      GridCase.row = intRow
      dblPrevRow = GridCase.row
      'If GridCase.CellBackColor = QBColor(15) Then
         For i = 0 To GridCase.Cols - 1
            GridCase.col = i
            If GridCase.CellBackColor <> &H8080FF And GridCase.CellBackColor <> QBColor(14) Then
               GridCase.CellBackColor = &HFFC0C0
            End If
         Next i
      'End If
   End If
   If GridCase.TextMatrix(intRow, 1) <> "" Then
      LblCnt.Caption = GridCase.TextMatrix(intRow, 0) '順序
      Combo1(1).Text = Trim(GridCase.TextMatrix(intRow, 1)) '案件性質
      Combo1(1).Tag = Combo1(1).Text
      Text1(101).Text = Format(GridCase.TextMatrix(intRow, 2), "###0")  '費用
      Text1(101).Tag = Text1(101).Text
      Text1(102).Text = Format(GridCase.TextMatrix(intRow, 3), "###0") '規費
      Text1(102).Tag = Text1(102).Text
      Text1(103).Text = Format(GridCase.TextMatrix(intRow, 4), "###0.000") '點數
      Text1(103).Tag = Text1(103).Text
      Combo2(0).Text = GridCase.TextMatrix(intRow, 5) '備註
      Combo2(0).Tag = Combo2(0).Text
   End If
End Sub

'Add By Sindy 2022/8/29
Private Sub GridCase_SelChange()
Dim j As Integer, i As Integer

GridCase.Visible = False
If GridCase.MouseRow = 0 Then
   '已選取的資料列清除反白
   For j = 1 To GridCase.Rows - 1
      GridCase.col = 1
      GridCase.row = j
      If GridCase.CellBackColor <> QBColor(15) Then
         For i = 0 To GridCase.Cols - 1
            GridCase.col = i
            GridCase.CellBackColor = QBColor(15)
         Next i
         Exit For
      End If
   Next j
Else
   Call GetGridCaseData(GridCase.MouseRow)
'   '檢查目前那一列為反白列
'   dblPrevRow = 0
'   For j = 1 To GridCase.Rows - 1
'      GridCase.col = 1
'      GridCase.row = j
'      If GridCase.CellBackColor <> QBColor(15) Then
'         dblPrevRow = j
'         Exit For
'      End If
'   Next j
'   If dblPrevRow <> GridCase.MouseRow Then
'      '上一筆資料列清除反白
'      If dblPrevRow > 0 And dblPrevRow <= (GridCase.Rows - 1) Then
'         For i = 0 To GridCase.Cols - 1
'            GridCase.col = i
'            If GridCase.CellBackColor <> &H8080FF Then
'               GridCase.CellBackColor = QBColor(15)
'            End If
'         Next i
'      End If
'      '目前資料列反白
'      GridCase.col = 1
'      GridCase.row = GridCase.MouseRow
'      dblPrevRow = GridCase.row
'      If GridCase.CellBackColor = QBColor(15) Then
'         For i = 0 To GridCase.Cols - 1
'            GridCase.col = i
'            If GridCase.CellBackColor <> &H8080FF Then
'               GridCase.CellBackColor = &HFFC0C0
'            End If
'         Next i
'      End If
'   End If
End If
GridCase.Visible = True
End Sub

'Added by Lydia 2015/10/14
Private Sub cmdTMQ_Click()

   'Added by Lydia 2024/11/11 查名單(網中)
   If m_UseTmqTma = "2" Then
      nfrm090127_New.SetParent Me, , , pTMQList
      nfrm090127_New.stKeyUser = Trim(Text1(10)) '回傳智權人員
      If nfrm090127_New.IsRolePlay("查覆") = True Then
         '傳申請人(中文名稱) ->客戶名稱
         If "" & Text1(12).Text <> "" Then
            nfrm090127_New.contCusName = Trim(Text1(21).Text)
         Else
            nfrm090127_New.contCusName = ""
         End If
         nfrm090127_New.cmdExit.Caption = "確定(&X)"
         nfrm090127_New.cmdTo.Visible = False
         nfrm090127_New.cmdSendMail.Visible = False
         nfrm090127_New.cmdMaster(0).Visible = False
         nfrm090127_New.cmdMaster(1).Visible = False
         nfrm090127_New.Show
         Me.Hide
      End If
   Else
   'end 2024/11/11
      '注意專案是否有查名電子化的表單
      '後續卷宗區會用到frm090128
      '櫃台收文用frm090130
      Set frm090127.Tmpfrm090128 = frm090128 'Added by Lydia 2016/05/10
      'Modified by Lydia 2023/08/02
      'frm090127.SetParent Me
      frm090127.SetParent Me, , , pTMQList
      frm090127.stKeyUser = Trim(Text1(10)) 'Added by Lydia 2016/04/28 回傳智權人員
      If frm090127.IsRolePlay("查覆") = True Then
         'Added by Lydia 2015/11/16 傳申請人(中文名稱) ->客戶名稱
         If "" & Text1(12).Text <> "" Then
            frm090127.contCusName = Trim(Text1(21).Text)
         Else
            frm090127.contCusName = ""
         End If
         'end 2015/11/16
         
         frm090127.cmdExit.Caption = "確定(&X)" 'Added by Lydia 2016/05/10
         frm090127.cmdTo.Visible = False
         frm090127.cmdSendMail.Visible = False 'Added by Lydia 2016/04/29
         'frm090127.cmdDetail.Visible = False 'Remove by Lydia 2016/05/10
         'Modified by Lydia 2015/12/21
         frm090127.cmdMaster(0).Visible = False
         frm090127.cmdMaster(1).Visible = False
         frm090127.Show
         Me.Hide
      End If
   End If 'Added by Lydia 2024/11/11
End Sub

Private Sub GrdTMQ_Click()
Dim TmpRow As Integer
Dim inR As Integer
TmpRow = GrdTMQ.MouseRow

If TmpRow > 0 Then
   If GrdTMQ.TextMatrix(TmpRow, 0) = "V" Then
      '清空資料
      GrdTMQ.col = 0
      GrdTMQ.row = TmpRow
      GrdTMQ.Text = ""
      For inR = 0 To GrdTMQ.Cols - 1
         GrdTMQ.col = inR
         GrdTMQ.CellBackColor = QBColor(15)
      Next inR
   Else
      '目前資料列反白
      GrdTMQ.col = 0
      GrdTMQ.row = TmpRow
      'Modified by Lydia 2016/05/05
      'If PUB_MGridGetValue(tmpRow, "TMQ11", GrdTMQ) <> "" Then
      If TMQ_CtrRead = False Then
         GrdTMQ.Text = "V"
      'Modified by Lydia 2016/03/28 是否控制查覆完畢
      'Else
      Else
         If m_UseTmqTma = "1" Then 'Added by Lydia 2024/11/11
            If TMQ_CtrRead And Trim(PUB_MGridGetValue(TmpRow, "TMQ11", GrdTMQ)) = "" Then
               MsgBox "委查單" & PUB_MGridGetValue(TmpRow, "委查單號", GrdTMQ) & " 尚未查覆完畢,請洽查名人員 " & GetStaffName(PUB_MGridGetValue(TmpRow, "TMQ10", GrdTMQ)), vbCritical, "委查結果"
            End If
         End If  'Added by Lydia 2024/11/11
      End If
   End If
End If
End Sub
'Modify By Sindy 2022/12/23 + Optional strTQC01 As String = "" : 查名代號
Public Sub QueryTMQ(Optional strTQC01 As String = "")
Dim rsAD As New ADODB.Recordset
Dim inX As Integer
Dim inA As Integer
Dim strA1 As String
    'Added by Lydia 2016/04/18
    GrdTMQ.FixedCols = 0
    Call SetGrdTMQ(True)  'Modified by Lydia 2023/08/02 直接改成傳入變數+True
    'end 2016/04/18
    'Modified by Lydia 2023/08/02
    'If cmdTMQ.Tag <> "" Then
    '   strA1 = GetAddStr(cmdTMQ.Tag)
    If cmdTMQ.Tag <> "" Or pTMQList <> "" Then
       If cmdTMQ.Tag = "" Then  '取消查覆區的勾選
          strA1 = "'999'"
       Else
          strA1 = GetAddStr(cmdTMQ.Tag)
       End If
    'end 2023/08/02
       'Added by Lydia 2024/11/11 查名單(網中)
       If m_UseTmqTma = "2" Then
          strSql = "select 'V' v,tma26 as 文字檢索,decode(tma27,null,null,'(圖形檢索)') as 圖形檢索,tma18 as 客戶名稱," & _
                  " decode(tma25,'2',null,decode(tma19," & PUB_GetTMQans("3", True) & ", tma39)) as 文字檢索結果,decode(tma25,'1',null,decode(tma19," & PUB_GetTMQans("3", True) & ",tma41)) as 圖形檢索結果," & _
                  " decode(tma20,null,decode(tma22,null,decode(tma23,null,null,tma23||',')||decode(tma24,null,null,tma24||','),tma22||','),tma20) as 類別組群,tma33 as 智權備註,tma01" & _
                  " from tmqappform WHERE "
          If strTQC01 <> "" Then
             strSql = strSql & " tma01 in (select tqc03 from tmqcasemap where tqc01='" & strTQC01 & "' and tqc03<>'" & cntTQC自動記錄 & "') "
          Else
             strSql = strSql & " tma01 in (" & strA1 & ") "
          End If
          strSql = strSql & " ORDER BY TMA01 desc "
       Else
       'end 2024/11/11
            'Modified by Lydia 2016/01/27 排除整張不查的委查單
            'Modified by Lydia 2016/03/28 +控制TMQ_CtrRead
            'Modified by Lydia 2016/04/06 +控制TMQ_ReApp
            'Modified by Lydia 2016/06/02 覆核結果取代查名結果MIN(TQD06)=>MIN(NVL(TQD09,TQD06)),TMQ_結果查詢改成模組PUB_GetTMQans
            'Modified by Lydia 2018/03/20 用TMQ20判斷是否已刪除明細(+And nvl(tmq20,'N') = 'N') 'Remove by Lydia 2018/03/21 影響速度
            strSql = "select 'V' V,TMQ19 讀,DECODE(TQA06,'1',DECODE(TQA13,NULL,'(非正常字)',TQA13),'2','(圖形查詢)') 文字1,DECODE(TQA06,'1',DECODE(TQA14,NULL,DECODE(TQA08,NULL,'','(非正常字)'),TQA14),'2','') 文字2," & _
                    "TQA04 客戶名稱,decode(v1c2," & PUB_GetTMQans("3", True) & ") 結果, TMQ03 組群,TMQ01,TMQ11,TMQ10,TMQ20,TMQ21 " & _
                     "FROM TMQAPP,trademarkquery,(select tqd02 v1c1, MIN(NVL(TQD09,TQD06)) v1c2 from tmqdetail group by tqd02) VT1 " & _
                     "WHERE TQA01=TMQ18(+) and tmq01=v1c1(+) AND NOT(TMQ03 IS NULL) " & _
                     IIf(TMQ_ReApp = False, "and tmq21 is null ", "") & _
                     IIf(TMQ_CtrRead = True, "AND V1C2<" & CNULL(TMQ_不查), "")
            'Modify By Sindy 2022/12/23
            If strTQC01 <> "" Then
              'Modified by Lydia 2023/08/18 +排除記錄
              strSql = strSql & "and tmq01 in (select tqc03 from tmqcasemap where tqc01='" & strTQC01 & "' and tqc03<>'" & cntTQC自動記錄 & "') "
            Else
              strSql = strSql & "and tqa01 in (" & strA1 & ") "
            End If
            '2022/12/23 END
            'Modified by lydia 2016/04/18 改依日期降冪(最新的再上面)
            strSql = strSql & " ORDER BY TMQ18 desc,TMQ01 desc "
       End If
       inA = 1
       Set rsAD = ClsLawReadRstMsg(inA, strSql)
       If inA = 1 Then
          Set GrdTMQ.Recordset = rsAD
          'Modified by Lydia 2023/08/02 直接改成傳入變數
          'SetGrdTMQ (rsAD.RecordCount + 1)
          Call SetGrdTMQ(False, rsAD.RecordCount + 1)
          GrdTMQ.FixedCols = 4
       End If
    End If
End Sub

'Modified by Lydia 2023/08/02
'Private Sub SetGrdTMQ(Optional ByVal iR As Integer = 2)
Private Sub SetGrdTMQ(Optional ByVal bolReset As Boolean = False, Optional ByVal iCnt As Integer = 2)
   Dim arrGridHeadText, arrGridHeadWidth
   Dim iRow As Integer
   
   'Added by Lydia 2024/11/11 查名單(網中)
   If m_UseTmqTma = "2" Then
      arrGridHeadText = Array("V", "文字檢索", "圖形檢索", "客戶名稱", "文字結果", "圖形結果", "類別組群", "智權備註", "查名單號")
      arrGridHeadWidth = Array(200, 860, 860, 860, 860, 860, 1000, 1000, 1000)
   Else
   'end 2024/11/11
      arrGridHeadText = Array("V", "讀", "文字1", "文字2", "客戶名稱", "結果", "組群", "委查單號", "TMQ11", "TMQ10", "TMQ20", "TMQ21")
      arrGridHeadWidth = Array(200, 300, 860, 860, 800, 800, 860, 1000, 0, 0, 0, 0)
   End If 'Added by Lydia 2024/11/11
   GrdTMQ.Visible = False
   GrdTMQ.Cols = UBound(arrGridHeadText) + 1
   'Modified by Lydia 2023/08/02
   'GrdTMQ.Rows = iCnt
   If bolReset = True Then
      GrdTMQ.Clear
      GrdTMQ.Rows = 2
   End If
   'end 2023/08/02
   With GrdTMQ
        For iRow = 0 To .Cols - 1
           .row = 0
           .col = iRow
           .Text = arrGridHeadText(iRow)
           .ColWidth(iRow) = arrGridHeadWidth(iRow)
           .CellAlignment = flexAlignCenterCenter
        Next
        
        For intI = 1 To iCnt - 1
          .row = intI
          For iRow = 0 To 3
            .col = iRow
            .CellBackColor = QBColor(15)
          Next iRow
        Next intI
   End With
   GrdTMQ.Visible = True

End Sub
'end 2015/10/14

'Add by Amy 2015/11/02 原Label改為按鈕,顯示臺地址格式
Private Sub cmdTW_Click(Index As Integer)
    frm100135.Show vbModal
End Sub

Private Sub CheckComp()
    Dim stComp As String
    Dim stCompNo As String, strMsg As String 'Add by Amy 2016/09/01
    Dim intP As Integer 'Added by Lydia 2020/04/08
    
    'Modify by Amy 2016/09/01 改抓共用函數
    If Text1(6) <> "" And Text1(6) <> "L" And Text1(6) <> "LA" And Text1(6) <> "LIN" And Text1(6) <> "FCL" And Text1(6) <> "CFL" Then 'Added by Lydia 2021/07/12 排除法務案; ex.L-006408已將LC48=J公司拿掉
           stComp = "Y"
           stCompNo = GetReceiptCmp(Left(Text1(12), 8), Mid(Text1(12), 9, 1), Text1(6), Left(Combo1(0), 3), False, stComp, Me.Name)
    End If 'Added by Lydia 2021/07/12
    
    'Added by Lydia 2020/04/08 改用變數
    If stCompNo <> "" Then
        Select Case stCompNo
             Case "1": intP = m_Comp1forIdx
             Case "2": intP = m_Comp2forIdx
             Case "J": intP = m_CompJforIdx
             Case "L": intP = m_CompLforIdx
        End Select
    End If
    'end 2020/04/08
    
    Combo4.Tag = stCompNo '記錄客戶檔收據公司別
    'Modify by Amy 2020/01/16 +GetReceiptVal
    If GetReceiptVal(Combo4, False) <> stCompNo And stComp <> "" Then
        If Combo4 = MsgText(601) Then
            'Modified by Lydia 2020/04/08
            'Combo4.ListIndex = IIf(stCompNo = "J", 3, Val(stCompNo))
            Combo4.ListIndex = intP
        Else
            strMsg = "您輸入之收據公司別「" & Combo4 & "」與客戶檔設定值「" & stComp & "」不同" & vbCrLf & _
                            "是否依客戶檔設定覆蓋您的輸入值？"
            If MsgBox(strMsg, vbYesNo + vbCritical) = vbYes Then
                'Modified by Lydia 2020/04/08
                'Combo4.ListIndex = IIf(stCompNo = "J", 3, Val(stCompNo))
                Combo4.ListIndex = intP
            End If
        End If
    End If
    'end 2016/09/01
End Sub

Private Sub ChkZipData(ByVal intChoose As Integer, ByRef objTxt As Object, Optional ByRef stZipCode As String = "", Optional ByRef intArea As Integer = 0)
    Dim intZipIdx As Integer, intTabIdx As Integer  '地址相對應Zip欄位Index (Name要為Text1)/頁籤Index
    Dim strMsg As String, strAddr As String
    Dim intCount As Integer
    
     Select Case objTxt.Index
        Case 26
            strMsg = "申請人1 聯絡地址"
            intZipIdx = 25: intTabIdx = 0
        Case 27
            strMsg = "申請人1 申請地址"
            intZipIdx = 120: intTabIdx = 0
        Case 42
            strMsg = "申請人2 聯絡地址"
            intZipIdx = 41: intTabIdx = 1
        Case 43
             strMsg = "申請人2 申請地址"
            intZipIdx = 121: intTabIdx = 1
        Case 58
            strMsg = "申請人3 聯絡地址"
            intZipIdx = 57: intTabIdx = 2
        Case 59
             strMsg = "申請人3 申請地址"
            intZipIdx = 122: intTabIdx = 2
        Case 74
            strMsg = "申請人4 聯絡地址"
            intZipIdx = 73: intTabIdx = 3
        Case 75
            strMsg = "申請人4 申請地址"
            intZipIdx = 123: intTabIdx = 3
        Case 90
            strMsg = "申請人5 聯絡地址"
            intZipIdx = 89: intTabIdx = 4
        Case 91
            strMsg = "申請人5 申請地址"
            intZipIdx = 124: intTabIdx = 4
        Case Else
            intZipIdx = objTxt.Index
    End Select
    
    Select Case intChoose
        Case 0 '取代申請地址/郵遞區號=聯絡地址/郵遞區號
            objTxt = Text1(objTxt.Index - 1)
            If Text1(25 + intTabIdx * 16) <> MsgText(601) Then
                If Trim(Text1(120 + intTabIdx) <> MsgText(601)) And Left(Text1(120 + intTabIdx), 3) <> Left(Text1(25 + intTabIdx * 16), 3) Then
                    MsgBox strMsg & "郵遞區號有誤系統將自動更正！", , MsgText(5)
                End If
            End If
            Text1(120 + intTabIdx) = Text1(25 + intTabIdx * 16)
            intTWAddr(((objTxt.Index - 11) / 16) * 2) = intTWAddr(((objTxt.Index - 11) / 16) * 2 - 1)
        Case 1 'ZipCode多筆(同區/鄉 ZipCode不同)
            '且與畫面上欄位資料前3碼不同或空值,彈郵遞區號查詢畫面
            If InStr(stZipCode, Left(Trim(Text1(intZipIdx)), 3)) = 0 Or Trim(Text1(intZipIdx)) = MsgText(601) Then
                If Trim(Text1(intZipIdx)) <> MsgText(601) Then MsgBox strMsg & "郵遞區號有誤,請選擇正確郵遞區號！"
                Call frm100134.SetParent(Me)
                Me.Hide
                frm100134.BFormZip = "Text1(" & intZipIdx & ")"
                frm100134.GetStreet objTxt.Text, 1, intArea, stZipCode
                Call frm100134.QueryData
                frm100134.Show
                Exit Sub
            End If
        Case 2 'ZipCode非多筆
            '判斷抓到的郵遞區號是否與畫面上欄位資料前3碼相同
            If Left(Text1(intZipIdx), 3) <> stZipCode Then
                If Text1(intZipIdx) <> MsgText(601) Then MsgBox strMsg & "郵遞區號有誤,系統將自動更正！", , MsgText(5)
                Text1(intZipIdx) = stZipCode
            End If
        Case 3, 4, 5, 6 '抓不到ZipCode-3.區錯/4.只有路且郵遞區號為多筆/5.抓到2個字縣市,但多筆/6.舊客戶ZipCode多筆
            SSTab1.Tab = 1
            MsgBox strMsg & "無法解析郵遞區號，請由下一畫面選取！"
            Call frm100134.SetParent(Me)
            Me.Hide
            frm100134.BFormZip = "Text1(" & intZipIdx & ")"
            frm100134.GetStreet objTxt.Text, IIf(intChoose = 6, 2, intChoose), intArea, stZipCode
            Call frm100134.QueryData '(stZipCode)
            frm100134.Show
            Exit Sub
        Case 9 '設定頁籤
            SSTab1.Tab = 1
            SSTab2.Tab = intTabIdx
            If Text1(objTxt.Index).Enabled = True Then
                Text1(objTxt.Index).SetFocus
                Text1_GotFocus (objTxt.Index)
            End If
    End Select
End Sub

'Add by Amy 2015/11/13 +L及CFL 且案件性質選7501判決分析,開放Frame41欄位
Private Sub SetFrame41()
   'm_strCaseCPM = GetAllCaseCPM() 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   Frame41.Visible = False
   If (Text1(6) = "L" Or Text1(6) = "CFL") And ( _
       Left(Trim(Combo1(1)), 4) = "7501" Or InStr(m_strCaseCPM, "7501") > 0 _
      ) Then
'        (Left(Trim(Combo1(2)), 4) = "7501" And Trim(Combo1(2)) <> "") Or _
'       (Left(Trim(Combo1(3)), 4) = "7501" And Trim(Combo1(3)) <> "") Or (Left(Trim(Combo1(4)), 4) = "7501" And Trim(Combo1(4)) <> "")
      Frame41.Visible = True
   Else
      Option9(0).Value = False
      Option9(1).Value = False
   End If
End Sub

'Add By Sindy 2023/8/16
Private Sub SetFrame58()
   'Add By Sindy 2022/10/14
   Frame58.Visible = False '商品類別
   If Option1(0).Value = True Then
      If Text1(6).Text = "T" Or Text1(6).Text = "TF" Or Text1(6).Text = "CFT" Or _
         Text1(6).Text = "S" Or Text1(6).Text = "TS" Or Text1(6).Text = "TT" Then
         Frame58.Visible = True
      End If
   Else
   '2022/10/14 END
      If Text1(6).Text = "S" Or Text1(6).Text = "TS" Or Text1(6).Text = "TT" Then
         Frame58.Visible = True
      End If
   End If
End Sub

'Added by Lydia 2015/11/26 所有T*案之送件方改為勾選"收款後送件",可不勾選
'Modify By Sindy 2023/4/21 T*案要加指定送件日期
Private Sub SetFrame18()
   'Modify By Sindy 2024/1/22
'   OptSendType(0).Caption = "立即送件"
   If Text1(6).Text = "" Then Exit Sub
   ClsPDGetSystemKind Text1(6).Text, intI
   '所有法務案(L、CFL、FCL、LIN)、顧問案(LA)、創新業務(ACS)都不要顯示送件方式
   Frame18.Visible = False
   If intI = 專利 Or intI = 商標 Or intI = 5 Or intI = 6 Then
      Frame18.Visible = True
   End If
   '送件方式選項1的中文
   OptSendType(0).Caption = PUB_GetCP114Opt1Desc(Trim(Text1(6)), _
         m_strCaseCPM & IIf(Trim(Left(Trim(Combo1(1)), 4)) <> "", "," & Trim(Left(Trim(Combo1(1)), 4)), ""))
   '2024/1/22 END
   If Left(Text1(6), 1) = "T" Then
      'OptSendType(0).Caption = "不限制" 'Modify By Sindy 2023/12/12 mark,統一用立即送件
      
'      'Modify By Sindy 2024/1/16 T案且案件性質有延展102時，送件方式之「立即送件」選項的文字請改為「可辦期送件」。
'      If (Trim(Left(Trim(Combo1(1)), 4)) = "102" Or InStr(m_strCaseCPM, "102") > 0) Then
'         OptSendType(0).Caption = "可辦期送件"
'      End If
'      '2024/1/16 END
      
'      OptSendType(0).Value = True
'      Frame18.Visible = True

   'Add By Sindy 2010/11/22 送件方式
   'Modify by Morgan 2010/12/22 取消測試控制
   'If Pub_StrUserSt03 = "M51" And _
      Text1(6) = "P" And (arrCaseProperty(0) = "601" Or arrCaseProperty(0) = "605") Then
   ElseIf Text1(6) = "P" And _
      ((Trim(Left(Trim(Combo1(1)), 4)) = "601" Or InStr(m_strCaseCPM, "601") > 0) Or _
       (Trim(Left(Trim(Combo1(1)), 4)) = "605" Or InStr(m_strCaseCPM, "605") > 0)) Then
      
'      Frame18.Visible = True

      'OptSendType(0).Visible = True
      '本所期限到期
      If Val(Text1(3)) <> 0 And Val(Text1(3)) <= Val(strSrvDate(2)) Then
         'Add By Sindy 2022/11/4 急件
         Check11.Value = 1
         FrameCRL90.Enabled = False
         '2022/11/4 END
         OptSendType(0).Value = True
         OptSendType(1).Enabled = False
         OptSendType(2).Enabled = False
      Else
         'Modify by Morgan 2011/1/13 不要預設 --秀玲與電話副總確認後決定
         'OptSendType(1).Value = True
         OptSendType(0).Value = False
         OptSendType(1).Value = False
         OptSendType(2).Value = False
         'end 2011/1/13
         
         OptSendType(1).Enabled = True
         OptSendType(2).Enabled = True
         'Add By Sindy 2022/11/4 急件
         Check11.Value = 0
         FrameCRL90.Enabled = True
         '2022/11/4 END
      End If
   Else
      'Modify By Sindy 2023/12/12
      'Modified by Morgan 2024/1/18 原來可勾選的條件不變--杜協理
      'If strSrvDate(1) < 指定日期啟用日 Then
      '   Frame18.Visible = False
      'Else
      '   OptSendType(0).Value = True
      '   Frame18.Visible = True
      'End If
      
'      Frame18.Visible = False

      'end 2024/1/18
      '2023/12/12 END
   End If
End Sub

'Modify by Amy 2016/06/06 清除地址變數
Private Sub ClearAddrVar(ByVal intChoose As Integer, Optional ByVal idx As Integer = 0)
    Dim i As Integer
  
    Select Case intChoose
        '清intTWAddr全部
        Case 0
            For i = LBound(intTWAddr) To UBound(intTWAddr)
                intTWAddr(i) = 0
                strOldAddr(i) = ""
            Next i
        '清地址欄位未鎖住的intTWAddr變數
        Case 1
            'Mark by Amy 2024/08/29 原紙本用,電子連續收不設,避免連續輸國籍未存,導致後續判斷有誤 ex:113/08/27 丁浚評副理 連收9筆申請人香港之接洽單 第二筆一定要輸ID
            '收第一筆(單號1130018612)不清資料存檔時 intTWAddr(x)=10,再收第二筆(單號1130018614),CheckDataYN1 會把strNation設000
'            For i = 1 To 5
'                If Text1(26 + (i - 1) * 16).Enabled = True Then strOldAddr(i * 2 - 1) = Text1(26 + (i - 1) * 16): intTWAddr(i * 2 - 1) = 10
'                If Text1(27 + (i - 1) * 16).Enabled = True Then strOldAddr(i * 2) = Text1(27 + (i - 1) * 16): intTWAddr(i * 2) = 10
'            Next i
        Case 2
            intTWAddr(idx * 2 - 1) = 0: strOldAddr(idx * 2 - 1) = ""
            intTWAddr(idx * 2) = 0: strOldAddr(idx * 2) = ""
            Text1(26 + (idx - 1) * 16).Tag = MsgText(601)
            Text1(27 + (idx - 1) * 16).Tag = MsgText(601)
        'Add by Amy 2017/07/12 清 是否有客戶中文地址 的變數-舊案用
        Case 3
            For i = LBound(bolCusCAddr) To UBound(bolCusCAddr)
                bolCusCAddr(i) = False
            Next i
    End Select
End Sub

Private Sub SetCusZip(ByRef objTxt As Object)
    Dim strZipCode As String, strAddr As String, strCityN As String, strIndArea As String, strROC As String, strNewArea As String
    Dim bolMany As Boolean
    Dim intRecCount As Integer, intArea As Integer, intStatus As Integer
    
    If objTxt.Index Mod 2 = 0 Then
        'Modify by Amy 2021/3/11 02/23 以為是有申請地址但無郵遞區號的bug,但是此算錯位置的問題 原:(objTxt.Index - 26) / 16 + 1
        'ex:申請人1 輸 X83843 申請地址郵遞區號為空/申請人2 輸X37571 列印時會彈申請人1地址郵遞區號為空,當申請人2輸完跳離時,算出(objTxt.Index - 26) / 16 + 1=2
        intTWAddr(((objTxt.Index - 26) / 16) * 2 + 1) = 2
    Else
        intTWAddr(((objTxt.Index - 27) / 16 + 1) * 2) = 2
    End If
    strAddr = ReplaceAddrTW(objTxt.Text)
    strROC = ""
    If Left(strAddr, 4) = "中華民國" Then strROC = strROC & Left(strAddr, 4): strAddr = Mid(strAddr, 5)
    If Left(strAddr, 3) = "臺灣省" Or Left(strAddr, 3) = "台灣省" Then strROC = strROC & Left(strAddr, 3): strAddr = Mid(strAddr, 4)
    If Left(strAddr, 2) = "臺灣" Or Left(strAddr, 2) = "台灣" Then strROC = strROC & Left(strAddr, 2): strAddr = Mid(strAddr, 3)
    '去除xx工業區查(台中工業區/台塑工業園區不取代,可能抓錯zip)
    strIndArea = "True"
    strAddr = ReplaceIndArea(strAddr, strIndArea)
    If strIndArea = "True" Then strIndArea = MsgText(601)
    If Left(strAddr, 4) = "新竹新竹" And (strIndArea = "科學工業園區" Or strIndArea = "科學園區") Then
        strIndArea = "新竹" & strIndArea
        strAddr = Mid(strAddr, 3)
    End If
    '第3個字是 縣 / 市
AgainCheck1:
    intStatus = 2
    objTxt.Tag = ""
    If Mid(strAddr, 3, 1) = "市" Or Mid(strAddr, 3, 1) = "縣" Or Mid(strAddr, 1, 3) = "釣魚臺" Or Mid(strAddr, 1, 3) = "海南島" Then
        '第5 or 6個字是 市/區/鄉/鎮
        'Modify by Amy 2020/08/31 +判斷第七個字 ex:嘉義縣阿里山鄉 X80024
        If Mid(strAddr, 7, 1) = "市" Or Mid(strAddr, 7, 1) = "區" Or Mid(strAddr, 7, 1) = "鄉" Or Mid(strAddr, 7, 1) = "鎮" _
            Or Mid(strAddr, 6, 1) = "市" Or Mid(strAddr, 6, 1) = "區" Or Mid(strAddr, 6, 1) = "鄉" Or Mid(strAddr, 6, 1) = "鎮" _
            Or Mid(strAddr, 5, 1) = "市" Or Mid(strAddr, 5, 1) = "區" Or Mid(strAddr, 5, 1) = "鄉" Or Mid(strAddr, 5, 1) = "鎮" Then
            '傳入地址前6個字抓到郵遞區號
            intArea = 6
            strZipCode = GetPostZip(Left(strAddr, 6), 6, , , bolMany)
            '傳入地址前5個字取郵遞區號
            If strZipCode = MsgText(601) Then strZipCode = GetPostZip(Left(strAddr, 5), 5, , , bolMany): intArea = 5
            '抓到郵遞區號
            If strZipCode <> MsgText(601) Then
                If bolMany = False Then
                    '只有1筆,直接帶入
                    Call ChkZipData(2, objTxt, strZipCode, intArea)
                    intStatus = 1
                Else
                    '區/鄉/鎮 多筆+路名查
                    intRecCount = 1: strZipCode = "1"
                    frm100134.GetStreet strAddr, 2, intArea, , False
                    intRecCount = frm100134.CountQuery(1, strZipCode)
                    If intRecCount = 1 Then
                        '只有1筆,直接帶入
                        Call ChkZipData(2, objTxt, strZipCode, intArea)
                        intStatus = 1
                    ElseIf intRecCount > 1 Then
                        intStatus = 3
                        objTxt.Tag = strZipCode
                    End If
                End If
            '沒抓到郵遞區號
            Else
                '以 縣/市 +路查
                intRecCount = 1: strZipCode = "1"
                frm100134.GetStreet strAddr, 2, intArea, , False
                intRecCount = frm100134.CountQuery(2, strZipCode)
                If intRecCount = 1 Then
                    '只有1筆,直接帶入
                    Call ChkZipData(2, objTxt, strZipCode, intArea)
                    intStatus = 1
                ElseIf intRecCount > 1 Then
                    intStatus = 4
                    objTxt.Tag = strZipCode
                End If
            End If
        '無 鄉/鎮/市/區
        Else
            '以路/街 抓是否有zip
            strZipCode = GetZipCode_Tai(2, strAddr, intArea, bolMany, strNewArea)
            If strZipCode <> MsgText(601) Then
                If bolMany = False Then
                    '只有1筆,直接帶入
                    Call ChkZipData(2, objTxt, strZipCode, intArea)
                    intStatus = 1
                Else
                    intStatus = 5
                    objTxt.Tag = strZipCode
                End If
            End If
        End If
        objTxt.Tag = strAddr
        If objTxt.Index Mod 2 = 0 Then
            'Modify by Amy 2021/03/11 02/23 以為是有申請地址但無郵遞區號的bug,但是此算錯位置的問題 原:(objTxt.Index - 26) / 16 + 1
            intTWAddr(((objTxt.Index - 26) / 16) * 2 + 1) = intStatus
        Else
            intTWAddr(((objTxt.Index - 27) / 16 + 1) * 2) = intStatus
        End If
    '第三3個字無 縣 / 市
    Else
        '傳入地址前2個字判斷是否有其縣/市
        strCityN = "Pzd02"
        strZipCode = GetPostZip(Left(strAddr, 2), 2, 1, , bolMany, "Pzd02", strCityN)
        If strZipCode <> MsgText(601) Then
            If bolMany = False Then
                '只有一筆
                strAddr = strCityN & Mid(strAddr, 3)
                GoTo AgainCheck1
            End If
        End If
    End If
End Sub

'Added by Lydia 2016/03/21 增加查名單輸入
Private Sub cmdTMQApp_Click()
   
   'Added by Lydia 2024/11/11 查名單(網中)
   If m_UseTmqTma = "2" Then
      nfrm090126_New.SetParent Me, "", Trim(Text1(10))
      nfrm090126_New.Show
      Me.Hide
   Else
   'end 2024/11/11
      If TypeName(Tmpfrm090126) <> "Nothing" Then
          Tmpfrm090126.SetParent Me
          Tmpfrm090126.stKeyUser = Trim(Text1(10)) 'Added by Lydia 2016/04/28 回傳智權人員
          Tmpfrm090126.Show
          Me.Hide
      End If
   End If 'Added by Lydia 2024/11/11
End Sub

'Added by Lydia 2016/04/26 判斷查名單對應
'Modified by Lydia 2023/08/02 改成傳入變數
'Private Function GetTMQList() As Boolean
Private Function GetTMQList(ByRef m_TMQList As String, Optional ByVal bolShow As Boolean = False) As Boolean
Dim inJ As Integer, inK As Integer
'Dim strCase As String 'Remove by Lydia 2021/11/23
 
GetTMQList = False
   
   'Modified by Lydia 2023/08/02
   'TMQList = "" ': mTQC01 = "" 'Remove by Lydia 2016/05/05
   m_TMQList = ""
   
   'Remove by Lydia 2021/11/23
   'strCase = IIf(Trim(Left(Trim(Combo1(1)), 4)) <> "", Trim(Left(Trim(Combo1(1)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(2)), 4)) <> "", Trim(Left(Trim(Combo1(2)), 4)), "") & _
            "," & IIf(Trim(Left(Trim(Combo1(3)), 4)) <> "", Trim(Left(Trim(Combo1(3)), 4)), "") & "," & IIf(Trim(Left(Trim(Combo1(4)), 4)) <> "", Trim(Left(Trim(Combo1(4)), 4)), "")
   'Modified by Lydia 2016/04/25 +TS案
   'Modified by Lydia 2023/08/02 FRTMQ.Visible = True=> (FRTMQ.Visible = True Or bolShow = True)
   If strSrvDate(1) >= TMQ電子化啟用日 And _
      Option1(0).Value = True And (Text1(6).Text = "T" Or Text1(6).Text = "TS") And _
      Text1(7).Text = "" And Text1(8).Text = "" And (FRTMQ.Visible = True Or bolShow = True) Then
     '過濾案件性質
     'Modified by Lydia 2021/11/23
     'If Left(Trim(Combo1(0)), 3) <> "000" Or (Text1(6).Text = "T" And InStr(strCase, TMQ_T案) = 0) Or (Text1(6).Text = "TS" And InStr(strCase, TMQ_TS案) = 0) Then
     If GetTMQArea = False Then
        FRTMQ.Visible = False
     Else
        If GrdTMQ.Rows >= 2 Then
           'Added by Lydia 2024/11/11 查名單(網中)
           If m_UseTmqTma = "2" Then
              inJ = PUB_MGridGetId("查名單號", GrdTMQ)
           Else
           'end 2024/11/11
              inJ = PUB_MGridGetId("委查單號", GrdTMQ)
           End If 'Added by Lydia 2024/11/11
           For inK = 1 To GrdTMQ.Rows - 1
              'Modified by Lydia 2023/08/02
              'If GrdTMQ.TextMatrix(inK, 0) = "V" Then
              If GrdTMQ.TextMatrix(inK, 0) = "V" Or bolShow = True Then
                 '是否控制已讀(TMQ_CtrRead)
                 If TMQ_CtrRead And GrdTMQ.TextMatrix(inK, 1) = "" Then
                    MsgBox "委查單: " & GrdTMQ.TextMatrix(inK, inJ) & " 尚未讀取查覆結果!", vbCritical
                    Exit Function
                 End If
                 'Remove by Lydia 2016/04/28
                 'If TMQ_CtrRead And PUB_MGridGetValue(inK, "TMQ20", GrdTMQ) <> "" Then
                 '   MsgBox "委查單: " & GrdTMQ.TextMatrix(inK, inJ) & " 已有業務收文!", vbCritical
                 '   Exit Function
                 'End If
                 '判斷是否可重複收文(TMQ_ReApp)
                 'Mark by Lydia 2023/08/02 上線後,一直沒有啟用這項控制
                 'If TMQ_ReApp = False And PUB_MGridGetValue(inK, "TMQ21", GrdTMQ) <> "" Then
                 '   MsgBox "委查單: " & GrdTMQ.TextMatrix(inK, inJ) & " 已收文，不可再次收文!", vbCritical
                 '   Exit Function
                 'End If
                 'end 2023/08/02
                 'Modified by Lydia 2023/08/02
                 'If InStr(TMQList, Trim(GrdTMQ.TextMatrix(inK, inJ))) = 0 Then
                 '   TMQList = TMQList & Trim(GrdTMQ.TextMatrix(inK, inJ)) & ","
                 If InStr(m_TMQList, Trim(GrdTMQ.TextMatrix(inK, inJ))) = 0 Then
                    m_TMQList = m_TMQList & Trim(GrdTMQ.TextMatrix(inK, inJ)) & ","
                 'end 2023/08/02
                 End If
              End If
           Next inK
        End If
        '提示
        'Modified by Lydia 2016/09/22 + 不查名，請逕提出申請
        'If TMQList = "" Then
        'Modified by Lydia 2023/08/02
        'If TMQList = "" And Option6(4).Value = False Then
        If m_TMQList = "" And Option6(4).Value = False And InStr(cmdOK(0).Caption, "存檔") > 0 Then
           'Modified by Lydia 2016/05/10
           'If MsgBox("是否要勾選查名單" & IIf(cmdTMQApp.Visible = True, "或填寫查名單", "") & "?", vbYesNo + vbDefaultButton1) = vbYes Then
           If MsgBox("請進查覆區勾選查名單" & IIf(cmdTMQApp.Visible = True, "或查名單輸入", "") & "?", vbYesNo + vbDefaultButton1) = vbYes Then
              SSTab1.Tab = 4
              Exit Function
           End If
        End If
     End If
   End If
   
   'Remove by Lydia 2016/05/10 改回每列印一次,給一次號碼
   'Added by Lydia 2016/05/05
   'If pTMQList <> "" And TMQList = pTMQList Then
   '   inJ = MsgBox("是否重新列印?　(否：另一案件列印)", vbInformation + vbYesNoCancel + vbDefaultButton3)
   '   If inJ = 2 Then 'Cancel
   '       Exit Function
   '   ElseIf inJ = 7 Then 'No
   '        mTQC01 = ""
   '   End If
   'Else
   '   mTQC01 = ""
   'End If
   'end 2016/05/05
   
   'Added by Lydia 2024/11/11 查名單(網中)
   If TypeName(m_PrevForm) = "frm090128_New" Then
      m_PrevForm.mbolCall = True
      Unload nfrm090127_New
   Else
   'end 2024/11/11
      'Added by Lydia 2016/05/10 從查覆明細按收文
      'Modified by Lydia 2023/08/02 變數改用途 =>拿掉pTMQList <> "" And
      If TypeName(m_PrevForm) = "frm090128" Then
         m_PrevForm.mbolCall = True
         Unload frm090127
      End If
      'mTQC01 = "" 'Mark by Lydia 2023/08/02 不可清空=>因為要保留待收文區的查名單勾選
   End If 'Added by Lydia 2024/11/11
GetTMQList = True
End Function

'Added by Lydia 2016/05/27 CFP控制年費.延展費及維持費智權同仁可加的點數
Private Sub CheckCFP605to607()
Dim intJ As Integer
   
   For intJ = 1 To GridCase.Rows - 1 '4
      If Trim(Left(Trim(GridCase.TextMatrix(intJ, 1)), 4)) <> "" And _
         ((Trim(Left(Trim(GridCase.TextMatrix(intJ, 1)), 4)) = "605" And Val(Format(Trim(GridCase.TextMatrix(intJ, 4)), "###0.000")) > CFP_dg605) Or _
          (Trim(Left(Trim(GridCase.TextMatrix(intJ, 1)), 4)) = "606" And Val(Format(Trim(GridCase.TextMatrix(intJ, 4)), "###0.000")) > CFP_dg606) Or _
          (Trim(Left(Trim(GridCase.TextMatrix(intJ, 1)), 4)) = "607" And Val(Format(Trim(GridCase.TextMatrix(intJ, 4)), "###0.000")) > CFP_dg607) _
         ) Then
         'Modified by Lydia 2018/06/04 +lcv06
         'If PUB_GetLCV04LCV10(Trim(Text1(6)), Trim(Text1(7)), Trim(Text1(8)), Trim(Text1(9)), Trim(Left(Trim(Combo1(intJ)), 4)), strExc(2), strExc(3), strExc(4), strExc(5)) Then
         If PUB_GetLCV04LCV10(Trim(Text1(6)), Trim(Text1(7)), Trim(Text1(8)), Trim(Text1(9)), _
               Trim(Left(Trim(GridCase.TextMatrix(intJ, 1)), 4)), strExc(2), strExc(3), strExc(4), strExc(5), strExc(6)) Then
            
            '不需主管簽核或主管不同意調整
            If strExc(4) <> "Y" Or strExc(3) = "0" Then
                'Modified by Lydia 2018/06/04  (ex.CFP-23599已進入國家階段的年費,各國調整不超過5點不需主管簽核,改用智權人員報價來比對)
                'If Val(Trim(Text1(100 + 3 * intJ))) > Val(strExc(2)) Then
                If Val(Format(Trim(GridCase.TextMatrix(intJ, 4)), "###0.000")) > IIf(strExc(4) = "" And Val(strExc(6)) > 0, Val(strExc(6)), Val(strExc(2))) Then
                   'MsgBox "年費(605)超過" & CFP_dg605 & "點，維持費(606)及延展費(607)超過" & CFP_dg606 & "點，請交主管簽核方可收文！", vbCritical, "控制點數"
                   Select Case Trim(Left(Trim(GridCase.TextMatrix(intJ, 1)), 4))
                       Case "605": strExc(1) = Mid(Trim(GridCase.TextMatrix(intJ, 1)), 5) & "(605)超過" & CFP_dg605 & "點"
                       Case "606": strExc(1) = Mid(Trim(GridCase.TextMatrix(intJ, 1)), 5) & "(606)超過" & CFP_dg606 & "點"
                       Case "607": strExc(1) = Mid(Trim(GridCase.TextMatrix(intJ, 1)), 5) & "(607)超過" & CFP_dg607 & "點"
                   End Select
                  m_Msgbox = "(" & intJ & ") " & strExc(1)
'                  MsgBox m_Msgbox & "，呈主管簽核方可收文！", vbCritical, "控制點數"
'                   strMemoPrt = strMemoPrt & vbCrLf & "(" & intJ & ") " & strExc(1) & "，請交主管簽核方可收文!"
                  'Add By Sindy 2022/9/14
                  If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
                     txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
                  End If
                  '2022/9/14 END
                End If
            '有主管簽核
            ElseIf strExc(4) = "Y" Then
                If Val(Format(Trim(GridCase.TextMatrix(intJ, 4)), "###0.000")) <= Val(strExc(3)) Then '輸入點數<主管簽核點數
                  'strMemoPrt = strMemoPrt & vbCrLf & "(" & intJ & ") " & GetStaffName(strExc(5)) & "核可收文" & strExc(3) & "點"
                  m_Msgbox = "(" & intJ & ") " & GetStaffName(strExc(5)) & "核可收文" & strExc(3) & "點"
                  'Add By Sindy 2022/9/14
                  If InStr(txtCRL70.Text, m_Msgbox) = 0 Then
                     txtCRL70.Text = txtCRL70.Text & m_Msgbox & vbCrLf
                  End If
                  '2022/9/14 END
                Else '輸入點數>主管簽核點數
                  m_Msgbox = "(" & intJ & ") " & "已超過" & GetStaffName(strExc(5)) & "核可收文" & strExc(3) & "點"
'                  MsgBox m_Msgbox & "，再呈主管簽核方可收文！", vbCritical, "控制點數"
'                   strMemoPrt = strMemoPrt & vbCrLf & "(" & intJ & ") 已超過" & GetStaffName(strExc(5)) & "核可收文" & strExc(3) & "點，請再交主管簽核方可收文!"
                  'Add By Sindy 2022/9/14
                  If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
                     txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
                  End If
                  '2022/9/14 END
                End If
            End If
         End If
      End If
      'Added by Lydia 2020/11/19 英國脫歐案管制：CFP視做舊案，依然要判斷613延展(英國)的點數不可超過控制； 因為不確定實際作法，先以畫面輸入為準。
      If Trim(Left(Trim(GridCase.TextMatrix(intJ, 1)), 4)) = "613" And Val(Format(Trim(GridCase.TextMatrix(intJ, 4)), "###0.000")) > CFP_dg607 Then
         Call ClsPDGetCaseProperty(Text1(6), "607", strExc(0))
         m_Msgbox = "(" & intJ & ") " & strExc(0) & "(607)超過" & CFP_dg607 & "點"
'         MsgBox m_Msgbox & "，呈主管簽核方可收文！", vbCritical, "控制點數"
'           strMemoPrt = strMemoPrt & vbCrLf & strExc(1)
         'Add By Sindy 2022/9/14
         If InStr(txtCRL69.Text, m_Msgbox) = 0 Then
            txtCRL69.Text = txtCRL69.Text & m_Msgbox & vbCrLf
         End If
         '2022/9/14 END
      End If
      'end 2020/11/19
   Next intJ
   
End Sub

'Add by Amy 2016/06/06 +專利設計案案件性質
Private Sub SetCombo5_P()
    If InStr(Text1(6), "P") = 0 Then Exit Sub
    
    '當專利種類由1、2變3 或3變1、2 時重抓案件屬性
    If Combo6.Tag <> Combo6.Text Then
'    If ((Combo6.Tag = MsgText(601) Or Left(Combo6.Tag, 1) = "1" Or Left(Combo6.Tag, 1) = "2") And Left(Combo6, 1) = "3") _
'      Or (Left(Combo6.Tag, 1) = "3" And (Left(Combo6, 1) = "1" Or Left(Combo6, 1) = "2")) Then
        'Add By Sindy 2022/12/27
        If Combo5.Text <> "" Then
            Combo5.Tag = Combo5.Text
        Else
            Combo5.Tag = ""
        End If
        '2022/12/27 END
        
        Call PUB_AddCaseAttributeCombo(Combo5, Left(Combo6, 1)) '專利案件屬性選單 Modify By Sindy 2020/3/10
        
        'Add By Sindy 2022/12/27
        If Combo5.Tag <> "" Then
            'Add By Sindy 2023/4/20
            If Val(Left(Combo5.Tag, 1)) - 1 <= Combo5.ListCount - 1 Then
            '2023/4/20 END
               Combo5.ListIndex = Val(Left(Combo5.Tag, 1)) - 1
            End If
        End If
        '2022/12/27 END
'        Combo5.Clear
'        If Left(Combo6, 1) = "3" Then
'            Combo5.AddItem ""
'            Combo5.AddItem "1.整體"
'            Combo5.AddItem "2.部分"
'            Combo5.AddItem "3.圖像"
'            Combo5.AddItem "4.成組"
'        Else
'            Combo5.AddItem ""
'            Combo5.AddItem "1.機械"
'            Combo5.AddItem "2.電子電機"
'            Combo5.AddItem "3.化學生醫"
'        End If
    End If
End Sub

Private Function ChkIsNumeric(ByVal stZip As String) As Boolean
    Dim j As Integer
    
    ChkIsNumeric = False
    If Trim(stZip) = MsgText(601) Then Exit Function
    
    For j = 1 To Len(stZip)
        If Not IsNumeric(Mid(stZip, j, 1)) Then Exit Function
    Next j
    ChkIsNumeric = True
End Function

'Added by Morgan 2016/7/20
Private Sub Combo1_Change(Index As Integer)
   If Index = 0 Then
      stCountry = ""
   End If
End Sub

'Add by Amy 2016/09/01 卷宗性質
Private Function GetTM28() As String
    Dim RsQ As New ADODB.Recordset
    Dim strQ As String, intQ As Integer
    
    GetTM28 = ""
    strQ = "Select TM28 From TradeMark Where tm01='" & Text1(6) & "' And tm02='" & Text1(7) & "' And tm03='" & Text1(8) & "' And tm04='" & Text1(9) & "' "
    intQ = 1
    Set RsQ = ClsLawReadRstMsg(intQ, strQ)
    If intQ = 1 Then
       GetTM28 = "" & RsQ.Fields("TM28")
    End If
    Set RsQ = Nothing
End Function

'Add by Amy 2018/08/09 以承辦人抓其主管 st52且在職,抓到有值或 st52=null 為止
Private Function GetAllST52(ByVal stCP14 As String, ByRef m_CP14) As Boolean
    Dim RsQ As New ADODB.Recordset
    Dim strQ As String, strST52 As String
    Dim intQ As Integer
    
    GetAllST52 = False
    strQ = "Select st01,st52,st04 From Staff Where st01="
    Do While stCP14 <> MsgText(601)
        intQ = 1
        Set RsQ = ClsLawReadRstMsg(intQ, strQ & "'" & stCP14 & "'")
        If intQ = 1 Then
            '離職
            If "" & RsQ.Fields("st04") = "2" Then
                'st52 為null 會離開回圈
                stCP14 = "" & RsQ.Fields("st52")
            Else
                stCP14 = "": m_CP14 = "" & RsQ.Fields("st01")
                GetAllST52 = True
            End If
        End If
    Loop
    Set RsQ = Nothing
End Function

'Added by Lydia 2018/12/10 檢查匯入的查名單是否齊備
Private Function ChkTMQList(ByVal mList As String) As Boolean
Dim stCon As String
Dim stMid As String

    If Frame42.Visible = True Then
       ChkTMQList = True
       If Option6(3).Value = True And OptCP143(0).Value = True Then '尚待查名+查名已齊備
           MsgBox "尚待查名和查名已齊備兩者結果為相反 !"
           GoTo ExitProc
       ElseIf mList <> "" And (OptCP143(0).Value = True Or Option6(0).Value = True Or Option6(1).Value = True Or Option6(2).Value = True) Then   '匯入查名單+查名已齊備/已查名...
            stMid = PUB_TMQchkCP143(mList)
            If stMid = "N" Then
               If OptCP143(0).Value = True Then
                   stCon = "查名已齊備"
                   OptCP143(0).Value = False
               ElseIf Option6(0).Value = True Then
                   stCon = Option6(0).Caption
               ElseIf Option6(1).Value = True Then
                   stCon = Option6(1).Caption
               ElseIf Option6(2).Value = True Then
                   stCon = Option6(2).Caption
               End If
               If stCon <> "" Then
                     MsgBox "勾選的查名單尚未查覆完畢，請勿勾選: " & stCon & " !"
                     GoTo ExitProc
               End If
            End If
       End If
    Else
       ChkTMQList = True
    End If
    
    Exit Function
    
ExitProc:
SSTab1.Tab = 2
SSTab3.Tab = 0
ChkTMQList = False

End Function

'Added by Lydia 2019/04/10 提醒及列印顧問服務件數
Private Sub SetLAdata()
'填寫接洽單時，若輸入為LA之舊案時，
'在本所案號欄跳離時讀取下列資訊顯示訊息給操作者，
'同時列印在接洽單上。
'抓該案號最大收文日且未取消收文的顧問聘任(CP10='0')
'依其聘任期間(CP53~CP54)，再抓該案號於聘任期間A類且未收費之收文，
'累計次數及工作時數(CP113)顯示訊息：
'聘任期間：民國年/月/日~民國年/月/日, 已服務  次,  工時(PS: 工時為0時不顯示)
Dim rsB As New ADODB.Recordset
Dim intB As Integer
Dim strB1 As String
Dim pCP15 As String, pCP53 As String, pCP54 As String, pWHours As String, pWTimes As String 'Added by Lydia 2024/04/15
Dim dTotRvFee As Double 'Added by Lydia 2025/07/04

On Error GoTo ErrHandle

m_LAmsg = ""
m_LAchk = "" 'Added by Lydia 2024/04/15

If Option1(1).Value = True And Text1(6).Text = "LA" And Len(Trim(Text1(7).Text)) = 6 Then
    'Modified by Lydia 2024/04/15 改成模組
    'strB1 = "select c1.cp09,substr(sqldatet(c1.cp53),1,9) cp53t,substr(sqldatet(c1.cp54),1,9) cp54t,sum(x02) x02,sum(x03) x03 from caseprogress c1" & _
                  ",(select cp09 as x00,cp05 as x01, 1 as x02,nvl(cp113,0) as x03 from caseprogress where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Left(Text1(8) & "0", 1) & "' and cp04='" & Left(Text1(9) & "00", 2) & "' and substr(cp09,1,1)='A' and nvl(cp18,0)=0) x1 " & _
                  "where c1.cp09 in ( " & _
                  "select substr(max(cp05||cp09),9,9) mno from caseprogress where cp01='" & Text1(6) & "' and cp02='" & Text1(7) & "' and cp03='" & Left(Text1(8) & "0", 1) & "' and cp04='" & Left(Text1(9) & "00", 2) & "' and cp10='0' and cp158=0 and cp159=0 " & _
                   ") and x01>=c1.cp53 and x01<=c1.cp54 group by c1.cp09,substr(sqldatet(c1.cp53),1,9) ,substr(sqldatet(c1.cp54),1,9) "
    'intB = 1
    'Set rsB = ClsLawReadRstMsg(intB, strB1)
    'If intB = 1 Then
     '   'Modified by Lydia 2019/08/12 + ""
     '   If "" & rsB.Fields("cp53t") <> "" And "" & rsB.Fields("cp54t") <> "" Then
     '       m_LAmsg = "聘任期間：" & rsB.Fields("cp53t") & "~" & rsB.Fields("cp54t")
     '       m_LAmsg = m_LAmsg & ", 已服務 " & rsB.Fields("x02") & " 次"
     '       If Val("" & rsB.Fields("x03")) > 0 Then m_LAmsg = m_LAmsg & ", 工時： "
     '       MsgBox m_LAmsg, vbInformation, "顧問服務件數"
     '       'Added by Lydia 2021/02/22 加入備註; ex. LA-003219於109/1/9已有顧問聘任期間(輸錯109/2/1~111/1/31)，又於110/1/20重複顧問聘任期間
     '       If InStr(Text1(119), m_LAmsg) = 0 Then
     '           Text1(119) = Text1(119) & IIf(Text1(119) <> "", vbCrLf & vbCrLf, "") & m_LAmsg & vbCrLf
     '       End If
     '       'end 2021/02/22
     '   End If
    'End If
    If Pub_GetLAforTimes(Text1(6), Text1(7), Text1(8), Text1(9), pCP53, pCP54, pCP15, pWHours, pWTimes) = True Then
       m_LAchk = "總工作時數已達簽約時數，不可再收文！" 'Added by Lydia 2025/07/04

       m_LAmsg = "聘任期間：" & pCP53 & "~" & pCP54
       If Val(pCP15) > 0 Then
          m_LAmsg = m_LAmsg & ", 簽約時數： " & pCP15 & vbCrLf
       End If
       m_LAmsg = m_LAmsg & ", 已服務： " & pWTimes & " 次"
       If Val(pWHours) > 0 Then m_LAmsg = m_LAmsg & ", 工時： " & pWHours
       
       '顧問服務管制:若本次簽約有簽約時數CP15有值時，也要做已服務時數及簽約時數的管制及提醒；參考ACS智財顧問112的控制。
       If Val(pCP15) > 0 And Val(pWHours) >= Val(pCP15) Then
          'Modified by Lydia 2025/07/04 若簽約時數或次數超過，增加1,2點判斷：
          'm_LAchk = "總工作時數已達簽約時數，不可再收文！"
          'm_LAmsg = m_LAmsg & vbCrLf & m_LAchk
          '先清除前一次的備註
          If InStr(Text1(119), m_LAchk) > 0 And m_LAchk <> "" Then
             Text1(119) = Replace(Text1(119), vbCrLf & m_LAchk, "")
          End If
          If InStr(Text1(119), m_LAmsg) > 0 And m_LAmsg <> "" Then
             Text1(119) = Replace(Text1(119), vbCrLf & vbCrLf & m_LAmsg & vbCrLf, "")
             Text1(119) = Replace(Text1(119), m_LAmsg & vbCrLf, "")
          End If
          strB1 = "," & GetAllCaseCPM(, , , , , dTotRvFee) & ","
          If InStr(strB1, ",0,") > 0 And strB1 <> "" Then '0顧問聘任
             '目前有收文0顧問聘任，不受時數或次數超過限制
             strB1 = "1"
             m_LAchk = ""
             '不用列印時數和次數
             m_LAmsg = ""
          ElseIf dTotRvFee > 0 Then
             '若有收費，則訊息印在接洽單上(也要提醒)，但仍可收文
             strB1 = "2"
             m_LAchk = ""
          Else
             strB1 = "3"
          End If
          If m_LAchk <> "" Then m_LAmsg = m_LAmsg & vbCrLf & m_LAchk
          'end 2025/07/04
       End If
       'Added by Lydia 2025/07/07 沒有簽約時數或未超出; ex.LA-003234
       If Val(pCP15) = 0 Or (Val(pCP15) > 0 And Val(pWHours) < Val(pCP15)) Then
           m_LAchk = ""
       End If
       'end 2025/07/07
       
       'Modified by Lydia 2025/07/04 判斷非0顧問聘任，彈訊息; +If strB1 <> "1" Then
       If strB1 <> "1" Then MsgBox m_LAmsg, vbInformation, "顧問服務件數"
       
       If InStr(Text1(119), m_LAmsg) = 0 And m_LAmsg <> "" Then
          Text1(119) = Text1(119) & IIf(Text1(119) <> "", vbCrLf & vbCrLf, "") & m_LAmsg & vbCrLf
       End If
    End If
    'end 2024/04/15
    
    Set rsB = Nothing
End If

'Added by Lydia 2019/08/13
    Exit Sub
    
ErrHandle:
    If Err.Number <> 0 Then
        MsgBox Err.Description, "提醒顧問服務件數" '及列印
        Resume Next
    End If
'end 2019/08/13
End Sub


'Added by Lydia 2019/09/11 CFP回覆代理人902,CFP其他翻譯927;P補文件202,P自請撤回413,P保密審查430：以上條件有輸本所期限, 可以不必輸法定期限。
Private Function CheckCP06CP07(ByRef bolCancel As Boolean) As Boolean
Dim intQ As Integer
Dim bolChk As Boolean
Dim arrCP10() As String, strCP10 As String
   
   If Text1(6) <> "P" And Text1(6) <> "CFP" Then Exit Function
   
   m_strCaseCPM = GetAllCaseCPM() 'Add By Sindy 2022/8/29 取得案件性質代碼
   arrCP10() = Split(m_strCaseCPM, ",")
   
   'For intQ = 1 To 4
   For intQ = LBound(arrCP10) To UBound(arrCP10)
      strCP10 = arrCP10(intQ)
      'If Trim(Combo1(intQ).Text) <> "" Then
         'Memo by Lydia 2019/09/12 + P及CFP的911補收款; P的908代辦退費
         If Text1(6) = "P" Then
            'If InStr("202,413,430,911,908", Trim(Left(Combo1(intQ).Text, 4))) = 0 Then
            If InStr("202,413,430,911,908", strCP10) = 0 Then
               Exit Function
            Else
               bolChk = True
            End If
         ElseIf Text1(6) = "CFP" Then
            'If InStr("902,927,911", Trim(Left(Combo1(intQ).Text, 4))) = 0 Then
            If InStr("902,927,911", strCP10) = 0 Then
               Exit Function
            Else
               bolChk = True
            End If
         End If
      'End If
   Next intQ
   
   If bolChk = True Then
      CheckCP06CP07 = True
      bolCancel = True
      
      If Val(Text1(1)) <> 0 Or Val(Text1(3)) <> 0 Then  '有輸本所期限, 可以不必輸法定期限
         If Val(Text1(1)) <> 0 And Val(Text1(3)) = 0 Then '有輸法定期限, 必輸本所期限
            MsgBox "本所期限" & MsgText(52), vbExclamation
            SSTab1.Tab = 0
            Text1(3).SetFocus
            Exit Function
         End If
      End If
      If Val(Text1(1)) <> Val(strSrvDate(2)) Then
         If Val(Text1(3)) > Val(Text1(1)) And Val(Text1(1)) > 0 Then
            SSTab1.Tab = 0
            'Modify By Sindy 2023/3/29
            If Text1(3).Enabled = False Then
               MsgBox "提醒！本所期限大於法定期限。" & vbCrLf & _
                      "（回掉訊息後，可繼續操作。）", vbExclamation
            Else
            '2023/3/29 END
               MsgBox "本所期限不可大於法定期限！", vbExclamation
               Text1(3).SetFocus
               Exit Function
            End If
         End If
      End If
      bolCancel = False
   End If
End Function

'Add by Amy 2019/12/04 傳入收據公司別名稱,回傳對應之編號
Private Function GetReceiptVal(ByVal stReceiptName As String, ByVal bolSql As Boolean) As String
    'Added by Lydia 2020/03/30
    If strSrvDate(1) >= 智慧所更名日 Then
        Select Case stReceiptName
            Case m_CompName1
                GetReceiptVal = "1"
            Case m_CompName2
                'Modified by Lydia 2022/09/05 因為預設2公司,所以不用回寫=空白
                'GetReceiptVal = "2"
                GetReceiptVal = ""
            Case m_CompNameJ
               GetReceiptVal = "J"
            Case m_CompNameL
               GetReceiptVal = "L"
            Case Else
                GetReceiptVal = ""
        End Select
    Else
    'end 2020/03/30
        Select Case stReceiptName
            Case "專利商標"
                GetReceiptVal = "1"
            Case "專利法律"
                GetReceiptVal = "2"
            'Modify by Amy 2016/07/27
            Case "智權公司"
               GetReceiptVal = "J"
            Case Else
                GetReceiptVal = ""
        End Select
    End If
    
    'Removed by Morgan 2020/7/1 不管有無編號，回傳形式應該要相同，否則無編號時會更新成單引號 Ex:X25140
    'If bolSql = True And GetReceiptVal = MsgText(601) Then
    '    GetReceiptVal = "'" & GetReceiptVal & "'"
    'End If
    'end 2020/7/1
End Function

'Added by Lydia 2020/03/30 智慧所更名日起法務案(L、CFL)及顧問案LA之智權人員只能是法律所人員
'Mark by Lydia 2020/04/08 改成共用模組PUB_ChkSalesL
'Private Function ChkSalesL(ByVal pSysNo As String, ByVal pSalesNo As String) As Boolean
'    ChkSalesL = False
'    If strSrvDate(1) >= 智慧所更名日 And (pSysNo = "L" Or pSysNo = "CFL" Or pSysNo = "LA") And pSalesNo <> "" Then
'       If PUB_ChkLCompStaff(pSalesNo) = False Then
'            MsgBox "智權人員非法律所人員不可收文！", , "注意！"
'            Exit Function
'       End If
'    End If
'    ChkSalesL = True
'End Function
'end 2020/04/08

'Added by Lydia 2020/03/30 設定收據公司別(簡稱)
Private Sub SetCombo4(Optional ByVal pStartDay As String)
'pStartDay  : 可傳入接洽單日期CRL02
Dim strB As String, strB2 As String
Dim intB As Integer
Dim rsB As New ADODB.Recordset
Dim m_Comp  As String
     
     If pStartDay = "" Then pStartDay = strSrvDate(1) '預設系統日
     
     '記錄收據公司(簡稱)
     If m_CompName2 = "" Then
        If pStartDay >= 智慧所更名日 Then
            m_CompName1 = CompNameQuery("1", "4")
            m_CompName2 = CompNameQuery("2", "4")
            m_CompNameJ = CompNameQuery("J", "4")
            m_CompNameL = CompNameQuery("L", "4")
        Else
            m_CompName1 = "專利商標"
            m_CompName2 = "專利法律"
            m_CompNameJ = "智權公司"
            m_CompNameL = "L"
        End If
     End If

    '收據公司欄自智慧所更名日起，下拉選單預設僅以2抓公司檔簡稱，智權公司的預設也以J抓公司檔簡稱
    If pStartDay < 智慧所更名日 Then  '1+2公司
        strB = "1,2,J"
    Else
        '其他:
        strB = "2,J"  '抓2+J公司
        '新案以系統類別抓系統種類對照表，若SK02為3、4(法務案)及7、8(顧問案)的收據公司別鎖住，且不更新回客戶檔
        If Text1(6).Text <> "" Then
            'Modified by Lydia 2020/04/10 '請改為instr(系統類別,'L')>0的收據公司別鎖住，且不更新回客戶檔；instr(系統類別,'L')=0不可選L公司；
            'strB2 = "select sk02 from systemkind where sk01='" & Text1(6).Text & "' "
            'intB = 1
            'Set rsB = ClsLawReadRstMsg(intB, strB2)
            'If intB = 1 Then
            '    If InStr("3,4,7,8", "" & rsB.Fields("sk02")) > 0 Then
                If InStr(UCase(Text1(6)), "L") > 0 Then
            'end 2020/04/10
                    If Option1(0).Value = True Then '新案限制為L公司
                        m_Comp = "L"
                    Else   '舊案=L
                        strB = "L"
                    End If
                End If
            'End If 'Mark by Lydia 2020/04/10
        End If
    End If

    strB = "select a0801,a0820 from acc080 where a0801 in (" & GetAddStr(IIf(m_Comp <> "", m_Comp, strB)) & ") order by a0801 "
    intB = 1
    Set rsB = ClsLawReadRstMsg(intB, strB)
    If intB = 1 Then
      Combo4.Clear
      intB = 0
      Combo4.AddItem "", intB
      rsB.MoveFirst
      Do While Not rsB.EOF
          intB = intB + 1
          'Combo4.AddItem "" & rsB.Fields("a0820"), intB
          Select Case "" & rsB.Fields("a0801")
               Case "1"
                   Combo4.AddItem m_CompName1, intB
                   m_Comp1forIdx = intB
               Case "2"
                   Combo4.AddItem m_CompName2, intB
                   m_Comp2forIdx = intB
               Case "J"
                   Combo4.AddItem m_CompNameJ, intB
                   m_CompJforIdx = intB
               Case "L"
                   Combo4.AddItem m_CompNameL, intB
                   m_CompLforIdx = intB
          End Select
          rsB.MoveNext
      Loop
    End If
    '新案以系統類別抓系統種類對照表，若SK02為3、4(法務案)及7、8(顧問案)的收據公司別鎖住，且不更新回客戶檔
    'Memo by Lydia 2020/04/10 請改為instr(系統類別,'L')>0的收據公司別鎖住，且不更新回客戶檔；instr(系統類別,'L')=0不可選L公司；
    If m_Comp = "L" Then
         Combo4.ListIndex = m_CompLforIdx
         Combo4.Enabled = False
    Else
         Combo4.Enabled = True
    End If
    
    'Added by Lydia 2021/03/29 ACS案件收文與點數及營業稅：勾選新案時，將收據公司欄鎖住並預設為J公司(智權公司)
    If strSrvDate(1) >= strACSdate1 Then
        If Text1(6) = "ACS" Then
            If Option1(0).Value = True Then
                Combo4.ListIndex = m_CompJforIdx
                Combo4.Enabled = False
            Else
                Combo4.Enabled = True
            End If
        End If
    End If
    'end 2021/03/29
End Sub

'Added by Morgan 2020/4/17
'Modify By Sindy 2022/10/6
Private Sub SrcSetButton()
Dim intRow As Integer
Dim bolLosCase As Boolean 'Add By Sindy 2022/10/6

   '預設
   If Text5 = "" Then
      LblText5.Visible = False
      Text5.Visible = False
   Else
      LblText5.Visible = True
      Text5.Visible = True
   End If
   
   cmdSend.Caption = "待收文區"
   cmdSend.Visible = False
   If m_blnCallPrint = True Then '僅查詢
      'cmdSend.Visible = False
      Exit Sub
   End If
   
   Me.Enabled = False
   cmdOK(1).Enabled = True '可操作結束
   cmdOK(5).Visible = False
   cmdOK(0).Visible = True

   If InStr(UCase(Text1(6).Text), "L") > 0 And PUB_ChkLCompStaff(Text1(10).Text) = False Then
      bolLosCase = True
   End If
   
   '外部呼叫的收文,直接送出
   If bolExternalCall = True Or cmdOK(0).Caption = "送出" Then
      cmdOK(0).Caption = "送出"
      cmdOK(2).Visible = False
   Else
      intRow = SrcGetCRLFlow
      If intRow > 0 Then
         cmdSend.Caption = "待收文區(" & intRow & ")"
         cmdSend.Visible = True
         cmdOK(1).Enabled = False '不可操作結束
      End If
      If Text5 = "" Then
         cmdOK(0).Caption = "新增"
         cmdOK(2).Visible = True
      Else
         If UCase(TypeName(m_PrevForm)) = UCase("frm210148") Then
            cmdOK(0).Visible = False
         ElseIf UCase(TypeName(m_PrevForm)) = UCase("frm210147") And m_F0309 = Flow_退回 Then
'            If bolLosCase = True Then
'               m_blnCallPrint = True '案源不能修改資料
'               MsgBox "案源資料已寫入，不可修改！", vbInformation
'            End If
            'Add By Sindy 2024/9/25
            If Label1(123).Caption = "案源" Then
               m_blnCallPrint = True '案源不能修改資料
               MsgBox "案源資料已寫入，不可修改！", vbInformation
               cmdOK(0).Visible = False
            End If
            cmdOK(0).Caption = "重送"
            '2024/9/25 END
            'If Option1(1).Value = True Then cmdOK(3).Enabled = True 'Add By Sindy 2024/5/7
            'cmdSend.Visible = False '待收文區不顯示 Add By Sindy 2023/1/16
            cmdDelCRL.Visible = True '刪除
         Else
            'If bolLosCase = True Then
            If Label1(123).Caption = "案源" Then
               m_blnCallPrint = True '案源不能修改資料
               MsgBox "案源資料已寫入，不可修改！", vbInformation
'            ElseIf mTQC01 <> "" Then '有查名代號了,不可修改存檔
'               m_blnCallPrint = True
'               Call SetCtrlReadOnly(True)
'               MsgBox "有查名代號了，不可修改！", vbInformation
            End If
            
            cmdOK(0).Caption = "存檔"
         End If
         cmdOK(2).Visible = False '清除畫面(&C)
      End If
      If m_blnCallPrint = True Then
         If cmdOK(0).Caption <> "重送" Then
            cmdOK(0).Visible = False
         End If
      End If
   End If
   
   'If bolLosCase = True Then
   'Modified by Morgan 2025/4/18
   'If bolLosCase = True Or strCheckStatus <> "" Then
   If bolLosCase = True Then
   'end 2025/4/18
      'Modify By Sindy 2024/9/25 + UCase(TypeName(m_PrevForm)) = UCase("FRM210147")
      If m_blnCallPrint = True Or UCase(TypeName(m_PrevForm)) = UCase("FRM210147") Then
         cmdOK(5).Caption = "案源(&I)"
         Label1(123).Visible = False
      Else
         cmdOK(5).Caption = "案源輸入(&I)"
      End If
      '2024/9/24 END
      cmdOK(5).Visible = True
      If cmdOK(0).Caption <> "重送" Then cmdOK(0).Visible = False
   End If
   
   If m_PrevForm Is Nothing = False Then
      '查詢狀況
      If intRow = 0 Then
         cmdSend.Visible = False
         cmdOK(1).Enabled = True '可操作結束
      End If
   End If
   Me.Enabled = True
End Sub

'Added by Morgan 2020/4/22
'Modified by Morgan 2020/7/23 pIsLCase2:是否為法律案接洽單2
Public Sub Load4Print(pLOS15 As String, pCRL01 As String, Optional pIsLCase As Boolean = True, Optional pIsLCase2 As Boolean = False)
   strLOS15 = pLOS15
   
   '列印
   If pCRL01 <> "" Then
      bolIsTmp = True 'Added by Morgan 2020/8/3
      Text5 = pCRL01
      cmdOK(4).Value = True
      m_CP05 = ""
      m_CP09 = ""
      
      If pIsLCase = True Then
         Text1(10) = strUserNum
         Text1_Validate 10, False
'         Frame46.Left = Frame21.Left + Frame31.Left
'         Frame46.Top = Frame31.Top
'         Frame46.Visible = True
         cmdOK(5).Visible = True
      'Added by Morgan 2022/4/25
      'P/T案接洽單無費用不印特殊收據
      ElseIf Check9.Value = 1 Then
         Check9.Value = 0
      'end 2022/4/25
      End If
            
      cmdOK(0).Caption = "列印(&P)　　份"
      cmdOK(0).Visible = True
      cmdOK(2).Visible = False
   '自行填法務案接洽單
   Else
      SrcLoadLCasebyLOS15 strLOS15
   End If
   
   'Modified by Morgan 2020/7/23
   'bolLawOfficeCase = True
   bolLawOfficeCase = pIsLCase
   bolLawOfficeCase2 = pIsLCase2
   'end 2020/7/23
End Sub

'Added by Morgan 2020/4/23
'更新接洽單列印時間
Private Sub SrcUpdPrintTime()
On Error GoTo ErrHnd
   'Modified by Morgan 2020/7/23 +los24列印人員
   If bolLawOfficeCase2 Then
      strSql = "update lawofficesource set los25=sysdate,los26='" & strUserNum & "' where los15='" & strLOS15 & "'"
   Else
      strSql = "update lawofficesource set los14=sysdate,los24='" & strUserNum & "' where los15='" & strLOS15 & "'"
   End If
   cnnConnection.Execute strSql, intI
ErrHnd:
   If Err.Number <> 0 Then MsgBox Err.Description, vbCritical
End Sub

'Added by Morgan 2020/5/22
'檢查是否0費用
Private Function SrcZoroFeeChk() As Boolean
   Dim ii As Integer, bCheck As Boolean
   bCheck = True
   For ii = 1 To GridCase.Rows - 1 '4
      'If Val(Text1(101 + 3 * (ii - 1))) <> 0 Then
      If Val(Format(Trim(GridCase.TextMatrix(ii, 2)), "###0")) <> 0 Then
         SSTab1.Tab = 0
         'Text1(101 + 3 * (ii - 1)).SetFocus
         bCheck = False
         Exit For
      'ElseIf Val(Text1(102 + 3 * (ii - 1))) <> 0 Then
      ElseIf Val(Format(Trim(GridCase.TextMatrix(ii, 3)), "###0")) <> 0 Then
         SSTab1.Tab = 0
         'Text1(102 + 3 * (ii - 1)).SetFocus
         bCheck = False
         Exit For
      'ElseIf Val(Text1(103 + 3 * (ii - 1))) <> 0 Then
      ElseIf Val(Format(Trim(GridCase.TextMatrix(ii, 4)), "###0.000")) <> 0 Then
         SSTab1.Tab = 0
         'Text1(103 + 3 * (ii - 1)).SetFocus
         bCheck = False
         Exit For
      End If
   Next
   If bCheck = False Then
      If Left(strLSourceType, 1) = "B" Then
         MsgBox "【B類】案源接洽單之費用、規費、點數都必須為 0 !!" & vbCrLf & "若欲收文有費用的案件性質，請分不同接洽單填寫!!", vbExclamation
      'Removed by Morgan 2021/7/19 取消 C類案源
      'ElseIf strLSourceType = "C" Then
      '   MsgBox "【C類】案源法務案之費用、規費、點數都必須為 0 !!", vbExclamation
      'end 2021/7/19
      ElseIf strLCaseNo(1) = "L" Then
         MsgBox "【B類】案源補收文之費用、規費、點數都必須為 0 !!", vbExclamation
      End If
   End If
   SrcZoroFeeChk = bCheck
End Function

'Added by Morgan 2020/5/22
'自動新增【提供書狀意見】
'Modify By Sindy 2024/11/15 增加使用功能: Optional strCPM As String => 指定要新增的案件性質
Private Sub SrcAutoAdd(Optional strCPM As String)
Dim strCP10 As String
Dim ii As Integer, jj As Integer
    
   m_strCaseCPM = GetAllCaseCPM() 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   'Add By Sindy 2024/11/15
   If strCPM <> "" Then
      strCP10 = strCPM
   Else
   '2024/11/15 END
      If Trim(Text1(6).Text) = "P" Then
         strCP10 = "225"
      Else
         strCP10 = "212"
      End If
   End If
'   jj = 0
'   For ii = 1 To 4
'      If Left(Combo1(ii), 3) = strCP10 Then
'         Exit For
'      ElseIf Combo1(ii) = "" And jj = 0 Then
'         jj = ii
'      End If
'   Next
   If InStr(m_strCaseCPM, strCP10) > 0 Then
      Exit Sub
   End If
'   If ii = 5 Then
'      If jj = 0 Then
'         MsgBox "案件性質超過，無法新增【提供書狀意見】！", vbExclamation
'      Else
'         For ii = 0 To Combo1(jj).ListCount - 1
'            If Left(Combo1(jj).List(ii), 3) = strCP10 Then
'               Combo1(jj).ListIndex = ii
'               Combo1_LostFocus jj
'               Text1(101 + 3 * (jj - 1)).Text = "0"
'               Text1(102 + 3 * (jj - 1)).Text = "0"
'               Text1(103 + 3 * (jj - 1)).Text = "0.000"
'               Exit For
'            End If
'         Next
         For ii = 0 To Combo1(1).ListCount - 1
            If Left(Combo1(1).List(ii), 3) = strCP10 Then
               Combo1(1).ListIndex = ii
               Combo1_LostFocus 1
'               Text1(101).Text = "0"
'               Text1(102).Text = "0"
'               Text1(103).Text = "0.000"
               Exit For
            End If
         Next
'      End If
'   End If
End Sub
'Added by Morgan 2020/7/13
'自動新增【準備程序】【言詞辯論】
Private Sub SrcAutoAdd2(pCP10s As String)
Dim arrCP10() As String, strCP10 As String, strCP10n As String
Dim ii As Integer, jj As Integer, kk As Integer
   
   m_strCaseCPM = GetAllCaseCPM() 'Add By Sindy 2022/8/29 取得案件性質代碼
   
   arrCP10() = Split(pCP10s, ",")
   
   For kk = LBound(arrCP10) To UBound(arrCP10)
      strCP10 = arrCP10(kk)
      strCP10n = ""
      For ii = 0 To Combo1(1).ListCount - 1
         If Left(Combo1(1).List(ii), 3) = strCP10 Then
            strCP10n = Mid(Combo1(1).List(ii), 5)
            Exit For
         End If
      Next
      If strCP10 <> "" Then
'         jj = 0
'         For ii = 1 To 4
'            If Left(Combo1(ii), 3) = strCP10 Then
'               Exit For
'            ElseIf Combo1(ii) = "" And jj = 0 Then
'               jj = ii
'            End If
'         Next
         If InStr(m_strCaseCPM, strCP10) > 0 Then
            Exit Sub
         End If
'         If ii = 5 Then
'            If jj = 0 Then
'               MsgBox "案件性質超過，無法新增【" & strCP10n & "】！", vbExclamation
'               Exit For
'            Else
'               For ii = 0 To Combo1(jj).ListCount - 1
'                  If Left(Combo1(jj).List(ii), 3) = strCP10 Then
'                     Combo1(jj).ListIndex = ii
'                     Combo1_LostFocus jj
'                     Text1(101 + 3 * (jj - 1)).Text = "0"
'                     Text1(102 + 3 * (jj - 1)).Text = "0"
'                     Text1(103 + 3 * (jj - 1)).Text = "0.000"
'                     Exit For
'                  End If
'               Next
               For ii = 0 To Combo1(1).ListCount - 1
                  If Left(Combo1(1).List(ii), 3) = strCP10 Then
                     Combo1(1).ListIndex = ii
                     Combo1_LostFocus 1
'                     Text1(101).Text = "0"
'                     Text1(102).Text = "0"
'                     Text1(103).Text = "0.000"
                     Exit For
                  End If
               Next
'            End If
'         End If
      End If
   Next
End Sub

'Added by Morgan 2020/4/28
'B1類智財民刑事:P226/T213配合開庭，自動補上提供書狀意見(P225/T212)，兩項費用規費均設0 <--案件性質抓特殊設定 B1P, B1T
'B2類商標行政訴訟/專利上訴...，費用0: <--案件性質抓特殊設定 B2P, B2T
'C類專利行政訴訟(含參加)...: <--案件性質抓特殊設定 CP, CT --取消 2021/7/13
Private Function SrcSetLCase(Optional pSaveCheck As Boolean = False, Optional pIndex As Integer = -1) As Boolean
   Dim ii As Integer
   Dim bCheck As Boolean
   Dim strCode As String, strCode2 As String, strTemp As String, arrCP10() As String
   Dim strChuTing As String, bolChuTing As Boolean
   Dim strSuYuan As String
   Dim strAutoAdd2Pty As String
   
   If strLOS15 <> "" Then SrcSetLCase = True: Exit Function
   
   m_strCaseCPM = GetAllCaseCPM 'Add By Sindy 2022/9/12 取得案件性質代碼
   strLSourceType = ""
   bolSuYuan = False
   bolIsB2CourtFee = False
   Erase strLCaseNo
   If Left(Combo1(0), 3) = "000" And (Trim(Text1(6).Text) = "P" Or Trim(Text1(6).Text) = "T" Or Trim(Text1(6).Text) = "TC") Then
   
      '設定案件性質(準備程序,言詞辯論,訴願)
      If Trim(Text1(6).Text) = "P" Then
         strChuTing = "211,212"
         'Modified by Morgan 2021/7/13 專利訴願不再是案源(改專利師處理不需律師)
         'strSuYuan = "501,505"
         strSuYuan = ""
         'end 2021/7/13
         strAutoAdd2Pty = "503,506" 'Modified by Morgan 2022/11/11 +506
      Else
         strChuTing = "204,205"
         strSuYuan = "401,406"
         strAutoAdd2Pty = "403" '行政訴訟
      End If
      
      m_strCaseCPM = m_strCaseCPM & IIf(Trim(Left(Trim(Combo1(1)), 4)) <> "", "," & Trim(Left(Trim(Combo1(1)), 4)), "")
      'If Left(m_strCaseCPM, 1) = "," Then m_strCaseCPM = Mid(m_strCaseCPM, 2)
      arrCP10 = Split(m_strCaseCPM, ",")
      'For ii = 1 To 4
      For ii = 0 To UBound(arrCP10) '- 1
         strTemp = arrCP10(ii) 'Left(Combo1(ii), 3)
         If strTemp <> "" Then
            '是否有收準備程序,言詞辯論
            If InStr(strChuTing, strTemp) > 0 Then bolChuTing = True
            '是否有收訴願
            If InStr(strSuYuan, strTemp) > 0 Then bolSuYuan = True
            
            If Trim(Text1(6).Text) = "P" Then
               strCode2 = PUB_GetLOSkind("P", strTemp)
            Else
               strCode2 = PUB_GetLOSkind("T", strTemp)
            End If
            If strCode2 <> "" Then
               If strCode = "" Then
                  strCode = strCode2
               ElseIf strCode <> strCode2 Then
                  MsgBox "不可同時收文" & Left(strCode, Len(strCode) - 1) & "類及" & Left(strCode2, Len(strCode2) - 1) & "類案源的案件性質！", vbExclamation
                  Exit Function
               End If
            End If
         End If
      Next ii
      'B1
      If Left(strCode, 2) = "B1" Then
         strLSourceType = "B1"
         If pSaveCheck = True Then
            If SrcZoroFeeChk() = False Then Exit Function
            
         ElseIf pIndex > -1 Then
         
            Text1(101).Text = "0" ' + 3 * (pIndex - 1)
            Text1(102).Text = "0" ' + 3 * (pIndex - 1)
            Text1(103).Text = "0.000" ' + 3 * (pIndex - 1)
            Call cmdUpd_Click '新增
            SrcAutoAdd '自動新增【提供書狀意見】
         End If
         
      'B2
      ElseIf Left(strCode, 2) = "B2" Then
         strLSourceType = "B2"
         If pSaveCheck = True Then
            If SrcZoroFeeChk() = False Then Exit Function
            
         ElseIf pIndex > -1 Then
         
            Text1(101).Text = "0" ' + 3 * (pIndex - 1)
            Text1(102).Text = "0" ' + 3 * (pIndex - 1)
            Text1(103).Text = "0.000" ' + 3 * (pIndex - 1)
            Call cmdUpd_Click '新增
            
            '新案收文行政訴訟自動新增【準備程序】【言詞辯論】
            'Modified by Morgan 2022/11/11
            'If Option1(0).Value = True And Left(Combo1(pIndex), 3) = strAutoAdd2Pty Then
'            If Option1(0).Value = True And InStr(strAutoAdd2Pty, Left(Combo1(pIndex), 3)) > 0 Then
            'end 2022/11/11
            'If Option1(0).Value = True And InStr(m_strCaseCPM, strAutoAdd2Pty) > 0 Then
            'Modify By Sindy 2022/11/11
            arrCP10 = Split(strAutoAdd2Pty, ",")
            For ii = 0 To UBound(arrCP10)
               strTemp = arrCP10(ii)
               If strTemp <> "" Then
                  'If Option1(0).Value = True And InStr(m_strCaseCPM, strAutoAdd2Pty) > 0 Then
                  If Option1(0).Value = True And InStr(m_strCaseCPM, strTemp) > 0 Then
                     SrcAutoAdd2 strChuTing
                     Exit For
                  End If
               End If
            Next ii
            '2022/11/11 END
         End If
         
      'C
      'Removed by Morgan 2021/7/19 取消 C類案源
      'ElseIf Left(strCode, 1) = "C" Then
      '   strLSourceType = "C"
      '   If pIndex > -1 Then
      '      '新案收文行政訴訟自動新增【準備程序】【言詞辯論】
      '      If Option1(0).Value = True And Left(Combo1(pIndex), 3) = strAutoAdd2Pty Then
      '         SrcAutoAdd2 strChuTing
      '      End If
      '   End If
      'end 2021/7/19
      
      '非案源但有收準備程序或言詞辯論
      ElseIf strLSourceType = "" And bolChuTing = True Then
         '本單有收訴願
         If bolSuYuan = True Then
            'Modified by Morgan 2021/7/19 商標訴願程序參加訴願言詞辯論由律師協助處理-法律所收文開收據
            'strLSourceType = "C"
            strLSourceType = "B2"
            'end 2021/7/19
         End If
         
      End If
      
      'Added by Morgan 2020/6/3
      '準備程序/言詞辯論是否補收出庭費
      If strLSourceType = "" And Option1(1).Value = True And bolChuTing = True And pSaveCheck = True Then
         'B2類案源補收文
         If SrcCheckExistLOS(Text1(6), Text1(7), Text1(8), Text1(9), strLCaseNo, "B2", strTemp) = True Then
            If strLCaseNo(1) = "L" Then '法務案要已收文否則會變成新案號
               If SrcZoroFeeChk() = False Then Exit Function
               If MsgBox("是否有【補收款】？" & vbCrLf & vbCrLf & "若【是】，請繼續操作法務案補收款接洽單", vbQuestion + vbYesNo + vbDefaultButton2) = vbYes Then
                  strLSourceType = "B2"
                  bolIsB2CourtFee = True
               End If
            End If
         
         '非C類案源補收文
         'Removed by Morgan 2021/7/19 取消 C類案源
         'ElseIf SrcCheckExistLOS(Text1(6), Text1(7), Text1(8), Text1(9), strLCaseNo, "C") = False Then
         '   '是否訴願案
         '   bolSuYuan = SrcChkIsSuYuan(Text1(6), Text1(7), Text1(8), Text1(9), strSuYuan)
         '   If bolSuYuan = True Then
         '      strLSourceType = "C"
         '   End If
         'end 2021/7/19
         End If
      End If
      'end 2020/6/3
   
   'Add By Sindy 2022/9/28
   ElseIf Text1(6) = "L" And Text1(7) = "888888" And Combo1(1).Text <> "" Then
         Text1(101).Text = "0" ' + 3 * (pIndex - 1)
         Text1(102).Text = "0" ' + 3 * (pIndex - 1)
         Text1(103).Text = "0.000" ' + 3 * (pIndex - 1)
         Call cmdUpd_Click '新增
         '2022/9/28 END
   End If
   
   SrcSetLCase = True
End Function

'Added by Morgan 2020/5/4
Private Function SrcGetLOS15(pCRL01 As String) As String
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   
On Error GoTo ErrHnd
   
   stSQL = "select LOS15 From LawOfficeSource where LOS17='" & pCRL01 & "'"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      SrcGetLOS15 = "" & RsQ("LOS15")
   End If
   
ErrHnd:
   Set RsQ = Nothing
End Function

'Added by Morgan 2020/5/6
'預設案件說明事項
'blnOverseas:是否外對台, bolChange:判斷有改過說明時不重新預設
Private Sub SrcSetMemo(Optional blnOverseas As Boolean = False, Optional bolChange As Boolean = False)
   If bolChange = True And Text1(119).Tag <> Trim(Text1(119)) Then Exit Sub
   
   'Add By Sindy 2022/10/14
   If Text1(6) = "ACS" Then
      Text1(119).Text = ""
      '2022/10/14 END
      
   ElseIf InStr(UCase(Text1(6).Text), "L") > 0 Then
      If PUB_ChkLCompStaff(Text1(10).Text) = True And strLOS15 = "" And strSrvDate(1) < 法律所案源收文啟用日 Then
         Text1(119).Text = "智權人員："
      Else
         Text1(119).Text = ""
      End If
      
   Else
      'Modify By Sindy 2022/10/14 取消 "商品類別：" & vbCrLf "彼所案號：" & vbCrLf: 改存欄位
      Text1(119).Text = "如案件內容摘要、引用條文與客戶洽談要旨等等......" & vbCrLf & _
                        "商品名稱：" & vbCrLf & _
                        "註冊號數：" & vbCrLf & _
                        "優先權日：" & vbCrLf & _
                        "優先權號：" & vbCrLf
      If blnOverseas = True Then
         Text1(119).Text = Text1(119).Text & _
                        "聯絡人：" & vbCrLf '& _
                        '"彼所案號：" & vbCrLf
         Frame33(1).Visible = False  'Add by Sindy 2024/7/19 DEBIT NOTE請款選項;預設不顯示
      End If
   End If
   
   Text1(119).Tag = Trim(Text1(119))
End Sub
'Added by Morgan 2020/4/29
'檢查是否有案源未完成
'Modify By Sindy 2024/9/24 + Optional bolMustChk As Boolean = False: 要檢查是否為案源且抓資料
Private Sub SrcLoadCheck(Optional bolMustChk As Boolean = False)
   
   If bolMustChk = False Then 'Add By Sindy 2024/9/24 + if
      If Not (Text5 = "" And m_PrevForm Is Nothing And Text1(10) <> "") Then Exit Sub
   End If
   
   strCheckStatus = ""
   '檢查是否有案源法務案未輸入
   If SrcLoadCheck1() = True Then strCheckStatus = "1": Exit Sub
   
   '檢查是否有B1類案源要補配合開庭
   If SrcLoadCheck2() = True Then strCheckStatus = "2": Exit Sub
   
   '檢查是否有B1類案源P/T案未輸入
   If SrcLoadCheck3() = True Then strCheckStatus = "3": Exit Sub
   
   '檢查是否有B1類案源法務案補收款未輸入
   If SrcLoadCheck4() = True Then strCheckStatus = "4": Exit Sub
End Sub
'Added by Morgan 2020/4/29
'檢查是否有案源法務案未輸入
Private Function SrcLoadCheck1() As Boolean
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset, RsQ2 As ADODB.Recordset
   Dim strMsg As String, strSys As String, strCP10 As String, strCP10s As String, ii As Integer, jj As Integer
   Dim bolIsB2Case As Boolean, strCaseName As String
   Dim RsCMP As ADODB.Recordset 'Add By Sindy 2022/9/12
   
   'Modify By Sindy 2022/8/30
'   stSQL = "select LOS02,LOS05,LOS06,LOS15,LOS18,LOS19,CRL07||decode(CRL08,'','新案','-'||CRL08||'-'||CRL09||'-'||CRL10) OurRef" & _
'      ",RTRIM(c1.cpm03||' '||c2.cpm03||' '||c3.cpm03||' '||c4.cpm03) Prty,cr.*" & _
'      " From LawOfficeSource,consultrecordlist cr,casepropertymap c1,casepropertymap c2,casepropertymap c3,casepropertymap c4" & _
'      " where instr(LOS04,'" & Text1(10) & "')=1 and los17 is null and los18 is not null" & _
'      " and crl01(+)=los18" & _
'      " and c1.cpm01(+)=CRL07 and c1.cpm02(+)=CRL19 and c2.cpm01(+)=CRL07 and c2.cpm02(+)=CRL24 and c3.cpm01(+)=CRL07 and c3.cpm02(+)=CRL29 and c4.cpm01(+)=CRL07 and c4.cpm02(+)=CRL34" & _
'      " order by los18"
   stSQL = "select LOS02,LOS05,LOS06,LOS15,LOS18,LOS19,CRL07||decode(CRL08,'','新案','-'||CRL08||'-'||CRL09||'-'||CRL10) OurRef" & _
      ",GetCRCaseNmFee(crl01,'2') Prty,cr.*" & _
      " From LawOfficeSource,consultrecordlist cr" & _
      " where instr(LOS04,'" & Text1(10) & "')=1 and los17 is null and los18 is not null" & _
      " and crl01(+)=los18" & _
      " order by los18"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      With RsQ
      strLSourceType = "" & .Fields("LOS02")
      strPTSysCode = "" & .Fields("CRL07") 'P/T系統別
      strCaseName = "" & .Fields("CRL17") '案件名稱
      'P/T是否新案
      If .Fields("CRL06") = "Y" Then
         bolPTIsNew = True
      Else
         bolPTIsNew = False
      End If
      strLOS18 = "" & .Fields("LOS18") 'P/T接洽單號
      strLOS15 = "" & .Fields("LOS15") '案源單號
      strLCaseCP10 = "" & .Fields("LOS19") '法務案預設收文性質
      
      'B2案源設定PT規費及出庭費提醒
      If strLSourceType = "B2" Then
         bolCourtFeeAlert = False
         bolIsB2Case = False
         lngPTOFee = 0
         lngPTcost = 0 'Add By Sindy 2025/4/14 費用
         '出庭費案件性質
         If strPTSysCode = "P" Then
            strCP10s = "211,212"
            strExc(1) = Pub_GetSpecMan("B2P")
         Else
            strCP10s = "204,205"
            strExc(1) = Pub_GetSpecMan("B2T")
         End If
         
         'Modify By Sindy 2022/9/12 讀取案件性質
         stSQL = "SELECT * FROM ConsultRecCMP WHERE CRC01 = '" & strLOS18 & "' order by CRC02 asc"
         intQ = 1
         Set RsCMP = ClsLawReadRstMsg(intQ, stSQL)
         If intQ = 1 Then
            RsCMP.MoveFirst
            Do While Not RsCMP.EOF
               strCP10 = "" & RsCMP.Fields("CRC03") '案件性質
               If strCP10 <> "" Then
                  '出庭費提醒
                  If InStr(strCP10s, strCP10) > 0 Then
                     bolCourtFeeAlert = True
                  End If
                  
                  '是否有B2案源主項
                  If InStr(strExc(1), strCP10) > 0 Then
                     bolIsB2Case = True
                  End If
                  
                  'PT規費
                  'Modify By Sindy 2025/4/14 改成共用函數
'                  stSQL = "SELECT cf08 FROM CASEFEE WHERE CF01 = '" & strPTSysCode & "' AND CF02 = '000' AND CF03 = '" & strCP10 & "' and cf08>0"
'                  intQ = 1
'                  Set RsQ2 = ClsLawReadRstMsg(intQ, stSQL)
'                  If intQ = 1 Then
'                     lngPTOFee = lngPTOFee + RsQ2("cf08")
'                  End If
                  Call PUB_GetCaseFee_000("", strExc(1), strExc(2), strExc(3), strPTSysCode, strCP10)
                  lngPTOFee = lngPTOFee + Val(strExc(3))
                  lngPTcost = lngPTcost + Val(strExc(1)) 'Add By Sindy 2025/4/14 費用
                  '2025/4/14 END
               End If
               RsCMP.MoveNext
            Loop
         End If
'         For ii = 1 To 4
'            strCP10 = "" & RsQ("CRL" & 19 + (ii - 1) * 5) '案件性質
'            If strCP10 <> "" Then
'               '出庭費提醒
'               If InStr(strCP10s, strCP10) > 0 Then
'                  bolCourtFeeAlert = True
'               End If
'
'               '是否有B2案源主項
'               If InStr(strExc(1), strCP10) > 0 Then
'                  bolIsB2Case = True
'               End If
'
'               'PT規費
'               stSQL = "SELECT cf08 FROM CASEFEE WHERE CF01 = '" & strPTSysCode & "' AND CF02 = '000' AND CF03 = '" & strCP10 & "' and cf08>0"
'               intQ = 1
'               Set RsQ2 = ClsLawReadRstMsg(intQ, stSQL)
'               If intQ = 1 Then
'                  lngPTOFee = lngPTOFee + RsQ2("cf08")
'               End If
'            End If
'         Next ii
         '2022/9/12 END
         
         '補收款:P/T案無B2案源案件性質但有準備程序或言詞辯論
         If bolCourtFeeAlert = True And bolIsB2Case = False Then
            bolIsB2CourtFee = True
            SrcCheckExistLOS .Fields("CRL07"), .Fields("CRL08"), .Fields("CRL09"), .Fields("CRL10"), strLCaseNo, "B2", strExc(1)
         ElseIf bolPTIsNew = False Then
            SrcCheckExistLOS .Fields("CRL07"), .Fields("CRL08"), .Fields("CRL09"), .Fields("CRL10"), strLCaseNo
         End If
      
      'Added by Morgan 2020/8/3
      'Removed by Morgan 2021/7/19 取消 C類案源
      'ElseIf strLSourceType = "C" Then
      '   If bolPTIsNew = False Then
      '      SrcCheckExistLOS .Fields("CRL07"), .Fields("CRL08"), .Fields("CRL09"), .Fields("CRL10"), strLCaseNo
      '   End If
      'end 2021/7/19
      'end 2020/8/3
      End If
            
      If strLSourceType = "B2" And bolIsB2CourtFee = True Then
         strMsg = IIf(strUserNum = Text1(10), "您", lblStaffName & " ") & "尚有法務案【補收款】收文內容未完成，是否要繼續？" & vbCrLf & vbCrLf
      Else
         strMsg = IIf(strUserNum = Text1(10), "您", lblStaffName & " ") & "尚有【" & .Fields("LOS02") & "類介紹案源之法務案】未輸入，是否要繼續？" & vbCrLf & vbCrLf
      End If
      
      strMsg = strMsg & "※注意：若選【否】將不再保留下列 P/T 接洽單內容!!" & vbCrLf & vbCrLf
      strMsg = strMsg & "案源單號：" & .Fields("LOS15") & vbCrLf
      strMsg = strMsg & "本所案號：" & .Fields("OurRef") & vbCrLf
      strMsg = strMsg & "案件性質：" & .Fields("Prty") & vbCrLf
      End With
      
      stSQL = "select C.*,nvl(CRA07,CRA08) Cust from ConsultRecApp C where CRA01='" & "" & strLOS18 & "' order by cra02 asc"
      intQ = 1
      Set RsQ2 = ClsLawReadRstMsg(intQ, stSQL)
      If intQ = 1 Then
         With RsQ2
         strMsg = strMsg & "　申請人：" & .Fields("Cust") & vbCrLf
         .MoveNext
         Do While Not .EOF
            strMsg = strMsg & "　　　　　" & .Fields("Cust") & vbCrLf
            .MoveNext
         Loop
         End With
      End If
      
      If MsgBox(strMsg, vbQuestion + vbYesNo + vbDefaultButton1) = vbYes Then
      
         SrcSetField "L", bolPTIsNew
         If Option1(0).Value = True Then
            Text1(11) = strCaseName
            SrcLoadCustbyCRL01 strLOS18
            Call GetReceiptTitle
         End If
         If strLCaseCP10 <> "" Then
            For ii = 0 To Combo1(1).ListCount - 1
               If InStr(Combo1(1).List(ii), strLCaseCP10 & " ") = 1 Then
                  Combo1(1).ListIndex = ii
                  Combo1_LostFocus 1
                  'C類案源預設費用0
                  'Removed by Morgan 2021/7/19 取消 C類案源
                  'If strLSourceType = "C" Then
                  '   Text1(101).Text = "0"
                  '   Text1(102).Text = "0"
                  '   Text1(103).Text = "0.000"
                  'End If
                  'end 2021/7/19
                  Exit For
               End If
            Next
         End If
         SrcLoadCheck1 = True
      Else
         SrcDeletSource strLOS15, strLOS18
         SrcLOSReset
         SrcSetButton 'Add By Sindy 2022/10/13
      End If
   End If
   
ErrHnd:
   If Err.Number <> 0 Then MsgBox Err.Description, vbCritical
   Set RsQ = Nothing
   Set RsQ2 = Nothing
   Set RsCMP = Nothing 'Add By Sindy 2022/9/12
End Function

'Added by Morgan 2020/4/29
'檢查是否有B1類案源要補配合開庭
Private Function SrcLoadCheck2() As Boolean
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   Dim strMsg As String, strSys As String, strCP10 As String, strCP10s As String, ii As Integer, jj As Integer
   Dim arrCP10() As String
   
   '有B1案源且有法務收文號但無案源收文號
   stSQL = "select LOS15,CP01||'-'||CP02||DECODE(CP03||CP04,'000','','-'||CP03||'-'||CP04) CaseNo,CP31,LOS19,cp01,cp02,cp03,cp04" & _
      ",cpm03 Prty,LC05,LC11,LC43,LC44,LC45,LC46,LC47,c1.cu04 Cus1,c2.cu04 Cus2,c3.cu04 Cus3,c4.cu04 Cus4,c5.cu04 Cus5" & _
      " From LawOfficeSource,caseprogress a,casepropertymap,lawcase,customer c1,customer c2,customer c3,customer c4,customer c5" & _
      " where instr(LOS04,'" & Text1(10) & "')=1 and LOS02='B1' and los01 is null and los06 is not null and los18 is null" & _
      " and cp09(+)=los06 and cp01<>'FCL' and lc01(+)=cp01 and lc02(+)=cp02 and lc03(+)=cp03 and lc04(+)=cp04" & _
      " and cpm01(+)=cp01 and cpm02(+)=cp10" & _
      " and c1.cu01(+)=substr(LC11,1,8) and c1.cu02(+)=substr(LC11,9)" & _
      " and c2.cu01(+)=substr(LC43,1,8) and c2.cu02(+)=substr(LC43,9)" & _
      " and c3.cu01(+)=substr(LC44,1,8) and c3.cu02(+)=substr(LC44,9)" & _
      " and c4.cu01(+)=substr(LC45,1,8) and c4.cu02(+)=substr(LC45,9)" & _
      " and c5.cu01(+)=substr(LC46,1,8) and c5.cu02(+)=substr(LC46,9)" & _
      " and not exists(select * from caseprogress b where b.cp162=los15 and b.cp01<>a.cp01)"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      strLSourceType = "B1"
      With RsQ
      strCP10s = "" & .Fields("LOS19")
      SetPTByLC47 "" & .Fields("LC47"), strSys, strCP10
      If strCP10s = "" Then strCP10s = strCP10
      
      strMsg = "是否現在要補收【" & SrcGetProperty(strSys, strCP10s) & "】接洽單？" & vbCrLf & vbCrLf
      strMsg = strMsg & "案源單號：" & .Fields("LOS15") & vbCrLf
      strMsg = strMsg & "法務案號：" & .Fields("CaseNo") & vbCrLf
      strMsg = strMsg & "案件名稱：" & .Fields("LC05") & vbCrLf
      strMsg = strMsg & "案件性質：" & .Fields("Prty") & vbCrLf
      strMsg = strMsg & "　申請人：" & .Fields("Cus1") & vbCrLf
      If Not IsNull(.Fields("LC43")) Then
         strMsg = strMsg & "　　　　　" & .Fields("Cus2") & vbCrLf
      End If
      If Not IsNull(.Fields("LC44")) Then
         strMsg = strMsg & "　　　　　" & .Fields("Cus3") & vbCrLf
      End If
      If Not IsNull(.Fields("LC45")) Then
         strMsg = strMsg & "　　　　　" & .Fields("Cus4") & vbCrLf
      End If
      If Not IsNull(.Fields("LC46")) Then
         strMsg = strMsg & "　　　　　" & .Fields("Cus5") & vbCrLf
      End If
      
      If MsgBox(strMsg, vbQuestion + vbYesNo + vbDefaultButton1) = vbYes Then
         strLOS15 = "" & .Fields("LOS15") '案源單號
         strPTCP10 = strCP10s
         '主題
         Text1(11) = "" & .Fields("LC05")
         '鎖定智權人員,新案,系統別,申請國...
         
         SrcSetField strSys
         arrCP10 = Split(strCP10s, ",")
         For jj = 0 To UBound(arrCP10)
            strCP10 = arrCP10(jj)
            If strCP10 <> "" Then
'               For ii = 0 To Combo1(1 + jj).ListCount - 1
'                  If Left(Combo1(1 + jj).List(ii), 3) = strCP10 Then
'                     Combo1(1 + jj).ListIndex = ii
'                     Combo1_LostFocus 1 + jj
'                     Text1(101 + 3 * jj).Text = "0"
'                     Text1(102 + 3 * jj).Text = "0"
'                     Text1(103 + 3 * jj).Text = "0.000"
'                     Exit For
'                  End If
'               Next
               For ii = 0 To Combo1(1).ListCount - 1
                  If Left(Combo1(1).List(ii), 3) = strCP10 Then
                     Combo1(1).ListIndex = ii
                     Combo1_LostFocus 1
                     Text1(101).Text = "0"
                     Text1(102).Text = "0"
                     Text1(103).Text = "0.000"
                     Call cmdUpd_Click '新增
                     Exit For
                  End If
               Next
            End If
         Next
         strCUNo(1) = "" & .Fields("LC11")
         strCUNo(2) = "" & .Fields("LC43")
         strCUNo(3) = "" & .Fields("LC44")
         strCUNo(4) = "" & .Fields("LC45")
         strCUNo(5) = "" & .Fields("LC46")
         
         SrcSetCustByVar
         
         '後續法務案若有補收款要用
         strLCaseNo(1) = "" & .Fields("CP01")
         strLCaseNo(2) = "" & .Fields("cp02")
         strLCaseNo(3) = "" & .Fields("cp03")
         strLCaseNo(4) = "" & .Fields("cp04")
         
         SrcLoadCheck2 = True
      Else
         SrcLOSReset
      End If
      End With
   End If
   
   Set RsQ = Nothing
End Function

'Added by Morgan 2020/4/29
'檢查是否有B1類案源P/T案未輸入
Private Function SrcLoadCheck3(Optional pLOS17 As String) As Boolean
   Dim stSQL As String, intQ As Integer, stCon As String
   Dim RsQ As ADODB.Recordset, RsQ2 As ADODB.Recordset
   Dim strMsg As String, strSys As String, strCP10 As String, strCP10s As String, ii As Integer, jj As Integer
   Dim arrCP10() As String
   
   If pLOS17 <> "" Then stCon = " and LOS17='" & pLOS17 & "'"
   
   'B1案源,無案源收文號,無PT案接洽單號
   'Modify By Sindy 2022/8/30
'   stSQL = "select LOS02,LOS05,LOS15,LOS17,LOS19,CRL07||decode(CRL08,'','新案','-'||CRL08||'-'||CRL09||'-'||CRL10) OurRef" & _
'      ",RTRIM(c1.cpm03||' '||c2.cpm03||' '||c3.cpm03||' '||c4.cpm03) Prty,cr.*" & _
'      " From LawOfficeSource,consultrecordlist cr,casepropertymap c1,casepropertymap c2,casepropertymap c3,casepropertymap c4" & _
'      " where instr(LOS04,'" & Text1(10) & "')=1 and LOS02='B1' and los01 is null and los06 is null and los18 is null" & stCon & _
'      " and crl01(+)=los17 and crl07<>'FCL'" & _
'      " and c1.cpm01(+)=CRL07 and c1.cpm02(+)=CRL19 and c2.cpm01(+)=CRL07 and c2.cpm02(+)=CRL24" & _
'      " and c3.cpm01(+)=CRL07 and c3.cpm02(+)=CRL29 and c4.cpm01(+)=CRL07 and c4.cpm02(+)=CRL34" & _
'      " order by los18"
   stSQL = "select LOS02,LOS05,LOS15,LOS17,LOS19,CRL07||decode(CRL08,'','新案','-'||CRL08||'-'||CRL09||'-'||CRL10) OurRef" & _
      ",GetCRCaseNmFee(crl01,'2') Prty,cr.*" & _
      " From LawOfficeSource,consultrecordlist cr" & _
      " where instr(LOS04,'" & Text1(10) & "')=1 and LOS02='B1' and los01 is null and los06 is null and los18 is null" & stCon & _
      " and crl01(+)=los17 and crl07<>'FCL'" & _
      " order by los18"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      strLSourceType = "B1"
      With RsQ
      strLOS15 = "" & .Fields("LOS15") '案源單號
      strLOS17 = "" & .Fields("LOS17") '法律案接洽單號
      
      strMsg = "是否現在要補輸下列【B1案源】的 P/T案 接洽單？" & vbCrLf & vbCrLf
      strMsg = strMsg & "※注意：若選【否】將不再保留 法務案 接洽單內容!!" & vbCrLf & vbCrLf
      strMsg = strMsg & "案源單號：" & .Fields("LOS15") & vbCrLf
      strMsg = strMsg & "法務案號：" & .Fields("OurRef") & vbCrLf
      strMsg = strMsg & "案件性質：" & .Fields("Prty") & vbCrLf
      End With
      
      If pLOS17 <> "" Then
         intQ = vbYes
      Else
         stSQL = "select C.*,nvl(CRA07,CRA08) Cust from ConsultRecApp C where CRA01='" & strLOS17 & "' order by cra02 asc"
         intQ = 1
         Set RsQ2 = ClsLawReadRstMsg(intQ, stSQL)
         With RsQ2
         If intQ = 1 Then
            strMsg = strMsg & "　申請人：" & .Fields("Cust") & vbCrLf
            .MoveNext
            Do While Not .EOF
               strMsg = strMsg & "　　　　　" & .Fields("Cust") & vbCrLf
               .MoveNext
            Loop
         End If
         End With
         intQ = MsgBox(strMsg, vbQuestion + vbYesNo + vbDefaultButton1)
      End If
      
      If intQ = vbYes Then
                  
         SetPTByLC47 "" & RsQ.Fields("CRL84"), strSys, strCP10
         SrcSetField strSys
         SrcLoadCustbyCRL01 strLOS17
         Call GetReceiptTitle

         If strCP10 <> "" Then
            arrCP10 = Split(strCP10, ",")
            For jj = 0 To UBound(arrCP10)
               If arrCP10(jj) = "" Then Exit For
'               For ii = 0 To Combo1(1 + jj).ListCount - 1
'                  If Left(Combo1(1 + jj).List(ii), 3) = arrCP10(jj) Then
'                     Combo1(1 + jj).ListIndex = ii
'                     Combo1_LostFocus 1 + jj
'                     Text1(101 + 3 * jj).Text = "0"
'                     Text1(102 + 3 * jj).Text = "0"
'                     Text1(103 + 3 * jj).Text = "0.000"
'                     Exit For
'                  End If
'               Next
               For ii = 0 To Combo1(1).ListCount - 1
                  If Left(Combo1(1).List(ii), 3) = arrCP10(jj) Then
                     Combo1(1).ListIndex = ii
                     Combo1_LostFocus 1
                     Text1(101).Text = "0"
                     Text1(102).Text = "0"
                     Text1(103).Text = "0.000"
                     Call cmdUpd_Click '新增
                     Exit For
                  End If
               Next
            Next
         End If
         SrcLoadCheck3 = True
      Else
         SrcDeletSource strLOS15, strLOS17
         SrcLOSReset
         SrcSetButton 'Added by Morgan 2024/3/22
      End If
   End If
   
   Set RsQ = Nothing
   Set RsQ2 = Nothing
End Function
'Added by Morgan 2020/6/23
'檢查是否有B1法務案補收款未輸入
Private Function SrcLoadCheck4() As Boolean
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   Dim strMsg As String, strSys As String, strCP10 As String, strCP10s As String, ii As Integer, jj As Integer
   Dim arrCP10() As String
   
   '有B1案源且有法務收文號但無案源收文號
   stSQL = "select LOS15,CP01||'-'||CP02||DECODE(CP03||CP04,'000','','-'||CP03||'-'||CP04) CaseNo,CP01,CP02,CP03,CP04,CP31,LOS18,LOS19" & _
      ",cpm03 Prty,LC05,LC11,LC43,LC44,LC45,LC46,LC47,c1.cu04 Cus1,c2.cu04 Cus2,c3.cu04 Cus3,c4.cu04 Cus4,c5.cu04 Cus5" & _
      " From LawOfficeSource,caseprogress a,casepropertymap,lawcase,customer c1,customer c2,customer c3,customer c4,customer c5" & _
      " where instr(LOS04,'" & Text1(10) & "')=1 and LOS02='B1' and los01 is null and los06 is not null and los18 is not null and los19='78' and los20 is null" & _
      " and cp09(+)=los06 and cp01<>'FCL' and lc01(+)=cp01 and lc02(+)=cp02 and lc03(+)=cp03 and lc04(+)=cp04" & _
      " and cpm01(+)=cp01 and cpm02(+)=cp10" & _
      " and c1.cu01(+)=substr(LC11,1,8) and c1.cu02(+)=substr(LC11,9)" & _
      " and c2.cu01(+)=substr(LC43,1,8) and c2.cu02(+)=substr(LC43,9)" & _
      " and c3.cu01(+)=substr(LC44,1,8) and c3.cu02(+)=substr(LC44,9)" & _
      " and c4.cu01(+)=substr(LC45,1,8) and c4.cu02(+)=substr(LC45,9)" & _
      " and c5.cu01(+)=substr(LC46,1,8) and c5.cu02(+)=substr(LC46,9)" & _
      " and not exists(select * from caseprogress b where b.cp162=los15 and b.cp01<>a.cp01)"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      strLSourceType = "B1"
      With RsQ
      strMsg = IIf(strUserNum = Text1(10), "您", lblStaffName & " ") & "尚有法務案【補收款】收文內容未完成，是否要繼續？" & vbCrLf & vbCrLf
      strMsg = strMsg & "案源單號：" & .Fields("LOS15") & vbCrLf
      strMsg = strMsg & "法務案號：" & .Fields("CaseNo") & vbCrLf
      strMsg = strMsg & "案件名稱：" & .Fields("LC05") & vbCrLf
      strMsg = strMsg & "案件性質：" & .Fields("Prty") & vbCrLf
      strMsg = strMsg & "　申請人：" & .Fields("Cus1") & vbCrLf
      If Not IsNull(.Fields("LC43")) Then
         strMsg = strMsg & "　　　　　" & .Fields("Cus2") & vbCrLf
      End If
      If Not IsNull(.Fields("LC44")) Then
         strMsg = strMsg & "　　　　　" & .Fields("Cus3") & vbCrLf
      End If
      If Not IsNull(.Fields("LC45")) Then
         strMsg = strMsg & "　　　　　" & .Fields("Cus4") & vbCrLf
      End If
      If Not IsNull(.Fields("LC46")) Then
         strMsg = strMsg & "　　　　　" & .Fields("Cus5") & vbCrLf
      End If
      
      If MsgBox(strMsg, vbQuestion + vbYesNo + vbDefaultButton1) = vbYes Then
         strLCaseCP10 = "78"
         strLOS15 = "" & .Fields("LOS15") '案源單號
         strLOS18 = "" & .Fields("LOS18") 'P/T接洽單號
         strCP10s = "" & .Fields("LOS19") '法務案預設收文性質
         
         strLCaseNo(1) = "" & .Fields("CP01")
         strLCaseNo(2) = "" & .Fields("cp02")
         strLCaseNo(3) = "" & .Fields("cp03")
         strLCaseNo(4) = "" & .Fields("cp04")
         SrcSetField "L"
         
         arrCP10 = Split(strCP10s, ",")
         For jj = 0 To UBound(arrCP10)
            strCP10 = arrCP10(jj)
            If strCP10 <> "" Then
'               For ii = 0 To Combo1(1 + jj).ListCount - 1
'                  If InStr(Combo1(1 + jj).List(ii), strCP10 & " ") = 1 Then
'                     Combo1(jj + 1).ListIndex = ii
'                     Combo1_LostFocus jj + 1
'                     Exit For
'                  End If
'               Next
               For ii = 0 To Combo1(1).ListCount - 1
                  If Left(Combo1(1).List(ii), 3) = strCP10 Then
                     Combo1(1).ListIndex = ii
                     Combo1_LostFocus 1
                     Call cmdUpd_Click '新增
                     Exit For
                  End If
               Next
            End If
         Next
         SrcLoadCheck4 = True
      Else
         SrcLOSReset
      End If
      End With
   End If
   
   Set RsQ = Nothing
   
End Function
'刪除案源
Private Sub SrcDeletSource(pLOS15 As String, Optional pCRL01 As String)
   Dim stSQL As String, intR As Integer
   
   cnnConnection.BeginTrans
On Error GoTo ErrHnd
   
   If pCRL01 <> "" Then
   'Modified by Morgan 2024/3/22 改呼叫函數
   '   stSQL = "delete consultrecordlist where crl01='" & pCRL01 & "'"
   '   cnnConnection.Execute stSQL, intR
   '
   '   stSQL = "delete ConsultRecApp where CRA01='" & pCRL01 & "'"
   '   cnnConnection.Execute stSQL, intR
   '
   '   'Add By Sindy 2022/8/30
   '   stSQL = "delete ConsultRecCMP where CRC01='" & pCRL01 & "'"
   '   cnnConnection.Execute stSQL, intR
      If PUB_DelCRLAllData(pCRL01) = False Then
         cnnConnection.RollbackTrans
         Exit Sub
      End If
   'end 2024/3/22
   End If
   
   'Added by Morgan 2024/3/22
   stSQL = "delete caseprogress where cp09 in (select los10 from LawOfficeSource where los15='" & pLOS15 & "')"
   cnnConnection.Execute stSQL, intR
   'end 2024/3/22

   stSQL = "delete LawOfficeSource where LOS15='" & pLOS15 & "'"
   cnnConnection.Execute stSQL, intR
   
   cnnConnection.CommitTrans
   Exit Sub
   
ErrHnd:
   cnnConnection.RollbackTrans
   MsgBox Err.Description, vbCritical
   
End Sub

Private Sub SrcCustValidate()
   If Text1(12) <> "" Then Text1_Validate 12, False
   If Text1(28) <> "" Then Text1_Validate 28, False
   If Text1(44) <> "" Then Text1_Validate 44, False
   If Text1(60) <> "" Then Text1_Validate 60, False
   If Text1(76) <> "" Then Text1_Validate 76, False
End Sub

Private Sub SrcSetField(pSys As String, Optional pNewCase As Boolean)
   
   'Modified by Morgan 2020/8/3 +C類也可能有法務舊案
   'Removed by Morgan 2021/7/19 取消 C類案源
   'If (bolIsB2CourtFee = True Or strLSourceType = "B1" Or strLSourceType = "B2" Or strLSourceType = "C") And strLCaseNo(1) <> "" Then
   If (bolIsB2CourtFee = True Or strLSourceType = "B1" Or strLSourceType = "B2") And strLCaseNo(1) <> "" Then
      '本所案號
      Option1(1).Value = True
      Text1(6).Text = strLCaseNo(1)
      Text1(7).Text = strLCaseNo(2)
      Text1(8).Text = strLCaseNo(3)
      Text1(9).Text = strLCaseNo(4)
      Text1_LostFocus 9
   Else
      'Option1(1).Value = True
      Option1(0).Value = True '預設新案
      '要先設國家再設系統別才會載入案件性質清單
      '國家
      'Modify By Sindy 2024/2/21
      'SetComboCase 0, "000"
      'SetComboCase 0, Combo1(0).Text
      Call frm090801_New_SetComboCase(0, "000", Combo1(0), Me.Text1(6).Text, _
            Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
      Call frm090801_New_SetComboCase(0, Combo1(0).Text, Combo1(0), Me.Text1(6).Text, _
            Combo1(0).Text, ChkPCT, Text1(101), Text1(102), Text1(103))
      '2024/2/21 END
      
      '本所案號
      Text1(6).Text = pSys
      Text1_LostFocus 6
      Text1(7).Text = ""
      Text1(8).Text = ""
      Text1(9).Text = ""
      '主題
      'If pSys = "L" Then Text1(11) = ""
      If Text1(11).Enabled Then Text1(11).SetFocus
      
   End If
   
   '鎖住欄位
   SrcLockField True, pNewCase
   
   If pSys = "L" Then
      If strPTSysCode = "P" Then Check3(0).Value = vbChecked
      If strPTSysCode = "T" Then Check3(1).Value = vbChecked
      If strPTSysCode = "TC" Then Check3(2).Value = vbChecked
      SrcSetButton
   End If
End Sub

'Added by Morgan 2020/5/6
'案源輸入欄位控制(BC輸法務案或B1補PT配合開庭)
Private Sub SrcLockField(pLocked As Boolean, Optional pNewPTCase As Boolean)
   
   If pLocked = True Then
      '舊案
      If Option1(1).Value = True Then
         If Text1(6) <> "L" Then
            Option1(0).Enabled = False
            Text1(7).Enabled = False
            Text1(8).Enabled = False
            Text1(9).Enabled = False
         End If
         
      '新案
      'P/T案為新案時,法務案也要是新案
      ElseIf Text1(6) = "L" And pNewPTCase = True Then
         Option1(1).Enabled = False
      End If
   Else
      Option1(0).Enabled = True
      Option1(1).Enabled = True
      If Option1(1).Value = True Then
         Text1(7).Enabled = pLocked
         Text1(8).Enabled = pLocked
         Text1(9).Enabled = pLocked
      End If
   End If
   
   Text1(6).Locked = pLocked '系統別
   Combo1(0).Locked = pLocked '申請國家
   Text1(10).Locked = pLocked '介紹人(智權人員)
End Sub
'Added by Morgan 2020/5/29
'以案源單號載入法務案接洽單預設資料
Private Sub SrcLoadLCasebyLOS15(pLOS15 As String)
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   
   stSQL = "select LOS02,CP01,CP31,nvl(PA26,TM23) Cus1,nvl(PA27,TM78) Cus2" & _
      ",nvl(PA28,TM79) Cus3,nvl(PA29,TM80) Cus4,nvl(PA30,TM81) Cus5" & _
      " from LawOfficeSource,caseprogress,patent,trademark" & _
      " where los15='" & pLOS15 & "' and cp09(+)=los01" & _
      " and pa01(+)=cp01 and pa02(+)=cp02 and pa03(+)=cp03 and pa04(+)=cp04" & _
      " and tm01(+)=cp01 and tm02(+)=cp02 and tm03(+)=cp03 and tm04(+)=cp04"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      With RsQ
      strLSourceType = "" & .Fields("LOS02")
      strPTSysCode = .Fields("CP01")
      'P/T是否新案
      If .Fields("CP31") = "Y" Then
         bolPTIsNew = True
      Else
         bolPTIsNew = False
      End If
      
      SrcSetField "L", bolPTIsNew
      strCUNo(1) = "" & .Fields("Cus1")
      strCUNo(2) = "" & .Fields("Cus2")
      strCUNo(3) = "" & .Fields("Cus3")
      strCUNo(4) = "" & .Fields("Cus4")
      strCUNo(5) = "" & .Fields("Cus5")
      SrcSetCustByVar
      
      End With
   End If
   Set RsQ = Nothing
End Sub

'Adde by Morgan 2020/5/29
Private Sub SrcSetCustByVar()
   '申請人1
   If strCUNo(1) <> "" Then
      Option31(1).Value = True
      Text1(12) = strCUNo(1)
   End If
   '申請人2
   If strCUNo(2) <> "" Then
      Option32(1).Value = True
      Text1(28) = strCUNo(1)
   End If
   '申請人3
   If strCUNo(3) <> "" Then
      Option33(1).Value = True
      Text1(44) = strCUNo(3)
   End If
   '申請人4
   If strCUNo(4) <> "" Then
      Option34(1).Value = True
      Text1(60) = strCUNo(4)
   End If
   '申請人5
   If strCUNo(5) <> "" Then
      Option35(1).Value = True
      Text1(76) = strCUNo(5)
   End If
   SrcCustValidate
End Sub
'Added by Morgan 2020/5/6
'載入申請人資料 (參照QueryData)
Private Sub SrcLoadCustbyCRL01(pCRL01 As String)
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   Dim intIndex As Integer, intIndex2 As Integer
   
   If pCRL01 = "" Then Exit Sub
   
   stSQL = "select * from ConsultRecApp C where CRA01='" & "" & pCRL01 & "' order by cra02 asc"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      With RsQ
      .MoveFirst
      Do While Not .EOF
         '申請人1
         If .Fields("CRA02") = "1" Then
            Me.SSTab2.Tab = 0
            If "" & .Fields("CRA03") = "Y" Then Option31(0).Value = True Else Option31(1).Value = True
            If "" & .Fields("CRA25") = "Y" Then
               optCP811(0).Value = True
            ElseIf "" & .Fields("CRA25") = "N" Then
               optCP811(1).Value = True
            End If
         '申請人2
         ElseIf .Fields("CRA02") = "2" Then
            Me.SSTab2.Tab = 1
            If "" & .Fields("CRA03") = "Y" Then Option32(0).Value = True Else Option32(1).Value = True
            If "" & .Fields("CRA25") = "Y" Then
               optCP812(0).Value = True
            ElseIf "" & .Fields("CRA25") = "N" Then
               optCP812(1).Value = True
            End If
         '申請人3
         ElseIf .Fields("CRA02") = "3" Then
            Me.SSTab2.Tab = 2
            If "" & .Fields("CRA03") = "Y" Then Option33(0).Value = True Else Option33(1).Value = True
            If "" & .Fields("CRA25") = "Y" Then
               optCP813(0).Value = True
            ElseIf "" & .Fields("CRA25") = "N" Then
               optCP813(1).Value = True
            End If
         '申請人4
         ElseIf .Fields("CRA02") = "4" Then
            Me.SSTab2.Tab = 3
            If "" & .Fields("CRA03") = "Y" Then Option34(0).Value = True Else Option34(1).Value = True
            If "" & .Fields("CRA25") = "Y" Then
               optCP814(0).Value = True
            ElseIf "" & .Fields("CRA25") = "N" Then
               optCP814(1).Value = True
            End If
         '申請人5
         ElseIf .Fields("CRA02") = "5" Then
            Me.SSTab2.Tab = 4
            If "" & .Fields("CRA03") = "Y" Then Option35(0).Value = True Else Option35(1).Value = True
            If "" & .Fields("CRA25") = "Y" Then
               optCP815(0).Value = True
            ElseIf "" & .Fields("CRA25") = "N" Then
               optCP815(1).Value = True
            End If
         End If
         intIndex = .Fields("CRA02")
         If Not IsNull(.Fields("CRA04")) Then Text1(IIf(intIndex = 1, 198, IIf(intIndex = 2, 298, IIf(intIndex = 3, 398, IIf(intIndex = 4, 498, 598))))) = .Fields("CRA04")
         If Not IsNull(.Fields("CRA05")) Then Text1(IIf(intIndex = 1, 12, IIf(intIndex = 2, 28, IIf(intIndex = 3, 44, IIf(intIndex = 4, 60, 76))))) = .Fields("CRA05") & .Fields("CRA06")
         
         If Not IsNull(.Fields("CRA07")) Then
            intIndex2 = IIf(intIndex = 1, 21, IIf(intIndex = 2, 37, IIf(intIndex = 3, 53, IIf(intIndex = 4, 69, 85))))
            Text1(intIndex2) = .Fields("CRA07")
            Text1(intIndex2).Tag = Text1(intIndex2)
         End If
         If Not IsNull(.Fields("CRA08")) Then
            intIndex2 = IIf(intIndex = 1, 22, IIf(intIndex = 2, 38, IIf(intIndex = 3, 54, IIf(intIndex = 4, 70, 86))))
            Text1(intIndex2) = .Fields("CRA08")
            Text1(intIndex2).Tag = Text1(intIndex2)
         End If
         
         If Not IsNull(.Fields("CRA09")) Then Text1(IIf(intIndex = 1, 23, IIf(intIndex = 2, 39, IIf(intIndex = 3, 55, IIf(intIndex = 4, 71, 87))))) = .Fields("CRA09")
         If Not IsNull(.Fields("CRA10")) Then cboContact(intIndex) = .Fields("CRA10")
         If Not IsNull(.Fields("CRA11")) Then Text1(IIf(intIndex = 1, 34, IIf(intIndex = 2, 50, IIf(intIndex = 3, 66, IIf(intIndex = 4, 82, 98))))) = .Fields("CRA11")
         If Not IsNull(.Fields("CRA12")) Then Text1(IIf(intIndex = 1, 92, IIf(intIndex = 2, 93, IIf(intIndex = 3, 94, IIf(intIndex = 4, 95, 96))))) = .Fields("CRA12")
         If Not IsNull(.Fields("CRA13")) Then Text1(IIf(intIndex = 1, 14, IIf(intIndex = 2, 30, IIf(intIndex = 3, 46, IIf(intIndex = 4, 62, 78))))) = .Fields("CRA13")
         If Not IsNull(.Fields("CRA14")) Then Text1(IIf(intIndex = 1, 15, IIf(intIndex = 2, 31, IIf(intIndex = 3, 47, IIf(intIndex = 4, 63, 79))))) = .Fields("CRA14")
         If Not IsNull(.Fields("CRA15")) Then Text1(IIf(intIndex = 1, 16, IIf(intIndex = 2, 32, IIf(intIndex = 3, 48, IIf(intIndex = 4, 64, 80))))) = .Fields("CRA15")
         If Not IsNull(.Fields("CRA16")) Then Text1(IIf(intIndex = 1, 17, IIf(intIndex = 2, 33, IIf(intIndex = 3, 49, IIf(intIndex = 4, 65, 81))))) = .Fields("CRA16")
         If Not IsNull(.Fields("CRA17")) Then Text1(IIf(intIndex = 1, 19, IIf(intIndex = 2, 35, IIf(intIndex = 3, 51, IIf(intIndex = 4, 67, 83))))) = .Fields("CRA17")
         If Not IsNull(.Fields("CRA18")) Then Text1(IIf(intIndex = 1, 20, IIf(intIndex = 2, 36, IIf(intIndex = 3, 52, IIf(intIndex = 4, 68, 84))))) = .Fields("CRA18")
         If Not IsNull(.Fields("CRA19")) Then Text1(IIf(intIndex = 1, 120, IIf(intIndex = 2, 121, IIf(intIndex = 3, 122, IIf(intIndex = 4, 123, 124))))) = .Fields("CRA19")
         If Not IsNull(.Fields("CRA20")) Then Text1(IIf(intIndex = 1, 27, IIf(intIndex = 2, 43, IIf(intIndex = 3, 59, IIf(intIndex = 4, 75, 91))))) = .Fields("CRA20")
         If Not IsNull(.Fields("CRA21")) Then Text1(IIf(intIndex = 1, 125, IIf(intIndex = 2, 141, IIf(intIndex = 3, 157, IIf(intIndex = 4, 173, 189))))) = .Fields("CRA21")
         If Not IsNull(.Fields("CRA22")) Then Text1(IIf(intIndex = 1, 25, IIf(intIndex = 2, 41, IIf(intIndex = 3, 57, IIf(intIndex = 4, 73, 89))))) = .Fields("CRA22")
         If Not IsNull(.Fields("CRA23")) Then Text1(IIf(intIndex = 1, 26, IIf(intIndex = 2, 42, IIf(intIndex = 3, 58, IIf(intIndex = 4, 74, 90))))) = .Fields("CRA23")
         If Not IsNull(.Fields("CRA24")) Then Text1(IIf(intIndex = 1, 24, IIf(intIndex = 2, 40, IIf(intIndex = 3, 56, IIf(intIndex = 4, 72, 88))))) = .Fields("CRA24")
         .MoveNext
      Loop
      End With
      SrcCustValidate
   End If
   Set RsQ = Nothing
End Sub

'Added by Morgan 2020/5/20
'檢查客戶是否與接洽單相同
Private Function SrcCheckSameCust(pCRA01 As String) As Boolean
   Dim ii As Integer, strID As String, strNameC As String, strNameE As String, strMsg As String
   
   If pCRA01 <> "" Then
      strExc(0) = "select * from ConsultRecApp where CRA01='" & "" & pCRA01 & "' order by cra02 asc"
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
      If intI = 1 Then
         With RsTemp
         Do While Not .EOF
            ii = .Fields("cra02")
            strID = Text1(12 + 16 * (ii - 1))
            strNameC = Text1(21 + 16 * (ii - 1))
            strNameE = Text1(22 + 16 * (ii - 1))
            '有客戶編號
            If .Fields("cra05") & .Fields("cra06") <> "" Then
               If .Fields("cra05") & .Fields("cra06") <> strID Then
                  SSTab1.Tab = 1
                  SSTab2.Tab = ii - 1
                  MsgBox "申請人" & ii & "【" & strID & "】與 P/T案【" & .Fields("cra05") & .Fields("cra06") & "】不同，請確認！"
                  Exit Function
                  'Mark by Lydia 2021/09/07 (保留)法務舊案客戶和P/T案舊案客戶編號不一致，改成詢問；ex.P-074838用X29213000(個人), L-006229用X29213120(磐石)
                  '-------目前不啟用的原因：因為該案是去年案源未上線前收文，所以理論不應收；修改程式先保留
                  'If MsgBox("申請人" & ii & "【" & strID & "】與 P/T案【" & .Fields("cra05") & .Fields("cra06") & "】不同，請確認是否繼續？", vbExclamation + vbYesNo + vbDefaultButton2) = vbNo Then
                  '    Exit Function
                  'End If
                  'end 2021/09/07
               End If
            '中文名稱
            ElseIf "" & .Fields("CRA07") <> "" Then
               If .Fields("CRA07") <> strNameC Then
                  SSTab1.Tab = 1
                  SSTab2.Tab = ii - 1
                  MsgBox "申請人" & ii & "【" & strNameC & "】與 P/T案【" & .Fields("cra07") & "】不同，請確認！"
                  Exit Function
               End If
            '英文名稱
            ElseIf "" & .Fields("CRA08") <> "" Then
               If .Fields("CRA08") <> strNameE Then
                  SSTab1.Tab = 1
                  SSTab2.Tab = ii - 1
                  MsgBox "申請人" & ii & "【" & strNameE & "】與 P/T案【" & .Fields("cra08") & "】不同，請確認！"
                  Exit Function
               End If
            End If
            .MoveNext
         Loop
         End With
         
         If ii < 5 Then
            ii = ii + 1
            strNameC = Text1(21 + 16 * (ii - 1))
            strNameE = Text1(22 + 16 * (ii - 1))
            If strNameC <> "" Then
               SSTab1.Tab = 1
               SSTab2.Tab = ii - 1
               MsgBox "P/T案無申請人" & ii & "【" & strNameC & "】，請確認！"
               Exit Function
            ElseIf strNameE <> "" Then
               SSTab1.Tab = 1
               SSTab2.Tab = ii - 1
               MsgBox "P/T案無申請人" & ii & "【" & strNameE & "】，請確認！"
               Exit Function
            End If
         End If
      End If
   
   'Modified by Morgan 2024/9/20 程式調整
   ElseIf strLOS15 <> "" Then
      If Text1(6) = "L" Then
         strExc(1) = "P/T/TC"
      Else
         strExc(1) = "法務"
      End If
                  
      For ii = 1 To 5
         strID = Text1(12 + 16 * (ii - 1))
         strNameC = Text1(21 + 16 * (ii - 1))
         '舊客戶
         If strID <> "" Then
            If strID <> strCUNo(ii) Then
               SSTab1.Tab = 1
               SSTab2.Tab = ii - 1
               If strCUNo(ii) <> "" Then
                  strMsg = "申請人" & ii & "(" & strID & ")與" & strExc(1) & "案【" & strCUNo(ii) & "】不同，請確認！"
                  MsgBox strMsg, vbExclamation
               Else
                  MsgBox strExc(1) & "案並無申請人" & ii & "，請確認！", vbExclamation
               End If
               Exit Function
            End If
            
         '新客戶
         ElseIf strNameC <> "" Then
            SSTab1.Tab = 1
            SSTab2.Tab = ii - 1
            If strCUNo(ii) <> "" Then
               MsgBox "申請人" & ii & "【" & strNameC & "】與" & strExc(1) & "案【" & strCUNo(ii) & "】不同，請確認！", vbExclamation
            Else
               MsgBox strExc(1) & "案並無申請人" & ii & "，請確認！", vbExclamation
            End If
            Exit Function
            
         ElseIf strCUNo(ii) <> "" Then
            SSTab1.Tab = 1
            SSTab2.Tab = ii - 1
            MsgBox "本案無申請人" & ii & "與" & strExc(1) & "案【" & strCUNo(ii) & "】不同，請確認！", vbExclamation
            
            Exit Function
         End If
      Next
      
   End If
   SrcCheckSameCust = True
End Function
'案源變數清除
Private Sub SrcLOSReset()
   Erase strLCaseNo
   Erase strCUNo
      
   bolSuYuan = False
   bolIsB2CourtFee = False
   bolPTIsNew = False
   
   strLCaseCP10 = ""
   strLSourceType = ""
   strCheckStatus = ""
   strPTSysCode = ""
   strPTCP10 = ""
   strLOS15 = ""
   strLOS17 = ""
   strLOS18 = ""
   
   SrcLockField False
End Sub

'檢查是否有案源
Private Function SrcCheckExistLOS(PTCaseNo1 As String, PTCaseNo2 As String, PTCaseNo3 As String, PTCaseNo4 As String, LCaseNo() As String, Optional strType As String, Optional Pty As String) As Boolean
   Dim strCon As String
   
   If strType <> "" Then strCon = strCon & " and los02='" & strType & "'"
   'Modified by Morgan 2023/8/16 取消 and c1.cp159=0 條件，因銷案後可能會再收文 Ex:P-130276
   strExc(0) = "select cpm03,c2.cp01,c2.cp02,c2.cp03,c2.cp04 from caseprogress c1,lawofficesource,casepropertymap,caseprogress c2" & _
      " where c1.cp01='" & PTCaseNo1 & "' and c1.cp02='" & PTCaseNo2 & "' and c1.cp03='" & PTCaseNo3 & "' and c1.cp04='" & PTCaseNo4 & "'" & _
      " and los01(+)=c1.cp09 and c2.cp09(+)=LOS06 and c2.cp09 is not null" & strCon & " and cpm01(+)=c1.cp01 and cpm02(+)=c1.cp10 order by c1.cp05 desc"
   intI = 1
   Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
   '有案源
   If intI > 0 Then
      SrcCheckExistLOS = True
      LCaseNo(1) = "" & RsTemp("cp01")
      LCaseNo(2) = "" & RsTemp("cp02")
      LCaseNo(3) = "" & RsTemp("cp03")
      LCaseNo(4) = "" & RsTemp("cp04")
      Pty = "" & RsTemp("cpm03")
   End If
End Function

'檢查是否訴願階段:有收文訴願且無准駁(有可能發文後才收文言詞辯論 Ex:T-225478)
Private Function SrcChkIsSuYuan(pCP01 As String, pCP02 As String, pCP03 As String, pCP04 As String, pCP10s As String) As Boolean
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   Dim stB2 As String
      
   stSQL = "select * from caseprogress a" & _
      " where " & ChgCaseprogress(pCP01 & pCP02 & pCP03 & pCP04) & _
      " and cp159=0 and instr('" & pCP10s & "',cp10)>0 and cp24 is null"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      SrcChkIsSuYuan = True
   End If
   Set RsQ = Nothing
End Function
'抓法務相關P/T案
Private Function SrcGetPTCase(pLCase() As String, pPTCaseNo() As String) As Boolean
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   
   stSQL = "select b.cp01,b.cp02,b.cp03,b.cp04 from caseprogress a,caseprogress b" & _
      " where a.cp01='" & pLCase(1) & "' and a.cp02='" & pLCase(2) & "' and a.cp158=0" & _
      " and a.cp162 is not null and b.cp162(+)=a.cp162 and b.cp01<>a.cp01 and b.cp158=0" & _
      " union select b.cp01,b.cp02,b.cp03,b.cp04 from caseprogress a,acc0n0,caseprogress b" & _
      " where a.cp01='" & pLCase(1) & "' and a.cp02='" & pLCase(2) & "' and a.cp158=0" & _
      " and a0n01(+)=a1.cp09 and b.cp09(+)=a0n02 and b.cp09<>a0n01"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      pPTCaseNo(1) = RsQ("cp01")
      pPTCaseNo(2) = RsQ("cp02")
      pPTCaseNo(3) = RsQ("cp03")
      pPTCaseNo(4) = RsQ("cp04")
      SrcGetPTCase = True
   End If
   Set RsQ = Nothing
End Function

Private Function SrcGetProperty(pSys As String, pCP10s As String) As String
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   Dim stTemp As String
   
   stSQL = "select cpm03 from casepropertymap" & _
      " where cpm01='" & pSys & "' and cpm02 in (" & pCP10s & ")" & _
      " order by instr('" & pCP10s & "',cpm02) asc"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      With RsQ
      stTemp = "" & .Fields(0)
      .MoveNext
      Do While Not .EOF
         stTemp = stTemp & "、" & .Fields(0)
         .MoveNext
      Loop
      End With
      SrcGetProperty = stTemp
   End If
   
   Set RsQ = Nothing
End Function
'Added by Morgan 2020/6/17
Private Function SrcGetLC47() As String
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   
   If Option1(0).Value = True Then
      SrcGetLC47 = Text1(127)
   Else
      If bolPrintNewCase = True And Text1(8).Tag <> "" Then
         stSQL = " select lc47 from lawcase where lc01='" & Text1(6) & "' and lc02='" & Text1(7) & "' and lc03='" & Text1(8).Tag & "' and lc04='" & Text1(9) & "'"
      Else
         stSQL = "select lc47 from lawcase where lc01='" & Text1(6) & "' and lc02='" & Text1(7) & "' and lc03='" & Text1(8) & "' and lc04='" & Text1(9) & "'"
      End If
      intQ = 1
      Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
      If intQ = 1 Then
         SrcGetLC47 = "" & RsQ(0)
      End If
   End If
   Set RsQ = Nothing
End Function

'Added by Morgan 2020/6/17
'法務案是否為智財權類
'pAddElse
Private Function SrcChkLIsIPCase(pLC47 As String, Optional pPTOnly As Boolean = True) As Boolean
   If InStr(pLC47, "專利") > 0 Or InStr(pLC47, "商標") > 0 Or InStr(pLC47, "著作權") > 0 Then
      SrcChkLIsIPCase = True
   ElseIf pPTOnly = False Then
      If InStr(pLC47, "智財權") > 0 Then
         SrcChkLIsIPCase = True
      End If
   End If
End Function
'Added by Morgan 2020/6/17
'法務案是否為訴訟案
Private Function SrcChkLIsSuitCase() As Boolean
   Dim ii As Integer
   Dim arrTmp() As String
   
   If Trim(Left(Combo1(0), 4)) <> "000" Then Exit Function 'Added by Morgan 2024/9/19 只有台灣案有出庭費
   
   arrTmp = Split(m_strCaseCPM, ",")
   'For ii = 1 To 4
   For ii = 0 To UBound(arrTmp)
      'If Combo1(ii).Text <> "" Then
      If arrTmp(ii) <> "" Then
         'arrTmp = Split(Combo1(ii), " ")
         'If SrcChkIsB1CP10(Text1(6), arrTmp(0)) = True Then
         If SrcChkIsB1CP10(Text1(6), arrTmp(ii)) = True Then
            SrcChkLIsSuitCase = True
            Exit For
         End If
      End If
   Next ii
End Function

'Added by Morgan 2020/6/18
'以法務案類別設定PT案系統別及預設收文案件性質
Private Sub SetPTByLC47(pLC47 As String, pPTSys As String, pPTCP10 As String)
   If InStr(pLC47, "專利") > 0 Then
      pPTSys = "P"
      pPTCP10 = "226,225"
   ElseIf InStr(pLC47, "商標") > 0 Then
      pPTSys = "T"
      pPTCP10 = "213,212"
   Else
      pPTSys = "TC"
      pPTCP10 = "213,212"
   End If
End Sub

'Added by Morgan 2020/6/17
'法務案收文性質是否屬B1類(訴訟案件性質)
Private Function SrcChkIsB1CP10(pSys As String, pCP10 As String) As Boolean
   Dim stSQL As String, intQ As Integer
   Dim RsQ As ADODB.Recordset
   
   stSQL = "select cpm11 from casepropertymap where cpm01='" & pSys & "'and cpm02='" & pCP10 & "' and cpm11 in ('414101','416111','416121')"
   intQ = 1
   Set RsQ = ClsLawReadRstMsg(intQ, stSQL)
   If intQ = 1 Then
      SrcChkIsB1CP10 = True
   End If
   Set RsQ = Nothing
End Function

'Added by Morgan 2020/6/20
'列印P/T案接洽單
Private Sub SrcPrintSheet(pLOS15 As String, pCRL01 As String, pPrinter As String)
   Dim frmTmp As Form
   Set frmTmp = New frm090801_New
   With frmTmp
   .Load4Print pLOS15, pCRL01, False
   .cboPrinter = pPrinter
   .cmdOK(0).Value = True
   End With
   Unload frmTmp
   Set frmTmp = Nothing
End Sub

'Added by Lydia 2020/08/21 案件說明事項處理情形:第二頁開始改最大字數
Private Function GetPrintDetailWidth(ByVal pMaxL As Integer, ByVal PV01 As Integer, ByRef PV02 As Integer) As Integer

    GetPrintDetailWidth = PV01 + 1
    If GetPrintDetailWidth > pMaxL + 1 Then
        PV02 = 90
    End If
End Function

'Add by Amy 2020/09/01 判斷是否為大陸地址
Private Function ChkCN(ByVal stCuAddr As String) As Boolean
    Dim RsQ As New ADODB.Recordset
    Dim intQ As Integer
    Dim strQ As String, stAddr As String
    
    ChkCN = False
    stAddr = stCuAddr
    '去除中國大陸/大陸/中國 文字,取其前3個字或2個字查國家檔域別為大陸地區
    If Left(stAddr, 4) = "中國大陸" Then stAddr = Mid(stAddr, 5)
    If Left(stAddr, 2) = "中國" Then stAddr = Mid(stAddr, 3)
    If Left(stAddr, 2) = "大陸" Then stAddr = Mid(stAddr, 3)
    
    strQ = "Select * From Nation Where Na03='" & Left(stAddr, 3) & "' And SubStr(Na02,1,1)='B' "
    intQ = 1
    Set RsQ = ClsLawReadRstMsg(intQ, strQ)
    If intQ = 1 Then
        ChkCN = True
    Else
        strQ = "Select * From Nation Where Na03='" & Left(stAddr, 2) & "' And SubStr(Na02,1,1)='B' "
        intQ = 1
        Set RsQ = ClsLawReadRstMsg(intQ, strQ)
        If intQ = 1 Then
            ChkCN = True
        End If
    End If
    
    Set RsQ = Nothing
End Function

'Added by Morgan 2020/11/9
'TW-SUPA僅適用於沒有主張優先權的台灣案
Private Function ChkTwSupa() As Boolean
   Dim ii As Integer, jj As Integer
   Dim stCP10 As String, stCP10_1 As String, stCP10_2 As String
   Dim bCancel As Boolean
   
   ChkTwSupa = True
   'For ii = 1 To 4
      'stCP10 = Trim(Left(Me.Combo1(ii).Text, 4))
      'If stCP10 = "434" Or stCP10 = "106" Then
      If InStr(m_strCaseCPM, "434") > 0 Or InStr(m_strCaseCPM, "106") > 0 Then
         'If stCP10 = "434" Then
         If InStr(m_strCaseCPM, "434") > 0 Then
            stCP10_2 = "106"
         Else
            stCP10_2 = "434"
         End If
         
         'For jj = 1 To 4
            'stCP10 = Trim(Left(Me.Combo1(jj).Text, 4))
            'If stCP10 = stCP10_2 Then
            If InStr(m_strCaseCPM, stCP10_2) > 0 Then
               ChkTwSupa = False
               'Exit For
            End If
         'Next
         
         If ChkTwSupa = True Then
            '舊案再檢查收文
            If Option1(1).Value = True Then
               strExc(0) = "select cp09 from caseprogress where " & ChgCaseprogress(Text1(6) & Text1(7) & Text1(8) & Text1(9)) & " and cp10='" & stCP10_2 & "' and cp57 is null"
               intI = 1
               Set RsTemp = ClsLawReadRstMsg(intI, strExc(0))
               If intI = 1 Then
                  ChkTwSupa = False
               End If
            End If
         End If
         
         If ChkTwSupa = False Then
            If stCP10_2 = "434" Then
               MsgBox "此案有申請TW-SUPA，不應主張國際優先權，請確認!!", vbCritical
            Else
               MsgBox "此案有主張國際優先權，不得申請TW-SUPA!!", vbCritical
            End If
            Exit Function
         End If
         
      End If
   'Next
End Function

'Added by Lydia 2021/02/24
Private Sub Text7_KeyPress(KeyAscii As MSForms.ReturnInteger)
   If Text1(6).Text = "CFT" Then
      KeyAscii = UpperCase(KeyAscii)
   End If
   '原本主題有下列控制，先保留
   'If KeyAscii = 91 Or KeyAscii = 93 Or KeyAscii = -24219 Or KeyAscii = -24218 Then
   '     MsgBox Replace(fra47Title.Caption & "禁止打中括號!!!", "：", ""), vbExclamation + vbOKOnly
   '     KeyAscii = 0
   'End If
End Sub

Private Sub Text7_GotFocus()
    TextInverse Text7
End Sub

'Added by Morgan 2021/4/16
'自動收文減免退費919
Private Sub AutoAdd919(Optional bolCallAdd As Boolean = False)
   Dim ii As Integer, jj As Integer
   
'   jj = 0
'   For ii = 1 To 4
'      If Left(Combo1(ii), 3) = "919" Then
'         Exit For
'      ElseIf Combo1(ii) = "" And jj = 0 Then
'         jj = ii
'      End If
'   Next
   If InStr(m_strCaseCPM, "919") > 0 Then
      Exit Sub
   End If
'   If ii = 5 Then
'      If jj = 0 Then
'         MsgBox "案件性質超過，無法新增【減免退費】！", vbExclamation
'      Else
'         For ii = 0 To Combo1(jj).ListCount - 1
'            If Left(Combo1(jj).List(ii), 3) = "919" Then
'               Combo1(jj).ListIndex = ii
'               Combo1_LostFocus jj
'               Text1(101 + 3 * (jj - 1)).Text = "0"
'               Text1(102 + 3 * (jj - 1)).Text = "0"
'               Text1(103 + 3 * (jj - 1)).Text = "0.000"
'               Exit For
'            End If
'         Next
         For ii = 0 To Combo1(1).ListCount - 1
            If Left(Combo1(1).List(ii), 3) = "919" Then
               Combo1(1).ListIndex = ii
               Combo1_LostFocus 1
               If bolCallAdd = True Then
                  Text1(101).Text = "0"
                  Text1(102).Text = "0"
                  Text1(103).Text = "0.000"
                  Call cmdUpd_Click '新增
               End If
               Exit For
            End If
         Next
'      End If
'   End If
End Sub

'Added by Lydia 2021/05/07 ACS智財顧問專業分配比例管制
Private Sub SetACS112data()
Dim pCP09 As String, pCP15 As String, pCP53 As String, pCP54 As String
Dim pACS01 As String, pACS02 As String, pACS03 As String, pACS04 As String
Dim pWHours As String, pWTimes As String, pNTimes As String
    
    m_ACS112msg = "": m_ACS112chk = ""
    If strSrvDate(1) < ACS_PFrateStart Then Exit Sub

    'Modified by Lydia 2021/07/05 +L,CFL,
    If Option1(1).Value = True And InStr("CFP,CFT,P,T,ACS,L,CFL,", Text1(6) & ",") > 0 And Len(Trim(Text1(7))) = 6 Then
        If Pub_GetACS112Range(Text1(6), Text1(7), IIf(Trim(Text1(8)) <> "", Trim(Text1(8)), "0"), IIf(Trim(Text1(9)) <> "", Trim(Text1(9)), "00"), pCP09, pCP15, pCP53, pCP54, pACS01, pACS02, pACS03, pACS04) = True Then
             If strSrvDate(1) >= pCP54 Then
                 If Text1(6) = "ACS" Then
                     If InStr(m_strCaseCPM & ",", "112,") = 0 Then
                         m_ACS112chk = "此案智財顧問期間已過期，除智財顧問112外，不可再收文！"
                     End If
                 Else
                     m_ACS112chk = "此案之相關智財顧問" & pACS01 & "-" & pACS02 & IIf(pACS03 <> "0", "-" & pACS03, "") & IIf(pACS04 <> "00", "-" & pACS04, "") & _
                                   "，顧問期間：" & ChangeWStringToTDateString(pCP53) & "~" & ChangeWStringToTDateString(pCP54) & "已過期，不可再收文！"
                 End If
                 If m_ACS112chk <> "" Then
                    MsgBox m_ACS112chk, vbExclamation, "ACS智財顧問管制"
                    Exit Sub
                 End If
             End If
             
             If Text1(6) = "ACS" Then
                m_ACS112msg = ACS112STATISTICS("1", Text1(6), Text1(7), IIf(Trim(Text1(8)) <> "", Trim(Text1(8)), "0"), IIf(Trim(Text1(9)) <> "", Trim(Text1(9)), "00"), pCP09, pCP15, pCP53, pCP54, pWHours, pWTimes, pNTimes)
             Else
                m_ACS112msg = ACS112STATISTICS("1", pACS01, pACS02, pACS03, pACS04, pCP09, pCP15, pCP53, pCP54, pWHours, pWTimes, pNTimes)
             End If
             If Val(pWHours) >= Val(pCP15) Then
                 If Text1(6) = "ACS" Then
                     If InStr(m_strCaseCPM & ",", "112,") = 0 Then
                          m_ACS112chk = "此案智財顧問案總工作時數已達簽約時數，除智財顧問112外，不可再收文！"
                     End If
                 Else
                    m_ACS112chk = "此案之相關智財顧問" & pACS01 & "-" & pACS02 & IIf(pACS03 <> "0", "-" & pACS03, "") & IIf(pACS04 <> "00", "-" & pACS04, "") & _
                                   "，總工作時數已達簽約時數，不可再收文！"
                 End If
                 If m_ACS112chk <> "" Then
                    MsgBox m_ACS112chk, vbExclamation, "ACS智財顧問管制"
                    Exit Sub
                 End If
             End If
             
             If strSrvDate(1) >= pCP53 And strSrvDate(1) < pCP54 Then
                 If Text1(6) <> "ACS" Then  '追加相關ACS案號
                     'Modified by Lydia 2021/07/05 + vbCrlf
                     m_ACS112msg = "智財顧問案：" & pACS01 & "-" & pACS02 & IIf(pACS03 <> "0", "-" & pACS03, "") & IIf(pACS04 <> "00", "-" & pACS04, "") & "，" & vbCrLf & m_ACS112msg
                 End If
                 MsgBox m_ACS112msg, vbInformation, "ACS智財顧問管制"
             End If
        End If
    End If
End Sub

'Added by Lydia 2021/06/16 尾聲：為了自動轉收文完成後，還能還原預設
'Memo by Lydia 2022/08/19 刪除其他自動轉收文測試程式
Private Sub ProcToFinal(ByVal bolPrintPT As Boolean)
Dim objOpt As Object

   'Add By Sindy 2010/6/29 使用者再列印下一個案號時, 增加查看其收據抬頭的正確性
   Option2(0).Value = False
   Option2(2).Value = False
   Option2(1).Value = False
   '2010/6/29 End
   
   'Added by Lydia 2023/11/13 DEBIT NOTE請款選項;預設清空
   optDB(0).Value = False: optDB(1).Value = False
   Check7(2).Value = False: Check7(3).Value = False
   Frame33(1).Visible = False
   'end 2023/11/13
   
   'Add By Sindy 2024/6/27 按了新增之後，不論新舊案一律清除本所期限、法定期限及送件方式的欄位
   Text1(1).Text = ""
   Text1(3).Text = ""
   Text1(126).Text = ""
   For Each objOpt In Me.OptSendType '送件方式
      objOpt.Value = False
   Next
   For Each objOpt In Me.OptCP164 '指定日期方式
      objOpt.Value = False
   Next
   '2024/6/27 END
   
   ' 設定滑鼠游標為預設
   Screen.MousePointer = vbDefault
   Me.SSTab1.Tab = 0
   If Me.Text1(10).Enabled = True Then Me.Text1(10).SetFocus
   Me.txtPrintType = "2" '輸出方式,印表機
   m_blnCallPrint = False 'Add By Sindy 2010/6/21
   
   m_CP05 = "": m_CP09 = "" 'Add by Morgan 2011/1/10
   m_CP14 = ""
   m_strCRL57 = "" 'Add by Morgan 2011/1/13
   
   stChReceipt = "" 'Add by Amy 2020/02/14
   
   'Add By Sindy 2011/6/7 L案不同審級的訴訟收文時,清空(還原)母案的法務案件屬性欄,方便下一筆輸入
   'Remove by Lydia 2021/10/12 法務案收文新案號但為舊案之下一審級時，請自動帶舊案號之案件屬性到下一審級案號，以免分案時會發通知改案件屬性的email; ex. 10/8分案的L-006439-1
   'If bolPrintNewCase = True Then Frame19.Visible = False: Text1(127) = ""
   'Mark by Amy 2024/08/29 連續收不設地址變數=10
   'ClearAddrVar 1 'Add by Amy 2016/06/06
   
   'Modified by Morgan 2020/4/17
   'cmdOK(0).Caption = "列印(&P)　　份"
   'txtPCnt.Visible = True
   SrcSetButton
   If bolPrintPT = True Then
      SrcLOSReset
      cmdClear
   End If
   'end 2020/4/17
End Sub

'Added by Lydia 2021/09/07 記錄or還原案件說明處理事項->文件是否齊備等選項
Private Sub GetDocOptSet(ByVal pType As String, ByRef pRecStr As String)
Dim tmpArr1 As Variant
Dim intA As Integer
   
   If pType = "1" Then '記錄
       pRecStr = ""
       '資料是否齊備/文件是否齊備
       If OptEP06(0).Value = True Then pRecStr = pRecStr & "EP06:Y;"
       If OptEP06(1).Value = True Then pRecStr = pRecStr & "EP06:N;"
       '是否會稿
       If OptEP34(0).Value = True Then pRecStr = pRecStr & "EP34:Y;"
       If OptEP34(1).Value = True Then pRecStr = pRecStr & "EP34:N;"
'       '是否急件
'       If OptCP122(0).Value = True Then pRecStr = pRecStr & "CP122:Y;"
'       If OptCP122(1).Value = True Then pRecStr = pRecStr & "CP122:N;"
       '是否延期
       If OptCRL133(0).Value = True Then pRecStr = pRecStr & "CRL133:Y;"
       If OptCRL133(1).Value = True Then pRecStr = pRecStr & "CRL133:N;"
   ElseIf pType = "2" Then '還原
       If pRecStr = "" Then Exit Sub
       tmpArr1 = Split(pRecStr, ";")
       For intA = 0 To UBound(tmpArr1)
           If Trim(tmpArr1(intA)) <> "" Then
               Select Case Trim(tmpArr1(intA))
                    '資料是否齊備/文件是否齊備
                    Case "EP06:Y": OptEP06(0).Value = True
                    Case "EP06:N": OptEP06(1).Value = True
                    '是否會稿
                    Case "EP34:Y": OptEP34(0).Value = True
                    Case "EP34:N": OptEP34(1).Value = True
'                    '是否急件
'                    Case "CP122:Y": OptCP122(0).Value = True
'                    Case "CP122:N": OptCP122(1).Value = True
                    '是否延期
                    Case "CRL133:Y": OptCRL133(0).Value = True
                    Case "CRL133:N": OptCRL133(1).Value = True
               End Select
           End If
       Next intA
   End If
End Sub

'Added by Lydia 2021/11/23 判斷是否有商標查名 (因為T案增加737智財協作,調整判斷)
Private Function GetTMQArea() As Boolean
Dim intP As Integer, strP1 As String
Dim arrText As Variant
   
   m_strCaseCPM = GetAllCaseCPM() 'Add By Sindy 2022/9/12 取得案件性質代碼
   GetTMQArea = False
   strP1 = ""
   'Modified by Lydia 2022/02/24 debug : Text1(6).Text = "T" Or Text1(6).Text = "TS" => (Text1(6).Text = "T" Or Text1(6).Text = "TS")
   If strSrvDate(1) >= TMQ電子化啟用日 And (Text1(6).Text = "T" Or Text1(6).Text = "TS") And _
      Left(Trim(Combo1(0)), 3) = "000" And Option1(0).Value = True Then
      'Modify By Sindy 2022/12/24
      If Me.Combo1(1).Text <> "" Then
         m_strCaseCPM = m_strCaseCPM & IIf(m_strCaseCPM <> "", ",", "") & Trim(Left(Combo1(1).Text, 4))
      End If
      arrText = Split(m_strCaseCPM, ",")
      '2022/12/24 END
      'For intP = 1 To 4
      For intP = 0 To UBound(arrText)
         'If Trim(Left(Trim(Combo1(intP)), 4)) <> "" Then
         If arrText(intP) <> "" Then
            If Text1(6).Text = "T" Then
               'If InStr(TMQ_T案, Trim(Left(Trim(Combo1(intP)), 4))) > 0 Then
               If InStr(TMQ_T案, arrText(intP)) > 0 Then
                  strP1 = "Y"
                  Exit For 'Add By Sindy 2022/12/24
               End If
            ElseIf Text1(6).Text = "TS" Then
               'If InStr(TMQ_TS案, Trim(Left(Trim(Combo1(intP)), 4))) > 0 Then
               If InStr(TMQ_TS案, arrText(intP)) > 0 Then
                  strP1 = "Y"
                  Exit For 'Add By Sindy 2022/12/24
               End If
            End If
         End If
      Next intP
   End If
   
   If strP1 = "Y" Then GetTMQArea = True
End Function

'Added by Morgan 2022/1/25
Private Function WordModelOpen(Optional ByRef pFilePath As String) As Boolean
   Dim m_DefPath As String
   Dim m_FileID As String, m_FileName As String

On Error GoTo ErrHand
   
   m_DefPath = App.path & "\" & strUserNum
   
   '下載範本
   'M51-000301-0-00 接洽單-國內.docx
   If OptChoose(0).Value = True Then
      m_FileID = "M51-000301-0-00"
   'M51-000301-0-01 接洽單-外至台.docx
   Else
      m_FileID = "M51-000301-0-01"
   End If
   
   m_FileName = "$$" & strUserNum & "_" & strSrvDate(1) & ServerTime & ".order"
   pFilePath = m_DefPath & "\" & m_FileName
   If Dir(pFilePath) <> "" Then
      Kill pFilePath
   End If
   If PUB_GetSampleFile(m_FileName, m_FileID, , m_DefPath) = False Then
        Exit Function
   End If
   
   '判斷word是否已開啟
   If g_WordAp Is Nothing Then
RestarWord:
      Set g_WordAp = New Word.Application
      g_WordAp.Visible = False
      'g_WordAp.Visible = True
   End If
   g_WordAp.Documents.Open pFilePath, False, False, False
   WordModelOpen = True
   Exit Function
   
ErrHand:
   If Err.Number = 462 Then '遠端伺服器不存在或無法使用
      GoTo RestarWord
   ElseIf Err.Number <> 0 Then
      MsgBox Err.Number & ":" & Err.Description, , "錯誤 "
   End If
   
End Function
'檢查內容是否含Unicode
Private Function WordChkUnicod() As Boolean
   Dim ii As Integer, strText As String
   For ii = 1 To UBound(m_WordVar, 2)
      strText = m_WordVar(2, ii)
      If strText <> "" Then
         strText = StrConv(StrConv(strText, vbFromUnicode), vbUnicode)
         If strText <> m_WordVar(2, ii) Then
            WordChkUnicod = True
            Exit For
         End If
      End If
   Next
End Function
'Added by Morgan 2022/1/25
'Word變數轉輸出內容
Private Function WordVarConvert(ByRef pBookMark As String) As Boolean
   Dim ii As Integer, iMax As Integer
   Dim strName As String, strText As String
   Dim strBookMark As String
   
On Error GoTo ErrHand
   
   With g_WordAp
   .Selection.WholeStory
   For ii = 1 To UBound(m_WordVar, 2)
      strName = m_WordVar(1, ii)
      strText = m_WordVar(2, ii)
      If Trim(strName) <> "" Then
         '插入其他Word的特殊變數
         If strName = "說明事項2" Then
            If strText <> "" Then
               .Selection.EndKey Unit:=wdStory
               .Selection.InsertBreak Type:=wdPageBreak '跳頁
               WordPrintMemo strText
            End If
            
         ElseIf strName = "表頭" Then
            .Selection.EndKey Unit:=wdStory
            .Selection.ParagraphFormat.LineSpacingRule = wdLineSpaceExactly
            .Selection.ParagraphFormat.LineSpacing = 5
            .Selection.InsertBreak Type:=wdPageBreak '跳頁
            .Selection.ParagraphFormat.LineSpacingRule = wdLineSpaceSingle
            strBookMark = "BreakPos1"
            With .ActiveDocument.Bookmarks
               .add Range:=g_WordAp.Application.Selection.Range, Name:=strBookMark
               .DefaultSorting = wdSortByLocation
               .ShowHidden = False
            End With
            'M51-000301-0-07智權部接洽單-國內(表頭).docx
            Call WordInsDoc("M51-000301-0-07")
            '.Selection.TypeBackspace '回縮一列
            
         ElseIf strName = "申請人2" Then
            .Selection.EndKey Unit:=wdStory
            strBookMark = "BreakPos2"
            With .ActiveDocument.Bookmarks
               .add Range:=g_WordAp.Application.Selection.Range, Name:=strBookMark
               .DefaultSorting = wdSortByLocation
               .ShowHidden = False
            End With
            'M51-000301-0-02 接洽單-申請人2.docx
            Call WordInsDoc("M51-000301-0-02")
            .Selection.TypeBackspace '回縮一列
            
         ElseIf strName = "申請人3" Then
            .Selection.EndKey Unit:=wdStory
            strBookMark = "BreakPos3"
            With .ActiveDocument.Bookmarks
               .add Range:=g_WordAp.Application.Selection.Range, Name:=strBookMark
               .DefaultSorting = wdSortByLocation
               .ShowHidden = False
            End With
            'M51-000301-0-03 接洽單-申請人3.docx
            Call WordInsDoc("M51-000301-0-03")
            .Selection.TypeBackspace '回縮一列
            
         ElseIf strName = "申請人4" Then
            .Selection.EndKey Unit:=wdStory
            strBookMark = "BreakPos4"
            With .ActiveDocument.Bookmarks
               .add Range:=g_WordAp.Application.Selection.Range, Name:=strBookMark
               .DefaultSorting = wdSortByLocation
               .ShowHidden = False
            End With
            'M51-000301-0-04 接洽單-申請人4.docx
            Call WordInsDoc("M51-000301-0-04")
            .Selection.TypeBackspace '回縮一列
            
         ElseIf strName = "申請人5" Then
            .Selection.EndKey Unit:=wdStory
            strBookMark = "BreakPos5"
            With .ActiveDocument.Bookmarks
               .add Range:=g_WordAp.Application.Selection.Range, Name:=strBookMark
               .DefaultSorting = wdSortByLocation
               .ShowHidden = False
            End With
            'M51-000301-0-05 接洽單-申請人5.docx
            Call WordInsDoc("M51-000301-0-05")
            .Selection.TypeBackspace '回縮一列
            
         ElseIf strName = "特殊收據附件" Then
            .Selection.EndKey Unit:=wdStory
            strBookMark = "BreakPos6"
            With .ActiveDocument.Bookmarks
               .add Range:=g_WordAp.Application.Selection.Range, Name:=strBookMark
               .DefaultSorting = wdSortByLocation
               .ShowHidden = False
            End With
            .Selection.ParagraphFormat.LineSpacingRule = wdLineSpaceExactly
            .Selection.ParagraphFormat.LineSpacing = 5
            .Selection.InsertBreak Type:=wdPageBreak '跳頁
            .Selection.ParagraphFormat.LineSpacingRule = wdLineSpaceSingle
            
            'M51-000301-0-06 接洽單-特殊收據.docx
            Call WordInsDoc("M51-000301-0-06")
            pBookMark = strBookMark
         
         ElseIf strName = "商標圖標題" Then
            If strText <> "" Then
               WordInsText strText
            End If
         ElseIf strName = "商標圖" Then
            WordInsPic
         ElseIf strName = "商標文" Then
            WordInsText strText, 1
         Else
            If strBookMark <> "" Then
               .Selection.GoTo what:=wdGoToBookmark, Name:=strBookMark
            Else
               .Selection.HomeKey Unit:=wdStory
            End If
            
            .Selection.Find.ClearFormatting
            If m_WordVar(3, ii) = "Y" Then
               .Selection.Find.Text = strName
            Else
               .Selection.Find.Text = "|#" & strName & "#|"
            End If
            .Selection.Find.Replacement.Text = ""
            .Selection.Find.Forward = True
            .Selection.Find.Wrap = wdFindContinue
            .Selection.Find.Format = False
            .Selection.Find.MatchCase = False
            .Selection.Find.MatchWholeWord = False
            .Selection.Find.MatchWildcards = False
            .Selection.Find.MatchSoundsLike = False
            .Selection.Find.MatchAllWordForms = False
            .Selection.Find.MatchByte = True
            If .Selection.Find.Execute() = True Then
               .Selection.Font.Name = "標楷體"
               .Selection.Font.Size = 12
               .Selection.Font.Bold = False
               .Selection.Font.Underline = wdUnderlineNone
               
               If strName = "新案" Or strName = "舊案" Then
                  .Selection.Collapse Direction:=wdCollapseStart
                  .Selection.MoveLeft Unit:=wdCharacter, Count:=1
                  .Selection.TypeText strText
               Else
                  .Selection.Delete
                  '有底線的日期
                  If strName = "填表日期" Or strName = "法定期限" Or strName = "約定期限" Or strName = "本所期限" Then
                     .Selection.Font.Underline = wdUnderlineSingle
                     If strText <> "" Then
                        .Selection.TypeText " " & (Left(strText, 4) - 1911) & " "
                     Else
                        .Selection.TypeText "     "
                     End If
                     .Selection.Font.Underline = wdUnderlineNone
                     .Selection.TypeText "年"
                     .Selection.Font.Underline = wdUnderlineSingle
                     If strText <> "" Then
                        .Selection.TypeText " " & Mid(strText, 5, 2) & " "
                     Else
                        .Selection.TypeText "    "
                     End If
                     .Selection.Font.Underline = wdUnderlineNone
                     .Selection.TypeText "月"
                     .Selection.Font.Underline = wdUnderlineSingle
                     If strText <> "" Then
                        .Selection.TypeText " " & Mid(strText, 7, 2) & " "
                     Else
                        .Selection.TypeText "    "
                     End If
                     .Selection.Font.Underline = wdUnderlineNone
                     .Selection.TypeText "日"
                     
                  ElseIf strName = "說明事項" Then
                     WordPrintMemo strText
                     
                  ElseIf strText <> "" Then
                     If strName = "標題" Then
                        .Selection.Font.Size = 22
                     '大字
                     ElseIf strName = "申請國" Or Left(strName, 4) = "案件性質" Or Left(strName, 4) = "主題" Then
                        .Selection.Font.Size = 16
                     '小字
                     ElseIf strName = "減免資格" Then
                        .Selection.Font.Size = 9
                     
                     '有固定長度的底線
                     ElseIf strName = "本所人員" Or strName = "員工代號" Then
                        .Selection.Font.Size = 15
                        .Selection.Font.Underline = wdUnderlineSingle
                        strText = PUB_StrToStr(strText & String(7, "　"), 14, True)
                        
                     ElseIf strName = "區別" Then
                        .Selection.Font.Underline = wdUnderlineSingle
                        strText = PUB_StrToStr(strText & String(10, "　"), 20, True)
                        
                     ElseIf strName = "介紹人" Then
                        .Selection.Font.Underline = wdUnderlineSingle
                        strText = PUB_StrToStr(strText & String(16, "　"), 32, True)
                     'Added by Morgan 2022/10/7
                     ElseIf strName = "申請地址-英" Then
                        If Len(strText) > 110 Then
                           .Selection.Font.Size = 9
                        ElseIf Len(strText) > 70 Then
                           .Selection.Font.Size = 10
                        End If
                     'end 2022/10/7
                     End If
                     
                     '粗體
                     If m_WordVar(4, ii) = "Y" Then
                        .Selection.Font.Bold = True
                     End If
                     .Selection.TypeText strText
                  Else
                     '合併前一格
                     If strName = "案件性質3" Or strName = "案件性質4" Then
                        .Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                        .Selection.Cells.Merge
                        .Selection.EndKey
                     End If
                  End If
               End If
               
               .Selection.Font.Name = "標楷體"
               .Selection.Font.Size = 12
               .Selection.Font.Bold = False
               .Selection.Font.Underline = wdUnderlineNone
            End If
         End If
      End If
      If strText <> "" Then
         PUB_ChgUnicodeFont strText, g_WordAp
      End If
   Next
   End With
   WordVarConvert = True
   Exit Function
   
ErrHand:
   MsgBox Err.Number & ":" & Err.Description, vbCritical, "錯誤 "
   
End Function

'插入文字框
'pType:0=標題, 1=商標文
Private Sub WordInsText(pText As String, Optional pType As Integer)
   Dim iLeft As Single, iTop As Single, iWidth As Single, iHeight As Single
   Dim shpText
   Dim ii As Integer, iLines As Integer
   Dim arrText
   
   With g_WordAp
   .Selection.HomeKey Unit:=wdStory
   '商標文
   If pType = 1 Then
      iLeft = .CentimetersToPoints(11.5)
      iTop = .CentimetersToPoints(21.6)
      iWidth = .CentimetersToPoints(5.64)
      iHeight = .CentimetersToPoints(5.5)
      arrText = Split(pText, vbCrLf)
      iLines = 0
      For ii = 0 To UBound(arrText)
         iLines = iLines + (-1 * Int(-1 * GetTextLength(CStr(arrText(ii))) / 16))
      Next
      pText = Join(arrText, vbCrLf)
      If iLines < 7 Then
         pText = String((8 - iLines) \ 2, vbCrLf) & pText
      End If
   '標題
   Else
      iLeft = .CentimetersToPoints(11.3)
      iTop = .CentimetersToPoints(20.9)
      iWidth = .CentimetersToPoints(3)
      iHeight = .CentimetersToPoints(1)
   End If
   Set shpText = .ActiveDocument.Shapes.AddTextbox(1, iLeft, iTop, iWidth, iHeight)
   
   '商標文
   If pType = 1 Then
      shpText.Line.Visible = 1
      
   Else
      shpText.Line.Visible = 0
   End If
   
   shpText.Select
   .Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter '置中
   .Selection.ParagraphFormat.LeftIndent = 0 '縮排
   .Selection.ParagraphFormat.RightIndent = 0 '縮排
   .Selection.ParagraphFormat.LineSpacingRule = wdLineSpaceExactly
   .Selection.ParagraphFormat.LineSpacing = 18
   .Selection.Font.Name = "標楷體"
   
   '文字商標
   If pType = 1 Then
      .Selection.Font.Size = 18
   '標題
   Else
      .Selection.Font.Size = 12
   End If
   .Selection.TypeText pText
   End With
End Sub
'Added by Morgan 2022/2/24
'插入商標圖
Private Sub WordInsPic()
   Dim strFilePath As String
   Dim oShape
   Dim iLeft As Single, iTop As Single, iWidth As Single, iHeight As Single
   Dim shpLine
   
    
   strFilePath = App.path & "\" & strUserNum & "\$$" & strUserNum & "_" & strSrvDate(1) & ServerTime & ".bmp"
   If Dir(strFilePath) <> "" Then
      Kill strFilePath
   End If
   
   SavePicture tmpImg.Picture, strFilePath
   'If opt1(2).Value = True Then
   '   SavePicture tmpPic.Picture, strFilePath
   'Else
   '   SavePicture G_SeekPicColor.Picture, strFilePath
   'End If
   With g_WordAp
   .Selection.HomeKey Unit:=wdStory
   .Selection.Find.ClearFormatting
   .Selection.Find.Text = "|#說明事項#|"
   If .Selection.Find.Execute() = True Then
      .Selection.EndKey
      Set oShape = .ActiveDocument.Shapes.AddPicture(Anchor:=.Selection.Range, FileName:=strFilePath, LinkToFile:=False, SaveWithDocument:=True)
      oShape.LockAspectRatio = -1
      oShape.RelativeHorizontalPosition = wdRelativeHorizontalPositionPage
      oShape.RelativeVerticalPosition = wdRelativeVerticalPositionPage
      oShape.Height = .CentimetersToPoints(5.5)
      If oShape.Width > .CentimetersToPoints(5.5) Then
         oShape.Width = .CentimetersToPoints(5.5)
      End If
      oShape.Left = .CentimetersToPoints(11.1)
      oShape.Top = .CentimetersToPoints(3.5)
      
      iLeft = .CentimetersToPoints(11.5)
      iTop = .CentimetersToPoints(21.6)
      iWidth = oShape.Width + 5
      iHeight = oShape.Height + 5
      Set shpLine = .ActiveDocument.Shapes.AddTextbox(1, iLeft, iTop, oShape.Width + 5, oShape.Height + 5)
      
   End If
   End With
End Sub

'Added by Morgan 2022/1/25
Private Function WordPrintOut(Optional pCopies As Integer = 1) As Boolean
   Dim strBookMark As String, strFilePath As String
   
On Error GoTo ErrHand
   Load frmpic003
   frmpic003.Label1.FontSize = 14
   'frmpic002.Label1.AutoSize = True
   frmpic003.Label1.Caption = "本接洽單含有萬國碼，列印需要較長時間，" & vbCrLf & "請耐心等候..." & vbCrLf & vbCrLf & "注意:列印中請勿操作Word！"
   frmpic003.Label1.WordWrap = True
   frmpic003.Height = frmpic003.Label1.Height + 50
   frmpic003.Width = frmpic003.Label1.Width + 50
   frmpic003.Show
   frmpic003.ZOrder 0
   
   pub_OsPrinter = PUB_GetOsDefaultPrinter
'   PUB_SetOsDefaultPrinter cboPrinter
   PUB_SetWordActivePrinter
      
   If WordModelOpen(strFilePath) = True Then
      WordVarConvert strBookMark
      '預覽
      If txtPrintType = "1" Then
         strFilePath = strFilePath & ".pdf"
         If Dir(strFilePath) <> "" Then
            Kill strFilePath
         End If
         g_WordAp.ActiveDocument.ExportAsFixedFormat OutputFileName:=strFilePath, ExportFormat:=17, OpenAfterExport:=True
      '列印
      Else
         g_WordAp.PrintOut Background:=False, Copies:=1, Collate:=True
         If pCopies > 1 Then
            If strBookMark <> "" Then WordDelAfterBookMark strBookMark
            g_WordAp.PrintOut Background:=False, Copies:=(pCopies - 1), Collate:=True
         End If
      End If
      '關閉Word
      g_WordAp.ActiveDocument.Close wdDoNotSaveChanges
      If g_WordAp.Documents.Count = 0 Then
         g_WordAp.Quit wdDoNotSaveChanges
         Set g_WordAp = Nothing
      End If
   End If
   PUB_SetOsDefaultPrinter pub_OsPrinter
   WordPrintOut = True
   Unload frmpic003
   Exit Function
   
ErrHand:
   If Err.Number = 5101 Then Resume Next '書籤不存時繼續列印
   
   MsgBox Err.Number & ":" & Err.Description, vbCritical, "錯誤 "
   
   PUB_SetOsDefaultPrinter pub_OsPrinter
   Unload frmpic003
End Function
'Added by Morgan 2022/2/24
'刪除特殊收據
Private Sub WordDelAfterBookMark(ByVal pBookMark As String)
   With g_WordAp
   .Selection.GoTo what:=wdGoToBookmark, Name:=pBookMark
   .Selection.EndKey Unit:=wdStory, Extend:=wdExtend
   .Selection.Delete
   End With
End Sub
'儲存Word變數資料
Private Sub WordVarSet(pVarName As String, Optional pText As String = "", Optional pNoDelete As Boolean = False, Optional pBold As Boolean = False)
   m_iSizeD2 = m_iSizeD2 + 1
   ReDim Preserve m_WordVar(4, m_iSizeD2)
   m_WordVar(1, m_iSizeD2) = pVarName
   m_WordVar(2, m_iSizeD2) = pText
   If pNoDelete Then
      m_WordVar(3, m_iSizeD2) = "Y"
   End If
   If pBold Then
      m_WordVar(4, m_iSizeD2) = "Y"
   End If
End Sub

'Added by Morgan 2022/1/25
Private Function WordInsDoc(pFileID As String) As Boolean
   Dim m_DefPath As String
   Dim m_FileName As String
   Dim m_WordDoc As Word.Document

On Error GoTo ErrHand

   m_DefPath = App.path & "\" & strUserNum
   
   m_FileName = "$$" & strUserNum & "_" & strSrvDate(1) & ServerTime & ".att1.docx"
   If Dir(m_DefPath & "\" & m_FileName) <> "" Then
      Kill m_DefPath & "\" & m_FileName
   End If
   If PUB_GetSampleFile(m_FileName, pFileID, , m_DefPath) = False Then
        Exit Function
   End If
   
   Set m_WordDoc = g_WordAp.Documents.Open(m_DefPath & "\" & m_FileName)
   m_WordDoc.Select
   g_WordAp.Selection.Copy
   m_WordDoc.Close wdDoNotSaveChanges
   g_WordAp.Selection.Paste
   
   WordInsDoc = True
   Exit Function
   
ErrHand:
   MsgBox Err.Number & ":" & Err.Description, vbCritical, "錯誤 "
   
End Function
'Added by Morgan 2022/2/23
'列印說明事項
Private Sub WordPrintMemo(pText As String)
   Dim PrintDetailTxt
   Dim iiiii As Integer
   
   PrintDetailTxt = Split(pText, vbCrLf)
   
   With g_WordAp
   For iiiii = 0 To UBound(PrintDetailTxt) - 1
      If PrintDetailTxt(iiiii) <> "" Then
         '加粗
         '新發明人,查名代號
         If Mid(PrintDetailTxt(iiiii), 6, 1) = "■" Or InStr(PrintDetailTxt(iiiii), "查名代號") > 0 Or PrintDetailTxt(iiiii) = " 後續資料：" Or PrintDetailTxt(iiiii) = " 發明人資料：" Or PrintDetailTxt(iiiii) = " 發明人資料如附件" Or PrintDetailTxt(iiiii) = " (次頁尚有其他資料)" Then
            .Selection.Font.Bold = True
            .Selection.TypeText PrintDetailTxt(iiiii)
            .Selection.Font.Bold = False
         '加粗加大
         ElseIf InStr(PrintDetailTxt(iiiii), "★送件方式") > 0 Or InStr(PrintDetailTxt(iiiii), "★" & Label19.Caption) > 0 Or InStr(PrintDetailTxt(iiiii), "★電子送件") > 0 Or InStr(PrintDetailTxt(iiiii), "★紙本送件") > 0 Or InStr(PrintDetailTxt(iiiii), "★附英文摘要") > 0 Then
            .Selection.Font.Size = .Selection.Font.Size + 1
            .Selection.Font.Bold = True
            .Selection.TypeText PrintDetailTxt(iiiii)
            .Selection.Font.Size = .Selection.Font.Size - 1
            .Selection.Font.Bold = False
         ElseIf (Frame16.Visible = True And (InStr(PrintDetailTxt(iiiii), Option3(0).Caption) > 0 Or InStr(PrintDetailTxt(iiiii), Option3(1).Caption) > 0)) _
                 Or (Frame41.Visible = True And (InStr(PrintDetailTxt(iiiii), Option9(0).Caption) > 0 Or InStr(PrintDetailTxt(iiiii), Option9(1).Caption) > 0)) Then
            .Selection.Font.Bold = True
            .Selection.Font.Size = 16
            .Selection.TypeText PrintDetailTxt(iiiii)
            .Selection.Font.Bold = False
            .Selection.Font.Size = 11
         Else
            .Selection.TypeText PrintDetailTxt(iiiii)
         End If
         .Selection.TypeParagraph
      End If
   Next
   End With
End Sub
'Added by Morgan 2022/3/2
'設定Unicode的字型為"新細明體-ExtB"
Private Sub PUB_ChgUnicodeFont(pText As String, pWord As Word.Application)
   Dim ii As Integer, strText As String, strUniText As String
   For ii = 1 To Len(pText)
      strText = StrConv(StrConv(Mid(pText, ii, 1), vbFromUnicode), vbUnicode)
      If strText <> Mid(pText, ii, 1) Then
         strUniText = Mid(pText, ii, 1)
         '要抓到非Unicode字,因為有的Unicode字用len算會是2,必須組合起來才找得到字
         Do While (ii < Len(pText))
            ii = ii + 1
            strText = StrConv(StrConv(Mid(pText, ii, 1), vbFromUnicode), vbUnicode)
            If strText <> Mid(pText, ii, 1) Then
               strUniText = strUniText & Mid(pText, ii, 1)
            Else
               Exit Do
            End If
         Loop
         
         With pWord
         .Selection.HomeKey Unit:=wdStory
         .Selection.Find.ClearFormatting
         .Selection.Find.Text = strUniText
         .Selection.Find.Replacement.Text = strUniText
         .Selection.Find.Replacement.Font.Name = "新細明體-ExtB"
         .Selection.Find.Execute Replace:=wdReplaceAll
         End With
      End If
   Next
End Sub

Private Sub SetGrd2()
   Dim arrGridHeadText, arrGridHeadWidth
   Dim iRow As Integer

   arrGridHeadText = Array("簽核人員", "身份", "日期", "時間", "簽核結果", "B1104")
   arrGridHeadWidth = Array(1050, 600, 800, 800, 800, 0)
   GRD1.Visible = False
   GRD1.Cols = UBound(arrGridHeadText) + 1
   For iRow = 0 To GRD1.Cols - 1
      GRD1.row = 0
      GRD1.col = iRow
      GRD1.Text = arrGridHeadText(iRow)
      GRD1.ColWidth(iRow) = arrGridHeadWidth(iRow)
      GRD1.CellAlignment = flexAlignCenterCenter
   Next
   GRD1.Visible = True
End Sub

'Add By Sindy 2022/9/21
' 更新各控制項的狀態
Private Sub SetCtrlReadOnly_Flow(ByVal bEnable As Boolean)
   Me.txtF0306.Locked = bEnable
   Me.txtF0306.Enabled = Not bEnable
   If bEnable = True Then
      txtF0306.BackColor = &H8000000F
   Else
      txtF0306.BackColor = &H80000005 '白底
   End If
End Sub

Private Sub ClearField_Flow()
   txtF0306 = Empty
   txtF0310 = Empty
   txtF0310_2 = Empty
   txtF0309 = Empty
   txtNote = Empty
   txtF0407 = Empty
   GRD1.Clear
   SetGrd2
      
   Frame56.Visible = False
   '退回原因
   Label1(130).Visible = False
   LblReason.Visible = False
   LblReason.Caption = ""
   '您的意見
   Label34.Visible = False
   txtNote.Visible = False
   
   cmdAgree.Enabled = True 'Add By Sindy 2023/4/18
   cmdBack.Enabled = True 'Add By Sindy 2023/4/18
End Sub

Public Sub QueryData_Flow()
Dim rsTmp As New ADODB.Recordset
Dim RsQ As New ADODB.Recordset
Dim strSql As String
Dim strQ As String, intQ As Integer
Dim strF0305 As String
   
   ClearField_Flow '清空欄位值
   If Text5.Text = "" Then Exit Sub
   
   Screen.MousePointer = vbHourglass
   Me.Enabled = False
   
'   '讀取退回原因
'   strQ = "Select * From AllCode Where AC01='12' Order by ac02 "
'   intQ = 1
'   Set RsQ = ClsLawReadRstMsg(intQ, strQ)
'   If intQ = 1 Then
'      Do While Not RsQ.EOF
'         Me.cboReason.AddItem "" & RsQ("ac02") & "--" & RsQ("ac03")
'         RsQ.MoveNext
'      Loop
'   End If
   
   '案件表單主檔
   strSql = "select flow003.*,decode(F0309," & ShowFlow表單狀態中文 & ") as F0309NM,decode(F0305,null,'',AC02||'--'||AC03) as BReason" & _
            " from flow003,allcode" & _
            " where f0301='" & Text5.Text & "' and f0302='" & Flow_接洽單 & "' And AC01(+)='12' And F0305=AC02(+)"
   rsTmp.CursorLocation = adUseClient
   rsTmp.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
   If rsTmp.RecordCount > 0 Then
      txtF0306 = "" & rsTmp.Fields("F0306")
      strF0305 = "" & rsTmp.Fields("F0305")
      m_F0316 = "" & rsTmp.Fields("F0316") '智權人員
      txtF0310 = "" & rsTmp.Fields("F0310"): txtF0310_2 = GetPrjSalesNM("" & rsTmp.Fields("F0310"))
      If m_F0316 <> "" And txtF0310 <> "" Then
         If m_F0316 <> txtF0310 Then
            txtF0310.ForeColor = &HFF0000
            txtF0310_2.ForeColor = &HFF0000
         Else
            txtF0310.ForeColor = &H80000008
            txtF0310_2.ForeColor = &H80000008
         End If
      End If
      LblReason = "" & rsTmp.Fields("BReason") '退回原因
      m_F0307 = "" & rsTmp.Fields("F0307") '上一處理人員
      m_F0308 = "" & rsTmp.Fields("F0308") '下一處理人員
      m_F0309 = "" & rsTmp.Fields("F0309") '目前狀態
'      m_F0310 = "" & rsTmp.Fields("F0310") 'Add By Sindy 2025/3/25 填單人員
      txtF0309 = "" & rsTmp.Fields("F0309") & " " & rsTmp.Fields("F0309NM")
      Call UpdateCUID(rsTmp)
      If m_F0309 = "" Then Label29.Visible = False
'   Else
'      Screen.MousePointer = vbDefault
'      ShowNoData
'      rsTmp.Close
'      Set rsTmp = Nothing
'      Exit Sub
   End If
   rsTmp.Close
   
   '主管-案件簽核作業
   '法務-介紹案源管理
   If UCase(TypeName(m_PrevForm)) = UCase("frm210148") Or UCase(TypeName(m_PrevForm)) = UCase("frm077003") Then
      Frame56.Visible = True '功能鍵
      cmdOK(3).Enabled = False 'Add By Sindy 2024/5/9
      
      '您的意見
      Label34.Visible = True
      txtNote.Visible = True
      'Me.txtNote.Locked = False
      
      If UCase(TypeName(m_PrevForm)) = UCase("frm077003") Then '法務人員確定接案件,就進行收文
         cmdAgree.Caption = "收文"
'         If Text1(6) = "L" And Text1(7) = "888888" Then
'            cmdBack.Visible = False
'         End If
         cmdBack.Visible = False '"無"退回功能
      End If
      
      'Add By Sindy 2023/8/16 增加提醒訊息
      strExc(10) = ""
      If lblZip.Visible = True Then strExc(10) = strExc(10) & "有跨所" & vbCrLf
      If lblAPPLQ.Visible = True Then strExc(10) = strExc(10) & "有對造" & vbCrLf
      If ChkCRL66.Value = 1 Then strExc(10) = strExc(10) & "對造已簽准" & vbCrLf
      If Check11.Value = 1 Then strExc(10) = strExc(10) & "有勾急件" & vbCrLf
      If Check12.Value = 1 Then strExc(10) = strExc(10) & "費用已核准" & vbCrLf
      If ChkCRL152.Value = 1 Then strExc(10) = strExc(10) & "有勾自行送簽核" & vbCrLf
      'Add By Sindy 2025/4/14
      If Check10.Value = 1 Then
         'strExc(10) = strExc(10) & "有勾規費調整" & vbCrLf
         Me.Check10.BackColor = QBColor(14) '淡黃色
      End If
      '2025/4/14 END
      If strExc(10) <> "" Then
         MsgBox "請注意簽核事項！" & vbCrLf & strExc(10), vbCritical, "注意！"
      End If
      '2023/8/16 END
      
   '案件目前表單
   ElseIf UCase(TypeName(m_PrevForm)) = UCase("frm210147") Then
      
'      If Text1(6) = "P" Or Text1(6) = "PS" Or Text1(6) = "CFP" Or Text1(6) = "CPS" Then
'         Frame57.Visible = True
'      Else
'         Frame57.Visible = False
'      End If
      Call SetCtrlReadOnly_Flow(False)
      If m_F0309 = Flow_智權補件 Then
         Frame56.Visible = True '功能鍵
         cmdAgree.Visible = False '隱藏按鍵
         cmdBack.Caption = "補件完成"
         cmdBack.Left = cmdAgree.Left
         cmdBack.Width = 1200
         '您的意見
         Label34.Visible = True
         txtNote.Visible = True
         txtNote.Enabled = True
      End If
   End If
   
   If InStr(UCase(TypeName(m_PrevForm)), UCase("frm090801")) = 0 And UCase(TypeName(m_PrevForm)) <> "NOTHING" Then
      '退回原因
      Label1(130).Visible = True
      LblReason.Visible = True
      SSTab1.Tab = 0
      
      If (Text1(6) = "P" Or Text1(6) = "PS" Or Text1(6) = "CFP" Or Text1(6) = "CPS") And (m_F0309 >= Flow_待分案 Or InStr("'A5','A6','A7'", m_F0307) > 0) Then
         Frame57.Visible = True
      Else
         Frame57.Visible = False
      End If
      
      If m_F0309 = Flow_已收文 Or m_F0309 = Flow_已分案 Then
         Me.Caption = "檢視接洽單 (本所案號：" & Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9) & ")" & "　" & m_strTransCase
      Else
         Me.Caption = "接洽單-簽核 (本所案號：" & Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9) & ")" & "　" & m_strTransCase
         SSTab1.Tab = 5
      End If
   End If
'   If m_F0309 = Flow_已分案 Or m_F0309 = Flow_已收文 Then
'      Me.LblRecved.Visible = False
'   End If
      
   '案件表單流程備註檔
   SetFlow004TextBox txtF0407, Text5
   '案件表單簽核檔
   strSql = "SELECT decode(F0204," & ShowFlow特殊簽核人員 & ",ST02)||nvl(F0208,'') 簽核人員" & _
            ",decode(F0202," & ShowFlow簽核人員身份 & ") 身份,sqldateT(F0205) 日期,sqltime6(F0206) 時間" & _
            ",decode(F0207," & ShowFlow簽核結果 & ") 簽核結果,F0204" & _
            " FROM FLOW002,Staff WHERE F0201='" & Text5 & "' and F0204=ST01(+)" & _
            " order by decode(F0205,null,2,1) asc,F0205||sqltime6(F0206) asc,F0202,F0203 asc" 'order by F0205,F0202,F0203 asc
   rsTmp.CursorLocation = adUseClient
   rsTmp.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
   If rsTmp.RecordCount > 0 Then
      Set GRD1.Recordset = rsTmp
   End If
   
   '若有資料游標停在第一筆
   GRD1.Visible = False
   GRD1.col = 0
   GRD1.row = 1
   GRD1.Visible = True
   
   Screen.MousePointer = vbDefault
   Me.Enabled = True
   
EXITSUB:
   Set rsTmp = Nothing
   Set RsQ = Nothing
End Sub

Private Sub grd1_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
Dim nCol As Long, nRow As Long
getGrdColRow GRD1, x, y, nCol, nRow
GRD1.col = nCol
GRD1.row = nRow
End Sub

Private Sub grd1_SelChange()
Dim i As Integer, dblRow As Double
Dim k As Integer

GRD1.Visible = False
If GRD1.MouseRow <> 0 Then
   dblRow = 0
   For k = 1 To GRD1.Rows - 1
      GRD1.col = 1
      GRD1.row = k
      If GRD1.CellBackColor = &HFFC0C0 Then
         dblRow = k
         Exit For
      End If
   Next k
   '上一筆資料列清除反白
   If dblRow > 0 Then
      GRD1.col = 2
      GRD1.row = dblRow
      For i = 0 To GRD1.Cols - 1
         GRD1.col = i
         GRD1.CellBackColor = QBColor(15)
      Next i
   End If
   '目前資料列反白
   GRD1.col = 0
   GRD1.row = GRD1.MouseRow
   For i = 0 To GRD1.Cols - 1
      GRD1.col = i
      GRD1.CellBackColor = &HFFC0C0
   Next i
End If
GRD1.Visible = True
End Sub

' 更新 Create 及 Update 的人
Private Sub UpdateCUID(ByRef rsSrcTmp As ADODB.Recordset)
Dim strTemp As String
Dim strCName As String
Dim strCDate As String
Dim strCTime As String
Dim strUName As String
Dim strUDate As String
Dim strUTime As String
   
   If IsNull(rsSrcTmp.Fields("F0310")) = False Then
      If IsEmptyText(rsSrcTmp.Fields("F0310")) = False Then
         strCName = GetStaffName(rsSrcTmp.Fields("F0310"), True)
      End If
   End If
   If IsNull(rsSrcTmp.Fields("F0311")) = False Then
      If IsEmptyText(rsSrcTmp.Fields("F0311")) = False Then
         strTemp = TAIWANDATE(rsSrcTmp.Fields("F0311"))
         strCDate = Format(strTemp, "###/##/##")
      End If
   End If
   If IsNull(rsSrcTmp.Fields("F0312")) = False Then
      If IsEmptyText(rsSrcTmp.Fields("F0312")) = False Then
         strTemp = rsSrcTmp.Fields("F0312")
         strCTime = Format(strTemp, "##:##:##")
      End If
   End If
   If IsNull(rsSrcTmp.Fields("F0313")) = False Then
      If IsEmptyText(rsSrcTmp.Fields("F0313")) = False Then
         strUName = GetStaffName(rsSrcTmp.Fields("F0313"), True)
      End If
   End If
   If IsNull(rsSrcTmp.Fields("F0314")) = False Then
      If IsEmptyText(rsSrcTmp.Fields("F0314")) = False Then
         strTemp = TAIWANDATE(rsSrcTmp.Fields("F0314"))
         strUDate = Format(strTemp, "###/##/##")
      End If
   End If
   If IsNull(rsSrcTmp.Fields("F0315")) = False Then
      If IsEmptyText(rsSrcTmp.Fields("F0315")) = False Then
         strTemp = rsSrcTmp.Fields("F0315")
         strUTime = Format(strTemp, "##:##:##")
      End If
   End If

   ' 設定CUID中的文字
   Label29.Caption = "CREATE : " & strCName & " " & _
              " " & strCDate & " " & _
              " " & strCTime & String(10, " ") & _
              "UPDATE : " & strUName & " " & _
              " " & strUDate & " " & _
              " " & strUTime
End Sub

Private Sub txtF0306_Change()
   PUB_RefreshText txtF0306
End Sub
Private Sub txtF0306_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
   If Button = 2 Then Forms(0).PopupMenu2 txtNote
End Sub
Private Sub txtF0306_GotFocus()
   TextInverse txtF0306
End Sub
Private Sub txtF0306_Validate(Cancel As Boolean)
   '檢查長度
   If Not CheckLengthIsOK(txtF0306, txtF0306.MaxLength) Then
      txtF0306.SetFocus
      Cancel = True
   End If
End Sub
'Add By Sindy 2024/1/25
Private Sub txtNote_GotFocus()
   TextInverse txtNote
End Sub
Private Sub txtNote_Validate(Cancel As Boolean)
   '檢查長度
   If Not CheckLengthIsOK(txtNote, txtNote.MaxLength) Then
      txtNote.SetFocus
      Cancel = True
   End If
End Sub
'2024/1/25 END
Private Sub txtNote_Change()
   PUB_RefreshText txtNote
End Sub
Private Sub txtNote_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
   If Button = 2 Then Forms(0).PopupMenu2 txtNote
End Sub

'主管簽核同意/法律案源收文
Private Sub cmdAgree_Click()
Dim strUpdDate As String, strUpdTime As String
Dim strSubject As String, strContent As String
Dim bolConn As Boolean
Dim bolisA2 As Boolean, strTo As String
Dim intUpdOK As Integer 'Add By Sindy 2023/1/16
Dim Cancel As Boolean
   
On Error GoTo ErrHand
   
   'Add By Sindy 2024/1/25
   Call txtNote_Validate(Cancel)
   If Cancel = True Then
      Exit Sub
   End If
   '2024/1/25 END
   
   Screen.MousePointer = vbHourglass
   
   cmdAgree.Enabled = False 'Add By Sindy 2023/4/14 防按2次
   
   intUpdOK = 0 'Add By Sindy 2023/1/16
   strUpdDate = strSrvDate(1)
   strUpdTime = Right("000000" & ServerTime, 6)
   
   cnnConnection.BeginTrans: bolConn = True
   
   '簽核檔
   If m_F0308 = "A4" Then 'A4=法務案源
      strSql = "update FLOW002 set " & _
               "F0205='" & strUpdDate & "'" & _
               ",F0206='" & strUpdTime & "'" & _
               ",F0207='1',F0204='" & strUserNum & "'" & _
               " where F0201='" & Text5 & "' and F0202='" & m_F0308 & "' and F0207 is null "
      cnnConnection.Execute strSql, intUpdOK
   Else
      '是否有特例簽核
      bolisA2 = False
      strSql = "SELECT * from FLOW002" & _
               " where F0201='" & Text5 & "' and F0204='" & m_SignFlowEmp & "' and F0207 is null" & _
               " and F0202='A2'"
      intI = 1
      Set RsTemp = ClsLawReadRstMsg(intI, strSql)
      If intI = 1 Then
         bolisA2 = True '有特例簽核
      End If
      
      strSql = "update FLOW002 set " & _
               "F0205='" & strUpdDate & "'" & _
               ",F0206='" & strUpdTime & "'" & _
               ",F0207='1'" & IIf(m_SignFlowEmp <> strUserNum, ",F0208='(代)',F0204='" & strUserNum & "'", "") & _
               " where F0201='" & Text5 & "' and F0202 in('A1','A2') and F0204='" & m_SignFlowEmp & "' and F0207 is null "
      cnnConnection.Execute strSql, intUpdOK
   End If
   'Add By Sindy 2023/1/16
   If intUpdOK = 0 Then
      GoTo ErrHand
   End If
   '2023/1/16 END
   
   '流程備註檔
   If Trim(txtNote.Text) <> "" Then
      strSql = GetInsertFLOW004Sql(Trim(Text5), strUserNum, strUpdDate, strUpdTime, m_F0309, ChgSQL(Trim(txtNote.Text)))
      cnnConnection.Execute strSql
   End If
   
   '讀取下一處理人員
   If GetNextProPerson_Flow(Trim(Text5), Trim(m_F0316), m_F0308, m_F0309) = False Then GoTo ErrHand
   
   cnnConnection.CommitTrans: bolConn = False
   
   PUB_SendMailCache '發信(因電子收文)
   
   'Modify By Sindy 2025/3/31 Mark:林柄佑協理調職管理國內專利處;中所智權部由杜協理統一管理
'   '1.L-888888 中所同仁的接洽單杜協理簽完後，副本通知林協理
'   '2.中所智權部同仁的接洽單特例簽核時,檢查是否林經理有簽,杜協理沒簽時,要副本知會杜協理; 反之
'   '                                  ,檢查是否杜協理有簽,林經理沒簽時,要副本知會林經理
'   If ((Text1(6) = "L" And Text1(7) = "888888") Or bolisA2 = True) And PUB_GetST06(Text1(10)) = "2" And Left(GetST15(Text1(10).Text), 1) = "S" Then
'      strTo = ""
'      If InStr(Pub_GetSpecMan("全所智權部主管"), m_SignFlowEmp) > 0 Then
'         strTo = Pub_GetSpecMan("中所智權部主管")
'      ElseIf InStr(Pub_GetSpecMan("中所智權部主管"), m_SignFlowEmp) > 0 Then
'         strTo = Pub_GetSpecMan("全所智權部主管")
'      'Add By Sindy 2023/6/19
'      Else
'         strSql = "SELECT * from FLOW002" & _
'                  " where F0201='" & Text5 & "' and F0204='" & Pub_GetSpecMan("中所智權部主管") & "'"
'         intI = 1
'         Set RsTemp = ClsLawReadRstMsg(intI, strSql)
'         If intI = 0 Then
'            strTo = Pub_GetSpecMan("中所智權部主管")
'         End If
'         strSql = "SELECT * from FLOW002" & _
'                  " where F0201='" & Text5 & "' and F0204='" & Pub_GetSpecMan("全所智權部主管") & "'"
'         intI = 1
'         Set RsTemp = ClsLawReadRstMsg(intI, strSql)
'         If intI = 0 Then
'            strTo = IIf(strTo <> "", strTo & ";", "") & Pub_GetSpecMan("全所智權部主管")
'         End If
'         '2023/6/19 END
'      End If
'      If strTo <> "" Then
'         If InStr(strTo, ";") = 0 Then
'            strSql = "SELECT * from FLOW002" & _
'                     " where F0201='" & Text5 & "' and F0204='" & strTo & "'"
'            intI = 1
'            Set RsTemp = ClsLawReadRstMsg(intI, strSql)
'         Else
'            intI = 0
'         End If
'         If intI = 0 Then
'            '發E-Mail通知
'            strSubject = GetPrjSalesNM(Text1(10)) & "(接洽單" & Text1(6) & "-" & Text1(7) & "-" & Text1(8) & "-" & Text1(9) & ")【副本知會】通知" & IIf(bolisA2 = True, ",有特例簽核", "")
'            strContent = PUB_MailGetCRLCaseData(Text5)
'            PUB_SendMail strUserNum, strTo, "", strSubject, strContent
'         End If
'      End If
'   End If
   
   Screen.MousePointer = vbDefault
   
   Me.Text5 = ""
   m_PrevForm.Show
   m_PrevForm.PubShowNextData
   If Me.Text5 = "" Then
      Unload Me
   End If
   Exit Sub
   
ErrHand:
   Screen.MousePointer = vbDefault
   cmdAgree.Enabled = True 'Add By Sindy 2023/4/14 防按2次
   If bolConn = True Then
      cnnConnection.RollbackTrans
   End If
   MsgBox "簽核失敗！" & vbCrLf & Err.Description
End Sub

'主管簽核退回/智權人員補件完成
Private Sub cmdBack_Click()
Dim strUpdDate As String, strUpdTime As String
Dim strSubject As String, strContent As String
Dim bolConn As Boolean
Dim Cancel As Boolean
   
On Error GoTo ErrHand
   
   If Trim(txtNote.Text) = "" Then
      MsgBox "您的意見不可以空白！", vbExclamation
      txtNote.SetFocus
      Exit Sub
   Else
      'Add By Sindy 2024/1/25
      Call txtNote_Validate(Cancel)
      If Cancel = True Then
         Exit Sub
      End If
      '2024/1/25 END
   End If
   
   Screen.MousePointer = vbHourglass
   
   cmdBack.Enabled = False 'Add By Sindy 2023/4/14 防按2次
   
   strUpdDate = strSrvDate(1)
   strUpdTime = Right("000000" & ServerTime, 6)
   
   cnnConnection.BeginTrans: bolConn = True
   
   '簽核檔
'   If Len(m_F0307) = 2 Then
'      strSql = "update FLOW002 set " & _
'               "F0205='" & strUpdDate & "'" & _
'               ",F0206='" & strUpdTime & "'" & _
'               ",F0207='2',F0204='" & strUserNum & "'" & _
'               " where F0201='" & Text5 & "' and F0202='" & m_F0307 & "' and F0207 is null "
'      cnnConnection.Execute strSql
'   Else
      strSql = "update FLOW002 set " & _
               "F0205='" & strUpdDate & "'" & _
               ",F0206='" & strUpdTime & "'" & _
               ",F0207='" & IIf(InStr(cmdBack.Caption, "補件完成") > 0, "5", "2") & "'" & _
               IIf(m_SignFlowEmp <> strUserNum, ",F0208='(代)',F0204='" & strUserNum & "'", "") & _
               " where F0201='" & Text5 & "' and F0204='" & m_SignFlowEmp & "' and F0207 is null "
      cnnConnection.Execute strSql, intI
'   End If
   
   If InStr(cmdBack.Caption, "退回") > 0 Then
      m_F0309 = Flow_退回 '退回當事人:發E-Mail
      m_F0308 = Text1(10) '智權人員
   Else
      m_F0309 = Flow_補件完成 '回給上一處理人員:目前是分所分案/北所分案主管,不發E-Mail
      m_F0308 = m_F0307 '存入,上一處理人員
   End If
   
   '表單主檔
   strSql = "update FLOW003 set " & _
            "F0307='" & strUserNum & "'" & _
            ",F0308='" & m_F0308 & "'" & _
            ",F0309='" & m_F0309 & "'" & _
            " where F0301='" & Text5 & "'"
   cnnConnection.Execute strSql, intI
   
   '流程備註檔
   If Trim(txtNote.Text) <> "" Then
      strSql = GetInsertFLOW004Sql(Trim(Text5), strUserNum, strUpdDate, strUpdTime, m_F0309, ChgSQL(Trim(txtNote.Text)), "A0", m_F0307)
      cnnConnection.Execute strSql
   End If
   
   cnnConnection.CommitTrans: bolConn = False
   
   PUB_SendMailCache '發信(因電子收文)
   
   '發E-Mail通知當事人
   If m_F0309 = Flow_退回 Then
      strContent = GetEMailContent_Flow(Text5, strSubject)
      If Trim(txtNote.Text) <> "" Then
         strSubject = strSubject & "；退回原因：" & Trim(txtNote.Text)
      End If
      'Modify By Sindy 2025/5/8 填單人員非智權人員時,退回的收受者掛填單人員,副本為下一處理人員(智權人員)
      If txtF0310 <> Text1(10) Then
         PUB_SendMail strUserNum, txtF0310, "", strSubject, strContent, , , , , , m_F0308
      Else
      '2025/5/8 END
         PUB_SendMail strUserNum, m_F0308, "", strSubject, strContent
      End If
   End If
   
   Screen.MousePointer = vbDefault
   
   Me.Text5 = ""
   m_PrevForm.Show
   If TypeName(m_PrevForm) = UCase("frm210148") Then
      m_PrevForm.PubShowNextData
   End If
   If Me.Text5 = "" Then
      Unload Me
   End If
   Exit Sub
   
ErrHand:
   Screen.MousePointer = vbDefault
   cmdBack.Enabled = True 'Add By Sindy 2023/4/14 防按2次
   If bolConn = True Then
      cnnConnection.RollbackTrans
   End If
   MsgBox "退回失敗！" & vbCrLf & Err.Description
End Sub

'查詢下一筆
Private Sub cmdQueryNext_Click()
   Me.Text5 = ""
   m_PrevForm.Show
   m_PrevForm.PubShowNextData
   If Me.Text5 = "" Then
      Unload Me
   End If
End Sub

'Added by Morgan 2023/4/18
'檢查P案領證、年費是否減免身分有變動,因為自動分案整批發文,故若有變動則需先請程序人員修改否則會沒有設定到
Private Function ChgCusDis() As Boolean
   Dim ii As Integer, bolCheck As Boolean
   Dim stCP10 As String
   
   If m_IsQueryNow Then Exit Function 'Added by Morgan 2023/4/27 查詢時不必檢查
   
   ChgCusDis = False
   If Text1(6) = "P" And optCP811(0).Enabled = True Then
      bolCheck = False
      For ii = 1 To GridCase.Rows - 1
         stCP10 = Trim(Left(Trim(GridCase.TextMatrix(ii, 1)), 4))
         If stCP10 = "601" Or stCP10 = "605" Then
            bolCheck = True
            Exit For
         End If
      Next
      If bolCheck Then
         If DiscStatusIsChanged Then
            MsgBox "請先通知程序人員修改好減免身分後再進行收文作業！", vbExclamation
            ChgCusDis = True
         End If
      End If
   End If
End Function

'Added by Lydia 2023/11/13
Private Function CheckDataValidate5(Index As Integer) As Boolean
Dim Cancel As Boolean
Dim stMsg As String 'Add by Amy 2024/01/17
   
   'Added by Lydia 2023/11/13 DEBIT NOTE請款選項
   'Modified by Lydia 2023/11/14 排除外至台案件(MCTF) => OptChoose(0).Value = 1
   If Option2(2).Value = 1 And Frame33(1).Visible = False And OptChoose(0).Value = 1 Then
      Frame33(1).Visible = True
   End If
   If Option2(2).Value = 0 And Frame33(1).Visible = True Then
      MsgBox "請勾選以DEBIT NOTE請款！", vbExclamation + vbOKOnly
      SSTab1.Tab = 0
      Screen.MousePointer = vbDefault
      Exit Function
   End If
   'end 2022/10/27
   If Frame33(1).Visible = True Then
      If optDB(0).Value = 0 And optDB(1).Value = 0 Then
         MsgBox "請輸入DEBIT NOTE請款選項！", vbExclamation + vbOKOnly
         Frame33(1).BackColor = &HFFFFC0
         SSTab1.Tab = 0
         Screen.MousePointer = vbDefault
         Exit Function
      Else
         If optDB(0).Value = True Then
            Check7(2).Value = 0
            Check7(3).Value = 0
         ElseIf Check7(2).Value = 0 And Check7(3).Value = 0 Then
            MsgBox "請選擇是否要加印國內收據！", vbExclamation + vbOKOnly
            Frame33(1).BackColor = &HFFFFC0
            SSTab1.Tab = 0
            Screen.MousePointer = vbDefault
            Exit Function
         End If
      End If
   End If
   'end 2023/11/13
   
   'Add by Amy 2024/01/17 依案件性質檢查名稱是否存在於風險檢查對象中
   stMsg = "": Cancel = False: strExc(3) = ""
   If strSrvDate(1) >= 風險警示啟用日 Then
      strExc(2) = GetAllCaseCPM
      '風險檢查對象需管控之專利及商標部分案件性質,參看SetSendRiskChkMail
      '若有專利903(專利調查),回傳 系統別+903
      Cancel = ChkRiskData(1.2, Me.Name, Text1(6), strExc(2), , strExc(3))
      If Cancel = True Then
         If m_RiskMsg = MsgText(601) Then
            If (InStr(strExc(3), "P") > 0 Or InStr(strExc(3), "FG") > 0) And InStr(strExc(3), "903") > 0 Then
               '專利903(專利調查)有輸才檢查申請人 中/英 名稱一定要輸
            Else
               stMsg = "有風險檢查控管之案件性質" & vbCrLf & _
                                 "對造 中/英/日 文 名稱必需擇一輸入！"
               MsgBox stMsg, vbExclamation + vbOKOnly
               Screen.MousePointer = vbDefault
               Call RunFrm090801_14
               Exit Function
            End If
         End If
      End If
   '[非]需檢查風險檢查對象,但又有輸對造資料
   ElseIf m_RiskMsg <> MsgText(601) Then
      stMsg = "[非]風險檢查控管之案件性質" & vbCrLf & _
                        "對造 中/英/日 文 不可有資料！"
      MsgBox stMsg, vbExclamation + vbOKOnly
      Screen.MousePointer = vbDefault
      Call RunFrm090801_14
      Exit Function
   End If 'strSrvDate(1) >= 風險警示啟用日
   
   'Added by Lydia 2024/04/15 顧問服務管制
   'Modified by Lydia 2025/07/04 改在CheckDataValidate5才彈訊息
   'If m_LAchk <> "" Then '重新檢查
   If Text1(6) = "LA" Then
       Call SetLAdata
       If m_LAchk <> "" Then
           SSTab1.Tab = 0
           Screen.MousePointer = vbDefault
           Exit Function
       End If
   End If
   'end 2024/04/15
   CheckDataValidate5 = True
End Function

'Added by Lydia 2023/11/13 DEBIT NOTE請款選項
Private Sub optDB_Click(Index As Integer)
   If Index = 0 Then
      Check7(2).Value = 0
      Check7(3).Value = 0
   End If
End Sub

'Add by Amy 2024/01/17 對造資料
Private Sub RunFrm090801_14()
   Dim nFrm As Form
   
   'Set nFrm = Forms(0).GetForm("frm090801_14")
   nFrm.SetParent Me
   nFrm.m_stSysKind = Text1(6)
   nFrm.m_stCRL156 = m_stCRL156
   nFrm.m_stCRL157 = m_stCRL157
   nFrm.m_stCRL158 = m_stCRL158
   nFrm.m_stCRL159 = m_stCRL159
   nFrm.m_RiskMsg = m_RiskMsg
   nFrm.Show vbModal
End Sub

'Add by Amy 2024/10/09 專利已收放棄專利權(429)且已發文及已通知專利權公告作廢(1606),不能再收文年費控制 (從Combo1_Validate搬過來)
Private Function ChkP429Or1606NoAdd605(ByVal stCaseNo1 As String, ByVal stCaseNo2 As String, ByVal stCaseNo3 As String, ByVal stCaseNo4 As String, ByVal stNation As String, ByRef stMsg As String) As Boolean
   ChkP429Or1606NoAdd605 = False: stMsg = ""
   If InStr(stCaseNo1, "P") = 0 Then Exit Function
   
   'Add by Amy 2016/09/10 臺灣一案兩請新型案是否不可收文年費控制 ex:P-108013
   If stNation = "000" Then
      If PUB_TwDualCaseUtyNoAdd605(stCaseNo1, stCaseNo2, stCaseNo3, stCaseNo4, stNation) = True Then
         stMsg = "發明案有收文「擇一申復」且已公告，故不可再收文年費！"
         ChkP429Or1606NoAdd605 = True
         Exit Function
      End If
   End If
   'end 2016/09/01
   stMsg = ChkP429Or1606(stCaseNo1, stCaseNo2, stCaseNo3, stCaseNo4, stNation) 'ex:P-104016
   If stMsg <> MsgText(601) Then
      stMsg = "本案已「" & stMsg & "」無需再繳納年費！"
      ChkP429Or1606NoAdd605 = True
      Exit Function
   End If
End Function

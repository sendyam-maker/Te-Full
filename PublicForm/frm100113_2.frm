VERSION 5.00
Object = "{0ECD9B60-23AA-11D0-B351-00A0C9055D8E}#6.0#0"; "MSHFLXGD.OCX"
Object = "{0D452EE1-E08F-101A-852E-02608C4D0BB4}#2.0#0"; "FM20.DLL"
Begin VB.Form frm100113_2 
   BorderStyle     =   1  '單線固定
   Caption         =   "申請人查詢案件變更紀錄"
   ClientHeight    =   5730
   ClientLeft      =   80
   ClientTop       =   1010
   ClientWidth     =   9310
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   ScaleHeight     =   5730
   ScaleWidth      =   9310
   Begin VB.CommandButton cmdOK 
      Caption         =   "變更事項"
      CausesValidation=   0   'False
      Height          =   400
      Index           =   3
      Left            =   6030
      Style           =   1  '圖片外觀
      TabIndex        =   23
      Top             =   70
      Width           =   1200
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "全選 / 取消"
      CausesValidation=   0   'False
      Height          =   400
      Index           =   2
      Left            =   4710
      Style           =   1  '圖片外觀
      TabIndex        =   22
      Top             =   70
      Width           =   1320
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "回前畫面"
      CausesValidation=   0   'False
      Height          =   400
      Index           =   0
      Left            =   7224
      Style           =   1  '圖片外觀
      TabIndex        =   0
      Top             =   70
      Width           =   1200
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "結束"
      CausesValidation=   0   'False
      Height          =   400
      Index           =   1
      Left            =   8448
      Style           =   1  '圖片外觀
      TabIndex        =   1
      Top             =   70
      Width           =   800
   End
   Begin MSHierarchicalFlexGridLib.MSHFlexGrid grdDataList 
      Height          =   4890
      Left            =   30
      TabIndex        =   4
      Top             =   810
      Width           =   7500
      _ExtentX        =   13229
      _ExtentY        =   8625
      _Version        =   393216
      Cols            =   17
      FixedCols       =   0
      ScrollTrack     =   -1  'True
      HighLight       =   0
      SelectionMode   =   1
      AllowUserResizing=   3
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "新細明體-ExtB"
         Size            =   9
         Charset         =   136
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      _NumberOfBands  =   1
      _Band(0).Cols   =   17
   End
   Begin MSForms.Label lbl2 
      Height          =   300
      Index           =   0
      Left            =   1080
      TabIndex        =   24
      Top             =   510
      Width           =   6435
      VariousPropertyBits=   27
      Size            =   "11351;529"
      FontName        =   "新細明體-ExtB"
      FontHeight      =   180
      FontCharSet     =   136
      FontPitchAndFamily=   34
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "其他"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   16
      Left            =   7635
      TabIndex        =   21
      Top             =   5475
      Width           =   360
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更圖樣"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   15
      Left            =   7635
      TabIndex        =   20
      Top             =   5160
      Width           =   720
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更正商標號數"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   14
      Left            =   7635
      TabIndex        =   19
      Top             =   4875
      Width           =   1260
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更代理人"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   13
      Left            =   7635
      TabIndex        =   18
      Top             =   4575
      Width           =   900
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更代表人印鑑"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   12
      Left            =   7635
      TabIndex        =   17
      Top             =   4290
      Width           =   1260
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更申請人印鑑"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   11
      Left            =   7635
      TabIndex        =   16
      Top             =   3990
      Width           =   1260
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更商品組群"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   10
      Left            =   7635
      TabIndex        =   15
      Top             =   3690
      Width           =   1080
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更商品類別"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   9
      Left            =   7635
      TabIndex        =   14
      Top             =   3405
      Width           =   1080
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "減縮商品"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   8
      Left            =   7635
      TabIndex        =   13
      Top             =   3105
      Width           =   720
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更案件名稱"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   7
      Left            =   7635
      TabIndex        =   12
      Top             =   2820
      Width           =   1080
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更專利商標種類"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   6
      Left            =   7635
      TabIndex        =   11
      Top             =   2520
      Width           =   1440
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更申請地址"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   5
      Left            =   7635
      TabIndex        =   10
      Top             =   2220
      Width           =   1080
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更代表人中譯文"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   4
      Left            =   7635
      TabIndex        =   9
      Top             =   1935
      Width           =   1440
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更申請人中譯文"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   3
      Left            =   7635
      TabIndex        =   8
      Top             =   1635
      Width           =   1440
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更代表人"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   2
      Left            =   7635
      TabIndex        =   7
      Top             =   1350
      Width           =   900
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更申請人"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   1
      Left            =   7635
      TabIndex        =   6
      Top             =   1050
      Width           =   900
   End
   Begin VB.Label lbl1 
      AutoSize        =   -1  'True
      Caption         =   "變更申請日"
      ForeColor       =   &H000000FF&
      Height          =   180
      Index           =   0
      Left            =   7635
      TabIndex        =   5
      Top             =   750
      Width           =   900
   End
   Begin VB.Label Label1 
      AutoSize        =   -1  'True
      Caption         =   "申請人編號:"
      Height          =   180
      Left            =   90
      TabIndex        =   3
      Top             =   510
      Width           =   945
   End
   Begin VB.Label Label2 
      AutoSize        =   -1  'True
      Caption         =   "變更事項:"
      Height          =   180
      Left            =   7635
      TabIndex        =   2
      Top             =   510
      Width           =   765
   End
End
Attribute VB_Name = "frm100113_2"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'Memo by Lydia 2022/01/05 改成Form2.0 ; grdDataList改字型=新細明體-ExtB、lbl2(0)
'Memo By Sindy 2012/12/3 智權人員欄已修改
'Memo By Sindy 2011/2/17 SQLDate已檢查
'Memo By Sindy 2010/11/25 員工編號欄已修改
'sonia 2010/9/15 日期欄已修改
Option Explicit
Dim strSQL1 As String, strSQL2 As String, StrSQL3 As String, StrSQL4 As String, strSQL5 As String
Dim i As Integer, j As Integer, s As Integer, intK As Integer
Dim strSql As String, Str01 As String, Str02 As String, Str03 As String, Str04 As String, Str05 As String
Dim StrTest As String, strTemp As Variant, intTemp As Integer, StrSQL6 As String
'Add By Cheng
Dim m_blnAllChk As Boolean '
'92.04.16 nick 紀錄作用按鍵
Public cmdState As Integer
'Added by Lydia 2019/11/01 利益衝突案件
Dim m_AllSys As String '預設全部系統別
Dim intCufaCnt As Integer '限閱案件X件
Dim ColCE01 As Integer 'CE01收文號欄位的位置

Private Sub SetDataListWidth()
Dim iDep As String   '2010/9/15 ADD BY SONIA
'Added by Lydia 2019/11/01
Dim intField As Integer
intField = 18
grdDataList.Cols = intField
'end 2019/11/01

iDep = PUB_GetST06(strUserNum)  '2010/9/15 ADD BY SONIA

grdDataList.row = 0
'Add By Cheng 2002/12/04
grdDataList.col = 0: grdDataList.Text = "V"
grdDataList.ColWidth(0) = 200
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 1: grdDataList.Text = "申請人"
grdDataList.ColWidth(1) = 1000
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 2: grdDataList.Text = "本所案號"
grdDataList.ColWidth(2) = 1550
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 3: grdDataList.Text = "分所號"
'2010/9/15 ADD BY SONIA 電腦中心，跟分所才秀
'Modified by Lydia 2019/12/25
'If GetStaffDepartment(strUserNum) <> "M51" And iDep = "1" Then
If Pub_StrUserSt03 <> "M51" And iDep = "1" Then
   grdDataList.ColWidth(3) = 0
Else
   grdDataList.ColWidth(3) = 620
End If
'2010/9/15 END
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 4: grdDataList.Text = "案件名稱"
grdDataList.ColWidth(4) = 800
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 5: grdDataList.Text = "案件性質"
grdDataList.ColWidth(5) = 800
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 6: grdDataList.Text = "收文日"
grdDataList.ColWidth(6) = 850
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 7: grdDataList.Text = "是否出名"
grdDataList.ColWidth(7) = 800
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 8: grdDataList.Text = "變更事項"
grdDataList.ColWidth(8) = 2200
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 9: grdDataList.Text = "變更內容"
grdDataList.ColWidth(9) = 2200
grdDataList.CellAlignment = flexAlignCenterCenter
grdDataList.col = 10: grdDataList.Text = "准駁"
'Modified隱藏欄位：CE01收文號,申請人1~5, FC代理人
'grdDataList.ColWidth(10) = 800
'grdDataList.CellAlignment = flexAlignCenterCenter
'grdDataList.col = 11: grdDataList.Text = ""
'grdDataList.ColWidth(11) = 0
'grdDataList.CellAlignment = flexAlignCenterCenter
'grdDataList.col = 12: grdDataList.Text = ""
'grdDataList.ColWidth(12) = 0
'grdDataList.CellAlignment = flexAlignCenterCenter
'grdDataList.col = 13: grdDataList.Text = ""
'grdDataList.ColWidth(13) = 0
'grdDataList.CellAlignment = flexAlignCenterCenter
''Add By Cheng 2002/12/04
'grdDataList.col = 14: grdDataList.Text = ""
'grdDataList.ColWidth(14) = 0
'grdDataList.CellAlignment = flexAlignCenterCenter
''2010/9/15 ADD BY SONIA
'grdDataList.col = 15: grdDataList.Text = "收文號"
'grdDataList.ColWidth(15) = 0
'grdDataList.CellAlignment = flexAlignCenterCenter
For intI = 11 To intField - 1
     grdDataList.col = intI
     grdDataList.ColWidth(intI) = 0
Next intI
If ColCE01 = 0 Then ColCE01 = 11
'end 2019/11/01
End Sub

'92.04.16 nick
Public Sub PubShowNextData()
Dim ii As Integer
Dim jj As Integer

Select Case cmdState
Case 0
      tmpBol = fnCancelNowFormAndShowParentForm(Me)
Case 1
     fnCloseAllFrm100
Case 2 '全選或取消
    If m_blnAllChk = False Then
        If Me.grdDataList.Rows > 1 Then
            For ii = 1 To Me.grdDataList.Rows - 1
                Me.grdDataList.TextMatrix(ii, 0) = "V"
            Next ii
            m_blnAllChk = True
        End If
    Else
        If Me.grdDataList.Rows > 1 Then
            For ii = 1 To Me.grdDataList.Rows - 1
                Me.grdDataList.TextMatrix(ii, 0) = ""
            Next ii
            m_blnAllChk = False
        End If
    End If
Case 3 '變更事項內容
    cmdState = -1
    If Me.grdDataList.Rows > 1 Then
        jj = 0
        frm100113_3.Tag = ""
        For ii = 1 To Me.grdDataList.Rows - 1
            'Modified by Lydia 2019/11/01 改成變數
            'If Me.grdDataList.TextMatrix(ii, 0) = "V" Then jj = jj + 1: frm100113_3.Tag = frm100113_3.Tag & Me.grdDataList.TextMatrix(ii, 15) & ","
            If Me.grdDataList.TextMatrix(ii, 0) = "V" Then
               jj = jj + 1
               frm100113_3.Tag = frm100113_3.Tag & Me.grdDataList.TextMatrix(ii, ColCE01) & ","
            End If
            'end 2019/11/01
        Next ii
        If jj <> 0 Then
            Me.Enabled = False
            Screen.MousePointer = vbHourglass
            If fnSaveParentForm(Me) = False Then
                Me.Enabled = True
                Exit Sub
            End If
            frm100113_3.Tag = jj & "," & frm100113_3.Tag
            frm100113_3.Tag = Left(frm100113_3.Tag, Len(frm100113_3.Tag) - 1)
            frm100113_3.Show
            Me.Enabled = True
            Screen.MousePointer = vbDefault
        Else
            MsgBox "請勾選變更事項!!!", vbExclamation + vbOKOnly
        End If
    End If
Case Else
End Select
End Sub

Private Sub cmdok_Click(Index As Integer)
'92.04.16 nick 紀錄作用按鍵
cmdState = Index
PubShowNextData
End Sub

Private Sub Form_Load()
bolToEndByNick = False
   MoveFormToCenter Me
SetDataListWidth
If bolFNation = False Then
    LBL1(13).Visible = False
End If
'92.04.16 nick
cmdState = -1
End Sub
Sub SetLabelEnabled()
If frm100113_1.Check1(0).Value = 1 Then LBL1(0).Enabled = True Else LBL1(0).Enabled = False
If frm100113_1.Check1(1).Value = 1 Then LBL1(1).Enabled = True Else LBL1(1).Enabled = False
If frm100113_1.Check1(2).Value = 1 Then LBL1(2).Enabled = True Else LBL1(2).Enabled = False
If frm100113_1.Check1(3).Value = 1 Then LBL1(3).Enabled = True Else LBL1(3).Enabled = False
If frm100113_1.Check1(4).Value = 1 Then LBL1(4).Enabled = True Else LBL1(4).Enabled = False
If frm100113_1.Check1(5).Value = 1 Then LBL1(5).Enabled = True Else LBL1(5).Enabled = False
If frm100113_1.Check1(6).Value = 1 Then LBL1(6).Enabled = True Else LBL1(6).Enabled = False
If frm100113_1.Check1(7).Value = 1 Then LBL1(7).Enabled = True Else LBL1(7).Enabled = False
If frm100113_1.Check1(8).Value = 1 Then LBL1(8).Enabled = True Else LBL1(8).Enabled = False
If frm100113_1.Check1(9).Value = 1 Then LBL1(9).Enabled = True Else LBL1(9).Enabled = False
If frm100113_1.Check1(10).Value = 1 Then LBL1(10).Enabled = True Else LBL1(10).Enabled = False
If frm100113_1.Check1(11).Value = 1 Then LBL1(11).Enabled = True Else LBL1(11).Enabled = False
If frm100113_1.Check1(12).Value = 1 Then LBL1(12).Enabled = True Else LBL1(12).Enabled = False
If frm100113_1.Check1(13).Value = 1 Then LBL1(13).Enabled = True Else LBL1(13).Enabled = False
If frm100113_1.Check1(14).Value = 1 Then LBL1(14).Enabled = True Else LBL1(14).Enabled = False
If frm100113_1.Check1(15).Value = 1 Then LBL1(15).Enabled = True Else LBL1(15).Enabled = False
If frm100113_1.Check1(16).Value = 1 Then LBL1(16).Enabled = True Else LBL1(16).Enabled = False
End Sub

Sub StrMenu()
Dim ii As Integer
'Added by Lydia 2019/11/01 利益衝突案件：於後面增加欄位
Dim SeColPA As String
Dim SeColTM As String
Dim SeColSP As String
Dim SeColLC As String
Dim SeColHC As String
Dim dblRow As Double 'Add By Sindy 2025/9/3

lbl2(0).Caption = frm100113_1.txt1(0) + "-" + frm100113_1.txt1(1)
Me.Enabled = False
intTemp = 0
strSQL1 = ""
strSQL2 = ""
StrSQL3 = ""
StrSQL4 = ""
strSQL5 = ""

'Added by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位=>CE01收文號,申請人1~5, FC代理人
m_AllSys = IIf(frm100113_1.txt1(4).Text <> "ALL", frm100113_1.txt1(4).Text, GetAllSysKind(, frm100113_1.txt1(4).Text))
SeColTM = " ,CE01,tm23 as cust01,tm78 as cust02,tm79 as cust03,tm80 as cust04,tm81 as cust05,tm44 as fcno "
SeColPA = " ,CE01,pa26 as cust01,pa27 as cust02,pa28 as cust03,pa29 as cust04,pa30 as cust05,pa75 as fcno "
SeColSP = " ,CE01,sp08 as cust01,sp58 as cust02,sp59 as cust03,sp65 as cust04,sp66 as cust05,sp26 as fcno "
SeColLC = " ,CE01,lc11 as cust01,lc43 as cust02,lc44 as cust03,lc45 as cust04,lc46 as cust05,lc22 as fcno "
SeColHC = " ,CE01,hc05 as cust01,hc24 as cust02,hc25 as cust03,hc26 as cust04,hc27 as cust05,'' as fcno "
intCufaCnt = 0
'end 2019/11/01

'變更收文日
If Len(frm100113_1.txt1(2)) <> 0 Then
   strSQL1 = strSQL1 + " AND CP05>=" & Val(ChangeTStringToWString(frm100113_1.txt1(2))) & ""
End If
If Len(Trim(frm100113_1.txt1(3))) <> 0 Then
   strSQL1 = strSQL1 & " AND CP05<=" & Val(ChangeTStringToWString(frm100113_1.txt1(3))) & ""
   pub_QL05 = pub_QL05 & ";" & frm100113_1.Label2(1) & frm100113_1.txt1(2) & "-" & frm100113_1.txt1(3) 'Add By Sindy 2010/11/4
'Add By Cheng 2002/03/18
'若起日有輸入而迄日無, 則以系統日代替
Else
   If Len(frm100113_1.txt1(2).Text) > 0 Then
      strSQL1 = strSQL1 & " AND CP05<=" & Val(ChangeTStringToWString(ServerDate - 19110000)) & ""
      pub_QL05 = pub_QL05 & ";" & frm100113_1.Label2(1) & frm100113_1.txt1(2) & "-" & (ServerDate - 19110000) 'Add By Sindy 2010/11/4
   End If
End If
'Add By Cheng 2002/02/20
'本所案號
If Len("" & frm100113_1.txt3(0).Text) > 0 And Len("" & frm100113_1.txt3(1).Text) > 0 Then
   strSQL1 = strSQL1 + " And CP01='" & frm100113_1.txt3(0).Text & "' AND CP02='" & frm100113_1.txt3(1).Text & "' " & _
            IIf(Len("" & frm100113_1.txt3(2).Text) > 0, " AND CP03= '" & frm100113_1.txt3(2).Text & "' ", " ") & _
            IIf(Len("" & frm100113_1.txt3(3).Text) > 0, " AND CP04= '" & frm100113_1.txt3(3).Text & "' ", " ")
   pub_QL05 = pub_QL05 & ";" & frm100113_1.Label2(3) & frm100113_1.txt3(0) & "-" & frm100113_1.txt3(1) & "-" & frm100113_1.txt3(2) & "-" & frm100113_1.txt3(3) 'Add By Sindy 2010/11/4
End If

strSQL2 = strSQL1
StrSQL3 = strSQL1
StrSQL4 = strSQL1
strSQL5 = strSQL1
'Modify By Cheng 2002/11/13
'申請人編號
If frm100113_1.txt1(0).Text <> "" And frm100113_1.txt1(1).Text <> "" Then
    strSQL1 = strSQL1 & " AND ((PA26>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND PA26<='" & GetNewFagent(frm100113_1.txt1(1)) & "') OR (PA27>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND PA27<='" & GetNewFagent(frm100113_1.txt1(1)) & "') OR (PA28>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND PA28<='" & GetNewFagent(frm100113_1.txt1(1)) & "') OR (PA29>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND PA29<='" & GetNewFagent(frm100113_1.txt1(1)) & "') OR (PA30>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND PA30<='" & GetNewFagent(frm100113_1.txt1(1)) & "')) "
    'edit by nickc 2006/12/11
    'strSQL2 = strSQL2 & " AND (TM23>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND TM23<='" & GetNewFagent(frm100113_1.txt1(1)) & "') "
    strSQL2 = strSQL2 & " AND ((TM23>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND TM23<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (TM78>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND TM78<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (TM79>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND TM79<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (TM80>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND TM80<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (TM81>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND TM81<='" & GetNewFagent(frm100113_1.txt1(1)) & "')) "
    'Modified by Lydia 2019/11/01 +申請人2~5
    'StrSQL3 = StrSQL3 & " AND (LC11>='" & GetNewFagent(frm100113_1.Txt1(0)) & "' AND LC11<='" & GetNewFagent(frm100113_1.Txt1(1)) & "') "
    'StrSQL4 = StrSQL4 & " AND (HC05>='" & GetNewFagent(frm100113_1.Txt1(0)) & "' AND HC05<='" & GetNewFagent(frm100113_1.Txt1(1)) & "') "
    StrSQL3 = StrSQL3 & " AND ((LC11>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND LC11<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (LC43>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND LC43<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (LC44>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND LC44<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (LC45>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND LC45<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (LC46>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND LC46<='" & GetNewFagent(frm100113_1.txt1(1)) & "'))"
    StrSQL4 = StrSQL4 & " AND ((HC05>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND HC05<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (HC24>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND HC24<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (HC25>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND HC25<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (HC26>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND HC26<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (HC27>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND HC27<='" & GetNewFagent(frm100113_1.txt1(1)) & "')) "
    'edit by nickc 2006/12/11
    'strSQL5 = strSQL5 & " AND ((SP08>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND SP08<='" & GetNewFagent(frm100113_1.txt1(1)) & "') OR (SP58>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND SP58<='" & GetNewFagent(frm100113_1.txt1(1)) & "') OR (SP59>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND SP59<='" & GetNewFagent(frm100113_1.txt1(1)) & "'))"
    strSQL5 = strSQL5 & " AND ((SP08>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND SP08<='" & GetNewFagent(frm100113_1.txt1(1)) & "') OR (SP58>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND SP58<='" & GetNewFagent(frm100113_1.txt1(1)) & "') OR (SP59>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND SP59<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (SP65>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND SP65<='" & GetNewFagent(frm100113_1.txt1(1)) & "') or (SP66>='" & GetNewFagent(frm100113_1.txt1(0)) & "' AND SP66<='" & GetNewFagent(frm100113_1.txt1(1)) & "')) "
    pub_QL05 = pub_QL05 & ";" & frm100113_1.Label1 & frm100113_1.txt1(0) & "-" & frm100113_1.txt1(1) 'Add By Sindy 2010/11/4
End If
'系統類別
If Len(Trim(frm100113_1.txt1(4))) <> 0 Then
   'Modify By Cheng 2002/03/14
'   strSQL1 = strSQL1 & " AND CP01 IN (" & SQLGrpStr(frm100113_1.txt1(4), 1) & ") "
'   strSQL2 = strSQL2 & " AND CP01 IN (" & SQLGrpStr(frm100113_1.txt1(4), 2) & ") "
'   StrSQL3 = StrSQL3 & " AND CP01 IN (" & SQLGrpStr(frm100113_1.txt1(4), 3) & ") "
'   StrSQL4 = StrSQL4 & " AND CP01 IN (" & SQLGrpStr(frm100113_1.txt1(4), 4) & ") "
'   StrSQL5 = StrSQL5 & " AND CP01 IN (" & SQLGrpStr(frm100113_1.txt1(4), 5) & ") "
   strSQL1 = strSQL1 & " AND CP01 IN (" & SQLGrpStr(IIf(frm100113_1.txt1(4).Text <> "ALL", frm100113_1.txt1(4).Text, GetAllSysKind(frm100113_1.txt1(4))), 1) & ") "
   strSQL2 = strSQL2 & " AND CP01 IN (" & SQLGrpStr(IIf(frm100113_1.txt1(4).Text <> "ALL", frm100113_1.txt1(4).Text, GetAllSysKind(frm100113_1.txt1(4))), 2) & ") "
   StrSQL3 = StrSQL3 & " AND CP01 IN (" & SQLGrpStr(IIf(frm100113_1.txt1(4).Text <> "ALL", frm100113_1.txt1(4).Text, GetAllSysKind(frm100113_1.txt1(4))), 3) & ") "
   StrSQL4 = StrSQL4 & " AND CP01 IN (" & SQLGrpStr(IIf(frm100113_1.txt1(4).Text <> "ALL", frm100113_1.txt1(4).Text, GetAllSysKind(frm100113_1.txt1(4))), 4) & ") "
   strSQL5 = strSQL5 & " AND CP01 IN (" & SQLGrpStr(IIf(frm100113_1.txt1(4).Text <> "ALL", frm100113_1.txt1(4).Text, GetAllSysKind(frm100113_1.txt1(4))), 5) & ") "
   pub_QL05 = pub_QL05 & ";" & Left(frm100113_1.Label2(2), 5) & frm100113_1.txt1(4) 'Add By Sindy 2010/11/4
End If

pub_QL05 = pub_QL05 & ";" & frm100113_1.Label2(0).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(0).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(0).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(1).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(1).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(2).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(2).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(3).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(3).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(4).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(4).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(5).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(5).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(6).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(6).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(7).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(7).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(8).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(8).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(9).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(9).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(10).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(10).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(11).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(11).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(12).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(12).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(13).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(13).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(14).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(14).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(15).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(15).Caption 'Add By Sindy 2010/11/4
If frm100113_1.Check1(16).Value = 1 Then pub_QL05 = pub_QL05 & ";" & frm100113_1.Check1(16).Caption 'Add By Sindy 2010/11/4

intTemp = 0
'變更申請日
If frm100113_1.Check1(0).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'                       strSQL = "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
                       'edit by nickc 2006/12/11
   '2010/9/15 MODIFY BY SONIA 所有日期欄若需排序改百年日期排序問題
                       'strSQL = "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'                       strSql = "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   'edit by nickc 2006/12/11
'   'strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
                       strSql = "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                   " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                   "FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁" & SeColSP & _
                            " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁" & SeColLC & _
                            " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請日' AS 變更事項,SUBSTR(' '||sqldatet(CE02),-9) AS 變更內容,DECODE(CE03,'1','准','2','駁','') AS 准駁" & SeColHC & _
                            " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE02<>0 AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(1).Value = 1 Then
    strSql = strSql + " UNION "
End If
'Modify By Cheng 2002/02/20
'intTemp = 0
'變更申請人
If frm100113_1.Check1(1).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              'edit by nickc 2006/12/11
              'strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   'edit by nickc 2006/12/11
'   'strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                        " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                        " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                        " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                        " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人' AS 變更事項,CE04||'-'||CE05||'-'||CE06||'-'||CE07||'-'||CE08 AS 變更內容,DECODE(CE09,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                        " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE04 IS NOT NULL OR CE05 IS NOT NULL OR CE06 IS NOT NULL OR CE07 IS NOT NULL OR CE08 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(2).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更代表人
If frm100113_1.Check1(2).Value = 1 Then
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,'','','','',CE01 " & _
              " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 " & _
'              " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 " & _
'              " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 " & _
'              " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 " & _
'              " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,'','','','',CE01 " & _
'              " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁,'','','','',CE01 " & _
'              " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁" & SeColTM & _
              " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁" & SeColPA & _
              " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁" & SeColSP & _
              " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁" & SeColLC & _
              " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人' AS 變更事項,CE10||'/'||CE11||'/'||CE12||'-'||CE13||'/'||CE14||'/'||CE15 AS 變更內容,DECODE(CE16,'1','准','2','駁','') AS 准駁" & SeColHC & _
              " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE10 IS NOT NULL OR CE11 IS NOT NULL OR CE12 IS NOT NULL OR CE13 IS NOT NULL OR CE14 IS NOT NULL OR CE15 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(3).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更申請人中譯文
If frm100113_1.Check1(3).Value = 1 Then
   'Modify By Cheng 2002/04/25
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(SP05,'Y','＊','') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(SP05,'Y','＊','') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(SP05,'Y','＊','') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁" & SeColTM & _
                          " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁" & SeColPA & _
                          " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(SP05,'Y','＊','') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁" & SeColSP & _
                          " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁" & SeColLC & _
                          " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人中譯文' AS 變更事項,CE17||'-'||CE18||'-'||CE19||'-'||CE20||'-'||CE21 AS 變更內容,DECODE(CE22,'1','准','2','駁','') AS 准駁" & SeColHC & _
                          " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE17 IS NOT NULL OR CE18 IS NOT NULL OR CE19 IS NOT NULL OR CE20 IS NOT NULL OR CE21 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(4).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更代表人中譯文
If frm100113_1.Check1(4).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁" & SeColTM & _
                            " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁" & SeColPA & _
                            " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁" & SeColSP & _
                            " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁" & SeColLC & _
                           " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人中譯文' AS 變更事項,CE63||'-'||CE64 AS 變更內容,DECODE(CE65,'1','准','2','駁','') AS 准駁" & SeColHC & _
                           " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE63 IS NOT NULL OR CE64 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(5).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更申請地址
If frm100113_1.Check1(5).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'   strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,'','','','' " & _
'            " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 " & _
'            " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' " & _
'            " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,'','','','' " & _
'            " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,'','','','' " & _
'            " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'   strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,'','','','',CE01 " & _
            " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'   strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 " & _
'            " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 " & _
'            " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 " & _
'            " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 " & _
'            " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,'','','','',CE01 " & _
'            " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁,'','','','',CE01 " & _
'            " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁" & SeColTM & _
            " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁" & SeColPA & _
            " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁" & SeColSP & _
            " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁" & SeColLC & _
            " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請地址' AS 變更事項,CE23||'/'||CE24||'/'||CE25||'-'||CE26||'/'||CE27||'/'||CE28||'-'||CE29||'/'||CE30||'/'||CE31||'-'||CE32||'/'||CE33||'/'||CE34||'-'||CE35||'/'||CE36||'/'||CE37 AS 變更內容,DECODE(CE38,'1','准','2','駁','') AS 准駁" & SeColHC & _
            " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE23 IS NOT NULL OR CE24 IS NOT NULL OR CE25 IS NOT NULL OR CE26 IS NOT NULL OR CE27 IS NOT NULL OR CE28 IS NOT NULL OR CE29 IS NOT NULL OR CE30 IS NOT NULL OR CE31 IS NOT NULL OR CE32 IS NOT NULL OR CE33 IS NOT NULL OR CE34 IS NOT NULL OR CE35 IS NOT NULL OR CE36 IS NOT NULL OR CE37 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(6).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更專利商標種類
If frm100113_1.Check1(6).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁" & SeColTM & _
                            " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁" & SeColPA & _
                            " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁" & SeColSP & _
                            " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁" & SeColLC & _
                            " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更專利商標種類' AS 變更事項,CE39 AS 變更內容,DECODE(CE40,'1','准','2','駁','') AS 准駁" & SeColHC & _
                            " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE39 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(7).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更案件名稱
If frm100113_1.Check1(7).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更案件名稱' AS 變更事項,CE41||'/'||CE42||'/'||CE43 AS 變更內容,DECODE(CE44,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE (CE41 IS NOT NULL OR CE42 IS NOT NULL OR CE43 IS NOT NULL) AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(8).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'減縮商品
If frm100113_1.Check1(8).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'減縮商品' AS 變更事項,CE45 AS 變更內容,DECODE(CE46,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE45 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(9).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更商品類別
If frm100113_1.Check1(9).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                        " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                        " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                        " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                        " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品類別' AS 變更事項,CE47 AS 變更內容,DECODE(CE48,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                        " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE47 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(10).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更商品組群
If frm100113_1.Check1(10).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                        " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                        " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                        " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                        " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更商品組群' AS 變更事項,CE49 AS 變更內容,DECODE(CE50,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                        " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE49 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(11).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更申請人印鑑
If frm100113_1.Check1(11).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
             strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                        " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                        " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                        " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                        " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更申請人印鑑' AS 變更事項,CE51 AS 變更內容,DECODE(CE52,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                        " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE51 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(12).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更代表人印鑑
If frm100113_1.Check1(12).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                    " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                    " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                    " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                    " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代表人印鑑' AS 變更事項,CE53 AS 變更內容,DECODE(CE54,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                    " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE53 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(13).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更代理人
If frm100113_1.Check1(13).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變吱代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                        " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                         " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                        " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                        " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更代理人' AS 變更事項,CE55 AS 變更內容,DECODE(CE56,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                        " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE55 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(14).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更正商標號數
If frm100113_1.Check1(14).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                        " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                        " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                        " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                        " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更正商標號數' AS 變更事項,CE57 AS 變更內容,DECODE(CE58,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                        " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE57 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(15).Value = 1 Then
    strSql = strSql + " UNION "
End If
'intTemp = 0
'變更圖樣
If frm100113_1.Check1(15).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                        " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                        " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                        " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                        " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'變更圖樣' AS 變更事項,CE59 AS 變更內容,DECODE(CE60,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                        " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE59 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
If intTemp = 1 And frm100113_1.Check1(16).Value = 1 Then
    strSql = strSql + " UNION "
End If
'其他
'intTemp = 0
If frm100113_1.Check1(16).Value = 1 Then
   'Modify By Cheng 2002/04/25
   '若已閉卷, 則在本所案號後加"*"號
    'Modify By Cheng 2002/12/04
'              strSQL = strSQL + "SELECT NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,'','','','' FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,SP58,SP59,'','' FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & StrSQL5
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,'','','','' FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSQL = strSQL + " union all select NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,'','','','' FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
'edit by nickc 2006/12/11
'              strSQL = strSQL + "SELECT ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   'Modified by Lydia 2019/11/01 利益衝突案件：調整最後面的欄位
'              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,tm78,tm79,tm80,tm81,CE01 FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,PA27,PA28,PA29,PA30,CE01 FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
''edit by nickc 2006/12/11
''   strSQL = strSQL + " union all select ' ' As V, NVL(NVL(CU04,NVL(CU05||' '||CU88||' '||CU89||' '||CU90,CU06)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,SP58,SP59,'','',CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,SP58,SP59,sp65,sp66,CE01 FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
'   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁,'','','','',CE01 FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
              strSql = strSql + "SELECT ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),TM23) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(tm29,'Y','＊','')||DECODE(length(nvl(tm57,'')),null,'','●') AS 本所案號,DECODE(length(nvl(tm73,'')),null,'','●')||tm34 as 分所號,NVL(TM05,NVL(TM06,TM07)) AS 案件名稱,NVL(DECODE(TM10,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁" & SeColTM & _
                                        " FROM TRADEMARK,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND cE01=cp09(+) AND cp01=TM01(+) AND cp02=TM02(+) AND cp03=TM03(+) AND cp04=TM04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("tm23", "cu") & " " & strSQL2
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),PA26) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(PA57,'Y','＊','')||DECODE(length(nvl(pa108,'')),null,'','●') AS 本所案號,DECODE(length(nvl(pa136,'')),null,'','●')||pa47 as 分所號,NVL(PA05,NVL(PA06,PA07)) AS 案件名稱,NVL(DECODE(PA09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁" & SeColPA & _
                                        " FROM PATENT,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=PA01(+) AND cp02=PA02(+) AND cp03=PA03(+) AND cp04=PA04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("pa26", "cu") & " " & strSQL1
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),SP08) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(sp15,'Y','＊','')||DECODE(length(nvl(sp61,'')),null,'','●') AS 本所案號,DECODE(length(nvl(sp68,'')),null,'','●')||sp28 as 分所號,NVL(SP05,NVL(SP06,SP07)) AS 案件名稱,NVL(DECODE(SP09,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁" & SeColSP & _
                                        " FROM SERVICEPRACTICE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=sP01(+) AND cp02=sP02(+) AND cp03=sP03(+) AND cp04=sP04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("sp08", "cu") & " " & strSQL5
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),LC11) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(lc08,'Y','＊','')||DECODE(length(nvl(lc34,'')),null,'','●') AS 本所案號,DECODE(length(nvl(lc36,'')),null,'','●')||lc16 as 分所號,NVL(LC05,NVL(LC06,LC07)) AS 案件名稱,NVL(DECODE(LC15,'000',CPM03,CPM04),CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁" & SeColLC & _
                                        " FROM LAWCASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=lc01(+) AND cp02=lc02(+) AND cp03=lc03(+) AND cp04=lc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("lc11", "cu") & " " & StrSQL3
   strSql = strSql + " union all select ' ' As V, NVL(NVL(CU04,DECODE(cu05,null,CU06,cu05||' '||cu88||' '||cu89||' '||cu90)),HC05) AS 申請人,CP01||'-'||CP02||'-'||CP03||'-'||CP04||DECODE(hc09,'Y','＊','')||DECODE(length(nvl(hc19,'')),null,'','●') AS 本所案號,DECODE(length(nvl(hc20,'')),null,'','●')||hc07 as 分所號,HC06 AS 案件名稱,NVL(CPM03,CP10) AS 案件性質,SUBSTR(' '||sqldatet(CP05),-9) AS 收文日,DECODE(CP22,'Y','是','N','否','') AS 是否出名,'其他' AS 變更事項,CE61 AS 變更內容,DECODE(CE62,'1','准','2','駁','') AS 准駁" & SeColHC & _
                                        " FROM HIRECASE,CASEPROGRESS,CHANGEEVENT,casepropertymap,customer WHERE CE61 IS NOT NULL AND ce01=CP09(+) AND cp01=hc01(+) AND cp02=hc02(+) AND cp03=hc03(+) AND cp04=hc04(+) and cp01=cpm01(+) and cp10=cpm02(+) and " & SQLNewFag("hc05", "cu") & " " & StrSQL4
   'end 2019/11/01
   intTemp = 1
End If
strSql = strSql + " ORDER BY 申請人,本所案號 "
CheckOC
s = 0
adoRecordset.CursorLocation = adUseClient
'Modified by Lydia 2019/11/01 改變型態
'adoRecordset.Open strSql, cnnConnection, adOpenStatic, adLockReadOnly
adoRecordset.Open strSql, cnnConnection, adOpenDynamic, adLockBatchOptimistic

If adoRecordset.RecordCount <> 0 And adoRecordset.RecordCount > 0 Then
   dblRow = adoRecordset.RecordCount 'Add By Sindy 2025/9/3

   'Added by Lydia 2019/11/01 逐案號判斷
    If strSrvDate(1) >= XY特殊權限啟用日 And XY特殊權限範圍 <> "" Then
        adoRecordset.MoveFirst
        Do While adoRecordset.EOF = False
            '利益衝突案件：逐案號判斷
            If PUB_ChkCufaByCase(Me.Name, m_AllSys, "" & adoRecordset.Fields("本所案號"), "" & adoRecordset.Fields("cust01") & "," & adoRecordset.Fields("cust02") & "," & adoRecordset.Fields("cust03") & "," & adoRecordset.Fields("cust04") & "," & adoRecordset.Fields("cust05"), "" & adoRecordset.Fields("fcno")) = False Then
                intCufaCnt = intCufaCnt + 1
                adoRecordset.Delete
            End If
            adoRecordset.MoveNext
        Loop
        '利益衝突案件：限閱案件
        If intCufaCnt > 0 Then
            pub_QL05 = pub_QL05 & "(含限閱" & intCufaCnt & "筆)" 'Add By Sindy 2025/9/3
            MsgBox MsgText(1109) & " " & intCufaCnt & " 件", vbInformation, MsgText(1110)
        End If
        InsertQueryLog (dblRow) 'Add By Sindy 2010/11/4
        If adoRecordset.RecordCount = 0 Then
              GoTo JumpToNoData
        End If
    Else
        InsertQueryLog (adoRecordset.RecordCount) 'Add By Sindy 2010/11/4
    End If
   'end 2019/11/01
   
Else
   InsertQueryLog (0) 'Add By Sindy 2010/11/4
JumpToNoData:   'Added by Lydia 2019/11/01
   Me.Enabled = True
   ShowNoData
   Screen.MousePointer = vbDefault
   '92.04.18 nick
   'Me.Hide
   tmpBol = fnCancelNowFormAndShowParentForm(Me)
   Exit Sub
End If
Me.grdDataList.Visible = False
Set grdDataList.Recordset = adoRecordset
For ii = 1 To Me.grdDataList.Rows - 1
    'Modified by Lydia 2019/11/01 改成變數
    'Me.grdDataList.TextMatrix(ii, 5) = Me.grdDataList.TextMatrix(ii, 5) & PUB_GetRelateCasePropertyName(Me.grdDataList.TextMatrix(ii, 15), "1")
    Me.grdDataList.TextMatrix(ii, 5) = Me.grdDataList.TextMatrix(ii, 5) & PUB_GetRelateCasePropertyName(Me.grdDataList.TextMatrix(ii, ColCE01), "1")
Next ii
Me.grdDataList.Visible = True
Me.Enabled = True
End Sub

Private Sub Form_Unload(Cancel As Integer)
    Set frm100113_2 = Nothing
End Sub

Private Sub GrdDataList_Click()
    'Add By Cheng 2002/12/04
    With Me.grdDataList
        If .Rows > 1 And .row > 0 Then
            If .TextMatrix(.row, 0) <> "V" Then
                .TextMatrix(.row, 0) = "V"
            Else
                .TextMatrix(.row, 0) = ""
            End If
        End If
    End With
End Sub
